(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const m of e.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function a(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerPolicy&&(e.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?e.credentials="include":s.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function o(s){if(s.ep)return;s.ep=!0;const e=a(s);fetch(s.href,e)}})();function Ob(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function Av(l){if(Object.prototype.hasOwnProperty.call(l,"__esModule"))return l;var n=l.default;if(typeof n=="function"){var a=function o(){var s=!1;try{s=this instanceof o}catch{}return s?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};a.prototype=n.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(l).forEach(function(o){var s=Object.getOwnPropertyDescriptor(l,o);Object.defineProperty(a,o,s.get?s:{enumerable:!0,get:function(){return l[o]}})}),a}var a1={exports:{}},Bf={};var Sx;function Ev(){if(Sx)return Bf;Sx=1;var l=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(o,s,e){var m=null;if(e!==void 0&&(m=""+e),s.key!==void 0&&(m=""+s.key),"key"in s){e={};for(var v in s)v!=="key"&&(e[v]=s[v])}else e=s;return s=e.ref,{$$typeof:l,type:o,key:m,ref:s!==void 0?s:null,props:e}}return Bf.Fragment=n,Bf.jsx=a,Bf.jsxs=a,Bf}var Ax;function Dv(){return Ax||(Ax=1,a1.exports=Ev()),a1.exports}var t=Dv(),n1={exports:{}},Es={};var Ex;function Tv(){if(Ex)return Es;Ex=1;var l=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),e=Symbol.for("react.consumer"),m=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),N=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),L=Symbol.iterator;function M(W){return W===null||typeof W!="object"?null:(W=L&&W[L]||W["@@iterator"],typeof W=="function"?W:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,P={};function G(W,pe,Me){this.props=W,this.context=pe,this.refs=P,this.updater=Me||F}G.prototype.isReactComponent={},G.prototype.setState=function(W,pe){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,pe,"setState")},G.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function ae(){}ae.prototype=G.prototype;function re(W,pe,Me){this.props=W,this.context=pe,this.refs=P,this.updater=Me||F}var Ne=re.prototype=new ae;Ne.constructor=re,O(Ne,G.prototype),Ne.isPureReactComponent=!0;var xe=Array.isArray;function we(){}var Z={H:null,A:null,T:null,S:null},ce=Object.prototype.hasOwnProperty;function ue(W,pe,Me){var Se=Me.ref;return{$$typeof:l,type:W,key:pe,ref:Se!==void 0?Se:null,props:Me}}function Le(W,pe){return ue(W.type,pe,W.props)}function be(W){return typeof W=="object"&&W!==null&&W.$$typeof===l}function oe(W){var pe={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(Me){return pe[Me]})}var he=/\/+/g;function ye(W,pe){return typeof W=="object"&&W!==null&&W.key!=null?oe(""+W.key):pe.toString(36)}function Te(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(we,we):(W.status="pending",W.then(function(pe){W.status==="pending"&&(W.status="fulfilled",W.value=pe)},function(pe){W.status==="pending"&&(W.status="rejected",W.reason=pe)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function fe(W,pe,Me,Se,V){var H=typeof W;(H==="undefined"||H==="boolean")&&(W=null);var Q=!1;if(W===null)Q=!0;else switch(H){case"bigint":case"string":case"number":Q=!0;break;case"object":switch(W.$$typeof){case l:case n:Q=!0;break;case S:return Q=W._init,fe(Q(W._payload),pe,Me,Se,V)}}if(Q)return V=V(W),Q=Se===""?"."+ye(W,0):Se,xe(V)?(Me="",Q!=null&&(Me=Q.replace(he,"$&/")+"/"),fe(V,pe,Me,"",function(ve){return ve})):V!=null&&(be(V)&&(V=Le(V,Me+(V.key==null||W&&W.key===V.key?"":(""+V.key).replace(he,"$&/")+"/")+Q)),pe.push(V)),1;Q=0;var te=Se===""?".":Se+":";if(xe(W))for(var de=0;de<W.length;de++)Se=W[de],H=te+ye(Se,de),Q+=fe(Se,pe,Me,H,V);else if(de=M(W),typeof de=="function")for(W=de.call(W),de=0;!(Se=W.next()).done;)Se=Se.value,H=te+ye(Se,de++),Q+=fe(Se,pe,Me,H,V);else if(H==="object"){if(typeof W.then=="function")return fe(Te(W),pe,Me,Se,V);throw pe=String(W),Error("Objects are not valid as a React child (found: "+(pe==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":pe)+"). If you meant to render a collection of children, use an array instead.")}return Q}function _e(W,pe,Me){if(W==null)return W;var Se=[],V=0;return fe(W,Se,"","",function(H){return pe.call(Me,H,V++)}),Se}function We(W){if(W._status===-1){var pe=W._result;pe=pe(),pe.then(function(Me){(W._status===0||W._status===-1)&&(W._status=1,W._result=Me)},function(Me){(W._status===0||W._status===-1)&&(W._status=2,W._result=Me)}),W._status===-1&&(W._status=0,W._result=pe)}if(W._status===1)return W._result.default;throw W._result}var se=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var pe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(pe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)},me={map:_e,forEach:function(W,pe,Me){_e(W,function(){pe.apply(this,arguments)},Me)},count:function(W){var pe=0;return _e(W,function(){pe++}),pe},toArray:function(W){return _e(W,function(pe){return pe})||[]},only:function(W){if(!be(W))throw Error("React.Children.only expected to receive a single React element child.");return W}};return Es.Activity=D,Es.Children=me,Es.Component=G,Es.Fragment=a,Es.Profiler=s,Es.PureComponent=re,Es.StrictMode=o,Es.Suspense=w,Es.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Z,Es.__COMPILER_RUNTIME={__proto__:null,c:function(W){return Z.H.useMemoCache(W)}},Es.cache=function(W){return function(){return W.apply(null,arguments)}},Es.cacheSignal=function(){return null},Es.cloneElement=function(W,pe,Me){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var Se=O({},W.props),V=W.key;if(pe!=null)for(H in pe.key!==void 0&&(V=""+pe.key),pe)!ce.call(pe,H)||H==="key"||H==="__self"||H==="__source"||H==="ref"&&pe.ref===void 0||(Se[H]=pe[H]);var H=arguments.length-2;if(H===1)Se.children=Me;else if(1<H){for(var Q=Array(H),te=0;te<H;te++)Q[te]=arguments[te+2];Se.children=Q}return ue(W.type,V,Se)},Es.createContext=function(W){return W={$$typeof:m,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:e,_context:W},W},Es.createElement=function(W,pe,Me){var Se,V={},H=null;if(pe!=null)for(Se in pe.key!==void 0&&(H=""+pe.key),pe)ce.call(pe,Se)&&Se!=="key"&&Se!=="__self"&&Se!=="__source"&&(V[Se]=pe[Se]);var Q=arguments.length-2;if(Q===1)V.children=Me;else if(1<Q){for(var te=Array(Q),de=0;de<Q;de++)te[de]=arguments[de+2];V.children=te}if(W&&W.defaultProps)for(Se in Q=W.defaultProps,Q)V[Se]===void 0&&(V[Se]=Q[Se]);return ue(W,H,V)},Es.createRef=function(){return{current:null}},Es.forwardRef=function(W){return{$$typeof:v,render:W}},Es.isValidElement=be,Es.lazy=function(W){return{$$typeof:S,_payload:{_status:-1,_result:W},_init:We}},Es.memo=function(W,pe){return{$$typeof:N,type:W,compare:pe===void 0?null:pe}},Es.startTransition=function(W){var pe=Z.T,Me={};Z.T=Me;try{var Se=W(),V=Z.S;V!==null&&V(Me,Se),typeof Se=="object"&&Se!==null&&typeof Se.then=="function"&&Se.then(we,se)}catch(H){se(H)}finally{pe!==null&&Me.types!==null&&(pe.types=Me.types),Z.T=pe}},Es.unstable_useCacheRefresh=function(){return Z.H.useCacheRefresh()},Es.use=function(W){return Z.H.use(W)},Es.useActionState=function(W,pe,Me){return Z.H.useActionState(W,pe,Me)},Es.useCallback=function(W,pe){return Z.H.useCallback(W,pe)},Es.useContext=function(W){return Z.H.useContext(W)},Es.useDebugValue=function(){},Es.useDeferredValue=function(W,pe){return Z.H.useDeferredValue(W,pe)},Es.useEffect=function(W,pe){return Z.H.useEffect(W,pe)},Es.useEffectEvent=function(W){return Z.H.useEffectEvent(W)},Es.useId=function(){return Z.H.useId()},Es.useImperativeHandle=function(W,pe,Me){return Z.H.useImperativeHandle(W,pe,Me)},Es.useInsertionEffect=function(W,pe){return Z.H.useInsertionEffect(W,pe)},Es.useLayoutEffect=function(W,pe){return Z.H.useLayoutEffect(W,pe)},Es.useMemo=function(W,pe){return Z.H.useMemo(W,pe)},Es.useOptimistic=function(W,pe){return Z.H.useOptimistic(W,pe)},Es.useReducer=function(W,pe,Me){return Z.H.useReducer(W,pe,Me)},Es.useRef=function(W){return Z.H.useRef(W)},Es.useState=function(W){return Z.H.useState(W)},Es.useSyncExternalStore=function(W,pe,Me){return Z.H.useSyncExternalStore(W,pe,Me)},Es.useTransition=function(){return Z.H.useTransition()},Es.version="19.2.3",Es}var Dx;function ex(){return Dx||(Dx=1,n1.exports=Tv()),n1.exports}var B=ex();const Lo=Ob(B);var i1={exports:{}},zf={},l1={exports:{}},o1={};var Tx;function _v(){return Tx||(Tx=1,(function(l){function n(fe,_e){var We=fe.length;fe.push(_e);e:for(;0<We;){var se=We-1>>>1,me=fe[se];if(0<s(me,_e))fe[se]=_e,fe[We]=me,We=se;else break e}}function a(fe){return fe.length===0?null:fe[0]}function o(fe){if(fe.length===0)return null;var _e=fe[0],We=fe.pop();if(We!==_e){fe[0]=We;e:for(var se=0,me=fe.length,W=me>>>1;se<W;){var pe=2*(se+1)-1,Me=fe[pe],Se=pe+1,V=fe[Se];if(0>s(Me,We))Se<me&&0>s(V,Me)?(fe[se]=V,fe[Se]=We,se=Se):(fe[se]=Me,fe[pe]=We,se=pe);else if(Se<me&&0>s(V,We))fe[se]=V,fe[Se]=We,se=Se;else break e}}return _e}function s(fe,_e){var We=fe.sortIndex-_e.sortIndex;return We!==0?We:fe.id-_e.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var e=performance;l.unstable_now=function(){return e.now()}}else{var m=Date,v=m.now();l.unstable_now=function(){return m.now()-v}}var w=[],N=[],S=1,D=null,L=3,M=!1,F=!1,O=!1,P=!1,G=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,re=typeof setImmediate<"u"?setImmediate:null;function Ne(fe){for(var _e=a(N);_e!==null;){if(_e.callback===null)o(N);else if(_e.startTime<=fe)o(N),_e.sortIndex=_e.expirationTime,n(w,_e);else break;_e=a(N)}}function xe(fe){if(O=!1,Ne(fe),!F)if(a(w)!==null)F=!0,we||(we=!0,oe());else{var _e=a(N);_e!==null&&Te(xe,_e.startTime-fe)}}var we=!1,Z=-1,ce=5,ue=-1;function Le(){return P?!0:!(l.unstable_now()-ue<ce)}function be(){if(P=!1,we){var fe=l.unstable_now();ue=fe;var _e=!0;try{e:{F=!1,O&&(O=!1,ae(Z),Z=-1),M=!0;var We=L;try{t:{for(Ne(fe),D=a(w);D!==null&&!(D.expirationTime>fe&&Le());){var se=D.callback;if(typeof se=="function"){D.callback=null,L=D.priorityLevel;var me=se(D.expirationTime<=fe);if(fe=l.unstable_now(),typeof me=="function"){D.callback=me,Ne(fe),_e=!0;break t}D===a(w)&&o(w),Ne(fe)}else o(w);D=a(w)}if(D!==null)_e=!0;else{var W=a(N);W!==null&&Te(xe,W.startTime-fe),_e=!1}}break e}finally{D=null,L=We,M=!1}_e=void 0}}finally{_e?oe():we=!1}}}var oe;if(typeof re=="function")oe=function(){re(be)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,ye=he.port2;he.port1.onmessage=be,oe=function(){ye.postMessage(null)}}else oe=function(){G(be,0)};function Te(fe,_e){Z=G(function(){fe(l.unstable_now())},_e)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(fe){fe.callback=null},l.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ce=0<fe?Math.floor(1e3/fe):5},l.unstable_getCurrentPriorityLevel=function(){return L},l.unstable_next=function(fe){switch(L){case 1:case 2:case 3:var _e=3;break;default:_e=L}var We=L;L=_e;try{return fe()}finally{L=We}},l.unstable_requestPaint=function(){P=!0},l.unstable_runWithPriority=function(fe,_e){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var We=L;L=fe;try{return _e()}finally{L=We}},l.unstable_scheduleCallback=function(fe,_e,We){var se=l.unstable_now();switch(typeof We=="object"&&We!==null?(We=We.delay,We=typeof We=="number"&&0<We?se+We:se):We=se,fe){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=We+me,fe={id:S++,callback:_e,priorityLevel:fe,startTime:We,expirationTime:me,sortIndex:-1},We>se?(fe.sortIndex=We,n(N,fe),a(w)===null&&fe===a(N)&&(O?(ae(Z),Z=-1):O=!0,Te(xe,We-se))):(fe.sortIndex=me,n(w,fe),F||M||(F=!0,we||(we=!0,oe()))),fe},l.unstable_shouldYield=Le,l.unstable_wrapCallback=function(fe){var _e=L;return function(){var We=L;L=_e;try{return fe.apply(this,arguments)}finally{L=We}}}})(o1)),o1}var _x;function Fv(){return _x||(_x=1,l1.exports=_v()),l1.exports}var c1={exports:{}},Za={};var Fx;function Mv(){if(Fx)return Za;Fx=1;var l=ex();function n(w){var N="https://react.dev/errors/"+w;if(1<arguments.length){N+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)N+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+w+"; visit "+N+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var o={d:{f:a,r:function(){throw Error(n(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},s=Symbol.for("react.portal");function e(w,N,S){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:D==null?null:""+D,children:w,containerInfo:N,implementation:S}}var m=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function v(w,N){if(w==="font")return"";if(typeof N=="string")return N==="use-credentials"?N:""}return Za.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,Za.createPortal=function(w,N){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N||N.nodeType!==1&&N.nodeType!==9&&N.nodeType!==11)throw Error(n(299));return e(w,N,null,S)},Za.flushSync=function(w){var N=m.T,S=o.p;try{if(m.T=null,o.p=2,w)return w()}finally{m.T=N,o.p=S,o.d.f()}},Za.preconnect=function(w,N){typeof w=="string"&&(N?(N=N.crossOrigin,N=typeof N=="string"?N==="use-credentials"?N:"":void 0):N=null,o.d.C(w,N))},Za.prefetchDNS=function(w){typeof w=="string"&&o.d.D(w)},Za.preinit=function(w,N){if(typeof w=="string"&&N&&typeof N.as=="string"){var S=N.as,D=v(S,N.crossOrigin),L=typeof N.integrity=="string"?N.integrity:void 0,M=typeof N.fetchPriority=="string"?N.fetchPriority:void 0;S==="style"?o.d.S(w,typeof N.precedence=="string"?N.precedence:void 0,{crossOrigin:D,integrity:L,fetchPriority:M}):S==="script"&&o.d.X(w,{crossOrigin:D,integrity:L,fetchPriority:M,nonce:typeof N.nonce=="string"?N.nonce:void 0})}},Za.preinitModule=function(w,N){if(typeof w=="string")if(typeof N=="object"&&N!==null){if(N.as==null||N.as==="script"){var S=v(N.as,N.crossOrigin);o.d.M(w,{crossOrigin:S,integrity:typeof N.integrity=="string"?N.integrity:void 0,nonce:typeof N.nonce=="string"?N.nonce:void 0})}}else N==null&&o.d.M(w)},Za.preload=function(w,N){if(typeof w=="string"&&typeof N=="object"&&N!==null&&typeof N.as=="string"){var S=N.as,D=v(S,N.crossOrigin);o.d.L(w,S,{crossOrigin:D,integrity:typeof N.integrity=="string"?N.integrity:void 0,nonce:typeof N.nonce=="string"?N.nonce:void 0,type:typeof N.type=="string"?N.type:void 0,fetchPriority:typeof N.fetchPriority=="string"?N.fetchPriority:void 0,referrerPolicy:typeof N.referrerPolicy=="string"?N.referrerPolicy:void 0,imageSrcSet:typeof N.imageSrcSet=="string"?N.imageSrcSet:void 0,imageSizes:typeof N.imageSizes=="string"?N.imageSizes:void 0,media:typeof N.media=="string"?N.media:void 0})}},Za.preloadModule=function(w,N){if(typeof w=="string")if(N){var S=v(N.as,N.crossOrigin);o.d.m(w,{as:typeof N.as=="string"&&N.as!=="script"?N.as:void 0,crossOrigin:S,integrity:typeof N.integrity=="string"?N.integrity:void 0})}else o.d.m(w)},Za.requestFormReset=function(w){o.d.r(w)},Za.unstable_batchedUpdates=function(w,N){return w(N)},Za.useFormState=function(w,N,S){return m.H.useFormState(w,N,S)},Za.useFormStatus=function(){return m.H.useHostTransitionStatus()},Za.version="19.2.3",Za}var Mx;function Lv(){if(Mx)return c1.exports;Mx=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(n){console.error(n)}}return l(),c1.exports=Mv(),c1.exports}var Lx;function Rv(){if(Lx)return zf;Lx=1;var l=Fv(),n=ex(),a=Lv();function o(i){var c="https://react.dev/errors/"+i;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function e(i){var c=i,f=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(f=c.return),i=c.return;while(i)}return c.tag===3?f:null}function m(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function v(i){if(i.tag===31){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function w(i){if(e(i)!==i)throw Error(o(188))}function N(i){var c=i.alternate;if(!c){if(c=e(i),c===null)throw Error(o(188));return c!==i?null:i}for(var f=i,p=c;;){var C=f.return;if(C===null)break;var A=C.alternate;if(A===null){if(p=C.return,p!==null){f=p;continue}break}if(C.child===A.child){for(A=C.child;A;){if(A===f)return w(C),i;if(A===p)return w(C),c;A=A.sibling}throw Error(o(188))}if(f.return!==p.return)f=C,p=A;else{for(var U=!1,ee=C.child;ee;){if(ee===f){U=!0,f=C,p=A;break}if(ee===p){U=!0,p=C,f=A;break}ee=ee.sibling}if(!U){for(ee=A.child;ee;){if(ee===f){U=!0,f=A,p=C;break}if(ee===p){U=!0,p=A,f=C;break}ee=ee.sibling}if(!U)throw Error(o(189))}}if(f.alternate!==p)throw Error(o(190))}if(f.tag!==3)throw Error(o(188));return f.stateNode.current===f?i:c}function S(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i;for(i=i.child;i!==null;){if(c=S(i),c!==null)return c;i=i.sibling}return null}var D=Object.assign,L=Symbol.for("react.element"),M=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),ae=Symbol.for("react.consumer"),re=Symbol.for("react.context"),Ne=Symbol.for("react.forward_ref"),xe=Symbol.for("react.suspense"),we=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),ce=Symbol.for("react.lazy"),ue=Symbol.for("react.activity"),Le=Symbol.for("react.memo_cache_sentinel"),be=Symbol.iterator;function oe(i){return i===null||typeof i!="object"?null:(i=be&&i[be]||i["@@iterator"],typeof i=="function"?i:null)}var he=Symbol.for("react.client.reference");function ye(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===he?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case O:return"Fragment";case G:return"Profiler";case P:return"StrictMode";case xe:return"Suspense";case we:return"SuspenseList";case ue:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case F:return"Portal";case re:return i.displayName||"Context";case ae:return(i._context.displayName||"Context")+".Consumer";case Ne:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Z:return c=i.displayName||null,c!==null?c:ye(i.type)||"Memo";case ce:c=i._payload,i=i._init;try{return ye(i(c))}catch{}}return null}var Te=Array.isArray,fe=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,We={pending:!1,data:null,method:null,action:null},se=[],me=-1;function W(i){return{current:i}}function pe(i){0>me||(i.current=se[me],se[me]=null,me--)}function Me(i,c){me++,se[me]=i.current,i.current=c}var Se=W(null),V=W(null),H=W(null),Q=W(null);function te(i,c){switch(Me(H,c),Me(V,i),Me(Se,null),c.nodeType){case 9:case 11:i=(i=c.documentElement)&&(i=i.namespaceURI)?Lf(i):0;break;default:if(i=c.tagName,c=c.namespaceURI)c=Lf(c),i=ni(c,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}pe(Se),Me(Se,i)}function de(){pe(Se),pe(V),pe(H)}function ve(i){i.memoizedState!==null&&Me(Q,i);var c=Se.current,f=ni(c,i.type);c!==f&&(Me(V,i),Me(Se,f))}function ke(i){V.current===i&&(pe(Se),pe(V)),Q.current===i&&(pe(Q),Wt._currentValue=We)}var ne,De;function He(i){if(ne===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);ne=c&&c[1]||"",De=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ne+i+De}var vt=!1;function Pe(i,c){if(!i||vt)return"";vt=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(c){var mt=function(){throw Error()};if(Object.defineProperty(mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mt,[])}catch(lt){var et=lt}Reflect.construct(i,[],mt)}else{try{mt.call()}catch(lt){et=lt}i.call(mt.prototype)}}else{try{throw Error()}catch(lt){et=lt}(mt=i())&&typeof mt.catch=="function"&&mt.catch(function(){})}}catch(lt){if(lt&&et&&typeof lt.stack=="string")return[lt.stack,et.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=p.DetermineComponentFrameRoot(),U=A[0],ee=A[1];if(U&&ee){var je=U.split(`
`),Ye=ee.split(`
`);for(C=p=0;p<je.length&&!je[p].includes("DetermineComponentFrameRoot");)p++;for(;C<Ye.length&&!Ye[C].includes("DetermineComponentFrameRoot");)C++;if(p===je.length||C===Ye.length)for(p=je.length-1,C=Ye.length-1;1<=p&&0<=C&&je[p]!==Ye[C];)C--;for(;1<=p&&0<=C;p--,C--)if(je[p]!==Ye[C]){if(p!==1||C!==1)do if(p--,C--,0>C||je[p]!==Ye[C]){var ut=`
`+je[p].replace(" at new "," at ");return i.displayName&&ut.includes("<anonymous>")&&(ut=ut.replace("<anonymous>",i.displayName)),ut}while(1<=p&&0<=C);break}}}finally{vt=!1,Error.prepareStackTrace=f}return(f=i?i.displayName||i.name:"")?He(f):""}function Nt(i,c){switch(i.tag){case 26:case 27:case 5:return He(i.type);case 16:return He("Lazy");case 13:return i.child!==c&&c!==null?He("Suspense Fallback"):He("Suspense");case 19:return He("SuspenseList");case 0:case 15:return Pe(i.type,!1);case 11:return Pe(i.type.render,!1);case 1:return Pe(i.type,!0);case 31:return He("Activity");default:return""}}function st(i){try{var c="",f=null;do c+=Nt(i,f),f=i,i=i.return;while(i);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Xt=Object.prototype.hasOwnProperty,Rt=l.unstable_scheduleCallback,Ns=l.unstable_cancelCallback,Js=l.unstable_shouldYield,ps=l.unstable_requestPaint,ds=l.unstable_now,Ie=l.unstable_getCurrentPriorityLevel,dt=l.unstable_ImmediatePriority,Tt=l.unstable_UserBlockingPriority,ms=l.unstable_NormalPriority,nn=l.unstable_LowPriority,rr=l.unstable_IdlePriority,$l=l.log,ln=l.unstable_setDisableYieldValue,Vn=null,_a=null;function Er(i){if(typeof $l=="function"&&ln(i),_a&&typeof _a.setStrictMode=="function")try{_a.setStrictMode(Vn,i)}catch{}}var Br=Math.clz32?Math.clz32:ah,Bo=Math.log,ql=Math.LN2;function ah(i){return i>>>=0,i===0?32:31-(Bo(i)/ql|0)|0}var zo=256,_i=262144,Ba=4194304;function Wn(i){var c=i&42;if(c!==0)return c;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Zt(i,c,f){var p=i.pendingLanes;if(p===0)return 0;var C=0,A=i.suspendedLanes,U=i.pingedLanes;i=i.warmLanes;var ee=p&134217727;return ee!==0?(p=ee&~A,p!==0?C=Wn(p):(U&=ee,U!==0?C=Wn(U):f||(f=ee&~i,f!==0&&(C=Wn(f))))):(ee=p&~A,ee!==0?C=Wn(ee):U!==0?C=Wn(U):f||(f=p&~i,f!==0&&(C=Wn(f)))),C===0?0:c!==0&&c!==C&&(c&A)===0&&(A=C&-C,f=c&-c,A>=f||A===32&&(f&4194048)!==0)?c:C}function Yl(i,c){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&c)===0}function Ds(i,c){switch(i){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wr(){var i=Ba;return Ba<<=1,(Ba&62914560)===0&&(Ba=4194304),i}function Yc(i){for(var c=[],f=0;31>f;f++)c.push(i);return c}function $n(i,c){i.pendingLanes|=c,c!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Fi(i,c,f,p,C,A){var U=i.pendingLanes;i.pendingLanes=f,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=f,i.entangledLanes&=f,i.errorRecoveryDisabledLanes&=f,i.shellSuspendCounter=0;var ee=i.entanglements,je=i.expirationTimes,Ye=i.hiddenUpdates;for(f=U&~f;0<f;){var ut=31-Br(f),mt=1<<ut;ee[ut]=0,je[ut]=-1;var et=Ye[ut];if(et!==null)for(Ye[ut]=null,ut=0;ut<et.length;ut++){var lt=et[ut];lt!==null&&(lt.lane&=-536870913)}f&=~mt}p!==0&&Gl(i,p,0),A!==0&&C===0&&i.tag!==0&&(i.suspendedLanes|=A&~(U&~c))}function Gl(i,c,f){i.pendingLanes|=c,i.suspendedLanes&=~c;var p=31-Br(c);i.entangledLanes|=c,i.entanglements[p]=i.entanglements[p]|1073741824|f&261930}function Dr(i,c){var f=i.entangledLanes|=c;for(i=i.entanglements;f;){var p=31-Br(f),C=1<<p;C&c|i[p]&c&&(i[p]|=c),f&=~C}}function ul(i,c){var f=c&-c;return f=(f&42)!==0?1:hl(f),(f&(i.suspendedLanes|c))!==0?0:f}function hl(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Mi(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Li(){var i=_e.p;return i!==0?i:(i=window.event,i===void 0?32:Ce(i.type))}function $r(i,c){var f=_e.p;try{return _e.p=i,c()}finally{_e.p=f}}var Fa=Math.random().toString(36).slice(2),oa="__reactFiber$"+Fa,Ts="__reactProps$"+Fa,ur="__reactContainer$"+Fa,Ys="__reactEvents$"+Fa,jr="__reactListeners$"+Fa,on="__reactHandles$"+Fa,di="__reactResources$"+Fa,Cn="__reactMarker$"+Fa;function fl(i){delete i[oa],delete i[Ts],delete i[Ys],delete i[jr],delete i[on]}function Na(i){var c=i[oa];if(c)return c;for(var f=i.parentNode;f;){if(c=f[ur]||f[oa]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(i=zg(i);i!==null;){if(f=i[oa])return f;i=zg(i)}return c}i=f,f=i.parentNode}return null}function cn(i){if(i=i[oa]||i[ur]){var c=i.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return i}return null}function Sn(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i.stateNode;throw Error(o(33))}function ca(i){var c=i[di];return c||(c=i[di]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function qr(i){i[Cn]=!0}var zr=new Set,Ma={};function ui(i,c){cs(i,c),cs(i+"Capture",c)}function cs(i,c){for(Ma[i]=c,i=0;i<c.length;i++)zr.add(c[i])}var Gc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),hi={},Nr={};function kr(i){return Xt.call(Nr,i)?!0:Xt.call(hi,i)?!1:Gc.test(i)?Nr[i]=!0:(hi[i]=!0,!1)}function Uo(i,c,f){if(kr(c))if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":i.removeAttribute(c);return;case"boolean":var p=c.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(c);return}}i.setAttribute(c,""+f)}}function Mr(i,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttribute(c,""+f)}}function qn(i,c,f,p){if(p===null)i.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(f);return}i.setAttributeNS(c,f,""+p)}}function Ka(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function gs(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function An(i,c,f){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,c);if(!i.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var C=p.get,A=p.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return C.call(this)},set:function(U){f=""+U,A.call(this,U)}}),Object.defineProperty(i,c,{enumerable:p.enumerable}),{getValue:function(){return f},setValue:function(U){f=""+U},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function dn(i){if(!i._valueTracker){var c=gs(i)?"checked":"value";i._valueTracker=An(i,c,""+i[c])}}function Kc(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var f=c.getValue(),p="";return i&&(p=gs(i)?i.checked?"true":"false":i.value),i=p,i!==f?(c.setValue(i),!0):!1}function Kl(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Yn=/[\n"\\]/g;function ys(i){return i.replace(Yn,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function fi(i,c,f,p,C,A,U,ee){i.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?i.type=U:i.removeAttribute("type"),c!=null?U==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+Ka(c)):i.value!==""+Ka(c)&&(i.value=""+Ka(c)):U!=="submit"&&U!=="reset"||i.removeAttribute("value"),c!=null?Gs(i,U,Ka(c)):f!=null?Gs(i,U,Ka(f)):p!=null&&i.removeAttribute("value"),C==null&&A!=null&&(i.defaultChecked=!!A),C!=null&&(i.checked=C&&typeof C!="function"&&typeof C!="symbol"),ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?i.name=""+Ka(ee):i.removeAttribute("name")}function Qc(i,c,f,p,C,A,U,ee){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.type=A),c!=null||f!=null){if(!(A!=="submit"&&A!=="reset"||c!=null)){dn(i);return}f=f!=null?""+Ka(f):"",c=c!=null?""+Ka(c):f,ee||c===i.value||(i.value=c),i.defaultValue=c}p=p??C,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=ee?i.checked:!!p,i.defaultChecked=!!p,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(i.name=U),dn(i)}function Gs(i,c,f){c==="number"&&Kl(i.ownerDocument)===i||i.defaultValue===""+f||(i.defaultValue=""+f)}function mi(i,c,f,p){if(i=i.options,c){c={};for(var C=0;C<f.length;C++)c["$"+f[C]]=!0;for(f=0;f<i.length;f++)C=c.hasOwnProperty("$"+i[f].value),i[f].selected!==C&&(i[f].selected=C),C&&p&&(i[f].defaultSelected=!0)}else{for(f=""+Ka(f),c=null,C=0;C<i.length;C++){if(i[C].value===f){i[C].selected=!0,p&&(i[C].defaultSelected=!0);return}c!==null||i[C].disabled||(c=i[C])}c!==null&&(c.selected=!0)}}function Ho(i,c,f){if(c!=null&&(c=""+Ka(c),c!==i.value&&(i.value=c),f==null)){i.defaultValue!==c&&(i.defaultValue=c);return}i.defaultValue=f!=null?""+Ka(f):""}function Vo(i,c,f,p){if(c==null){if(p!=null){if(f!=null)throw Error(o(92));if(Te(p)){if(1<p.length)throw Error(o(93));p=p[0]}f=p}f==null&&(f=""),c=f}f=Ka(c),i.defaultValue=f,p=i.textContent,p===f&&p!==""&&p!==null&&(i.value=p),dn(i)}function Ri(i,c){if(c){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=c;return}}i.textContent=c}var l0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function o0(i,c,f){var p=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?p?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="":p?i.setProperty(c,f):typeof f!="number"||f===0||l0.has(c)?c==="float"?i.cssFloat=f:i[c]=(""+f).trim():i[c]=f+"px"}function hr(i,c,f){if(c!=null&&typeof c!="object")throw Error(o(62));if(i=i.style,f!=null){for(var p in f)!f.hasOwnProperty(p)||c!=null&&c.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var C in c)p=c[C],c.hasOwnProperty(C)&&f[C]!==p&&o0(i,C,p)}else for(var A in c)c.hasOwnProperty(A)&&o0(i,A,c[A])}function K(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ge=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),nt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ue(i){return nt.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Xe(){}var ze=null;function qe(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ke=null,Be=null;function Ot(i){var c=cn(i);if(c&&(i=c.stateNode)){var f=i[Ts]||null;e:switch(i=c.stateNode,c.type){case"input":if(fi(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+ys(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var p=f[c];if(p!==i&&p.form===i.form){var C=p[Ts]||null;if(!C)throw Error(o(90));fi(p,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name)}}for(c=0;c<f.length;c++)p=f[c],p.form===i.form&&Kc(p)}break e;case"textarea":Ho(i,f.value,f.defaultValue);break e;case"select":c=f.value,c!=null&&mi(i,!!f.multiple,c,!1)}}}var zt=!1;function Pt(i,c,f){if(zt)return i(c,f);zt=!0;try{var p=i(c);return p}finally{if(zt=!1,(Ke!==null||Be!==null)&&(wu(),Ke&&(c=Ke,i=Be,Be=Ke=null,Ot(c),i)))for(c=0;c<i.length;c++)Ot(i[c])}}function ht(i,c){var f=i.stateNode;if(f===null)return null;var p=f[Ts]||null;if(p===null)return null;f=p[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(o(231,c,typeof f));return f}var qt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cs=!1;if(qt)try{var _s={};Object.defineProperty(_s,"passive",{get:function(){Cs=!0}}),window.addEventListener("test",_s,_s),window.removeEventListener("test",_s,_s)}catch{Cs=!1}var ws=null,kt=null,Oi=null;function c0(){if(Oi)return Oi;var i,c=kt,f=c.length,p,C="value"in ws?ws.value:ws.textContent,A=C.length;for(i=0;i<f&&c[i]===C[i];i++);var U=f-i;for(p=1;p<=U&&c[f-p]===C[A-p];p++);return Oi=C.slice(i,1<p?1-p:void 0)}function ml(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function Yr(){return!0}function gl(){return!1}function Cr(i){function c(f,p,C,A,U){this._reactName=f,this._targetInst=C,this.type=p,this.nativeEvent=A,this.target=U,this.currentTarget=null;for(var ee in i)i.hasOwnProperty(ee)&&(f=i[ee],this[ee]=f?f(A):A[ee]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Yr:gl,this.isPropagationStopped=gl,this}return D(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Yr)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Yr)},persist:function(){},isPersistent:Yr}),c}var pl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xc=Cr(pl),Wo=D({},pl,{view:0,detail:0}),ym=Cr(Wo),d0,u0,$o,Jc=D({},Wo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uh,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==$o&&($o&&i.type==="mousemove"?(d0=i.screenX-$o.screenX,u0=i.screenY-$o.screenY):u0=d0=0,$o=i),d0)},movementY:function(i){return"movementY"in i?i.movementY:u0}}),nh=Cr(Jc),vm=D({},Jc,{dataTransfer:0}),wm=Cr(vm),h0=D({},Wo,{relatedTarget:0}),f0=Cr(h0),qo=D({},pl,{animationName:0,elapsedTime:0,pseudoElement:0}),ih=Cr(qo),lh=D({},pl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),oh=Cr(lh),ch=D({},pl,{data:0}),m0=Cr(ch),g0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pi(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=Yo[i])?!!c[i]:!1}function uh(){return Pi}var ga=D({},Wo,{key:function(i){if(i.key){var c=g0[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=ml(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?dh[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uh,charCode:function(i){return i.type==="keypress"?ml(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ml(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Ql=Cr(ga),zp=D({},Jc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Go=Cr(zp),Up=D({},Wo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uh}),Hp=Cr(Up),Vp=D({},pl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wp=Cr(Vp),jm=D({},Jc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ka=Cr(jm),La=D({},pl,{newState:0,oldState:0}),gt=Cr(La),Ii=[9,13,27,32],Ra=qt&&"CompositionEvent"in window,yt=null;qt&&"documentMode"in document&&(yt=document.documentMode);var Zc=qt&&"TextEvent"in window&&!yt,hh=qt&&(!Ra||yt&&8<yt&&11>=yt),Ko=" ",p0=!1;function x0(i,c){switch(i){case"keyup":return Ii.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ur(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var xl=!1;function Tr(i,c){switch(i){case"compositionend":return Ur(c);case"keypress":return c.which!==32?null:(p0=!0,Ko);case"textInput":return i=c.data,i===Ko&&p0?null:i;default:return null}}function Hr(i,c){if(xl)return i==="compositionend"||!Ra&&x0(i,c)?(i=c0(),Oi=kt=ws=null,xl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return hh&&c.locale!=="ko"?null:c.data;default:return null}}var vs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Oa(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!vs[i.type]:c==="textarea"}function Ss(i,c,f,p){Ke?Be?Be.push(p):Be=[p]:Ke=p,c=Vd(c,"onChange"),0<c.length&&(f=new Xc("onChange","change",null,f,p),i.push({event:f,listeners:c}))}var Ls=null,ed=null;function gi(i){Og(i,0)}function Gn(i){var c=Sn(i);if(Kc(c))return i}function fh(i,c){if(i==="change")return c}var Xl=!1;if(qt){var un;if(qt){var pa="oninput"in document;if(!pa){var da=document.createElement("div");da.setAttribute("oninput","return;"),pa=typeof da.oninput=="function"}un=pa}else un=!1;Xl=un&&(!document.documentMode||9<document.documentMode)}function b0(){Ls&&(Ls.detachEvent("onpropertychange",Nm),ed=Ls=null)}function Nm(i){if(i.propertyName==="value"&&Gn(ed)){var c=[];Ss(c,ed,i,qe(i)),Pt(gi,c)}}function $p(i,c,f){i==="focusin"?(b0(),Ls=c,ed=f,Ls.attachEvent("onpropertychange",Nm)):i==="focusout"&&b0()}function En(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Gn(ed)}function Jl(i,c){if(i==="click")return Gn(c)}function Zl(i,c){if(i==="input"||i==="change")return Gn(c)}function eo(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var hn=typeof Object.is=="function"?Object.is:eo;function Qo(i,c){if(hn(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var f=Object.keys(i),p=Object.keys(c);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var C=f[p];if(!Xt.call(c,C)||!hn(i[C],c[C]))return!1}return!0}function y0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function td(i,c){var f=y0(i);i=0;for(var p;f;){if(f.nodeType===3){if(p=i+f.textContent.length,i<=c&&p>=c)return{node:f,offset:c-i};i=p}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=y0(f)}}function km(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?km(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function v0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var c=Kl(i.document);c instanceof i.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)i=c.contentWindow;else break;c=Kl(i.document)}return c}function sd(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}var mh=qt&&"documentMode"in document&&11>=document.documentMode,to=null,w0=null,Kn=null,bl=!1;function Ca(i,c,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;bl||to==null||to!==Kl(p)||(p=to,"selectionStart"in p&&sd(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Kn&&Qo(Kn,p)||(Kn=p,p=Vd(w0,"onSelect"),0<p.length&&(c=new Xc("onSelect","select",null,c,f),i.push({event:c,listeners:p}),c.target=to)))}function Dn(i,c){var f={};return f[i.toLowerCase()]=c.toLowerCase(),f["Webkit"+i]="webkit"+c,f["Moz"+i]="moz"+c,f}var Bi={animationend:Dn("Animation","AnimationEnd"),animationiteration:Dn("Animation","AnimationIteration"),animationstart:Dn("Animation","AnimationStart"),transitionrun:Dn("Transition","TransitionRun"),transitionstart:Dn("Transition","TransitionStart"),transitioncancel:Dn("Transition","TransitionCancel"),transitionend:Dn("Transition","TransitionEnd")},j0={},N0={};qt&&(N0=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function sa(i){if(j0[i])return j0[i];if(!Bi[i])return i;var c=Bi[i],f;for(f in c)if(c.hasOwnProperty(f)&&f in N0)return j0[i]=c[f];return i}var gh=sa("animationend"),ph=sa("animationiteration"),Cm=sa("animationstart"),xh=sa("transitionrun"),bh=sa("transitionstart"),Sm=sa("transitioncancel"),Am=sa("transitionend"),Xo=new Map,Qn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qn.push("scrollEnd");function Tn(i,c){Xo.set(i,c),ui(c,[i])}var Jo=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},za=[],yl=0,k0=0;function ks(){for(var i=yl,c=k0=yl=0;c<i;){var f=za[c];za[c++]=null;var p=za[c];za[c++]=null;var C=za[c];za[c++]=null;var A=za[c];if(za[c++]=null,p!==null&&C!==null){var U=p.pending;U===null?C.next=C:(C.next=U.next,U.next=C),p.pending=C}A!==0&&nr(f,C,A)}}function vl(i,c,f,p){za[yl++]=i,za[yl++]=c,za[yl++]=f,za[yl++]=p,k0|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function so(i,c,f,p){return vl(i,c,f,p),C0(i)}function _n(i,c){return vl(i,null,null,c),C0(i)}function nr(i,c,f){i.lanes|=f;var p=i.alternate;p!==null&&(p.lanes|=f);for(var C=!1,A=i.return;A!==null;)A.childLanes|=f,p=A.alternate,p!==null&&(p.childLanes|=f),A.tag===22&&(i=A.stateNode,i===null||i._visibility&1||(C=!0)),i=A,A=A.return;return i.tag===3?(A=i.stateNode,C&&c!==null&&(C=31-Br(f),i=A.hiddenUpdates,p=i[C],p===null?i[C]=[c]:p.push(c),c.lane=f|536870912),A):null}function C0(i){if(50<Rd)throw Rd=0,Od=null,Error(o(185));for(var c=i.return;c!==null;)i=c,c=i.return;return i.tag===3?i.stateNode:null}var ro={};function Em(i,c,f,p){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lr(i,c,f,p){return new Em(i,c,f,p)}function yh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function pi(i,c){var f=i.alternate;return f===null?(f=Lr(i.tag,c,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=c,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&65011712,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,c=i.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f.refCleanup=i.refCleanup,f}function S0(i,c){i.flags&=65011714;var f=i.alternate;return f===null?(i.childLanes=0,i.lanes=c,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=f.childLanes,i.lanes=f.lanes,i.child=f.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=f.memoizedProps,i.memoizedState=f.memoizedState,i.updateQueue=f.updateQueue,i.type=f.type,c=f.dependencies,i.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),i}function rd(i,c,f,p,C,A){var U=0;if(p=i,typeof i=="function")yh(i)&&(U=1);else if(typeof i=="string")U=Ut(i,f,Se.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case ue:return i=Lr(31,f,c,C),i.elementType=ue,i.lanes=A,i;case O:return fn(f.children,C,A,c);case P:U=8,C|=24;break;case G:return i=Lr(12,f,c,C|2),i.elementType=G,i.lanes=A,i;case xe:return i=Lr(13,f,c,C),i.elementType=xe,i.lanes=A,i;case we:return i=Lr(19,f,c,C),i.elementType=we,i.lanes=A,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case re:U=10;break e;case ae:U=9;break e;case Ne:U=11;break e;case Z:U=14;break e;case ce:U=16,p=null;break e}U=29,f=Error(o(130,i===null?"null":typeof i,"")),p=null}return c=Lr(U,f,c,C),c.elementType=i,c.type=p,c.lanes=A,c}function fn(i,c,f,p){return i=Lr(7,i,p,c),i.lanes=f,i}function A0(i,c,f){return i=Lr(6,i,null,c),i.lanes=f,i}function vh(i){var c=Lr(18,null,null,0);return c.stateNode=i,c}function E0(i,c,f){return c=Lr(4,i.children!==null?i.children:[],i.key,c),c.lanes=f,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}var Dm=new WeakMap;function mn(i,c){if(typeof i=="object"&&i!==null){var f=Dm.get(i);return f!==void 0?f:(c={value:i,source:c,stack:st(c)},Dm.set(i,c),c)}return{value:i,source:c,stack:st(c)}}var ao=[],wl=0,Zo=null,ec=0,gn=[],pn=0,zi=null,xi=1,Xn="";function bi(i,c){ao[wl++]=ec,ao[wl++]=Zo,Zo=i,ec=c}function ad(i,c,f){gn[pn++]=xi,gn[pn++]=Xn,gn[pn++]=zi,zi=i;var p=xi;i=Xn;var C=32-Br(p)-1;p&=~(1<<C),f+=1;var A=32-Br(c)+C;if(30<A){var U=C-C%5;A=(p&(1<<U)-1).toString(32),p>>=U,C-=U,xi=1<<32-Br(c)+C|f<<C|p,Xn=A+i}else xi=1<<A|f<<C|p,Xn=i}function D0(i){i.return!==null&&(bi(i,1),ad(i,1,0))}function T0(i){for(;i===Zo;)Zo=ao[--wl],ao[wl]=null,ec=ao[--wl],ao[wl]=null;for(;i===zi;)zi=gn[--pn],gn[pn]=null,Xn=gn[--pn],gn[pn]=null,xi=gn[--pn],gn[pn]=null}function wh(i,c){gn[pn++]=xi,gn[pn++]=Xn,gn[pn++]=zi,xi=c.id,Xn=c.overflow,zi=i}var xa=null,Sr=null,Vs=!1,Ua=null,er=!1,Sa=Error(o(519));function xr(i){var c=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Hi(mn(c,i)),Sa}function xn(i){var c=i.stateNode,f=i.type,p=i.memoizedProps;switch(c[oa]=i,c[Ts]=p,f){case"dialog":hs("cancel",c),hs("close",c);break;case"iframe":case"object":case"embed":hs("load",c);break;case"video":case"audio":for(f=0;f<Ao.length;f++)hs(Ao[f],c);break;case"source":hs("error",c);break;case"img":case"image":case"link":hs("error",c),hs("load",c);break;case"details":hs("toggle",c);break;case"input":hs("invalid",c),Qc(c,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":hs("invalid",c);break;case"textarea":hs("invalid",c),Vo(c,p.value,p.defaultValue,p.children)}f=p.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||p.suppressHydrationWarning===!0||Df(c.textContent,f)?(p.popover!=null&&(hs("beforetoggle",c),hs("toggle",c)),p.onScroll!=null&&hs("scroll",c),p.onScrollEnd!=null&&hs("scrollend",c),p.onClick!=null&&(c.onclick=Xe),c=!0):c=!1,c||xr(i,!0)}function jh(i){for(xa=i.return;xa;)switch(xa.tag){case 5:case 31:case 13:er=!1;return;case 27:case 3:er=!0;return;default:xa=xa.return}}function no(i){if(i!==xa)return!1;if(!Vs)return jh(i),Vs=!0,!1;var c=i.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=i.type,f=!(f!=="form"&&f!=="button")||Dc(i.type,i.memoizedProps)),f=!f),f&&Sr&&xr(i),jh(i),c===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(o(317));Sr=$s(i)}else if(c===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(o(317));Sr=$s(i)}else c===27?(c=Sr,ll(i.type)?(i=Pl,Pl=null,Sr=i):Sr=c):Sr=xa?kn(i.stateNode.nextSibling):null;return!0}function Jn(){Sr=xa=null,Vs=!1}function Ui(){var i=Ua;return i!==null&&(Xa===null?Xa=i:Xa.push.apply(Xa,i),Ua=null),i}function Hi(i){Ua===null?Ua=[i]:Ua.push(i)}var Vi=W(null),jl=null,Wi=null;function Zn(i,c,f){Me(Vi,c._currentValue),c._currentValue=f}function yi(i){i._currentValue=Vi.current,pe(Vi)}function _0(i,c,f){for(;i!==null;){var p=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),i===f)break;i=i.return}}function F0(i,c,f,p){var C=i.child;for(C!==null&&(C.return=i);C!==null;){var A=C.dependencies;if(A!==null){var U=C.child;A=A.firstContext;e:for(;A!==null;){var ee=A;A=C;for(var je=0;je<c.length;je++)if(ee.context===c[je]){A.lanes|=f,ee=A.alternate,ee!==null&&(ee.lanes|=f),_0(A.return,f,i),p||(U=null);break e}A=ee.next}}else if(C.tag===18){if(U=C.return,U===null)throw Error(o(341));U.lanes|=f,A=U.alternate,A!==null&&(A.lanes|=f),_0(U,f,i),U=null}else U=C.child;if(U!==null)U.return=C;else for(U=C;U!==null;){if(U===i){U=null;break}if(C=U.sibling,C!==null){C.return=U.return,U=C;break}U=U.return}C=U}}function Ha(i,c,f,p){i=null;for(var C=c,A=!1;C!==null;){if(!A){if((C.flags&524288)!==0)A=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var U=C.alternate;if(U===null)throw Error(o(387));if(U=U.memoizedProps,U!==null){var ee=C.type;hn(C.pendingProps.value,U.value)||(i!==null?i.push(ee):i=[ee])}}else if(C===Q.current){if(U=C.alternate,U===null)throw Error(o(387));U.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(i!==null?i.push(Wt):i=[Wt])}C=C.return}i!==null&&F0(c,i,f,p),c.flags|=262144}function vi(i){for(i=i.firstContext;i!==null;){if(!hn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Nl(i){jl=i,Wi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function ra(i){return Nh(jl,i)}function nd(i,c){return jl===null&&Nl(i),Nh(i,c)}function Nh(i,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},Wi===null){if(i===null)throw Error(o(308));Wi=c,i.dependencies={lanes:0,firstContext:c},i.flags|=524288}else Wi=Wi.next=c;return f}var qp=typeof AbortController<"u"?AbortController:function(){var i=[],c=this.signal={aborted:!1,addEventListener:function(f,p){i.push(p)}};this.abort=function(){c.aborted=!0,i.forEach(function(f){return f()})}},Tm=l.unstable_scheduleCallback,Pa=l.unstable_NormalPriority,aa={$$typeof:re,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function tc(){return{controller:new qp,data:new Map,refCount:0}}function io(i){i.refCount--,i.refCount===0&&Tm(Pa,function(){i.controller.abort()})}var id=null,M0=0,lo=0,oo=null;function _m(i,c){if(id===null){var f=id=[];M0=0,lo=zs(),oo={status:"pending",value:void 0,then:function(p){f.push(p)}}}return M0++,c.then(kh,kh),c}function kh(){if(--M0===0&&id!==null){oo!==null&&(oo.status="fulfilled");var i=id;id=null,lo=0,oo=null;for(var c=0;c<i.length;c++)(0,i[c])()}}function Fm(i,c){var f=[],p={status:"pending",value:null,reason:null,then:function(C){f.push(C)}};return i.then(function(){p.status="fulfilled",p.value=c;for(var C=0;C<f.length;C++)(0,f[C])(c)},function(C){for(p.status="rejected",p.reason=C,C=0;C<f.length;C++)(0,f[C])(void 0)}),p}var Mm=fe.S;fe.S=function(i,c){yg=ds(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&_m(i,c),Mm!==null&&Mm(i,c)};var kl=W(null);function L0(){var i=kl.current;return i!==null?i:br.pooledCache}function ld(i,c){c===null?Me(kl,kl.current):Me(kl,c.pool)}function Lm(){var i=L0();return i===null?null:{parent:aa._currentValue,pool:i}}var sc=Error(o(460)),R0=Error(o(474)),O0=Error(o(542)),P0={then:function(){}};function Ch(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Sh(i,c,f){switch(f=i[f],f===void 0?i.push(c):f!==c&&(c.then(Xe,Xe),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Ah(i),i;default:if(typeof c.status=="string")c.then(Xe,Xe);else{if(i=br,i!==null&&100<i.shellSuspendCounter)throw Error(o(482));i=c,i.status="pending",i.then(function(p){if(c.status==="pending"){var C=c;C.status="fulfilled",C.value=p}},function(p){if(c.status==="pending"){var C=c;C.status="rejected",C.reason=p}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Ah(i),i}throw co=c,sc}}function wi(i){try{var c=i._init;return c(i._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(co=f,sc):f}}var co=null;function I0(){if(co===null)throw Error(o(459));var i=co;return co=null,i}function Ah(i){if(i===sc||i===O0)throw Error(o(483))}var $i=null,rc=0;function od(i){var c=rc;return rc+=1,$i===null&&($i=[]),Sh($i,i,c)}function ac(i,c){c=c.props.ref,i.ref=c!==void 0?c:null}function cd(i,c){throw c.$$typeof===L?Error(o(525)):(i=Object.prototype.toString.call(c),Error(o(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i)))}function dd(i){function c($e,Re){if(i){var tt=$e.deletions;tt===null?($e.deletions=[Re],$e.flags|=16):tt.push(Re)}}function f($e,Re){if(!i)return null;for(;Re!==null;)c($e,Re),Re=Re.sibling;return null}function p($e){for(var Re=new Map;$e!==null;)$e.key!==null?Re.set($e.key,$e):Re.set($e.index,$e),$e=$e.sibling;return Re}function C($e,Re){return $e=pi($e,Re),$e.index=0,$e.sibling=null,$e}function A($e,Re,tt){return $e.index=tt,i?(tt=$e.alternate,tt!==null?(tt=tt.index,tt<Re?($e.flags|=67108866,Re):tt):($e.flags|=67108866,Re)):($e.flags|=1048576,Re)}function U($e){return i&&$e.alternate===null&&($e.flags|=67108866),$e}function ee($e,Re,tt,bt){return Re===null||Re.tag!==6?(Re=A0(tt,$e.mode,bt),Re.return=$e,Re):(Re=C(Re,tt),Re.return=$e,Re)}function je($e,Re,tt,bt){var fs=tt.type;return fs===O?ut($e,Re,tt.props.children,bt,tt.key):Re!==null&&(Re.elementType===fs||typeof fs=="object"&&fs!==null&&fs.$$typeof===ce&&wi(fs)===Re.type)?(Re=C(Re,tt.props),ac(Re,tt),Re.return=$e,Re):(Re=rd(tt.type,tt.key,tt.props,null,$e.mode,bt),ac(Re,tt),Re.return=$e,Re)}function Ye($e,Re,tt,bt){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==tt.containerInfo||Re.stateNode.implementation!==tt.implementation?(Re=E0(tt,$e.mode,bt),Re.return=$e,Re):(Re=C(Re,tt.children||[]),Re.return=$e,Re)}function ut($e,Re,tt,bt,fs){return Re===null||Re.tag!==7?(Re=fn(tt,$e.mode,bt,fs),Re.return=$e,Re):(Re=C(Re,tt),Re.return=$e,Re)}function mt($e,Re,tt){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Re=A0(""+Re,$e.mode,tt),Re.return=$e,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case M:return tt=rd(Re.type,Re.key,Re.props,null,$e.mode,tt),ac(tt,Re),tt.return=$e,tt;case F:return Re=E0(Re,$e.mode,tt),Re.return=$e,Re;case ce:return Re=wi(Re),mt($e,Re,tt)}if(Te(Re)||oe(Re))return Re=fn(Re,$e.mode,tt,null),Re.return=$e,Re;if(typeof Re.then=="function")return mt($e,od(Re),tt);if(Re.$$typeof===re)return mt($e,nd($e,Re),tt);cd($e,Re)}return null}function et($e,Re,tt,bt){var fs=Re!==null?Re.key:null;if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return fs!==null?null:ee($e,Re,""+tt,bt);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case M:return tt.key===fs?je($e,Re,tt,bt):null;case F:return tt.key===fs?Ye($e,Re,tt,bt):null;case ce:return tt=wi(tt),et($e,Re,tt,bt)}if(Te(tt)||oe(tt))return fs!==null?null:ut($e,Re,tt,bt,null);if(typeof tt.then=="function")return et($e,Re,od(tt),bt);if(tt.$$typeof===re)return et($e,Re,nd($e,tt),bt);cd($e,tt)}return null}function lt($e,Re,tt,bt,fs){if(typeof bt=="string"&&bt!==""||typeof bt=="number"||typeof bt=="bigint")return $e=$e.get(tt)||null,ee(Re,$e,""+bt,fs);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case M:return $e=$e.get(bt.key===null?tt:bt.key)||null,je(Re,$e,bt,fs);case F:return $e=$e.get(bt.key===null?tt:bt.key)||null,Ye(Re,$e,bt,fs);case ce:return bt=wi(bt),lt($e,Re,tt,bt,fs)}if(Te(bt)||oe(bt))return $e=$e.get(tt)||null,ut(Re,$e,bt,fs,null);if(typeof bt.then=="function")return lt($e,Re,tt,od(bt),fs);if(bt.$$typeof===re)return lt($e,Re,tt,nd(Re,bt),fs);cd(Re,bt)}return null}function ts($e,Re,tt,bt){for(var fs=null,lr=null,ls=Re,Bs=Re=0,Qs=null;ls!==null&&Bs<tt.length;Bs++){ls.index>Bs?(Qs=ls,ls=null):Qs=ls.sibling;var or=et($e,ls,tt[Bs],bt);if(or===null){ls===null&&(ls=Qs);break}i&&ls&&or.alternate===null&&c($e,ls),Re=A(or,Re,Bs),lr===null?fs=or:lr.sibling=or,lr=or,ls=Qs}if(Bs===tt.length)return f($e,ls),Vs&&bi($e,Bs),fs;if(ls===null){for(;Bs<tt.length;Bs++)ls=mt($e,tt[Bs],bt),ls!==null&&(Re=A(ls,Re,Bs),lr===null?fs=ls:lr.sibling=ls,lr=ls);return Vs&&bi($e,Bs),fs}for(ls=p(ls);Bs<tt.length;Bs++)Qs=lt(ls,$e,Bs,tt[Bs],bt),Qs!==null&&(i&&Qs.alternate!==null&&ls.delete(Qs.key===null?Bs:Qs.key),Re=A(Qs,Re,Bs),lr===null?fs=Qs:lr.sibling=Qs,lr=Qs);return i&&ls.forEach(function(_c){return c($e,_c)}),Vs&&bi($e,Bs),fs}function bs($e,Re,tt,bt){if(tt==null)throw Error(o(151));for(var fs=null,lr=null,ls=Re,Bs=Re=0,Qs=null,or=tt.next();ls!==null&&!or.done;Bs++,or=tt.next()){ls.index>Bs?(Qs=ls,ls=null):Qs=ls.sibling;var _c=et($e,ls,or.value,bt);if(_c===null){ls===null&&(ls=Qs);break}i&&ls&&_c.alternate===null&&c($e,ls),Re=A(_c,Re,Bs),lr===null?fs=_c:lr.sibling=_c,lr=_c,ls=Qs}if(or.done)return f($e,ls),Vs&&bi($e,Bs),fs;if(ls===null){for(;!or.done;Bs++,or=tt.next())or=mt($e,or.value,bt),or!==null&&(Re=A(or,Re,Bs),lr===null?fs=or:lr.sibling=or,lr=or);return Vs&&bi($e,Bs),fs}for(ls=p(ls);!or.done;Bs++,or=tt.next())or=lt(ls,$e,Bs,or.value,bt),or!==null&&(i&&or.alternate!==null&&ls.delete(or.key===null?Bs:or.key),Re=A(or,Re,Bs),lr===null?fs=or:lr.sibling=or,lr=or);return i&&ls.forEach(function(Sv){return c($e,Sv)}),Vs&&bi($e,Bs),fs}function Ar($e,Re,tt,bt){if(typeof tt=="object"&&tt!==null&&tt.type===O&&tt.key===null&&(tt=tt.props.children),typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case M:e:{for(var fs=tt.key;Re!==null;){if(Re.key===fs){if(fs=tt.type,fs===O){if(Re.tag===7){f($e,Re.sibling),bt=C(Re,tt.props.children),bt.return=$e,$e=bt;break e}}else if(Re.elementType===fs||typeof fs=="object"&&fs!==null&&fs.$$typeof===ce&&wi(fs)===Re.type){f($e,Re.sibling),bt=C(Re,tt.props),ac(bt,tt),bt.return=$e,$e=bt;break e}f($e,Re);break}else c($e,Re);Re=Re.sibling}tt.type===O?(bt=fn(tt.props.children,$e.mode,bt,tt.key),bt.return=$e,$e=bt):(bt=rd(tt.type,tt.key,tt.props,null,$e.mode,bt),ac(bt,tt),bt.return=$e,$e=bt)}return U($e);case F:e:{for(fs=tt.key;Re!==null;){if(Re.key===fs)if(Re.tag===4&&Re.stateNode.containerInfo===tt.containerInfo&&Re.stateNode.implementation===tt.implementation){f($e,Re.sibling),bt=C(Re,tt.children||[]),bt.return=$e,$e=bt;break e}else{f($e,Re);break}else c($e,Re);Re=Re.sibling}bt=E0(tt,$e.mode,bt),bt.return=$e,$e=bt}return U($e);case ce:return tt=wi(tt),Ar($e,Re,tt,bt)}if(Te(tt))return ts($e,Re,tt,bt);if(oe(tt)){if(fs=oe(tt),typeof fs!="function")throw Error(o(150));return tt=fs.call(tt),bs($e,Re,tt,bt)}if(typeof tt.then=="function")return Ar($e,Re,od(tt),bt);if(tt.$$typeof===re)return Ar($e,Re,nd($e,tt),bt);cd($e,tt)}return typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint"?(tt=""+tt,Re!==null&&Re.tag===6?(f($e,Re.sibling),bt=C(Re,tt),bt.return=$e,$e=bt):(f($e,Re),bt=A0(tt,$e.mode,bt),bt.return=$e,$e=bt),U($e)):f($e,Re)}return function($e,Re,tt,bt){try{rc=0;var fs=Ar($e,Re,tt,bt);return $i=null,fs}catch(ls){if(ls===sc||ls===O0)throw ls;var lr=Lr(29,ls,null,$e.mode);return lr.lanes=bt,lr.return=$e,lr}}}var Cl=dd(!0),Eh=dd(!1),ei=!1;function B0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nc(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Aa(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function qi(i,c,f){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(ar&2)!==0){var C=p.pending;return C===null?c.next=c:(c.next=C.next,C.next=c),p.pending=c,c=C0(i),nr(i,null,f),c}return vl(i,p,c,f),C0(i)}function uo(i,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var p=c.lanes;p&=i.pendingLanes,f|=p,c.lanes=f,Dr(i,f)}}function z0(i,c){var f=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var C=null,A=null;if(f=f.firstBaseUpdate,f!==null){do{var U={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};A===null?C=A=U:A=A.next=U,f=f.next}while(f!==null);A===null?C=A=c:A=A.next=c}else C=A=c;f={baseState:p.baseState,firstBaseUpdate:C,lastBaseUpdate:A,shared:p.shared,callbacks:p.callbacks},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=c:i.next=c,f.lastBaseUpdate=c}var U0=!1;function ic(){if(U0){var i=oo;if(i!==null)throw i}}function ho(i,c,f,p){U0=!1;var C=i.updateQueue;ei=!1;var A=C.firstBaseUpdate,U=C.lastBaseUpdate,ee=C.shared.pending;if(ee!==null){C.shared.pending=null;var je=ee,Ye=je.next;je.next=null,U===null?A=Ye:U.next=Ye,U=je;var ut=i.alternate;ut!==null&&(ut=ut.updateQueue,ee=ut.lastBaseUpdate,ee!==U&&(ee===null?ut.firstBaseUpdate=Ye:ee.next=Ye,ut.lastBaseUpdate=je))}if(A!==null){var mt=C.baseState;U=0,ut=Ye=je=null,ee=A;do{var et=ee.lane&-536870913,lt=et!==ee.lane;if(lt?(Ws&et)===et:(p&et)===et){et!==0&&et===lo&&(U0=!0),ut!==null&&(ut=ut.next={lane:0,tag:ee.tag,payload:ee.payload,callback:null,next:null});e:{var ts=i,bs=ee;et=c;var Ar=f;switch(bs.tag){case 1:if(ts=bs.payload,typeof ts=="function"){mt=ts.call(Ar,mt,et);break e}mt=ts;break e;case 3:ts.flags=ts.flags&-65537|128;case 0:if(ts=bs.payload,et=typeof ts=="function"?ts.call(Ar,mt,et):ts,et==null)break e;mt=D({},mt,et);break e;case 2:ei=!0}}et=ee.callback,et!==null&&(i.flags|=64,lt&&(i.flags|=8192),lt=C.callbacks,lt===null?C.callbacks=[et]:lt.push(et))}else lt={lane:et,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},ut===null?(Ye=ut=lt,je=mt):ut=ut.next=lt,U|=et;if(ee=ee.next,ee===null){if(ee=C.shared.pending,ee===null)break;lt=ee,ee=lt.next,lt.next=null,C.lastBaseUpdate=lt,C.shared.pending=null}}while(!0);ut===null&&(je=mt),C.baseState=je,C.firstBaseUpdate=Ye,C.lastBaseUpdate=ut,A===null&&(C.shared.lanes=0),rl|=U,i.lanes=U,i.memoizedState=mt}}function Dh(i,c){if(typeof i!="function")throw Error(o(191,i));i.call(c)}function H0(i,c){var f=i.callbacks;if(f!==null)for(i.callbacks=null,i=0;i<f.length;i++)Dh(f[i],c)}var Yi=W(null),Gi=W(0);function Th(i,c){i=sl,Me(Gi,i),Me(Yi,c),sl=i|c.baseLanes}function V0(){Me(Gi,sl),Me(Yi,Yi.current)}function _h(){sl=Gi.current,pe(Yi),pe(Gi)}var bn=W(null),yn=null;function ti(i){var c=i.alternate;Me(Gr,Gr.current&1),Me(bn,i),yn===null&&(c===null||Yi.current!==null||c.memoizedState!==null)&&(yn=i)}function ud(i){Me(Gr,Gr.current),Me(bn,i),yn===null&&(yn=i)}function W0(i){i.tag===22?(Me(Gr,Gr.current),Me(bn,i),yn===null&&(yn=i)):Ki()}function Ki(){Me(Gr,Gr.current),Me(bn,bn.current)}function ua(i){pe(bn),yn===i&&(yn=null),pe(Gr)}var Gr=W(0);function lc(i){for(var c=i;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Uu(f)||Tc(f)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Fn=0,As=null,Zs=null,Rr=null,hd=!1,fo=!1,Sl=!1,fd=0,oc=0,mo=null,Rm=0;function Kr(){throw Error(o(321))}function Fh(i,c){if(c===null)return!1;for(var f=0;f<c.length&&f<i.length;f++)if(!hn(i[f],c[f]))return!1;return!0}function $0(i,c,f,p,C,A){return Fn=A,As=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,fe.H=i===null||i.memoizedState===null?Jm:Qh,Sl=!1,A=f(p,C),Sl=!1,fo&&(A=Pm(c,f,p,C)),Om(i),A}function Om(i){fe.H=kd;var c=Zs!==null&&Zs.next!==null;if(Fn=0,Rr=Zs=As=null,hd=!1,oc=0,mo=null,c)throw Error(o(300));i===null||na||(i=i.dependencies,i!==null&&vi(i)&&(na=!0))}function Pm(i,c,f,p){As=i;var C=0;do{if(fo&&(mo=null),oc=0,fo=!1,25<=C)throw Error(o(301));if(C+=1,Rr=Zs=null,i.updateQueue!=null){var A=i.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}fe.H=Zm,A=c(f,p)}while(fo);return A}function Yp(){var i=fe.H,c=i.useState()[0];return c=typeof c.then=="function"?gd(c):c,i=i.useState()[0],(Zs!==null?Zs.memoizedState:null)!==i&&(As.flags|=1024),c}function Mh(){var i=fd!==0;return fd=0,i}function Lh(i,c,f){c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~f}function md(i){if(hd){for(i=i.memoizedState;i!==null;){var c=i.queue;c!==null&&(c.pending=null),i=i.next}hd=!1}Fn=0,Rr=Zs=As=null,fo=!1,oc=fd=0,mo=null}function Va(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rr===null?As.memoizedState=Rr=i:Rr=Rr.next=i,Rr}function Jr(){if(Zs===null){var i=As.alternate;i=i!==null?i.memoizedState:null}else i=Zs.next;var c=Rr===null?As.memoizedState:Rr.next;if(c!==null)Rr=c,Zs=i;else{if(i===null)throw As.alternate===null?Error(o(467)):Error(o(310));Zs=i,i={memoizedState:Zs.memoizedState,baseState:Zs.baseState,baseQueue:Zs.baseQueue,queue:Zs.queue,next:null},Rr===null?As.memoizedState=Rr=i:Rr=Rr.next=i}return Rr}function q0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gd(i){var c=oc;return oc+=1,mo===null&&(mo=[]),i=Sh(mo,i,c),c=As,(Rr===null?c.memoizedState:Rr.next)===null&&(c=c.alternate,fe.H=c===null||c.memoizedState===null?Jm:Qh),i}function pd(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return gd(i);if(i.$$typeof===re)return ra(i)}throw Error(o(438,String(i)))}function Rh(i){var c=null,f=As.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var p=As.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(c={data:p.data.map(function(C){return C.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=q0(),As.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(i),p=0;p<i;p++)f[p]=Le;return c.index++,f}function Qi(i,c){return typeof c=="function"?c(i):c}function xd(i){var c=Jr();return si(c,Zs,i)}function si(i,c,f){var p=i.queue;if(p===null)throw Error(o(311));p.lastRenderedReducer=f;var C=i.baseQueue,A=p.pending;if(A!==null){if(C!==null){var U=C.next;C.next=A.next,A.next=U}c.baseQueue=C=A,p.pending=null}if(A=i.baseState,C===null)i.memoizedState=A;else{c=C.next;var ee=U=null,je=null,Ye=c,ut=!1;do{var mt=Ye.lane&-536870913;if(mt!==Ye.lane?(Ws&mt)===mt:(Fn&mt)===mt){var et=Ye.revertLane;if(et===0)je!==null&&(je=je.next={lane:0,revertLane:0,gesture:null,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),mt===lo&&(ut=!0);else if((Fn&et)===et){Ye=Ye.next,et===lo&&(ut=!0);continue}else mt={lane:0,revertLane:Ye.revertLane,gesture:null,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null},je===null?(ee=je=mt,U=A):je=je.next=mt,As.lanes|=et,rl|=et;mt=Ye.action,Sl&&f(A,mt),A=Ye.hasEagerState?Ye.eagerState:f(A,mt)}else et={lane:mt,revertLane:Ye.revertLane,gesture:Ye.gesture,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null},je===null?(ee=je=et,U=A):je=je.next=et,As.lanes|=mt,rl|=mt;Ye=Ye.next}while(Ye!==null&&Ye!==c);if(je===null?U=A:je.next=ee,!hn(A,i.memoizedState)&&(na=!0,ut&&(f=oo,f!==null)))throw f;i.memoizedState=A,i.baseState=U,i.baseQueue=je,p.lastRenderedState=A}return C===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function Oh(i){var c=Jr(),f=c.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=i;var p=f.dispatch,C=f.pending,A=c.memoizedState;if(C!==null){f.pending=null;var U=C=C.next;do A=i(A,U.action),U=U.next;while(U!==C);hn(A,c.memoizedState)||(na=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),f.lastRenderedState=A}return[A,p]}function Im(i,c,f){var p=As,C=Jr(),A=Vs;if(A){if(f===void 0)throw Error(o(407));f=f()}else f=c();var U=!hn((Zs||C).memoizedState,f);if(U&&(C.memoizedState=f,na=!0),C=C.queue,vd(Bm.bind(null,p,C,i),[i]),C.getSnapshot!==c||U||Rr!==null&&Rr.memoizedState.tag&1){if(p.flags|=2048,Zr(9,{destroy:void 0},Ih.bind(null,p,C,f,c),null),br===null)throw Error(o(349));A||(Fn&127)!==0||Ph(p,c,f)}return f}function Ph(i,c,f){i.flags|=16384,i={getSnapshot:c,value:f},c=As.updateQueue,c===null?(c=q0(),As.updateQueue=c,c.stores=[i]):(f=c.stores,f===null?c.stores=[i]:f.push(i))}function Ih(i,c,f,p){c.value=f,c.getSnapshot=p,Y0(c)&&G0(i)}function Bm(i,c,f){return f(function(){Y0(c)&&G0(i)})}function Y0(i){var c=i.getSnapshot;i=i.value;try{var f=c();return!hn(i,f)}catch{return!0}}function G0(i){var c=_n(i,2);c!==null&&Ya(c,i,2)}function K0(i){var c=Va();if(typeof i=="function"){var f=i;if(i=f(),Sl){Er(!0);try{f()}finally{Er(!1)}}}return c.memoizedState=c.baseState=i,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:i},c}function Bh(i,c,f,p){return i.baseState=f,si(i,Zs,typeof p=="function"?p:Qi)}function zm(i,c,f,p,C){if(eu(i))throw Error(o(485));if(i=c.action,i!==null){var A={payload:C,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){A.listeners.push(U)}};fe.T!==null?f(!0):A.isTransition=!1,p(A),f=c.pending,f===null?(A.next=c.pending=A,go(c,A)):(A.next=f.next,c.pending=f.next=A)}}function go(i,c){var f=c.action,p=c.payload,C=i.state;if(c.isTransition){var A=fe.T,U={};fe.T=U;try{var ee=f(C,p),je=fe.S;je!==null&&je(U,ee),Um(i,c,ee)}catch(Ye){Q0(i,c,Ye)}finally{A!==null&&U.types!==null&&(A.types=U.types),fe.T=A}}else try{A=f(C,p),Um(i,c,A)}catch(Ye){Q0(i,c,Ye)}}function Um(i,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(p){Hm(i,c,p)},function(p){return Q0(i,c,p)}):Hm(i,c,f)}function Hm(i,c,f){c.status="fulfilled",c.value=f,zh(c),i.state=f,c=i.pending,c!==null&&(f=c.next,f===c?i.pending=null:(f=f.next,c.next=f,go(i,f)))}function Q0(i,c,f){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do c.status="rejected",c.reason=f,zh(c),c=c.next;while(c!==p)}i.action=null}function zh(i){i=i.listeners;for(var c=0;c<i.length;c++)(0,i[c])()}function bd(i,c){return c}function cc(i,c){if(Vs){var f=br.formState;if(f!==null){e:{var p=As;if(Vs){if(Sr){t:{for(var C=Sr,A=er;C.nodeType!==8;){if(!A){C=null;break t}if(C=kn(C.nextSibling),C===null){C=null;break t}}A=C.data,C=A==="F!"||A==="F"?C:null}if(C){Sr=kn(C.nextSibling),p=C.data==="F!";break e}}xr(p)}p=!1}p&&(c=f[0])}}return f=Va(),f.memoizedState=f.baseState=c,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bd,lastRenderedState:c},f.queue=p,f=fc.bind(null,As,p),p.dispatch=f,p=K0(!1),A=Kh.bind(null,As,!1,p.queue),p=Va(),C={state:c,dispatch:null,action:i,pending:null},p.queue=C,f=zm.bind(null,As,C,A,f),C.dispatch=f,p.memoizedState=i,[c,f,!1]}function yd(i){var c=Jr();return Uh(c,Zs,i)}function Uh(i,c,f){if(c=si(i,c,bd)[0],i=xd(Qi)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var p=gd(c)}catch(U){throw U===sc?O0:U}else p=c;c=Jr();var C=c.queue,A=C.dispatch;return f!==c.memoizedState&&(As.flags|=2048,Zr(9,{destroy:void 0},Gp.bind(null,C,f),null)),[p,A,i]}function Gp(i,c){i.action=c}function Vm(i){var c=Jr(),f=Zs;if(f!==null)return Uh(c,f,i);Jr(),c=c.memoizedState,f=Jr();var p=f.queue.dispatch;return f.memoizedState=i,[c,p,!1]}function Zr(i,c,f,p){return i={tag:i,create:f,deps:p,inst:c,next:null},c=As.updateQueue,c===null&&(c=q0(),As.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=i.next=i:(p=f.next,f.next=i,i.next=p,c.lastEffect=i),i}function dc(){return Jr().memoizedState}function Al(i,c,f,p){var C=Va();As.flags|=i,C.memoizedState=Zr(1|c,{destroy:void 0},f,p===void 0?null:p)}function po(i,c,f,p){var C=Jr();p=p===void 0?null:p;var A=C.memoizedState.inst;Zs!==null&&p!==null&&Fh(p,Zs.memoizedState.deps)?C.memoizedState=Zr(c,A,f,p):(As.flags|=i,C.memoizedState=Zr(1|c,A,f,p))}function X0(i,c){Al(8390656,8,i,c)}function vd(i,c){po(2048,8,i,c)}function El(i){As.flags|=4;var c=As.updateQueue;if(c===null)c=q0(),As.updateQueue=c,c.events=[i];else{var f=c.events;f===null?c.events=[i]:f.push(i)}}function Hh(i){var c=Jr().memoizedState;return El({ref:c,nextImpl:i}),function(){if((ar&2)!==0)throw Error(o(440));return c.impl.apply(void 0,arguments)}}function uc(i,c){return po(4,2,i,c)}function xo(i,c){return po(4,4,i,c)}function Wm(i,c){if(typeof c=="function"){i=i();var f=c(i);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function wd(i,c,f){f=f!=null?f.concat([i]):null,po(4,4,Wm.bind(null,c,i),f)}function hc(){}function Vh(i,c){var f=Jr();c=c===void 0?null:c;var p=f.memoizedState;return c!==null&&Fh(c,p[1])?p[0]:(f.memoizedState=[i,c],i)}function Wh(i,c){var f=Jr();c=c===void 0?null:c;var p=f.memoizedState;if(c!==null&&Fh(c,p[1]))return p[0];if(p=i(),Sl){Er(!0);try{i()}finally{Er(!1)}}return f.memoizedState=[p,c],p}function J0(i,c,f){return f===void 0||(Fn&1073741824)!==0&&(Ws&261930)===0?i.memoizedState=c:(i.memoizedState=f,i=vg(),As.lanes|=i,rl|=i,f)}function $h(i,c,f,p){return hn(f,c)?f:Yi.current!==null?(i=J0(i,f,p),hn(i,c)||(na=!0),i):(Fn&42)===0||(Fn&1073741824)!==0&&(Ws&261930)===0?(na=!0,i.memoizedState=f):(i=vg(),As.lanes|=i,rl|=i,c)}function qh(i,c,f,p,C){var A=_e.p;_e.p=A!==0&&8>A?A:8;var U=fe.T,ee={};fe.T=ee,Kh(i,!1,c,f);try{var je=C(),Ye=fe.S;if(Ye!==null&&Ye(ee,je),je!==null&&typeof je=="object"&&typeof je.then=="function"){var ut=Fm(je,p);Nd(i,c,ut,qa(i))}else Nd(i,c,p,qa(i))}catch(mt){Nd(i,c,{then:function(){},status:"rejected",reason:mt},qa())}finally{_e.p=A,U!==null&&ee.types!==null&&(U.types=ee.types),fe.T=U}}function jd(){}function Yh(i,c,f,p){if(i.tag!==5)throw Error(o(476));var C=Gh(i).queue;qh(i,C,c,We,f===null?jd:function(){return $m(i),f(p)})}function Gh(i){var c=i.memoizedState;if(c!==null)return c;c={memoizedState:We,baseState:We,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:We},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:f},next:null},i.memoizedState=c,i=i.alternate,i!==null&&(i.memoizedState=c),c}function $m(i){var c=Gh(i);c.next===null&&(c=i.alternate.memoizedState),Nd(i,c.next.queue,{},qa())}function Z0(){return ra(Wt)}function qm(){return Jr().memoizedState}function Ym(){return Jr().memoizedState}function Gm(i){for(var c=i.return;c!==null;){switch(c.tag){case 24:case 3:var f=qa();i=Aa(f);var p=qi(c,i,f);p!==null&&(Ya(p,c,f),uo(p,c,f)),c={cache:tc()},i.payload=c;return}c=c.return}}function Km(i,c,f){var p=qa();f={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},eu(i)?Qm(c,f):(f=so(i,c,f,p),f!==null&&(Ya(f,i,p),Xm(f,c,p)))}function fc(i,c,f){var p=qa();Nd(i,c,f,p)}function Nd(i,c,f,p){var C={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(eu(i))Qm(c,C);else{var A=i.alternate;if(i.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var U=c.lastRenderedState,ee=A(U,f);if(C.hasEagerState=!0,C.eagerState=ee,hn(ee,U))return vl(i,c,C,0),br===null&&ks(),!1}catch{}if(f=so(i,c,C,p),f!==null)return Ya(f,i,p),Xm(f,c,p),!0}return!1}function Kh(i,c,f,p){if(p={lane:2,revertLane:zs(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},eu(i)){if(c)throw Error(o(479))}else c=so(i,f,p,2),c!==null&&Ya(c,i,2)}function eu(i){var c=i.alternate;return i===As||c!==null&&c===As}function Qm(i,c){fo=hd=!0;var f=i.pending;f===null?c.next=c:(c.next=f.next,f.next=c),i.pending=c}function Xm(i,c,f){if((f&4194048)!==0){var p=c.lanes;p&=i.pendingLanes,f|=p,c.lanes=f,Dr(i,f)}}var kd={readContext:ra,use:pd,useCallback:Kr,useContext:Kr,useEffect:Kr,useImperativeHandle:Kr,useLayoutEffect:Kr,useInsertionEffect:Kr,useMemo:Kr,useReducer:Kr,useRef:Kr,useState:Kr,useDebugValue:Kr,useDeferredValue:Kr,useTransition:Kr,useSyncExternalStore:Kr,useId:Kr,useHostTransitionStatus:Kr,useFormState:Kr,useActionState:Kr,useOptimistic:Kr,useMemoCache:Kr,useCacheRefresh:Kr};kd.useEffectEvent=Kr;var Jm={readContext:ra,use:pd,useCallback:function(i,c){return Va().memoizedState=[i,c===void 0?null:c],i},useContext:ra,useEffect:X0,useImperativeHandle:function(i,c,f){f=f!=null?f.concat([i]):null,Al(4194308,4,Wm.bind(null,c,i),f)},useLayoutEffect:function(i,c){return Al(4194308,4,i,c)},useInsertionEffect:function(i,c){Al(4,2,i,c)},useMemo:function(i,c){var f=Va();c=c===void 0?null:c;var p=i();if(Sl){Er(!0);try{i()}finally{Er(!1)}}return f.memoizedState=[p,c],p},useReducer:function(i,c,f){var p=Va();if(f!==void 0){var C=f(c);if(Sl){Er(!0);try{f(c)}finally{Er(!1)}}}else C=c;return p.memoizedState=p.baseState=C,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:C},p.queue=i,i=i.dispatch=Km.bind(null,As,i),[p.memoizedState,i]},useRef:function(i){var c=Va();return i={current:i},c.memoizedState=i},useState:function(i){i=K0(i);var c=i.queue,f=fc.bind(null,As,c);return c.dispatch=f,[i.memoizedState,f]},useDebugValue:hc,useDeferredValue:function(i,c){var f=Va();return J0(f,i,c)},useTransition:function(){var i=K0(!1);return i=qh.bind(null,As,i.queue,!0,!1),Va().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,c,f){var p=As,C=Va();if(Vs){if(f===void 0)throw Error(o(407));f=f()}else{if(f=c(),br===null)throw Error(o(349));(Ws&127)!==0||Ph(p,c,f)}C.memoizedState=f;var A={value:f,getSnapshot:c};return C.queue=A,X0(Bm.bind(null,p,A,i),[i]),p.flags|=2048,Zr(9,{destroy:void 0},Ih.bind(null,p,A,f,c),null),f},useId:function(){var i=Va(),c=br.identifierPrefix;if(Vs){var f=Xn,p=xi;f=(p&~(1<<32-Br(p)-1)).toString(32)+f,c="_"+c+"R_"+f,f=fd++,0<f&&(c+="H"+f.toString(32)),c+="_"}else f=Rm++,c="_"+c+"r_"+f.toString(32)+"_";return i.memoizedState=c},useHostTransitionStatus:Z0,useFormState:cc,useActionState:cc,useOptimistic:function(i){var c=Va();c.memoizedState=c.baseState=i;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=Kh.bind(null,As,!0,f),f.dispatch=c,[i,c]},useMemoCache:Rh,useCacheRefresh:function(){return Va().memoizedState=Gm.bind(null,As)},useEffectEvent:function(i){var c=Va(),f={impl:i};return c.memoizedState=f,function(){if((ar&2)!==0)throw Error(o(440));return f.impl.apply(void 0,arguments)}}},Qh={readContext:ra,use:pd,useCallback:Vh,useContext:ra,useEffect:vd,useImperativeHandle:wd,useInsertionEffect:uc,useLayoutEffect:xo,useMemo:Wh,useReducer:xd,useRef:dc,useState:function(){return xd(Qi)},useDebugValue:hc,useDeferredValue:function(i,c){var f=Jr();return $h(f,Zs.memoizedState,i,c)},useTransition:function(){var i=xd(Qi)[0],c=Jr().memoizedState;return[typeof i=="boolean"?i:gd(i),c]},useSyncExternalStore:Im,useId:qm,useHostTransitionStatus:Z0,useFormState:yd,useActionState:yd,useOptimistic:function(i,c){var f=Jr();return Bh(f,Zs,i,c)},useMemoCache:Rh,useCacheRefresh:Ym};Qh.useEffectEvent=Hh;var Zm={readContext:ra,use:pd,useCallback:Vh,useContext:ra,useEffect:vd,useImperativeHandle:wd,useInsertionEffect:uc,useLayoutEffect:xo,useMemo:Wh,useReducer:Oh,useRef:dc,useState:function(){return Oh(Qi)},useDebugValue:hc,useDeferredValue:function(i,c){var f=Jr();return Zs===null?J0(f,i,c):$h(f,Zs.memoizedState,i,c)},useTransition:function(){var i=Oh(Qi)[0],c=Jr().memoizedState;return[typeof i=="boolean"?i:gd(i),c]},useSyncExternalStore:Im,useId:qm,useHostTransitionStatus:Z0,useFormState:Vm,useActionState:Vm,useOptimistic:function(i,c){var f=Jr();return Zs!==null?Bh(f,Zs,i,c):(f.baseState=i,[i,f.queue.dispatch])},useMemoCache:Rh,useCacheRefresh:Ym};Zm.useEffectEvent=Hh;function Xh(i,c,f,p){c=i.memoizedState,f=f(p,c),f=f==null?c:D({},c,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var Jh={enqueueSetState:function(i,c,f){i=i._reactInternals;var p=qa(),C=Aa(p);C.payload=c,f!=null&&(C.callback=f),c=qi(i,C,p),c!==null&&(Ya(c,i,p),uo(c,i,p))},enqueueReplaceState:function(i,c,f){i=i._reactInternals;var p=qa(),C=Aa(p);C.tag=1,C.payload=c,f!=null&&(C.callback=f),c=qi(i,C,p),c!==null&&(Ya(c,i,p),uo(c,i,p))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var f=qa(),p=Aa(f);p.tag=2,c!=null&&(p.callback=c),c=qi(i,p,f),c!==null&&(Ya(c,i,f),uo(c,i,f))}};function eg(i,c,f,p,C,A,U){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,A,U):c.prototype&&c.prototype.isPureReactComponent?!Qo(f,p)||!Qo(C,A):!0}function tg(i,c,f,p){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,p),c.state!==i&&Jh.enqueueReplaceState(c,c.state,null)}function Dl(i,c){var f=c;if("ref"in c){f={};for(var p in c)p!=="ref"&&(f[p]=c[p])}if(i=i.defaultProps){f===c&&(f=D({},f));for(var C in i)f[C]===void 0&&(f[C]=i[C])}return f}function tu(i){Jo(i)}function sg(i){console.error(i)}function rg(i){Jo(i)}function su(i,c){try{var f=i.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(p){setTimeout(function(){throw p})}}function Zh(i,c,f){try{var p=i.onCaughtError;p(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function Tl(i,c,f){return f=Aa(f),f.tag=3,f.payload={element:null},f.callback=function(){su(i,c)},f}function ef(i){return i=Aa(i),i.tag=3,i}function tf(i,c,f,p){var C=f.type.getDerivedStateFromError;if(typeof C=="function"){var A=p.value;i.payload=function(){return C(A)},i.callback=function(){Zh(c,f,p)}}var U=f.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(i.callback=function(){Zh(c,f,p),typeof C!="function"&&(Ll===null?Ll=new Set([this]):Ll.add(this));var ee=p.stack;this.componentDidCatch(p.value,{componentStack:ee!==null?ee:""})})}function ag(i,c,f,p,C){if(f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(c=f.alternate,c!==null&&Ha(c,f,C,!0),f=bn.current,f!==null){switch(f.tag){case 31:case 13:return yn===null?ju():f.alternate===null&&Vr===0&&(Vr=3),f.flags&=-257,f.flags|=65536,f.lanes=C,p===P0?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([p]):c.add(p),ku(i,p,C)),!1;case 22:return f.flags|=65536,p===P0?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([p])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([p]):f.add(p)),ku(i,p,C)),!1}throw Error(o(435,f.tag))}return ku(i,p,C),ju(),!1}if(Vs)return c=bn.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=C,p!==Sa&&(i=Error(o(422),{cause:p}),Hi(mn(i,f)))):(p!==Sa&&(c=Error(o(423),{cause:p}),Hi(mn(c,f))),i=i.current.alternate,i.flags|=65536,C&=-C,i.lanes|=C,p=mn(p,f),C=Tl(i.stateNode,p,C),z0(i,C),Vr!==4&&(Vr=2)),!1;var A=Error(o(520),{cause:p});if(A=mn(A,f),Ld===null?Ld=[A]:Ld.push(A),Vr!==4&&(Vr=2),c===null)return!0;p=mn(p,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,i=C&-C,f.lanes|=i,i=Tl(f.stateNode,p,i),z0(f,i),!1;case 1:if(c=f.type,A=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ll===null||!Ll.has(A))))return f.flags|=65536,C&=-C,f.lanes|=C,C=ef(C),tf(C,i,f,p),z0(f,C),!1}f=f.return}while(f!==null);return!1}var sf=Error(o(461)),na=!1;function ba(i,c,f,p){c.child=i===null?Eh(c,null,f,p):Cl(c,i.child,f,p)}function ru(i,c,f,p,C){f=f.render;var A=c.ref;if("ref"in p){var U={};for(var ee in p)ee!=="ref"&&(U[ee]=p[ee])}else U=p;return Nl(c),p=$0(i,c,f,U,A,C),ee=Mh(),i!==null&&!na?(Lh(i,c,C),Xi(i,c,C)):(Vs&&ee&&D0(c),c.flags|=1,ba(i,c,p,C),c.child)}function rf(i,c,f,p,C){if(i===null){var A=f.type;return typeof A=="function"&&!yh(A)&&A.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=A,bo(i,c,A,p,C)):(i=rd(f.type,null,p,c,c.mode,C),i.ref=c.ref,i.return=c,c.child=i)}if(A=i.child,!vo(i,C)){var U=A.memoizedProps;if(f=f.compare,f=f!==null?f:Qo,f(U,p)&&i.ref===c.ref)return Xi(i,c,C)}return c.flags|=1,i=pi(A,p),i.ref=c.ref,i.return=c,c.child=i}function bo(i,c,f,p,C){if(i!==null){var A=i.memoizedProps;if(Qo(A,p)&&i.ref===c.ref)if(na=!1,c.pendingProps=p=A,vo(i,C))(i.flags&131072)!==0&&(na=!0);else return c.lanes=i.lanes,Xi(i,c,C)}return nu(i,c,f,p,C)}function ng(i,c,f,p){var C=p.children,A=i!==null?i.memoizedState:null;if(i===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((c.flags&128)!==0){if(A=A!==null?A.baseLanes|f:f,i!==null){for(p=c.child=i.child,C=0;p!==null;)C=C|p.lanes|p.childLanes,p=p.sibling;p=C&~A}else p=0,c.child=null;return au(i,c,A,f,p)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},i!==null&&ld(c,A!==null?A.cachePool:null),A!==null?Th(c,A):V0(),W0(c);else return p=c.lanes=536870912,au(i,c,A!==null?A.baseLanes|f:f,f,p)}else A!==null?(ld(c,A.cachePool),Th(c,A),Ki(),c.memoizedState=null):(i!==null&&ld(c,null),V0(),Ki());return ba(i,c,C,f),c.child}function yo(i,c){return i!==null&&i.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function au(i,c,f,p,C){var A=L0();return A=A===null?null:{parent:aa._currentValue,pool:A},c.memoizedState={baseLanes:f,cachePool:A},i!==null&&ld(c,null),V0(),W0(c),i!==null&&Ha(i,c,p,!0),c.childLanes=C,null}function Cd(i,c){return c=Ad({mode:c.mode,children:c.children},i.mode),c.ref=i.ref,i.child=c,c.return=i,c}function af(i,c,f){return Cl(c,i.child,null,f),i=Cd(c,c.pendingProps),i.flags|=2,ua(c),c.memoizedState=null,i}function ia(i,c,f){var p=c.pendingProps,C=(c.flags&128)!==0;if(c.flags&=-129,i===null){if(Vs){if(p.mode==="hidden")return i=Cd(c,p),c.lanes=536870912,yo(null,i);if(ud(c),(i=Sr)?(i=zu(i,er),i=i!==null&&i.data==="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:zi!==null?{id:xi,overflow:Xn}:null,retryLane:536870912,hydrationErrors:null},f=vh(i),f.return=c,c.child=f,xa=c,Sr=null)):i=null,i===null)throw xr(c);return c.lanes=536870912,null}return Cd(c,p)}var A=i.memoizedState;if(A!==null){var U=A.dehydrated;if(ud(c),C)if(c.flags&256)c.flags&=-257,c=af(i,c,f);else if(c.memoizedState!==null)c.child=i.child,c.flags|=128,c=null;else throw Error(o(558));else if(na||Ha(i,c,f,!1),C=(f&i.childLanes)!==0,na||C){if(p=br,p!==null&&(U=ul(p,f),U!==0&&U!==A.retryLane))throw A.retryLane=U,_n(i,U),Ya(p,i,U),sf;ju(),c=af(i,c,f)}else i=A.treeContext,Sr=kn(U.nextSibling),xa=c,Vs=!0,Ua=null,er=!1,i!==null&&wh(c,i),c=Cd(c,p),c.flags|=4096;return c}return i=pi(i.child,{mode:p.mode,children:p.children}),i.ref=c.ref,c.child=i,i.return=c,i}function ri(i,c){var f=c.ref;if(f===null)i!==null&&i.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(o(284));(i===null||i.ref!==f)&&(c.flags|=4194816)}}function nu(i,c,f,p,C){return Nl(c),f=$0(i,c,f,p,void 0,C),p=Mh(),i!==null&&!na?(Lh(i,c,C),Xi(i,c,C)):(Vs&&p&&D0(c),c.flags|=1,ba(i,c,f,C),c.child)}function nf(i,c,f,p,C,A){return Nl(c),c.updateQueue=null,f=Pm(c,p,f,C),Om(i),p=Mh(),i!==null&&!na?(Lh(i,c,A),Xi(i,c,A)):(Vs&&p&&D0(c),c.flags|=1,ba(i,c,f,A),c.child)}function lf(i,c,f,p,C){if(Nl(c),c.stateNode===null){var A=ro,U=f.contextType;typeof U=="object"&&U!==null&&(A=ra(U)),A=new f(p,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=Jh,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=p,A.state=c.memoizedState,A.refs={},B0(c),U=f.contextType,A.context=typeof U=="object"&&U!==null?ra(U):ro,A.state=c.memoizedState,U=f.getDerivedStateFromProps,typeof U=="function"&&(Xh(c,f,U,p),A.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(U=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),U!==A.state&&Jh.enqueueReplaceState(A,A.state,null),ho(c,p,A,C),ic(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),p=!0}else if(i===null){A=c.stateNode;var ee=c.memoizedProps,je=Dl(f,ee);A.props=je;var Ye=A.context,ut=f.contextType;U=ro,typeof ut=="object"&&ut!==null&&(U=ra(ut));var mt=f.getDerivedStateFromProps;ut=typeof mt=="function"||typeof A.getSnapshotBeforeUpdate=="function",ee=c.pendingProps!==ee,ut||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(ee||Ye!==U)&&tg(c,A,p,U),ei=!1;var et=c.memoizedState;A.state=et,ho(c,p,A,C),ic(),Ye=c.memoizedState,ee||et!==Ye||ei?(typeof mt=="function"&&(Xh(c,f,mt,p),Ye=c.memoizedState),(je=ei||eg(c,f,je,p,et,Ye,U))?(ut||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=Ye),A.props=p,A.state=Ye,A.context=U,p=je):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{A=c.stateNode,nc(i,c),U=c.memoizedProps,ut=Dl(f,U),A.props=ut,mt=c.pendingProps,et=A.context,Ye=f.contextType,je=ro,typeof Ye=="object"&&Ye!==null&&(je=ra(Ye)),ee=f.getDerivedStateFromProps,(Ye=typeof ee=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==mt||et!==je)&&tg(c,A,p,je),ei=!1,et=c.memoizedState,A.state=et,ho(c,p,A,C),ic();var lt=c.memoizedState;U!==mt||et!==lt||ei||i!==null&&i.dependencies!==null&&vi(i.dependencies)?(typeof ee=="function"&&(Xh(c,f,ee,p),lt=c.memoizedState),(ut=ei||eg(c,f,ut,p,et,lt,je)||i!==null&&i.dependencies!==null&&vi(i.dependencies))?(Ye||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(p,lt,je),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(p,lt,je)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||U===i.memoizedProps&&et===i.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===i.memoizedProps&&et===i.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=lt),A.props=p,A.state=lt,A.context=je,p=ut):(typeof A.componentDidUpdate!="function"||U===i.memoizedProps&&et===i.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===i.memoizedProps&&et===i.memoizedState||(c.flags|=1024),p=!1)}return A=p,ri(i,c),p=(c.flags&128)!==0,A||p?(A=c.stateNode,f=p&&typeof f.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,i!==null&&p?(c.child=Cl(c,i.child,null,C),c.child=Cl(c,null,f,C)):ba(i,c,f,C),c.memoizedState=A.state,i=c.child):i=Xi(i,c,C),i}function ig(i,c,f,p){return Jn(),c.flags|=256,ba(i,c,f,p),c.child}var iu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function lu(i){return{baseLanes:i,cachePool:Lm()}}function of(i,c,f){return i=i!==null?i.childLanes&~f:0,c&&(i|=wn),i}function mc(i,c,f){var p=c.pendingProps,C=!1,A=(c.flags&128)!==0,U;if((U=A)||(U=i!==null&&i.memoizedState===null?!1:(Gr.current&2)!==0),U&&(C=!0,c.flags&=-129),U=(c.flags&32)!==0,c.flags&=-33,i===null){if(Vs){if(C?ti(c):Ki(),(i=Sr)?(i=zu(i,er),i=i!==null&&i.data!=="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:zi!==null?{id:xi,overflow:Xn}:null,retryLane:536870912,hydrationErrors:null},f=vh(i),f.return=c,c.child=f,xa=c,Sr=null)):i=null,i===null)throw xr(c);return Tc(i)?c.lanes=32:c.lanes=536870912,null}var ee=p.children;return p=p.fallback,C?(Ki(),C=c.mode,ee=Ad({mode:"hidden",children:ee},C),p=fn(p,C,f,null),ee.return=c,p.return=c,ee.sibling=p,c.child=ee,p=c.child,p.memoizedState=lu(f),p.childLanes=of(i,U,f),c.memoizedState=iu,yo(null,p)):(ti(c),Sd(c,ee))}var je=i.memoizedState;if(je!==null&&(ee=je.dehydrated,ee!==null)){if(A)c.flags&256?(ti(c),c.flags&=-257,c=cf(i,c,f)):c.memoizedState!==null?(Ki(),c.child=i.child,c.flags|=128,c=null):(Ki(),ee=p.fallback,C=c.mode,p=Ad({mode:"visible",children:p.children},C),ee=fn(ee,C,f,null),ee.flags|=2,p.return=c,ee.return=c,p.sibling=ee,c.child=p,Cl(c,i.child,null,f),p=c.child,p.memoizedState=lu(f),p.childLanes=of(i,U,f),c.memoizedState=iu,c=yo(null,p));else if(ti(c),Tc(ee)){if(U=ee.nextSibling&&ee.nextSibling.dataset,U)var Ye=U.dgst;U=Ye,p=Error(o(419)),p.stack="",p.digest=U,Hi({value:p,source:null,stack:null}),c=cf(i,c,f)}else if(na||Ha(i,c,f,!1),U=(f&i.childLanes)!==0,na||U){if(U=br,U!==null&&(p=ul(U,f),p!==0&&p!==je.retryLane))throw je.retryLane=p,_n(i,p),Ya(U,i,p),sf;Uu(ee)||ju(),c=cf(i,c,f)}else Uu(ee)?(c.flags|=192,c.child=i.child,c=null):(i=je.treeContext,Sr=kn(ee.nextSibling),xa=c,Vs=!0,Ua=null,er=!1,i!==null&&wh(c,i),c=Sd(c,p.children),c.flags|=4096);return c}return C?(Ki(),ee=p.fallback,C=c.mode,je=i.child,Ye=je.sibling,p=pi(je,{mode:"hidden",children:p.children}),p.subtreeFlags=je.subtreeFlags&65011712,Ye!==null?ee=pi(Ye,ee):(ee=fn(ee,C,f,null),ee.flags|=2),ee.return=c,p.return=c,p.sibling=ee,c.child=p,yo(null,p),p=c.child,ee=i.child.memoizedState,ee===null?ee=lu(f):(C=ee.cachePool,C!==null?(je=aa._currentValue,C=C.parent!==je?{parent:je,pool:je}:C):C=Lm(),ee={baseLanes:ee.baseLanes|f,cachePool:C}),p.memoizedState=ee,p.childLanes=of(i,U,f),c.memoizedState=iu,yo(i.child,p)):(ti(c),f=i.child,i=f.sibling,f=pi(f,{mode:"visible",children:p.children}),f.return=c,f.sibling=null,i!==null&&(U=c.deletions,U===null?(c.deletions=[i],c.flags|=16):U.push(i)),c.child=f,c.memoizedState=null,f)}function Sd(i,c){return c=Ad({mode:"visible",children:c},i.mode),c.return=i,i.child=c}function Ad(i,c){return i=Lr(22,i,null,c),i.lanes=0,i}function cf(i,c,f){return Cl(c,i.child,null,f),i=Sd(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function df(i,c,f){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c),_0(i.return,c,f)}function uf(i,c,f,p,C,A){var U=i.memoizedState;U===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:C,treeForkCount:A}:(U.isBackwards=c,U.rendering=null,U.renderingStartTime=0,U.last=p,U.tail=f,U.tailMode=C,U.treeForkCount=A)}function lg(i,c,f){var p=c.pendingProps,C=p.revealOrder,A=p.tail;p=p.children;var U=Gr.current,ee=(U&2)!==0;if(ee?(U=U&1|2,c.flags|=128):U&=1,Me(Gr,U),ba(i,c,p,f),p=Vs?ec:0,!ee&&i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&df(i,f,c);else if(i.tag===19)df(i,f,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(C){case"forwards":for(f=c.child,C=null;f!==null;)i=f.alternate,i!==null&&lc(i)===null&&(C=f),f=f.sibling;f=C,f===null?(C=c.child,c.child=null):(C=f.sibling,f.sibling=null),uf(c,!1,C,f,A,p);break;case"backwards":case"unstable_legacy-backwards":for(f=null,C=c.child,c.child=null;C!==null;){if(i=C.alternate,i!==null&&lc(i)===null){c.child=C;break}i=C.sibling,C.sibling=f,f=C,C=i}uf(c,!0,f,null,A,p);break;case"together":uf(c,!1,null,null,void 0,p);break;default:c.memoizedState=null}return c.child}function Xi(i,c,f){if(i!==null&&(c.dependencies=i.dependencies),rl|=c.lanes,(f&c.childLanes)===0)if(i!==null){if(Ha(i,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(i!==null&&c.child!==i.child)throw Error(o(153));if(c.child!==null){for(i=c.child,f=pi(i,i.pendingProps),c.child=f,f.return=c;i.sibling!==null;)i=i.sibling,f=f.sibling=pi(i,i.pendingProps),f.return=c;f.sibling=null}return c.child}function vo(i,c){return(i.lanes&c)!==0?!0:(i=i.dependencies,!!(i!==null&&vi(i)))}function Ed(i,c,f){switch(c.tag){case 3:te(c,c.stateNode.containerInfo),Zn(c,aa,i.memoizedState.cache),Jn();break;case 27:case 5:ve(c);break;case 4:te(c,c.stateNode.containerInfo);break;case 10:Zn(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,ud(c),null;break;case 13:var p=c.memoizedState;if(p!==null)return p.dehydrated!==null?(ti(c),c.flags|=128,null):(f&c.child.childLanes)!==0?mc(i,c,f):(ti(c),i=Xi(i,c,f),i!==null?i.sibling:null);ti(c);break;case 19:var C=(i.flags&128)!==0;if(p=(f&c.childLanes)!==0,p||(Ha(i,c,f,!1),p=(f&c.childLanes)!==0),C){if(p)return lg(i,c,f);c.flags|=128}if(C=c.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),Me(Gr,Gr.current),p)break;return null;case 22:return c.lanes=0,ng(i,c,f,c.pendingProps);case 24:Zn(c,aa,i.memoizedState.cache)}return Xi(i,c,f)}function og(i,c,f){if(i!==null)if(i.memoizedProps!==c.pendingProps)na=!0;else{if(!vo(i,f)&&(c.flags&128)===0)return na=!1,Ed(i,c,f);na=(i.flags&131072)!==0}else na=!1,Vs&&(c.flags&1048576)!==0&&ad(c,ec,c.index);switch(c.lanes=0,c.tag){case 16:e:{var p=c.pendingProps;if(i=wi(c.elementType),c.type=i,typeof i=="function")yh(i)?(p=Dl(i,p),c.tag=1,c=lf(null,c,i,p,f)):(c.tag=0,c=nu(null,c,i,p,f));else{if(i!=null){var C=i.$$typeof;if(C===Ne){c.tag=11,c=ru(null,c,i,p,f);break e}else if(C===Z){c.tag=14,c=rf(null,c,i,p,f);break e}}throw c=ye(i)||i,Error(o(306,c,""))}}return c;case 0:return nu(i,c,c.type,c.pendingProps,f);case 1:return p=c.type,C=Dl(p,c.pendingProps),lf(i,c,p,C,f);case 3:e:{if(te(c,c.stateNode.containerInfo),i===null)throw Error(o(387));p=c.pendingProps;var A=c.memoizedState;C=A.element,nc(i,c),ho(c,p,null,f);var U=c.memoizedState;if(p=U.cache,Zn(c,aa,p),p!==A.cache&&F0(c,[aa],f,!0),ic(),p=U.element,A.isDehydrated)if(A={element:p,isDehydrated:!1,cache:U.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=ig(i,c,p,f);break e}else if(p!==C){C=mn(Error(o(424)),c),Hi(C),c=ig(i,c,p,f);break e}else for(i=c.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,Sr=kn(i.firstChild),xa=c,Vs=!0,Ua=null,er=!0,f=Eh(c,null,p,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Jn(),p===C){c=Xi(i,c,f);break e}ba(i,c,p,f)}c=c.child}return c;case 26:return ri(i,c),i===null?(f=Y(c.type,null,c.pendingProps,null))?c.memoizedState=f:Vs||(f=c.type,i=c.pendingProps,p=Wd(H.current).createElement(f),p[oa]=c,p[Ts]=i,wa(p,f,i),qr(p),c.stateNode=p):c.memoizedState=Y(c.type,i.memoizedProps,c.pendingProps,i.memoizedState),null;case 27:return ve(c),i===null&&Vs&&(p=c.stateNode=r(c.type,c.pendingProps,H.current),xa=c,er=!0,C=Sr,ll(c.type)?(Pl=C,Sr=kn(p.firstChild)):Sr=C),ba(i,c,c.pendingProps.children,f),ri(i,c),i===null&&(c.flags|=4194304),c.child;case 5:return i===null&&Vs&&((C=p=Sr)&&(p=Bu(p,c.type,c.pendingProps,er),p!==null?(c.stateNode=p,xa=c,Sr=kn(p.firstChild),er=!1,C=!0):C=!1),C||xr(c)),ve(c),C=c.type,A=c.pendingProps,U=i!==null?i.memoizedProps:null,p=A.children,Dc(C,A)?p=null:U!==null&&Dc(C,U)&&(c.flags|=32),c.memoizedState!==null&&(C=$0(i,c,Yp,null,null,f),Wt._currentValue=C),ri(i,c),ba(i,c,p,f),c.child;case 6:return i===null&&Vs&&((i=f=Sr)&&(f=Pf(f,c.pendingProps,er),f!==null?(c.stateNode=f,xa=c,Sr=null,i=!0):i=!1),i||xr(c)),null;case 13:return mc(i,c,f);case 4:return te(c,c.stateNode.containerInfo),p=c.pendingProps,i===null?c.child=Cl(c,null,p,f):ba(i,c,p,f),c.child;case 11:return ru(i,c,c.type,c.pendingProps,f);case 7:return ba(i,c,c.pendingProps,f),c.child;case 8:return ba(i,c,c.pendingProps.children,f),c.child;case 12:return ba(i,c,c.pendingProps.children,f),c.child;case 10:return p=c.pendingProps,Zn(c,c.type,p.value),ba(i,c,p.children,f),c.child;case 9:return C=c.type._context,p=c.pendingProps.children,Nl(c),C=ra(C),p=p(C),c.flags|=1,ba(i,c,p,f),c.child;case 14:return rf(i,c,c.type,c.pendingProps,f);case 15:return bo(i,c,c.type,c.pendingProps,f);case 19:return lg(i,c,f);case 31:return ia(i,c,f);case 22:return ng(i,c,f,c.pendingProps);case 24:return Nl(c),p=ra(aa),i===null?(C=L0(),C===null&&(C=br,A=tc(),C.pooledCache=A,A.refCount++,A!==null&&(C.pooledCacheLanes|=f),C=A),c.memoizedState={parent:p,cache:C},B0(c),Zn(c,aa,C)):((i.lanes&f)!==0&&(nc(i,c),ho(c,null,null,f),ic()),C=i.memoizedState,A=c.memoizedState,C.parent!==p?(C={parent:p,cache:p},c.memoizedState=C,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=C),Zn(c,aa,p)):(p=A.cache,Zn(c,aa,p),p!==C.cache&&F0(c,[aa],f,!0))),ba(i,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(o(156,c.tag))}function ji(i){i.flags|=4}function ou(i,c,f,p,C){if((c=(i.mode&32)!==0)&&(c=!1),c){if(i.flags|=16777216,(C&335544128)===C)if(i.stateNode.complete)i.flags|=8192;else if(Ng())i.flags|=8192;else throw co=P0,R0}else i.flags&=-16777217}function Ia(i,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Ft(c))if(Ng())i.flags|=8192;else throw co=P0,R0}function gc(i,c){c!==null&&(i.flags|=4),i.flags&16384&&(c=i.tag!==22?wr():536870912,i.lanes|=c,Nc|=c)}function Dd(i,c){if(!Vs)switch(i.tailMode){case"hidden":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function fr(i){var c=i.alternate!==null&&i.alternate.child===i.child,f=0,p=0;if(c)for(var C=i.child;C!==null;)f|=C.lanes|C.childLanes,p|=C.subtreeFlags&65011712,p|=C.flags&65011712,C.return=i,C=C.sibling;else for(C=i.child;C!==null;)f|=C.lanes|C.childLanes,p|=C.subtreeFlags,p|=C.flags,C.return=i,C=C.sibling;return i.subtreeFlags|=p,i.childLanes=f,c}function Kp(i,c,f){var p=c.pendingProps;switch(T0(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fr(c),null;case 1:return fr(c),null;case 3:return f=c.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),yi(aa),de(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(no(c)?ji(c):i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ui())),fr(c),null;case 26:var C=c.type,A=c.memoizedState;return i===null?(ji(c),A!==null?(fr(c),Ia(c,A)):(fr(c),ou(c,C,null,p,f))):A?A!==i.memoizedState?(ji(c),fr(c),Ia(c,A)):(fr(c),c.flags&=-16777217):(i=i.memoizedProps,i!==p&&ji(c),fr(c),ou(c,C,i,p,f)),null;case 27:if(ke(c),f=H.current,C=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&ji(c);else{if(!p){if(c.stateNode===null)throw Error(o(166));return fr(c),null}i=Se.current,no(c)?xn(c):(i=r(C,p,f),c.stateNode=i,ji(c))}return fr(c),null;case 5:if(ke(c),C=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&ji(c);else{if(!p){if(c.stateNode===null)throw Error(o(166));return fr(c),null}if(A=Se.current,no(c))xn(c);else{var U=Wd(H.current);switch(A){case 1:A=U.createElementNS("http://www.w3.org/2000/svg",C);break;case 2:A=U.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;default:switch(C){case"svg":A=U.createElementNS("http://www.w3.org/2000/svg",C);break;case"math":A=U.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;case"script":A=U.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof p.is=="string"?U.createElement("select",{is:p.is}):U.createElement("select"),p.multiple?A.multiple=!0:p.size&&(A.size=p.size);break;default:A=typeof p.is=="string"?U.createElement(C,{is:p.is}):U.createElement(C)}}A[oa]=c,A[Ts]=p;e:for(U=c.child;U!==null;){if(U.tag===5||U.tag===6)A.appendChild(U.stateNode);else if(U.tag!==4&&U.tag!==27&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===c)break e;for(;U.sibling===null;){if(U.return===null||U.return===c)break e;U=U.return}U.sibling.return=U.return,U=U.sibling}c.stateNode=A;e:switch(wa(A,C,p),C){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&ji(c)}}return fr(c),ou(c,c.type,i===null?null:i.memoizedProps,c.pendingProps,f),null;case 6:if(i&&c.stateNode!=null)i.memoizedProps!==p&&ji(c);else{if(typeof p!="string"&&c.stateNode===null)throw Error(o(166));if(i=H.current,no(c)){if(i=c.stateNode,f=c.memoizedProps,p=null,C=xa,C!==null)switch(C.tag){case 27:case 5:p=C.memoizedProps}i[oa]=c,i=!!(i.nodeValue===f||p!==null&&p.suppressHydrationWarning===!0||Df(i.nodeValue,f)),i||xr(c,!0)}else i=Wd(i).createTextNode(p),i[oa]=c,c.stateNode=i}return fr(c),null;case 31:if(f=c.memoizedState,i===null||i.memoizedState!==null){if(p=no(c),f!==null){if(i===null){if(!p)throw Error(o(318));if(i=c.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(o(557));i[oa]=c}else Jn(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;fr(c),i=!1}else f=Ui(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=f),i=!0;if(!i)return c.flags&256?(ua(c),c):(ua(c),null);if((c.flags&128)!==0)throw Error(o(558))}return fr(c),null;case 13:if(p=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(C=no(c),p!==null&&p.dehydrated!==null){if(i===null){if(!C)throw Error(o(318));if(C=c.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(o(317));C[oa]=c}else Jn(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;fr(c),C=!1}else C=Ui(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=C),C=!0;if(!C)return c.flags&256?(ua(c),c):(ua(c),null)}return ua(c),(c.flags&128)!==0?(c.lanes=f,c):(f=p!==null,i=i!==null&&i.memoizedState!==null,f&&(p=c.child,C=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(C=p.alternate.memoizedState.cachePool.pool),A=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(A=p.memoizedState.cachePool.pool),A!==C&&(p.flags|=2048)),f!==i&&f&&(c.child.flags|=8192),gc(c,c.updateQueue),fr(c),null);case 4:return de(),i===null&&Af(c.stateNode.containerInfo),fr(c),null;case 10:return yi(c.type),fr(c),null;case 19:if(pe(Gr),p=c.memoizedState,p===null)return fr(c),null;if(C=(c.flags&128)!==0,A=p.rendering,A===null)if(C)Dd(p,!1);else{if(Vr!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(A=lc(i),A!==null){for(c.flags|=128,Dd(p,!1),i=A.updateQueue,c.updateQueue=i,gc(c,i),c.subtreeFlags=0,i=f,f=c.child;f!==null;)S0(f,i),f=f.sibling;return Me(Gr,Gr.current&1|2),Vs&&bi(c,p.treeForkCount),c.child}i=i.sibling}p.tail!==null&&ds()>xu&&(c.flags|=128,C=!0,Dd(p,!1),c.lanes=4194304)}else{if(!C)if(i=lc(A),i!==null){if(c.flags|=128,C=!0,i=i.updateQueue,c.updateQueue=i,gc(c,i),Dd(p,!0),p.tail===null&&p.tailMode==="hidden"&&!A.alternate&&!Vs)return fr(c),null}else 2*ds()-p.renderingStartTime>xu&&f!==536870912&&(c.flags|=128,C=!0,Dd(p,!1),c.lanes=4194304);p.isBackwards?(A.sibling=c.child,c.child=A):(i=p.last,i!==null?i.sibling=A:c.child=A,p.last=A)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=ds(),i.sibling=null,f=Gr.current,Me(Gr,C?f&1|2:f&1),Vs&&bi(c,p.treeForkCount),i):(fr(c),null);case 22:case 23:return ua(c),_h(),p=c.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(c.flags|=8192):p&&(c.flags|=8192),p?(f&536870912)!==0&&(c.flags&128)===0&&(fr(c),c.subtreeFlags&6&&(c.flags|=8192)):fr(c),f=c.updateQueue,f!==null&&gc(c,f.retryQueue),f=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048),i!==null&&pe(kl),null;case 24:return f=null,i!==null&&(f=i.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),yi(aa),fr(c),null;case 25:return null;case 30:return null}throw Error(o(156,c.tag))}function cu(i,c){switch(T0(c),c.tag){case 1:return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return yi(aa),de(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 26:case 27:case 5:return ke(c),null;case 31:if(c.memoizedState!==null){if(ua(c),c.alternate===null)throw Error(o(340));Jn()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 13:if(ua(c),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(o(340));Jn()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return pe(Gr),null;case 4:return de(),null;case 10:return yi(c.type),null;case 22:case 23:return ua(c),_h(),i!==null&&pe(kl),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 24:return yi(aa),null;case 25:return null;default:return null}}function cg(i,c){switch(T0(c),c.tag){case 3:yi(aa),de();break;case 26:case 27:case 5:ke(c);break;case 4:de();break;case 31:c.memoizedState!==null&&ua(c);break;case 13:ua(c);break;case 19:pe(Gr);break;case 10:yi(c.type);break;case 22:case 23:ua(c),_h(),i!==null&&pe(kl);break;case 24:yi(aa)}}function Td(i,c){try{var f=c.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var C=p.next;f=C;do{if((f.tag&i)===i){p=void 0;var A=f.create,U=f.inst;p=A(),U.destroy=p}f=f.next}while(f!==C)}}catch(ee){ir(c,c.return,ee)}}function _l(i,c,f){try{var p=c.updateQueue,C=p!==null?p.lastEffect:null;if(C!==null){var A=C.next;p=A;do{if((p.tag&i)===i){var U=p.inst,ee=U.destroy;if(ee!==void 0){U.destroy=void 0,C=c;var je=f,Ye=ee;try{Ye()}catch(ut){ir(C,je,ut)}}}p=p.next}while(p!==A)}}catch(ut){ir(c,c.return,ut)}}function hf(i){var c=i.updateQueue;if(c!==null){var f=i.stateNode;try{H0(c,f)}catch(p){ir(i,i.return,p)}}}function dg(i,c,f){f.props=Dl(i.type,i.memoizedProps),f.state=i.memoizedState;try{f.componentWillUnmount()}catch(p){ir(i,c,p)}}function pc(i,c){try{var f=i.ref;if(f!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof f=="function"?i.refCleanup=f(p):f.current=p}}catch(C){ir(i,c,C)}}function Mn(i,c){var f=i.ref,p=i.refCleanup;if(f!==null)if(typeof p=="function")try{p()}catch(C){ir(i,c,C)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(C){ir(i,c,C)}else f.current=null}function xc(i){var c=i.type,f=i.memoizedProps,p=i.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&p.focus();break e;case"img":f.src?p.src=f.src:f.srcSet&&(p.srcset=f.srcSet)}}catch(C){ir(i,i.return,C)}}function Fl(i,c,f){try{var p=i.stateNode;_f(p,i.type,f,c),p[Ts]=c}catch(C){ir(i,i.return,C)}}function bc(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&ll(i.type)||i.tag===4}function _d(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||bc(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&ll(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function yc(i,c,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(i,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(i),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=Xe));else if(p!==4&&(p===27&&ll(i.type)&&(f=i.stateNode,c=null),i=i.child,i!==null))for(yc(i,c,f),i=i.sibling;i!==null;)yc(i,c,f),i=i.sibling}function Ni(i,c,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?f.insertBefore(i,c):f.appendChild(i);else if(p!==4&&(p===27&&ll(i.type)&&(f=i.stateNode),i=i.child,i!==null))for(Ni(i,c,f),i=i.sibling;i!==null;)Ni(i,c,f),i=i.sibling}function Ji(i){var c=i.stateNode,f=i.memoizedProps;try{for(var p=i.type,C=c.attributes;C.length;)c.removeAttributeNode(C[0]);wa(c,p,f),c[oa]=i,c[Ts]=f}catch(A){ir(i,i.return,A)}}var ki=!1,la=!1,ff=!1,ug=typeof WeakSet=="function"?WeakSet:Set,ya=null;function Qp(i,c){if(i=i.containerInfo,Ec=qs,i=v0(i),sd(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var C=p.anchorOffset,A=p.focusNode;p=p.focusOffset;try{f.nodeType,A.nodeType}catch{f=null;break e}var U=0,ee=-1,je=-1,Ye=0,ut=0,mt=i,et=null;t:for(;;){for(var lt;mt!==f||C!==0&&mt.nodeType!==3||(ee=U+C),mt!==A||p!==0&&mt.nodeType!==3||(je=U+p),mt.nodeType===3&&(U+=mt.nodeValue.length),(lt=mt.firstChild)!==null;)et=mt,mt=lt;for(;;){if(mt===i)break t;if(et===f&&++Ye===C&&(ee=U),et===A&&++ut===p&&(je=U),(lt=mt.nextSibling)!==null)break;mt=et,et=mt.parentNode}mt=lt}f=ee===-1||je===-1?null:{start:ee,end:je}}else f=null}f=f||{start:0,end:0}}else f=null;for(Mu={focusedElem:i,selectionRange:f},qs=!1,ya=c;ya!==null;)if(c=ya,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,ya=i;else for(;ya!==null;){switch(c=ya,A=c.alternate,i=c.flags,c.tag){case 0:if((i&4)!==0&&(i=c.updateQueue,i=i!==null?i.events:null,i!==null))for(f=0;f<i.length;f++)C=i[f],C.ref.impl=C.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&A!==null){i=void 0,f=c,C=A.memoizedProps,A=A.memoizedState,p=f.stateNode;try{var ts=Dl(f.type,C);i=p.getSnapshotBeforeUpdate(ts,A),p.__reactInternalSnapshotBeforeUpdate=i}catch(bs){ir(f,f.return,bs)}}break;case 3:if((i&1024)!==0){if(i=c.stateNode.containerInfo,f=i.nodeType,f===9)Iu(i);else if(f===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Iu(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(o(163))}if(i=c.sibling,i!==null){i.return=c.return,ya=i;break}ya=c.return}}function hg(i,c,f){var p=f.flags;switch(f.tag){case 0:case 11:case 15:Ci(i,f),p&4&&Td(5,f);break;case 1:if(Ci(i,f),p&4)if(i=f.stateNode,c===null)try{i.componentDidMount()}catch(U){ir(f,f.return,U)}else{var C=Dl(f.type,c.memoizedProps);c=c.memoizedState;try{i.componentDidUpdate(C,c,i.__reactInternalSnapshotBeforeUpdate)}catch(U){ir(f,f.return,U)}}p&64&&hf(f),p&512&&pc(f,f.return);break;case 3:if(Ci(i,f),p&64&&(i=f.updateQueue,i!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{H0(i,c)}catch(U){ir(f,f.return,U)}}break;case 27:c===null&&p&4&&Ji(f);case 26:case 5:Ci(i,f),c===null&&p&4&&xc(f),p&512&&pc(f,f.return);break;case 12:Ci(i,f);break;case 31:Ci(i,f),p&4&&du(i,f);break;case 13:Ci(i,f),p&4&&gg(i,f),p&64&&(i=f.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(f=Fg.bind(null,f),If(i,f))));break;case 22:if(p=f.memoizedState!==null||ki,!p){c=c!==null&&c.memoizedState!==null||la,C=ki;var A=la;ki=p,(la=c)&&!A?el(i,f,(f.subtreeFlags&8772)!==0):Ci(i,f),ki=C,la=A}break;case 30:break;default:Ci(i,f)}}function fg(i){var c=i.alternate;c!==null&&(i.alternate=null,fg(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&fl(c)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var _r=null,Qa=!1;function Zi(i,c,f){for(f=f.child;f!==null;)mg(i,c,f),f=f.sibling}function mg(i,c,f){if(_a&&typeof _a.onCommitFiberUnmount=="function")try{_a.onCommitFiberUnmount(Vn,f)}catch{}switch(f.tag){case 26:la||Mn(f,c),Zi(i,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:la||Mn(f,c);var p=_r,C=Qa;ll(f.type)&&(_r=f.stateNode,Qa=!1),Zi(i,c,f),d(f.stateNode),_r=p,Qa=C;break;case 5:la||Mn(f,c);case 6:if(p=_r,C=Qa,_r=null,Zi(i,c,f),_r=p,Qa=C,_r!==null)if(Qa)try{(_r.nodeType===9?_r.body:_r.nodeName==="HTML"?_r.ownerDocument.body:_r).removeChild(f.stateNode)}catch(A){ir(f,c,A)}else try{_r.removeChild(f.stateNode)}catch(A){ir(f,c,A)}break;case 18:_r!==null&&(Qa?(i=_r,Pu(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,f.stateNode),ns(i)):Pu(_r,f.stateNode));break;case 4:p=_r,C=Qa,_r=f.stateNode.containerInfo,Qa=!0,Zi(i,c,f),_r=p,Qa=C;break;case 0:case 11:case 14:case 15:_l(2,f,c),la||_l(4,f,c),Zi(i,c,f);break;case 1:la||(Mn(f,c),p=f.stateNode,typeof p.componentWillUnmount=="function"&&dg(f,c,p)),Zi(i,c,f);break;case 21:Zi(i,c,f);break;case 22:la=(p=la)||f.memoizedState!==null,Zi(i,c,f),la=p;break;default:Zi(i,c,f)}}function du(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{ns(i)}catch(f){ir(c,c.return,f)}}}function gg(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{ns(i)}catch(f){ir(c,c.return,f)}}function Xp(i){switch(i.tag){case 31:case 13:case 19:var c=i.stateNode;return c===null&&(c=i.stateNode=new ug),c;case 22:return i=i.stateNode,c=i._retryCache,c===null&&(c=i._retryCache=new ug),c;default:throw Error(o(435,i.tag))}}function uu(i,c){var f=Xp(i);c.forEach(function(p){if(!f.has(p)){f.add(p);var C=Mg.bind(null,i,p);p.then(C,C)}})}function Wa(i,c){var f=c.deletions;if(f!==null)for(var p=0;p<f.length;p++){var C=f[p],A=i,U=c,ee=U;e:for(;ee!==null;){switch(ee.tag){case 27:if(ll(ee.type)){_r=ee.stateNode,Qa=!1;break e}break;case 5:_r=ee.stateNode,Qa=!1;break e;case 3:case 4:_r=ee.stateNode.containerInfo,Qa=!0;break e}ee=ee.return}if(_r===null)throw Error(o(160));mg(A,U,C),_r=null,Qa=!1,A=C.alternate,A!==null&&(A.return=null),C.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)mf(c,i),c=c.sibling}var Ln=null;function mf(i,c){var f=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Wa(c,i),$a(i),p&4&&(_l(3,i,i.return),Td(3,i),_l(5,i,i.return));break;case 1:Wa(c,i),$a(i),p&512&&(la||f===null||Mn(f,f.return)),p&64&&ki&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(f=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=f===null?p:f.concat(p))));break;case 26:var C=Ln;if(Wa(c,i),$a(i),p&512&&(la||f===null||Mn(f,f.return)),p&4){var A=f!==null?f.memoizedState:null;if(p=i.memoizedState,f===null)if(p===null)if(i.stateNode===null){e:{p=i.type,f=i.memoizedProps,C=C.ownerDocument||C;t:switch(p){case"title":A=C.getElementsByTagName("title")[0],(!A||A[Cn]||A[oa]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=C.createElement(p),C.head.insertBefore(A,C.querySelector("head > title"))),wa(A,p,f),A[oa]=i,qr(A),p=A;break e;case"link":var U=Ct("link","href",C).get(p+(f.href||""));if(U){for(var ee=0;ee<U.length;ee++)if(A=U[ee],A.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&A.getAttribute("rel")===(f.rel==null?null:f.rel)&&A.getAttribute("title")===(f.title==null?null:f.title)&&A.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){U.splice(ee,1);break t}}A=C.createElement(p),wa(A,p,f),C.head.appendChild(A);break;case"meta":if(U=Ct("meta","content",C).get(p+(f.content||""))){for(ee=0;ee<U.length;ee++)if(A=U[ee],A.getAttribute("content")===(f.content==null?null:""+f.content)&&A.getAttribute("name")===(f.name==null?null:f.name)&&A.getAttribute("property")===(f.property==null?null:f.property)&&A.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&A.getAttribute("charset")===(f.charSet==null?null:f.charSet)){U.splice(ee,1);break t}}A=C.createElement(p),wa(A,p,f),C.head.appendChild(A);break;default:throw Error(o(468,p))}A[oa]=i,qr(A),p=A}i.stateNode=p}else Vt(C,i.type,i.stateNode);else i.stateNode=Oe(C,p,i.memoizedProps);else A!==p?(A===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):A.count--,p===null?Vt(C,i.type,i.stateNode):Oe(C,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Fl(i,i.memoizedProps,f.memoizedProps)}break;case 27:Wa(c,i),$a(i),p&512&&(la||f===null||Mn(f,f.return)),f!==null&&p&4&&Fl(i,i.memoizedProps,f.memoizedProps);break;case 5:if(Wa(c,i),$a(i),p&512&&(la||f===null||Mn(f,f.return)),i.flags&32){C=i.stateNode;try{Ri(C,"")}catch(ts){ir(i,i.return,ts)}}p&4&&i.stateNode!=null&&(C=i.memoizedProps,Fl(i,C,f!==null?f.memoizedProps:C)),p&1024&&(ff=!0);break;case 6:if(Wa(c,i),$a(i),p&4){if(i.stateNode===null)throw Error(o(162));p=i.memoizedProps,f=i.stateNode;try{f.nodeValue=p}catch(ts){ir(i,i.return,ts)}}break;case 3:if(at=null,C=Ln,Ln=g(c.containerInfo),Wa(c,i),Ln=C,$a(i),p&4&&f!==null&&f.memoizedState.isDehydrated)try{ns(c.containerInfo)}catch(ts){ir(i,i.return,ts)}ff&&(ff=!1,gf(i));break;case 4:p=Ln,Ln=g(i.stateNode.containerInfo),Wa(c,i),$a(i),Ln=p;break;case 12:Wa(c,i),$a(i);break;case 31:Wa(c,i),$a(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,uu(i,p)));break;case 13:Wa(c,i),$a(i),i.child.flags&8192&&i.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(pu=ds()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,uu(i,p)));break;case 22:C=i.memoizedState!==null;var je=f!==null&&f.memoizedState!==null,Ye=ki,ut=la;if(ki=Ye||C,la=ut||je,Wa(c,i),la=ut,ki=Ye,$a(i),p&8192)e:for(c=i.stateNode,c._visibility=C?c._visibility&-2:c._visibility|1,C&&(f===null||je||ki||la||Ml(i)),f=null,c=i;;){if(c.tag===5||c.tag===26){if(f===null){je=f=c;try{if(A=je.stateNode,C)U=A.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{ee=je.stateNode;var mt=je.memoizedProps.style,et=mt!=null&&mt.hasOwnProperty("display")?mt.display:null;ee.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(ts){ir(je,je.return,ts)}}}else if(c.tag===6){if(f===null){je=c;try{je.stateNode.nodeValue=C?"":je.memoizedProps}catch(ts){ir(je,je.return,ts)}}}else if(c.tag===18){if(f===null){je=c;try{var lt=je.stateNode;C?Of(lt,!0):Of(je.stateNode,!1)}catch(ts){ir(je,je.return,ts)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===i)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break e;for(;c.sibling===null;){if(c.return===null||c.return===i)break e;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}p&4&&(p=i.updateQueue,p!==null&&(f=p.retryQueue,f!==null&&(p.retryQueue=null,uu(i,f))));break;case 19:Wa(c,i),$a(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,uu(i,p)));break;case 30:break;case 21:break;default:Wa(c,i),$a(i)}}function $a(i){var c=i.flags;if(c&2){try{for(var f,p=i.return;p!==null;){if(bc(p)){f=p;break}p=p.return}if(f==null)throw Error(o(160));switch(f.tag){case 27:var C=f.stateNode,A=_d(i);Ni(i,A,C);break;case 5:var U=f.stateNode;f.flags&32&&(Ri(U,""),f.flags&=-33);var ee=_d(i);Ni(i,ee,U);break;case 3:case 4:var je=f.stateNode.containerInfo,Ye=_d(i);yc(i,Ye,je);break;default:throw Error(o(161))}}catch(ut){ir(i,i.return,ut)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function gf(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var c=i;gf(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),i=i.sibling}}function Ci(i,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)hg(i,c.alternate,c),c=c.sibling}function Ml(i){for(i=i.child;i!==null;){var c=i;switch(c.tag){case 0:case 11:case 14:case 15:_l(4,c,c.return),Ml(c);break;case 1:Mn(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&dg(c,c.return,f),Ml(c);break;case 27:d(c.stateNode);case 26:case 5:Mn(c,c.return),Ml(c);break;case 22:c.memoizedState===null&&Ml(c);break;case 30:Ml(c);break;default:Ml(c)}i=i.sibling}}function el(i,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var p=c.alternate,C=i,A=c,U=A.flags;switch(A.tag){case 0:case 11:case 15:el(C,A,f),Td(4,A);break;case 1:if(el(C,A,f),p=A,C=p.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(Ye){ir(p,p.return,Ye)}if(p=A,C=p.updateQueue,C!==null){var ee=p.stateNode;try{var je=C.shared.hiddenCallbacks;if(je!==null)for(C.shared.hiddenCallbacks=null,C=0;C<je.length;C++)Dh(je[C],ee)}catch(Ye){ir(p,p.return,Ye)}}f&&U&64&&hf(A),pc(A,A.return);break;case 27:Ji(A);case 26:case 5:el(C,A,f),f&&p===null&&U&4&&xc(A),pc(A,A.return);break;case 12:el(C,A,f);break;case 31:el(C,A,f),f&&U&4&&du(C,A);break;case 13:el(C,A,f),f&&U&4&&gg(C,A);break;case 22:A.memoizedState===null&&el(C,A,f),pc(A,A.return);break;case 30:break;default:el(C,A,f)}c=c.sibling}}function pf(i,c){var f=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),i=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(i=c.memoizedState.cachePool.pool),i!==f&&(i!=null&&i.refCount++,f!=null&&io(f))}function hu(i,c){i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&io(i))}function ai(i,c,f,p){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Fd(i,c,f,p),c=c.sibling}function Fd(i,c,f,p){var C=c.flags;switch(c.tag){case 0:case 11:case 15:ai(i,c,f,p),C&2048&&Td(9,c);break;case 1:ai(i,c,f,p);break;case 3:ai(i,c,f,p),C&2048&&(i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&io(i)));break;case 12:if(C&2048){ai(i,c,f,p),i=c.stateNode;try{var A=c.memoizedProps,U=A.id,ee=A.onPostCommit;typeof ee=="function"&&ee(U,c.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(je){ir(c,c.return,je)}}else ai(i,c,f,p);break;case 31:ai(i,c,f,p);break;case 13:ai(i,c,f,p);break;case 23:break;case 22:A=c.stateNode,U=c.alternate,c.memoizedState!==null?A._visibility&2?ai(i,c,f,p):wc(i,c):A._visibility&2?ai(i,c,f,p):(A._visibility|=2,vc(i,c,f,p,(c.subtreeFlags&10256)!==0||!1)),C&2048&&pf(U,c);break;case 24:ai(i,c,f,p),C&2048&&hu(c.alternate,c);break;default:ai(i,c,f,p)}}function vc(i,c,f,p,C){for(C=C&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var A=i,U=c,ee=f,je=p,Ye=U.flags;switch(U.tag){case 0:case 11:case 15:vc(A,U,ee,je,C),Td(8,U);break;case 23:break;case 22:var ut=U.stateNode;U.memoizedState!==null?ut._visibility&2?vc(A,U,ee,je,C):wc(A,U):(ut._visibility|=2,vc(A,U,ee,je,C)),C&&Ye&2048&&pf(U.alternate,U);break;case 24:vc(A,U,ee,je,C),C&&Ye&2048&&hu(U.alternate,U);break;default:vc(A,U,ee,je,C)}c=c.sibling}}function wc(i,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=i,p=c,C=p.flags;switch(p.tag){case 22:wc(f,p),C&2048&&pf(p.alternate,p);break;case 24:wc(f,p),C&2048&&hu(p.alternate,p);break;default:wc(f,p)}c=c.sibling}}var Si=8192;function jc(i,c,f){if(i.subtreeFlags&Si)for(i=i.child;i!==null;)xf(i,c,f),i=i.sibling}function xf(i,c,f){switch(i.tag){case 26:jc(i,c,f),i.flags&Si&&i.memoizedState!==null&&Mt(f,Ln,i.memoizedState,i.memoizedProps);break;case 5:jc(i,c,f);break;case 3:case 4:var p=Ln;Ln=g(i.stateNode.containerInfo),jc(i,c,f),Ln=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=Si,Si=16777216,jc(i,c,f),Si=p):jc(i,c,f));break;default:jc(i,c,f)}}function pg(i){var c=i.alternate;if(c!==null&&(i=c.child,i!==null)){c.child=null;do c=i.sibling,i.sibling=null,i=c;while(i!==null)}}function Md(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];ya=p,bg(p,i)}pg(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)xg(i),i=i.sibling}function xg(i){switch(i.tag){case 0:case 11:case 15:Md(i),i.flags&2048&&_l(9,i,i.return);break;case 3:Md(i);break;case 12:Md(i);break;case 22:var c=i.stateNode;i.memoizedState!==null&&c._visibility&2&&(i.return===null||i.return.tag!==13)?(c._visibility&=-3,fu(i)):Md(i);break;default:Md(i)}}function fu(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];ya=p,bg(p,i)}pg(i)}for(i=i.child;i!==null;){switch(c=i,c.tag){case 0:case 11:case 15:_l(8,c,c.return),fu(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,fu(c));break;default:fu(c)}i=i.sibling}}function bg(i,c){for(;ya!==null;){var f=ya;switch(f.tag){case 0:case 11:case 15:_l(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var p=f.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:io(f.memoizedState.cache)}if(p=f.child,p!==null)p.return=f,ya=p;else e:for(f=i;ya!==null;){p=ya;var C=p.sibling,A=p.return;if(fg(p),p===f){ya=null;break e}if(C!==null){C.return=A,ya=C;break e}ya=A}}}var Jp={getCacheForType:function(i){var c=ra(aa),f=c.data.get(i);return f===void 0&&(f=i(),c.data.set(i,f)),f},cacheSignal:function(){return ra(aa).controller.signal}},Zp=typeof WeakMap=="function"?WeakMap:Map,ar=0,br=null,Ps=null,Ws=0,cr=0,vn=null,tl=!1,wo=!1,mu=!1,sl=0,Vr=0,rl=0,jo=0,gu=0,wn=0,Nc=0,Ld=null,Xa=null,bf=!1,pu=0,yg=0,xu=1/0,bu=null,Ll=null,ha=0,Rl=null,kc=null,jn=0,yu=0,vu=null,Rn=null,Rd=0,Od=null;function qa(){return(ar&2)!==0&&Ws!==0?Ws&-Ws:fe.T!==null?zs():Li()}function vg(){if(wn===0)if((Ws&536870912)===0||Vs){var i=_i;_i<<=1,(_i&3932160)===0&&(_i=262144),wn=i}else wn=536870912;return i=bn.current,i!==null&&(i.flags|=32),wn}function Ya(i,c,f){(i===br&&(cr===2||cr===9)||i.cancelPendingCommit!==null)&&(Ga(i,0),Ol(i,Ws,wn,!1)),$n(i,f),((ar&2)===0||i!==br)&&(i===br&&((ar&2)===0&&(jo|=f),Vr===4&&Ol(i,Ws,wn,!1)),va(i))}function wg(i,c,f){if((ar&6)!==0)throw Error(o(327));var p=!f&&(c&127)===0&&(c&i.expiredLanes)===0||Yl(i,c),C=p?It(i,c):No(i,c,!0),A=p;do{if(C===0){wo&&!p&&Ol(i,c,0,!1);break}else{if(f=i.current.alternate,A&&!e1(f)){C=No(i,c,!1),A=!1;continue}if(C===2){if(A=c,i.errorRecoveryDisabledLanes&A)var U=0;else U=i.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){c=U;e:{var ee=i;C=Ld;var je=ee.current.memoizedState.isDehydrated;if(je&&(Ga(ee,U).flags|=256),U=No(ee,U,!1),U!==2){if(mu&&!je){ee.errorRecoveryDisabledLanes|=A,jo|=A,C=4;break e}A=Xa,Xa=C,A!==null&&(Xa===null?Xa=A:Xa.push.apply(Xa,A))}C=U}if(A=!1,C!==2)continue}}if(C===1){Ga(i,0),Ol(i,c,0,!0);break}e:{switch(p=i,A=C,A){case 0:case 1:throw Error(o(345));case 4:if((c&4194048)!==c)break;case 6:Ol(p,c,wn,!tl);break e;case 2:Xa=null;break;case 3:case 5:break;default:throw Error(o(329))}if((c&62914560)===c&&(C=pu+300-ds(),10<C)){if(Ol(p,c,wn,!tl),Zt(p,0,!0)!==0)break e;jn=c,p.timeoutHandle=Ru(jg.bind(null,p,f,Xa,bu,bf,c,wn,jo,Nc,tl,A,"Throttled",-0,0),C);break e}jg(p,f,Xa,bu,bf,c,wn,jo,Nc,tl,A,null,-0,0)}}break}while(!0);va(i)}function jg(i,c,f,p,C,A,U,ee,je,Ye,ut,mt,et,lt){if(i.timeoutHandle=-1,mt=c.subtreeFlags,mt&8192||(mt&16785408)===16785408){mt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Xe},xf(c,A,mt);var ts=(A&62914560)===A?pu-ds():(A&4194048)===A?yg-ds():0;if(ts=wt(mt,ts),ts!==null){jn=A,i.cancelPendingCommit=ts(Ag.bind(null,i,c,A,f,p,C,U,ee,je,ut,mt,null,et,lt)),Ol(i,A,U,!Ye);return}}Ag(i,c,A,f,p,C,U,ee,je)}function e1(i){for(var c=i;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var p=0;p<f.length;p++){var C=f[p],A=C.getSnapshot;C=C.value;try{if(!hn(A(),C))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ol(i,c,f,p){c&=~gu,c&=~jo,i.suspendedLanes|=c,i.pingedLanes&=~c,p&&(i.warmLanes|=c),p=i.expirationTimes;for(var C=c;0<C;){var A=31-Br(C),U=1<<A;p[A]=-1,C&=~U}f!==0&&Gl(i,f,c)}function wu(){return(ar&6)===0?(Co(0),!1):!0}function yf(){if(Ps!==null){if(cr===0)var i=Ps.return;else i=Ps,Wi=jl=null,md(i),$i=null,rc=0,i=Ps;for(;i!==null;)cg(i.alternate,i),i=i.return;Ps=null}}function Ga(i,c){var f=i.timeoutHandle;f!==-1&&(i.timeoutHandle=-1,Ig(f)),f=i.cancelPendingCommit,f!==null&&(i.cancelPendingCommit=null,f()),jn=0,yf(),br=i,Ps=f=pi(i.current,null),Ws=c,cr=0,vn=null,tl=!1,wo=Yl(i,c),mu=!1,Nc=wn=gu=jo=rl=Vr=0,Xa=Ld=null,bf=!1,(c&8)!==0&&(c|=c&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=c;0<p;){var C=31-Br(p),A=1<<C;c|=i[C],p&=~A}return sl=c,ks(),f}function Pd(i,c){As=null,fe.H=kd,c===sc||c===O0?(c=I0(),cr=3):c===R0?(c=I0(),cr=4):cr=c===sf?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,vn=c,Ps===null&&(Vr=1,su(i,mn(c,i.current)))}function Ng(){var i=bn.current;return i===null?!0:(Ws&4194048)===Ws?yn===null:(Ws&62914560)===Ws||(Ws&536870912)!==0?i===yn:!1}function Cc(){var i=fe.H;return fe.H=kd,i===null?kd:i}function Id(){var i=fe.A;return fe.A=Jp,i}function ju(){Vr=4,tl||(Ws&4194048)!==Ws&&bn.current!==null||(wo=!0),(rl&134217727)===0&&(jo&134217727)===0||br===null||Ol(br,Ws,wn,!1)}function No(i,c,f){var p=ar;ar|=2;var C=Cc(),A=Id();(br!==i||Ws!==c)&&(bu=null,Ga(i,c)),c=!1;var U=Vr;e:do try{if(cr!==0&&Ps!==null){var ee=Ps,je=vn;switch(cr){case 8:yf(),U=6;break e;case 3:case 2:case 9:case 6:bn.current===null&&(c=!0);var Ye=cr;if(cr=0,vn=null,Sc(i,ee,je,Ye),f&&wo){U=0;break e}break;default:Ye=cr,cr=0,vn=null,Sc(i,ee,je,Ye)}}vf(),U=Vr;break}catch(ut){Pd(i,ut)}while(!0);return c&&i.shellSuspendCounter++,Wi=jl=null,ar=p,fe.H=C,fe.A=A,Ps===null&&(br=null,Ws=0,ks()),U}function vf(){for(;Ps!==null;)kg(Ps)}function It(i,c){var f=ar;ar|=2;var p=Cc(),C=Id();br!==i||Ws!==c?(bu=null,xu=ds()+500,Ga(i,c)):wo=Yl(i,c);e:do try{if(cr!==0&&Ps!==null){c=Ps;var A=vn;t:switch(cr){case 1:cr=0,vn=null,Sc(i,c,A,1);break;case 2:case 9:if(Ch(A)){cr=0,vn=null,Cg(c);break}c=function(){cr!==2&&cr!==9||br!==i||(cr=7),va(i)},A.then(c,c);break e;case 3:cr=7;break e;case 4:cr=5;break e;case 7:Ch(A)?(cr=0,vn=null,Cg(c)):(cr=0,vn=null,Sc(i,c,A,7));break;case 5:var U=null;switch(Ps.tag){case 26:U=Ps.memoizedState;case 5:case 27:var ee=Ps;if(U?Ft(U):ee.stateNode.complete){cr=0,vn=null;var je=ee.sibling;if(je!==null)Ps=je;else{var Ye=ee.return;Ye!==null?(Ps=Ye,Nu(Ye)):Ps=null}break t}}cr=0,vn=null,Sc(i,c,A,5);break;case 6:cr=0,vn=null,Sc(i,c,A,6);break;case 8:yf(),Vr=6;break e;default:throw Error(o(462))}}Bd();break}catch(ut){Pd(i,ut)}while(!0);return Wi=jl=null,fe.H=p,fe.A=C,ar=f,Ps!==null?0:(br=null,Ws=0,ks(),Vr)}function Bd(){for(;Ps!==null&&!Js();)kg(Ps)}function kg(i){var c=og(i.alternate,i,sl);i.memoizedProps=i.pendingProps,c===null?Nu(i):Ps=c}function Cg(i){var c=i,f=c.alternate;switch(c.tag){case 15:case 0:c=nf(f,c,c.pendingProps,c.type,void 0,Ws);break;case 11:c=nf(f,c,c.pendingProps,c.type.render,c.ref,Ws);break;case 5:md(c);default:cg(f,c),c=Ps=S0(c,sl),c=og(f,c,sl)}i.memoizedProps=i.pendingProps,c===null?Nu(i):Ps=c}function Sc(i,c,f,p){Wi=jl=null,md(c),$i=null,rc=0;var C=c.return;try{if(ag(i,C,c,f,Ws)){Vr=1,su(i,mn(f,i.current)),Ps=null;return}}catch(A){if(C!==null)throw Ps=C,A;Vr=1,su(i,mn(f,i.current)),Ps=null;return}c.flags&32768?(Vs||p===1?i=!0:wo||(Ws&536870912)!==0?i=!1:(tl=i=!0,(p===2||p===9||p===3||p===6)&&(p=bn.current,p!==null&&p.tag===13&&(p.flags|=16384))),Sg(c,i)):Nu(c)}function Nu(i){var c=i;do{if((c.flags&32768)!==0){Sg(c,tl);return}i=c.return;var f=Kp(c.alternate,c,sl);if(f!==null){Ps=f;return}if(c=c.sibling,c!==null){Ps=c;return}Ps=c=i}while(c!==null);Vr===0&&(Vr=5)}function Sg(i,c){do{var f=cu(i.alternate,i);if(f!==null){f.flags&=32767,Ps=f;return}if(f=i.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(i=i.sibling,i!==null)){Ps=i;return}Ps=i=f}while(i!==null);Vr=6,Ps=null}function Ag(i,c,f,p,C,A,U,ee,je){i.cancelPendingCommit=null;do zd();while(ha!==0);if((ar&6)!==0)throw Error(o(327));if(c!==null){if(c===i.current)throw Error(o(177));if(A=c.lanes|c.childLanes,A|=k0,Fi(i,f,A,U,ee,je),i===br&&(Ps=br=null,Ws=0),kc=c,Rl=i,jn=f,yu=A,vu=C,Rn=p,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Lg(ms,function(){return jf(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||p){p=fe.T,fe.T=null,C=_e.p,_e.p=2,U=ar,ar|=4;try{Qp(i,c,f)}finally{ar=U,_e.p=C,fe.T=p}}ha=1,Eg(),Dg(),Tg()}}function Eg(){if(ha===1){ha=0;var i=Rl,c=kc,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=fe.T,fe.T=null;var p=_e.p;_e.p=2;var C=ar;ar|=4;try{mf(c,i);var A=Mu,U=v0(i.containerInfo),ee=A.focusedElem,je=A.selectionRange;if(U!==ee&&ee&&ee.ownerDocument&&km(ee.ownerDocument.documentElement,ee)){if(je!==null&&sd(ee)){var Ye=je.start,ut=je.end;if(ut===void 0&&(ut=Ye),"selectionStart"in ee)ee.selectionStart=Ye,ee.selectionEnd=Math.min(ut,ee.value.length);else{var mt=ee.ownerDocument||document,et=mt&&mt.defaultView||window;if(et.getSelection){var lt=et.getSelection(),ts=ee.textContent.length,bs=Math.min(je.start,ts),Ar=je.end===void 0?bs:Math.min(je.end,ts);!lt.extend&&bs>Ar&&(U=Ar,Ar=bs,bs=U);var $e=td(ee,bs),Re=td(ee,Ar);if($e&&Re&&(lt.rangeCount!==1||lt.anchorNode!==$e.node||lt.anchorOffset!==$e.offset||lt.focusNode!==Re.node||lt.focusOffset!==Re.offset)){var tt=mt.createRange();tt.setStart($e.node,$e.offset),lt.removeAllRanges(),bs>Ar?(lt.addRange(tt),lt.extend(Re.node,Re.offset)):(tt.setEnd(Re.node,Re.offset),lt.addRange(tt))}}}}for(mt=[],lt=ee;lt=lt.parentNode;)lt.nodeType===1&&mt.push({element:lt,left:lt.scrollLeft,top:lt.scrollTop});for(typeof ee.focus=="function"&&ee.focus(),ee=0;ee<mt.length;ee++){var bt=mt[ee];bt.element.scrollLeft=bt.left,bt.element.scrollTop=bt.top}}qs=!!Ec,Mu=Ec=null}finally{ar=C,_e.p=p,fe.T=f}}i.current=c,ha=2}}function Dg(){if(ha===2){ha=0;var i=Rl,c=kc,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=fe.T,fe.T=null;var p=_e.p;_e.p=2;var C=ar;ar|=4;try{hg(i,c.alternate,c)}finally{ar=C,_e.p=p,fe.T=f}}ha=3}}function Tg(){if(ha===4||ha===3){ha=0,ps();var i=Rl,c=kc,f=jn,p=Rn;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?ha=5:(ha=0,kc=Rl=null,wf(i,i.pendingLanes));var C=i.pendingLanes;if(C===0&&(Ll=null),Mi(f),c=c.stateNode,_a&&typeof _a.onCommitFiberRoot=="function")try{_a.onCommitFiberRoot(Vn,c,void 0,(c.current.flags&128)===128)}catch{}if(p!==null){c=fe.T,C=_e.p,_e.p=2,fe.T=null;try{for(var A=i.onRecoverableError,U=0;U<p.length;U++){var ee=p[U];A(ee.value,{componentStack:ee.stack})}}finally{fe.T=c,_e.p=C}}(jn&3)!==0&&zd(),va(i),C=i.pendingLanes,(f&261930)!==0&&(C&42)!==0?i===Od?Rd++:(Rd=0,Od=i):Rd=0,Co(0)}}function wf(i,c){(i.pooledCacheLanes&=c)===0&&(c=i.pooledCache,c!=null&&(i.pooledCache=null,io(c)))}function zd(){return Eg(),Dg(),Tg(),jf()}function jf(){if(ha!==5)return!1;var i=Rl,c=yu;yu=0;var f=Mi(jn),p=fe.T,C=_e.p;try{_e.p=32>f?32:f,fe.T=null,f=vu,vu=null;var A=Rl,U=jn;if(ha=0,kc=Rl=null,jn=0,(ar&6)!==0)throw Error(o(331));var ee=ar;if(ar|=4,xg(A.current),Fd(A,A.current,U,f),ar=ee,Co(0,!1),_a&&typeof _a.onPostCommitFiberRoot=="function")try{_a.onPostCommitFiberRoot(Vn,A)}catch{}return!0}finally{_e.p=C,fe.T=p,wf(i,c)}}function Nf(i,c,f){c=mn(f,c),c=Tl(i.stateNode,c,2),i=qi(i,c,2),i!==null&&($n(i,2),va(i))}function ir(i,c,f){if(i.tag===3)Nf(i,i,f);else for(;c!==null;){if(c.tag===3){Nf(c,i,f);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Ll===null||!Ll.has(p))){i=mn(f,i),f=ef(2),p=qi(c,f,2),p!==null&&(tf(f,p,c,i),$n(p,2),va(p));break}}c=c.return}}function ku(i,c,f){var p=i.pingCache;if(p===null){p=i.pingCache=new Zp;var C=new Set;p.set(c,C)}else C=p.get(c),C===void 0&&(C=new Set,p.set(c,C));C.has(f)||(mu=!0,C.add(f),i=_g.bind(null,i,c,f),c.then(i,i))}function _g(i,c,f){var p=i.pingCache;p!==null&&p.delete(c),i.pingedLanes|=i.suspendedLanes&f,i.warmLanes&=~f,br===i&&(Ws&f)===f&&(Vr===4||Vr===3&&(Ws&62914560)===Ws&&300>ds()-pu?(ar&2)===0&&Ga(i,0):gu|=f,Nc===Ws&&(Nc=0)),va(i)}function kf(i,c){c===0&&(c=wr()),i=_n(i,c),i!==null&&($n(i,c),va(i))}function Fg(i){var c=i.memoizedState,f=0;c!==null&&(f=c.retryLane),kf(i,f)}function Mg(i,c){var f=0;switch(i.tag){case 31:case 13:var p=i.stateNode,C=i.memoizedState;C!==null&&(f=C.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(o(314))}p!==null&&p.delete(c),kf(i,f)}function Lg(i,c){return Rt(i,c)}var Ud=null,ko=null,Cu=!1,Su=!1,Au=!1,al=0;function va(i){i!==ko&&i.next===null&&(ko===null?Ud=ko=i:ko=ko.next=i),Su=!0,Cu||(Cu=!0,Or())}function Co(i,c){if(!Au&&Su){Au=!0;do for(var f=!1,p=Ud;p!==null;){if(i!==0){var C=p.pendingLanes;if(C===0)var A=0;else{var U=p.suspendedLanes,ee=p.pingedLanes;A=(1<<31-Br(42|i)+1)-1,A&=C&~(U&~ee),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(f=!0,Ks(p,A))}else A=Ws,A=Zt(p,p===br?A:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(A&3)===0||Yl(p,A)||(f=!0,Ks(p,A));p=p.next}while(f);Au=!1}}function Rg(){nl()}function nl(){Su=Cu=!1;var i=0;al!==0&&Lu()&&(i=al);for(var c=ds(),f=null,p=Ud;p!==null;){var C=p.next,A=Cf(p,c);A===0?(p.next=null,f===null?Ud=C:f.next=C,C===null&&(ko=f)):(f=p,(i!==0||(A&3)!==0)&&(Su=!0)),p=C}ha!==0&&ha!==5||Co(i),al!==0&&(al=0)}function Cf(i,c){for(var f=i.suspendedLanes,p=i.pingedLanes,C=i.expirationTimes,A=i.pendingLanes&-62914561;0<A;){var U=31-Br(A),ee=1<<U,je=C[U];je===-1?((ee&f)===0||(ee&p)!==0)&&(C[U]=Ds(ee,c)):je<=c&&(i.expiredLanes|=ee),A&=~ee}if(c=br,f=Ws,f=Zt(i,i===c?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,f===0||i===c&&(cr===2||cr===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&Ns(p),i.callbackNode=null,i.callbackPriority=0;if((f&3)===0||Yl(i,f)){if(c=f&-f,c===i.callbackPriority)return c;switch(p!==null&&Ns(p),Mi(f)){case 2:case 8:f=Tt;break;case 32:f=ms;break;case 268435456:f=rr;break;default:f=ms}return p=Ac.bind(null,i),f=Rt(f,p),i.callbackPriority=c,i.callbackNode=f,c}return p!==null&&p!==null&&Ns(p),i.callbackPriority=2,i.callbackNode=null,2}function Ac(i,c){if(ha!==0&&ha!==5)return i.callbackNode=null,i.callbackPriority=0,null;var f=i.callbackNode;if(zd()&&i.callbackNode!==f)return null;var p=Ws;return p=Zt(i,i===br?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(wg(i,p,c),Cf(i,ds()),i.callbackNode!=null&&i.callbackNode===f?Ac.bind(null,i):null)}function Ks(i,c){if(zd())return null;wg(i,c,!0)}function Or(){Ou(function(){(ar&6)!==0?Rt(dt,Rg):nl()})}function zs(){if(al===0){var i=lo;i===0&&(i=zo,zo<<=1,(zo&261888)===0&&(zo=256)),al=i}return al}function Pr(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Ue(""+i)}function Eu(i,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,i.id&&f.setAttribute("form",i.id),c.parentNode.insertBefore(f,c),i=new FormData(i),f.parentNode.removeChild(f),i}function On(i,c,f,p,C){if(c==="submit"&&f&&f.stateNode===C){var A=Pr((C[Ts]||null).action),U=p.submitter;U&&(c=(c=U[Ts]||null)?Pr(c.formAction):U.getAttribute("formAction"),c!==null&&(A=c,U=null));var ee=new Xc("action","action",null,p,C);i.push({event:ee,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(al!==0){var je=U?Eu(C,U):new FormData(C);Yh(f,{pending:!0,data:je,method:C.method,action:A},null,je)}}else typeof A=="function"&&(ee.preventDefault(),je=U?Eu(C,U):new FormData(C),Yh(f,{pending:!0,data:je,method:C.method,action:A},A,je))},currentTarget:C}]})}}for(var il=0;il<Qn.length;il++){var Ja=Qn[il],So=Ja.toLowerCase(),t1=Ja[0].toUpperCase()+Ja.slice(1);Tn(So,"on"+t1)}Tn(gh,"onAnimationEnd"),Tn(ph,"onAnimationIteration"),Tn(Cm,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(xh,"onTransitionRun"),Tn(bh,"onTransitionStart"),Tn(Sm,"onTransitionCancel"),Tn(Am,"onTransitionEnd"),cs("onMouseEnter",["mouseout","mouseover"]),cs("onMouseLeave",["mouseout","mouseover"]),cs("onPointerEnter",["pointerout","pointerover"]),cs("onPointerLeave",["pointerout","pointerover"]),ui("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ui("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ui("onBeforeInput",["compositionend","keypress","textInput","paste"]),ui("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ui("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ui("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ao="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sf=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ao));function Og(i,c){c=(c&4)!==0;for(var f=0;f<i.length;f++){var p=i[f],C=p.event;p=p.listeners;e:{var A=void 0;if(c)for(var U=p.length-1;0<=U;U--){var ee=p[U],je=ee.instance,Ye=ee.currentTarget;if(ee=ee.listener,je!==A&&C.isPropagationStopped())break e;A=ee,C.currentTarget=Ye;try{A(C)}catch(ut){Jo(ut)}C.currentTarget=null,A=je}else for(U=0;U<p.length;U++){if(ee=p[U],je=ee.instance,Ye=ee.currentTarget,ee=ee.listener,je!==A&&C.isPropagationStopped())break e;A=ee,C.currentTarget=Ye;try{A(C)}catch(ut){Jo(ut)}C.currentTarget=null,A=je}}}}function hs(i,c){var f=c[Ys];f===void 0&&(f=c[Ys]=new Set);var p=i+"__bubble";f.has(p)||(Pg(c,i,2,!1),f.add(p))}function Du(i,c,f){var p=0;c&&(p|=4),Pg(f,i,p,c)}var Tu="_reactListening"+Math.random().toString(36).slice(2);function Af(i){if(!i[Tu]){i[Tu]=!0,zr.forEach(function(f){f!=="selectionchange"&&(Sf.has(f)||Du(f,!1,i),Du(f,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[Tu]||(c[Tu]=!0,Du("selectionchange",!1,c))}}function Pg(i,c,f,p){switch(Ce(c)){case 2:var C=fa;break;case 8:C=Pn;break;default:C=ge}f=C.bind(null,c,f,i),C=void 0,!Cs||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(C=!0),p?C!==void 0?i.addEventListener(c,f,{capture:!0,passive:C}):i.addEventListener(c,f,!0):C!==void 0?i.addEventListener(c,f,{passive:C}):i.addEventListener(c,f,!1)}function _u(i,c,f,p,C){var A=p;if((c&1)===0&&(c&2)===0&&p!==null)e:for(;;){if(p===null)return;var U=p.tag;if(U===3||U===4){var ee=p.stateNode.containerInfo;if(ee===C)break;if(U===4)for(U=p.return;U!==null;){var je=U.tag;if((je===3||je===4)&&U.stateNode.containerInfo===C)return;U=U.return}for(;ee!==null;){if(U=Na(ee),U===null)return;if(je=U.tag,je===5||je===6||je===26||je===27){p=A=U;continue e}ee=ee.parentNode}}p=p.return}Pt(function(){var Ye=A,ut=qe(f),mt=[];e:{var et=Xo.get(i);if(et!==void 0){var lt=Xc,ts=i;switch(i){case"keypress":if(ml(f)===0)break e;case"keydown":case"keyup":lt=Ql;break;case"focusin":ts="focus",lt=f0;break;case"focusout":ts="blur",lt=f0;break;case"beforeblur":case"afterblur":lt=f0;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":lt=nh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":lt=wm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":lt=Hp;break;case gh:case ph:case Cm:lt=ih;break;case Am:lt=Wp;break;case"scroll":case"scrollend":lt=ym;break;case"wheel":lt=ka;break;case"copy":case"cut":case"paste":lt=oh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":lt=Go;break;case"toggle":case"beforetoggle":lt=gt}var bs=(c&4)!==0,Ar=!bs&&(i==="scroll"||i==="scrollend"),$e=bs?et!==null?et+"Capture":null:et;bs=[];for(var Re=Ye,tt;Re!==null;){var bt=Re;if(tt=bt.stateNode,bt=bt.tag,bt!==5&&bt!==26&&bt!==27||tt===null||$e===null||(bt=ht(Re,$e),bt!=null&&bs.push(Hd(Re,bt,tt))),Ar)break;Re=Re.return}0<bs.length&&(et=new lt(et,ts,null,f,ut),mt.push({event:et,listeners:bs}))}}if((c&7)===0){e:{if(et=i==="mouseover"||i==="pointerover",lt=i==="mouseout"||i==="pointerout",et&&f!==ze&&(ts=f.relatedTarget||f.fromElement)&&(Na(ts)||ts[ur]))break e;if((lt||et)&&(et=ut.window===ut?ut:(et=ut.ownerDocument)?et.defaultView||et.parentWindow:window,lt?(ts=f.relatedTarget||f.toElement,lt=Ye,ts=ts?Na(ts):null,ts!==null&&(Ar=e(ts),bs=ts.tag,ts!==Ar||bs!==5&&bs!==27&&bs!==6)&&(ts=null)):(lt=null,ts=Ye),lt!==ts)){if(bs=nh,bt="onMouseLeave",$e="onMouseEnter",Re="mouse",(i==="pointerout"||i==="pointerover")&&(bs=Go,bt="onPointerLeave",$e="onPointerEnter",Re="pointer"),Ar=lt==null?et:Sn(lt),tt=ts==null?et:Sn(ts),et=new bs(bt,Re+"leave",lt,f,ut),et.target=Ar,et.relatedTarget=tt,bt=null,Na(ut)===Ye&&(bs=new bs($e,Re+"enter",ts,f,ut),bs.target=tt,bs.relatedTarget=Ar,bt=bs),Ar=bt,lt&&ts)t:{for(bs=Ef,$e=lt,Re=ts,tt=0,bt=$e;bt;bt=bs(bt))tt++;bt=0;for(var fs=Re;fs;fs=bs(fs))bt++;for(;0<tt-bt;)$e=bs($e),tt--;for(;0<bt-tt;)Re=bs(Re),bt--;for(;tt--;){if($e===Re||Re!==null&&$e===Re.alternate){bs=$e;break t}$e=bs($e),Re=bs(Re)}bs=null}else bs=null;lt!==null&&Fu(mt,et,lt,bs,!1),ts!==null&&Ar!==null&&Fu(mt,Ar,ts,bs,!0)}}e:{if(et=Ye?Sn(Ye):window,lt=et.nodeName&&et.nodeName.toLowerCase(),lt==="select"||lt==="input"&&et.type==="file")var lr=fh;else if(Oa(et))if(Xl)lr=Zl;else{lr=En;var ls=$p}else lt=et.nodeName,!lt||lt.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?Ye&&K(Ye.elementType)&&(lr=fh):lr=Jl;if(lr&&(lr=lr(i,Ye))){Ss(mt,lr,f,ut);break e}ls&&ls(i,et,Ye),i==="focusout"&&Ye&&et.type==="number"&&Ye.memoizedProps.value!=null&&Gs(et,"number",et.value)}switch(ls=Ye?Sn(Ye):window,i){case"focusin":(Oa(ls)||ls.contentEditable==="true")&&(to=ls,w0=Ye,Kn=null);break;case"focusout":Kn=w0=to=null;break;case"mousedown":bl=!0;break;case"contextmenu":case"mouseup":case"dragend":bl=!1,Ca(mt,f,ut);break;case"selectionchange":if(mh)break;case"keydown":case"keyup":Ca(mt,f,ut)}var Bs;if(Ra)e:{switch(i){case"compositionstart":var Qs="onCompositionStart";break e;case"compositionend":Qs="onCompositionEnd";break e;case"compositionupdate":Qs="onCompositionUpdate";break e}Qs=void 0}else xl?x0(i,f)&&(Qs="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(Qs="onCompositionStart");Qs&&(hh&&f.locale!=="ko"&&(xl||Qs!=="onCompositionStart"?Qs==="onCompositionEnd"&&xl&&(Bs=c0()):(ws=ut,kt="value"in ws?ws.value:ws.textContent,xl=!0)),ls=Vd(Ye,Qs),0<ls.length&&(Qs=new m0(Qs,i,null,f,ut),mt.push({event:Qs,listeners:ls}),Bs?Qs.data=Bs:(Bs=Ur(f),Bs!==null&&(Qs.data=Bs)))),(Bs=Zc?Tr(i,f):Hr(i,f))&&(Qs=Vd(Ye,"onBeforeInput"),0<Qs.length&&(ls=new m0("onBeforeInput","beforeinput",null,f,ut),mt.push({event:ls,listeners:Qs}),ls.data=Bs)),On(mt,i,Ye,f,ut)}Og(mt,c)})}function Hd(i,c,f){return{instance:i,listener:c,currentTarget:f}}function Vd(i,c){for(var f=c+"Capture",p=[];i!==null;){var C=i,A=C.stateNode;if(C=C.tag,C!==5&&C!==26&&C!==27||A===null||(C=ht(i,f),C!=null&&p.unshift(Hd(i,C,A)),C=ht(i,c),C!=null&&p.push(Hd(i,C,A))),i.tag===3)return p;i=i.return}return[]}function Ef(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Fu(i,c,f,p,C){for(var A=c._reactName,U=[];f!==null&&f!==p;){var ee=f,je=ee.alternate,Ye=ee.stateNode;if(ee=ee.tag,je!==null&&je===p)break;ee!==5&&ee!==26&&ee!==27||Ye===null||(je=Ye,C?(Ye=ht(f,A),Ye!=null&&U.unshift(Hd(f,Ye,je))):C||(Ye=ht(f,A),Ye!=null&&U.push(Hd(f,Ye,je)))),f=f.return}U.length!==0&&i.push({event:c,listeners:U})}var s1=/\r\n?/g,r1=/\u0000|\uFFFD/g;function Nn(i){return(typeof i=="string"?i:""+i).replace(s1,`
`).replace(r1,"")}function Df(i,c){return c=Nn(c),Nn(i)===c}function mr(i,c,f,p,C,A){switch(f){case"children":typeof p=="string"?c==="body"||c==="textarea"&&p===""||Ri(i,p):(typeof p=="number"||typeof p=="bigint")&&c!=="body"&&Ri(i,""+p);break;case"className":Mr(i,"class",p);break;case"tabIndex":Mr(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Mr(i,f,p);break;case"style":hr(i,p,A);break;case"data":if(c!=="object"){Mr(i,"data",p);break}case"src":case"href":if(p===""&&(c!=="a"||f!=="href")){i.removeAttribute(f);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=Ue(""+p),i.setAttribute(f,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(f==="formAction"?(c!=="input"&&mr(i,c,"name",C.name,C,null),mr(i,c,"formEncType",C.formEncType,C,null),mr(i,c,"formMethod",C.formMethod,C,null),mr(i,c,"formTarget",C.formTarget,C,null)):(mr(i,c,"encType",C.encType,C,null),mr(i,c,"method",C.method,C,null),mr(i,c,"target",C.target,C,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=Ue(""+p),i.setAttribute(f,p);break;case"onClick":p!=null&&(i.onclick=Xe);break;case"onScroll":p!=null&&hs("scroll",i);break;case"onScrollEnd":p!=null&&hs("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(o(61));if(f=p.__html,f!=null){if(C.children!=null)throw Error(o(60));i.innerHTML=f}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}f=Ue(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""+p):i.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""):i.removeAttribute(f);break;case"capture":case"download":p===!0?i.setAttribute(f,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,p):i.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(f,p):i.removeAttribute(f);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(f):i.setAttribute(f,p);break;case"popover":hs("beforetoggle",i),hs("toggle",i),Uo(i,"popover",p);break;case"xlinkActuate":qn(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":qn(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":qn(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":qn(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":qn(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":qn(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":qn(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":qn(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":qn(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Uo(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Ge.get(f)||f,Uo(i,f,p))}}function Tf(i,c,f,p,C,A){switch(f){case"style":hr(i,p,A);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(o(61));if(f=p.__html,f!=null){if(C.children!=null)throw Error(o(60));i.innerHTML=f}}break;case"children":typeof p=="string"?Ri(i,p):(typeof p=="number"||typeof p=="bigint")&&Ri(i,""+p);break;case"onScroll":p!=null&&hs("scroll",i);break;case"onScrollEnd":p!=null&&hs("scrollend",i);break;case"onClick":p!=null&&(i.onclick=Xe);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ma.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(C=f.endsWith("Capture"),c=f.slice(2,C?f.length-7:void 0),A=i[Ts]||null,A=A!=null?A[f]:null,typeof A=="function"&&i.removeEventListener(c,A,C),typeof p=="function")){typeof A!="function"&&A!==null&&(f in i?i[f]=null:i.hasAttribute(f)&&i.removeAttribute(f)),i.addEventListener(c,p,C);break e}f in i?i[f]=p:p===!0?i.setAttribute(f,""):Uo(i,f,p)}}}function wa(i,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":hs("error",i),hs("load",i);var p=!1,C=!1,A;for(A in f)if(f.hasOwnProperty(A)){var U=f[A];if(U!=null)switch(A){case"src":p=!0;break;case"srcSet":C=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,c));default:mr(i,c,A,U,f,null)}}C&&mr(i,c,"srcSet",f.srcSet,f,null),p&&mr(i,c,"src",f.src,f,null);return;case"input":hs("invalid",i);var ee=A=U=C=null,je=null,Ye=null;for(p in f)if(f.hasOwnProperty(p)){var ut=f[p];if(ut!=null)switch(p){case"name":C=ut;break;case"type":U=ut;break;case"checked":je=ut;break;case"defaultChecked":Ye=ut;break;case"value":A=ut;break;case"defaultValue":ee=ut;break;case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(o(137,c));break;default:mr(i,c,p,ut,f,null)}}Qc(i,A,ee,je,Ye,U,C,!1);return;case"select":hs("invalid",i),p=U=A=null;for(C in f)if(f.hasOwnProperty(C)&&(ee=f[C],ee!=null))switch(C){case"value":A=ee;break;case"defaultValue":U=ee;break;case"multiple":p=ee;default:mr(i,c,C,ee,f,null)}c=A,f=U,i.multiple=!!p,c!=null?mi(i,!!p,c,!1):f!=null&&mi(i,!!p,f,!0);return;case"textarea":hs("invalid",i),A=C=p=null;for(U in f)if(f.hasOwnProperty(U)&&(ee=f[U],ee!=null))switch(U){case"value":p=ee;break;case"defaultValue":C=ee;break;case"children":A=ee;break;case"dangerouslySetInnerHTML":if(ee!=null)throw Error(o(91));break;default:mr(i,c,U,ee,f,null)}Vo(i,p,C,A);return;case"option":for(je in f)f.hasOwnProperty(je)&&(p=f[je],p!=null)&&(je==="selected"?i.selected=p&&typeof p!="function"&&typeof p!="symbol":mr(i,c,je,p,f,null));return;case"dialog":hs("beforetoggle",i),hs("toggle",i),hs("cancel",i),hs("close",i);break;case"iframe":case"object":hs("load",i);break;case"video":case"audio":for(p=0;p<Ao.length;p++)hs(Ao[p],i);break;case"image":hs("error",i),hs("load",i);break;case"details":hs("toggle",i);break;case"embed":case"source":case"link":hs("error",i),hs("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ye in f)if(f.hasOwnProperty(Ye)&&(p=f[Ye],p!=null))switch(Ye){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,c));default:mr(i,c,Ye,p,f,null)}return;default:if(K(c)){for(ut in f)f.hasOwnProperty(ut)&&(p=f[ut],p!==void 0&&Tf(i,c,ut,p,f,void 0));return}}for(ee in f)f.hasOwnProperty(ee)&&(p=f[ee],p!=null&&mr(i,c,ee,p,f,null))}function _f(i,c,f,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var C=null,A=null,U=null,ee=null,je=null,Ye=null,ut=null;for(lt in f){var mt=f[lt];if(f.hasOwnProperty(lt)&&mt!=null)switch(lt){case"checked":break;case"value":break;case"defaultValue":je=mt;default:p.hasOwnProperty(lt)||mr(i,c,lt,null,p,mt)}}for(var et in p){var lt=p[et];if(mt=f[et],p.hasOwnProperty(et)&&(lt!=null||mt!=null))switch(et){case"type":A=lt;break;case"name":C=lt;break;case"checked":Ye=lt;break;case"defaultChecked":ut=lt;break;case"value":U=lt;break;case"defaultValue":ee=lt;break;case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(o(137,c));break;default:lt!==mt&&mr(i,c,et,lt,p,mt)}}fi(i,U,ee,je,Ye,ut,A,C);return;case"select":lt=U=ee=et=null;for(A in f)if(je=f[A],f.hasOwnProperty(A)&&je!=null)switch(A){case"value":break;case"multiple":lt=je;default:p.hasOwnProperty(A)||mr(i,c,A,null,p,je)}for(C in p)if(A=p[C],je=f[C],p.hasOwnProperty(C)&&(A!=null||je!=null))switch(C){case"value":et=A;break;case"defaultValue":ee=A;break;case"multiple":U=A;default:A!==je&&mr(i,c,C,A,p,je)}c=ee,f=U,p=lt,et!=null?mi(i,!!f,et,!1):!!p!=!!f&&(c!=null?mi(i,!!f,c,!0):mi(i,!!f,f?[]:"",!1));return;case"textarea":lt=et=null;for(ee in f)if(C=f[ee],f.hasOwnProperty(ee)&&C!=null&&!p.hasOwnProperty(ee))switch(ee){case"value":break;case"children":break;default:mr(i,c,ee,null,p,C)}for(U in p)if(C=p[U],A=f[U],p.hasOwnProperty(U)&&(C!=null||A!=null))switch(U){case"value":et=C;break;case"defaultValue":lt=C;break;case"children":break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(o(91));break;default:C!==A&&mr(i,c,U,C,p,A)}Ho(i,et,lt);return;case"option":for(var ts in f)et=f[ts],f.hasOwnProperty(ts)&&et!=null&&!p.hasOwnProperty(ts)&&(ts==="selected"?i.selected=!1:mr(i,c,ts,null,p,et));for(je in p)et=p[je],lt=f[je],p.hasOwnProperty(je)&&et!==lt&&(et!=null||lt!=null)&&(je==="selected"?i.selected=et&&typeof et!="function"&&typeof et!="symbol":mr(i,c,je,et,p,lt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bs in f)et=f[bs],f.hasOwnProperty(bs)&&et!=null&&!p.hasOwnProperty(bs)&&mr(i,c,bs,null,p,et);for(Ye in p)if(et=p[Ye],lt=f[Ye],p.hasOwnProperty(Ye)&&et!==lt&&(et!=null||lt!=null))switch(Ye){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(o(137,c));break;default:mr(i,c,Ye,et,p,lt)}return;default:if(K(c)){for(var Ar in f)et=f[Ar],f.hasOwnProperty(Ar)&&et!==void 0&&!p.hasOwnProperty(Ar)&&Tf(i,c,Ar,void 0,p,et);for(ut in p)et=p[ut],lt=f[ut],!p.hasOwnProperty(ut)||et===lt||et===void 0&&lt===void 0||Tf(i,c,ut,et,p,lt);return}}for(var $e in f)et=f[$e],f.hasOwnProperty($e)&&et!=null&&!p.hasOwnProperty($e)&&mr(i,c,$e,null,p,et);for(mt in p)et=p[mt],lt=f[mt],!p.hasOwnProperty(mt)||et===lt||et==null&&lt==null||mr(i,c,mt,et,p,lt)}function Ff(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Mf(){if(typeof performance.getEntriesByType=="function"){for(var i=0,c=0,f=performance.getEntriesByType("resource"),p=0;p<f.length;p++){var C=f[p],A=C.transferSize,U=C.initiatorType,ee=C.duration;if(A&&ee&&Ff(U)){for(U=0,ee=C.responseEnd,p+=1;p<f.length;p++){var je=f[p],Ye=je.startTime;if(Ye>ee)break;var ut=je.transferSize,mt=je.initiatorType;ut&&Ff(mt)&&(je=je.responseEnd,U+=ut*(je<ee?1:(ee-Ye)/(je-Ye)))}if(--p,c+=8*(A+U)/(C.duration/1e3),i++,10<i)break}}if(0<i)return c/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Ec=null,Mu=null;function Wd(i){return i.nodeType===9?i:i.ownerDocument}function Lf(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ni(i,c){if(i===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&c==="foreignObject"?0:i}function Dc(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var $d=null;function Lu(){var i=window.event;return i&&i.type==="popstate"?i===$d?!1:($d=i,!0):($d=null,!1)}var Ru=typeof setTimeout=="function"?setTimeout:void 0,Ig=typeof clearTimeout=="function"?clearTimeout:void 0,Rf=typeof Promise=="function"?Promise:void 0,Ou=typeof queueMicrotask=="function"?queueMicrotask:typeof Rf<"u"?function(i){return Rf.resolve(null).then(i).catch(Bg)}:Ru;function Bg(i){setTimeout(function(){throw i})}function ll(i){return i==="head"}function Pu(i,c){var f=c,p=0;do{var C=f.nextSibling;if(i.removeChild(f),C&&C.nodeType===8)if(f=C.data,f==="/$"||f==="/&"){if(p===0){i.removeChild(C),ns(c);return}p--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")p++;else if(f==="html")d(i.ownerDocument.documentElement);else if(f==="head"){f=i.ownerDocument.head,d(f);for(var A=f.firstChild;A;){var U=A.nextSibling,ee=A.nodeName;A[Cn]||ee==="SCRIPT"||ee==="STYLE"||ee==="LINK"&&A.rel.toLowerCase()==="stylesheet"||f.removeChild(A),A=U}}else f==="body"&&d(i.ownerDocument.body);f=C}while(f);ns(c)}function Of(i,c){var f=i;i=0;do{var p=f.nextSibling;if(f.nodeType===1?c?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(c?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),p&&p.nodeType===8)if(f=p.data,f==="/$"){if(i===0)break;i--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||i++;f=p}while(f)}function Iu(i){var c=i.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Iu(f),fl(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}i.removeChild(f)}}function Bu(i,c,f,p){for(;i.nodeType===1;){var C=f;if(i.nodeName.toLowerCase()!==c.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Cn])switch(c){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(A=i.getAttribute("rel"),A==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(A!==C.rel||i.getAttribute("href")!==(C.href==null||C.href===""?null:C.href)||i.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin)||i.getAttribute("title")!==(C.title==null?null:C.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(A=i.getAttribute("src"),(A!==(C.src==null?null:C.src)||i.getAttribute("type")!==(C.type==null?null:C.type)||i.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin))&&A&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(c==="input"&&i.type==="hidden"){var A=C.name==null?null:""+C.name;if(C.type==="hidden"&&i.getAttribute("name")===A)return i}else return i;if(i=kn(i.nextSibling),i===null)break}return null}function Pf(i,c,f){if(c==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!f||(i=kn(i.nextSibling),i===null))return null;return i}function zu(i,c){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=kn(i.nextSibling),i===null))return null;return i}function Uu(i){return i.data==="$?"||i.data==="$~"}function Tc(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function If(i,c){var f=i.ownerDocument;if(i.data==="$~")i._reactRetry=c;else if(i.data!=="$?"||f.readyState!=="loading")c();else{var p=function(){c(),f.removeEventListener("DOMContentLoaded",p)};f.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function kn(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return i}var Pl=null;function $s(i){i=i.nextSibling;for(var c=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"||f==="/&"){if(c===0)return kn(i.nextSibling);c--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||c++}i=i.nextSibling}return null}function zg(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(c===0)return i;c--}else f!=="/$"&&f!=="/&"||c++}i=i.previousSibling}return null}function r(i,c,f){switch(c=Wd(f),i){case"html":if(i=c.documentElement,!i)throw Error(o(452));return i;case"head":if(i=c.head,!i)throw Error(o(453));return i;case"body":if(i=c.body,!i)throw Error(o(454));return i;default:throw Error(o(451))}}function d(i){for(var c=i.attributes;c.length;)i.removeAttributeNode(c[0]);fl(i)}var u=new Map,h=new Set;function g(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var b=_e.d;_e.d={f:x,r:y,D:E,C:T,L:_,m:R,X:I,S:q,M:J};function x(){var i=b.f(),c=wu();return i||c}function y(i){var c=cn(i);c!==null&&c.tag===5&&c.type==="form"?$m(c):b.r(i)}var j=typeof document>"u"?null:document;function k(i,c,f){var p=j;if(p&&typeof c=="string"&&c){var C=ys(c);C='link[rel="'+i+'"][href="'+C+'"]',typeof f=="string"&&(C+='[crossorigin="'+f+'"]'),h.has(C)||(h.add(C),i={rel:i,crossOrigin:f,href:c},p.querySelector(C)===null&&(c=p.createElement("link"),wa(c,"link",i),qr(c),p.head.appendChild(c)))}}function E(i){b.D(i),k("dns-prefetch",i,null)}function T(i,c){b.C(i,c),k("preconnect",i,c)}function _(i,c,f){b.L(i,c,f);var p=j;if(p&&i&&c){var C='link[rel="preload"][as="'+ys(c)+'"]';c==="image"&&f&&f.imageSrcSet?(C+='[imagesrcset="'+ys(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(C+='[imagesizes="'+ys(f.imageSizes)+'"]')):C+='[href="'+ys(i)+'"]';var A=C;switch(c){case"style":A=z(i);break;case"script":A=Ae(i)}u.has(A)||(i=D({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:i,as:c},f),u.set(A,i),p.querySelector(C)!==null||c==="style"&&p.querySelector(X(A))||c==="script"&&p.querySelector(Ve(A))||(c=p.createElement("link"),wa(c,"link",i),qr(c),p.head.appendChild(c)))}}function R(i,c){b.m(i,c);var f=j;if(f&&i){var p=c&&typeof c.as=="string"?c.as:"script",C='link[rel="modulepreload"][as="'+ys(p)+'"][href="'+ys(i)+'"]',A=C;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Ae(i)}if(!u.has(A)&&(i=D({rel:"modulepreload",href:i},c),u.set(A,i),f.querySelector(C)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Ve(A)))return}p=f.createElement("link"),wa(p,"link",i),qr(p),f.head.appendChild(p)}}}function q(i,c,f){b.S(i,c,f);var p=j;if(p&&i){var C=ca(p).hoistableStyles,A=z(i);c=c||"default";var U=C.get(A);if(!U){var ee={loading:0,preload:null};if(U=p.querySelector(X(A)))ee.loading=5;else{i=D({rel:"stylesheet",href:i,"data-precedence":c},f),(f=u.get(A))&&pt(i,f);var je=U=p.createElement("link");qr(je),wa(je,"link",i),je._p=new Promise(function(Ye,ut){je.onload=Ye,je.onerror=ut}),je.addEventListener("load",function(){ee.loading|=1}),je.addEventListener("error",function(){ee.loading|=2}),ee.loading|=4,Je(U,c,p)}U={type:"stylesheet",instance:U,count:1,state:ee},C.set(A,U)}}}function I(i,c){b.X(i,c);var f=j;if(f&&i){var p=ca(f).hoistableScripts,C=Ae(i),A=p.get(C);A||(A=f.querySelector(Ve(C)),A||(i=D({src:i,async:!0},c),(c=u.get(C))&&xt(i,c),A=f.createElement("script"),qr(A),wa(A,"link",i),f.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(C,A))}}function J(i,c){b.M(i,c);var f=j;if(f&&i){var p=ca(f).hoistableScripts,C=Ae(i),A=p.get(C);A||(A=f.querySelector(Ve(C)),A||(i=D({src:i,async:!0,type:"module"},c),(c=u.get(C))&&xt(i,c),A=f.createElement("script"),qr(A),wa(A,"link",i),f.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(C,A))}}function Y(i,c,f,p){var C=(C=H.current)?g(C):null;if(!C)throw Error(o(446));switch(i){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=z(f.href),f=ca(C).hoistableStyles,p=f.get(c),p||(p={type:"style",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){i=z(f.href);var A=ca(C).hoistableStyles,U=A.get(i);if(U||(C=C.ownerDocument||C,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(i,U),(A=C.querySelector(X(i)))&&!A._p&&(U.instance=A,U.state.loading=5),u.has(i)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},u.set(i,f),A||le(C,i,f,U.state))),c&&p===null)throw Error(o(528,""));return U}if(c&&p!==null)throw Error(o(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Ae(f),f=ca(C).hoistableScripts,p=f.get(c),p||(p={type:"script",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,i))}}function z(i){return'href="'+ys(i)+'"'}function X(i){return'link[rel="stylesheet"]['+i+"]"}function ie(i){return D({},i,{"data-precedence":i.precedence,precedence:null})}function le(i,c,f,p){i.querySelector('link[rel="preload"][as="style"]['+c+"]")?p.loading=1:(c=i.createElement("link"),p.preload=c,c.addEventListener("load",function(){return p.loading|=1}),c.addEventListener("error",function(){return p.loading|=2}),wa(c,"link",f),qr(c),i.head.appendChild(c))}function Ae(i){return'[src="'+ys(i)+'"]'}function Ve(i){return"script[async]"+i}function Oe(i,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var p=i.querySelector('style[data-href~="'+ys(f.href)+'"]');if(p)return c.instance=p,qr(p),p;var C=D({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),qr(p),wa(p,"style",C),Je(p,f.precedence,i),c.instance=p;case"stylesheet":C=z(f.href);var A=i.querySelector(X(C));if(A)return c.state.loading|=4,c.instance=A,qr(A),A;p=ie(f),(C=u.get(C))&&pt(p,C),A=(i.ownerDocument||i).createElement("link"),qr(A);var U=A;return U._p=new Promise(function(ee,je){U.onload=ee,U.onerror=je}),wa(A,"link",p),c.state.loading|=4,Je(A,f.precedence,i),c.instance=A;case"script":return A=Ae(f.src),(C=i.querySelector(Ve(A)))?(c.instance=C,qr(C),C):(p=f,(C=u.get(A))&&(p=D({},f),xt(p,C)),i=i.ownerDocument||i,C=i.createElement("script"),qr(C),wa(C,"link",p),i.head.appendChild(C),c.instance=C);case"void":return null;default:throw Error(o(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(p=c.instance,c.state.loading|=4,Je(p,f.precedence,i));return c.instance}function Je(i,c,f){for(var p=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),C=p.length?p[p.length-1]:null,A=C,U=0;U<p.length;U++){var ee=p[U];if(ee.dataset.precedence===c)A=ee;else if(A!==C)break}A?A.parentNode.insertBefore(i,A.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(i,c.firstChild))}function pt(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.title==null&&(i.title=c.title)}function xt(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.integrity==null&&(i.integrity=c.integrity)}var at=null;function Ct(i,c,f){if(at===null){var p=new Map,C=at=new Map;C.set(f,p)}else C=at,p=C.get(f),p||(p=new Map,C.set(f,p));if(p.has(i))return p;for(p.set(i,null),f=f.getElementsByTagName(i),C=0;C<f.length;C++){var A=f[C];if(!(A[Cn]||A[oa]||i==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var U=A.getAttribute(c)||"";U=i+U;var ee=p.get(U);ee?ee.push(A):p.set(U,[A])}}return p}function Vt(i,c,f){i=i.ownerDocument||i,i.head.insertBefore(f,c==="title"?i.querySelector("head > title"):null)}function Ut(i,c,f){if(f===1||c.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(i=c.disabled,typeof c.precedence=="string"&&i==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Ft(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Mt(i,c,f,p){if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var C=z(p.href),A=c.querySelector(X(C));if(A){c=A._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(i.count++,i=Yt.bind(i),c.then(i,i)),f.state.loading|=4,f.instance=A,qr(A);return}A=c.ownerDocument||c,p=ie(p),(C=u.get(C))&&pt(p,C),A=A.createElement("link"),qr(A);var U=A;U._p=new Promise(function(ee,je){U.onload=ee,U.onerror=je}),wa(A,"link",p),f.instance=A}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(i.count++,f=Yt.bind(i),c.addEventListener("load",f),c.addEventListener("error",f))}}var Dt=0;function wt(i,c){return i.stylesheets&&i.count===0&&is(i,i.stylesheets),0<i.count||0<i.imgCount?function(f){var p=setTimeout(function(){if(i.stylesheets&&is(i,i.stylesheets),i.unsuspend){var A=i.unsuspend;i.unsuspend=null,A()}},6e4+c);0<i.imgBytes&&Dt===0&&(Dt=62500*Mf());var C=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&is(i,i.stylesheets),i.unsuspend)){var A=i.unsuspend;i.unsuspend=null,A()}},(i.imgBytes>Dt?50:800)+c);return i.unsuspend=f,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(C)}}:null}function Yt(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)is(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Jt=null;function is(i,c){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Jt=new Map,c.forEach(Fs,i),Jt=null,Yt.call(i))}function Fs(i,c){if(!(c.state.loading&4)){var f=Jt.get(i);if(f)var p=f.get(null);else{f=new Map,Jt.set(i,f);for(var C=i.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<C.length;A++){var U=C[A];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(f.set(U.dataset.precedence,U),p=U)}p&&f.set(null,p)}C=c.instance,U=C.getAttribute("data-precedence"),A=f.get(U)||p,A===p&&f.set(null,C),f.set(U,C),this.count++,p=Yt.bind(this),C.addEventListener("load",p),C.addEventListener("error",p),A?A.parentNode.insertBefore(C,A.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(C,i.firstChild)),c.state.loading|=4}}var Wt={$$typeof:re,Provider:null,Consumer:null,_currentValue:We,_currentValue2:We,_threadCount:0};function St(i,c,f,p,C,A,U,ee,je){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Yc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yc(0),this.hiddenUpdates=Yc(null),this.identifierPrefix=p,this.onUncaughtError=C,this.onCaughtError=A,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=je,this.incompleteTransitions=new Map}function xs(i,c,f,p,C,A,U,ee,je,Ye,ut,mt){return i=new St(i,c,f,U,je,Ye,ut,mt,ee),c=1,A===!0&&(c|=24),A=Lr(3,null,null,c),i.current=A,A.stateNode=i,c=tc(),c.refCount++,i.pooledCache=c,c.refCount++,A.memoizedState={element:p,isDehydrated:f,cache:c},B0(A),i}function Hs(i){return i?(i=ro,i):ro}function Is(i,c,f,p,C,A){C=Hs(C),p.context===null?p.context=C:p.pendingContext=C,p=Aa(c),p.payload={element:f},A=A===void 0?null:A,A!==null&&(p.callback=A),f=qi(i,p,c),f!==null&&(Ya(f,i,c),uo(f,i,c))}function tr(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<c?f:c}}function Ir(i,c){tr(i,c),(i=i.alternate)&&tr(i,c)}function Fe(i){if(i.tag===13||i.tag===31){var c=_n(i,67108864);c!==null&&Ya(c,i,67108864),Ir(i,67108864)}}function sr(i){if(i.tag===13||i.tag===31){var c=qa();c=hl(c);var f=_n(i,c);f!==null&&Ya(f,i,c),Ir(i,c)}}var qs=!0;function fa(i,c,f,p){var C=fe.T;fe.T=null;var A=_e.p;try{_e.p=2,ge(i,c,f,p)}finally{_e.p=A,fe.T=C}}function Pn(i,c,f,p){var C=fe.T;fe.T=null;var A=_e.p;try{_e.p=8,ge(i,c,f,p)}finally{_e.p=A,fe.T=C}}function ge(i,c,f,p){if(qs){var C=it(p);if(C===null)_u(i,c,p,Ee,f),Bt(i,p);else if(rs(C,i,c,f,p))p.stopPropagation();else if(Bt(i,p),c&4&&-1<Gt.indexOf(i)){for(;C!==null;){var A=cn(C);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var U=Wn(A.pendingLanes);if(U!==0){var ee=A;for(ee.pendingLanes|=2,ee.entangledLanes|=2;U;){var je=1<<31-Br(U);ee.entanglements[1]|=je,U&=~je}va(A),(ar&6)===0&&(xu=ds()+500,Co(0))}}break;case 31:case 13:ee=_n(A,2),ee!==null&&Ya(ee,A,2),wu(),Ir(A,2)}if(A=it(p),A===null&&_u(i,c,p,Ee,f),A===C)break;C=A}C!==null&&p.stopPropagation()}else _u(i,c,p,null,f)}}function it(i){return i=qe(i),rt(i)}var Ee=null;function rt(i){if(Ee=null,i=Na(i),i!==null){var c=e(i);if(c===null)i=null;else{var f=c.tag;if(f===13){if(i=m(c),i!==null)return i;i=null}else if(f===31){if(i=v(c),i!==null)return i;i=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null)}}return Ee=i,null}function Ce(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ie()){case dt:return 2;case Tt:return 8;case ms:case nn:return 32;case rr:return 268435456;default:return 32}default:return 32}}var jt=!1,Ze=null,ot=null,Qe=null,ft=new Map,At=new Map,Kt=[],Gt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Bt(i,c){switch(i){case"focusin":case"focusout":Ze=null;break;case"dragenter":case"dragleave":ot=null;break;case"mouseover":case"mouseout":Qe=null;break;case"pointerover":case"pointerout":ft.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(c.pointerId)}}function Qt(i,c,f,p,C,A){return i===null||i.nativeEvent!==A?(i={blockedOn:c,domEventName:f,eventSystemFlags:p,nativeEvent:A,targetContainers:[C]},c!==null&&(c=cn(c),c!==null&&Fe(c)),i):(i.eventSystemFlags|=p,c=i.targetContainers,C!==null&&c.indexOf(C)===-1&&c.push(C),i)}function rs(i,c,f,p,C){switch(c){case"focusin":return Ze=Qt(Ze,i,c,f,p,C),!0;case"dragenter":return ot=Qt(ot,i,c,f,p,C),!0;case"mouseover":return Qe=Qt(Qe,i,c,f,p,C),!0;case"pointerover":var A=C.pointerId;return ft.set(A,Qt(ft.get(A)||null,i,c,f,p,C)),!0;case"gotpointercapture":return A=C.pointerId,At.set(A,Qt(At.get(A)||null,i,c,f,p,C)),!0}return!1}function ss(i){var c=Na(i.target);if(c!==null){var f=e(c);if(f!==null){if(c=f.tag,c===13){if(c=m(f),c!==null){i.blockedOn=c,$r(i.priority,function(){sr(f)});return}}else if(c===31){if(c=v(f),c!==null){i.blockedOn=c,$r(i.priority,function(){sr(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Lt(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var f=it(i.nativeEvent);if(f===null){f=i.nativeEvent;var p=new f.constructor(f.type,f);ze=p,f.target.dispatchEvent(p),ze=null}else return c=cn(f),c!==null&&Fe(c),i.blockedOn=f,!1;c.shift()}return!0}function Et(i,c,f){Lt(i)&&f.delete(c)}function as(){jt=!1,Ze!==null&&Lt(Ze)&&(Ze=null),ot!==null&&Lt(ot)&&(ot=null),Qe!==null&&Lt(Qe)&&(Qe=null),ft.forEach(Et),At.forEach(Et)}function $t(i,c){i.blockedOn===c&&(i.blockedOn=null,jt||(jt=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,as)))}var _t=null;function os(i){_t!==i&&(_t=i,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){_t===i&&(_t=null);for(var c=0;c<i.length;c+=3){var f=i[c],p=i[c+1],C=i[c+2];if(typeof p!="function"){if(rt(p||f)===null)continue;break}var A=cn(f);A!==null&&(i.splice(c,3),c-=3,Yh(A,{pending:!0,data:C,method:f.method,action:p},p,C))}}))}function ns(i){function c(je){return $t(je,i)}Ze!==null&&$t(Ze,i),ot!==null&&$t(ot,i),Qe!==null&&$t(Qe,i),ft.forEach(c),At.forEach(c);for(var f=0;f<Kt.length;f++){var p=Kt[f];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Kt.length&&(f=Kt[0],f.blockedOn===null);)ss(f),f.blockedOn===null&&Kt.shift();if(f=(i.ownerDocument||i).$$reactFormReplay,f!=null)for(p=0;p<f.length;p+=3){var C=f[p],A=f[p+1],U=C[Ts]||null;if(typeof A=="function")U||os(f);else if(U){var ee=null;if(A&&A.hasAttribute("formAction")){if(C=A,U=A[Ts]||null)ee=U.formAction;else if(rt(C)!==null)continue}else ee=U.action;typeof ee=="function"?f[p+1]=ee:(f.splice(p,3),p-=3),os(f)}}}function gr(){function i(A){A.canIntercept&&A.info==="react-transition"&&A.intercept({handler:function(){return new Promise(function(U){return C=U})},focusReset:"manual",scroll:"manual"})}function c(){C!==null&&(C(),C=null),p||setTimeout(f,20)}function f(){if(!p&&!navigation.transition){var A=navigation.currentEntry;A&&A.url!=null&&navigation.navigate(A.url,{state:A.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,C=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(f,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),C!==null&&(C(),C=null)}}}function us(i){this._internalRoot=i}js.prototype.render=us.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(o(409));var f=c.current,p=qa();Is(f,p,i,c,null,null)},js.prototype.unmount=us.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;Is(i.current,2,null,i,null,null),wu(),c[ur]=null}};function js(i){this._internalRoot=i}js.prototype.unstable_scheduleHydration=function(i){if(i){var c=Li();i={blockedOn:null,target:i,priority:c};for(var f=0;f<Kt.length&&c!==0&&c<Kt[f].priority;f++);Kt.splice(f,0,i),f===0&&ss(i)}};var es=n.version;if(es!=="19.2.3")throw Error(o(527,es,"19.2.3"));_e.findDOMNode=function(i){var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(o(188)):(i=Object.keys(i).join(","),Error(o(268,i)));return i=N(c),i=i!==null?S(i):null,i=i===null?null:i.stateNode,i};var Us={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:fe,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rs.isDisabled&&Rs.supportsFiber)try{Vn=Rs.inject(Us),_a=Rs}catch{}}return zf.createRoot=function(i,c){if(!s(i))throw Error(o(299));var f=!1,p="",C=tu,A=sg,U=rg;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(C=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError)),c=xs(i,1,!1,null,null,f,p,null,C,A,U,gr),i[ur]=c.current,Af(i),new us(c)},zf.hydrateRoot=function(i,c,f){if(!s(i))throw Error(o(299));var p=!1,C="",A=tu,U=sg,ee=rg,je=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(C=f.identifierPrefix),f.onUncaughtError!==void 0&&(A=f.onUncaughtError),f.onCaughtError!==void 0&&(U=f.onCaughtError),f.onRecoverableError!==void 0&&(ee=f.onRecoverableError),f.formState!==void 0&&(je=f.formState)),c=xs(i,1,!0,c,f??null,p,C,je,A,U,ee,gr),c.context=Hs(null),f=c.current,p=qa(),p=hl(p),C=Aa(p),C.callback=null,qi(f,C,p),f=p,c.current.lanes=f,$n(c,f),va(c),i[ur]=c.current,Af(i),new js(c)},zf.version="19.2.3",zf}var Rx;function Ov(){if(Rx)return i1.exports;Rx=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(n){console.error(n)}}return l(),i1.exports=Rv(),i1.exports}var Pv=Ov();const Iv=Ob(Pv);var Ox="popstate";function Bv(l={}){function n(o,s){let{pathname:e,search:m,hash:v}=o.location;return B1("",{pathname:e,search:m,hash:v},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(o,s){return typeof s=="string"?s:rm(s)}return Uv(n,a,null,l)}function Xr(l,n){if(l===!1||l===null||typeof l>"u")throw new Error(n)}function li(l,n){if(!l){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function zv(){return Math.random().toString(36).substring(2,10)}function Px(l,n){return{usr:l.state,key:l.key,idx:n}}function B1(l,n,a=null,o){return{pathname:typeof l=="string"?l:l.pathname,search:"",hash:"",...typeof n=="string"?Ju(n):n,state:a,key:n&&n.key||o||zv()}}function rm({pathname:l="/",search:n="",hash:a=""}){return n&&n!=="?"&&(l+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(l+=a.charAt(0)==="#"?a:"#"+a),l}function Ju(l){let n={};if(l){let a=l.indexOf("#");a>=0&&(n.hash=l.substring(a),l=l.substring(0,a));let o=l.indexOf("?");o>=0&&(n.search=l.substring(o),l=l.substring(0,o)),l&&(n.pathname=l)}return n}function Uv(l,n,a,o={}){let{window:s=document.defaultView,v5Compat:e=!1}=o,m=s.history,v="POP",w=null,N=S();N==null&&(N=0,m.replaceState({...m.state,idx:N},""));function S(){return(m.state||{idx:null}).idx}function D(){v="POP";let P=S(),G=P==null?null:P-N;N=P,w&&w({action:v,location:O.location,delta:G})}function L(P,G){v="PUSH";let ae=B1(O.location,P,G);N=S()+1;let re=Px(ae,N),Ne=O.createHref(ae);try{m.pushState(re,"",Ne)}catch(xe){if(xe instanceof DOMException&&xe.name==="DataCloneError")throw xe;s.location.assign(Ne)}e&&w&&w({action:v,location:O.location,delta:1})}function M(P,G){v="REPLACE";let ae=B1(O.location,P,G);N=S();let re=Px(ae,N),Ne=O.createHref(ae);m.replaceState(re,"",Ne),e&&w&&w({action:v,location:O.location,delta:0})}function F(P){return Hv(P)}let O={get action(){return v},get location(){return l(s,m)},listen(P){if(w)throw new Error("A history only accepts one active listener");return s.addEventListener(Ox,D),w=P,()=>{s.removeEventListener(Ox,D),w=null}},createHref(P){return n(s,P)},createURL:F,encodeLocation(P){let G=F(P);return{pathname:G.pathname,search:G.search,hash:G.hash}},push:L,replace:M,go(P){return m.go(P)}};return O}function Hv(l,n=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),Xr(a,"No window.location.(origin|href) available to create URL");let o=typeof l=="string"?l:rm(l);return o=o.replace(/ $/,"%20"),!n&&o.startsWith("//")&&(o=a+o),new URL(o,a)}function Pb(l,n,a="/"){return Vv(l,n,a,!1)}function Vv(l,n,a,o){let s=typeof n=="string"?Ju(n):n,e=Po(s.pathname||"/",a);if(e==null)return null;let m=Ib(l);Wv(m);let v=null;for(let w=0;v==null&&w<m.length;++w){let N=t4(e);v=Zv(m[w],N,o)}return v}function Ib(l,n=[],a=[],o="",s=!1){let e=(m,v,w=s,N)=>{let S={relativePath:N===void 0?m.path||"":N,caseSensitive:m.caseSensitive===!0,childrenIndex:v,route:m};if(S.relativePath.startsWith("/")){if(!S.relativePath.startsWith(o)&&w)return;Xr(S.relativePath.startsWith(o),`Absolute route path "${S.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),S.relativePath=S.relativePath.slice(o.length)}let D=Oo([o,S.relativePath]),L=a.concat(S);m.children&&m.children.length>0&&(Xr(m.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${D}".`),Ib(m.children,n,L,D,w)),!(m.path==null&&!m.index)&&n.push({path:D,score:Xv(D,m.index),routesMeta:L})};return l.forEach((m,v)=>{if(m.path===""||!m.path?.includes("?"))e(m,v);else for(let w of Bb(m.path))e(m,v,!0,w)}),n}function Bb(l){let n=l.split("/");if(n.length===0)return[];let[a,...o]=n,s=a.endsWith("?"),e=a.replace(/\?$/,"");if(o.length===0)return s?[e,""]:[e];let m=Bb(o.join("/")),v=[];return v.push(...m.map(w=>w===""?e:[e,w].join("/"))),s&&v.push(...m),v.map(w=>l.startsWith("/")&&w===""?"/":w)}function Wv(l){l.sort((n,a)=>n.score!==a.score?a.score-n.score:Jv(n.routesMeta.map(o=>o.childrenIndex),a.routesMeta.map(o=>o.childrenIndex)))}var $v=/^:[\w-]+$/,qv=3,Yv=2,Gv=1,Kv=10,Qv=-2,Ix=l=>l==="*";function Xv(l,n){let a=l.split("/"),o=a.length;return a.some(Ix)&&(o+=Qv),n&&(o+=Yv),a.filter(s=>!Ix(s)).reduce((s,e)=>s+($v.test(e)?qv:e===""?Gv:Kv),o)}function Jv(l,n){return l.length===n.length&&l.slice(0,-1).every((o,s)=>o===n[s])?l[l.length-1]-n[n.length-1]:0}function Zv(l,n,a=!1){let{routesMeta:o}=l,s={},e="/",m=[];for(let v=0;v<o.length;++v){let w=o[v],N=v===o.length-1,S=e==="/"?n:n.slice(e.length)||"/",D=gp({path:w.relativePath,caseSensitive:w.caseSensitive,end:N},S),L=w.route;if(!D&&N&&a&&!o[o.length-1].route.index&&(D=gp({path:w.relativePath,caseSensitive:w.caseSensitive,end:!1},S)),!D)return null;Object.assign(s,D.params),m.push({params:s,pathname:Oo([e,D.pathname]),pathnameBase:n4(Oo([e,D.pathnameBase])),route:L}),D.pathnameBase!=="/"&&(e=Oo([e,D.pathnameBase]))}return m}function gp(l,n){typeof l=="string"&&(l={path:l,caseSensitive:!1,end:!0});let[a,o]=e4(l.path,l.caseSensitive,l.end),s=n.match(a);if(!s)return null;let e=s[0],m=e.replace(/(.)\/+$/,"$1"),v=s.slice(1);return{params:o.reduce((N,{paramName:S,isOptional:D},L)=>{if(S==="*"){let F=v[L]||"";m=e.slice(0,e.length-F.length).replace(/(.)\/+$/,"$1")}const M=v[L];return D&&!M?N[S]=void 0:N[S]=(M||"").replace(/%2F/g,"/"),N},{}),pathname:e,pathnameBase:m,pattern:l}}function e4(l,n=!1,a=!0){li(l==="*"||!l.endsWith("*")||l.endsWith("/*"),`Route path "${l}" will be treated as if it were "${l.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${l.replace(/\*$/,"/*")}".`);let o=[],s="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(m,v,w)=>(o.push({paramName:v,isOptional:w!=null}),w?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return l.endsWith("*")?(o.push({paramName:"*"}),s+=l==="*"||l==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":l!==""&&l!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,n?void 0:"i"),o]}function t4(l){try{return l.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return li(!1,`The URL path "${l}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),l}}function Po(l,n){if(n==="/")return l;if(!l.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,o=l.charAt(a);return o&&o!=="/"?null:l.slice(a)||"/"}var zb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,s4=l=>zb.test(l);function r4(l,n="/"){let{pathname:a,search:o="",hash:s=""}=typeof l=="string"?Ju(l):l,e;if(a)if(s4(a))e=a;else{if(a.includes("//")){let m=a;a=a.replace(/\/\/+/g,"/"),li(!1,`Pathnames cannot have embedded double slashes - normalizing ${m} -> ${a}`)}a.startsWith("/")?e=Bx(a.substring(1),"/"):e=Bx(a,n)}else e=n;return{pathname:e,search:i4(o),hash:l4(s)}}function Bx(l,n){let a=n.replace(/\/+$/,"").split("/");return l.split("/").forEach(s=>{s===".."?a.length>1&&a.pop():s!=="."&&a.push(s)}),a.length>1?a.join("/"):"/"}function d1(l,n,a,o){return`Cannot include a '${l}' character in a manually specified \`to.${n}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function a4(l){return l.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function tx(l){let n=a4(l);return n.map((a,o)=>o===n.length-1?a.pathname:a.pathnameBase)}function sx(l,n,a,o=!1){let s;typeof l=="string"?s=Ju(l):(s={...l},Xr(!s.pathname||!s.pathname.includes("?"),d1("?","pathname","search",s)),Xr(!s.pathname||!s.pathname.includes("#"),d1("#","pathname","hash",s)),Xr(!s.search||!s.search.includes("#"),d1("#","search","hash",s)));let e=l===""||s.pathname==="",m=e?"/":s.pathname,v;if(m==null)v=a;else{let D=n.length-1;if(!o&&m.startsWith("..")){let L=m.split("/");for(;L[0]==="..";)L.shift(),D-=1;s.pathname=L.join("/")}v=D>=0?n[D]:"/"}let w=r4(s,v),N=m&&m!=="/"&&m.endsWith("/"),S=(e||m===".")&&a.endsWith("/");return!w.pathname.endsWith("/")&&(N||S)&&(w.pathname+="/"),w}var Oo=l=>l.join("/").replace(/\/\/+/g,"/"),n4=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),i4=l=>!l||l==="?"?"":l.startsWith("?")?l:"?"+l,l4=l=>!l||l==="#"?"":l.startsWith("#")?l:"#"+l,o4=class{constructor(l,n,a,o=!1){this.status=l,this.statusText=n||"",this.internal=o,a instanceof Error?(this.data=a.toString(),this.error=a):this.data=a}};function c4(l){return l!=null&&typeof l.status=="number"&&typeof l.statusText=="string"&&typeof l.internal=="boolean"&&"data"in l}function d4(l){return l.map(n=>n.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Ub=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Hb(l,n){let a=l;if(typeof a!="string"||!zb.test(a))return{absoluteURL:void 0,isExternal:!1,to:a};let o=a,s=!1;if(Ub)try{let e=new URL(window.location.href),m=a.startsWith("//")?new URL(e.protocol+a):new URL(a),v=Po(m.pathname,n);m.origin===e.origin&&v!=null?a=v+m.search+m.hash:s=!0}catch{li(!1,`<Link to="${a}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:o,isExternal:s,to:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Vb=["POST","PUT","PATCH","DELETE"];new Set(Vb);var u4=["GET",...Vb];new Set(u4);var Zu=B.createContext(null);Zu.displayName="DataRouter";var Cp=B.createContext(null);Cp.displayName="DataRouterState";var h4=B.createContext(!1),Wb=B.createContext({isTransitioning:!1});Wb.displayName="ViewTransition";var f4=B.createContext(new Map);f4.displayName="Fetchers";var m4=B.createContext(null);m4.displayName="Await";var oi=B.createContext(null);oi.displayName="Navigation";var um=B.createContext(null);um.displayName="Location";var Ti=B.createContext({outlet:null,matches:[],isDataRoute:!1});Ti.displayName="Route";var rx=B.createContext(null);rx.displayName="RouteError";var $b="REACT_ROUTER_ERROR",g4="REDIRECT",p4="ROUTE_ERROR_RESPONSE";function x4(l){if(l.startsWith(`${$b}:${g4}:{`))try{let n=JSON.parse(l.slice(28));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.location=="string"&&typeof n.reloadDocument=="boolean"&&typeof n.replace=="boolean")return n}catch{}}function b4(l){if(l.startsWith(`${$b}:${p4}:{`))try{let n=JSON.parse(l.slice(40));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string")return new o4(n.status,n.statusText,n.data)}catch{}}function y4(l,{relative:n}={}){Xr(eh(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:o}=B.useContext(oi),{hash:s,pathname:e,search:m}=hm(l,{relative:n}),v=e;return a!=="/"&&(v=e==="/"?a:Oo([a,e])),o.createHref({pathname:v,search:m,hash:s})}function eh(){return B.useContext(um)!=null}function Wl(){return Xr(eh(),"useLocation() may be used only in the context of a <Router> component."),B.useContext(um).location}var qb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Yb(l){B.useContext(oi).static||B.useLayoutEffect(l)}function Fr(){let{isDataRoute:l}=B.useContext(Ti);return l?L4():v4()}function v4(){Xr(eh(),"useNavigate() may be used only in the context of a <Router> component.");let l=B.useContext(Zu),{basename:n,navigator:a}=B.useContext(oi),{matches:o}=B.useContext(Ti),{pathname:s}=Wl(),e=JSON.stringify(tx(o)),m=B.useRef(!1);return Yb(()=>{m.current=!0}),B.useCallback((w,N={})=>{if(li(m.current,qb),!m.current)return;if(typeof w=="number"){a.go(w);return}let S=sx(w,JSON.parse(e),s,N.relative==="path");l==null&&n!=="/"&&(S.pathname=S.pathname==="/"?n:Oo([n,S.pathname])),(N.replace?a.replace:a.push)(S,N.state,N)},[n,a,e,s,l])}var w4=B.createContext(null);function j4(l){let n=B.useContext(Ti).outlet;return B.useMemo(()=>n&&B.createElement(w4.Provider,{value:l},n),[n,l])}function ci(){let{matches:l}=B.useContext(Ti),n=l[l.length-1];return n?n.params:{}}function hm(l,{relative:n}={}){let{matches:a}=B.useContext(Ti),{pathname:o}=Wl(),s=JSON.stringify(tx(a));return B.useMemo(()=>sx(l,JSON.parse(s),o,n==="path"),[l,s,o,n])}function N4(l,n){return Gb(l,n)}function Gb(l,n,a,o,s){Xr(eh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:e}=B.useContext(oi),{matches:m}=B.useContext(Ti),v=m[m.length-1],w=v?v.params:{},N=v?v.pathname:"/",S=v?v.pathnameBase:"/",D=v&&v.route;{let ae=D&&D.path||"";Qb(N,!D||ae.endsWith("*")||ae.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${N}" (under <Route path="${ae}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ae}"> to <Route path="${ae==="/"?"*":`${ae}/*`}">.`)}let L=Wl(),M;if(n){let ae=typeof n=="string"?Ju(n):n;Xr(S==="/"||ae.pathname?.startsWith(S),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${S}" but pathname "${ae.pathname}" was given in the \`location\` prop.`),M=ae}else M=L;let F=M.pathname||"/",O=F;if(S!=="/"){let ae=S.replace(/^\//,"").split("/");O="/"+F.replace(/^\//,"").split("/").slice(ae.length).join("/")}let P=Pb(l,{pathname:O});li(D||P!=null,`No routes matched location "${M.pathname}${M.search}${M.hash}" `),li(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${M.pathname}${M.search}${M.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let G=E4(P&&P.map(ae=>Object.assign({},ae,{params:Object.assign({},w,ae.params),pathname:Oo([S,e.encodeLocation?e.encodeLocation(ae.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ae.pathname]),pathnameBase:ae.pathnameBase==="/"?S:Oo([S,e.encodeLocation?e.encodeLocation(ae.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ae.pathnameBase])})),m,a,o,s);return n&&G?B.createElement(um.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...M},navigationType:"POP"}},G):G}function k4(){let l=M4(),n=c4(l)?`${l.status} ${l.statusText}`:l instanceof Error?l.message:JSON.stringify(l),a=l instanceof Error?l.stack:null,o="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:o},e={padding:"2px 4px",backgroundColor:o},m=null;return console.error("Error handled by React Router default ErrorBoundary:",l),m=B.createElement(B.Fragment,null,B.createElement("p",null," Hey developer "),B.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",B.createElement("code",{style:e},"ErrorBoundary")," or"," ",B.createElement("code",{style:e},"errorElement")," prop on your route.")),B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},n),a?B.createElement("pre",{style:s},a):null,m)}var C4=B.createElement(k4,null),Kb=class extends B.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,n){return n.location!==l.location||n.revalidation!=="idle"&&l.revalidation==="idle"?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:l.error!==void 0?l.error:n.error,location:n.location,revalidation:l.revalidation||n.revalidation}}componentDidCatch(l,n){this.props.onError?this.props.onError(l,n):console.error("React Router caught the following error during render",l)}render(){let l=this.state.error;if(this.context&&typeof l=="object"&&l&&"digest"in l&&typeof l.digest=="string"){const a=b4(l.digest);a&&(l=a)}let n=l!==void 0?B.createElement(Ti.Provider,{value:this.props.routeContext},B.createElement(rx.Provider,{value:l,children:this.props.component})):this.props.children;return this.context?B.createElement(S4,{error:l},n):n}};Kb.contextType=h4;var u1=new WeakMap;function S4({children:l,error:n}){let{basename:a}=B.useContext(oi);if(typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){let o=x4(n.digest);if(o){let s=u1.get(n);if(s)throw s;let e=Hb(o.location,a);if(Ub&&!u1.get(n))if(e.isExternal||o.reloadDocument)window.location.href=e.absoluteURL||e.to;else{const m=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(e.to,{replace:o.replace}));throw u1.set(n,m),m}return B.createElement("meta",{httpEquiv:"refresh",content:`0;url=${e.absoluteURL||e.to}`})}}return l}function A4({routeContext:l,match:n,children:a}){let o=B.useContext(Zu);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),B.createElement(Ti.Provider,{value:l},a)}function E4(l,n=[],a=null,o=null,s=null){if(l==null){if(!a)return null;if(a.errors)l=a.matches;else if(n.length===0&&!a.initialized&&a.matches.length>0)l=a.matches;else return null}let e=l,m=a?.errors;if(m!=null){let S=e.findIndex(D=>D.route.id&&m?.[D.route.id]!==void 0);Xr(S>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(m).join(",")}`),e=e.slice(0,Math.min(e.length,S+1))}let v=!1,w=-1;if(a)for(let S=0;S<e.length;S++){let D=e[S];if((D.route.HydrateFallback||D.route.hydrateFallbackElement)&&(w=S),D.route.id){let{loaderData:L,errors:M}=a,F=D.route.loader&&!L.hasOwnProperty(D.route.id)&&(!M||M[D.route.id]===void 0);if(D.route.lazy||F){v=!0,w>=0?e=e.slice(0,w+1):e=[e[0]];break}}}let N=a&&o?(S,D)=>{o(S,{location:a.location,params:a.matches?.[0]?.params??{},unstable_pattern:d4(a.matches),errorInfo:D})}:void 0;return e.reduceRight((S,D,L)=>{let M,F=!1,O=null,P=null;a&&(M=m&&D.route.id?m[D.route.id]:void 0,O=D.route.errorElement||C4,v&&(w<0&&L===0?(Qb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),F=!0,P=null):w===L&&(F=!0,P=D.route.hydrateFallbackElement||null)));let G=n.concat(e.slice(0,L+1)),ae=()=>{let re;return M?re=O:F?re=P:D.route.Component?re=B.createElement(D.route.Component,null):D.route.element?re=D.route.element:re=S,B.createElement(A4,{match:D,routeContext:{outlet:S,matches:G,isDataRoute:a!=null},children:re})};return a&&(D.route.ErrorBoundary||D.route.errorElement||L===0)?B.createElement(Kb,{location:a.location,revalidation:a.revalidation,component:O,error:M,children:ae(),routeContext:{outlet:null,matches:G,isDataRoute:!0},onError:N}):ae()},null)}function ax(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function D4(l){let n=B.useContext(Zu);return Xr(n,ax(l)),n}function T4(l){let n=B.useContext(Cp);return Xr(n,ax(l)),n}function _4(l){let n=B.useContext(Ti);return Xr(n,ax(l)),n}function nx(l){let n=_4(l),a=n.matches[n.matches.length-1];return Xr(a.route.id,`${l} can only be used on routes that contain a unique "id"`),a.route.id}function F4(){return nx("useRouteId")}function M4(){let l=B.useContext(rx),n=T4("useRouteError"),a=nx("useRouteError");return l!==void 0?l:n.errors?.[a]}function L4(){let{router:l}=D4("useNavigate"),n=nx("useNavigate"),a=B.useRef(!1);return Yb(()=>{a.current=!0}),B.useCallback(async(s,e={})=>{li(a.current,qb),a.current&&(typeof s=="number"?await l.navigate(s):await l.navigate(s,{fromRouteId:n,...e}))},[l,n])}var zx={};function Qb(l,n,a){!n&&!zx[l]&&(zx[l]=!0,li(!1,a))}B.memo(R4);function R4({routes:l,future:n,state:a,onError:o}){return Gb(l,void 0,a,o,n)}function pp({to:l,replace:n,state:a,relative:o}){Xr(eh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=B.useContext(oi);li(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:e}=B.useContext(Ti),{pathname:m}=Wl(),v=Fr(),w=sx(l,tx(e),m,o==="path"),N=JSON.stringify(w);return B.useEffect(()=>{v(JSON.parse(N),{replace:n,state:a,relative:o})},[v,N,o,n,a]),null}function O4(l){return j4(l.context)}function yr(l){Xr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function P4({basename:l="/",children:n=null,location:a,navigationType:o="POP",navigator:s,static:e=!1,unstable_useTransitions:m}){Xr(!eh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let v=l.replace(/^\/*/,"/"),w=B.useMemo(()=>({basename:v,navigator:s,static:e,unstable_useTransitions:m,future:{}}),[v,s,e,m]);typeof a=="string"&&(a=Ju(a));let{pathname:N="/",search:S="",hash:D="",state:L=null,key:M="default"}=a,F=B.useMemo(()=>{let O=Po(N,v);return O==null?null:{location:{pathname:O,search:S,hash:D,state:L,key:M},navigationType:o}},[v,N,S,D,L,M,o]);return li(F!=null,`<Router basename="${v}"> is not able to match the URL "${N}${S}${D}" because it does not start with the basename, so the <Router> won't render anything.`),F==null?null:B.createElement(oi.Provider,{value:w},B.createElement(um.Provider,{children:n,value:F}))}function I4({children:l,location:n}){return N4(z1(l),n)}function z1(l,n=[]){let a=[];return B.Children.forEach(l,(o,s)=>{if(!B.isValidElement(o))return;let e=[...n,s];if(o.type===B.Fragment){a.push.apply(a,z1(o.props.children,e));return}Xr(o.type===yr,`[${typeof o.type=="string"?o.type:o.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xr(!o.props.index||!o.props.children,"An index route cannot have child routes.");let m={id:o.props.id||e.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,middleware:o.props.middleware,loader:o.props.loader,action:o.props.action,hydrateFallbackElement:o.props.hydrateFallbackElement,HydrateFallback:o.props.HydrateFallback,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.hasErrorBoundary===!0||o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(m.children=z1(o.props.children,e)),a.push(m)}),a}var ip="get",lp="application/x-www-form-urlencoded";function Sp(l){return typeof HTMLElement<"u"&&l instanceof HTMLElement}function B4(l){return Sp(l)&&l.tagName.toLowerCase()==="button"}function z4(l){return Sp(l)&&l.tagName.toLowerCase()==="form"}function U4(l){return Sp(l)&&l.tagName.toLowerCase()==="input"}function H4(l){return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}function V4(l,n){return l.button===0&&(!n||n==="_self")&&!H4(l)}function U1(l=""){return new URLSearchParams(typeof l=="string"||Array.isArray(l)||l instanceof URLSearchParams?l:Object.keys(l).reduce((n,a)=>{let o=l[a];return n.concat(Array.isArray(o)?o.map(s=>[a,s]):[[a,o]])},[]))}function W4(l,n){let a=U1(l);return n&&n.forEach((o,s)=>{a.has(s)||n.getAll(s).forEach(e=>{a.append(s,e)})}),a}var Ug=null;function $4(){if(Ug===null)try{new FormData(document.createElement("form"),0),Ug=!1}catch{Ug=!0}return Ug}var q4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function h1(l){return l!=null&&!q4.has(l)?(li(!1,`"${l}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${lp}"`),null):l}function Y4(l,n){let a,o,s,e,m;if(z4(l)){let v=l.getAttribute("action");o=v?Po(v,n):null,a=l.getAttribute("method")||ip,s=h1(l.getAttribute("enctype"))||lp,e=new FormData(l)}else if(B4(l)||U4(l)&&(l.type==="submit"||l.type==="image")){let v=l.form;if(v==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let w=l.getAttribute("formaction")||v.getAttribute("action");if(o=w?Po(w,n):null,a=l.getAttribute("formmethod")||v.getAttribute("method")||ip,s=h1(l.getAttribute("formenctype"))||h1(v.getAttribute("enctype"))||lp,e=new FormData(v,l),!$4()){let{name:N,type:S,value:D}=l;if(S==="image"){let L=N?`${N}.`:"";e.append(`${L}x`,"0"),e.append(`${L}y`,"0")}else N&&e.append(N,D)}}else{if(Sp(l))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=ip,o=null,s=lp,m=l}return e&&s==="text/plain"&&(m=e,e=void 0),{action:o,method:a.toLowerCase(),encType:s,formData:e,body:m}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ix(l,n){if(l===!1||l===null||typeof l>"u")throw new Error(n)}function G4(l,n,a){let o=typeof l=="string"?new URL(l,typeof window>"u"?"server://singlefetch/":window.location.origin):l;return o.pathname==="/"?o.pathname=`_root.${a}`:n&&Po(o.pathname,n)==="/"?o.pathname=`${n.replace(/\/$/,"")}/_root.${a}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${a}`,o}async function K4(l,n){if(l.id in n)return n[l.id];try{let a=await import(l.module);return n[l.id]=a,a}catch(a){return console.error(`Error loading route module \`${l.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Q4(l){return l==null?!1:l.href==null?l.rel==="preload"&&typeof l.imageSrcSet=="string"&&typeof l.imageSizes=="string":typeof l.rel=="string"&&typeof l.href=="string"}async function X4(l,n,a){let o=await Promise.all(l.map(async s=>{let e=n.routes[s.route.id];if(e){let m=await K4(e,a);return m.links?m.links():[]}return[]}));return tw(o.flat(1).filter(Q4).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Ux(l,n,a,o,s,e){let m=(w,N)=>a[N]?w.route.id!==a[N].route.id:!0,v=(w,N)=>a[N].pathname!==w.pathname||a[N].route.path?.endsWith("*")&&a[N].params["*"]!==w.params["*"];return e==="assets"?n.filter((w,N)=>m(w,N)||v(w,N)):e==="data"?n.filter((w,N)=>{let S=o.routes[w.route.id];if(!S||!S.hasLoader)return!1;if(m(w,N)||v(w,N))return!0;if(w.route.shouldRevalidate){let D=w.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:a[0]?.params||{},nextUrl:new URL(l,window.origin),nextParams:w.params,defaultShouldRevalidate:!0});if(typeof D=="boolean")return D}return!0}):[]}function J4(l,n,{includeHydrateFallback:a}={}){return Z4(l.map(o=>{let s=n.routes[o.route.id];if(!s)return[];let e=[s.module];return s.clientActionModule&&(e=e.concat(s.clientActionModule)),s.clientLoaderModule&&(e=e.concat(s.clientLoaderModule)),a&&s.hydrateFallbackModule&&(e=e.concat(s.hydrateFallbackModule)),s.imports&&(e=e.concat(s.imports)),e}).flat(1))}function Z4(l){return[...new Set(l)]}function ew(l){let n={},a=Object.keys(l).sort();for(let o of a)n[o]=l[o];return n}function tw(l,n){let a=new Set;return new Set(n),l.reduce((o,s)=>{let e=JSON.stringify(ew(s));return a.has(e)||(a.add(e),o.push({key:e,link:s})),o},[])}function Xb(){let l=B.useContext(Zu);return ix(l,"You must render this element inside a <DataRouterContext.Provider> element"),l}function sw(){let l=B.useContext(Cp);return ix(l,"You must render this element inside a <DataRouterStateContext.Provider> element"),l}var lx=B.createContext(void 0);lx.displayName="FrameworkContext";function Jb(){let l=B.useContext(lx);return ix(l,"You must render this element inside a <HydratedRouter> element"),l}function rw(l,n){let a=B.useContext(lx),[o,s]=B.useState(!1),[e,m]=B.useState(!1),{onFocus:v,onBlur:w,onMouseEnter:N,onMouseLeave:S,onTouchStart:D}=n,L=B.useRef(null);B.useEffect(()=>{if(l==="render"&&m(!0),l==="viewport"){let O=G=>{G.forEach(ae=>{m(ae.isIntersecting)})},P=new IntersectionObserver(O,{threshold:.5});return L.current&&P.observe(L.current),()=>{P.disconnect()}}},[l]),B.useEffect(()=>{if(o){let O=setTimeout(()=>{m(!0)},100);return()=>{clearTimeout(O)}}},[o]);let M=()=>{s(!0)},F=()=>{s(!1),m(!1)};return a?l!=="intent"?[e,L,{}]:[e,L,{onFocus:Uf(v,M),onBlur:Uf(w,F),onMouseEnter:Uf(N,M),onMouseLeave:Uf(S,F),onTouchStart:Uf(D,M)}]:[!1,L,{}]}function Uf(l,n){return a=>{l&&l(a),a.defaultPrevented||n(a)}}function aw({page:l,...n}){let{router:a}=Xb(),o=B.useMemo(()=>Pb(a.routes,l,a.basename),[a.routes,l,a.basename]);return o?B.createElement(iw,{page:l,matches:o,...n}):null}function nw(l){let{manifest:n,routeModules:a}=Jb(),[o,s]=B.useState([]);return B.useEffect(()=>{let e=!1;return X4(l,n,a).then(m=>{e||s(m)}),()=>{e=!0}},[l,n,a]),o}function iw({page:l,matches:n,...a}){let o=Wl(),{manifest:s,routeModules:e}=Jb(),{basename:m}=Xb(),{loaderData:v,matches:w}=sw(),N=B.useMemo(()=>Ux(l,n,w,s,o,"data"),[l,n,w,s,o]),S=B.useMemo(()=>Ux(l,n,w,s,o,"assets"),[l,n,w,s,o]),D=B.useMemo(()=>{if(l===o.pathname+o.search+o.hash)return[];let F=new Set,O=!1;if(n.forEach(G=>{let ae=s.routes[G.route.id];!ae||!ae.hasLoader||(!N.some(re=>re.route.id===G.route.id)&&G.route.id in v&&e[G.route.id]?.shouldRevalidate||ae.hasClientLoader?O=!0:F.add(G.route.id))}),F.size===0)return[];let P=G4(l,m,"data");return O&&F.size>0&&P.searchParams.set("_routes",n.filter(G=>F.has(G.route.id)).map(G=>G.route.id).join(",")),[P.pathname+P.search]},[m,v,o,s,N,n,l,e]),L=B.useMemo(()=>J4(S,s),[S,s]),M=nw(S);return B.createElement(B.Fragment,null,D.map(F=>B.createElement("link",{key:F,rel:"prefetch",as:"fetch",href:F,...a})),L.map(F=>B.createElement("link",{key:F,rel:"modulepreload",href:F,...a})),M.map(({key:F,link:O})=>B.createElement("link",{key:F,nonce:a.nonce,...O})))}function lw(...l){return n=>{l.forEach(a=>{typeof a=="function"?a(n):a!=null&&(a.current=n)})}}var ow=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ow&&(window.__reactRouterVersion="7.11.0")}catch{}function cw({basename:l,children:n,unstable_useTransitions:a,window:o}){let s=B.useRef();s.current==null&&(s.current=Bv({window:o,v5Compat:!0}));let e=s.current,[m,v]=B.useState({action:e.action,location:e.location}),w=B.useCallback(N=>{a===!1?v(N):B.startTransition(()=>v(N))},[a]);return B.useLayoutEffect(()=>e.listen(w),[e,w]),B.createElement(P4,{basename:l,children:n,location:m.location,navigationType:m.action,navigator:e,unstable_useTransitions:a})}var Zb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ey=B.forwardRef(function({onClick:n,discover:a="render",prefetch:o="none",relative:s,reloadDocument:e,replace:m,state:v,target:w,to:N,preventScrollReset:S,viewTransition:D,unstable_defaultShouldRevalidate:L,...M},F){let{basename:O,unstable_useTransitions:P}=B.useContext(oi),G=typeof N=="string"&&Zb.test(N),ae=Hb(N,O);N=ae.to;let re=y4(N,{relative:s}),[Ne,xe,we]=rw(o,M),Z=fw(N,{replace:m,state:v,target:w,preventScrollReset:S,relative:s,viewTransition:D,unstable_defaultShouldRevalidate:L,unstable_useTransitions:P});function ce(Le){n&&n(Le),Le.defaultPrevented||Z(Le)}let ue=B.createElement("a",{...M,...we,href:ae.absoluteURL||re,onClick:ae.isExternal||e?n:ce,ref:lw(F,xe),target:w,"data-discover":!G&&a==="render"?"true":void 0});return Ne&&!G?B.createElement(B.Fragment,null,ue,B.createElement(aw,{page:re})):ue});ey.displayName="Link";var dw=B.forwardRef(function({"aria-current":n="page",caseSensitive:a=!1,className:o="",end:s=!1,style:e,to:m,viewTransition:v,children:w,...N},S){let D=hm(m,{relative:N.relative}),L=Wl(),M=B.useContext(Cp),{navigator:F,basename:O}=B.useContext(oi),P=M!=null&&bw(D)&&v===!0,G=F.encodeLocation?F.encodeLocation(D).pathname:D.pathname,ae=L.pathname,re=M&&M.navigation&&M.navigation.location?M.navigation.location.pathname:null;a||(ae=ae.toLowerCase(),re=re?re.toLowerCase():null,G=G.toLowerCase()),re&&O&&(re=Po(re,O)||re);const Ne=G!=="/"&&G.endsWith("/")?G.length-1:G.length;let xe=ae===G||!s&&ae.startsWith(G)&&ae.charAt(Ne)==="/",we=re!=null&&(re===G||!s&&re.startsWith(G)&&re.charAt(G.length)==="/"),Z={isActive:xe,isPending:we,isTransitioning:P},ce=xe?n:void 0,ue;typeof o=="function"?ue=o(Z):ue=[o,xe?"active":null,we?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let Le=typeof e=="function"?e(Z):e;return B.createElement(ey,{...N,"aria-current":ce,className:ue,ref:S,style:Le,to:m,viewTransition:v},typeof w=="function"?w(Z):w)});dw.displayName="NavLink";var uw=B.forwardRef(({discover:l="render",fetcherKey:n,navigate:a,reloadDocument:o,replace:s,state:e,method:m=ip,action:v,onSubmit:w,relative:N,preventScrollReset:S,viewTransition:D,unstable_defaultShouldRevalidate:L,...M},F)=>{let{unstable_useTransitions:O}=B.useContext(oi),P=pw(),G=xw(v,{relative:N}),ae=m.toLowerCase()==="get"?"get":"post",re=typeof v=="string"&&Zb.test(v),Ne=xe=>{if(w&&w(xe),xe.defaultPrevented)return;xe.preventDefault();let we=xe.nativeEvent.submitter,Z=we?.getAttribute("formmethod")||m,ce=()=>P(we||xe.currentTarget,{fetcherKey:n,method:Z,navigate:a,replace:s,state:e,relative:N,preventScrollReset:S,viewTransition:D,unstable_defaultShouldRevalidate:L});O&&a!==!1?B.startTransition(()=>ce()):ce()};return B.createElement("form",{ref:F,method:ae,action:G,onSubmit:o?w:Ne,...M,"data-discover":!re&&l==="render"?"true":void 0})});uw.displayName="Form";function hw(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ty(l){let n=B.useContext(Zu);return Xr(n,hw(l)),n}function fw(l,{target:n,replace:a,state:o,preventScrollReset:s,relative:e,viewTransition:m,unstable_defaultShouldRevalidate:v,unstable_useTransitions:w}={}){let N=Fr(),S=Wl(),D=hm(l,{relative:e});return B.useCallback(L=>{if(V4(L,n)){L.preventDefault();let M=a!==void 0?a:rm(S)===rm(D),F=()=>N(l,{replace:M,state:o,preventScrollReset:s,relative:e,viewTransition:m,unstable_defaultShouldRevalidate:v});w?B.startTransition(()=>F()):F()}},[S,N,D,a,o,n,l,s,e,m,v,w])}function n0(l){li(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let n=B.useRef(U1(l)),a=B.useRef(!1),o=Wl(),s=B.useMemo(()=>W4(o.search,a.current?null:n.current),[o.search]),e=Fr(),m=B.useCallback((v,w)=>{const N=U1(typeof v=="function"?v(new URLSearchParams(s)):v);a.current=!0,e("?"+N,w)},[e,s]);return[s,m]}var mw=0,gw=()=>`__${String(++mw)}__`;function pw(){let{router:l}=ty("useSubmit"),{basename:n}=B.useContext(oi),a=F4(),o=l.fetch,s=l.navigate;return B.useCallback(async(e,m={})=>{let{action:v,method:w,encType:N,formData:S,body:D}=Y4(e,n);if(m.navigate===!1){let L=m.fetcherKey||gw();await o(L,a,m.action||v,{unstable_defaultShouldRevalidate:m.unstable_defaultShouldRevalidate,preventScrollReset:m.preventScrollReset,formData:S,body:D,formMethod:m.method||w,formEncType:m.encType||N,flushSync:m.flushSync})}else await s(m.action||v,{unstable_defaultShouldRevalidate:m.unstable_defaultShouldRevalidate,preventScrollReset:m.preventScrollReset,formData:S,body:D,formMethod:m.method||w,formEncType:m.encType||N,replace:m.replace,state:m.state,fromRouteId:a,flushSync:m.flushSync,viewTransition:m.viewTransition})},[o,s,n,a])}function xw(l,{relative:n}={}){let{basename:a}=B.useContext(oi),o=B.useContext(Ti);Xr(o,"useFormAction must be used inside a RouteContext");let[s]=o.matches.slice(-1),e={...hm(l||".",{relative:n})},m=Wl();if(l==null){e.search=m.search;let v=new URLSearchParams(e.search),w=v.getAll("index");if(w.some(S=>S==="")){v.delete("index"),w.filter(D=>D).forEach(D=>v.append("index",D));let S=v.toString();e.search=S?`?${S}`:""}}return(!l||l===".")&&s.route.index&&(e.search=e.search?e.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(e.pathname=e.pathname==="/"?a:Oo([a,e.pathname])),rm(e)}function bw(l,{relative:n}={}){let a=B.useContext(Wb);Xr(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=ty("useViewTransitionState"),s=hm(l,{relative:n});if(!a.isTransitioning)return!1;let e=Po(a.currentLocation.pathname,o)||a.currentLocation.pathname,m=Po(a.nextLocation.pathname,o)||a.nextLocation.pathname;return gp(s.pathname,m)!=null||gp(s.pathname,e)!=null}const f1=[{id:"analytical-dashboard",label:"Dashboard",path:"/projects/dashboard",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{id:"project-management",label:"Project Management",path:"/projects",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}];function yw({isOpen:l=!1,onClose:n}){const a=Wl(),o=Fr(),s=[{id:"dashboard",label:"Dashboard",path:"/dashboard",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})},{id:"contacts",label:"Contacts",path:"/contacts",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{id:"import",label:"Import",path:"/import",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}],e={label:"Master Dashboard",path:"/master-dashboard",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},m=F=>F==="/dashboard"||F==="/"?a.pathname==="/dashboard"||a.pathname==="/":F==="/master-dashboard"?a.pathname==="/master-dashboard":F==="/projects/dashboard"?a.pathname==="/projects/dashboard":F==="/projects"?a.pathname==="/projects"||a.pathname.startsWith("/projects/")&&a.pathname!=="/projects/dashboard"&&!a.pathname.startsWith("/projects/dashboard/"):a.pathname.startsWith(F),v=s.some(F=>m(F.path)),[w,N]=B.useState(v),S=f1.some(F=>m(F.path)),[D,L]=B.useState(S);B.useEffect(()=>{s.some(O=>m(O.path))&&N(!0)},[a.pathname]),B.useEffect(()=>{f1.some(O=>m(O.path))&&L(!0)},[a.pathname]);const M=F=>{o(F),n&&n()};return t.jsxs("div",{className:`
      w-64 bg-white border-r border-gray-200 h-screen flex flex-col fixed left-0 top-0 z-50
      transform transition-transform duration-300 ease-in-out
      lg:translate-x-0
      ${l?"translate-x-0":"-translate-x-full"}
    `,children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded flex items-center justify-center flex-shrink-0",children:t.jsx("div",{className:"w-5 h-5 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-2.5 h-2.5 bg-blue-600 rounded-full"})})}),t.jsx("span",{className:"text-base font-semibold text-gray-900",children:"Outbound SaaS"})]}),t.jsx("button",{onClick:n,className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-600 hover:bg-gray-100","aria-label":"Close menu",children:t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("nav",{className:"flex-1 px-4 py-4 overflow-y-auto",children:t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>N(!w),className:"w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),t.jsx("span",{className:"text-sm font-medium",children:"Databank"})]}),t.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${w?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),w&&t.jsx("div",{className:"ml-4 mt-1 space-y-1 border-l-2 border-gray-200 pl-2",children:s.map(F=>{const O=m(F.path);return t.jsxs("button",{onClick:()=>M(F.path==="/dashboard"?"/":F.path),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${O?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:O?"text-blue-600":"text-gray-500",children:F.icon}),t.jsx("span",{className:`text-sm font-medium ${O?"text-blue-600":"text-gray-700"}`,children:F.label})]},F.id)})})]}),t.jsxs("div",{className:"mt-2",children:[t.jsxs("button",{onClick:()=>L(!D),className:"w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),t.jsx("span",{className:"text-sm font-medium",children:"Projects"})]}),t.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${D?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),D&&t.jsx("div",{className:"ml-4 mt-1 space-y-1 border-l-2 border-gray-200 pl-2",children:f1.map(F=>{const O=m(F.path);return t.jsxs("button",{onClick:()=>M(F.path),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${O?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:O?"text-blue-600":"text-gray-500",children:F.icon}),t.jsx("span",{className:`text-sm font-medium ${O?"text-blue-600":"text-gray-700"}`,children:F.label})]},F.id)})})]}),t.jsx("div",{className:"mt-2",children:t.jsxs("button",{onClick:()=>M(e.path),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${m(e.path)?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:m(e.path)?"text-blue-600":"text-gray-500",children:e.icon}),t.jsx("span",{className:`text-sm font-medium ${m(e.path)?"text-blue-600":"text-gray-700"}`,children:e.label})]})}),t.jsx("div",{className:"mt-2",children:t.jsxs("button",{onClick:()=>M("/employee-performance"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${m("/employee-performance")?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:m("/employee-performance")?"text-blue-600":"text-gray-500",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),t.jsx("span",{className:`text-sm font-medium ${m("/employee-performance")?"text-blue-600":"text-gray-700"}`,children:"Employee Performance"})]})})]})}),t.jsxs("div",{className:"px-4 py-4 border-t border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-sm font-semibold text-blue-700",children:(()=>{const F=JSON.parse(localStorage.getItem("user")||"{}");return F.name?F.name.charAt(0).toUpperCase():"U"})()})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(()=>{const F=JSON.parse(localStorage.getItem("user")||"{}");return F.name||F.email||"User"})()}),t.jsx("p",{className:"text-xs text-gray-500 truncate",children:JSON.parse(localStorage.getItem("user")||"{}").email||""})]})]}),t.jsxs("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),o("/login")},className:"w-full flex items-center gap-2 px-3 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})]})}function vw(){const l=localStorage.getItem("token"),[n,a]=B.useState(!1);return l?t.jsxs("div",{className:"flex h-screen bg-gray-50",children:[n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>a(!1)}),t.jsx(yw,{isOpen:n,onClose:()=>a(!1)}),t.jsxs("main",{className:"flex-1 lg:ml-64 overflow-y-auto",children:[t.jsxs("div",{className:"lg:hidden sticky top-0 z-30 bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>a(!n),className:"p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500","aria-label":"Toggle menu",children:t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded flex items-center justify-center flex-shrink-0",children:t.jsx("div",{className:"w-5 h-5 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-2.5 h-2.5 bg-blue-600 rounded-full"})})}),t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Outbound SaaS"})]})]}),t.jsx(O4,{context:{setSidebarOpen:a}})]})]}):t.jsx(pp,{to:"/login",replace:!0})}function sy(l,n){return function(){return l.apply(n,arguments)}}const{toString:ww}=Object.prototype,{getPrototypeOf:ox}=Object,{iterator:Ap,toStringTag:ry}=Symbol,Ep=(l=>n=>{const a=ww.call(n);return l[a]||(l[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),ol=l=>(l=l.toLowerCase(),n=>Ep(n)===l),Dp=l=>n=>typeof n===l,{isArray:th}=Array,Gu=Dp("undefined");function fm(l){return l!==null&&!Gu(l)&&l.constructor!==null&&!Gu(l.constructor)&&Un(l.constructor.isBuffer)&&l.constructor.isBuffer(l)}const ay=ol("ArrayBuffer");function jw(l){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(l):n=l&&l.buffer&&ay(l.buffer),n}const Nw=Dp("string"),Un=Dp("function"),ny=Dp("number"),mm=l=>l!==null&&typeof l=="object",kw=l=>l===!0||l===!1,op=l=>{if(Ep(l)!=="object")return!1;const n=ox(l);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(ry in l)&&!(Ap in l)},Cw=l=>{if(!mm(l)||fm(l))return!1;try{return Object.keys(l).length===0&&Object.getPrototypeOf(l)===Object.prototype}catch{return!1}},Sw=ol("Date"),Aw=ol("File"),Ew=ol("Blob"),Dw=ol("FileList"),Tw=l=>mm(l)&&Un(l.pipe),_w=l=>{let n;return l&&(typeof FormData=="function"&&l instanceof FormData||Un(l.append)&&((n=Ep(l))==="formdata"||n==="object"&&Un(l.toString)&&l.toString()==="[object FormData]"))},Fw=ol("URLSearchParams"),[Mw,Lw,Rw,Ow]=["ReadableStream","Request","Response","Headers"].map(ol),Pw=l=>l.trim?l.trim():l.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function gm(l,n,{allOwnKeys:a=!1}={}){if(l===null||typeof l>"u")return;let o,s;if(typeof l!="object"&&(l=[l]),th(l))for(o=0,s=l.length;o<s;o++)n.call(null,l[o],o,l);else{if(fm(l))return;const e=a?Object.getOwnPropertyNames(l):Object.keys(l),m=e.length;let v;for(o=0;o<m;o++)v=e[o],n.call(null,l[v],v,l)}}function iy(l,n){if(fm(l))return null;n=n.toLowerCase();const a=Object.keys(l);let o=a.length,s;for(;o-- >0;)if(s=a[o],n===s.toLowerCase())return s;return null}const Xd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ly=l=>!Gu(l)&&l!==Xd;function H1(){const{caseless:l,skipUndefined:n}=ly(this)&&this||{},a={},o=(s,e)=>{const m=l&&iy(a,e)||e;op(a[m])&&op(s)?a[m]=H1(a[m],s):op(s)?a[m]=H1({},s):th(s)?a[m]=s.slice():(!n||!Gu(s))&&(a[m]=s)};for(let s=0,e=arguments.length;s<e;s++)arguments[s]&&gm(arguments[s],o);return a}const Iw=(l,n,a,{allOwnKeys:o}={})=>(gm(n,(s,e)=>{a&&Un(s)?l[e]=sy(s,a):l[e]=s},{allOwnKeys:o}),l),Bw=l=>(l.charCodeAt(0)===65279&&(l=l.slice(1)),l),zw=(l,n,a,o)=>{l.prototype=Object.create(n.prototype,o),l.prototype.constructor=l,Object.defineProperty(l,"super",{value:n.prototype}),a&&Object.assign(l.prototype,a)},Uw=(l,n,a,o)=>{let s,e,m;const v={};if(n=n||{},l==null)return n;do{for(s=Object.getOwnPropertyNames(l),e=s.length;e-- >0;)m=s[e],(!o||o(m,l,n))&&!v[m]&&(n[m]=l[m],v[m]=!0);l=a!==!1&&ox(l)}while(l&&(!a||a(l,n))&&l!==Object.prototype);return n},Hw=(l,n,a)=>{l=String(l),(a===void 0||a>l.length)&&(a=l.length),a-=n.length;const o=l.indexOf(n,a);return o!==-1&&o===a},Vw=l=>{if(!l)return null;if(th(l))return l;let n=l.length;if(!ny(n))return null;const a=new Array(n);for(;n-- >0;)a[n]=l[n];return a},Ww=(l=>n=>l&&n instanceof l)(typeof Uint8Array<"u"&&ox(Uint8Array)),$w=(l,n)=>{const o=(l&&l[Ap]).call(l);let s;for(;(s=o.next())&&!s.done;){const e=s.value;n.call(l,e[0],e[1])}},qw=(l,n)=>{let a;const o=[];for(;(a=l.exec(n))!==null;)o.push(a);return o},Yw=ol("HTMLFormElement"),Gw=l=>l.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,o,s){return o.toUpperCase()+s}),Hx=(({hasOwnProperty:l})=>(n,a)=>l.call(n,a))(Object.prototype),Kw=ol("RegExp"),oy=(l,n)=>{const a=Object.getOwnPropertyDescriptors(l),o={};gm(a,(s,e)=>{let m;(m=n(s,e,l))!==!1&&(o[e]=m||s)}),Object.defineProperties(l,o)},Qw=l=>{oy(l,(n,a)=>{if(Un(l)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const o=l[a];if(Un(o)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},Xw=(l,n)=>{const a={},o=s=>{s.forEach(e=>{a[e]=!0})};return th(l)?o(l):o(String(l).split(n)),a},Jw=()=>{},Zw=(l,n)=>l!=null&&Number.isFinite(l=+l)?l:n;function e5(l){return!!(l&&Un(l.append)&&l[ry]==="FormData"&&l[Ap])}const t5=l=>{const n=new Array(10),a=(o,s)=>{if(mm(o)){if(n.indexOf(o)>=0)return;if(fm(o))return o;if(!("toJSON"in o)){n[s]=o;const e=th(o)?[]:{};return gm(o,(m,v)=>{const w=a(m,s+1);!Gu(w)&&(e[v]=w)}),n[s]=void 0,e}}return o};return a(l,0)},s5=ol("AsyncFunction"),r5=l=>l&&(mm(l)||Un(l))&&Un(l.then)&&Un(l.catch),cy=((l,n)=>l?setImmediate:n?((a,o)=>(Xd.addEventListener("message",({source:s,data:e})=>{s===Xd&&e===a&&o.length&&o.shift()()},!1),s=>{o.push(s),Xd.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",Un(Xd.postMessage)),a5=typeof queueMicrotask<"u"?queueMicrotask.bind(Xd):typeof process<"u"&&process.nextTick||cy,n5=l=>l!=null&&Un(l[Ap]),ct={isArray:th,isArrayBuffer:ay,isBuffer:fm,isFormData:_w,isArrayBufferView:jw,isString:Nw,isNumber:ny,isBoolean:kw,isObject:mm,isPlainObject:op,isEmptyObject:Cw,isReadableStream:Mw,isRequest:Lw,isResponse:Rw,isHeaders:Ow,isUndefined:Gu,isDate:Sw,isFile:Aw,isBlob:Ew,isRegExp:Kw,isFunction:Un,isStream:Tw,isURLSearchParams:Fw,isTypedArray:Ww,isFileList:Dw,forEach:gm,merge:H1,extend:Iw,trim:Pw,stripBOM:Bw,inherits:zw,toFlatObject:Uw,kindOf:Ep,kindOfTest:ol,endsWith:Hw,toArray:Vw,forEachEntry:$w,matchAll:qw,isHTMLForm:Yw,hasOwnProperty:Hx,hasOwnProp:Hx,reduceDescriptors:oy,freezeMethods:Qw,toObjectSet:Xw,toCamelCase:Gw,noop:Jw,toFiniteNumber:Zw,findKey:iy,global:Xd,isContextDefined:ly,isSpecCompliantForm:e5,toJSONObject:t5,isAsyncFn:s5,isThenable:r5,setImmediate:cy,asap:a5,isIterable:n5};function Os(l,n,a,o,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=l,this.name="AxiosError",n&&(this.code=n),a&&(this.config=a),o&&(this.request=o),s&&(this.response=s,this.status=s.status?s.status:null)}ct.inherits(Os,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ct.toJSONObject(this.config),code:this.code,status:this.status}}});const dy=Os.prototype,uy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(l=>{uy[l]={value:l}});Object.defineProperties(Os,uy);Object.defineProperty(dy,"isAxiosError",{value:!0});Os.from=(l,n,a,o,s,e)=>{const m=Object.create(dy);ct.toFlatObject(l,m,function(S){return S!==Error.prototype},N=>N!=="isAxiosError");const v=l&&l.message?l.message:"Error",w=n==null&&l?l.code:n;return Os.call(m,v,w,a,o,s),l&&m.cause==null&&Object.defineProperty(m,"cause",{value:l,configurable:!0}),m.name=l&&l.name||"Error",e&&Object.assign(m,e),m};const i5=null;function V1(l){return ct.isPlainObject(l)||ct.isArray(l)}function hy(l){return ct.endsWith(l,"[]")?l.slice(0,-2):l}function Vx(l,n,a){return l?l.concat(n).map(function(s,e){return s=hy(s),!a&&e?"["+s+"]":s}).join(a?".":""):n}function l5(l){return ct.isArray(l)&&!l.some(V1)}const o5=ct.toFlatObject(ct,{},null,function(n){return/^is[A-Z]/.test(n)});function Tp(l,n,a){if(!ct.isObject(l))throw new TypeError("target must be an object");n=n||new FormData,a=ct.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(O,P){return!ct.isUndefined(P[O])});const o=a.metaTokens,s=a.visitor||S,e=a.dots,m=a.indexes,w=(a.Blob||typeof Blob<"u"&&Blob)&&ct.isSpecCompliantForm(n);if(!ct.isFunction(s))throw new TypeError("visitor must be a function");function N(F){if(F===null)return"";if(ct.isDate(F))return F.toISOString();if(ct.isBoolean(F))return F.toString();if(!w&&ct.isBlob(F))throw new Os("Blob is not supported. Use a Buffer instead.");return ct.isArrayBuffer(F)||ct.isTypedArray(F)?w&&typeof Blob=="function"?new Blob([F]):Buffer.from(F):F}function S(F,O,P){let G=F;if(F&&!P&&typeof F=="object"){if(ct.endsWith(O,"{}"))O=o?O:O.slice(0,-2),F=JSON.stringify(F);else if(ct.isArray(F)&&l5(F)||(ct.isFileList(F)||ct.endsWith(O,"[]"))&&(G=ct.toArray(F)))return O=hy(O),G.forEach(function(re,Ne){!(ct.isUndefined(re)||re===null)&&n.append(m===!0?Vx([O],Ne,e):m===null?O:O+"[]",N(re))}),!1}return V1(F)?!0:(n.append(Vx(P,O,e),N(F)),!1)}const D=[],L=Object.assign(o5,{defaultVisitor:S,convertValue:N,isVisitable:V1});function M(F,O){if(!ct.isUndefined(F)){if(D.indexOf(F)!==-1)throw Error("Circular reference detected in "+O.join("."));D.push(F),ct.forEach(F,function(G,ae){(!(ct.isUndefined(G)||G===null)&&s.call(n,G,ct.isString(ae)?ae.trim():ae,O,L))===!0&&M(G,O?O.concat(ae):[ae])}),D.pop()}}if(!ct.isObject(l))throw new TypeError("data must be an object");return M(l),n}function Wx(l){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(l).replace(/[!'()~]|%20|%00/g,function(o){return n[o]})}function cx(l,n){this._pairs=[],l&&Tp(l,this,n)}const fy=cx.prototype;fy.append=function(n,a){this._pairs.push([n,a])};fy.toString=function(n){const a=n?function(o){return n.call(this,o,Wx)}:Wx;return this._pairs.map(function(s){return a(s[0])+"="+a(s[1])},"").join("&")};function c5(l){return encodeURIComponent(l).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function my(l,n,a){if(!n)return l;const o=a&&a.encode||c5;ct.isFunction(a)&&(a={serialize:a});const s=a&&a.serialize;let e;if(s?e=s(n,a):e=ct.isURLSearchParams(n)?n.toString():new cx(n,a).toString(o),e){const m=l.indexOf("#");m!==-1&&(l=l.slice(0,m)),l+=(l.indexOf("?")===-1?"?":"&")+e}return l}class $x{constructor(){this.handlers=[]}use(n,a,o){return this.handlers.push({fulfilled:n,rejected:a,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){ct.forEach(this.handlers,function(o){o!==null&&n(o)})}}const gy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},d5=typeof URLSearchParams<"u"?URLSearchParams:cx,u5=typeof FormData<"u"?FormData:null,h5=typeof Blob<"u"?Blob:null,f5={isBrowser:!0,classes:{URLSearchParams:d5,FormData:u5,Blob:h5},protocols:["http","https","file","blob","url","data"]},dx=typeof window<"u"&&typeof document<"u",W1=typeof navigator=="object"&&navigator||void 0,m5=dx&&(!W1||["ReactNative","NativeScript","NS"].indexOf(W1.product)<0),g5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",p5=dx&&window.location.href||"http://localhost",x5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:dx,hasStandardBrowserEnv:m5,hasStandardBrowserWebWorkerEnv:g5,navigator:W1,origin:p5},Symbol.toStringTag,{value:"Module"})),tn={...x5,...f5};function b5(l,n){return Tp(l,new tn.classes.URLSearchParams,{visitor:function(a,o,s,e){return tn.isNode&&ct.isBuffer(a)?(this.append(o,a.toString("base64")),!1):e.defaultVisitor.apply(this,arguments)},...n})}function y5(l){return ct.matchAll(/\w+|\[(\w*)]/g,l).map(n=>n[0]==="[]"?"":n[1]||n[0])}function v5(l){const n={},a=Object.keys(l);let o;const s=a.length;let e;for(o=0;o<s;o++)e=a[o],n[e]=l[e];return n}function py(l){function n(a,o,s,e){let m=a[e++];if(m==="__proto__")return!0;const v=Number.isFinite(+m),w=e>=a.length;return m=!m&&ct.isArray(s)?s.length:m,w?(ct.hasOwnProp(s,m)?s[m]=[s[m],o]:s[m]=o,!v):((!s[m]||!ct.isObject(s[m]))&&(s[m]=[]),n(a,o,s[m],e)&&ct.isArray(s[m])&&(s[m]=v5(s[m])),!v)}if(ct.isFormData(l)&&ct.isFunction(l.entries)){const a={};return ct.forEachEntry(l,(o,s)=>{n(y5(o),s,a,0)}),a}return null}function w5(l,n,a){if(ct.isString(l))try{return(n||JSON.parse)(l),ct.trim(l)}catch(o){if(o.name!=="SyntaxError")throw o}return(a||JSON.stringify)(l)}const pm={transitional:gy,adapter:["xhr","http","fetch"],transformRequest:[function(n,a){const o=a.getContentType()||"",s=o.indexOf("application/json")>-1,e=ct.isObject(n);if(e&&ct.isHTMLForm(n)&&(n=new FormData(n)),ct.isFormData(n))return s?JSON.stringify(py(n)):n;if(ct.isArrayBuffer(n)||ct.isBuffer(n)||ct.isStream(n)||ct.isFile(n)||ct.isBlob(n)||ct.isReadableStream(n))return n;if(ct.isArrayBufferView(n))return n.buffer;if(ct.isURLSearchParams(n))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let v;if(e){if(o.indexOf("application/x-www-form-urlencoded")>-1)return b5(n,this.formSerializer).toString();if((v=ct.isFileList(n))||o.indexOf("multipart/form-data")>-1){const w=this.env&&this.env.FormData;return Tp(v?{"files[]":n}:n,w&&new w,this.formSerializer)}}return e||s?(a.setContentType("application/json",!1),w5(n)):n}],transformResponse:[function(n){const a=this.transitional||pm.transitional,o=a&&a.forcedJSONParsing,s=this.responseType==="json";if(ct.isResponse(n)||ct.isReadableStream(n))return n;if(n&&ct.isString(n)&&(o&&!this.responseType||s)){const m=!(a&&a.silentJSONParsing)&&s;try{return JSON.parse(n,this.parseReviver)}catch(v){if(m)throw v.name==="SyntaxError"?Os.from(v,Os.ERR_BAD_RESPONSE,this,null,this.response):v}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tn.classes.FormData,Blob:tn.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ct.forEach(["delete","get","head","post","put","patch"],l=>{pm.headers[l]={}});const j5=ct.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),N5=l=>{const n={};let a,o,s;return l&&l.split(`
`).forEach(function(m){s=m.indexOf(":"),a=m.substring(0,s).trim().toLowerCase(),o=m.substring(s+1).trim(),!(!a||n[a]&&j5[a])&&(a==="set-cookie"?n[a]?n[a].push(o):n[a]=[o]:n[a]=n[a]?n[a]+", "+o:o)}),n},qx=Symbol("internals");function Hf(l){return l&&String(l).trim().toLowerCase()}function cp(l){return l===!1||l==null?l:ct.isArray(l)?l.map(cp):String(l)}function k5(l){const n=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=a.exec(l);)n[o[1]]=o[2];return n}const C5=l=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(l.trim());function m1(l,n,a,o,s){if(ct.isFunction(o))return o.call(this,n,a);if(s&&(n=a),!!ct.isString(n)){if(ct.isString(o))return n.indexOf(o)!==-1;if(ct.isRegExp(o))return o.test(n)}}function S5(l){return l.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,a,o)=>a.toUpperCase()+o)}function A5(l,n){const a=ct.toCamelCase(" "+n);["get","set","has"].forEach(o=>{Object.defineProperty(l,o+a,{value:function(s,e,m){return this[o].call(this,n,s,e,m)},configurable:!0})})}let Hn=class{constructor(n){n&&this.set(n)}set(n,a,o){const s=this;function e(v,w,N){const S=Hf(w);if(!S)throw new Error("header name must be a non-empty string");const D=ct.findKey(s,S);(!D||s[D]===void 0||N===!0||N===void 0&&s[D]!==!1)&&(s[D||w]=cp(v))}const m=(v,w)=>ct.forEach(v,(N,S)=>e(N,S,w));if(ct.isPlainObject(n)||n instanceof this.constructor)m(n,a);else if(ct.isString(n)&&(n=n.trim())&&!C5(n))m(N5(n),a);else if(ct.isObject(n)&&ct.isIterable(n)){let v={},w,N;for(const S of n){if(!ct.isArray(S))throw TypeError("Object iterator must return a key-value pair");v[N=S[0]]=(w=v[N])?ct.isArray(w)?[...w,S[1]]:[w,S[1]]:S[1]}m(v,a)}else n!=null&&e(a,n,o);return this}get(n,a){if(n=Hf(n),n){const o=ct.findKey(this,n);if(o){const s=this[o];if(!a)return s;if(a===!0)return k5(s);if(ct.isFunction(a))return a.call(this,s,o);if(ct.isRegExp(a))return a.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,a){if(n=Hf(n),n){const o=ct.findKey(this,n);return!!(o&&this[o]!==void 0&&(!a||m1(this,this[o],o,a)))}return!1}delete(n,a){const o=this;let s=!1;function e(m){if(m=Hf(m),m){const v=ct.findKey(o,m);v&&(!a||m1(o,o[v],v,a))&&(delete o[v],s=!0)}}return ct.isArray(n)?n.forEach(e):e(n),s}clear(n){const a=Object.keys(this);let o=a.length,s=!1;for(;o--;){const e=a[o];(!n||m1(this,this[e],e,n,!0))&&(delete this[e],s=!0)}return s}normalize(n){const a=this,o={};return ct.forEach(this,(s,e)=>{const m=ct.findKey(o,e);if(m){a[m]=cp(s),delete a[e];return}const v=n?S5(e):String(e).trim();v!==e&&delete a[e],a[v]=cp(s),o[v]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const a=Object.create(null);return ct.forEach(this,(o,s)=>{o!=null&&o!==!1&&(a[s]=n&&ct.isArray(o)?o.join(", "):o)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,a])=>n+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...a){const o=new this(n);return a.forEach(s=>o.set(s)),o}static accessor(n){const o=(this[qx]=this[qx]={accessors:{}}).accessors,s=this.prototype;function e(m){const v=Hf(m);o[v]||(A5(s,m),o[v]=!0)}return ct.isArray(n)?n.forEach(e):e(n),this}};Hn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ct.reduceDescriptors(Hn.prototype,({value:l},n)=>{let a=n[0].toUpperCase()+n.slice(1);return{get:()=>l,set(o){this[a]=o}}});ct.freezeMethods(Hn);function g1(l,n){const a=this||pm,o=n||a,s=Hn.from(o.headers);let e=o.data;return ct.forEach(l,function(v){e=v.call(a,e,s.normalize(),n?n.status:void 0)}),s.normalize(),e}function xy(l){return!!(l&&l.__CANCEL__)}function sh(l,n,a){Os.call(this,l??"canceled",Os.ERR_CANCELED,n,a),this.name="CanceledError"}ct.inherits(sh,Os,{__CANCEL__:!0});function by(l,n,a){const o=a.config.validateStatus;!a.status||!o||o(a.status)?l(a):n(new Os("Request failed with status code "+a.status,[Os.ERR_BAD_REQUEST,Os.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function E5(l){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(l);return n&&n[1]||""}function D5(l,n){l=l||10;const a=new Array(l),o=new Array(l);let s=0,e=0,m;return n=n!==void 0?n:1e3,function(w){const N=Date.now(),S=o[e];m||(m=N),a[s]=w,o[s]=N;let D=e,L=0;for(;D!==s;)L+=a[D++],D=D%l;if(s=(s+1)%l,s===e&&(e=(e+1)%l),N-m<n)return;const M=S&&N-S;return M?Math.round(L*1e3/M):void 0}}function T5(l,n){let a=0,o=1e3/n,s,e;const m=(N,S=Date.now())=>{a=S,s=null,e&&(clearTimeout(e),e=null),l(...N)};return[(...N)=>{const S=Date.now(),D=S-a;D>=o?m(N,S):(s=N,e||(e=setTimeout(()=>{e=null,m(s)},o-D)))},()=>s&&m(s)]}const xp=(l,n,a=3)=>{let o=0;const s=D5(50,250);return T5(e=>{const m=e.loaded,v=e.lengthComputable?e.total:void 0,w=m-o,N=s(w),S=m<=v;o=m;const D={loaded:m,total:v,progress:v?m/v:void 0,bytes:w,rate:N||void 0,estimated:N&&v&&S?(v-m)/N:void 0,event:e,lengthComputable:v!=null,[n?"download":"upload"]:!0};l(D)},a)},Yx=(l,n)=>{const a=l!=null;return[o=>n[0]({lengthComputable:a,total:l,loaded:o}),n[1]]},Gx=l=>(...n)=>ct.asap(()=>l(...n)),_5=tn.hasStandardBrowserEnv?((l,n)=>a=>(a=new URL(a,tn.origin),l.protocol===a.protocol&&l.host===a.host&&(n||l.port===a.port)))(new URL(tn.origin),tn.navigator&&/(msie|trident)/i.test(tn.navigator.userAgent)):()=>!0,F5=tn.hasStandardBrowserEnv?{write(l,n,a,o,s,e,m){if(typeof document>"u")return;const v=[`${l}=${encodeURIComponent(n)}`];ct.isNumber(a)&&v.push(`expires=${new Date(a).toUTCString()}`),ct.isString(o)&&v.push(`path=${o}`),ct.isString(s)&&v.push(`domain=${s}`),e===!0&&v.push("secure"),ct.isString(m)&&v.push(`SameSite=${m}`),document.cookie=v.join("; ")},read(l){if(typeof document>"u")return null;const n=document.cookie.match(new RegExp("(?:^|; )"+l+"=([^;]*)"));return n?decodeURIComponent(n[1]):null},remove(l){this.write(l,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function M5(l){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(l)}function L5(l,n){return n?l.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):l}function yy(l,n,a){let o=!M5(n);return l&&(o||a==!1)?L5(l,n):n}const Kx=l=>l instanceof Hn?{...l}:l;function t0(l,n){n=n||{};const a={};function o(N,S,D,L){return ct.isPlainObject(N)&&ct.isPlainObject(S)?ct.merge.call({caseless:L},N,S):ct.isPlainObject(S)?ct.merge({},S):ct.isArray(S)?S.slice():S}function s(N,S,D,L){if(ct.isUndefined(S)){if(!ct.isUndefined(N))return o(void 0,N,D,L)}else return o(N,S,D,L)}function e(N,S){if(!ct.isUndefined(S))return o(void 0,S)}function m(N,S){if(ct.isUndefined(S)){if(!ct.isUndefined(N))return o(void 0,N)}else return o(void 0,S)}function v(N,S,D){if(D in n)return o(N,S);if(D in l)return o(void 0,N)}const w={url:e,method:e,data:e,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:v,headers:(N,S,D)=>s(Kx(N),Kx(S),D,!0)};return ct.forEach(Object.keys({...l,...n}),function(S){const D=w[S]||s,L=D(l[S],n[S],S);ct.isUndefined(L)&&D!==v||(a[S]=L)}),a}const vy=l=>{const n=t0({},l);let{data:a,withXSRFToken:o,xsrfHeaderName:s,xsrfCookieName:e,headers:m,auth:v}=n;if(n.headers=m=Hn.from(m),n.url=my(yy(n.baseURL,n.url,n.allowAbsoluteUrls),l.params,l.paramsSerializer),v&&m.set("Authorization","Basic "+btoa((v.username||"")+":"+(v.password?unescape(encodeURIComponent(v.password)):""))),ct.isFormData(a)){if(tn.hasStandardBrowserEnv||tn.hasStandardBrowserWebWorkerEnv)m.setContentType(void 0);else if(ct.isFunction(a.getHeaders)){const w=a.getHeaders(),N=["content-type","content-length"];Object.entries(w).forEach(([S,D])=>{N.includes(S.toLowerCase())&&m.set(S,D)})}}if(tn.hasStandardBrowserEnv&&(o&&ct.isFunction(o)&&(o=o(n)),o||o!==!1&&_5(n.url))){const w=s&&e&&F5.read(e);w&&m.set(s,w)}return n},R5=typeof XMLHttpRequest<"u",O5=R5&&function(l){return new Promise(function(a,o){const s=vy(l);let e=s.data;const m=Hn.from(s.headers).normalize();let{responseType:v,onUploadProgress:w,onDownloadProgress:N}=s,S,D,L,M,F;function O(){M&&M(),F&&F(),s.cancelToken&&s.cancelToken.unsubscribe(S),s.signal&&s.signal.removeEventListener("abort",S)}let P=new XMLHttpRequest;P.open(s.method.toUpperCase(),s.url,!0),P.timeout=s.timeout;function G(){if(!P)return;const re=Hn.from("getAllResponseHeaders"in P&&P.getAllResponseHeaders()),xe={data:!v||v==="text"||v==="json"?P.responseText:P.response,status:P.status,statusText:P.statusText,headers:re,config:l,request:P};by(function(Z){a(Z),O()},function(Z){o(Z),O()},xe),P=null}"onloadend"in P?P.onloadend=G:P.onreadystatechange=function(){!P||P.readyState!==4||P.status===0&&!(P.responseURL&&P.responseURL.indexOf("file:")===0)||setTimeout(G)},P.onabort=function(){P&&(o(new Os("Request aborted",Os.ECONNABORTED,l,P)),P=null)},P.onerror=function(Ne){const xe=Ne&&Ne.message?Ne.message:"Network Error",we=new Os(xe,Os.ERR_NETWORK,l,P);we.event=Ne||null,o(we),P=null},P.ontimeout=function(){let Ne=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const xe=s.transitional||gy;s.timeoutErrorMessage&&(Ne=s.timeoutErrorMessage),o(new Os(Ne,xe.clarifyTimeoutError?Os.ETIMEDOUT:Os.ECONNABORTED,l,P)),P=null},e===void 0&&m.setContentType(null),"setRequestHeader"in P&&ct.forEach(m.toJSON(),function(Ne,xe){P.setRequestHeader(xe,Ne)}),ct.isUndefined(s.withCredentials)||(P.withCredentials=!!s.withCredentials),v&&v!=="json"&&(P.responseType=s.responseType),N&&([L,F]=xp(N,!0),P.addEventListener("progress",L)),w&&P.upload&&([D,M]=xp(w),P.upload.addEventListener("progress",D),P.upload.addEventListener("loadend",M)),(s.cancelToken||s.signal)&&(S=re=>{P&&(o(!re||re.type?new sh(null,l,P):re),P.abort(),P=null)},s.cancelToken&&s.cancelToken.subscribe(S),s.signal&&(s.signal.aborted?S():s.signal.addEventListener("abort",S)));const ae=E5(s.url);if(ae&&tn.protocols.indexOf(ae)===-1){o(new Os("Unsupported protocol "+ae+":",Os.ERR_BAD_REQUEST,l));return}P.send(e||null)})},P5=(l,n)=>{const{length:a}=l=l?l.filter(Boolean):[];if(n||a){let o=new AbortController,s;const e=function(N){if(!s){s=!0,v();const S=N instanceof Error?N:this.reason;o.abort(S instanceof Os?S:new sh(S instanceof Error?S.message:S))}};let m=n&&setTimeout(()=>{m=null,e(new Os(`timeout ${n} of ms exceeded`,Os.ETIMEDOUT))},n);const v=()=>{l&&(m&&clearTimeout(m),m=null,l.forEach(N=>{N.unsubscribe?N.unsubscribe(e):N.removeEventListener("abort",e)}),l=null)};l.forEach(N=>N.addEventListener("abort",e));const{signal:w}=o;return w.unsubscribe=()=>ct.asap(v),w}},I5=function*(l,n){let a=l.byteLength;if(a<n){yield l;return}let o=0,s;for(;o<a;)s=o+n,yield l.slice(o,s),o=s},B5=async function*(l,n){for await(const a of z5(l))yield*I5(a,n)},z5=async function*(l){if(l[Symbol.asyncIterator]){yield*l;return}const n=l.getReader();try{for(;;){const{done:a,value:o}=await n.read();if(a)break;yield o}}finally{await n.cancel()}},Qx=(l,n,a,o)=>{const s=B5(l,n);let e=0,m,v=w=>{m||(m=!0,o&&o(w))};return new ReadableStream({async pull(w){try{const{done:N,value:S}=await s.next();if(N){v(),w.close();return}let D=S.byteLength;if(a){let L=e+=D;a(L)}w.enqueue(new Uint8Array(S))}catch(N){throw v(N),N}},cancel(w){return v(w),s.return()}},{highWaterMark:2})},Xx=64*1024,{isFunction:Hg}=ct,U5=(({Request:l,Response:n})=>({Request:l,Response:n}))(ct.global),{ReadableStream:Jx,TextEncoder:Zx}=ct.global,e2=(l,...n)=>{try{return!!l(...n)}catch{return!1}},H5=l=>{l=ct.merge.call({skipUndefined:!0},U5,l);const{fetch:n,Request:a,Response:o}=l,s=n?Hg(n):typeof fetch=="function",e=Hg(a),m=Hg(o);if(!s)return!1;const v=s&&Hg(Jx),w=s&&(typeof Zx=="function"?(F=>O=>F.encode(O))(new Zx):async F=>new Uint8Array(await new a(F).arrayBuffer())),N=e&&v&&e2(()=>{let F=!1;const O=new a(tn.origin,{body:new Jx,method:"POST",get duplex(){return F=!0,"half"}}).headers.has("Content-Type");return F&&!O}),S=m&&v&&e2(()=>ct.isReadableStream(new o("").body)),D={stream:S&&(F=>F.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(F=>{!D[F]&&(D[F]=(O,P)=>{let G=O&&O[F];if(G)return G.call(O);throw new Os(`Response type '${F}' is not supported`,Os.ERR_NOT_SUPPORT,P)})});const L=async F=>{if(F==null)return 0;if(ct.isBlob(F))return F.size;if(ct.isSpecCompliantForm(F))return(await new a(tn.origin,{method:"POST",body:F}).arrayBuffer()).byteLength;if(ct.isArrayBufferView(F)||ct.isArrayBuffer(F))return F.byteLength;if(ct.isURLSearchParams(F)&&(F=F+""),ct.isString(F))return(await w(F)).byteLength},M=async(F,O)=>{const P=ct.toFiniteNumber(F.getContentLength());return P??L(O)};return async F=>{let{url:O,method:P,data:G,signal:ae,cancelToken:re,timeout:Ne,onDownloadProgress:xe,onUploadProgress:we,responseType:Z,headers:ce,withCredentials:ue="same-origin",fetchOptions:Le}=vy(F),be=n||fetch;Z=Z?(Z+"").toLowerCase():"text";let oe=P5([ae,re&&re.toAbortSignal()],Ne),he=null;const ye=oe&&oe.unsubscribe&&(()=>{oe.unsubscribe()});let Te;try{if(we&&N&&P!=="get"&&P!=="head"&&(Te=await M(ce,G))!==0){let W=new a(O,{method:"POST",body:G,duplex:"half"}),pe;if(ct.isFormData(G)&&(pe=W.headers.get("content-type"))&&ce.setContentType(pe),W.body){const[Me,Se]=Yx(Te,xp(Gx(we)));G=Qx(W.body,Xx,Me,Se)}}ct.isString(ue)||(ue=ue?"include":"omit");const fe=e&&"credentials"in a.prototype,_e={...Le,signal:oe,method:P.toUpperCase(),headers:ce.normalize().toJSON(),body:G,duplex:"half",credentials:fe?ue:void 0};he=e&&new a(O,_e);let We=await(e?be(he,Le):be(O,_e));const se=S&&(Z==="stream"||Z==="response");if(S&&(xe||se&&ye)){const W={};["status","statusText","headers"].forEach(V=>{W[V]=We[V]});const pe=ct.toFiniteNumber(We.headers.get("content-length")),[Me,Se]=xe&&Yx(pe,xp(Gx(xe),!0))||[];We=new o(Qx(We.body,Xx,Me,()=>{Se&&Se(),ye&&ye()}),W)}Z=Z||"text";let me=await D[ct.findKey(D,Z)||"text"](We,F);return!se&&ye&&ye(),await new Promise((W,pe)=>{by(W,pe,{data:me,headers:Hn.from(We.headers),status:We.status,statusText:We.statusText,config:F,request:he})})}catch(fe){throw ye&&ye(),fe&&fe.name==="TypeError"&&/Load failed|fetch/i.test(fe.message)?Object.assign(new Os("Network Error",Os.ERR_NETWORK,F,he),{cause:fe.cause||fe}):Os.from(fe,fe&&fe.code,F,he)}}},V5=new Map,wy=l=>{let n=l&&l.env||{};const{fetch:a,Request:o,Response:s}=n,e=[o,s,a];let m=e.length,v=m,w,N,S=V5;for(;v--;)w=e[v],N=S.get(w),N===void 0&&S.set(w,N=v?new Map:H5(n)),S=N;return N};wy();const ux={http:i5,xhr:O5,fetch:{get:wy}};ct.forEach(ux,(l,n)=>{if(l){try{Object.defineProperty(l,"name",{value:n})}catch{}Object.defineProperty(l,"adapterName",{value:n})}});const t2=l=>`- ${l}`,W5=l=>ct.isFunction(l)||l===null||l===!1;function $5(l,n){l=ct.isArray(l)?l:[l];const{length:a}=l;let o,s;const e={};for(let m=0;m<a;m++){o=l[m];let v;if(s=o,!W5(o)&&(s=ux[(v=String(o)).toLowerCase()],s===void 0))throw new Os(`Unknown adapter '${v}'`);if(s&&(ct.isFunction(s)||(s=s.get(n))))break;e[v||"#"+m]=s}if(!s){const m=Object.entries(e).map(([w,N])=>`adapter ${w} `+(N===!1?"is not supported by the environment":"is not available in the build"));let v=a?m.length>1?`since :
`+m.map(t2).join(`
`):" "+t2(m[0]):"as no adapter specified";throw new Os("There is no suitable adapter to dispatch the request "+v,"ERR_NOT_SUPPORT")}return s}const jy={getAdapter:$5,adapters:ux};function p1(l){if(l.cancelToken&&l.cancelToken.throwIfRequested(),l.signal&&l.signal.aborted)throw new sh(null,l)}function s2(l){return p1(l),l.headers=Hn.from(l.headers),l.data=g1.call(l,l.transformRequest),["post","put","patch"].indexOf(l.method)!==-1&&l.headers.setContentType("application/x-www-form-urlencoded",!1),jy.getAdapter(l.adapter||pm.adapter,l)(l).then(function(o){return p1(l),o.data=g1.call(l,l.transformResponse,o),o.headers=Hn.from(o.headers),o},function(o){return xy(o)||(p1(l),o&&o.response&&(o.response.data=g1.call(l,l.transformResponse,o.response),o.response.headers=Hn.from(o.response.headers))),Promise.reject(o)})}const Ny="1.13.2",_p={};["object","boolean","number","function","string","symbol"].forEach((l,n)=>{_p[l]=function(o){return typeof o===l||"a"+(n<1?"n ":" ")+l}});const r2={};_p.transitional=function(n,a,o){function s(e,m){return"[Axios v"+Ny+"] Transitional option '"+e+"'"+m+(o?". "+o:"")}return(e,m,v)=>{if(n===!1)throw new Os(s(m," has been removed"+(a?" in "+a:"")),Os.ERR_DEPRECATED);return a&&!r2[m]&&(r2[m]=!0,console.warn(s(m," has been deprecated since v"+a+" and will be removed in the near future"))),n?n(e,m,v):!0}};_p.spelling=function(n){return(a,o)=>(console.warn(`${o} is likely a misspelling of ${n}`),!0)};function q5(l,n,a){if(typeof l!="object")throw new Os("options must be an object",Os.ERR_BAD_OPTION_VALUE);const o=Object.keys(l);let s=o.length;for(;s-- >0;){const e=o[s],m=n[e];if(m){const v=l[e],w=v===void 0||m(v,e,l);if(w!==!0)throw new Os("option "+e+" must be "+w,Os.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new Os("Unknown option "+e,Os.ERR_BAD_OPTION)}}const dp={assertOptions:q5,validators:_p},Il=dp.validators;let Zd=class{constructor(n){this.defaults=n||{},this.interceptors={request:new $x,response:new $x}}async request(n,a){try{return await this._request(n,a)}catch(o){if(o instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const e=s.stack?s.stack.replace(/^.+\n/,""):"";try{o.stack?e&&!String(o.stack).endsWith(e.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+e):o.stack=e}catch{}}throw o}}_request(n,a){typeof n=="string"?(a=a||{},a.url=n):a=n||{},a=t0(this.defaults,a);const{transitional:o,paramsSerializer:s,headers:e}=a;o!==void 0&&dp.assertOptions(o,{silentJSONParsing:Il.transitional(Il.boolean),forcedJSONParsing:Il.transitional(Il.boolean),clarifyTimeoutError:Il.transitional(Il.boolean)},!1),s!=null&&(ct.isFunction(s)?a.paramsSerializer={serialize:s}:dp.assertOptions(s,{encode:Il.function,serialize:Il.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),dp.assertOptions(a,{baseUrl:Il.spelling("baseURL"),withXsrfToken:Il.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let m=e&&ct.merge(e.common,e[a.method]);e&&ct.forEach(["delete","get","head","post","put","patch","common"],F=>{delete e[F]}),a.headers=Hn.concat(m,e);const v=[];let w=!0;this.interceptors.request.forEach(function(O){typeof O.runWhen=="function"&&O.runWhen(a)===!1||(w=w&&O.synchronous,v.unshift(O.fulfilled,O.rejected))});const N=[];this.interceptors.response.forEach(function(O){N.push(O.fulfilled,O.rejected)});let S,D=0,L;if(!w){const F=[s2.bind(this),void 0];for(F.unshift(...v),F.push(...N),L=F.length,S=Promise.resolve(a);D<L;)S=S.then(F[D++],F[D++]);return S}L=v.length;let M=a;for(;D<L;){const F=v[D++],O=v[D++];try{M=F(M)}catch(P){O.call(this,P);break}}try{S=s2.call(this,M)}catch(F){return Promise.reject(F)}for(D=0,L=N.length;D<L;)S=S.then(N[D++],N[D++]);return S}getUri(n){n=t0(this.defaults,n);const a=yy(n.baseURL,n.url,n.allowAbsoluteUrls);return my(a,n.params,n.paramsSerializer)}};ct.forEach(["delete","get","head","options"],function(n){Zd.prototype[n]=function(a,o){return this.request(t0(o||{},{method:n,url:a,data:(o||{}).data}))}});ct.forEach(["post","put","patch"],function(n){function a(o){return function(e,m,v){return this.request(t0(v||{},{method:n,headers:o?{"Content-Type":"multipart/form-data"}:{},url:e,data:m}))}}Zd.prototype[n]=a(),Zd.prototype[n+"Form"]=a(!0)});let Y5=class ky{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(e){a=e});const o=this;this.promise.then(s=>{if(!o._listeners)return;let e=o._listeners.length;for(;e-- >0;)o._listeners[e](s);o._listeners=null}),this.promise.then=s=>{let e;const m=new Promise(v=>{o.subscribe(v),e=v}).then(s);return m.cancel=function(){o.unsubscribe(e)},m},n(function(e,m,v){o.reason||(o.reason=new sh(e,m,v),a(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const a=this._listeners.indexOf(n);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const n=new AbortController,a=o=>{n.abort(o)};return this.subscribe(a),n.signal.unsubscribe=()=>this.unsubscribe(a),n.signal}static source(){let n;return{token:new ky(function(s){n=s}),cancel:n}}};function G5(l){return function(a){return l.apply(null,a)}}function K5(l){return ct.isObject(l)&&l.isAxiosError===!0}const $1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries($1).forEach(([l,n])=>{$1[n]=l});function Cy(l){const n=new Zd(l),a=sy(Zd.prototype.request,n);return ct.extend(a,Zd.prototype,n,{allOwnKeys:!0}),ct.extend(a,n,null,{allOwnKeys:!0}),a.create=function(s){return Cy(t0(l,s))},a}const ta=Cy(pm);ta.Axios=Zd;ta.CanceledError=sh;ta.CancelToken=Y5;ta.isCancel=xy;ta.VERSION=Ny;ta.toFormData=Tp;ta.AxiosError=Os;ta.Cancel=ta.CanceledError;ta.all=function(n){return Promise.all(n)};ta.spread=G5;ta.isAxiosError=K5;ta.mergeConfig=t0;ta.AxiosHeaders=Hn;ta.formToJSON=l=>py(ct.isHTMLForm(l)?new FormData(l):l);ta.getAdapter=jy.getAdapter;ta.HttpStatusCode=$1;ta.default=ta;const{Axios:$7,AxiosError:q7,CanceledError:Y7,isCancel:G7,CancelToken:K7,VERSION:Q7,all:X7,Cancel:J7,isAxiosError:Z7,spread:eC,toFormData:tC,AxiosHeaders:sC,HttpStatusCode:rC,formToJSON:aC,getAdapter:nC,mergeConfig:iC}=ta,Q5=()=>{const n="http://localhost:5000/api".replace(/\/$/,"");return n.endsWith("/api")?n:`${n}/api`},Ht=ta.create({baseURL:Q5()});Ht.interceptors.request.use(l=>{const n=localStorage.getItem("token");return n&&(l.headers.Authorization=`Bearer ${n}`),l});Ht.interceptors.response.use(l=>l,l=>(ta.isCancel&&ta.isCancel(l)||l.name==="CanceledError"||l.message==="canceled"||l.code==="ERR_CANCELED"||l.config&&l.config.signal&&l.config.signal.aborted||(l.response?(console.error("API Error Response:",l.response.status,l.response.statusText),console.error("Error Details:",JSON.stringify(l.response.data,null,2)),console.error("Request URL:",l.config?.baseURL+l.config?.url),console.error("Request Method:",l.config?.method?.toUpperCase())):l.request?(console.error("API Network Error - No response received"),console.error("Error Message:",l.message),console.error("Error Code:",l.code),console.error("Request URL:",l.config?.baseURL+l.config?.url)):console.error("API Request Setup Error:",l.message)),Promise.reject(l)));function X5(){const l=Fr();B.useEffect(()=>{localStorage.getItem("token")&&l("/dashboard",{replace:!0})},[l]);const[n,a]=B.useState(!0),[o,s]=B.useState({email:"",password:"",name:""}),[e,m]=B.useState(!1),[v,w]=B.useState(""),N=L=>{s({...o,[L.target.name]:L.target.value}),w("")},S=()=>{s({email:"",password:"",name:""}),w("")},D=async L=>{if(L.preventDefault(),w(""),!o.email.trim()){w("Email is required");return}if(!o.password.trim()){w("Password is required");return}if(o.password.length<6){w("Password must be at least 6 characters long");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email.trim())){w("Please enter a valid email address");return}m(!0);try{const F=n?"/auth/login":"/auth/register",O=n?{email:o.email.trim(),password:o.password}:{email:o.email.trim(),password:o.password,...o.name&&o.name.trim()&&{name:o.name.trim()}},P=await Ht.post(F,O);P.data.success&&(localStorage.setItem("token",P.data.data.token),localStorage.setItem("user",JSON.stringify(P.data.data.user)),l("/dashboard"))}catch(F){F.code==="ERR_NETWORK"||F.message==="Network Error"||!F.response?w("Cannot connect to server. Please make sure the backend server is running on http://localhost:5000"):w(F.response?.data?.error||F.message||(n?"Login failed. Please check your credentials.":"Registration failed. Please try again."))}finally{m(!1)}};return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4",children:t.jsxs("div",{className:"w-full max-w-md",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-2xl mb-4 shadow-lg",children:t.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full"})})}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Outbound SaaS"}),t.jsx("p",{className:"text-gray-600",children:n?"Welcome back":"Let's get you started"})]}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[t.jsxs("div",{className:"flex gap-2 mb-6 p-1 bg-gray-100 rounded-lg",children:[t.jsx("button",{type:"button",onClick:()=>{a(!0),S()},className:`flex-1 py-2 px-4 rounded-md text-sm font-semibold transition-all ${n?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Login"}),t.jsx("button",{type:"button",onClick:()=>{a(!1),S()},className:`flex-1 py-2 px-4 rounded-md text-sm font-semibold transition-all ${n?"text-gray-600 hover:text-gray-900":"bg-white text-blue-600 shadow-sm"}`,children:"Register"})]}),v&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:v}),t.jsxs("form",{onSubmit:D,className:"space-y-4",children:[!n&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),t.jsx("input",{type:"text",name:"name",value:o.name,onChange:N,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:"Your name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),t.jsx("input",{type:"email",name:"email",value:o.email,onChange:N,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:"your@email.com"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),n&&t.jsx("button",{type:"button",onClick:()=>l("/reset-password"),className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Forgot Password?"})]}),t.jsx("input",{type:"password",name:"password",value:o.password,onChange:N,required:!0,minLength:6,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:""}),!n&&t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters"})]}),t.jsx("button",{type:"submit",disabled:e,className:"w-full py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:e?t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n?"Logging in...":"Creating account..."]}):n?"Login":"Create Account"})]})]}),t.jsx("p",{className:"text-center text-sm text-gray-500 mt-6",children:n?t.jsxs(t.Fragment,{children:["Don't have an account?"," ",t.jsx("button",{onClick:()=>{a(!1),S()},className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Sign up"})]}):t.jsxs(t.Fragment,{children:["Already have an account?"," ",t.jsx("button",{onClick:()=>{a(!0),S()},className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Sign in"})]})})]})})}function J5(){const l=Fr(),[n,a]=B.useState({email:"",newPassword:"",confirmPassword:""}),[o,s]=B.useState(!1),[e,m]=B.useState(""),[v,w]=B.useState(""),N=D=>{a({...n,[D.target.name]:D.target.value}),m(""),w("")},S=async D=>{if(D.preventDefault(),m(""),w(""),!n.email.trim()){m("Email is required");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email.trim())){m("Please enter a valid email address");return}if(!n.newPassword.trim()){m("New password is required");return}if(n.newPassword.length<6){m("Password must be at least 6 characters long");return}if(n.newPassword!==n.confirmPassword){m("Passwords do not match");return}s(!0);try{(await Ht.post("/auth/reset-password",{email:n.email.trim(),newPassword:n.newPassword})).data.success&&(w("Password reset successfully! Redirecting to login..."),setTimeout(()=>{l("/login")},2e3))}catch(M){M.code==="ERR_NETWORK"||M.message==="Network Error"||!M.response?m("Cannot connect to server. Please make sure the backend server is running."):m(M.response?.data?.error||M.message||"Failed to reset password")}finally{s(!1)}};return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4",children:t.jsxs("div",{className:"w-full max-w-md",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-2xl mb-4 shadow-lg",children:t.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full"})})}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reset Password"}),t.jsx("p",{className:"text-gray-600",children:"Enter your email and new password to reset"})]}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[e&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:e}),v&&t.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 text-green-700 rounded-lg text-sm",children:v}),t.jsxs("form",{onSubmit:S,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),t.jsx("input",{type:"password",name:"newPassword",value:n.newPassword,onChange:N,required:!0,minLength:6,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:""}),t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),t.jsx("input",{type:"password",name:"confirmPassword",value:n.confirmPassword,onChange:N,required:!0,minLength:6,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),t.jsx("input",{type:"email",name:"email",value:n.email,onChange:N,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:"your@email.com"})]}),t.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:o?t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Resetting..."]}):"Reset Password"})]})]}),t.jsxs("p",{className:"text-center text-sm text-gray-500 mt-6",children:["Remember your password?"," ",t.jsx("button",{onClick:()=>l("/login"),className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Sign in"})]})]})})}const Z5="modulepreload",e3=function(l){return"/"+l},a2={},Da=function(n,a,o){let s=Promise.resolve();if(a&&a.length>0){let N=function(S){return Promise.all(S.map(D=>Promise.resolve(D).then(L=>({status:"fulfilled",value:L}),L=>({status:"rejected",reason:L}))))};var m=N;document.getElementsByTagName("link");const v=document.querySelector("meta[property=csp-nonce]"),w=v?.nonce||v?.getAttribute("nonce");s=N(a.map(S=>{if(S=e3(S),S in a2)return;a2[S]=!0;const D=S.endsWith(".css"),L=D?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${L}`))return;const M=document.createElement("link");if(M.rel=D?"stylesheet":Z5,D||(M.as="script"),M.crossOrigin="",M.href=S,w&&M.setAttribute("nonce",w),document.head.appendChild(M),D)return new Promise((F,O)=>{M.addEventListener("load",F),M.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${S}`)))})}))}function e(v){const w=new Event("vite:preloadError",{cancelable:!0});if(w.payload=v,window.dispatchEvent(w),!w.defaultPrevented)throw v}return s.then(v=>{for(const w of v||[])w.status==="rejected"&&e(w.reason);return n().catch(e)})};function xm(l){return l+.5|0}const Fc=(l,n,a)=>Math.max(Math.min(l,a),n);function Qf(l){return Fc(xm(l*2.55),0,255)}function Rc(l){return Fc(xm(l*255),0,255)}function Mo(l){return Fc(xm(l/2.55)/100,0,1)}function n2(l){return Fc(xm(l*100),0,100)}const Ai={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},q1=[..."0123456789ABCDEF"],t3=l=>q1[l&15],s3=l=>q1[(l&240)>>4]+q1[l&15],Vg=l=>(l&240)>>4===(l&15),r3=l=>Vg(l.r)&&Vg(l.g)&&Vg(l.b)&&Vg(l.a);function a3(l){var n=l.length,a;return l[0]==="#"&&(n===4||n===5?a={r:255&Ai[l[1]]*17,g:255&Ai[l[2]]*17,b:255&Ai[l[3]]*17,a:n===5?Ai[l[4]]*17:255}:(n===7||n===9)&&(a={r:Ai[l[1]]<<4|Ai[l[2]],g:Ai[l[3]]<<4|Ai[l[4]],b:Ai[l[5]]<<4|Ai[l[6]],a:n===9?Ai[l[7]]<<4|Ai[l[8]]:255})),a}const n3=(l,n)=>l<255?n(l):"";function i3(l){var n=r3(l)?t3:s3;return l?"#"+n(l.r)+n(l.g)+n(l.b)+n3(l.a,n):void 0}const l3=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Sy(l,n,a){const o=n*Math.min(a,1-a),s=(e,m=(e+l/30)%12)=>a-o*Math.max(Math.min(m-3,9-m,1),-1);return[s(0),s(8),s(4)]}function o3(l,n,a){const o=(s,e=(s+l/60)%6)=>a-a*n*Math.max(Math.min(e,4-e,1),0);return[o(5),o(3),o(1)]}function c3(l,n,a){const o=Sy(l,1,.5);let s;for(n+a>1&&(s=1/(n+a),n*=s,a*=s),s=0;s<3;s++)o[s]*=1-n-a,o[s]+=n;return o}function d3(l,n,a,o,s){return l===s?(n-a)/o+(n<a?6:0):n===s?(a-l)/o+2:(l-n)/o+4}function hx(l){const a=l.r/255,o=l.g/255,s=l.b/255,e=Math.max(a,o,s),m=Math.min(a,o,s),v=(e+m)/2;let w,N,S;return e!==m&&(S=e-m,N=v>.5?S/(2-e-m):S/(e+m),w=d3(a,o,s,S,e),w=w*60+.5),[w|0,N||0,v]}function fx(l,n,a,o){return(Array.isArray(n)?l(n[0],n[1],n[2]):l(n,a,o)).map(Rc)}function mx(l,n,a){return fx(Sy,l,n,a)}function u3(l,n,a){return fx(c3,l,n,a)}function h3(l,n,a){return fx(o3,l,n,a)}function Ay(l){return(l%360+360)%360}function f3(l){const n=l3.exec(l);let a=255,o;if(!n)return;n[5]!==o&&(a=n[6]?Qf(+n[5]):Rc(+n[5]));const s=Ay(+n[2]),e=+n[3]/100,m=+n[4]/100;return n[1]==="hwb"?o=u3(s,e,m):n[1]==="hsv"?o=h3(s,e,m):o=mx(s,e,m),{r:o[0],g:o[1],b:o[2],a}}function m3(l,n){var a=hx(l);a[0]=Ay(a[0]+n),a=mx(a),l.r=a[0],l.g=a[1],l.b=a[2]}function g3(l){if(!l)return;const n=hx(l),a=n[0],o=n2(n[1]),s=n2(n[2]);return l.a<255?`hsla(${a}, ${o}%, ${s}%, ${Mo(l.a)})`:`hsl(${a}, ${o}%, ${s}%)`}const i2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},l2={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function p3(){const l={},n=Object.keys(l2),a=Object.keys(i2);let o,s,e,m,v;for(o=0;o<n.length;o++){for(m=v=n[o],s=0;s<a.length;s++)e=a[s],v=v.replace(e,i2[e]);e=parseInt(l2[m],16),l[v]=[e>>16&255,e>>8&255,e&255]}return l}let Wg;function x3(l){Wg||(Wg=p3(),Wg.transparent=[0,0,0,0]);const n=Wg[l.toLowerCase()];return n&&{r:n[0],g:n[1],b:n[2],a:n.length===4?n[3]:255}}const b3=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function y3(l){const n=b3.exec(l);let a=255,o,s,e;if(n){if(n[7]!==o){const m=+n[7];a=n[8]?Qf(m):Fc(m*255,0,255)}return o=+n[1],s=+n[3],e=+n[5],o=255&(n[2]?Qf(o):Fc(o,0,255)),s=255&(n[4]?Qf(s):Fc(s,0,255)),e=255&(n[6]?Qf(e):Fc(e,0,255)),{r:o,g:s,b:e,a}}}function v3(l){return l&&(l.a<255?`rgba(${l.r}, ${l.g}, ${l.b}, ${Mo(l.a)})`:`rgb(${l.r}, ${l.g}, ${l.b})`)}const x1=l=>l<=.0031308?l*12.92:Math.pow(l,1/2.4)*1.055-.055,Hu=l=>l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4);function w3(l,n,a){const o=Hu(Mo(l.r)),s=Hu(Mo(l.g)),e=Hu(Mo(l.b));return{r:Rc(x1(o+a*(Hu(Mo(n.r))-o))),g:Rc(x1(s+a*(Hu(Mo(n.g))-s))),b:Rc(x1(e+a*(Hu(Mo(n.b))-e))),a:l.a+a*(n.a-l.a)}}function $g(l,n,a){if(l){let o=hx(l);o[n]=Math.max(0,Math.min(o[n]+o[n]*a,n===0?360:1)),o=mx(o),l.r=o[0],l.g=o[1],l.b=o[2]}}function Ey(l,n){return l&&Object.assign(n||{},l)}function o2(l){var n={r:0,g:0,b:0,a:255};return Array.isArray(l)?l.length>=3&&(n={r:l[0],g:l[1],b:l[2],a:255},l.length>3&&(n.a=Rc(l[3]))):(n=Ey(l,{r:0,g:0,b:0,a:1}),n.a=Rc(n.a)),n}function j3(l){return l.charAt(0)==="r"?y3(l):f3(l)}class am{constructor(n){if(n instanceof am)return n;const a=typeof n;let o;a==="object"?o=o2(n):a==="string"&&(o=a3(n)||x3(n)||j3(n)),this._rgb=o,this._valid=!!o}get valid(){return this._valid}get rgb(){var n=Ey(this._rgb);return n&&(n.a=Mo(n.a)),n}set rgb(n){this._rgb=o2(n)}rgbString(){return this._valid?v3(this._rgb):void 0}hexString(){return this._valid?i3(this._rgb):void 0}hslString(){return this._valid?g3(this._rgb):void 0}mix(n,a){if(n){const o=this.rgb,s=n.rgb;let e;const m=a===e?.5:a,v=2*m-1,w=o.a-s.a,N=((v*w===-1?v:(v+w)/(1+v*w))+1)/2;e=1-N,o.r=255&N*o.r+e*s.r+.5,o.g=255&N*o.g+e*s.g+.5,o.b=255&N*o.b+e*s.b+.5,o.a=m*o.a+(1-m)*s.a,this.rgb=o}return this}interpolate(n,a){return n&&(this._rgb=w3(this._rgb,n._rgb,a)),this}clone(){return new am(this.rgb)}alpha(n){return this._rgb.a=Rc(n),this}clearer(n){const a=this._rgb;return a.a*=1-n,this}greyscale(){const n=this._rgb,a=xm(n.r*.3+n.g*.59+n.b*.11);return n.r=n.g=n.b=a,this}opaquer(n){const a=this._rgb;return a.a*=1+n,this}negate(){const n=this._rgb;return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,this}lighten(n){return $g(this._rgb,2,n),this}darken(n){return $g(this._rgb,2,-n),this}saturate(n){return $g(this._rgb,1,n),this}desaturate(n){return $g(this._rgb,1,-n),this}rotate(n){return m3(this._rgb,n),this}}function Eo(){}const N3=(()=>{let l=0;return()=>l++})();function dr(l){return l==null}function ja(l){if(Array.isArray&&Array.isArray(l))return!0;const n=Object.prototype.toString.call(l);return n.slice(0,7)==="[object"&&n.slice(-6)==="Array]"}function Xs(l){return l!==null&&Object.prototype.toString.call(l)==="[object Object]"}function an(l){return(typeof l=="number"||l instanceof Number)&&isFinite(+l)}function Bl(l,n){return an(l)?l:n}function Ms(l,n){return typeof l>"u"?n:l}const k3=(l,n)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100:+l/n,Dy=(l,n)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100*n:+l;function Wr(l,n,a){if(l&&typeof l.call=="function")return l.apply(a,n)}function vr(l,n,a,o){let s,e,m;if(ja(l))for(e=l.length,s=0;s<e;s++)n.call(a,l[s],s);else if(Xs(l))for(m=Object.keys(l),e=m.length,s=0;s<e;s++)n.call(a,l[m[s]],m[s])}function bp(l,n){let a,o,s,e;if(!l||!n||l.length!==n.length)return!1;for(a=0,o=l.length;a<o;++a)if(s=l[a],e=n[a],s.datasetIndex!==e.datasetIndex||s.index!==e.index)return!1;return!0}function yp(l){if(ja(l))return l.map(yp);if(Xs(l)){const n=Object.create(null),a=Object.keys(l),o=a.length;let s=0;for(;s<o;++s)n[a[s]]=yp(l[a[s]]);return n}return l}function Ty(l){return["__proto__","prototype","constructor"].indexOf(l)===-1}function C3(l,n,a,o){if(!Ty(l))return;const s=n[l],e=a[l];Xs(s)&&Xs(e)?nm(s,e,o):n[l]=yp(e)}function nm(l,n,a){const o=ja(n)?n:[n],s=o.length;if(!Xs(l))return l;a=a||{};const e=a.merger||C3;let m;for(let v=0;v<s;++v){if(m=o[v],!Xs(m))continue;const w=Object.keys(m);for(let N=0,S=w.length;N<S;++N)e(w[N],l,m,a)}return l}function Zf(l,n){return nm(l,n,{merger:S3})}function S3(l,n,a){if(!Ty(l))return;const o=n[l],s=a[l];Xs(o)&&Xs(s)?Zf(o,s):Object.prototype.hasOwnProperty.call(n,l)||(n[l]=yp(s))}const c2={"":l=>l,x:l=>l.x,y:l=>l.y};function A3(l){const n=l.split("."),a=[];let o="";for(const s of n)o+=s,o.endsWith("\\")?o=o.slice(0,-1)+".":(a.push(o),o="");return a}function E3(l){const n=A3(l);return a=>{for(const o of n){if(o==="")break;a=a&&a[o]}return a}}function Oc(l,n){return(c2[n]||(c2[n]=E3(n)))(l)}function gx(l){return l.charAt(0).toUpperCase()+l.slice(1)}const im=l=>typeof l<"u",Pc=l=>typeof l=="function",d2=(l,n)=>{if(l.size!==n.size)return!1;for(const a of l)if(!n.has(a))return!1;return!0};function D3(l){return l.type==="mouseup"||l.type==="click"||l.type==="contextmenu"}const pr=Math.PI,ea=2*pr,T3=ea+pr,vp=Number.POSITIVE_INFINITY,_3=pr/180,Ea=pr/2,qd=pr/4,u2=pr*2/3,_y=Math.log10,Vl=Math.sign;function em(l,n,a){return Math.abs(l-n)<a}function h2(l){const n=Math.round(l);l=em(l,n,l/1e3)?n:l;const a=Math.pow(10,Math.floor(_y(l))),o=l/a;return(o<=1?1:o<=2?2:o<=5?5:10)*a}function F3(l){const n=[],a=Math.sqrt(l);let o;for(o=1;o<a;o++)l%o===0&&(n.push(o),n.push(l/o));return a===(a|0)&&n.push(a),n.sort((s,e)=>s-e).pop(),n}function M3(l){return typeof l=="symbol"||typeof l=="object"&&l!==null&&!(Symbol.toPrimitive in l||"toString"in l||"valueOf"in l)}function Ku(l){return!M3(l)&&!isNaN(parseFloat(l))&&isFinite(l)}function L3(l,n){const a=Math.round(l);return a-n<=l&&a+n>=l}function R3(l,n,a){let o,s,e;for(o=0,s=l.length;o<s;o++)e=l[o][a],isNaN(e)||(n.min=Math.min(n.min,e),n.max=Math.max(n.max,e))}function Hl(l){return l*(pr/180)}function O3(l){return l*(180/pr)}function f2(l){if(!an(l))return;let n=1,a=0;for(;Math.round(l*n)/n!==l;)n*=10,a++;return a}function Fy(l,n){const a=n.x-l.x,o=n.y-l.y,s=Math.sqrt(a*a+o*o);let e=Math.atan2(o,a);return e<-.5*pr&&(e+=ea),{angle:e,distance:s}}function Y1(l,n){return Math.sqrt(Math.pow(n.x-l.x,2)+Math.pow(n.y-l.y,2))}function P3(l,n){return(l-n+T3)%ea-pr}function ii(l){return(l%ea+ea)%ea}function lm(l,n,a,o){const s=ii(l),e=ii(n),m=ii(a),v=ii(e-s),w=ii(m-s),N=ii(s-e),S=ii(s-m);return s===e||s===m||o&&e===m||v>w&&N<S}function sn(l,n,a){return Math.max(n,Math.min(a,l))}function I3(l){return sn(l,-32768,32767)}function Ro(l,n,a,o=1e-6){return l>=Math.min(n,a)-o&&l<=Math.max(n,a)+o}function px(l,n,a){a=a||(m=>l[m]<n);let o=l.length-1,s=0,e;for(;o-s>1;)e=s+o>>1,a(e)?s=e:o=e;return{lo:s,hi:o}}const Jd=(l,n,a,o)=>px(l,a,o?s=>{const e=l[s][n];return e<a||e===a&&l[s+1][n]===a}:s=>l[s][n]<a),B3=(l,n,a)=>px(l,a,o=>l[o][n]>=a);function z3(l,n,a){let o=0,s=l.length;for(;o<s&&l[o]<n;)o++;for(;s>o&&l[s-1]>a;)s--;return o>0||s<l.length?l.slice(o,s):l}const My=["push","pop","shift","splice","unshift"];function U3(l,n){if(l._chartjs){l._chartjs.listeners.push(n);return}Object.defineProperty(l,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[n]}}),My.forEach(a=>{const o="_onData"+gx(a),s=l[a];Object.defineProperty(l,a,{configurable:!0,enumerable:!1,value(...e){const m=s.apply(this,e);return l._chartjs.listeners.forEach(v=>{typeof v[o]=="function"&&v[o](...e)}),m}})})}function m2(l,n){const a=l._chartjs;if(!a)return;const o=a.listeners,s=o.indexOf(n);s!==-1&&o.splice(s,1),!(o.length>0)&&(My.forEach(e=>{delete l[e]}),delete l._chartjs)}function Ly(l){const n=new Set(l);return n.size===l.length?l:Array.from(n)}const Ry=(function(){return typeof window>"u"?function(l){return l()}:window.requestAnimationFrame})();function Oy(l,n){let a=[],o=!1;return function(...s){a=s,o||(o=!0,Ry.call(window,()=>{o=!1,l.apply(n,a)}))}}function H3(l,n){let a;return function(...o){return n?(clearTimeout(a),a=setTimeout(l,n,o)):l.apply(this,o),n}}const xx=l=>l==="start"?"left":l==="end"?"right":"center",en=(l,n,a)=>l==="start"?n:l==="end"?a:(n+a)/2,V3=(l,n,a,o)=>l===(o?"left":"right")?a:l==="center"?(n+a)/2:n;function Py(l,n,a){const o=n.length;let s=0,e=o;if(l._sorted){const{iScale:m,vScale:v,_parsed:w}=l,N=l.dataset&&l.dataset.options?l.dataset.options.spanGaps:null,S=m.axis,{min:D,max:L,minDefined:M,maxDefined:F}=m.getUserBounds();if(M){if(s=Math.min(Jd(w,S,D).lo,a?o:Jd(n,S,m.getPixelForValue(D)).lo),N){const O=w.slice(0,s+1).reverse().findIndex(P=>!dr(P[v.axis]));s-=Math.max(0,O)}s=sn(s,0,o-1)}if(F){let O=Math.max(Jd(w,m.axis,L,!0).hi+1,a?0:Jd(n,S,m.getPixelForValue(L),!0).hi+1);if(N){const P=w.slice(O-1).findIndex(G=>!dr(G[v.axis]));O+=Math.max(0,P)}e=sn(O,s,o)-s}else e=o-s}return{start:s,count:e}}function Iy(l){const{xScale:n,yScale:a,_scaleRanges:o}=l,s={xmin:n.min,xmax:n.max,ymin:a.min,ymax:a.max};if(!o)return l._scaleRanges=s,!0;const e=o.xmin!==n.min||o.xmax!==n.max||o.ymin!==a.min||o.ymax!==a.max;return Object.assign(o,s),e}const qg=l=>l===0||l===1,g2=(l,n,a)=>-(Math.pow(2,10*(l-=1))*Math.sin((l-n)*ea/a)),p2=(l,n,a)=>Math.pow(2,-10*l)*Math.sin((l-n)*ea/a)+1,tm={linear:l=>l,easeInQuad:l=>l*l,easeOutQuad:l=>-l*(l-2),easeInOutQuad:l=>(l/=.5)<1?.5*l*l:-.5*(--l*(l-2)-1),easeInCubic:l=>l*l*l,easeOutCubic:l=>(l-=1)*l*l+1,easeInOutCubic:l=>(l/=.5)<1?.5*l*l*l:.5*((l-=2)*l*l+2),easeInQuart:l=>l*l*l*l,easeOutQuart:l=>-((l-=1)*l*l*l-1),easeInOutQuart:l=>(l/=.5)<1?.5*l*l*l*l:-.5*((l-=2)*l*l*l-2),easeInQuint:l=>l*l*l*l*l,easeOutQuint:l=>(l-=1)*l*l*l*l+1,easeInOutQuint:l=>(l/=.5)<1?.5*l*l*l*l*l:.5*((l-=2)*l*l*l*l+2),easeInSine:l=>-Math.cos(l*Ea)+1,easeOutSine:l=>Math.sin(l*Ea),easeInOutSine:l=>-.5*(Math.cos(pr*l)-1),easeInExpo:l=>l===0?0:Math.pow(2,10*(l-1)),easeOutExpo:l=>l===1?1:-Math.pow(2,-10*l)+1,easeInOutExpo:l=>qg(l)?l:l<.5?.5*Math.pow(2,10*(l*2-1)):.5*(-Math.pow(2,-10*(l*2-1))+2),easeInCirc:l=>l>=1?l:-(Math.sqrt(1-l*l)-1),easeOutCirc:l=>Math.sqrt(1-(l-=1)*l),easeInOutCirc:l=>(l/=.5)<1?-.5*(Math.sqrt(1-l*l)-1):.5*(Math.sqrt(1-(l-=2)*l)+1),easeInElastic:l=>qg(l)?l:g2(l,.075,.3),easeOutElastic:l=>qg(l)?l:p2(l,.075,.3),easeInOutElastic(l){return qg(l)?l:l<.5?.5*g2(l*2,.1125,.45):.5+.5*p2(l*2-1,.1125,.45)},easeInBack(l){return l*l*((1.70158+1)*l-1.70158)},easeOutBack(l){return(l-=1)*l*((1.70158+1)*l+1.70158)+1},easeInOutBack(l){let n=1.70158;return(l/=.5)<1?.5*(l*l*(((n*=1.525)+1)*l-n)):.5*((l-=2)*l*(((n*=1.525)+1)*l+n)+2)},easeInBounce:l=>1-tm.easeOutBounce(1-l),easeOutBounce(l){return l<1/2.75?7.5625*l*l:l<2/2.75?7.5625*(l-=1.5/2.75)*l+.75:l<2.5/2.75?7.5625*(l-=2.25/2.75)*l+.9375:7.5625*(l-=2.625/2.75)*l+.984375},easeInOutBounce:l=>l<.5?tm.easeInBounce(l*2)*.5:tm.easeOutBounce(l*2-1)*.5+.5};function bx(l){if(l&&typeof l=="object"){const n=l.toString();return n==="[object CanvasPattern]"||n==="[object CanvasGradient]"}return!1}function x2(l){return bx(l)?l:new am(l)}function b1(l){return bx(l)?l:new am(l).saturate(.5).darken(.1).hexString()}const W3=["x","y","borderWidth","radius","tension"],$3=["color","borderColor","backgroundColor"];function q3(l){l.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),l.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:n=>n!=="onProgress"&&n!=="onComplete"&&n!=="fn"}),l.set("animations",{colors:{type:"color",properties:$3},numbers:{type:"number",properties:W3}}),l.describe("animations",{_fallback:"animation"}),l.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:n=>n|0}}}})}function Y3(l){l.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const b2=new Map;function G3(l,n){n=n||{};const a=l+JSON.stringify(n);let o=b2.get(a);return o||(o=new Intl.NumberFormat(l,n),b2.set(a,o)),o}function Fp(l,n,a){return G3(n,a).format(l)}const K3={values(l){return ja(l)?l:""+l},numeric(l,n,a){if(l===0)return"0";const o=this.chart.options.locale;let s,e=l;if(a.length>1){const N=Math.max(Math.abs(a[0].value),Math.abs(a[a.length-1].value));(N<1e-4||N>1e15)&&(s="scientific"),e=Q3(l,a)}const m=_y(Math.abs(e)),v=isNaN(m)?1:Math.max(Math.min(-1*Math.floor(m),20),0),w={notation:s,minimumFractionDigits:v,maximumFractionDigits:v};return Object.assign(w,this.options.ticks.format),Fp(l,o,w)}};function Q3(l,n){let a=n.length>3?n[2].value-n[1].value:n[1].value-n[0].value;return Math.abs(a)>=1&&l!==Math.floor(l)&&(a=l-Math.floor(l)),a}var By={formatters:K3};function X3(l){l.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(n,a)=>a.lineWidth,tickColor:(n,a)=>a.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:By.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),l.route("scale.ticks","color","","color"),l.route("scale.grid","color","","borderColor"),l.route("scale.border","color","","borderColor"),l.route("scale.title","color","","color"),l.describe("scale",{_fallback:!1,_scriptable:n=>!n.startsWith("before")&&!n.startsWith("after")&&n!=="callback"&&n!=="parser",_indexable:n=>n!=="borderDash"&&n!=="tickBorderDash"&&n!=="dash"}),l.describe("scales",{_fallback:"scale"}),l.describe("scale.ticks",{_scriptable:n=>n!=="backdropPadding"&&n!=="callback",_indexable:n=>n!=="backdropPadding"})}const s0=Object.create(null),G1=Object.create(null);function sm(l,n){if(!n)return l;const a=n.split(".");for(let o=0,s=a.length;o<s;++o){const e=a[o];l=l[e]||(l[e]=Object.create(null))}return l}function y1(l,n,a){return typeof n=="string"?nm(sm(l,n),a):nm(sm(l,""),n)}class J3{constructor(n,a){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,s)=>b1(s.backgroundColor),this.hoverBorderColor=(o,s)=>b1(s.borderColor),this.hoverColor=(o,s)=>b1(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(n),this.apply(a)}set(n,a){return y1(this,n,a)}get(n){return sm(this,n)}describe(n,a){return y1(G1,n,a)}override(n,a){return y1(s0,n,a)}route(n,a,o,s){const e=sm(this,n),m=sm(this,o),v="_"+a;Object.defineProperties(e,{[v]:{value:e[a],writable:!0},[a]:{enumerable:!0,get(){const w=this[v],N=m[s];return Xs(w)?Object.assign({},N,w):Ms(w,N)},set(w){this[v]=w}}})}apply(n){n.forEach(a=>a(this))}}var ma=new J3({_scriptable:l=>!l.startsWith("on"),_indexable:l=>l!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[q3,Y3,X3]);function Z3(l){return!l||dr(l.size)||dr(l.family)?null:(l.style?l.style+" ":"")+(l.weight?l.weight+" ":"")+l.size+"px "+l.family}function y2(l,n,a,o,s){let e=n[s];return e||(e=n[s]=l.measureText(s).width,a.push(s)),e>o&&(o=e),o}function Yd(l,n,a){const o=l.currentDevicePixelRatio,s=a!==0?Math.max(a/2,.5):0;return Math.round((n-s)*o)/o+s}function v2(l,n){!n&&!l||(n=n||l.getContext("2d"),n.save(),n.resetTransform(),n.clearRect(0,0,l.width,l.height),n.restore())}function K1(l,n,a,o){zy(l,n,a,o,null)}function zy(l,n,a,o,s){let e,m,v,w,N,S,D,L;const M=n.pointStyle,F=n.rotation,O=n.radius;let P=(F||0)*_3;if(M&&typeof M=="object"&&(e=M.toString(),e==="[object HTMLImageElement]"||e==="[object HTMLCanvasElement]")){l.save(),l.translate(a,o),l.rotate(P),l.drawImage(M,-M.width/2,-M.height/2,M.width,M.height),l.restore();return}if(!(isNaN(O)||O<=0)){switch(l.beginPath(),M){default:s?l.ellipse(a,o,s/2,O,0,0,ea):l.arc(a,o,O,0,ea),l.closePath();break;case"triangle":S=s?s/2:O,l.moveTo(a+Math.sin(P)*S,o-Math.cos(P)*O),P+=u2,l.lineTo(a+Math.sin(P)*S,o-Math.cos(P)*O),P+=u2,l.lineTo(a+Math.sin(P)*S,o-Math.cos(P)*O),l.closePath();break;case"rectRounded":N=O*.516,w=O-N,m=Math.cos(P+qd)*w,D=Math.cos(P+qd)*(s?s/2-N:w),v=Math.sin(P+qd)*w,L=Math.sin(P+qd)*(s?s/2-N:w),l.arc(a-D,o-v,N,P-pr,P-Ea),l.arc(a+L,o-m,N,P-Ea,P),l.arc(a+D,o+v,N,P,P+Ea),l.arc(a-L,o+m,N,P+Ea,P+pr),l.closePath();break;case"rect":if(!F){w=Math.SQRT1_2*O,S=s?s/2:w,l.rect(a-S,o-w,2*S,2*w);break}P+=qd;case"rectRot":D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+L,o-m),l.lineTo(a+D,o+v),l.lineTo(a-L,o+m),l.closePath();break;case"crossRot":P+=qd;case"cross":D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+D,o+v),l.moveTo(a+L,o-m),l.lineTo(a-L,o+m);break;case"star":D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+D,o+v),l.moveTo(a+L,o-m),l.lineTo(a-L,o+m),P+=qd,D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+D,o+v),l.moveTo(a+L,o-m),l.lineTo(a-L,o+m);break;case"line":m=s?s/2:Math.cos(P)*O,v=Math.sin(P)*O,l.moveTo(a-m,o-v),l.lineTo(a+m,o+v);break;case"dash":l.moveTo(a,o),l.lineTo(a+Math.cos(P)*(s?s/2:O),o+Math.sin(P)*O);break;case!1:l.closePath();break}l.fill(),n.borderWidth>0&&l.stroke()}}function om(l,n,a){return a=a||.5,!n||l&&l.x>n.left-a&&l.x<n.right+a&&l.y>n.top-a&&l.y<n.bottom+a}function Mp(l,n){l.save(),l.beginPath(),l.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),l.clip()}function Lp(l){l.restore()}function ej(l,n,a,o,s){if(!n)return l.lineTo(a.x,a.y);if(s==="middle"){const e=(n.x+a.x)/2;l.lineTo(e,n.y),l.lineTo(e,a.y)}else s==="after"!=!!o?l.lineTo(n.x,a.y):l.lineTo(a.x,n.y);l.lineTo(a.x,a.y)}function tj(l,n,a,o){if(!n)return l.lineTo(a.x,a.y);l.bezierCurveTo(o?n.cp1x:n.cp2x,o?n.cp1y:n.cp2y,o?a.cp2x:a.cp1x,o?a.cp2y:a.cp1y,a.x,a.y)}function sj(l,n){n.translation&&l.translate(n.translation[0],n.translation[1]),dr(n.rotation)||l.rotate(n.rotation),n.color&&(l.fillStyle=n.color),n.textAlign&&(l.textAlign=n.textAlign),n.textBaseline&&(l.textBaseline=n.textBaseline)}function rj(l,n,a,o,s){if(s.strikethrough||s.underline){const e=l.measureText(o),m=n-e.actualBoundingBoxLeft,v=n+e.actualBoundingBoxRight,w=a-e.actualBoundingBoxAscent,N=a+e.actualBoundingBoxDescent,S=s.strikethrough?(w+N)/2:N;l.strokeStyle=l.fillStyle,l.beginPath(),l.lineWidth=s.decorationWidth||2,l.moveTo(m,S),l.lineTo(v,S),l.stroke()}}function aj(l,n){const a=l.fillStyle;l.fillStyle=n.color,l.fillRect(n.left,n.top,n.width,n.height),l.fillStyle=a}function cm(l,n,a,o,s,e={}){const m=ja(n)?n:[n],v=e.strokeWidth>0&&e.strokeColor!=="";let w,N;for(l.save(),l.font=s.string,sj(l,e),w=0;w<m.length;++w)N=m[w],e.backdrop&&aj(l,e.backdrop),v&&(e.strokeColor&&(l.strokeStyle=e.strokeColor),dr(e.strokeWidth)||(l.lineWidth=e.strokeWidth),l.strokeText(N,a,o,e.maxWidth)),l.fillText(N,a,o,e.maxWidth),rj(l,a,o,N,e),o+=Number(s.lineHeight);l.restore()}function wp(l,n){const{x:a,y:o,w:s,h:e,radius:m}=n;l.arc(a+m.topLeft,o+m.topLeft,m.topLeft,1.5*pr,pr,!0),l.lineTo(a,o+e-m.bottomLeft),l.arc(a+m.bottomLeft,o+e-m.bottomLeft,m.bottomLeft,pr,Ea,!0),l.lineTo(a+s-m.bottomRight,o+e),l.arc(a+s-m.bottomRight,o+e-m.bottomRight,m.bottomRight,Ea,0,!0),l.lineTo(a+s,o+m.topRight),l.arc(a+s-m.topRight,o+m.topRight,m.topRight,0,-Ea,!0),l.lineTo(a+m.topLeft,o)}const nj=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,ij=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function lj(l,n){const a=(""+l).match(nj);if(!a||a[1]==="normal")return n*1.2;switch(l=+a[2],a[3]){case"px":return l;case"%":l/=100;break}return n*l}const oj=l=>+l||0;function yx(l,n){const a={},o=Xs(n),s=o?Object.keys(n):n,e=Xs(l)?o?m=>Ms(l[m],l[n[m]]):m=>l[m]:()=>l;for(const m of s)a[m]=oj(e(m));return a}function Uy(l){return yx(l,{top:"y",right:"x",bottom:"y",left:"x"})}function qu(l){return yx(l,["topLeft","topRight","bottomLeft","bottomRight"])}function Di(l){const n=Uy(l);return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function rn(l,n){l=l||{},n=n||ma.font;let a=Ms(l.size,n.size);typeof a=="string"&&(a=parseInt(a,10));let o=Ms(l.style,n.style);o&&!(""+o).match(ij)&&(console.warn('Invalid font style specified: "'+o+'"'),o=void 0);const s={family:Ms(l.family,n.family),lineHeight:lj(Ms(l.lineHeight,n.lineHeight),a),size:a,style:o,weight:Ms(l.weight,n.weight),string:""};return s.string=Z3(s),s}function Yg(l,n,a,o){let s,e,m;for(s=0,e=l.length;s<e;++s)if(m=l[s],m!==void 0&&m!==void 0)return m}function cj(l,n,a){const{min:o,max:s}=l,e=Dy(n,(s-o)/2),m=(v,w)=>a&&v===0?0:v+w;return{min:m(o,-Math.abs(e)),max:m(s,e)}}function i0(l,n){return Object.assign(Object.create(l),n)}function vx(l,n=[""],a,o,s=()=>l[0]){const e=a||l;typeof o>"u"&&(o=$y("_fallback",l));const m={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:l,_rootScopes:e,_fallback:o,_getTarget:s,override:v=>vx([v,...l],n,e,o)};return new Proxy(m,{deleteProperty(v,w){return delete v[w],delete v._keys,delete l[0][w],!0},get(v,w){return Vy(v,w,()=>xj(w,n,l,v))},getOwnPropertyDescriptor(v,w){return Reflect.getOwnPropertyDescriptor(v._scopes[0],w)},getPrototypeOf(){return Reflect.getPrototypeOf(l[0])},has(v,w){return j2(v).includes(w)},ownKeys(v){return j2(v)},set(v,w,N){const S=v._storage||(v._storage=s());return v[w]=S[w]=N,delete v._keys,!0}})}function Qu(l,n,a,o){const s={_cacheable:!1,_proxy:l,_context:n,_subProxy:a,_stack:new Set,_descriptors:Hy(l,o),setContext:e=>Qu(l,e,a,o),override:e=>Qu(l.override(e),n,a,o)};return new Proxy(s,{deleteProperty(e,m){return delete e[m],delete l[m],!0},get(e,m,v){return Vy(e,m,()=>uj(e,m,v))},getOwnPropertyDescriptor(e,m){return e._descriptors.allKeys?Reflect.has(l,m)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(l,m)},getPrototypeOf(){return Reflect.getPrototypeOf(l)},has(e,m){return Reflect.has(l,m)},ownKeys(){return Reflect.ownKeys(l)},set(e,m,v){return l[m]=v,delete e[m],!0}})}function Hy(l,n={scriptable:!0,indexable:!0}){const{_scriptable:a=n.scriptable,_indexable:o=n.indexable,_allKeys:s=n.allKeys}=l;return{allKeys:s,scriptable:a,indexable:o,isScriptable:Pc(a)?a:()=>a,isIndexable:Pc(o)?o:()=>o}}const dj=(l,n)=>l?l+gx(n):n,wx=(l,n)=>Xs(n)&&l!=="adapters"&&(Object.getPrototypeOf(n)===null||n.constructor===Object);function Vy(l,n,a){if(Object.prototype.hasOwnProperty.call(l,n)||n==="constructor")return l[n];const o=a();return l[n]=o,o}function uj(l,n,a){const{_proxy:o,_context:s,_subProxy:e,_descriptors:m}=l;let v=o[n];return Pc(v)&&m.isScriptable(n)&&(v=hj(n,v,l,a)),ja(v)&&v.length&&(v=fj(n,v,l,m.isIndexable)),wx(n,v)&&(v=Qu(v,s,e&&e[n],m)),v}function hj(l,n,a,o){const{_proxy:s,_context:e,_subProxy:m,_stack:v}=a;if(v.has(l))throw new Error("Recursion detected: "+Array.from(v).join("->")+"->"+l);v.add(l);let w=n(e,m||o);return v.delete(l),wx(l,w)&&(w=jx(s._scopes,s,l,w)),w}function fj(l,n,a,o){const{_proxy:s,_context:e,_subProxy:m,_descriptors:v}=a;if(typeof e.index<"u"&&o(l))return n[e.index%n.length];if(Xs(n[0])){const w=n,N=s._scopes.filter(S=>S!==w);n=[];for(const S of w){const D=jx(N,s,l,S);n.push(Qu(D,e,m&&m[l],v))}}return n}function Wy(l,n,a){return Pc(l)?l(n,a):l}const mj=(l,n)=>l===!0?n:typeof l=="string"?Oc(n,l):void 0;function gj(l,n,a,o,s){for(const e of n){const m=mj(a,e);if(m){l.add(m);const v=Wy(m._fallback,a,s);if(typeof v<"u"&&v!==a&&v!==o)return v}else if(m===!1&&typeof o<"u"&&a!==o)return null}return!1}function jx(l,n,a,o){const s=n._rootScopes,e=Wy(n._fallback,a,o),m=[...l,...s],v=new Set;v.add(o);let w=w2(v,m,a,e||a,o);return w===null||typeof e<"u"&&e!==a&&(w=w2(v,m,e,w,o),w===null)?!1:vx(Array.from(v),[""],s,e,()=>pj(n,a,o))}function w2(l,n,a,o,s){for(;a;)a=gj(l,n,a,o,s);return a}function pj(l,n,a){const o=l._getTarget();n in o||(o[n]={});const s=o[n];return ja(s)&&Xs(a)?a:s||{}}function xj(l,n,a,o){let s;for(const e of n)if(s=$y(dj(e,l),a),typeof s<"u")return wx(l,s)?jx(a,o,l,s):s}function $y(l,n){for(const a of n){if(!a)continue;const o=a[l];if(typeof o<"u")return o}}function j2(l){let n=l._keys;return n||(n=l._keys=bj(l._scopes)),n}function bj(l){const n=new Set;for(const a of l)for(const o of Object.keys(a).filter(s=>!s.startsWith("_")))n.add(o);return Array.from(n)}function qy(l,n,a,o){const{iScale:s}=l,{key:e="r"}=this._parsing,m=new Array(o);let v,w,N,S;for(v=0,w=o;v<w;++v)N=v+a,S=n[N],m[v]={r:s.parse(Oc(S,e),N)};return m}const yj=Number.EPSILON||1e-14,Xu=(l,n)=>n<l.length&&!l[n].skip&&l[n],Yy=l=>l==="x"?"y":"x";function vj(l,n,a,o){const s=l.skip?n:l,e=n,m=a.skip?n:a,v=Y1(e,s),w=Y1(m,e);let N=v/(v+w),S=w/(v+w);N=isNaN(N)?0:N,S=isNaN(S)?0:S;const D=o*N,L=o*S;return{previous:{x:e.x-D*(m.x-s.x),y:e.y-D*(m.y-s.y)},next:{x:e.x+L*(m.x-s.x),y:e.y+L*(m.y-s.y)}}}function wj(l,n,a){const o=l.length;let s,e,m,v,w,N=Xu(l,0);for(let S=0;S<o-1;++S)if(w=N,N=Xu(l,S+1),!(!w||!N)){if(em(n[S],0,yj)){a[S]=a[S+1]=0;continue}s=a[S]/n[S],e=a[S+1]/n[S],v=Math.pow(s,2)+Math.pow(e,2),!(v<=9)&&(m=3/Math.sqrt(v),a[S]=s*m*n[S],a[S+1]=e*m*n[S])}}function jj(l,n,a="x"){const o=Yy(a),s=l.length;let e,m,v,w=Xu(l,0);for(let N=0;N<s;++N){if(m=v,v=w,w=Xu(l,N+1),!v)continue;const S=v[a],D=v[o];m&&(e=(S-m[a])/3,v[`cp1${a}`]=S-e,v[`cp1${o}`]=D-e*n[N]),w&&(e=(w[a]-S)/3,v[`cp2${a}`]=S+e,v[`cp2${o}`]=D+e*n[N])}}function Nj(l,n="x"){const a=Yy(n),o=l.length,s=Array(o).fill(0),e=Array(o);let m,v,w,N=Xu(l,0);for(m=0;m<o;++m)if(v=w,w=N,N=Xu(l,m+1),!!w){if(N){const S=N[n]-w[n];s[m]=S!==0?(N[a]-w[a])/S:0}e[m]=v?N?Vl(s[m-1])!==Vl(s[m])?0:(s[m-1]+s[m])/2:s[m-1]:s[m]}wj(l,s,e),jj(l,e,n)}function Gg(l,n,a){return Math.max(Math.min(l,a),n)}function kj(l,n){let a,o,s,e,m,v=om(l[0],n);for(a=0,o=l.length;a<o;++a)m=e,e=v,v=a<o-1&&om(l[a+1],n),e&&(s=l[a],m&&(s.cp1x=Gg(s.cp1x,n.left,n.right),s.cp1y=Gg(s.cp1y,n.top,n.bottom)),v&&(s.cp2x=Gg(s.cp2x,n.left,n.right),s.cp2y=Gg(s.cp2y,n.top,n.bottom)))}function Cj(l,n,a,o,s){let e,m,v,w;if(n.spanGaps&&(l=l.filter(N=>!N.skip)),n.cubicInterpolationMode==="monotone")Nj(l,s);else{let N=o?l[l.length-1]:l[0];for(e=0,m=l.length;e<m;++e)v=l[e],w=vj(N,v,l[Math.min(e+1,m-(o?0:1))%m],n.tension),v.cp1x=w.previous.x,v.cp1y=w.previous.y,v.cp2x=w.next.x,v.cp2y=w.next.y,N=v}n.capBezierPoints&&kj(l,a)}function Nx(){return typeof window<"u"&&typeof document<"u"}function kx(l){let n=l.parentNode;return n&&n.toString()==="[object ShadowRoot]"&&(n=n.host),n}function jp(l,n,a){let o;return typeof l=="string"?(o=parseInt(l,10),l.indexOf("%")!==-1&&(o=o/100*n.parentNode[a])):o=l,o}const Rp=l=>l.ownerDocument.defaultView.getComputedStyle(l,null);function Sj(l,n){return Rp(l).getPropertyValue(n)}const Aj=["top","right","bottom","left"];function e0(l,n,a){const o={};a=a?"-"+a:"";for(let s=0;s<4;s++){const e=Aj[s];o[e]=parseFloat(l[n+"-"+e+a])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const Ej=(l,n,a)=>(l>0||n>0)&&(!a||!a.shadowRoot);function Dj(l,n){const a=l.touches,o=a&&a.length?a[0]:l,{offsetX:s,offsetY:e}=o;let m=!1,v,w;if(Ej(s,e,l.target))v=s,w=e;else{const N=n.getBoundingClientRect();v=o.clientX-N.left,w=o.clientY-N.top,m=!0}return{x:v,y:w,box:m}}function Kd(l,n){if("native"in l)return l;const{canvas:a,currentDevicePixelRatio:o}=n,s=Rp(a),e=s.boxSizing==="border-box",m=e0(s,"padding"),v=e0(s,"border","width"),{x:w,y:N,box:S}=Dj(l,a),D=m.left+(S&&v.left),L=m.top+(S&&v.top);let{width:M,height:F}=n;return e&&(M-=m.width+v.width,F-=m.height+v.height),{x:Math.round((w-D)/M*a.width/o),y:Math.round((N-L)/F*a.height/o)}}function Tj(l,n,a){let o,s;if(n===void 0||a===void 0){const e=l&&kx(l);if(!e)n=l.clientWidth,a=l.clientHeight;else{const m=e.getBoundingClientRect(),v=Rp(e),w=e0(v,"border","width"),N=e0(v,"padding");n=m.width-N.width-w.width,a=m.height-N.height-w.height,o=jp(v.maxWidth,e,"clientWidth"),s=jp(v.maxHeight,e,"clientHeight")}}return{width:n,height:a,maxWidth:o||vp,maxHeight:s||vp}}const Mc=l=>Math.round(l*10)/10;function _j(l,n,a,o){const s=Rp(l),e=e0(s,"margin"),m=jp(s.maxWidth,l,"clientWidth")||vp,v=jp(s.maxHeight,l,"clientHeight")||vp,w=Tj(l,n,a);let{width:N,height:S}=w;if(s.boxSizing==="content-box"){const L=e0(s,"border","width"),M=e0(s,"padding");N-=M.width+L.width,S-=M.height+L.height}return N=Math.max(0,N-e.width),S=Math.max(0,o?N/o:S-e.height),N=Mc(Math.min(N,m,w.maxWidth)),S=Mc(Math.min(S,v,w.maxHeight)),N&&!S&&(S=Mc(N/2)),(n!==void 0||a!==void 0)&&o&&w.height&&S>w.height&&(S=w.height,N=Mc(Math.floor(S*o))),{width:N,height:S}}function N2(l,n,a){const o=n||1,s=Mc(l.height*o),e=Mc(l.width*o);l.height=Mc(l.height),l.width=Mc(l.width);const m=l.canvas;return m.style&&(a||!m.style.height&&!m.style.width)&&(m.style.height=`${l.height}px`,m.style.width=`${l.width}px`),l.currentDevicePixelRatio!==o||m.height!==s||m.width!==e?(l.currentDevicePixelRatio=o,m.height=s,m.width=e,l.ctx.setTransform(o,0,0,o,0,0),!0):!1}const Fj=(function(){let l=!1;try{const n={get passive(){return l=!0,!1}};Nx()&&(window.addEventListener("test",null,n),window.removeEventListener("test",null,n))}catch{}return l})();function k2(l,n){const a=Sj(l,n),o=a&&a.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:void 0}function Qd(l,n,a,o){return{x:l.x+a*(n.x-l.x),y:l.y+a*(n.y-l.y)}}function Mj(l,n,a,o){return{x:l.x+a*(n.x-l.x),y:o==="middle"?a<.5?l.y:n.y:o==="after"?a<1?l.y:n.y:a>0?n.y:l.y}}function Lj(l,n,a,o){const s={x:l.cp2x,y:l.cp2y},e={x:n.cp1x,y:n.cp1y},m=Qd(l,s,a),v=Qd(s,e,a),w=Qd(e,n,a),N=Qd(m,v,a),S=Qd(v,w,a);return Qd(N,S,a)}const Rj=function(l,n){return{x(a){return l+l+n-a},setWidth(a){n=a},textAlign(a){return a==="center"?a:a==="right"?"left":"right"},xPlus(a,o){return a-o},leftForLtr(a,o){return a-o}}},Oj=function(){return{x(l){return l},setWidth(l){},textAlign(l){return l},xPlus(l,n){return l+n},leftForLtr(l,n){return l}}};function Yu(l,n,a){return l?Rj(n,a):Oj()}function Gy(l,n){let a,o;(n==="ltr"||n==="rtl")&&(a=l.canvas.style,o=[a.getPropertyValue("direction"),a.getPropertyPriority("direction")],a.setProperty("direction",n,"important"),l.prevTextDirection=o)}function Ky(l,n){n!==void 0&&(delete l.prevTextDirection,l.canvas.style.setProperty("direction",n[0],n[1]))}function Qy(l){return l==="angle"?{between:lm,compare:P3,normalize:ii}:{between:Ro,compare:(n,a)=>n-a,normalize:n=>n}}function C2({start:l,end:n,count:a,loop:o,style:s}){return{start:l%a,end:n%a,loop:o&&(n-l+1)%a===0,style:s}}function Pj(l,n,a){const{property:o,start:s,end:e}=a,{between:m,normalize:v}=Qy(o),w=n.length;let{start:N,end:S,loop:D}=l,L,M;if(D){for(N+=w,S+=w,L=0,M=w;L<M&&m(v(n[N%w][o]),s,e);++L)N--,S--;N%=w,S%=w}return S<N&&(S+=w),{start:N,end:S,loop:D,style:l.style}}function Xy(l,n,a){if(!a)return[l];const{property:o,start:s,end:e}=a,m=n.length,{compare:v,between:w,normalize:N}=Qy(o),{start:S,end:D,loop:L,style:M}=Pj(l,n,a),F=[];let O=!1,P=null,G,ae,re;const Ne=()=>w(s,re,G)&&v(s,re)!==0,xe=()=>v(e,G)===0||w(e,re,G),we=()=>O||Ne(),Z=()=>!O||xe();for(let ce=S,ue=S;ce<=D;++ce)ae=n[ce%m],!ae.skip&&(G=N(ae[o]),G!==re&&(O=w(G,s,e),P===null&&we()&&(P=v(G,s)===0?ce:ue),P!==null&&Z()&&(F.push(C2({start:P,end:ce,loop:L,count:m,style:M})),P=null),ue=ce,re=G));return P!==null&&F.push(C2({start:P,end:D,loop:L,count:m,style:M})),F}function Jy(l,n){const a=[],o=l.segments;for(let s=0;s<o.length;s++){const e=Xy(o[s],l.points,n);e.length&&a.push(...e)}return a}function Ij(l,n,a,o){let s=0,e=n-1;if(a&&!o)for(;s<n&&!l[s].skip;)s++;for(;s<n&&l[s].skip;)s++;for(s%=n,a&&(e+=s);e>s&&l[e%n].skip;)e--;return e%=n,{start:s,end:e}}function Bj(l,n,a,o){const s=l.length,e=[];let m=n,v=l[n],w;for(w=n+1;w<=a;++w){const N=l[w%s];N.skip||N.stop?v.skip||(o=!1,e.push({start:n%s,end:(w-1)%s,loop:o}),n=m=N.stop?w:null):(m=w,v.skip&&(n=w)),v=N}return m!==null&&e.push({start:n%s,end:m%s,loop:o}),e}function zj(l,n){const a=l.points,o=l.options.spanGaps,s=a.length;if(!s)return[];const e=!!l._loop,{start:m,end:v}=Ij(a,s,e,o);if(o===!0)return S2(l,[{start:m,end:v,loop:e}],a,n);const w=v<m?v+s:v,N=!!l._fullLoop&&m===0&&v===s-1;return S2(l,Bj(a,m,w,N),a,n)}function S2(l,n,a,o){return!o||!o.setContext||!a?n:Uj(l,n,a,o)}function Uj(l,n,a,o){const s=l._chart.getContext(),e=A2(l.options),{_datasetIndex:m,options:{spanGaps:v}}=l,w=a.length,N=[];let S=e,D=n[0].start,L=D;function M(F,O,P,G){const ae=v?-1:1;if(F!==O){for(F+=w;a[F%w].skip;)F-=ae;for(;a[O%w].skip;)O+=ae;F%w!==O%w&&(N.push({start:F%w,end:O%w,loop:P,style:G}),S=G,D=O%w)}}for(const F of n){D=v?D:F.start;let O=a[D%w],P;for(L=D+1;L<=F.end;L++){const G=a[L%w];P=A2(o.setContext(i0(s,{type:"segment",p0:O,p1:G,p0DataIndex:(L-1)%w,p1DataIndex:L%w,datasetIndex:m}))),Hj(P,S)&&M(D,L-1,F.loop,S),O=G,S=P}D<L-1&&M(D,L-1,F.loop,S)}return N}function A2(l){return{backgroundColor:l.backgroundColor,borderCapStyle:l.borderCapStyle,borderDash:l.borderDash,borderDashOffset:l.borderDashOffset,borderJoinStyle:l.borderJoinStyle,borderWidth:l.borderWidth,borderColor:l.borderColor}}function Hj(l,n){if(!n)return!1;const a=[],o=function(s,e){return bx(e)?(a.includes(e)||a.push(e),a.indexOf(e)):e};return JSON.stringify(l,o)!==JSON.stringify(n,o)}function Kg(l,n,a){return l.options.clip?l[a]:n[a]}function Vj(l,n){const{xScale:a,yScale:o}=l;return a&&o?{left:Kg(a,n,"left"),right:Kg(a,n,"right"),top:Kg(o,n,"top"),bottom:Kg(o,n,"bottom")}:n}function Zy(l,n){const a=n._clip;if(a.disabled)return!1;const o=Vj(n,l.chartArea);return{left:a.left===!1?0:o.left-(a.left===!0?0:a.left),right:a.right===!1?l.width:o.right+(a.right===!0?0:a.right),top:a.top===!1?0:o.top-(a.top===!0?0:a.top),bottom:a.bottom===!1?l.height:o.bottom+(a.bottom===!0?0:a.bottom)}}class Wj{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(n,a,o,s){const e=a.listeners[s],m=a.duration;e.forEach(v=>v({chart:n,initial:a.initial,numSteps:m,currentStep:Math.min(o-a.start,m)}))}_refresh(){this._request||(this._running=!0,this._request=Ry.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(n=Date.now()){let a=0;this._charts.forEach((o,s)=>{if(!o.running||!o.items.length)return;const e=o.items;let m=e.length-1,v=!1,w;for(;m>=0;--m)w=e[m],w._active?(w._total>o.duration&&(o.duration=w._total),w.tick(n),v=!0):(e[m]=e[e.length-1],e.pop());v&&(s.draw(),this._notify(s,o,n,"progress")),e.length||(o.running=!1,this._notify(s,o,n,"complete"),o.initial=!1),a+=e.length}),this._lastDate=n,a===0&&(this._running=!1)}_getAnims(n){const a=this._charts;let o=a.get(n);return o||(o={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},a.set(n,o)),o}listen(n,a,o){this._getAnims(n).listeners[a].push(o)}add(n,a){!a||!a.length||this._getAnims(n).items.push(...a)}has(n){return this._getAnims(n).items.length>0}start(n){const a=this._charts.get(n);a&&(a.running=!0,a.start=Date.now(),a.duration=a.items.reduce((o,s)=>Math.max(o,s._duration),0),this._refresh())}running(n){if(!this._running)return!1;const a=this._charts.get(n);return!(!a||!a.running||!a.items.length)}stop(n){const a=this._charts.get(n);if(!a||!a.items.length)return;const o=a.items;let s=o.length-1;for(;s>=0;--s)o[s].cancel();a.items=[],this._notify(n,a,Date.now(),"complete")}remove(n){return this._charts.delete(n)}}var _o=new Wj;const E2="transparent",$j={boolean(l,n,a){return a>.5?n:l},color(l,n,a){const o=x2(l||E2),s=o.valid&&x2(n||E2);return s&&s.valid?s.mix(o,a).hexString():n},number(l,n,a){return l+(n-l)*a}};class qj{constructor(n,a,o,s){const e=a[o];s=Yg([n.to,s,e,n.from]);const m=Yg([n.from,e,s]);this._active=!0,this._fn=n.fn||$j[n.type||typeof m],this._easing=tm[n.easing]||tm.linear,this._start=Math.floor(Date.now()+(n.delay||0)),this._duration=this._total=Math.floor(n.duration),this._loop=!!n.loop,this._target=a,this._prop=o,this._from=m,this._to=s,this._promises=void 0}active(){return this._active}update(n,a,o){if(this._active){this._notify(!1);const s=this._target[this._prop],e=o-this._start,m=this._duration-e;this._start=o,this._duration=Math.floor(Math.max(m,n.duration)),this._total+=e,this._loop=!!n.loop,this._to=Yg([n.to,a,s,n.from]),this._from=Yg([n.from,s,a])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(n){const a=n-this._start,o=this._duration,s=this._prop,e=this._from,m=this._loop,v=this._to;let w;if(this._active=e!==v&&(m||a<o),!this._active){this._target[s]=v,this._notify(!0);return}if(a<0){this._target[s]=e;return}w=a/o%2,w=m&&w>1?2-w:w,w=this._easing(Math.min(1,Math.max(0,w))),this._target[s]=this._fn(e,v,w)}wait(){const n=this._promises||(this._promises=[]);return new Promise((a,o)=>{n.push({res:a,rej:o})})}_notify(n){const a=n?"res":"rej",o=this._promises||[];for(let s=0;s<o.length;s++)o[s][a]()}}class ev{constructor(n,a){this._chart=n,this._properties=new Map,this.configure(a)}configure(n){if(!Xs(n))return;const a=Object.keys(ma.animation),o=this._properties;Object.getOwnPropertyNames(n).forEach(s=>{const e=n[s];if(!Xs(e))return;const m={};for(const v of a)m[v]=e[v];(ja(e.properties)&&e.properties||[s]).forEach(v=>{(v===s||!o.has(v))&&o.set(v,m)})})}_animateOptions(n,a){const o=a.options,s=Gj(n,o);if(!s)return[];const e=this._createAnimations(s,o);return o.$shared&&Yj(n.options.$animations,o).then(()=>{n.options=o},()=>{}),e}_createAnimations(n,a){const o=this._properties,s=[],e=n.$animations||(n.$animations={}),m=Object.keys(a),v=Date.now();let w;for(w=m.length-1;w>=0;--w){const N=m[w];if(N.charAt(0)==="$")continue;if(N==="options"){s.push(...this._animateOptions(n,a));continue}const S=a[N];let D=e[N];const L=o.get(N);if(D)if(L&&D.active()){D.update(L,S,v);continue}else D.cancel();if(!L||!L.duration){n[N]=S;continue}e[N]=D=new qj(L,n,N,S),s.push(D)}return s}update(n,a){if(this._properties.size===0){Object.assign(n,a);return}const o=this._createAnimations(n,a);if(o.length)return _o.add(this._chart,o),!0}}function Yj(l,n){const a=[],o=Object.keys(n);for(let s=0;s<o.length;s++){const e=l[o[s]];e&&e.active()&&a.push(e.wait())}return Promise.all(a)}function Gj(l,n){if(!n)return;let a=l.options;if(!a){l.options=n;return}return a.$shared&&(l.options=a=Object.assign({},a,{$shared:!1,$animations:{}})),a}function D2(l,n){const a=l&&l.options||{},o=a.reverse,s=a.min===void 0?n:0,e=a.max===void 0?n:0;return{start:o?e:s,end:o?s:e}}function Kj(l,n,a){if(a===!1)return!1;const o=D2(l,a),s=D2(n,a);return{top:s.end,right:o.end,bottom:s.start,left:o.start}}function Qj(l){let n,a,o,s;return Xs(l)?(n=l.top,a=l.right,o=l.bottom,s=l.left):n=a=o=s=l,{top:n,right:a,bottom:o,left:s,disabled:l===!1}}function tv(l,n){const a=[],o=l._getSortedDatasetMetas(n);let s,e;for(s=0,e=o.length;s<e;++s)a.push(o[s].index);return a}function T2(l,n,a,o={}){const s=l.keys,e=o.mode==="single";let m,v,w,N;if(n===null)return;let S=!1;for(m=0,v=s.length;m<v;++m){if(w=+s[m],w===a){if(S=!0,o.all)continue;break}N=l.values[w],an(N)&&(e||n===0||Vl(n)===Vl(N))&&(n+=N)}return!S&&!o.all?0:n}function Xj(l,n){const{iScale:a,vScale:o}=n,s=a.axis==="x"?"x":"y",e=o.axis==="x"?"x":"y",m=Object.keys(l),v=new Array(m.length);let w,N,S;for(w=0,N=m.length;w<N;++w)S=m[w],v[w]={[s]:S,[e]:l[S]};return v}function v1(l,n){const a=l&&l.options.stacked;return a||a===void 0&&n.stack!==void 0}function Jj(l,n,a){return`${l.id}.${n.id}.${a.stack||a.type}`}function Zj(l){const{min:n,max:a,minDefined:o,maxDefined:s}=l.getUserBounds();return{min:o?n:Number.NEGATIVE_INFINITY,max:s?a:Number.POSITIVE_INFINITY}}function e6(l,n,a){const o=l[n]||(l[n]={});return o[a]||(o[a]={})}function _2(l,n,a,o){for(const s of n.getMatchingVisibleMetas(o).reverse()){const e=l[s.index];if(a&&e>0||!a&&e<0)return s.index}return null}function F2(l,n){const{chart:a,_cachedMeta:o}=l,s=a._stacks||(a._stacks={}),{iScale:e,vScale:m,index:v}=o,w=e.axis,N=m.axis,S=Jj(e,m,o),D=n.length;let L;for(let M=0;M<D;++M){const F=n[M],{[w]:O,[N]:P}=F,G=F._stacks||(F._stacks={});L=G[N]=e6(s,S,O),L[v]=P,L._top=_2(L,m,!0,o.type),L._bottom=_2(L,m,!1,o.type);const ae=L._visualValues||(L._visualValues={});ae[v]=P}}function w1(l,n){const a=l.scales;return Object.keys(a).filter(o=>a[o].axis===n).shift()}function t6(l,n){return i0(l,{active:!1,dataset:void 0,datasetIndex:n,index:n,mode:"default",type:"dataset"})}function s6(l,n,a){return i0(l,{active:!1,dataIndex:n,parsed:void 0,raw:void 0,element:a,index:n,mode:"default",type:"data"})}function Vf(l,n){const a=l.controller.index,o=l.vScale&&l.vScale.axis;if(o){n=n||l._parsed;for(const s of n){const e=s._stacks;if(!e||e[o]===void 0||e[o][a]===void 0)return;delete e[o][a],e[o]._visualValues!==void 0&&e[o]._visualValues[a]!==void 0&&delete e[o]._visualValues[a]}}}const j1=l=>l==="reset"||l==="none",M2=(l,n)=>n?l:Object.assign({},l),r6=(l,n,a)=>l&&!n.hidden&&n._stacked&&{keys:tv(a,!0),values:null};class Ic{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(n,a){this.chart=n,this._ctx=n.ctx,this.index=a,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const n=this._cachedMeta;this.configure(),this.linkScales(),n._stacked=v1(n.vScale,n),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(n){this.index!==n&&Vf(this._cachedMeta),this.index=n}linkScales(){const n=this.chart,a=this._cachedMeta,o=this.getDataset(),s=(D,L,M,F)=>D==="x"?L:D==="r"?F:M,e=a.xAxisID=Ms(o.xAxisID,w1(n,"x")),m=a.yAxisID=Ms(o.yAxisID,w1(n,"y")),v=a.rAxisID=Ms(o.rAxisID,w1(n,"r")),w=a.indexAxis,N=a.iAxisID=s(w,e,m,v),S=a.vAxisID=s(w,m,e,v);a.xScale=this.getScaleForId(e),a.yScale=this.getScaleForId(m),a.rScale=this.getScaleForId(v),a.iScale=this.getScaleForId(N),a.vScale=this.getScaleForId(S)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(n){return this.chart.scales[n]}_getOtherScale(n){const a=this._cachedMeta;return n===a.iScale?a.vScale:a.iScale}reset(){this._update("reset")}_destroy(){const n=this._cachedMeta;this._data&&m2(this._data,this),n._stacked&&Vf(n)}_dataCheck(){const n=this.getDataset(),a=n.data||(n.data=[]),o=this._data;if(Xs(a)){const s=this._cachedMeta;this._data=Xj(a,s)}else if(o!==a){if(o){m2(o,this);const s=this._cachedMeta;Vf(s),s._parsed=[]}a&&Object.isExtensible(a)&&U3(a,this),this._syncList=[],this._data=a}}addElements(){const n=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(n.dataset=new this.datasetElementType)}buildOrUpdateElements(n){const a=this._cachedMeta,o=this.getDataset();let s=!1;this._dataCheck();const e=a._stacked;a._stacked=v1(a.vScale,a),a.stack!==o.stack&&(s=!0,Vf(a),a.stack=o.stack),this._resyncElements(n),(s||e!==a._stacked)&&(F2(this,a._parsed),a._stacked=v1(a.vScale,a))}configure(){const n=this.chart.config,a=n.datasetScopeKeys(this._type),o=n.getOptionScopes(this.getDataset(),a,!0);this.options=n.createResolver(o,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(n,a){const{_cachedMeta:o,_data:s}=this,{iScale:e,_stacked:m}=o,v=e.axis;let w=n===0&&a===s.length?!0:o._sorted,N=n>0&&o._parsed[n-1],S,D,L;if(this._parsing===!1)o._parsed=s,o._sorted=!0,L=s;else{ja(s[n])?L=this.parseArrayData(o,s,n,a):Xs(s[n])?L=this.parseObjectData(o,s,n,a):L=this.parsePrimitiveData(o,s,n,a);const M=()=>D[v]===null||N&&D[v]<N[v];for(S=0;S<a;++S)o._parsed[S+n]=D=L[S],w&&(M()&&(w=!1),N=D);o._sorted=w}m&&F2(this,L)}parsePrimitiveData(n,a,o,s){const{iScale:e,vScale:m}=n,v=e.axis,w=m.axis,N=e.getLabels(),S=e===m,D=new Array(s);let L,M,F;for(L=0,M=s;L<M;++L)F=L+o,D[L]={[v]:S||e.parse(N[F],F),[w]:m.parse(a[F],F)};return D}parseArrayData(n,a,o,s){const{xScale:e,yScale:m}=n,v=new Array(s);let w,N,S,D;for(w=0,N=s;w<N;++w)S=w+o,D=a[S],v[w]={x:e.parse(D[0],S),y:m.parse(D[1],S)};return v}parseObjectData(n,a,o,s){const{xScale:e,yScale:m}=n,{xAxisKey:v="x",yAxisKey:w="y"}=this._parsing,N=new Array(s);let S,D,L,M;for(S=0,D=s;S<D;++S)L=S+o,M=a[L],N[S]={x:e.parse(Oc(M,v),L),y:m.parse(Oc(M,w),L)};return N}getParsed(n){return this._cachedMeta._parsed[n]}getDataElement(n){return this._cachedMeta.data[n]}applyStack(n,a,o){const s=this.chart,e=this._cachedMeta,m=a[n.axis],v={keys:tv(s,!0),values:a._stacks[n.axis]._visualValues};return T2(v,m,e.index,{mode:o})}updateRangeFromParsed(n,a,o,s){const e=o[a.axis];let m=e===null?NaN:e;const v=s&&o._stacks[a.axis];s&&v&&(s.values=v,m=T2(s,e,this._cachedMeta.index)),n.min=Math.min(n.min,m),n.max=Math.max(n.max,m)}getMinMax(n,a){const o=this._cachedMeta,s=o._parsed,e=o._sorted&&n===o.iScale,m=s.length,v=this._getOtherScale(n),w=r6(a,o,this.chart),N={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:S,max:D}=Zj(v);let L,M;function F(){M=s[L];const O=M[v.axis];return!an(M[n.axis])||S>O||D<O}for(L=0;L<m&&!(!F()&&(this.updateRangeFromParsed(N,n,M,w),e));++L);if(e){for(L=m-1;L>=0;--L)if(!F()){this.updateRangeFromParsed(N,n,M,w);break}}return N}getAllParsedValues(n){const a=this._cachedMeta._parsed,o=[];let s,e,m;for(s=0,e=a.length;s<e;++s)m=a[s][n.axis],an(m)&&o.push(m);return o}getMaxOverflow(){return!1}getLabelAndValue(n){const a=this._cachedMeta,o=a.iScale,s=a.vScale,e=this.getParsed(n);return{label:o?""+o.getLabelForValue(e[o.axis]):"",value:s?""+s.getLabelForValue(e[s.axis]):""}}_update(n){const a=this._cachedMeta;this.update(n||"default"),a._clip=Qj(Ms(this.options.clip,Kj(a.xScale,a.yScale,this.getMaxOverflow())))}update(n){}draw(){const n=this._ctx,a=this.chart,o=this._cachedMeta,s=o.data||[],e=a.chartArea,m=[],v=this._drawStart||0,w=this._drawCount||s.length-v,N=this.options.drawActiveElementsOnTop;let S;for(o.dataset&&o.dataset.draw(n,e,v,w),S=v;S<v+w;++S){const D=s[S];D.hidden||(D.active&&N?m.push(D):D.draw(n,e))}for(S=0;S<m.length;++S)m[S].draw(n,e)}getStyle(n,a){const o=a?"active":"default";return n===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(o):this.resolveDataElementOptions(n||0,o)}getContext(n,a,o){const s=this.getDataset();let e;if(n>=0&&n<this._cachedMeta.data.length){const m=this._cachedMeta.data[n];e=m.$context||(m.$context=s6(this.getContext(),n,m)),e.parsed=this.getParsed(n),e.raw=s.data[n],e.index=e.dataIndex=n}else e=this.$context||(this.$context=t6(this.chart.getContext(),this.index)),e.dataset=s,e.index=e.datasetIndex=this.index;return e.active=!!a,e.mode=o,e}resolveDatasetElementOptions(n){return this._resolveElementOptions(this.datasetElementType.id,n)}resolveDataElementOptions(n,a){return this._resolveElementOptions(this.dataElementType.id,a,n)}_resolveElementOptions(n,a="default",o){const s=a==="active",e=this._cachedDataOpts,m=n+"-"+a,v=e[m],w=this.enableOptionSharing&&im(o);if(v)return M2(v,w);const N=this.chart.config,S=N.datasetElementScopeKeys(this._type,n),D=s?[`${n}Hover`,"hover",n,""]:[n,""],L=N.getOptionScopes(this.getDataset(),S),M=Object.keys(ma.elements[n]),F=()=>this.getContext(o,s,a),O=N.resolveNamedOptions(L,M,F,D);return O.$shared&&(O.$shared=w,e[m]=Object.freeze(M2(O,w))),O}_resolveAnimations(n,a,o){const s=this.chart,e=this._cachedDataOpts,m=`animation-${a}`,v=e[m];if(v)return v;let w;if(s.options.animation!==!1){const S=this.chart.config,D=S.datasetAnimationScopeKeys(this._type,a),L=S.getOptionScopes(this.getDataset(),D);w=S.createResolver(L,this.getContext(n,o,a))}const N=new ev(s,w&&w.animations);return w&&w._cacheable&&(e[m]=Object.freeze(N)),N}getSharedOptions(n){if(n.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},n))}includeOptions(n,a){return!a||j1(n)||this.chart._animationsDisabled}_getSharedOptions(n,a){const o=this.resolveDataElementOptions(n,a),s=this._sharedOptions,e=this.getSharedOptions(o),m=this.includeOptions(a,e)||e!==s;return this.updateSharedOptions(e,a,o),{sharedOptions:e,includeOptions:m}}updateElement(n,a,o,s){j1(s)?Object.assign(n,o):this._resolveAnimations(a,s).update(n,o)}updateSharedOptions(n,a,o){n&&!j1(a)&&this._resolveAnimations(void 0,a).update(n,o)}_setStyle(n,a,o,s){n.active=s;const e=this.getStyle(a,s);this._resolveAnimations(a,o,s).update(n,{options:!s&&this.getSharedOptions(e)||e})}removeHoverStyle(n,a,o){this._setStyle(n,o,"active",!1)}setHoverStyle(n,a,o){this._setStyle(n,o,"active",!0)}_removeDatasetHoverStyle(){const n=this._cachedMeta.dataset;n&&this._setStyle(n,void 0,"active",!1)}_setDatasetHoverStyle(){const n=this._cachedMeta.dataset;n&&this._setStyle(n,void 0,"active",!0)}_resyncElements(n){const a=this._data,o=this._cachedMeta.data;for(const[v,w,N]of this._syncList)this[v](w,N);this._syncList=[];const s=o.length,e=a.length,m=Math.min(e,s);m&&this.parse(0,m),e>s?this._insertElements(s,e-s,n):e<s&&this._removeElements(e,s-e)}_insertElements(n,a,o=!0){const s=this._cachedMeta,e=s.data,m=n+a;let v;const w=N=>{for(N.length+=a,v=N.length-1;v>=m;v--)N[v]=N[v-a]};for(w(e),v=n;v<m;++v)e[v]=new this.dataElementType;this._parsing&&w(s._parsed),this.parse(n,a),o&&this.updateElements(e,n,a,"reset")}updateElements(n,a,o,s){}_removeElements(n,a){const o=this._cachedMeta;if(this._parsing){const s=o._parsed.splice(n,a);o._stacked&&Vf(o,s)}o.data.splice(n,a)}_sync(n){if(this._parsing)this._syncList.push(n);else{const[a,o,s]=n;this[a](o,s)}this.chart._dataChanges.push([this.index,...n])}_onDataPush(){const n=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-n,n])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(n,a){a&&this._sync(["_removeElements",n,a]);const o=arguments.length-2;o&&this._sync(["_insertElements",n,o])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function a6(l,n){if(!l._cache.$bar){const a=l.getMatchingVisibleMetas(n);let o=[];for(let s=0,e=a.length;s<e;s++)o=o.concat(a[s].controller.getAllParsedValues(l));l._cache.$bar=Ly(o.sort((s,e)=>s-e))}return l._cache.$bar}function n6(l){const n=l.iScale,a=a6(n,l.type);let o=n._length,s,e,m,v;const w=()=>{m===32767||m===-32768||(im(v)&&(o=Math.min(o,Math.abs(m-v)||o)),v=m)};for(s=0,e=a.length;s<e;++s)m=n.getPixelForValue(a[s]),w();for(v=void 0,s=0,e=n.ticks.length;s<e;++s)m=n.getPixelForTick(s),w();return o}function i6(l,n,a,o){const s=a.barThickness;let e,m;return dr(s)?(e=n.min*a.categoryPercentage,m=a.barPercentage):(e=s*o,m=1),{chunk:e/o,ratio:m,start:n.pixels[l]-e/2}}function l6(l,n,a,o){const s=n.pixels,e=s[l];let m=l>0?s[l-1]:null,v=l<s.length-1?s[l+1]:null;const w=a.categoryPercentage;m===null&&(m=e-(v===null?n.end-n.start:v-e)),v===null&&(v=e+e-m);const N=e-(e-Math.min(m,v))/2*w;return{chunk:Math.abs(v-m)/2*w/o,ratio:a.barPercentage,start:N}}function o6(l,n,a,o){const s=a.parse(l[0],o),e=a.parse(l[1],o),m=Math.min(s,e),v=Math.max(s,e);let w=m,N=v;Math.abs(m)>Math.abs(v)&&(w=v,N=m),n[a.axis]=N,n._custom={barStart:w,barEnd:N,start:s,end:e,min:m,max:v}}function sv(l,n,a,o){return ja(l)?o6(l,n,a,o):n[a.axis]=a.parse(l,o),n}function L2(l,n,a,o){const s=l.iScale,e=l.vScale,m=s.getLabels(),v=s===e,w=[];let N,S,D,L;for(N=a,S=a+o;N<S;++N)L=n[N],D={},D[s.axis]=v||s.parse(m[N],N),w.push(sv(L,D,e,N));return w}function N1(l){return l&&l.barStart!==void 0&&l.barEnd!==void 0}function c6(l,n,a){return l!==0?Vl(l):(n.isHorizontal()?1:-1)*(n.min>=a?1:-1)}function d6(l){let n,a,o,s,e;return l.horizontal?(n=l.base>l.x,a="left",o="right"):(n=l.base<l.y,a="bottom",o="top"),n?(s="end",e="start"):(s="start",e="end"),{start:a,end:o,reverse:n,top:s,bottom:e}}function u6(l,n,a,o){let s=n.borderSkipped;const e={};if(!s){l.borderSkipped=e;return}if(s===!0){l.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:m,end:v,reverse:w,top:N,bottom:S}=d6(l);s==="middle"&&a&&(l.enableBorderRadius=!0,(a._top||0)===o?s=N:(a._bottom||0)===o?s=S:(e[R2(S,m,v,w)]=!0,s=N)),e[R2(s,m,v,w)]=!0,l.borderSkipped=e}function R2(l,n,a,o){return o?(l=h6(l,n,a),l=O2(l,a,n)):l=O2(l,n,a),l}function h6(l,n,a){return l===n?a:l===a?n:l}function O2(l,n,a){return l==="start"?n:l==="end"?a:l}function f6(l,{inflateAmount:n},a){l.inflateAmount=n==="auto"?a===1?.33:0:n}class m6 extends Ic{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(n,a,o,s){return L2(n,a,o,s)}parseArrayData(n,a,o,s){return L2(n,a,o,s)}parseObjectData(n,a,o,s){const{iScale:e,vScale:m}=n,{xAxisKey:v="x",yAxisKey:w="y"}=this._parsing,N=e.axis==="x"?v:w,S=m.axis==="x"?v:w,D=[];let L,M,F,O;for(L=o,M=o+s;L<M;++L)O=a[L],F={},F[e.axis]=e.parse(Oc(O,N),L),D.push(sv(Oc(O,S),F,m,L));return D}updateRangeFromParsed(n,a,o,s){super.updateRangeFromParsed(n,a,o,s);const e=o._custom;e&&a===this._cachedMeta.vScale&&(n.min=Math.min(n.min,e.min),n.max=Math.max(n.max,e.max))}getMaxOverflow(){return 0}getLabelAndValue(n){const a=this._cachedMeta,{iScale:o,vScale:s}=a,e=this.getParsed(n),m=e._custom,v=N1(m)?"["+m.start+", "+m.end+"]":""+s.getLabelForValue(e[s.axis]);return{label:""+o.getLabelForValue(e[o.axis]),value:v}}initialize(){this.enableOptionSharing=!0,super.initialize();const n=this._cachedMeta;n.stack=this.getDataset().stack}update(n){const a=this._cachedMeta;this.updateElements(a.data,0,a.data.length,n)}updateElements(n,a,o,s){const e=s==="reset",{index:m,_cachedMeta:{vScale:v}}=this,w=v.getBasePixel(),N=v.isHorizontal(),S=this._getRuler(),{sharedOptions:D,includeOptions:L}=this._getSharedOptions(a,s);for(let M=a;M<a+o;M++){const F=this.getParsed(M),O=e||dr(F[v.axis])?{base:w,head:w}:this._calculateBarValuePixels(M),P=this._calculateBarIndexPixels(M,S),G=(F._stacks||{})[v.axis],ae={horizontal:N,base:O.base,enableBorderRadius:!G||N1(F._custom)||m===G._top||m===G._bottom,x:N?O.head:P.center,y:N?P.center:O.head,height:N?P.size:Math.abs(O.size),width:N?Math.abs(O.size):P.size};L&&(ae.options=D||this.resolveDataElementOptions(M,n[M].active?"active":s));const re=ae.options||n[M].options;u6(ae,re,G,m),f6(ae,re,S.ratio),this.updateElement(n[M],M,ae,s)}}_getStacks(n,a){const{iScale:o}=this._cachedMeta,s=o.getMatchingVisibleMetas(this._type).filter(S=>S.controller.options.grouped),e=o.options.stacked,m=[],v=this._cachedMeta.controller.getParsed(a),w=v&&v[o.axis],N=S=>{const D=S._parsed.find(M=>M[o.axis]===w),L=D&&D[S.vScale.axis];if(dr(L)||isNaN(L))return!0};for(const S of s)if(!(a!==void 0&&N(S))&&((e===!1||m.indexOf(S.stack)===-1||e===void 0&&S.stack===void 0)&&m.push(S.stack),S.index===n))break;return m.length||m.push(void 0),m}_getStackCount(n){return this._getStacks(void 0,n).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const n=this.chart.scales,a=this.chart.options.indexAxis;return Object.keys(n).filter(o=>n[o].axis===a).shift()}_getAxis(){const n={},a=this.getFirstScaleIdForIndexAxis();for(const o of this.chart.data.datasets)n[Ms(this.chart.options.indexAxis==="x"?o.xAxisID:o.yAxisID,a)]=!0;return Object.keys(n)}_getStackIndex(n,a,o){const s=this._getStacks(n,o),e=a!==void 0?s.indexOf(a):-1;return e===-1?s.length-1:e}_getRuler(){const n=this.options,a=this._cachedMeta,o=a.iScale,s=[];let e,m;for(e=0,m=a.data.length;e<m;++e)s.push(o.getPixelForValue(this.getParsed(e)[o.axis],e));const v=n.barThickness;return{min:v||n6(a),pixels:s,start:o._startPixel,end:o._endPixel,stackCount:this._getStackCount(),scale:o,grouped:n.grouped,ratio:v?1:n.categoryPercentage*n.barPercentage}}_calculateBarValuePixels(n){const{_cachedMeta:{vScale:a,_stacked:o,index:s},options:{base:e,minBarLength:m}}=this,v=e||0,w=this.getParsed(n),N=w._custom,S=N1(N);let D=w[a.axis],L=0,M=o?this.applyStack(a,w,o):D,F,O;M!==D&&(L=M-D,M=D),S&&(D=N.barStart,M=N.barEnd-N.barStart,D!==0&&Vl(D)!==Vl(N.barEnd)&&(L=0),L+=D);const P=!dr(e)&&!S?e:L;let G=a.getPixelForValue(P);if(this.chart.getDataVisibility(n)?F=a.getPixelForValue(L+M):F=G,O=F-G,Math.abs(O)<m){O=c6(O,a,v)*m,D===v&&(G-=O/2);const ae=a.getPixelForDecimal(0),re=a.getPixelForDecimal(1),Ne=Math.min(ae,re),xe=Math.max(ae,re);G=Math.max(Math.min(G,xe),Ne),F=G+O,o&&!S&&(w._stacks[a.axis]._visualValues[s]=a.getValueForPixel(F)-a.getValueForPixel(G))}if(G===a.getPixelForValue(v)){const ae=Vl(O)*a.getLineWidthForValue(v)/2;G+=ae,O-=ae}return{size:O,base:G,head:F,center:F+O/2}}_calculateBarIndexPixels(n,a){const o=a.scale,s=this.options,e=s.skipNull,m=Ms(s.maxBarThickness,1/0);let v,w;const N=this._getAxisCount();if(a.grouped){const S=e?this._getStackCount(n):a.stackCount,D=s.barThickness==="flex"?l6(n,a,s,S*N):i6(n,a,s,S*N),L=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,M=this._getAxis().indexOf(Ms(L,this.getFirstScaleIdForIndexAxis())),F=this._getStackIndex(this.index,this._cachedMeta.stack,e?n:void 0)+M;v=D.start+D.chunk*F+D.chunk/2,w=Math.min(m,D.chunk*D.ratio)}else v=o.getPixelForValue(this.getParsed(n)[o.axis],n),w=Math.min(m,a.min*a.ratio);return{base:v-w/2,head:v+w/2,center:v,size:w}}draw(){const n=this._cachedMeta,a=n.vScale,o=n.data,s=o.length;let e=0;for(;e<s;++e)this.getParsed(e)[a.axis]!==null&&!o[e].hidden&&o[e].draw(this._ctx)}}class g6 extends Ic{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(n,a,o,s){const e=super.parsePrimitiveData(n,a,o,s);for(let m=0;m<e.length;m++)e[m]._custom=this.resolveDataElementOptions(m+o).radius;return e}parseArrayData(n,a,o,s){const e=super.parseArrayData(n,a,o,s);for(let m=0;m<e.length;m++){const v=a[o+m];e[m]._custom=Ms(v[2],this.resolveDataElementOptions(m+o).radius)}return e}parseObjectData(n,a,o,s){const e=super.parseObjectData(n,a,o,s);for(let m=0;m<e.length;m++){const v=a[o+m];e[m]._custom=Ms(v&&v.r&&+v.r,this.resolveDataElementOptions(m+o).radius)}return e}getMaxOverflow(){const n=this._cachedMeta.data;let a=0;for(let o=n.length-1;o>=0;--o)a=Math.max(a,n[o].size(this.resolveDataElementOptions(o))/2);return a>0&&a}getLabelAndValue(n){const a=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:e}=a,m=this.getParsed(n),v=s.getLabelForValue(m.x),w=e.getLabelForValue(m.y),N=m._custom;return{label:o[n]||"",value:"("+v+", "+w+(N?", "+N:"")+")"}}update(n){const a=this._cachedMeta.data;this.updateElements(a,0,a.length,n)}updateElements(n,a,o,s){const e=s==="reset",{iScale:m,vScale:v}=this._cachedMeta,{sharedOptions:w,includeOptions:N}=this._getSharedOptions(a,s),S=m.axis,D=v.axis;for(let L=a;L<a+o;L++){const M=n[L],F=!e&&this.getParsed(L),O={},P=O[S]=e?m.getPixelForDecimal(.5):m.getPixelForValue(F[S]),G=O[D]=e?v.getBasePixel():v.getPixelForValue(F[D]);O.skip=isNaN(P)||isNaN(G),N&&(O.options=w||this.resolveDataElementOptions(L,M.active?"active":s),e&&(O.options.radius=0)),this.updateElement(M,L,O,s)}}resolveDataElementOptions(n,a){const o=this.getParsed(n);let s=super.resolveDataElementOptions(n,a);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const e=s.radius;return a!=="active"&&(s.radius=0),s.radius+=Ms(o&&o._custom,e),s}}function p6(l,n,a){let o=1,s=1,e=0,m=0;if(n<ea){const v=l,w=v+n,N=Math.cos(v),S=Math.sin(v),D=Math.cos(w),L=Math.sin(w),M=(re,Ne,xe)=>lm(re,v,w,!0)?1:Math.max(Ne,Ne*a,xe,xe*a),F=(re,Ne,xe)=>lm(re,v,w,!0)?-1:Math.min(Ne,Ne*a,xe,xe*a),O=M(0,N,D),P=M(Ea,S,L),G=F(pr,N,D),ae=F(pr+Ea,S,L);o=(O-G)/2,s=(P-ae)/2,e=-(O+G)/2,m=-(P+ae)/2}return{ratioX:o,ratioY:s,offsetX:e,offsetY:m}}class rv extends Ic{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:n=>n!=="spacing",_indexable:n=>n!=="spacing"&&!n.startsWith("borderDash")&&!n.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const a=n.data,{labels:{pointStyle:o,textAlign:s,color:e,useBorderRadius:m,borderRadius:v}}=n.legend.options;return a.labels.length&&a.datasets.length?a.labels.map((w,N)=>{const D=n.getDatasetMeta(0).controller.getStyle(N);return{text:w,fillStyle:D.backgroundColor,fontColor:e,hidden:!n.getDataVisibility(N),lineDash:D.borderDash,lineDashOffset:D.borderDashOffset,lineJoin:D.borderJoinStyle,lineWidth:D.borderWidth,strokeStyle:D.borderColor,textAlign:s,pointStyle:o,borderRadius:m&&(v||D.borderRadius),index:N}}):[]}},onClick(n,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}}};constructor(n,a){super(n,a),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(n,a){const o=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=o;else{let e=w=>+o[w];if(Xs(o[n])){const{key:w="value"}=this._parsing;e=N=>+Oc(o[N],w)}let m,v;for(m=n,v=n+a;m<v;++m)s._parsed[m]=e(m)}}_getRotation(){return Hl(this.options.rotation-90)}_getCircumference(){return Hl(this.options.circumference)}_getRotationExtents(){let n=ea,a=-ea;for(let o=0;o<this.chart.data.datasets.length;++o)if(this.chart.isDatasetVisible(o)&&this.chart.getDatasetMeta(o).type===this._type){const s=this.chart.getDatasetMeta(o).controller,e=s._getRotation(),m=s._getCircumference();n=Math.min(n,e),a=Math.max(a,e+m)}return{rotation:n,circumference:a-n}}update(n){const a=this.chart,{chartArea:o}=a,s=this._cachedMeta,e=s.data,m=this.getMaxBorderWidth()+this.getMaxOffset(e)+this.options.spacing,v=Math.max((Math.min(o.width,o.height)-m)/2,0),w=Math.min(k3(this.options.cutout,v),1),N=this._getRingWeight(this.index),{circumference:S,rotation:D}=this._getRotationExtents(),{ratioX:L,ratioY:M,offsetX:F,offsetY:O}=p6(D,S,w),P=(o.width-m)/L,G=(o.height-m)/M,ae=Math.max(Math.min(P,G)/2,0),re=Dy(this.options.radius,ae),Ne=Math.max(re*w,0),xe=(re-Ne)/this._getVisibleDatasetWeightTotal();this.offsetX=F*re,this.offsetY=O*re,s.total=this.calculateTotal(),this.outerRadius=re-xe*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-xe*N,0),this.updateElements(e,0,e.length,n)}_circumference(n,a){const o=this.options,s=this._cachedMeta,e=this._getCircumference();return a&&o.animation.animateRotate||!this.chart.getDataVisibility(n)||s._parsed[n]===null||s.data[n].hidden?0:this.calculateCircumference(s._parsed[n]*e/ea)}updateElements(n,a,o,s){const e=s==="reset",m=this.chart,v=m.chartArea,N=m.options.animation,S=(v.left+v.right)/2,D=(v.top+v.bottom)/2,L=e&&N.animateScale,M=L?0:this.innerRadius,F=L?0:this.outerRadius,{sharedOptions:O,includeOptions:P}=this._getSharedOptions(a,s);let G=this._getRotation(),ae;for(ae=0;ae<a;++ae)G+=this._circumference(ae,e);for(ae=a;ae<a+o;++ae){const re=this._circumference(ae,e),Ne=n[ae],xe={x:S+this.offsetX,y:D+this.offsetY,startAngle:G,endAngle:G+re,circumference:re,outerRadius:F,innerRadius:M};P&&(xe.options=O||this.resolveDataElementOptions(ae,Ne.active?"active":s)),G+=re,this.updateElement(Ne,ae,xe,s)}}calculateTotal(){const n=this._cachedMeta,a=n.data;let o=0,s;for(s=0;s<a.length;s++){const e=n._parsed[s];e!==null&&!isNaN(e)&&this.chart.getDataVisibility(s)&&!a[s].hidden&&(o+=Math.abs(e))}return o}calculateCircumference(n){const a=this._cachedMeta.total;return a>0&&!isNaN(n)?ea*(Math.abs(n)/a):0}getLabelAndValue(n){const a=this._cachedMeta,o=this.chart,s=o.data.labels||[],e=Fp(a._parsed[n],o.options.locale);return{label:s[n]||"",value:e}}getMaxBorderWidth(n){let a=0;const o=this.chart;let s,e,m,v,w;if(!n){for(s=0,e=o.data.datasets.length;s<e;++s)if(o.isDatasetVisible(s)){m=o.getDatasetMeta(s),n=m.data,v=m.controller;break}}if(!n)return 0;for(s=0,e=n.length;s<e;++s)w=v.resolveDataElementOptions(s),w.borderAlign!=="inner"&&(a=Math.max(a,w.borderWidth||0,w.hoverBorderWidth||0));return a}getMaxOffset(n){let a=0;for(let o=0,s=n.length;o<s;++o){const e=this.resolveDataElementOptions(o);a=Math.max(a,e.offset||0,e.hoverOffset||0)}return a}_getRingWeightOffset(n){let a=0;for(let o=0;o<n;++o)this.chart.isDatasetVisible(o)&&(a+=this._getRingWeight(o));return a}_getRingWeight(n){return Math.max(Ms(this.chart.data.datasets[n].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class x6 extends Ic{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(n){const a=this._cachedMeta,{dataset:o,data:s=[],_dataset:e}=a,m=this.chart._animationsDisabled;let{start:v,count:w}=Py(a,s,m);this._drawStart=v,this._drawCount=w,Iy(a)&&(v=0,w=s.length),o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!e._decimated,o.points=s;const N=this.resolveDatasetElementOptions(n);this.options.showLine||(N.borderWidth=0),N.segment=this.options.segment,this.updateElement(o,void 0,{animated:!m,options:N},n),this.updateElements(s,v,w,n)}updateElements(n,a,o,s){const e=s==="reset",{iScale:m,vScale:v,_stacked:w,_dataset:N}=this._cachedMeta,{sharedOptions:S,includeOptions:D}=this._getSharedOptions(a,s),L=m.axis,M=v.axis,{spanGaps:F,segment:O}=this.options,P=Ku(F)?F:Number.POSITIVE_INFINITY,G=this.chart._animationsDisabled||e||s==="none",ae=a+o,re=n.length;let Ne=a>0&&this.getParsed(a-1);for(let xe=0;xe<re;++xe){const we=n[xe],Z=G?we:{};if(xe<a||xe>=ae){Z.skip=!0;continue}const ce=this.getParsed(xe),ue=dr(ce[M]),Le=Z[L]=m.getPixelForValue(ce[L],xe),be=Z[M]=e||ue?v.getBasePixel():v.getPixelForValue(w?this.applyStack(v,ce,w):ce[M],xe);Z.skip=isNaN(Le)||isNaN(be)||ue,Z.stop=xe>0&&Math.abs(ce[L]-Ne[L])>P,O&&(Z.parsed=ce,Z.raw=N.data[xe]),D&&(Z.options=S||this.resolveDataElementOptions(xe,we.active?"active":s)),G||this.updateElement(we,xe,Z,s),Ne=ce}}getMaxOverflow(){const n=this._cachedMeta,a=n.dataset,o=a.options&&a.options.borderWidth||0,s=n.data||[];if(!s.length)return o;const e=s[0].size(this.resolveDataElementOptions(0)),m=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(o,e,m)/2}draw(){const n=this._cachedMeta;n.dataset.updateControlPoints(this.chart.chartArea,n.iScale.axis),super.draw()}}class b6 extends Ic{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const a=n.data;if(a.labels.length&&a.datasets.length){const{labels:{pointStyle:o,color:s}}=n.legend.options;return a.labels.map((e,m)=>{const w=n.getDatasetMeta(0).controller.getStyle(m);return{text:e,fillStyle:w.backgroundColor,strokeStyle:w.borderColor,fontColor:s,lineWidth:w.borderWidth,pointStyle:o,hidden:!n.getDataVisibility(m),index:m}})}return[]}},onClick(n,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(n,a){super(n,a),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(n){const a=this._cachedMeta,o=this.chart,s=o.data.labels||[],e=Fp(a._parsed[n].r,o.options.locale);return{label:s[n]||"",value:e}}parseObjectData(n,a,o,s){return qy.bind(this)(n,a,o,s)}update(n){const a=this._cachedMeta.data;this._updateRadius(),this.updateElements(a,0,a.length,n)}getMinMax(){const n=this._cachedMeta,a={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return n.data.forEach((o,s)=>{const e=this.getParsed(s).r;!isNaN(e)&&this.chart.getDataVisibility(s)&&(e<a.min&&(a.min=e),e>a.max&&(a.max=e))}),a}_updateRadius(){const n=this.chart,a=n.chartArea,o=n.options,s=Math.min(a.right-a.left,a.bottom-a.top),e=Math.max(s/2,0),m=Math.max(o.cutoutPercentage?e/100*o.cutoutPercentage:1,0),v=(e-m)/n.getVisibleDatasetCount();this.outerRadius=e-v*this.index,this.innerRadius=this.outerRadius-v}updateElements(n,a,o,s){const e=s==="reset",m=this.chart,w=m.options.animation,N=this._cachedMeta.rScale,S=N.xCenter,D=N.yCenter,L=N.getIndexAngle(0)-.5*pr;let M=L,F;const O=360/this.countVisibleElements();for(F=0;F<a;++F)M+=this._computeAngle(F,s,O);for(F=a;F<a+o;F++){const P=n[F];let G=M,ae=M+this._computeAngle(F,s,O),re=m.getDataVisibility(F)?N.getDistanceFromCenterForValue(this.getParsed(F).r):0;M=ae,e&&(w.animateScale&&(re=0),w.animateRotate&&(G=ae=L));const Ne={x:S,y:D,innerRadius:0,outerRadius:re,startAngle:G,endAngle:ae,options:this.resolveDataElementOptions(F,P.active?"active":s)};this.updateElement(P,F,Ne,s)}}countVisibleElements(){const n=this._cachedMeta;let a=0;return n.data.forEach((o,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&a++}),a}_computeAngle(n,a,o){return this.chart.getDataVisibility(n)?Hl(this.resolveDataElementOptions(n,a).angle||o):0}}class y6 extends rv{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class v6 extends Ic{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(n){const a=this._cachedMeta.vScale,o=this.getParsed(n);return{label:a.getLabels()[n],value:""+a.getLabelForValue(o[a.axis])}}parseObjectData(n,a,o,s){return qy.bind(this)(n,a,o,s)}update(n){const a=this._cachedMeta,o=a.dataset,s=a.data||[],e=a.iScale.getLabels();if(o.points=s,n!=="resize"){const m=this.resolveDatasetElementOptions(n);this.options.showLine||(m.borderWidth=0);const v={_loop:!0,_fullLoop:e.length===s.length,options:m};this.updateElement(o,void 0,v,n)}this.updateElements(s,0,s.length,n)}updateElements(n,a,o,s){const e=this._cachedMeta.rScale,m=s==="reset";for(let v=a;v<a+o;v++){const w=n[v],N=this.resolveDataElementOptions(v,w.active?"active":s),S=e.getPointPositionForValue(v,this.getParsed(v).r),D=m?e.xCenter:S.x,L=m?e.yCenter:S.y,M={x:D,y:L,angle:S.angle,skip:isNaN(D)||isNaN(L),options:N};this.updateElement(w,v,M,s)}}}class w6 extends Ic{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(n){const a=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:e}=a,m=this.getParsed(n),v=s.getLabelForValue(m.x),w=e.getLabelForValue(m.y);return{label:o[n]||"",value:"("+v+", "+w+")"}}update(n){const a=this._cachedMeta,{data:o=[]}=a,s=this.chart._animationsDisabled;let{start:e,count:m}=Py(a,o,s);if(this._drawStart=e,this._drawCount=m,Iy(a)&&(e=0,m=o.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:v,_dataset:w}=a;v._chart=this.chart,v._datasetIndex=this.index,v._decimated=!!w._decimated,v.points=o;const N=this.resolveDatasetElementOptions(n);N.segment=this.options.segment,this.updateElement(v,void 0,{animated:!s,options:N},n)}else this.datasetElementType&&(delete a.dataset,this.datasetElementType=!1);this.updateElements(o,e,m,n)}addElements(){const{showLine:n}=this.options;!this.datasetElementType&&n&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(n,a,o,s){const e=s==="reset",{iScale:m,vScale:v,_stacked:w,_dataset:N}=this._cachedMeta,S=this.resolveDataElementOptions(a,s),D=this.getSharedOptions(S),L=this.includeOptions(s,D),M=m.axis,F=v.axis,{spanGaps:O,segment:P}=this.options,G=Ku(O)?O:Number.POSITIVE_INFINITY,ae=this.chart._animationsDisabled||e||s==="none";let re=a>0&&this.getParsed(a-1);for(let Ne=a;Ne<a+o;++Ne){const xe=n[Ne],we=this.getParsed(Ne),Z=ae?xe:{},ce=dr(we[F]),ue=Z[M]=m.getPixelForValue(we[M],Ne),Le=Z[F]=e||ce?v.getBasePixel():v.getPixelForValue(w?this.applyStack(v,we,w):we[F],Ne);Z.skip=isNaN(ue)||isNaN(Le)||ce,Z.stop=Ne>0&&Math.abs(we[M]-re[M])>G,P&&(Z.parsed=we,Z.raw=N.data[Ne]),L&&(Z.options=D||this.resolveDataElementOptions(Ne,xe.active?"active":s)),ae||this.updateElement(xe,Ne,Z,s),re=we}this.updateSharedOptions(D,s,S)}getMaxOverflow(){const n=this._cachedMeta,a=n.data||[];if(!this.options.showLine){let v=0;for(let w=a.length-1;w>=0;--w)v=Math.max(v,a[w].size(this.resolveDataElementOptions(w))/2);return v>0&&v}const o=n.dataset,s=o.options&&o.options.borderWidth||0;if(!a.length)return s;const e=a[0].size(this.resolveDataElementOptions(0)),m=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(s,e,m)/2}}function Gd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Cx{static override(n){Object.assign(Cx.prototype,n)}options;constructor(n){this.options=n||{}}init(){}formats(){return Gd()}parse(){return Gd()}format(){return Gd()}add(){return Gd()}diff(){return Gd()}startOf(){return Gd()}endOf(){return Gd()}}var j6={_date:Cx};function N6(l,n,a,o){const{controller:s,data:e,_sorted:m}=l,v=s._cachedMeta.iScale,w=l.dataset&&l.dataset.options?l.dataset.options.spanGaps:null;if(v&&n===v.axis&&n!=="r"&&m&&e.length){const N=v._reversePixels?B3:Jd;if(o){if(s._sharedOptions){const S=e[0],D=typeof S.getRange=="function"&&S.getRange(n);if(D){const L=N(e,n,a-D),M=N(e,n,a+D);return{lo:L.lo,hi:M.hi}}}}else{const S=N(e,n,a);if(w){const{vScale:D}=s._cachedMeta,{_parsed:L}=l,M=L.slice(0,S.lo+1).reverse().findIndex(O=>!dr(O[D.axis]));S.lo-=Math.max(0,M);const F=L.slice(S.hi).findIndex(O=>!dr(O[D.axis]));S.hi+=Math.max(0,F)}return S}}return{lo:0,hi:e.length-1}}function Op(l,n,a,o,s){const e=l.getSortedVisibleDatasetMetas(),m=a[n];for(let v=0,w=e.length;v<w;++v){const{index:N,data:S}=e[v],{lo:D,hi:L}=N6(e[v],n,m,s);for(let M=D;M<=L;++M){const F=S[M];F.skip||o(F,N,M)}}}function k6(l){const n=l.indexOf("x")!==-1,a=l.indexOf("y")!==-1;return function(o,s){const e=n?Math.abs(o.x-s.x):0,m=a?Math.abs(o.y-s.y):0;return Math.sqrt(Math.pow(e,2)+Math.pow(m,2))}}function k1(l,n,a,o,s){const e=[];return!s&&!l.isPointInArea(n)||Op(l,a,n,function(v,w,N){!s&&!om(v,l.chartArea,0)||v.inRange(n.x,n.y,o)&&e.push({element:v,datasetIndex:w,index:N})},!0),e}function C6(l,n,a,o){let s=[];function e(m,v,w){const{startAngle:N,endAngle:S}=m.getProps(["startAngle","endAngle"],o),{angle:D}=Fy(m,{x:n.x,y:n.y});lm(D,N,S)&&s.push({element:m,datasetIndex:v,index:w})}return Op(l,a,n,e),s}function S6(l,n,a,o,s,e){let m=[];const v=k6(a);let w=Number.POSITIVE_INFINITY;function N(S,D,L){const M=S.inRange(n.x,n.y,s);if(o&&!M)return;const F=S.getCenterPoint(s);if(!(!!e||l.isPointInArea(F))&&!M)return;const P=v(n,F);P<w?(m=[{element:S,datasetIndex:D,index:L}],w=P):P===w&&m.push({element:S,datasetIndex:D,index:L})}return Op(l,a,n,N),m}function C1(l,n,a,o,s,e){return!e&&!l.isPointInArea(n)?[]:a==="r"&&!o?C6(l,n,a,s):S6(l,n,a,o,s,e)}function P2(l,n,a,o,s){const e=[],m=a==="x"?"inXRange":"inYRange";let v=!1;return Op(l,a,n,(w,N,S)=>{w[m]&&w[m](n[a],s)&&(e.push({element:w,datasetIndex:N,index:S}),v=v||w.inRange(n.x,n.y,s))}),o&&!v?[]:e}var A6={modes:{index(l,n,a,o){const s=Kd(n,l),e=a.axis||"x",m=a.includeInvisible||!1,v=a.intersect?k1(l,s,e,o,m):C1(l,s,e,!1,o,m),w=[];return v.length?(l.getSortedVisibleDatasetMetas().forEach(N=>{const S=v[0].index,D=N.data[S];D&&!D.skip&&w.push({element:D,datasetIndex:N.index,index:S})}),w):[]},dataset(l,n,a,o){const s=Kd(n,l),e=a.axis||"xy",m=a.includeInvisible||!1;let v=a.intersect?k1(l,s,e,o,m):C1(l,s,e,!1,o,m);if(v.length>0){const w=v[0].datasetIndex,N=l.getDatasetMeta(w).data;v=[];for(let S=0;S<N.length;++S)v.push({element:N[S],datasetIndex:w,index:S})}return v},point(l,n,a,o){const s=Kd(n,l),e=a.axis||"xy",m=a.includeInvisible||!1;return k1(l,s,e,o,m)},nearest(l,n,a,o){const s=Kd(n,l),e=a.axis||"xy",m=a.includeInvisible||!1;return C1(l,s,e,a.intersect,o,m)},x(l,n,a,o){const s=Kd(n,l);return P2(l,s,"x",a.intersect,o)},y(l,n,a,o){const s=Kd(n,l);return P2(l,s,"y",a.intersect,o)}}};const av=["left","top","right","bottom"];function Wf(l,n){return l.filter(a=>a.pos===n)}function I2(l,n){return l.filter(a=>av.indexOf(a.pos)===-1&&a.box.axis===n)}function $f(l,n){return l.sort((a,o)=>{const s=n?o:a,e=n?a:o;return s.weight===e.weight?s.index-e.index:s.weight-e.weight})}function E6(l){const n=[];let a,o,s,e,m,v;for(a=0,o=(l||[]).length;a<o;++a)s=l[a],{position:e,options:{stack:m,stackWeight:v=1}}=s,n.push({index:a,box:s,pos:e,horizontal:s.isHorizontal(),weight:s.weight,stack:m&&e+m,stackWeight:v});return n}function D6(l){const n={};for(const a of l){const{stack:o,pos:s,stackWeight:e}=a;if(!o||!av.includes(s))continue;const m=n[o]||(n[o]={count:0,placed:0,weight:0,size:0});m.count++,m.weight+=e}return n}function T6(l,n){const a=D6(l),{vBoxMaxWidth:o,hBoxMaxHeight:s}=n;let e,m,v;for(e=0,m=l.length;e<m;++e){v=l[e];const{fullSize:w}=v.box,N=a[v.stack],S=N&&v.stackWeight/N.weight;v.horizontal?(v.width=S?S*o:w&&n.availableWidth,v.height=s):(v.width=o,v.height=S?S*s:w&&n.availableHeight)}return a}function _6(l){const n=E6(l),a=$f(n.filter(N=>N.box.fullSize),!0),o=$f(Wf(n,"left"),!0),s=$f(Wf(n,"right")),e=$f(Wf(n,"top"),!0),m=$f(Wf(n,"bottom")),v=I2(n,"x"),w=I2(n,"y");return{fullSize:a,leftAndTop:o.concat(e),rightAndBottom:s.concat(w).concat(m).concat(v),chartArea:Wf(n,"chartArea"),vertical:o.concat(s).concat(w),horizontal:e.concat(m).concat(v)}}function B2(l,n,a,o){return Math.max(l[a],n[a])+Math.max(l[o],n[o])}function nv(l,n){l.top=Math.max(l.top,n.top),l.left=Math.max(l.left,n.left),l.bottom=Math.max(l.bottom,n.bottom),l.right=Math.max(l.right,n.right)}function F6(l,n,a,o){const{pos:s,box:e}=a,m=l.maxPadding;if(!Xs(s)){a.size&&(l[s]-=a.size);const D=o[a.stack]||{size:0,count:1};D.size=Math.max(D.size,a.horizontal?e.height:e.width),a.size=D.size/D.count,l[s]+=a.size}e.getPadding&&nv(m,e.getPadding());const v=Math.max(0,n.outerWidth-B2(m,l,"left","right")),w=Math.max(0,n.outerHeight-B2(m,l,"top","bottom")),N=v!==l.w,S=w!==l.h;return l.w=v,l.h=w,a.horizontal?{same:N,other:S}:{same:S,other:N}}function M6(l){const n=l.maxPadding;function a(o){const s=Math.max(n[o]-l[o],0);return l[o]+=s,s}l.y+=a("top"),l.x+=a("left"),a("right"),a("bottom")}function L6(l,n){const a=n.maxPadding;function o(s){const e={left:0,top:0,right:0,bottom:0};return s.forEach(m=>{e[m]=Math.max(n[m],a[m])}),e}return o(l?["left","right"]:["top","bottom"])}function Xf(l,n,a,o){const s=[];let e,m,v,w,N,S;for(e=0,m=l.length,N=0;e<m;++e){v=l[e],w=v.box,w.update(v.width||n.w,v.height||n.h,L6(v.horizontal,n));const{same:D,other:L}=F6(n,a,v,o);N|=D&&s.length,S=S||L,w.fullSize||s.push(v)}return N&&Xf(s,n,a,o)||S}function Qg(l,n,a,o,s){l.top=a,l.left=n,l.right=n+o,l.bottom=a+s,l.width=o,l.height=s}function z2(l,n,a,o){const s=a.padding;let{x:e,y:m}=n;for(const v of l){const w=v.box,N=o[v.stack]||{placed:0,weight:1},S=v.stackWeight/N.weight||1;if(v.horizontal){const D=n.w*S,L=N.size||w.height;im(N.start)&&(m=N.start),w.fullSize?Qg(w,s.left,m,a.outerWidth-s.right-s.left,L):Qg(w,n.left+N.placed,m,D,L),N.start=m,N.placed+=D,m=w.bottom}else{const D=n.h*S,L=N.size||w.width;im(N.start)&&(e=N.start),w.fullSize?Qg(w,e,s.top,L,a.outerHeight-s.bottom-s.top):Qg(w,e,n.top+N.placed,L,D),N.start=e,N.placed+=D,e=w.right}}n.x=e,n.y=m}var Ei={addBox(l,n){l.boxes||(l.boxes=[]),n.fullSize=n.fullSize||!1,n.position=n.position||"top",n.weight=n.weight||0,n._layers=n._layers||function(){return[{z:0,draw(a){n.draw(a)}}]},l.boxes.push(n)},removeBox(l,n){const a=l.boxes?l.boxes.indexOf(n):-1;a!==-1&&l.boxes.splice(a,1)},configure(l,n,a){n.fullSize=a.fullSize,n.position=a.position,n.weight=a.weight},update(l,n,a,o){if(!l)return;const s=Di(l.options.layout.padding),e=Math.max(n-s.width,0),m=Math.max(a-s.height,0),v=_6(l.boxes),w=v.vertical,N=v.horizontal;vr(l.boxes,O=>{typeof O.beforeLayout=="function"&&O.beforeLayout()});const S=w.reduce((O,P)=>P.box.options&&P.box.options.display===!1?O:O+1,0)||1,D=Object.freeze({outerWidth:n,outerHeight:a,padding:s,availableWidth:e,availableHeight:m,vBoxMaxWidth:e/2/S,hBoxMaxHeight:m/2}),L=Object.assign({},s);nv(L,Di(o));const M=Object.assign({maxPadding:L,w:e,h:m,x:s.left,y:s.top},s),F=T6(w.concat(N),D);Xf(v.fullSize,M,D,F),Xf(w,M,D,F),Xf(N,M,D,F)&&Xf(w,M,D,F),M6(M),z2(v.leftAndTop,M,D,F),M.x+=M.w,M.y+=M.h,z2(v.rightAndBottom,M,D,F),l.chartArea={left:M.left,top:M.top,right:M.left+M.w,bottom:M.top+M.h,height:M.h,width:M.w},vr(v.chartArea,O=>{const P=O.box;Object.assign(P,l.chartArea),P.update(M.w,M.h,{left:0,top:0,right:0,bottom:0})})}};class iv{acquireContext(n,a){}releaseContext(n){return!1}addEventListener(n,a,o){}removeEventListener(n,a,o){}getDevicePixelRatio(){return 1}getMaximumSize(n,a,o,s){return a=Math.max(0,a||n.width),o=o||n.height,{width:a,height:Math.max(0,s?Math.floor(a/s):o)}}isAttached(n){return!0}updateConfig(n){}}class R6 extends iv{acquireContext(n){return n&&n.getContext&&n.getContext("2d")||null}updateConfig(n){n.options.animation=!1}}const up="$chartjs",O6={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},U2=l=>l===null||l==="";function P6(l,n){const a=l.style,o=l.getAttribute("height"),s=l.getAttribute("width");if(l[up]={initial:{height:o,width:s,style:{display:a.display,height:a.height,width:a.width}}},a.display=a.display||"block",a.boxSizing=a.boxSizing||"border-box",U2(s)){const e=k2(l,"width");e!==void 0&&(l.width=e)}if(U2(o))if(l.style.height==="")l.height=l.width/(n||2);else{const e=k2(l,"height");e!==void 0&&(l.height=e)}return l}const lv=Fj?{passive:!0}:!1;function I6(l,n,a){l&&l.addEventListener(n,a,lv)}function B6(l,n,a){l&&l.canvas&&l.canvas.removeEventListener(n,a,lv)}function z6(l,n){const a=O6[l.type]||l.type,{x:o,y:s}=Kd(l,n);return{type:a,chart:n,native:l,x:o!==void 0?o:null,y:s!==void 0?s:null}}function Np(l,n){for(const a of l)if(a===n||a.contains(n))return!0}function U6(l,n,a){const o=l.canvas,s=new MutationObserver(e=>{let m=!1;for(const v of e)m=m||Np(v.addedNodes,o),m=m&&!Np(v.removedNodes,o);m&&a()});return s.observe(document,{childList:!0,subtree:!0}),s}function H6(l,n,a){const o=l.canvas,s=new MutationObserver(e=>{let m=!1;for(const v of e)m=m||Np(v.removedNodes,o),m=m&&!Np(v.addedNodes,o);m&&a()});return s.observe(document,{childList:!0,subtree:!0}),s}const dm=new Map;let H2=0;function ov(){const l=window.devicePixelRatio;l!==H2&&(H2=l,dm.forEach((n,a)=>{a.currentDevicePixelRatio!==l&&n()}))}function V6(l,n){dm.size||window.addEventListener("resize",ov),dm.set(l,n)}function W6(l){dm.delete(l),dm.size||window.removeEventListener("resize",ov)}function $6(l,n,a){const o=l.canvas,s=o&&kx(o);if(!s)return;const e=Oy((v,w)=>{const N=s.clientWidth;a(v,w),N<s.clientWidth&&a()},window),m=new ResizeObserver(v=>{const w=v[0],N=w.contentRect.width,S=w.contentRect.height;N===0&&S===0||e(N,S)});return m.observe(s),V6(l,e),m}function S1(l,n,a){a&&a.disconnect(),n==="resize"&&W6(l)}function q6(l,n,a){const o=l.canvas,s=Oy(e=>{l.ctx!==null&&a(z6(e,l))},l);return I6(o,n,s),s}class Y6 extends iv{acquireContext(n,a){const o=n&&n.getContext&&n.getContext("2d");return o&&o.canvas===n?(P6(n,a),o):null}releaseContext(n){const a=n.canvas;if(!a[up])return!1;const o=a[up].initial;["height","width"].forEach(e=>{const m=o[e];dr(m)?a.removeAttribute(e):a.setAttribute(e,m)});const s=o.style||{};return Object.keys(s).forEach(e=>{a.style[e]=s[e]}),a.width=a.width,delete a[up],!0}addEventListener(n,a,o){this.removeEventListener(n,a);const s=n.$proxies||(n.$proxies={}),m={attach:U6,detach:H6,resize:$6}[a]||q6;s[a]=m(n,a,o)}removeEventListener(n,a){const o=n.$proxies||(n.$proxies={}),s=o[a];if(!s)return;({attach:S1,detach:S1,resize:S1}[a]||B6)(n,a,s),o[a]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(n,a,o,s){return _j(n,a,o,s)}isAttached(n){const a=n&&kx(n);return!!(a&&a.isConnected)}}function G6(l){return!Nx()||typeof OffscreenCanvas<"u"&&l instanceof OffscreenCanvas?R6:Y6}class Io{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(n){const{x:a,y:o}=this.getProps(["x","y"],n);return{x:a,y:o}}hasValue(){return Ku(this.x)&&Ku(this.y)}getProps(n,a){const o=this.$animations;if(!a||!o)return this;const s={};return n.forEach(e=>{s[e]=o[e]&&o[e].active()?o[e]._to:this[e]}),s}}function K6(l,n){const a=l.options.ticks,o=Q6(l),s=Math.min(a.maxTicksLimit||o,o),e=a.major.enabled?J6(n):[],m=e.length,v=e[0],w=e[m-1],N=[];if(m>s)return Z6(n,N,e,m/s),N;const S=X6(e,n,s);if(m>0){let D,L;const M=m>1?Math.round((w-v)/(m-1)):null;for(Xg(n,N,S,dr(M)?0:v-M,v),D=0,L=m-1;D<L;D++)Xg(n,N,S,e[D],e[D+1]);return Xg(n,N,S,w,dr(M)?n.length:w+M),N}return Xg(n,N,S),N}function Q6(l){const n=l.options.offset,a=l._tickSize(),o=l._length/a+(n?0:1),s=l._maxLength/a;return Math.floor(Math.min(o,s))}function X6(l,n,a){const o=eN(l),s=n.length/a;if(!o)return Math.max(s,1);const e=F3(o);for(let m=0,v=e.length-1;m<v;m++){const w=e[m];if(w>s)return w}return Math.max(s,1)}function J6(l){const n=[];let a,o;for(a=0,o=l.length;a<o;a++)l[a].major&&n.push(a);return n}function Z6(l,n,a,o){let s=0,e=a[0],m;for(o=Math.ceil(o),m=0;m<l.length;m++)m===e&&(n.push(l[m]),s++,e=a[s*o])}function Xg(l,n,a,o,s){const e=Ms(o,0),m=Math.min(Ms(s,l.length),l.length);let v=0,w,N,S;for(a=Math.ceil(a),s&&(w=s-o,a=w/Math.floor(w/a)),S=e;S<0;)v++,S=Math.round(e+v*a);for(N=Math.max(e,0);N<m;N++)N===S&&(n.push(l[N]),v++,S=Math.round(e+v*a))}function eN(l){const n=l.length;let a,o;if(n<2)return!1;for(o=l[0],a=1;a<n;++a)if(l[a]-l[a-1]!==o)return!1;return o}const tN=l=>l==="left"?"right":l==="right"?"left":l,V2=(l,n,a)=>n==="top"||n==="left"?l[n]+a:l[n]-a,W2=(l,n)=>Math.min(n||l,l);function $2(l,n){const a=[],o=l.length/n,s=l.length;let e=0;for(;e<s;e+=o)a.push(l[Math.floor(e)]);return a}function sN(l,n,a){const o=l.ticks.length,s=Math.min(n,o-1),e=l._startPixel,m=l._endPixel,v=1e-6;let w=l.getPixelForTick(s),N;if(!(a&&(o===1?N=Math.max(w-e,m-w):n===0?N=(l.getPixelForTick(1)-w)/2:N=(w-l.getPixelForTick(s-1))/2,w+=s<n?N:-N,w<e-v||w>m+v)))return w}function rN(l,n){vr(l,a=>{const o=a.gc,s=o.length/2;let e;if(s>n){for(e=0;e<s;++e)delete a.data[o[e]];o.splice(0,s)}})}function qf(l){return l.drawTicks?l.tickLength:0}function q2(l,n){if(!l.display)return 0;const a=rn(l.font,n),o=Di(l.padding);return(ja(l.text)?l.text.length:1)*a.lineHeight+o.height}function aN(l,n){return i0(l,{scale:n,type:"scale"})}function nN(l,n,a){return i0(l,{tick:a,index:n,type:"tick"})}function iN(l,n,a){let o=xx(l);return(a&&n!=="right"||!a&&n==="right")&&(o=tN(o)),o}function lN(l,n,a,o){const{top:s,left:e,bottom:m,right:v,chart:w}=l,{chartArea:N,scales:S}=w;let D=0,L,M,F;const O=m-s,P=v-e;if(l.isHorizontal()){if(M=en(o,e,v),Xs(a)){const G=Object.keys(a)[0],ae=a[G];F=S[G].getPixelForValue(ae)+O-n}else a==="center"?F=(N.bottom+N.top)/2+O-n:F=V2(l,a,n);L=v-e}else{if(Xs(a)){const G=Object.keys(a)[0],ae=a[G];M=S[G].getPixelForValue(ae)-P+n}else a==="center"?M=(N.left+N.right)/2-P+n:M=V2(l,a,n);F=en(o,m,s),D=a==="left"?-Ea:Ea}return{titleX:M,titleY:F,maxWidth:L,rotation:D}}class rh extends Io{constructor(n){super(),this.id=n.id,this.type=n.type,this.options=void 0,this.ctx=n.ctx,this.chart=n.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(n){this.options=n.setContext(this.getContext()),this.axis=n.axis,this._userMin=this.parse(n.min),this._userMax=this.parse(n.max),this._suggestedMin=this.parse(n.suggestedMin),this._suggestedMax=this.parse(n.suggestedMax)}parse(n,a){return n}getUserBounds(){let{_userMin:n,_userMax:a,_suggestedMin:o,_suggestedMax:s}=this;return n=Bl(n,Number.POSITIVE_INFINITY),a=Bl(a,Number.NEGATIVE_INFINITY),o=Bl(o,Number.POSITIVE_INFINITY),s=Bl(s,Number.NEGATIVE_INFINITY),{min:Bl(n,o),max:Bl(a,s),minDefined:an(n),maxDefined:an(a)}}getMinMax(n){let{min:a,max:o,minDefined:s,maxDefined:e}=this.getUserBounds(),m;if(s&&e)return{min:a,max:o};const v=this.getMatchingVisibleMetas();for(let w=0,N=v.length;w<N;++w)m=v[w].controller.getMinMax(this,n),s||(a=Math.min(a,m.min)),e||(o=Math.max(o,m.max));return a=e&&a>o?o:a,o=s&&a>o?a:o,{min:Bl(a,Bl(o,a)),max:Bl(o,Bl(a,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const n=this.chart.data;return this.options.labels||(this.isHorizontal()?n.xLabels:n.yLabels)||n.labels||[]}getLabelItems(n=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(n))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Wr(this.options.beforeUpdate,[this])}update(n,a,o){const{beginAtZero:s,grace:e,ticks:m}=this.options,v=m.sampleSize;this.beforeUpdate(),this.maxWidth=n,this.maxHeight=a,this._margins=o=Object.assign({left:0,right:0,top:0,bottom:0},o),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+o.left+o.right:this.height+o.top+o.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=cj(this,e,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const w=v<this.ticks.length;this._convertTicksToLabels(w?$2(this.ticks,v):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),m.display&&(m.autoSkip||m.source==="auto")&&(this.ticks=K6(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),w&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let n=this.options.reverse,a,o;this.isHorizontal()?(a=this.left,o=this.right):(a=this.top,o=this.bottom,n=!n),this._startPixel=a,this._endPixel=o,this._reversePixels=n,this._length=o-a,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Wr(this.options.afterUpdate,[this])}beforeSetDimensions(){Wr(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Wr(this.options.afterSetDimensions,[this])}_callHooks(n){this.chart.notifyPlugins(n,this.getContext()),Wr(this.options[n],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Wr(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(n){const a=this.options.ticks;let o,s,e;for(o=0,s=n.length;o<s;o++)e=n[o],e.label=Wr(a.callback,[e.value,o,n],this)}afterTickToLabelConversion(){Wr(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Wr(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const n=this.options,a=n.ticks,o=W2(this.ticks.length,n.ticks.maxTicksLimit),s=a.minRotation||0,e=a.maxRotation;let m=s,v,w,N;if(!this._isVisible()||!a.display||s>=e||o<=1||!this.isHorizontal()){this.labelRotation=s;return}const S=this._getLabelSizes(),D=S.widest.width,L=S.highest.height,M=sn(this.chart.width-D,0,this.maxWidth);v=n.offset?this.maxWidth/o:M/(o-1),D+6>v&&(v=M/(o-(n.offset?.5:1)),w=this.maxHeight-qf(n.grid)-a.padding-q2(n.title,this.chart.options.font),N=Math.sqrt(D*D+L*L),m=O3(Math.min(Math.asin(sn((S.highest.height+6)/v,-1,1)),Math.asin(sn(w/N,-1,1))-Math.asin(sn(L/N,-1,1)))),m=Math.max(s,Math.min(e,m))),this.labelRotation=m}afterCalculateLabelRotation(){Wr(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Wr(this.options.beforeFit,[this])}fit(){const n={width:0,height:0},{chart:a,options:{ticks:o,title:s,grid:e}}=this,m=this._isVisible(),v=this.isHorizontal();if(m){const w=q2(s,a.options.font);if(v?(n.width=this.maxWidth,n.height=qf(e)+w):(n.height=this.maxHeight,n.width=qf(e)+w),o.display&&this.ticks.length){const{first:N,last:S,widest:D,highest:L}=this._getLabelSizes(),M=o.padding*2,F=Hl(this.labelRotation),O=Math.cos(F),P=Math.sin(F);if(v){const G=o.mirror?0:P*D.width+O*L.height;n.height=Math.min(this.maxHeight,n.height+G+M)}else{const G=o.mirror?0:O*D.width+P*L.height;n.width=Math.min(this.maxWidth,n.width+G+M)}this._calculatePadding(N,S,P,O)}}this._handleMargins(),v?(this.width=this._length=a.width-this._margins.left-this._margins.right,this.height=n.height):(this.width=n.width,this.height=this._length=a.height-this._margins.top-this._margins.bottom)}_calculatePadding(n,a,o,s){const{ticks:{align:e,padding:m},position:v}=this.options,w=this.labelRotation!==0,N=v!=="top"&&this.axis==="x";if(this.isHorizontal()){const S=this.getPixelForTick(0)-this.left,D=this.right-this.getPixelForTick(this.ticks.length-1);let L=0,M=0;w?N?(L=s*n.width,M=o*a.height):(L=o*n.height,M=s*a.width):e==="start"?M=a.width:e==="end"?L=n.width:e!=="inner"&&(L=n.width/2,M=a.width/2),this.paddingLeft=Math.max((L-S+m)*this.width/(this.width-S),0),this.paddingRight=Math.max((M-D+m)*this.width/(this.width-D),0)}else{let S=a.height/2,D=n.height/2;e==="start"?(S=0,D=n.height):e==="end"&&(S=a.height,D=0),this.paddingTop=S+m,this.paddingBottom=D+m}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Wr(this.options.afterFit,[this])}isHorizontal(){const{axis:n,position:a}=this.options;return a==="top"||a==="bottom"||n==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(n){this.beforeTickToLabelConversion(),this.generateTickLabels(n);let a,o;for(a=0,o=n.length;a<o;a++)dr(n[a].label)&&(n.splice(a,1),o--,a--);this.afterTickToLabelConversion()}_getLabelSizes(){let n=this._labelSizes;if(!n){const a=this.options.ticks.sampleSize;let o=this.ticks;a<o.length&&(o=$2(o,a)),this._labelSizes=n=this._computeLabelSizes(o,o.length,this.options.ticks.maxTicksLimit)}return n}_computeLabelSizes(n,a,o){const{ctx:s,_longestTextCache:e}=this,m=[],v=[],w=Math.floor(a/W2(a,o));let N=0,S=0,D,L,M,F,O,P,G,ae,re,Ne,xe;for(D=0;D<a;D+=w){if(F=n[D].label,O=this._resolveTickFontOptions(D),s.font=P=O.string,G=e[P]=e[P]||{data:{},gc:[]},ae=O.lineHeight,re=Ne=0,!dr(F)&&!ja(F))re=y2(s,G.data,G.gc,re,F),Ne=ae;else if(ja(F))for(L=0,M=F.length;L<M;++L)xe=F[L],!dr(xe)&&!ja(xe)&&(re=y2(s,G.data,G.gc,re,xe),Ne+=ae);m.push(re),v.push(Ne),N=Math.max(re,N),S=Math.max(Ne,S)}rN(e,a);const we=m.indexOf(N),Z=v.indexOf(S),ce=ue=>({width:m[ue]||0,height:v[ue]||0});return{first:ce(0),last:ce(a-1),widest:ce(we),highest:ce(Z),widths:m,heights:v}}getLabelForValue(n){return n}getPixelForValue(n,a){return NaN}getValueForPixel(n){}getPixelForTick(n){const a=this.ticks;return n<0||n>a.length-1?null:this.getPixelForValue(a[n].value)}getPixelForDecimal(n){this._reversePixels&&(n=1-n);const a=this._startPixel+n*this._length;return I3(this._alignToPixels?Yd(this.chart,a,0):a)}getDecimalForPixel(n){const a=(n-this._startPixel)/this._length;return this._reversePixels?1-a:a}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:n,max:a}=this;return n<0&&a<0?a:n>0&&a>0?n:0}getContext(n){const a=this.ticks||[];if(n>=0&&n<a.length){const o=a[n];return o.$context||(o.$context=nN(this.getContext(),n,o))}return this.$context||(this.$context=aN(this.chart.getContext(),this))}_tickSize(){const n=this.options.ticks,a=Hl(this.labelRotation),o=Math.abs(Math.cos(a)),s=Math.abs(Math.sin(a)),e=this._getLabelSizes(),m=n.autoSkipPadding||0,v=e?e.widest.width+m:0,w=e?e.highest.height+m:0;return this.isHorizontal()?w*o>v*s?v/o:w/s:w*s<v*o?w/o:v/s}_isVisible(){const n=this.options.display;return n!=="auto"?!!n:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(n){const a=this.axis,o=this.chart,s=this.options,{grid:e,position:m,border:v}=s,w=e.offset,N=this.isHorizontal(),D=this.ticks.length+(w?1:0),L=qf(e),M=[],F=v.setContext(this.getContext()),O=F.display?F.width:0,P=O/2,G=function(fe){return Yd(o,fe,O)};let ae,re,Ne,xe,we,Z,ce,ue,Le,be,oe,he;if(m==="top")ae=G(this.bottom),Z=this.bottom-L,ue=ae-P,be=G(n.top)+P,he=n.bottom;else if(m==="bottom")ae=G(this.top),be=n.top,he=G(n.bottom)-P,Z=ae+P,ue=this.top+L;else if(m==="left")ae=G(this.right),we=this.right-L,ce=ae-P,Le=G(n.left)+P,oe=n.right;else if(m==="right")ae=G(this.left),Le=n.left,oe=G(n.right)-P,we=ae+P,ce=this.left+L;else if(a==="x"){if(m==="center")ae=G((n.top+n.bottom)/2+.5);else if(Xs(m)){const fe=Object.keys(m)[0],_e=m[fe];ae=G(this.chart.scales[fe].getPixelForValue(_e))}be=n.top,he=n.bottom,Z=ae+P,ue=Z+L}else if(a==="y"){if(m==="center")ae=G((n.left+n.right)/2);else if(Xs(m)){const fe=Object.keys(m)[0],_e=m[fe];ae=G(this.chart.scales[fe].getPixelForValue(_e))}we=ae-P,ce=we-L,Le=n.left,oe=n.right}const ye=Ms(s.ticks.maxTicksLimit,D),Te=Math.max(1,Math.ceil(D/ye));for(re=0;re<D;re+=Te){const fe=this.getContext(re),_e=e.setContext(fe),We=v.setContext(fe),se=_e.lineWidth,me=_e.color,W=We.dash||[],pe=We.dashOffset,Me=_e.tickWidth,Se=_e.tickColor,V=_e.tickBorderDash||[],H=_e.tickBorderDashOffset;Ne=sN(this,re,w),Ne!==void 0&&(xe=Yd(o,Ne,se),N?we=ce=Le=oe=xe:Z=ue=be=he=xe,M.push({tx1:we,ty1:Z,tx2:ce,ty2:ue,x1:Le,y1:be,x2:oe,y2:he,width:se,color:me,borderDash:W,borderDashOffset:pe,tickWidth:Me,tickColor:Se,tickBorderDash:V,tickBorderDashOffset:H}))}return this._ticksLength=D,this._borderValue=ae,M}_computeLabelItems(n){const a=this.axis,o=this.options,{position:s,ticks:e}=o,m=this.isHorizontal(),v=this.ticks,{align:w,crossAlign:N,padding:S,mirror:D}=e,L=qf(o.grid),M=L+S,F=D?-S:M,O=-Hl(this.labelRotation),P=[];let G,ae,re,Ne,xe,we,Z,ce,ue,Le,be,oe,he="middle";if(s==="top")we=this.bottom-F,Z=this._getXAxisLabelAlignment();else if(s==="bottom")we=this.top+F,Z=this._getXAxisLabelAlignment();else if(s==="left"){const Te=this._getYAxisLabelAlignment(L);Z=Te.textAlign,xe=Te.x}else if(s==="right"){const Te=this._getYAxisLabelAlignment(L);Z=Te.textAlign,xe=Te.x}else if(a==="x"){if(s==="center")we=(n.top+n.bottom)/2+M;else if(Xs(s)){const Te=Object.keys(s)[0],fe=s[Te];we=this.chart.scales[Te].getPixelForValue(fe)+M}Z=this._getXAxisLabelAlignment()}else if(a==="y"){if(s==="center")xe=(n.left+n.right)/2-M;else if(Xs(s)){const Te=Object.keys(s)[0],fe=s[Te];xe=this.chart.scales[Te].getPixelForValue(fe)}Z=this._getYAxisLabelAlignment(L).textAlign}a==="y"&&(w==="start"?he="top":w==="end"&&(he="bottom"));const ye=this._getLabelSizes();for(G=0,ae=v.length;G<ae;++G){re=v[G],Ne=re.label;const Te=e.setContext(this.getContext(G));ce=this.getPixelForTick(G)+e.labelOffset,ue=this._resolveTickFontOptions(G),Le=ue.lineHeight,be=ja(Ne)?Ne.length:1;const fe=be/2,_e=Te.color,We=Te.textStrokeColor,se=Te.textStrokeWidth;let me=Z;m?(xe=ce,Z==="inner"&&(G===ae-1?me=this.options.reverse?"left":"right":G===0?me=this.options.reverse?"right":"left":me="center"),s==="top"?N==="near"||O!==0?oe=-be*Le+Le/2:N==="center"?oe=-ye.highest.height/2-fe*Le+Le:oe=-ye.highest.height+Le/2:N==="near"||O!==0?oe=Le/2:N==="center"?oe=ye.highest.height/2-fe*Le:oe=ye.highest.height-be*Le,D&&(oe*=-1),O!==0&&!Te.showLabelBackdrop&&(xe+=Le/2*Math.sin(O))):(we=ce,oe=(1-be)*Le/2);let W;if(Te.showLabelBackdrop){const pe=Di(Te.backdropPadding),Me=ye.heights[G],Se=ye.widths[G];let V=oe-pe.top,H=0-pe.left;switch(he){case"middle":V-=Me/2;break;case"bottom":V-=Me;break}switch(Z){case"center":H-=Se/2;break;case"right":H-=Se;break;case"inner":G===ae-1?H-=Se:G>0&&(H-=Se/2);break}W={left:H,top:V,width:Se+pe.width,height:Me+pe.height,color:Te.backdropColor}}P.push({label:Ne,font:ue,textOffset:oe,options:{rotation:O,color:_e,strokeColor:We,strokeWidth:se,textAlign:me,textBaseline:he,translation:[xe,we],backdrop:W}})}return P}_getXAxisLabelAlignment(){const{position:n,ticks:a}=this.options;if(-Hl(this.labelRotation))return n==="top"?"left":"right";let s="center";return a.align==="start"?s="left":a.align==="end"?s="right":a.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(n){const{position:a,ticks:{crossAlign:o,mirror:s,padding:e}}=this.options,m=this._getLabelSizes(),v=n+e,w=m.widest.width;let N,S;return a==="left"?s?(S=this.right+e,o==="near"?N="left":o==="center"?(N="center",S+=w/2):(N="right",S+=w)):(S=this.right-v,o==="near"?N="right":o==="center"?(N="center",S-=w/2):(N="left",S=this.left)):a==="right"?s?(S=this.left+e,o==="near"?N="right":o==="center"?(N="center",S-=w/2):(N="left",S-=w)):(S=this.left+v,o==="near"?N="left":o==="center"?(N="center",S+=w/2):(N="right",S=this.right)):N="right",{textAlign:N,x:S}}_computeLabelArea(){if(this.options.ticks.mirror)return;const n=this.chart,a=this.options.position;if(a==="left"||a==="right")return{top:0,left:this.left,bottom:n.height,right:this.right};if(a==="top"||a==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:n.width}}drawBackground(){const{ctx:n,options:{backgroundColor:a},left:o,top:s,width:e,height:m}=this;a&&(n.save(),n.fillStyle=a,n.fillRect(o,s,e,m),n.restore())}getLineWidthForValue(n){const a=this.options.grid;if(!this._isVisible()||!a.display)return 0;const s=this.ticks.findIndex(e=>e.value===n);return s>=0?a.setContext(this.getContext(s)).lineWidth:0}drawGrid(n){const a=this.options.grid,o=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(n));let e,m;const v=(w,N,S)=>{!S.width||!S.color||(o.save(),o.lineWidth=S.width,o.strokeStyle=S.color,o.setLineDash(S.borderDash||[]),o.lineDashOffset=S.borderDashOffset,o.beginPath(),o.moveTo(w.x,w.y),o.lineTo(N.x,N.y),o.stroke(),o.restore())};if(a.display)for(e=0,m=s.length;e<m;++e){const w=s[e];a.drawOnChartArea&&v({x:w.x1,y:w.y1},{x:w.x2,y:w.y2},w),a.drawTicks&&v({x:w.tx1,y:w.ty1},{x:w.tx2,y:w.ty2},{color:w.tickColor,width:w.tickWidth,borderDash:w.tickBorderDash,borderDashOffset:w.tickBorderDashOffset})}}drawBorder(){const{chart:n,ctx:a,options:{border:o,grid:s}}=this,e=o.setContext(this.getContext()),m=o.display?e.width:0;if(!m)return;const v=s.setContext(this.getContext(0)).lineWidth,w=this._borderValue;let N,S,D,L;this.isHorizontal()?(N=Yd(n,this.left,m)-m/2,S=Yd(n,this.right,v)+v/2,D=L=w):(D=Yd(n,this.top,m)-m/2,L=Yd(n,this.bottom,v)+v/2,N=S=w),a.save(),a.lineWidth=e.width,a.strokeStyle=e.color,a.beginPath(),a.moveTo(N,D),a.lineTo(S,L),a.stroke(),a.restore()}drawLabels(n){if(!this.options.ticks.display)return;const o=this.ctx,s=this._computeLabelArea();s&&Mp(o,s);const e=this.getLabelItems(n);for(const m of e){const v=m.options,w=m.font,N=m.label,S=m.textOffset;cm(o,N,0,S,w,v)}s&&Lp(o)}drawTitle(){const{ctx:n,options:{position:a,title:o,reverse:s}}=this;if(!o.display)return;const e=rn(o.font),m=Di(o.padding),v=o.align;let w=e.lineHeight/2;a==="bottom"||a==="center"||Xs(a)?(w+=m.bottom,ja(o.text)&&(w+=e.lineHeight*(o.text.length-1))):w+=m.top;const{titleX:N,titleY:S,maxWidth:D,rotation:L}=lN(this,w,a,v);cm(n,o.text,0,0,e,{color:o.color,maxWidth:D,rotation:L,textAlign:iN(v,a,s),textBaseline:"middle",translation:[N,S]})}draw(n){this._isVisible()&&(this.drawBackground(),this.drawGrid(n),this.drawBorder(),this.drawTitle(),this.drawLabels(n))}_layers(){const n=this.options,a=n.ticks&&n.ticks.z||0,o=Ms(n.grid&&n.grid.z,-1),s=Ms(n.border&&n.border.z,0);return!this._isVisible()||this.draw!==rh.prototype.draw?[{z:a,draw:e=>{this.draw(e)}}]:[{z:o,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:a,draw:e=>{this.drawLabels(e)}}]}getMatchingVisibleMetas(n){const a=this.chart.getSortedVisibleDatasetMetas(),o=this.axis+"AxisID",s=[];let e,m;for(e=0,m=a.length;e<m;++e){const v=a[e];v[o]===this.id&&(!n||v.type===n)&&s.push(v)}return s}_resolveTickFontOptions(n){const a=this.options.ticks.setContext(this.getContext(n));return rn(a.font)}_maxDigits(){const n=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/n}}class Jg{constructor(n,a,o){this.type=n,this.scope=a,this.override=o,this.items=Object.create(null)}isForType(n){return Object.prototype.isPrototypeOf.call(this.type.prototype,n.prototype)}register(n){const a=Object.getPrototypeOf(n);let o;dN(a)&&(o=this.register(a));const s=this.items,e=n.id,m=this.scope+"."+e;if(!e)throw new Error("class does not have id: "+n);return e in s||(s[e]=n,oN(n,m,o),this.override&&ma.override(n.id,n.overrides)),m}get(n){return this.items[n]}unregister(n){const a=this.items,o=n.id,s=this.scope;o in a&&delete a[o],s&&o in ma[s]&&(delete ma[s][o],this.override&&delete s0[o])}}function oN(l,n,a){const o=nm(Object.create(null),[a?ma.get(a):{},ma.get(n),l.defaults]);ma.set(n,o),l.defaultRoutes&&cN(n,l.defaultRoutes),l.descriptors&&ma.describe(n,l.descriptors)}function cN(l,n){Object.keys(n).forEach(a=>{const o=a.split("."),s=o.pop(),e=[l].concat(o).join("."),m=n[a].split("."),v=m.pop(),w=m.join(".");ma.route(e,s,w,v)})}function dN(l){return"id"in l&&"defaults"in l}class uN{constructor(){this.controllers=new Jg(Ic,"datasets",!0),this.elements=new Jg(Io,"elements"),this.plugins=new Jg(Object,"plugins"),this.scales=new Jg(rh,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...n){this._each("register",n)}remove(...n){this._each("unregister",n)}addControllers(...n){this._each("register",n,this.controllers)}addElements(...n){this._each("register",n,this.elements)}addPlugins(...n){this._each("register",n,this.plugins)}addScales(...n){this._each("register",n,this.scales)}getController(n){return this._get(n,this.controllers,"controller")}getElement(n){return this._get(n,this.elements,"element")}getPlugin(n){return this._get(n,this.plugins,"plugin")}getScale(n){return this._get(n,this.scales,"scale")}removeControllers(...n){this._each("unregister",n,this.controllers)}removeElements(...n){this._each("unregister",n,this.elements)}removePlugins(...n){this._each("unregister",n,this.plugins)}removeScales(...n){this._each("unregister",n,this.scales)}_each(n,a,o){[...a].forEach(s=>{const e=o||this._getRegistryForType(s);o||e.isForType(s)||e===this.plugins&&s.id?this._exec(n,e,s):vr(s,m=>{const v=o||this._getRegistryForType(m);this._exec(n,v,m)})})}_exec(n,a,o){const s=gx(n);Wr(o["before"+s],[],o),a[n](o),Wr(o["after"+s],[],o)}_getRegistryForType(n){for(let a=0;a<this._typedRegistries.length;a++){const o=this._typedRegistries[a];if(o.isForType(n))return o}return this.plugins}_get(n,a,o){const s=a.get(n);if(s===void 0)throw new Error('"'+n+'" is not a registered '+o+".");return s}}var Ul=new uN;class hN{constructor(){this._init=void 0}notify(n,a,o,s){if(a==="beforeInit"&&(this._init=this._createDescriptors(n,!0),this._notify(this._init,n,"install")),this._init===void 0)return;const e=s?this._descriptors(n).filter(s):this._descriptors(n),m=this._notify(e,n,a,o);return a==="afterDestroy"&&(this._notify(e,n,"stop"),this._notify(this._init,n,"uninstall"),this._init=void 0),m}_notify(n,a,o,s){s=s||{};for(const e of n){const m=e.plugin,v=m[o],w=[a,s,e.options];if(Wr(v,w,m)===!1&&s.cancelable)return!1}return!0}invalidate(){dr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(n){if(this._cache)return this._cache;const a=this._cache=this._createDescriptors(n);return this._notifyStateChanges(n),a}_createDescriptors(n,a){const o=n&&n.config,s=Ms(o.options&&o.options.plugins,{}),e=fN(o);return s===!1&&!a?[]:gN(n,e,s,a)}_notifyStateChanges(n){const a=this._oldCache||[],o=this._cache,s=(e,m)=>e.filter(v=>!m.some(w=>v.plugin.id===w.plugin.id));this._notify(s(a,o),n,"stop"),this._notify(s(o,a),n,"start")}}function fN(l){const n={},a=[],o=Object.keys(Ul.plugins.items);for(let e=0;e<o.length;e++)a.push(Ul.getPlugin(o[e]));const s=l.plugins||[];for(let e=0;e<s.length;e++){const m=s[e];a.indexOf(m)===-1&&(a.push(m),n[m.id]=!0)}return{plugins:a,localIds:n}}function mN(l,n){return!n&&l===!1?null:l===!0?{}:l}function gN(l,{plugins:n,localIds:a},o,s){const e=[],m=l.getContext();for(const v of n){const w=v.id,N=mN(o[w],s);N!==null&&e.push({plugin:v,options:pN(l.config,{plugin:v,local:a[w]},N,m)})}return e}function pN(l,{plugin:n,local:a},o,s){const e=l.pluginScopeKeys(n),m=l.getOptionScopes(o,e);return a&&n.defaults&&m.push(n.defaults),l.createResolver(m,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Q1(l,n){const a=ma.datasets[l]||{};return((n.datasets||{})[l]||{}).indexAxis||n.indexAxis||a.indexAxis||"x"}function xN(l,n){let a=l;return l==="_index_"?a=n:l==="_value_"&&(a=n==="x"?"y":"x"),a}function bN(l,n){return l===n?"_index_":"_value_"}function Y2(l){if(l==="x"||l==="y"||l==="r")return l}function yN(l){if(l==="top"||l==="bottom")return"x";if(l==="left"||l==="right")return"y"}function X1(l,...n){if(Y2(l))return l;for(const a of n){const o=a.axis||yN(a.position)||l.length>1&&Y2(l[0].toLowerCase());if(o)return o}throw new Error(`Cannot determine type of '${l}' axis. Please provide 'axis' or 'position' option.`)}function G2(l,n,a){if(a[n+"AxisID"]===l)return{axis:n}}function vN(l,n){if(n.data&&n.data.datasets){const a=n.data.datasets.filter(o=>o.xAxisID===l||o.yAxisID===l);if(a.length)return G2(l,"x",a[0])||G2(l,"y",a[0])}return{}}function wN(l,n){const a=s0[l.type]||{scales:{}},o=n.scales||{},s=Q1(l.type,n),e=Object.create(null);return Object.keys(o).forEach(m=>{const v=o[m];if(!Xs(v))return console.error(`Invalid scale configuration for scale: ${m}`);if(v._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${m}`);const w=X1(m,v,vN(m,l),ma.scales[v.type]),N=bN(w,s),S=a.scales||{};e[m]=Zf(Object.create(null),[{axis:w},v,S[w],S[N]])}),l.data.datasets.forEach(m=>{const v=m.type||l.type,w=m.indexAxis||Q1(v,n),S=(s0[v]||{}).scales||{};Object.keys(S).forEach(D=>{const L=xN(D,w),M=m[L+"AxisID"]||L;e[M]=e[M]||Object.create(null),Zf(e[M],[{axis:L},o[M],S[D]])})}),Object.keys(e).forEach(m=>{const v=e[m];Zf(v,[ma.scales[v.type],ma.scale])}),e}function cv(l){const n=l.options||(l.options={});n.plugins=Ms(n.plugins,{}),n.scales=wN(l,n)}function dv(l){return l=l||{},l.datasets=l.datasets||[],l.labels=l.labels||[],l}function jN(l){return l=l||{},l.data=dv(l.data),cv(l),l}const K2=new Map,uv=new Set;function Zg(l,n){let a=K2.get(l);return a||(a=n(),K2.set(l,a),uv.add(a)),a}const Yf=(l,n,a)=>{const o=Oc(n,a);o!==void 0&&l.add(o)};class NN{constructor(n){this._config=jN(n),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(n){this._config.type=n}get data(){return this._config.data}set data(n){this._config.data=dv(n)}get options(){return this._config.options}set options(n){this._config.options=n}get plugins(){return this._config.plugins}update(){const n=this._config;this.clearCache(),cv(n)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(n){return Zg(n,()=>[[`datasets.${n}`,""]])}datasetAnimationScopeKeys(n,a){return Zg(`${n}.transition.${a}`,()=>[[`datasets.${n}.transitions.${a}`,`transitions.${a}`],[`datasets.${n}`,""]])}datasetElementScopeKeys(n,a){return Zg(`${n}-${a}`,()=>[[`datasets.${n}.elements.${a}`,`datasets.${n}`,`elements.${a}`,""]])}pluginScopeKeys(n){const a=n.id,o=this.type;return Zg(`${o}-plugin-${a}`,()=>[[`plugins.${a}`,...n.additionalOptionScopes||[]]])}_cachedScopes(n,a){const o=this._scopeCache;let s=o.get(n);return(!s||a)&&(s=new Map,o.set(n,s)),s}getOptionScopes(n,a,o){const{options:s,type:e}=this,m=this._cachedScopes(n,o),v=m.get(a);if(v)return v;const w=new Set;a.forEach(S=>{n&&(w.add(n),S.forEach(D=>Yf(w,n,D))),S.forEach(D=>Yf(w,s,D)),S.forEach(D=>Yf(w,s0[e]||{},D)),S.forEach(D=>Yf(w,ma,D)),S.forEach(D=>Yf(w,G1,D))});const N=Array.from(w);return N.length===0&&N.push(Object.create(null)),uv.has(a)&&m.set(a,N),N}chartOptionScopes(){const{options:n,type:a}=this;return[n,s0[a]||{},ma.datasets[a]||{},{type:a},ma,G1]}resolveNamedOptions(n,a,o,s=[""]){const e={$shared:!0},{resolver:m,subPrefixes:v}=Q2(this._resolverCache,n,s);let w=m;if(CN(m,a)){e.$shared=!1,o=Pc(o)?o():o;const N=this.createResolver(n,o,v);w=Qu(m,o,N)}for(const N of a)e[N]=w[N];return e}createResolver(n,a,o=[""],s){const{resolver:e}=Q2(this._resolverCache,n,o);return Xs(a)?Qu(e,a,void 0,s):e}}function Q2(l,n,a){let o=l.get(n);o||(o=new Map,l.set(n,o));const s=a.join();let e=o.get(s);return e||(e={resolver:vx(n,a),subPrefixes:a.filter(v=>!v.toLowerCase().includes("hover"))},o.set(s,e)),e}const kN=l=>Xs(l)&&Object.getOwnPropertyNames(l).some(n=>Pc(l[n]));function CN(l,n){const{isScriptable:a,isIndexable:o}=Hy(l);for(const s of n){const e=a(s),m=o(s),v=(m||e)&&l[s];if(e&&(Pc(v)||kN(v))||m&&ja(v))return!0}return!1}var SN="4.5.1";const AN=["top","bottom","left","right","chartArea"];function X2(l,n){return l==="top"||l==="bottom"||AN.indexOf(l)===-1&&n==="x"}function J2(l,n){return function(a,o){return a[l]===o[l]?a[n]-o[n]:a[l]-o[l]}}function Z2(l){const n=l.chart,a=n.options.animation;n.notifyPlugins("afterRender"),Wr(a&&a.onComplete,[l],n)}function EN(l){const n=l.chart,a=n.options.animation;Wr(a&&a.onProgress,[l],n)}function hv(l){return Nx()&&typeof l=="string"?l=document.getElementById(l):l&&l.length&&(l=l[0]),l&&l.canvas&&(l=l.canvas),l}const hp={},eb=l=>{const n=hv(l);return Object.values(hp).filter(a=>a.canvas===n).pop()};function DN(l,n,a){const o=Object.keys(l);for(const s of o){const e=+s;if(e>=n){const m=l[s];delete l[s],(a>0||e>n)&&(l[e+a]=m)}}}function TN(l,n,a,o){return!a||l.type==="mouseout"?null:o?n:l}let cl=class{static defaults=ma;static instances=hp;static overrides=s0;static registry=Ul;static version=SN;static getChart=eb;static register(...n){Ul.add(...n),tb()}static unregister(...n){Ul.remove(...n),tb()}constructor(n,a){const o=this.config=new NN(a),s=hv(n),e=eb(s);if(e)throw new Error("Canvas is already in use. Chart with ID '"+e.id+"' must be destroyed before the canvas with ID '"+e.canvas.id+"' can be reused.");const m=o.createResolver(o.chartOptionScopes(),this.getContext());this.platform=new(o.platform||G6(s)),this.platform.updateConfig(o);const v=this.platform.acquireContext(s,m.aspectRatio),w=v&&v.canvas,N=w&&w.height,S=w&&w.width;if(this.id=N3(),this.ctx=v,this.canvas=w,this.width=S,this.height=N,this._options=m,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new hN,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=H3(D=>this.update(D),m.resizeDelay||0),this._dataChanges=[],hp[this.id]=this,!v||!w){console.error("Failed to create chart: can't acquire context from the given item");return}_o.listen(this,"complete",Z2),_o.listen(this,"progress",EN),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:n,maintainAspectRatio:a},width:o,height:s,_aspectRatio:e}=this;return dr(n)?a&&e?e:s?o/s:null:n}get data(){return this.config.data}set data(n){this.config.data=n}get options(){return this._options}set options(n){this.config.options=n}get registry(){return Ul}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():N2(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return v2(this.canvas,this.ctx),this}stop(){return _o.stop(this),this}resize(n,a){_o.running(this)?this._resizeBeforeDraw={width:n,height:a}:this._resize(n,a)}_resize(n,a){const o=this.options,s=this.canvas,e=o.maintainAspectRatio&&this.aspectRatio,m=this.platform.getMaximumSize(s,n,a,e),v=o.devicePixelRatio||this.platform.getDevicePixelRatio(),w=this.width?"resize":"attach";this.width=m.width,this.height=m.height,this._aspectRatio=this.aspectRatio,N2(this,v,!0)&&(this.notifyPlugins("resize",{size:m}),Wr(o.onResize,[this,m],this),this.attached&&this._doResize(w)&&this.render())}ensureScalesHaveIDs(){const a=this.options.scales||{};vr(a,(o,s)=>{o.id=s})}buildOrUpdateScales(){const n=this.options,a=n.scales,o=this.scales,s=Object.keys(o).reduce((m,v)=>(m[v]=!1,m),{});let e=[];a&&(e=e.concat(Object.keys(a).map(m=>{const v=a[m],w=X1(m,v),N=w==="r",S=w==="x";return{options:v,dposition:N?"chartArea":S?"bottom":"left",dtype:N?"radialLinear":S?"category":"linear"}}))),vr(e,m=>{const v=m.options,w=v.id,N=X1(w,v),S=Ms(v.type,m.dtype);(v.position===void 0||X2(v.position,N)!==X2(m.dposition))&&(v.position=m.dposition),s[w]=!0;let D=null;if(w in o&&o[w].type===S)D=o[w];else{const L=Ul.getScale(S);D=new L({id:w,type:S,ctx:this.ctx,chart:this}),o[D.id]=D}D.init(v,n)}),vr(s,(m,v)=>{m||delete o[v]}),vr(o,m=>{Ei.configure(this,m,m.options),Ei.addBox(this,m)})}_updateMetasets(){const n=this._metasets,a=this.data.datasets.length,o=n.length;if(n.sort((s,e)=>s.index-e.index),o>a){for(let s=a;s<o;++s)this._destroyDatasetMeta(s);n.splice(a,o-a)}this._sortedMetasets=n.slice(0).sort(J2("order","index"))}_removeUnreferencedMetasets(){const{_metasets:n,data:{datasets:a}}=this;n.length>a.length&&delete this._stacks,n.forEach((o,s)=>{a.filter(e=>e===o._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const n=[],a=this.data.datasets;let o,s;for(this._removeUnreferencedMetasets(),o=0,s=a.length;o<s;o++){const e=a[o];let m=this.getDatasetMeta(o);const v=e.type||this.config.type;if(m.type&&m.type!==v&&(this._destroyDatasetMeta(o),m=this.getDatasetMeta(o)),m.type=v,m.indexAxis=e.indexAxis||Q1(v,this.options),m.order=e.order||0,m.index=o,m.label=""+e.label,m.visible=this.isDatasetVisible(o),m.controller)m.controller.updateIndex(o),m.controller.linkScales();else{const w=Ul.getController(v),{datasetElementType:N,dataElementType:S}=ma.datasets[v];Object.assign(w,{dataElementType:Ul.getElement(S),datasetElementType:N&&Ul.getElement(N)}),m.controller=new w(this,o),n.push(m.controller)}}return this._updateMetasets(),n}_resetElements(){vr(this.data.datasets,(n,a)=>{this.getDatasetMeta(a).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(n){const a=this.config;a.update();const o=this._options=a.createResolver(a.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!o.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:n,cancelable:!0})===!1)return;const e=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let m=0;for(let N=0,S=this.data.datasets.length;N<S;N++){const{controller:D}=this.getDatasetMeta(N),L=!s&&e.indexOf(D)===-1;D.buildOrUpdateElements(L),m=Math.max(+D.getMaxOverflow(),m)}m=this._minPadding=o.layout.autoPadding?m:0,this._updateLayout(m),s||vr(e,N=>{N.reset()}),this._updateDatasets(n),this.notifyPlugins("afterUpdate",{mode:n}),this._layers.sort(J2("z","_idx"));const{_active:v,_lastEvent:w}=this;w?this._eventHandler(w,!0):v.length&&this._updateHoverStyles(v,v,!0),this.render()}_updateScales(){vr(this.scales,n=>{Ei.removeBox(this,n)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const n=this.options,a=new Set(Object.keys(this._listeners)),o=new Set(n.events);(!d2(a,o)||!!this._responsiveListeners!==n.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:n}=this,a=this._getUniformDataChanges()||[];for(const{method:o,start:s,count:e}of a){const m=o==="_removeElements"?-e:e;DN(n,s,m)}}_getUniformDataChanges(){const n=this._dataChanges;if(!n||!n.length)return;this._dataChanges=[];const a=this.data.datasets.length,o=e=>new Set(n.filter(m=>m[0]===e).map((m,v)=>v+","+m.splice(1).join(","))),s=o(0);for(let e=1;e<a;e++)if(!d2(s,o(e)))return;return Array.from(s).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(n){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ei.update(this,this.width,this.height,n);const a=this.chartArea,o=a.width<=0||a.height<=0;this._layers=[],vr(this.boxes,s=>{o&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,e)=>{s._idx=e}),this.notifyPlugins("afterLayout")}_updateDatasets(n){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:n,cancelable:!0})!==!1){for(let a=0,o=this.data.datasets.length;a<o;++a)this.getDatasetMeta(a).controller.configure();for(let a=0,o=this.data.datasets.length;a<o;++a)this._updateDataset(a,Pc(n)?n({datasetIndex:a}):n);this.notifyPlugins("afterDatasetsUpdate",{mode:n})}}_updateDataset(n,a){const o=this.getDatasetMeta(n),s={meta:o,index:n,mode:a,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(o.controller._update(a),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(_o.has(this)?this.attached&&!_o.running(this)&&_o.start(this):(this.draw(),Z2({chart:this})))}draw(){let n;if(this._resizeBeforeDraw){const{width:o,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(o,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const a=this._layers;for(n=0;n<a.length&&a[n].z<=0;++n)a[n].draw(this.chartArea);for(this._drawDatasets();n<a.length;++n)a[n].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(n){const a=this._sortedMetasets,o=[];let s,e;for(s=0,e=a.length;s<e;++s){const m=a[s];(!n||m.visible)&&o.push(m)}return o}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const n=this.getSortedVisibleDatasetMetas();for(let a=n.length-1;a>=0;--a)this._drawDataset(n[a]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(n){const a=this.ctx,o={meta:n,index:n.index,cancelable:!0},s=Zy(this,n);this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(s&&Mp(a,s),n.controller.draw(),s&&Lp(a),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(n){return om(n,this.chartArea,this._minPadding)}getElementsAtEventForMode(n,a,o,s){const e=A6.modes[a];return typeof e=="function"?e(this,n,o,s):[]}getDatasetMeta(n){const a=this.data.datasets[n],o=this._metasets;let s=o.filter(e=>e&&e._dataset===a).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:a&&a.order||0,index:n,_dataset:a,_parsed:[],_sorted:!1},o.push(s)),s}getContext(){return this.$context||(this.$context=i0(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(n){const a=this.data.datasets[n];if(!a)return!1;const o=this.getDatasetMeta(n);return typeof o.hidden=="boolean"?!o.hidden:!a.hidden}setDatasetVisibility(n,a){const o=this.getDatasetMeta(n);o.hidden=!a}toggleDataVisibility(n){this._hiddenIndices[n]=!this._hiddenIndices[n]}getDataVisibility(n){return!this._hiddenIndices[n]}_updateVisibility(n,a,o){const s=o?"show":"hide",e=this.getDatasetMeta(n),m=e.controller._resolveAnimations(void 0,s);im(a)?(e.data[a].hidden=!o,this.update()):(this.setDatasetVisibility(n,o),m.update(e,{visible:o}),this.update(v=>v.datasetIndex===n?s:void 0))}hide(n,a){this._updateVisibility(n,a,!1)}show(n,a){this._updateVisibility(n,a,!0)}_destroyDatasetMeta(n){const a=this._metasets[n];a&&a.controller&&a.controller._destroy(),delete this._metasets[n]}_stop(){let n,a;for(this.stop(),_o.remove(this),n=0,a=this.data.datasets.length;n<a;++n)this._destroyDatasetMeta(n)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:n,ctx:a}=this;this._stop(),this.config.clearCache(),n&&(this.unbindEvents(),v2(n,a),this.platform.releaseContext(a),this.canvas=null,this.ctx=null),delete hp[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...n){return this.canvas.toDataURL(...n)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const n=this._listeners,a=this.platform,o=(e,m)=>{a.addEventListener(this,e,m),n[e]=m},s=(e,m,v)=>{e.offsetX=m,e.offsetY=v,this._eventHandler(e)};vr(this.options.events,e=>o(e,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const n=this._responsiveListeners,a=this.platform,o=(w,N)=>{a.addEventListener(this,w,N),n[w]=N},s=(w,N)=>{n[w]&&(a.removeEventListener(this,w,N),delete n[w])},e=(w,N)=>{this.canvas&&this.resize(w,N)};let m;const v=()=>{s("attach",v),this.attached=!0,this.resize(),o("resize",e),o("detach",m)};m=()=>{this.attached=!1,s("resize",e),this._stop(),this._resize(0,0),o("attach",v)},a.isAttached(this.canvas)?v():m()}unbindEvents(){vr(this._listeners,(n,a)=>{this.platform.removeEventListener(this,a,n)}),this._listeners={},vr(this._responsiveListeners,(n,a)=>{this.platform.removeEventListener(this,a,n)}),this._responsiveListeners=void 0}updateHoverStyle(n,a,o){const s=o?"set":"remove";let e,m,v,w;for(a==="dataset"&&(e=this.getDatasetMeta(n[0].datasetIndex),e.controller["_"+s+"DatasetHoverStyle"]()),v=0,w=n.length;v<w;++v){m=n[v];const N=m&&this.getDatasetMeta(m.datasetIndex).controller;N&&N[s+"HoverStyle"](m.element,m.datasetIndex,m.index)}}getActiveElements(){return this._active||[]}setActiveElements(n){const a=this._active||[],o=n.map(({datasetIndex:e,index:m})=>{const v=this.getDatasetMeta(e);if(!v)throw new Error("No dataset found at index "+e);return{datasetIndex:e,element:v.data[m],index:m}});!bp(o,a)&&(this._active=o,this._lastEvent=null,this._updateHoverStyles(o,a))}notifyPlugins(n,a,o){return this._plugins.notify(this,n,a,o)}isPluginEnabled(n){return this._plugins._cache.filter(a=>a.plugin.id===n).length===1}_updateHoverStyles(n,a,o){const s=this.options.hover,e=(w,N)=>w.filter(S=>!N.some(D=>S.datasetIndex===D.datasetIndex&&S.index===D.index)),m=e(a,n),v=o?n:e(n,a);m.length&&this.updateHoverStyle(m,s.mode,!1),v.length&&s.mode&&this.updateHoverStyle(v,s.mode,!0)}_eventHandler(n,a){const o={event:n,replay:a,cancelable:!0,inChartArea:this.isPointInArea(n)},s=m=>(m.options.events||this.options.events).includes(n.native.type);if(this.notifyPlugins("beforeEvent",o,s)===!1)return;const e=this._handleEvent(n,a,o.inChartArea);return o.cancelable=!1,this.notifyPlugins("afterEvent",o,s),(e||o.changed)&&this.render(),this}_handleEvent(n,a,o){const{_active:s=[],options:e}=this,m=a,v=this._getActiveElements(n,s,o,m),w=D3(n),N=TN(n,this._lastEvent,o,w);o&&(this._lastEvent=null,Wr(e.onHover,[n,v,this],this),w&&Wr(e.onClick,[n,v,this],this));const S=!bp(v,s);return(S||a)&&(this._active=v,this._updateHoverStyles(v,s,a)),this._lastEvent=N,S}_getActiveElements(n,a,o,s){if(n.type==="mouseout")return[];if(!o)return a;const e=this.options.hover;return this.getElementsAtEventForMode(n,e.mode,e,s)}};function tb(){return vr(cl.instances,l=>l._plugins.invalidate())}function _N(l,n,a){const{startAngle:o,x:s,y:e,outerRadius:m,innerRadius:v,options:w}=n,{borderWidth:N,borderJoinStyle:S}=w,D=Math.min(N/m,ii(o-a));if(l.beginPath(),l.arc(s,e,m-N/2,o+D/2,a-D/2),v>0){const L=Math.min(N/v,ii(o-a));l.arc(s,e,v+N/2,a-L/2,o+L/2,!0)}else{const L=Math.min(N/2,m*ii(o-a));if(S==="round")l.arc(s,e,L,a-pr/2,o+pr/2,!0);else if(S==="bevel"){const M=2*L*L,F=-M*Math.cos(a+pr/2)+s,O=-M*Math.sin(a+pr/2)+e,P=M*Math.cos(o+pr/2)+s,G=M*Math.sin(o+pr/2)+e;l.lineTo(F,O),l.lineTo(P,G)}}l.closePath(),l.moveTo(0,0),l.rect(0,0,l.canvas.width,l.canvas.height),l.clip("evenodd")}function FN(l,n,a){const{startAngle:o,pixelMargin:s,x:e,y:m,outerRadius:v,innerRadius:w}=n;let N=s/v;l.beginPath(),l.arc(e,m,v,o-N,a+N),w>s?(N=s/w,l.arc(e,m,w,a+N,o-N,!0)):l.arc(e,m,s,a+Ea,o-Ea),l.closePath(),l.clip()}function MN(l){return yx(l,["outerStart","outerEnd","innerStart","innerEnd"])}function LN(l,n,a,o){const s=MN(l.options.borderRadius),e=(a-n)/2,m=Math.min(e,o*n/2),v=w=>{const N=(a-Math.min(e,w))*o/2;return sn(w,0,Math.min(e,N))};return{outerStart:v(s.outerStart),outerEnd:v(s.outerEnd),innerStart:sn(s.innerStart,0,m),innerEnd:sn(s.innerEnd,0,m)}}function Vu(l,n,a,o){return{x:a+l*Math.cos(n),y:o+l*Math.sin(n)}}function kp(l,n,a,o,s,e){const{x:m,y:v,startAngle:w,pixelMargin:N,innerRadius:S}=n,D=Math.max(n.outerRadius+o+a-N,0),L=S>0?S+o+a+N:0;let M=0;const F=s-w;if(o){const Te=S>0?S-o:0,fe=D>0?D-o:0,_e=(Te+fe)/2,We=_e!==0?F*_e/(_e+o):F;M=(F-We)/2}const O=Math.max(.001,F*D-a/pr)/D,P=(F-O)/2,G=w+P+M,ae=s-P-M,{outerStart:re,outerEnd:Ne,innerStart:xe,innerEnd:we}=LN(n,L,D,ae-G),Z=D-re,ce=D-Ne,ue=G+re/Z,Le=ae-Ne/ce,be=L+xe,oe=L+we,he=G+xe/be,ye=ae-we/oe;if(l.beginPath(),e){const Te=(ue+Le)/2;if(l.arc(m,v,D,ue,Te),l.arc(m,v,D,Te,Le),Ne>0){const se=Vu(ce,Le,m,v);l.arc(se.x,se.y,Ne,Le,ae+Ea)}const fe=Vu(oe,ae,m,v);if(l.lineTo(fe.x,fe.y),we>0){const se=Vu(oe,ye,m,v);l.arc(se.x,se.y,we,ae+Ea,ye+Math.PI)}const _e=(ae-we/L+(G+xe/L))/2;if(l.arc(m,v,L,ae-we/L,_e,!0),l.arc(m,v,L,_e,G+xe/L,!0),xe>0){const se=Vu(be,he,m,v);l.arc(se.x,se.y,xe,he+Math.PI,G-Ea)}const We=Vu(Z,G,m,v);if(l.lineTo(We.x,We.y),re>0){const se=Vu(Z,ue,m,v);l.arc(se.x,se.y,re,G-Ea,ue)}}else{l.moveTo(m,v);const Te=Math.cos(ue)*D+m,fe=Math.sin(ue)*D+v;l.lineTo(Te,fe);const _e=Math.cos(Le)*D+m,We=Math.sin(Le)*D+v;l.lineTo(_e,We)}l.closePath()}function RN(l,n,a,o,s){const{fullCircles:e,startAngle:m,circumference:v}=n;let w=n.endAngle;if(e){kp(l,n,a,o,w,s);for(let N=0;N<e;++N)l.fill();isNaN(v)||(w=m+(v%ea||ea))}return kp(l,n,a,o,w,s),l.fill(),w}function ON(l,n,a,o,s){const{fullCircles:e,startAngle:m,circumference:v,options:w}=n,{borderWidth:N,borderJoinStyle:S,borderDash:D,borderDashOffset:L,borderRadius:M}=w,F=w.borderAlign==="inner";if(!N)return;l.setLineDash(D||[]),l.lineDashOffset=L,F?(l.lineWidth=N*2,l.lineJoin=S||"round"):(l.lineWidth=N,l.lineJoin=S||"bevel");let O=n.endAngle;if(e){kp(l,n,a,o,O,s);for(let P=0;P<e;++P)l.stroke();isNaN(v)||(O=m+(v%ea||ea))}F&&FN(l,n,O),w.selfJoin&&O-m>=pr&&M===0&&S!=="miter"&&_N(l,n,O),e||(kp(l,n,a,o,O,s),l.stroke())}class bm extends Io{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:n=>n!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(n){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,a,o){const s=this.getProps(["x","y"],o),{angle:e,distance:m}=Fy(s,{x:n,y:a}),{startAngle:v,endAngle:w,innerRadius:N,outerRadius:S,circumference:D}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],o),L=(this.options.spacing+this.options.borderWidth)/2,M=Ms(D,w-v),F=lm(e,v,w)&&v!==w,O=M>=ea||F,P=Ro(m,N+L,S+L);return O&&P}getCenterPoint(n){const{x:a,y:o,startAngle:s,endAngle:e,innerRadius:m,outerRadius:v}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:w,spacing:N}=this.options,S=(s+e)/2,D=(m+v+N+w)/2;return{x:a+Math.cos(S)*D,y:o+Math.sin(S)*D}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:a,circumference:o}=this,s=(a.offset||0)/4,e=(a.spacing||0)/2,m=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=o>ea?Math.floor(o/ea):0,o===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const v=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(v)*s,Math.sin(v)*s);const w=1-Math.sin(Math.min(pr,o||0)),N=s*w;n.fillStyle=a.backgroundColor,n.strokeStyle=a.borderColor,RN(n,this,N,e,m),ON(n,this,N,e,m),n.restore()}}function fv(l,n,a=n){l.lineCap=Ms(a.borderCapStyle,n.borderCapStyle),l.setLineDash(Ms(a.borderDash,n.borderDash)),l.lineDashOffset=Ms(a.borderDashOffset,n.borderDashOffset),l.lineJoin=Ms(a.borderJoinStyle,n.borderJoinStyle),l.lineWidth=Ms(a.borderWidth,n.borderWidth),l.strokeStyle=Ms(a.borderColor,n.borderColor)}function PN(l,n,a){l.lineTo(a.x,a.y)}function IN(l){return l.stepped?ej:l.tension||l.cubicInterpolationMode==="monotone"?tj:PN}function mv(l,n,a={}){const o=l.length,{start:s=0,end:e=o-1}=a,{start:m,end:v}=n,w=Math.max(s,m),N=Math.min(e,v),S=s<m&&e<m||s>v&&e>v;return{count:o,start:w,loop:n.loop,ilen:N<w&&!S?o+N-w:N-w}}function BN(l,n,a,o){const{points:s,options:e}=n,{count:m,start:v,loop:w,ilen:N}=mv(s,a,o),S=IN(e);let{move:D=!0,reverse:L}=o||{},M,F,O;for(M=0;M<=N;++M)F=s[(v+(L?N-M:M))%m],!F.skip&&(D?(l.moveTo(F.x,F.y),D=!1):S(l,O,F,L,e.stepped),O=F);return w&&(F=s[(v+(L?N:0))%m],S(l,O,F,L,e.stepped)),!!w}function zN(l,n,a,o){const s=n.points,{count:e,start:m,ilen:v}=mv(s,a,o),{move:w=!0,reverse:N}=o||{};let S=0,D=0,L,M,F,O,P,G;const ae=Ne=>(m+(N?v-Ne:Ne))%e,re=()=>{O!==P&&(l.lineTo(S,P),l.lineTo(S,O),l.lineTo(S,G))};for(w&&(M=s[ae(0)],l.moveTo(M.x,M.y)),L=0;L<=v;++L){if(M=s[ae(L)],M.skip)continue;const Ne=M.x,xe=M.y,we=Ne|0;we===F?(xe<O?O=xe:xe>P&&(P=xe),S=(D*S+Ne)/++D):(re(),l.lineTo(Ne,xe),F=we,D=0,O=P=xe),G=xe}re()}function J1(l){const n=l.options,a=n.borderDash&&n.borderDash.length;return!l._decimated&&!l._loop&&!n.tension&&n.cubicInterpolationMode!=="monotone"&&!n.stepped&&!a?zN:BN}function UN(l){return l.stepped?Mj:l.tension||l.cubicInterpolationMode==="monotone"?Lj:Qd}function HN(l,n,a,o){let s=n._path;s||(s=n._path=new Path2D,n.path(s,a,o)&&s.closePath()),fv(l,n.options),l.stroke(s)}function VN(l,n,a,o){const{segments:s,options:e}=n,m=J1(n);for(const v of s)fv(l,e,v.style),l.beginPath(),m(l,n,v,{start:a,end:a+o-1})&&l.closePath(),l.stroke()}const WN=typeof Path2D=="function";function $N(l,n,a,o){WN&&!n.options.segment?HN(l,n,a,o):VN(l,n,a,o)}class dl extends Io{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:n=>n!=="borderDash"&&n!=="fill"};constructor(n){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,n&&Object.assign(this,n)}updateControlPoints(n,a){const o=this.options;if((o.tension||o.cubicInterpolationMode==="monotone")&&!o.stepped&&!this._pointsUpdated){const s=o.spanGaps?this._loop:this._fullLoop;Cj(this._points,o,n,s,a),this._pointsUpdated=!0}}set points(n){this._points=n,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=zj(this,this.options.segment))}first(){const n=this.segments,a=this.points;return n.length&&a[n[0].start]}last(){const n=this.segments,a=this.points,o=n.length;return o&&a[n[o-1].end]}interpolate(n,a){const o=this.options,s=n[a],e=this.points,m=Jy(this,{property:a,start:s,end:s});if(!m.length)return;const v=[],w=UN(o);let N,S;for(N=0,S=m.length;N<S;++N){const{start:D,end:L}=m[N],M=e[D],F=e[L];if(M===F){v.push(M);continue}const O=Math.abs((s-M[a])/(F[a]-M[a])),P=w(M,F,O,o.stepped);P[a]=n[a],v.push(P)}return v.length===1?v[0]:v}pathSegment(n,a,o){return J1(this)(n,this,a,o)}path(n,a,o){const s=this.segments,e=J1(this);let m=this._loop;a=a||0,o=o||this.points.length-a;for(const v of s)m&=e(n,this,v,{start:a,end:a+o-1});return!!m}draw(n,a,o,s){const e=this.options||{};(this.points||[]).length&&e.borderWidth&&(n.save(),$N(n,this,o,s),n.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function sb(l,n,a,o){const s=l.options,{[a]:e}=l.getProps([a],o);return Math.abs(n-e)<s.radius+s.hitRadius}class Bc extends Io{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(n){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,a,o){const s=this.options,{x:e,y:m}=this.getProps(["x","y"],o);return Math.pow(n-e,2)+Math.pow(a-m,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(n,a){return sb(this,n,"x",a)}inYRange(n,a){return sb(this,n,"y",a)}getCenterPoint(n){const{x:a,y:o}=this.getProps(["x","y"],n);return{x:a,y:o}}size(n){n=n||this.options||{};let a=n.radius||0;a=Math.max(a,a&&n.hoverRadius||0);const o=a&&n.borderWidth||0;return(a+o)*2}draw(n,a){const o=this.options;this.skip||o.radius<.1||!om(this,a,this.size(o)/2)||(n.strokeStyle=o.borderColor,n.lineWidth=o.borderWidth,n.fillStyle=o.backgroundColor,K1(n,o,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}function gv(l,n){const{x:a,y:o,base:s,width:e,height:m}=l.getProps(["x","y","base","width","height"],n);let v,w,N,S,D;return l.horizontal?(D=m/2,v=Math.min(a,s),w=Math.max(a,s),N=o-D,S=o+D):(D=e/2,v=a-D,w=a+D,N=Math.min(o,s),S=Math.max(o,s)),{left:v,top:N,right:w,bottom:S}}function Lc(l,n,a,o){return l?0:sn(n,a,o)}function qN(l,n,a){const o=l.options.borderWidth,s=l.borderSkipped,e=Uy(o);return{t:Lc(s.top,e.top,0,a),r:Lc(s.right,e.right,0,n),b:Lc(s.bottom,e.bottom,0,a),l:Lc(s.left,e.left,0,n)}}function YN(l,n,a){const{enableBorderRadius:o}=l.getProps(["enableBorderRadius"]),s=l.options.borderRadius,e=qu(s),m=Math.min(n,a),v=l.borderSkipped,w=o||Xs(s);return{topLeft:Lc(!w||v.top||v.left,e.topLeft,0,m),topRight:Lc(!w||v.top||v.right,e.topRight,0,m),bottomLeft:Lc(!w||v.bottom||v.left,e.bottomLeft,0,m),bottomRight:Lc(!w||v.bottom||v.right,e.bottomRight,0,m)}}function GN(l){const n=gv(l),a=n.right-n.left,o=n.bottom-n.top,s=qN(l,a/2,o/2),e=YN(l,a/2,o/2);return{outer:{x:n.left,y:n.top,w:a,h:o,radius:e},inner:{x:n.left+s.l,y:n.top+s.t,w:a-s.l-s.r,h:o-s.t-s.b,radius:{topLeft:Math.max(0,e.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,e.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,e.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,e.bottomRight-Math.max(s.b,s.r))}}}}function A1(l,n,a,o){const s=n===null,e=a===null,v=l&&!(s&&e)&&gv(l,o);return v&&(s||Ro(n,v.left,v.right))&&(e||Ro(a,v.top,v.bottom))}function KN(l){return l.topLeft||l.topRight||l.bottomLeft||l.bottomRight}function QN(l,n){l.rect(n.x,n.y,n.w,n.h)}function E1(l,n,a={}){const o=l.x!==a.x?-n:0,s=l.y!==a.y?-n:0,e=(l.x+l.w!==a.x+a.w?n:0)-o,m=(l.y+l.h!==a.y+a.h?n:0)-s;return{x:l.x+o,y:l.y+s,w:l.w+e,h:l.h+m,radius:l.radius}}class zc extends Io{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(n){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,n&&Object.assign(this,n)}draw(n){const{inflateAmount:a,options:{borderColor:o,backgroundColor:s}}=this,{inner:e,outer:m}=GN(this),v=KN(m.radius)?wp:QN;n.save(),(m.w!==e.w||m.h!==e.h)&&(n.beginPath(),v(n,E1(m,a,e)),n.clip(),v(n,E1(e,-a,m)),n.fillStyle=o,n.fill("evenodd")),n.beginPath(),v(n,E1(e,a)),n.fillStyle=s,n.fill(),n.restore()}inRange(n,a,o){return A1(this,n,a,o)}inXRange(n,a){return A1(this,n,null,a)}inYRange(n,a){return A1(this,null,n,a)}getCenterPoint(n){const{x:a,y:o,base:s,horizontal:e}=this.getProps(["x","y","base","horizontal"],n);return{x:e?(a+s)/2:a,y:e?o:(o+s)/2}}getRange(n){return n==="x"?this.width/2:this.height/2}}function XN(l,n,a){const o=l.segments,s=l.points,e=n.points,m=[];for(const v of o){let{start:w,end:N}=v;N=Pp(w,N,s);const S=Z1(a,s[w],s[N],v.loop);if(!n.segments){m.push({source:v,target:S,start:s[w],end:s[N]});continue}const D=Jy(n,S);for(const L of D){const M=Z1(a,e[L.start],e[L.end],L.loop),F=Xy(v,s,M);for(const O of F)m.push({source:O,target:L,start:{[a]:rb(S,M,"start",Math.max)},end:{[a]:rb(S,M,"end",Math.min)}})}}return m}function Z1(l,n,a,o){if(o)return;let s=n[l],e=a[l];return l==="angle"&&(s=ii(s),e=ii(e)),{property:l,start:s,end:e}}function JN(l,n){const{x:a=null,y:o=null}=l||{},s=n.points,e=[];return n.segments.forEach(({start:m,end:v})=>{v=Pp(m,v,s);const w=s[m],N=s[v];o!==null?(e.push({x:w.x,y:o}),e.push({x:N.x,y:o})):a!==null&&(e.push({x:a,y:w.y}),e.push({x:a,y:N.y}))}),e}function Pp(l,n,a){for(;n>l;n--){const o=a[n];if(!isNaN(o.x)&&!isNaN(o.y))break}return n}function rb(l,n,a,o){return l&&n?o(l[a],n[a]):l?l[a]:n?n[a]:0}function pv(l,n){let a=[],o=!1;return ja(l)?(o=!0,a=l):a=JN(l,n),a.length?new dl({points:a,options:{tension:0},_loop:o,_fullLoop:o}):null}function ab(l){return l&&l.fill!==!1}function ZN(l,n,a){let s=l[n].fill;const e=[n];let m;if(!a)return s;for(;s!==!1&&e.indexOf(s)===-1;){if(!an(s))return s;if(m=l[s],!m)return!1;if(m.visible)return s;e.push(s),s=m.fill}return!1}function ek(l,n,a){const o=ak(l);if(Xs(o))return isNaN(o.value)?!1:o;let s=parseFloat(o);return an(s)&&Math.floor(s)===s?tk(o[0],n,s,a):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}function tk(l,n,a,o){return(l==="-"||l==="+")&&(a=n+a),a===n||a<0||a>=o?!1:a}function sk(l,n){let a=null;return l==="start"?a=n.bottom:l==="end"?a=n.top:Xs(l)?a=n.getPixelForValue(l.value):n.getBasePixel&&(a=n.getBasePixel()),a}function rk(l,n,a){let o;return l==="start"?o=a:l==="end"?o=n.options.reverse?n.min:n.max:Xs(l)?o=l.value:o=n.getBaseValue(),o}function ak(l){const n=l.options,a=n.fill;let o=Ms(a&&a.target,a);return o===void 0&&(o=!!n.backgroundColor),o===!1||o===null?!1:o===!0?"origin":o}function nk(l){const{scale:n,index:a,line:o}=l,s=[],e=o.segments,m=o.points,v=ik(n,a);v.push(pv({x:null,y:n.bottom},o));for(let w=0;w<e.length;w++){const N=e[w];for(let S=N.start;S<=N.end;S++)lk(s,m[S],v)}return new dl({points:s,options:{}})}function ik(l,n){const a=[],o=l.getMatchingVisibleMetas("line");for(let s=0;s<o.length;s++){const e=o[s];if(e.index===n)break;e.hidden||a.unshift(e.dataset)}return a}function lk(l,n,a){const o=[];for(let s=0;s<a.length;s++){const e=a[s],{first:m,last:v,point:w}=ok(e,n,"x");if(!(!w||m&&v)){if(m)o.unshift(w);else if(l.push(w),!v)break}}l.push(...o)}function ok(l,n,a){const o=l.interpolate(n,a);if(!o)return{};const s=o[a],e=l.segments,m=l.points;let v=!1,w=!1;for(let N=0;N<e.length;N++){const S=e[N],D=m[S.start][a],L=m[S.end][a];if(Ro(s,D,L)){v=s===D,w=s===L;break}}return{first:v,last:w,point:o}}class xv{constructor(n){this.x=n.x,this.y=n.y,this.radius=n.radius}pathSegment(n,a,o){const{x:s,y:e,radius:m}=this;return a=a||{start:0,end:ea},n.arc(s,e,m,a.end,a.start,!0),!o.bounds}interpolate(n){const{x:a,y:o,radius:s}=this,e=n.angle;return{x:a+Math.cos(e)*s,y:o+Math.sin(e)*s,angle:e}}}function ck(l){const{chart:n,fill:a,line:o}=l;if(an(a))return dk(n,a);if(a==="stack")return nk(l);if(a==="shape")return!0;const s=uk(l);return s instanceof xv?s:pv(s,o)}function dk(l,n){const a=l.getDatasetMeta(n);return a&&l.isDatasetVisible(n)?a.dataset:null}function uk(l){return(l.scale||{}).getPointPositionForValue?fk(l):hk(l)}function hk(l){const{scale:n={},fill:a}=l,o=sk(a,n);if(an(o)){const s=n.isHorizontal();return{x:s?o:null,y:s?null:o}}return null}function fk(l){const{scale:n,fill:a}=l,o=n.options,s=n.getLabels().length,e=o.reverse?n.max:n.min,m=rk(a,n,e),v=[];if(o.grid.circular){const w=n.getPointPositionForValue(0,e);return new xv({x:w.x,y:w.y,radius:n.getDistanceFromCenterForValue(m)})}for(let w=0;w<s;++w)v.push(n.getPointPositionForValue(w,m));return v}function D1(l,n,a){const o=ck(n),{chart:s,index:e,line:m,scale:v,axis:w}=n,N=m.options,S=N.fill,D=N.backgroundColor,{above:L=D,below:M=D}=S||{},F=s.getDatasetMeta(e),O=Zy(s,F);o&&m.points.length&&(Mp(l,a),mk(l,{line:m,target:o,above:L,below:M,area:a,scale:v,axis:w,clip:O}),Lp(l))}function mk(l,n){const{line:a,target:o,above:s,below:e,area:m,scale:v,clip:w}=n,N=a._loop?"angle":n.axis;l.save();let S=e;e!==s&&(N==="x"?(nb(l,o,m.top),T1(l,{line:a,target:o,color:s,scale:v,property:N,clip:w}),l.restore(),l.save(),nb(l,o,m.bottom)):N==="y"&&(ib(l,o,m.left),T1(l,{line:a,target:o,color:e,scale:v,property:N,clip:w}),l.restore(),l.save(),ib(l,o,m.right),S=s)),T1(l,{line:a,target:o,color:S,scale:v,property:N,clip:w}),l.restore()}function nb(l,n,a){const{segments:o,points:s}=n;let e=!0,m=!1;l.beginPath();for(const v of o){const{start:w,end:N}=v,S=s[w],D=s[Pp(w,N,s)];e?(l.moveTo(S.x,S.y),e=!1):(l.lineTo(S.x,a),l.lineTo(S.x,S.y)),m=!!n.pathSegment(l,v,{move:m}),m?l.closePath():l.lineTo(D.x,a)}l.lineTo(n.first().x,a),l.closePath(),l.clip()}function ib(l,n,a){const{segments:o,points:s}=n;let e=!0,m=!1;l.beginPath();for(const v of o){const{start:w,end:N}=v,S=s[w],D=s[Pp(w,N,s)];e?(l.moveTo(S.x,S.y),e=!1):(l.lineTo(a,S.y),l.lineTo(S.x,S.y)),m=!!n.pathSegment(l,v,{move:m}),m?l.closePath():l.lineTo(a,D.y)}l.lineTo(a,n.first().y),l.closePath(),l.clip()}function T1(l,n){const{line:a,target:o,property:s,color:e,scale:m,clip:v}=n,w=XN(a,o,s);for(const{source:N,target:S,start:D,end:L}of w){const{style:{backgroundColor:M=e}={}}=N,F=o!==!0;l.save(),l.fillStyle=M,gk(l,m,v,F&&Z1(s,D,L)),l.beginPath();const O=!!a.pathSegment(l,N);let P;if(F){O?l.closePath():lb(l,o,L,s);const G=!!o.pathSegment(l,S,{move:O,reverse:!0});P=O&&G,P||lb(l,o,D,s)}l.closePath(),l.fill(P?"evenodd":"nonzero"),l.restore()}}function gk(l,n,a,o){const s=n.chart.chartArea,{property:e,start:m,end:v}=o||{};if(e==="x"||e==="y"){let w,N,S,D;e==="x"?(w=m,N=s.top,S=v,D=s.bottom):(w=s.left,N=m,S=s.right,D=v),l.beginPath(),a&&(w=Math.max(w,a.left),S=Math.min(S,a.right),N=Math.max(N,a.top),D=Math.min(D,a.bottom)),l.rect(w,N,S-w,D-N),l.clip()}}function lb(l,n,a,o){const s=n.interpolate(a,o);s&&l.lineTo(s.x,s.y)}var Ip={id:"filler",afterDatasetsUpdate(l,n,a){const o=(l.data.datasets||[]).length,s=[];let e,m,v,w;for(m=0;m<o;++m)e=l.getDatasetMeta(m),v=e.dataset,w=null,v&&v.options&&v instanceof dl&&(w={visible:l.isDatasetVisible(m),index:m,fill:ek(v,m,o),chart:l,axis:e.controller.options.indexAxis,scale:e.vScale,line:v}),e.$filler=w,s.push(w);for(m=0;m<o;++m)w=s[m],!(!w||w.fill===!1)&&(w.fill=ZN(s,m,a.propagate))},beforeDraw(l,n,a){const o=a.drawTime==="beforeDraw",s=l.getSortedVisibleDatasetMetas(),e=l.chartArea;for(let m=s.length-1;m>=0;--m){const v=s[m].$filler;v&&(v.line.updateControlPoints(e,v.axis),o&&v.fill&&D1(l.ctx,v,e))}},beforeDatasetsDraw(l,n,a){if(a.drawTime!=="beforeDatasetsDraw")return;const o=l.getSortedVisibleDatasetMetas();for(let s=o.length-1;s>=0;--s){const e=o[s].$filler;ab(e)&&D1(l.ctx,e,l.chartArea)}},beforeDatasetDraw(l,n,a){const o=n.meta.$filler;!ab(o)||a.drawTime!=="beforeDatasetDraw"||D1(l.ctx,o,l.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const ob=(l,n)=>{let{boxHeight:a=n,boxWidth:o=n}=l;return l.usePointStyle&&(a=Math.min(a,n),o=l.pointStyleWidth||Math.min(o,n)),{boxWidth:o,boxHeight:a,itemHeight:Math.max(n,a)}},pk=(l,n)=>l!==null&&n!==null&&l.datasetIndex===n.datasetIndex&&l.index===n.index;class cb extends Io{constructor(n){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,a,o){this.maxWidth=n,this.maxHeight=a,this._margins=o,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const n=this.options.labels||{};let a=Wr(n.generateLabels,[this.chart],this)||[];n.filter&&(a=a.filter(o=>n.filter(o,this.chart.data))),n.sort&&(a=a.sort((o,s)=>n.sort(o,s,this.chart.data))),this.options.reverse&&a.reverse(),this.legendItems=a}fit(){const{options:n,ctx:a}=this;if(!n.display){this.width=this.height=0;return}const o=n.labels,s=rn(o.font),e=s.size,m=this._computeTitleHeight(),{boxWidth:v,itemHeight:w}=ob(o,e);let N,S;a.font=s.string,this.isHorizontal()?(N=this.maxWidth,S=this._fitRows(m,e,v,w)+10):(S=this.maxHeight,N=this._fitCols(m,s,v,w)+10),this.width=Math.min(N,n.maxWidth||this.maxWidth),this.height=Math.min(S,n.maxHeight||this.maxHeight)}_fitRows(n,a,o,s){const{ctx:e,maxWidth:m,options:{labels:{padding:v}}}=this,w=this.legendHitBoxes=[],N=this.lineWidths=[0],S=s+v;let D=n;e.textAlign="left",e.textBaseline="middle";let L=-1,M=-S;return this.legendItems.forEach((F,O)=>{const P=o+a/2+e.measureText(F.text).width;(O===0||N[N.length-1]+P+2*v>m)&&(D+=S,N[N.length-(O>0?0:1)]=0,M+=S,L++),w[O]={left:0,top:M,row:L,width:P,height:s},N[N.length-1]+=P+v}),D}_fitCols(n,a,o,s){const{ctx:e,maxHeight:m,options:{labels:{padding:v}}}=this,w=this.legendHitBoxes=[],N=this.columnSizes=[],S=m-n;let D=v,L=0,M=0,F=0,O=0;return this.legendItems.forEach((P,G)=>{const{itemWidth:ae,itemHeight:re}=xk(o,a,e,P,s);G>0&&M+re+2*v>S&&(D+=L+v,N.push({width:L,height:M}),F+=L+v,O++,L=M=0),w[G]={left:F,top:M,col:O,width:ae,height:re},L=Math.max(L,ae),M+=re+v}),D+=L,N.push({width:L,height:M}),D}adjustHitBoxes(){if(!this.options.display)return;const n=this._computeTitleHeight(),{legendHitBoxes:a,options:{align:o,labels:{padding:s},rtl:e}}=this,m=Yu(e,this.left,this.width);if(this.isHorizontal()){let v=0,w=en(o,this.left+s,this.right-this.lineWidths[v]);for(const N of a)v!==N.row&&(v=N.row,w=en(o,this.left+s,this.right-this.lineWidths[v])),N.top+=this.top+n+s,N.left=m.leftForLtr(m.x(w),N.width),w+=N.width+s}else{let v=0,w=en(o,this.top+n+s,this.bottom-this.columnSizes[v].height);for(const N of a)N.col!==v&&(v=N.col,w=en(o,this.top+n+s,this.bottom-this.columnSizes[v].height)),N.top=w,N.left+=this.left+s,N.left=m.leftForLtr(m.x(N.left),N.width),w+=N.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const n=this.ctx;Mp(n,this),this._draw(),Lp(n)}}_draw(){const{options:n,columnSizes:a,lineWidths:o,ctx:s}=this,{align:e,labels:m}=n,v=ma.color,w=Yu(n.rtl,this.left,this.width),N=rn(m.font),{padding:S}=m,D=N.size,L=D/2;let M;this.drawTitle(),s.textAlign=w.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=N.string;const{boxWidth:F,boxHeight:O,itemHeight:P}=ob(m,D),G=function(we,Z,ce){if(isNaN(F)||F<=0||isNaN(O)||O<0)return;s.save();const ue=Ms(ce.lineWidth,1);if(s.fillStyle=Ms(ce.fillStyle,v),s.lineCap=Ms(ce.lineCap,"butt"),s.lineDashOffset=Ms(ce.lineDashOffset,0),s.lineJoin=Ms(ce.lineJoin,"miter"),s.lineWidth=ue,s.strokeStyle=Ms(ce.strokeStyle,v),s.setLineDash(Ms(ce.lineDash,[])),m.usePointStyle){const Le={radius:O*Math.SQRT2/2,pointStyle:ce.pointStyle,rotation:ce.rotation,borderWidth:ue},be=w.xPlus(we,F/2),oe=Z+L;zy(s,Le,be,oe,m.pointStyleWidth&&F)}else{const Le=Z+Math.max((D-O)/2,0),be=w.leftForLtr(we,F),oe=qu(ce.borderRadius);s.beginPath(),Object.values(oe).some(he=>he!==0)?wp(s,{x:be,y:Le,w:F,h:O,radius:oe}):s.rect(be,Le,F,O),s.fill(),ue!==0&&s.stroke()}s.restore()},ae=function(we,Z,ce){cm(s,ce.text,we,Z+P/2,N,{strikethrough:ce.hidden,textAlign:w.textAlign(ce.textAlign)})},re=this.isHorizontal(),Ne=this._computeTitleHeight();re?M={x:en(e,this.left+S,this.right-o[0]),y:this.top+S+Ne,line:0}:M={x:this.left+S,y:en(e,this.top+Ne+S,this.bottom-a[0].height),line:0},Gy(this.ctx,n.textDirection);const xe=P+S;this.legendItems.forEach((we,Z)=>{s.strokeStyle=we.fontColor,s.fillStyle=we.fontColor;const ce=s.measureText(we.text).width,ue=w.textAlign(we.textAlign||(we.textAlign=m.textAlign)),Le=F+L+ce;let be=M.x,oe=M.y;w.setWidth(this.width),re?Z>0&&be+Le+S>this.right&&(oe=M.y+=xe,M.line++,be=M.x=en(e,this.left+S,this.right-o[M.line])):Z>0&&oe+xe>this.bottom&&(be=M.x=be+a[M.line].width+S,M.line++,oe=M.y=en(e,this.top+Ne+S,this.bottom-a[M.line].height));const he=w.x(be);if(G(he,oe,we),be=V3(ue,be+F+L,re?be+Le:this.right,n.rtl),ae(w.x(be),oe,we),re)M.x+=Le+S;else if(typeof we.text!="string"){const ye=N.lineHeight;M.y+=bv(we,ye)+S}else M.y+=xe}),Ky(this.ctx,n.textDirection)}drawTitle(){const n=this.options,a=n.title,o=rn(a.font),s=Di(a.padding);if(!a.display)return;const e=Yu(n.rtl,this.left,this.width),m=this.ctx,v=a.position,w=o.size/2,N=s.top+w;let S,D=this.left,L=this.width;if(this.isHorizontal())L=Math.max(...this.lineWidths),S=this.top+N,D=en(n.align,D,this.right-L);else{const F=this.columnSizes.reduce((O,P)=>Math.max(O,P.height),0);S=N+en(n.align,this.top,this.bottom-F-n.labels.padding-this._computeTitleHeight())}const M=en(v,D,D+L);m.textAlign=e.textAlign(xx(v)),m.textBaseline="middle",m.strokeStyle=a.color,m.fillStyle=a.color,m.font=o.string,cm(m,a.text,M,S,o)}_computeTitleHeight(){const n=this.options.title,a=rn(n.font),o=Di(n.padding);return n.display?a.lineHeight+o.height:0}_getLegendItemAt(n,a){let o,s,e;if(Ro(n,this.left,this.right)&&Ro(a,this.top,this.bottom)){for(e=this.legendHitBoxes,o=0;o<e.length;++o)if(s=e[o],Ro(n,s.left,s.left+s.width)&&Ro(a,s.top,s.top+s.height))return this.legendItems[o]}return null}handleEvent(n){const a=this.options;if(!vk(n.type,a))return;const o=this._getLegendItemAt(n.x,n.y);if(n.type==="mousemove"||n.type==="mouseout"){const s=this._hoveredItem,e=pk(s,o);s&&!e&&Wr(a.onLeave,[n,s,this],this),this._hoveredItem=o,o&&!e&&Wr(a.onHover,[n,o,this],this)}else o&&Wr(a.onClick,[n,o,this],this)}}function xk(l,n,a,o,s){const e=bk(o,l,n,a),m=yk(s,o,n.lineHeight);return{itemWidth:e,itemHeight:m}}function bk(l,n,a,o){let s=l.text;return s&&typeof s!="string"&&(s=s.reduce((e,m)=>e.length>m.length?e:m)),n+a.size/2+o.measureText(s).width}function yk(l,n,a){let o=l;return typeof n.text!="string"&&(o=bv(n,a)),o}function bv(l,n){const a=l.text?l.text.length:0;return n*a}function vk(l,n){return!!((l==="mousemove"||l==="mouseout")&&(n.onHover||n.onLeave)||n.onClick&&(l==="click"||l==="mouseup"))}var Uc={id:"legend",_element:cb,start(l,n,a){const o=l.legend=new cb({ctx:l.ctx,options:a,chart:l});Ei.configure(l,o,a),Ei.addBox(l,o)},stop(l){Ei.removeBox(l,l.legend),delete l.legend},beforeUpdate(l,n,a){const o=l.legend;Ei.configure(l,o,a),o.options=a},afterUpdate(l){const n=l.legend;n.buildLabels(),n.adjustHitBoxes()},afterEvent(l,n){n.replay||l.legend.handleEvent(n.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(l,n,a){const o=n.datasetIndex,s=a.chart;s.isDatasetVisible(o)?(s.hide(o),n.hidden=!0):(s.show(o),n.hidden=!1)},onHover:null,onLeave:null,labels:{color:l=>l.chart.options.color,boxWidth:40,padding:10,generateLabels(l){const n=l.data.datasets,{labels:{usePointStyle:a,pointStyle:o,textAlign:s,color:e,useBorderRadius:m,borderRadius:v}}=l.legend.options;return l._getSortedDatasetMetas().map(w=>{const N=w.controller.getStyle(a?0:void 0),S=Di(N.borderWidth);return{text:n[w.index].label,fillStyle:N.backgroundColor,fontColor:e,hidden:!w.visible,lineCap:N.borderCapStyle,lineDash:N.borderDash,lineDashOffset:N.borderDashOffset,lineJoin:N.borderJoinStyle,lineWidth:(S.width+S.height)/4,strokeStyle:N.borderColor,pointStyle:o||N.pointStyle,rotation:N.rotation,textAlign:s||N.textAlign,borderRadius:m&&(v||N.borderRadius),datasetIndex:w.index}},this)}},title:{color:l=>l.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:l=>!l.startsWith("on"),labels:{_scriptable:l=>!["generateLabels","filter","sort"].includes(l)}}};class yv extends Io{constructor(n){super(),this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,a){const o=this.options;if(this.left=0,this.top=0,!o.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=n,this.height=this.bottom=a;const s=ja(o.text)?o.text.length:1;this._padding=Di(o.padding);const e=s*rn(o.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=e:this.width=e}isHorizontal(){const n=this.options.position;return n==="top"||n==="bottom"}_drawArgs(n){const{top:a,left:o,bottom:s,right:e,options:m}=this,v=m.align;let w=0,N,S,D;return this.isHorizontal()?(S=en(v,o,e),D=a+n,N=e-o):(m.position==="left"?(S=o+n,D=en(v,s,a),w=pr*-.5):(S=e-n,D=en(v,a,s),w=pr*.5),N=s-a),{titleX:S,titleY:D,maxWidth:N,rotation:w}}draw(){const n=this.ctx,a=this.options;if(!a.display)return;const o=rn(a.font),e=o.lineHeight/2+this._padding.top,{titleX:m,titleY:v,maxWidth:w,rotation:N}=this._drawArgs(e);cm(n,a.text,0,0,o,{color:a.color,maxWidth:w,rotation:N,textAlign:xx(a.align),textBaseline:"middle",translation:[m,v]})}}function wk(l,n){const a=new yv({ctx:l.ctx,options:n,chart:l});Ei.configure(l,a,n),Ei.addBox(l,a),l.titleBlock=a}var Hc={id:"title",_element:yv,start(l,n,a){wk(l,a)},stop(l){const n=l.titleBlock;Ei.removeBox(l,n),delete l.titleBlock},beforeUpdate(l,n,a){const o=l.titleBlock;Ei.configure(l,o,a),o.options=a},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Jf={average(l){if(!l.length)return!1;let n,a,o=new Set,s=0,e=0;for(n=0,a=l.length;n<a;++n){const v=l[n].element;if(v&&v.hasValue()){const w=v.tooltipPosition();o.add(w.x),s+=w.y,++e}}return e===0||o.size===0?!1:{x:[...o].reduce((v,w)=>v+w)/o.size,y:s/e}},nearest(l,n){if(!l.length)return!1;let a=n.x,o=n.y,s=Number.POSITIVE_INFINITY,e,m,v;for(e=0,m=l.length;e<m;++e){const w=l[e].element;if(w&&w.hasValue()){const N=w.getCenterPoint(),S=Y1(n,N);S<s&&(s=S,v=w)}}if(v){const w=v.tooltipPosition();a=w.x,o=w.y}return{x:a,y:o}}};function zl(l,n){return n&&(ja(n)?Array.prototype.push.apply(l,n):l.push(n)),l}function Fo(l){return(typeof l=="string"||l instanceof String)&&l.indexOf(`
`)>-1?l.split(`
`):l}function jk(l,n){const{element:a,datasetIndex:o,index:s}=n,e=l.getDatasetMeta(o).controller,{label:m,value:v}=e.getLabelAndValue(s);return{chart:l,label:m,parsed:e.getParsed(s),raw:l.data.datasets[o].data[s],formattedValue:v,dataset:e.getDataset(),dataIndex:s,datasetIndex:o,element:a}}function db(l,n){const a=l.chart.ctx,{body:o,footer:s,title:e}=l,{boxWidth:m,boxHeight:v}=n,w=rn(n.bodyFont),N=rn(n.titleFont),S=rn(n.footerFont),D=e.length,L=s.length,M=o.length,F=Di(n.padding);let O=F.height,P=0,G=o.reduce((Ne,xe)=>Ne+xe.before.length+xe.lines.length+xe.after.length,0);if(G+=l.beforeBody.length+l.afterBody.length,D&&(O+=D*N.lineHeight+(D-1)*n.titleSpacing+n.titleMarginBottom),G){const Ne=n.displayColors?Math.max(v,w.lineHeight):w.lineHeight;O+=M*Ne+(G-M)*w.lineHeight+(G-1)*n.bodySpacing}L&&(O+=n.footerMarginTop+L*S.lineHeight+(L-1)*n.footerSpacing);let ae=0;const re=function(Ne){P=Math.max(P,a.measureText(Ne).width+ae)};return a.save(),a.font=N.string,vr(l.title,re),a.font=w.string,vr(l.beforeBody.concat(l.afterBody),re),ae=n.displayColors?m+2+n.boxPadding:0,vr(o,Ne=>{vr(Ne.before,re),vr(Ne.lines,re),vr(Ne.after,re)}),ae=0,a.font=S.string,vr(l.footer,re),a.restore(),P+=F.width,{width:P,height:O}}function Nk(l,n){const{y:a,height:o}=n;return a<o/2?"top":a>l.height-o/2?"bottom":"center"}function kk(l,n,a,o){const{x:s,width:e}=o,m=a.caretSize+a.caretPadding;if(l==="left"&&s+e+m>n.width||l==="right"&&s-e-m<0)return!0}function Ck(l,n,a,o){const{x:s,width:e}=a,{width:m,chartArea:{left:v,right:w}}=l;let N="center";return o==="center"?N=s<=(v+w)/2?"left":"right":s<=e/2?N="left":s>=m-e/2&&(N="right"),kk(N,l,n,a)&&(N="center"),N}function ub(l,n,a){const o=a.yAlign||n.yAlign||Nk(l,a);return{xAlign:a.xAlign||n.xAlign||Ck(l,n,a,o),yAlign:o}}function Sk(l,n){let{x:a,width:o}=l;return n==="right"?a-=o:n==="center"&&(a-=o/2),a}function Ak(l,n,a){let{y:o,height:s}=l;return n==="top"?o+=a:n==="bottom"?o-=s+a:o-=s/2,o}function hb(l,n,a,o){const{caretSize:s,caretPadding:e,cornerRadius:m}=l,{xAlign:v,yAlign:w}=a,N=s+e,{topLeft:S,topRight:D,bottomLeft:L,bottomRight:M}=qu(m);let F=Sk(n,v);const O=Ak(n,w,N);return w==="center"?v==="left"?F+=N:v==="right"&&(F-=N):v==="left"?F-=Math.max(S,L)+s:v==="right"&&(F+=Math.max(D,M)+s),{x:sn(F,0,o.width-n.width),y:sn(O,0,o.height-n.height)}}function ep(l,n,a){const o=Di(a.padding);return n==="center"?l.x+l.width/2:n==="right"?l.x+l.width-o.right:l.x+o.left}function fb(l){return zl([],Fo(l))}function Ek(l,n,a){return i0(l,{tooltip:n,tooltipItems:a,type:"tooltip"})}function mb(l,n){const a=n&&n.dataset&&n.dataset.tooltip&&n.dataset.tooltip.callbacks;return a?l.override(a):l}const vv={beforeTitle:Eo,title(l){if(l.length>0){const n=l[0],a=n.chart.data.labels,o=a?a.length:0;if(this&&this.options&&this.options.mode==="dataset")return n.dataset.label||"";if(n.label)return n.label;if(o>0&&n.dataIndex<o)return a[n.dataIndex]}return""},afterTitle:Eo,beforeBody:Eo,beforeLabel:Eo,label(l){if(this&&this.options&&this.options.mode==="dataset")return l.label+": "+l.formattedValue||l.formattedValue;let n=l.dataset.label||"";n&&(n+=": ");const a=l.formattedValue;return dr(a)||(n+=a),n},labelColor(l){const a=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{borderColor:a.borderColor,backgroundColor:a.backgroundColor,borderWidth:a.borderWidth,borderDash:a.borderDash,borderDashOffset:a.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(l){const a=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{pointStyle:a.pointStyle,rotation:a.rotation}},afterLabel:Eo,afterBody:Eo,beforeFooter:Eo,footer:Eo,afterFooter:Eo};function In(l,n,a,o){const s=l[n].call(a,o);return typeof s>"u"?vv[n].call(a,o):s}class gb extends Io{static positioners=Jf;constructor(n){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=n.chart,this.options=n.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(n){this.options=n,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const n=this._cachedAnimations;if(n)return n;const a=this.chart,o=this.options.setContext(this.getContext()),s=o.enabled&&a.options.animation&&o.animations,e=new ev(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(e)),e}getContext(){return this.$context||(this.$context=Ek(this.chart.getContext(),this,this._tooltipItems))}getTitle(n,a){const{callbacks:o}=a,s=In(o,"beforeTitle",this,n),e=In(o,"title",this,n),m=In(o,"afterTitle",this,n);let v=[];return v=zl(v,Fo(s)),v=zl(v,Fo(e)),v=zl(v,Fo(m)),v}getBeforeBody(n,a){return fb(In(a.callbacks,"beforeBody",this,n))}getBody(n,a){const{callbacks:o}=a,s=[];return vr(n,e=>{const m={before:[],lines:[],after:[]},v=mb(o,e);zl(m.before,Fo(In(v,"beforeLabel",this,e))),zl(m.lines,In(v,"label",this,e)),zl(m.after,Fo(In(v,"afterLabel",this,e))),s.push(m)}),s}getAfterBody(n,a){return fb(In(a.callbacks,"afterBody",this,n))}getFooter(n,a){const{callbacks:o}=a,s=In(o,"beforeFooter",this,n),e=In(o,"footer",this,n),m=In(o,"afterFooter",this,n);let v=[];return v=zl(v,Fo(s)),v=zl(v,Fo(e)),v=zl(v,Fo(m)),v}_createItems(n){const a=this._active,o=this.chart.data,s=[],e=[],m=[];let v=[],w,N;for(w=0,N=a.length;w<N;++w)v.push(jk(this.chart,a[w]));return n.filter&&(v=v.filter((S,D,L)=>n.filter(S,D,L,o))),n.itemSort&&(v=v.sort((S,D)=>n.itemSort(S,D,o))),vr(v,S=>{const D=mb(n.callbacks,S);s.push(In(D,"labelColor",this,S)),e.push(In(D,"labelPointStyle",this,S)),m.push(In(D,"labelTextColor",this,S))}),this.labelColors=s,this.labelPointStyles=e,this.labelTextColors=m,this.dataPoints=v,v}update(n,a){const o=this.options.setContext(this.getContext()),s=this._active;let e,m=[];if(!s.length)this.opacity!==0&&(e={opacity:0});else{const v=Jf[o.position].call(this,s,this._eventPosition);m=this._createItems(o),this.title=this.getTitle(m,o),this.beforeBody=this.getBeforeBody(m,o),this.body=this.getBody(m,o),this.afterBody=this.getAfterBody(m,o),this.footer=this.getFooter(m,o);const w=this._size=db(this,o),N=Object.assign({},v,w),S=ub(this.chart,o,N),D=hb(o,N,S,this.chart);this.xAlign=S.xAlign,this.yAlign=S.yAlign,e={opacity:1,x:D.x,y:D.y,width:w.width,height:w.height,caretX:v.x,caretY:v.y}}this._tooltipItems=m,this.$context=void 0,e&&this._resolveAnimations().update(this,e),n&&o.external&&o.external.call(this,{chart:this.chart,tooltip:this,replay:a})}drawCaret(n,a,o,s){const e=this.getCaretPosition(n,o,s);a.lineTo(e.x1,e.y1),a.lineTo(e.x2,e.y2),a.lineTo(e.x3,e.y3)}getCaretPosition(n,a,o){const{xAlign:s,yAlign:e}=this,{caretSize:m,cornerRadius:v}=o,{topLeft:w,topRight:N,bottomLeft:S,bottomRight:D}=qu(v),{x:L,y:M}=n,{width:F,height:O}=a;let P,G,ae,re,Ne,xe;return e==="center"?(Ne=M+O/2,s==="left"?(P=L,G=P-m,re=Ne+m,xe=Ne-m):(P=L+F,G=P+m,re=Ne-m,xe=Ne+m),ae=P):(s==="left"?G=L+Math.max(w,S)+m:s==="right"?G=L+F-Math.max(N,D)-m:G=this.caretX,e==="top"?(re=M,Ne=re-m,P=G-m,ae=G+m):(re=M+O,Ne=re+m,P=G+m,ae=G-m),xe=re),{x1:P,x2:G,x3:ae,y1:re,y2:Ne,y3:xe}}drawTitle(n,a,o){const s=this.title,e=s.length;let m,v,w;if(e){const N=Yu(o.rtl,this.x,this.width);for(n.x=ep(this,o.titleAlign,o),a.textAlign=N.textAlign(o.titleAlign),a.textBaseline="middle",m=rn(o.titleFont),v=o.titleSpacing,a.fillStyle=o.titleColor,a.font=m.string,w=0;w<e;++w)a.fillText(s[w],N.x(n.x),n.y+m.lineHeight/2),n.y+=m.lineHeight+v,w+1===e&&(n.y+=o.titleMarginBottom-v)}}_drawColorBox(n,a,o,s,e){const m=this.labelColors[o],v=this.labelPointStyles[o],{boxHeight:w,boxWidth:N}=e,S=rn(e.bodyFont),D=ep(this,"left",e),L=s.x(D),M=w<S.lineHeight?(S.lineHeight-w)/2:0,F=a.y+M;if(e.usePointStyle){const O={radius:Math.min(N,w)/2,pointStyle:v.pointStyle,rotation:v.rotation,borderWidth:1},P=s.leftForLtr(L,N)+N/2,G=F+w/2;n.strokeStyle=e.multiKeyBackground,n.fillStyle=e.multiKeyBackground,K1(n,O,P,G),n.strokeStyle=m.borderColor,n.fillStyle=m.backgroundColor,K1(n,O,P,G)}else{n.lineWidth=Xs(m.borderWidth)?Math.max(...Object.values(m.borderWidth)):m.borderWidth||1,n.strokeStyle=m.borderColor,n.setLineDash(m.borderDash||[]),n.lineDashOffset=m.borderDashOffset||0;const O=s.leftForLtr(L,N),P=s.leftForLtr(s.xPlus(L,1),N-2),G=qu(m.borderRadius);Object.values(G).some(ae=>ae!==0)?(n.beginPath(),n.fillStyle=e.multiKeyBackground,wp(n,{x:O,y:F,w:N,h:w,radius:G}),n.fill(),n.stroke(),n.fillStyle=m.backgroundColor,n.beginPath(),wp(n,{x:P,y:F+1,w:N-2,h:w-2,radius:G}),n.fill()):(n.fillStyle=e.multiKeyBackground,n.fillRect(O,F,N,w),n.strokeRect(O,F,N,w),n.fillStyle=m.backgroundColor,n.fillRect(P,F+1,N-2,w-2))}n.fillStyle=this.labelTextColors[o]}drawBody(n,a,o){const{body:s}=this,{bodySpacing:e,bodyAlign:m,displayColors:v,boxHeight:w,boxWidth:N,boxPadding:S}=o,D=rn(o.bodyFont);let L=D.lineHeight,M=0;const F=Yu(o.rtl,this.x,this.width),O=function(ce){a.fillText(ce,F.x(n.x+M),n.y+L/2),n.y+=L+e},P=F.textAlign(m);let G,ae,re,Ne,xe,we,Z;for(a.textAlign=m,a.textBaseline="middle",a.font=D.string,n.x=ep(this,P,o),a.fillStyle=o.bodyColor,vr(this.beforeBody,O),M=v&&P!=="right"?m==="center"?N/2+S:N+2+S:0,Ne=0,we=s.length;Ne<we;++Ne){for(G=s[Ne],ae=this.labelTextColors[Ne],a.fillStyle=ae,vr(G.before,O),re=G.lines,v&&re.length&&(this._drawColorBox(a,n,Ne,F,o),L=Math.max(D.lineHeight,w)),xe=0,Z=re.length;xe<Z;++xe)O(re[xe]),L=D.lineHeight;vr(G.after,O)}M=0,L=D.lineHeight,vr(this.afterBody,O),n.y-=e}drawFooter(n,a,o){const s=this.footer,e=s.length;let m,v;if(e){const w=Yu(o.rtl,this.x,this.width);for(n.x=ep(this,o.footerAlign,o),n.y+=o.footerMarginTop,a.textAlign=w.textAlign(o.footerAlign),a.textBaseline="middle",m=rn(o.footerFont),a.fillStyle=o.footerColor,a.font=m.string,v=0;v<e;++v)a.fillText(s[v],w.x(n.x),n.y+m.lineHeight/2),n.y+=m.lineHeight+o.footerSpacing}}drawBackground(n,a,o,s){const{xAlign:e,yAlign:m}=this,{x:v,y:w}=n,{width:N,height:S}=o,{topLeft:D,topRight:L,bottomLeft:M,bottomRight:F}=qu(s.cornerRadius);a.fillStyle=s.backgroundColor,a.strokeStyle=s.borderColor,a.lineWidth=s.borderWidth,a.beginPath(),a.moveTo(v+D,w),m==="top"&&this.drawCaret(n,a,o,s),a.lineTo(v+N-L,w),a.quadraticCurveTo(v+N,w,v+N,w+L),m==="center"&&e==="right"&&this.drawCaret(n,a,o,s),a.lineTo(v+N,w+S-F),a.quadraticCurveTo(v+N,w+S,v+N-F,w+S),m==="bottom"&&this.drawCaret(n,a,o,s),a.lineTo(v+M,w+S),a.quadraticCurveTo(v,w+S,v,w+S-M),m==="center"&&e==="left"&&this.drawCaret(n,a,o,s),a.lineTo(v,w+D),a.quadraticCurveTo(v,w,v+D,w),a.closePath(),a.fill(),s.borderWidth>0&&a.stroke()}_updateAnimationTarget(n){const a=this.chart,o=this.$animations,s=o&&o.x,e=o&&o.y;if(s||e){const m=Jf[n.position].call(this,this._active,this._eventPosition);if(!m)return;const v=this._size=db(this,n),w=Object.assign({},m,this._size),N=ub(a,n,w),S=hb(n,w,N,a);(s._to!==S.x||e._to!==S.y)&&(this.xAlign=N.xAlign,this.yAlign=N.yAlign,this.width=v.width,this.height=v.height,this.caretX=m.x,this.caretY=m.y,this._resolveAnimations().update(this,S))}}_willRender(){return!!this.opacity}draw(n){const a=this.options.setContext(this.getContext());let o=this.opacity;if(!o)return;this._updateAnimationTarget(a);const s={width:this.width,height:this.height},e={x:this.x,y:this.y};o=Math.abs(o)<.001?0:o;const m=Di(a.padding),v=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;a.enabled&&v&&(n.save(),n.globalAlpha=o,this.drawBackground(e,n,s,a),Gy(n,a.textDirection),e.y+=m.top,this.drawTitle(e,n,a),this.drawBody(e,n,a),this.drawFooter(e,n,a),Ky(n,a.textDirection),n.restore())}getActiveElements(){return this._active||[]}setActiveElements(n,a){const o=this._active,s=n.map(({datasetIndex:v,index:w})=>{const N=this.chart.getDatasetMeta(v);if(!N)throw new Error("Cannot find a dataset at index "+v);return{datasetIndex:v,element:N.data[w],index:w}}),e=!bp(o,s),m=this._positionChanged(s,a);(e||m)&&(this._active=s,this._eventPosition=a,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(n,a,o=!0){if(a&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,e=this._active||[],m=this._getActiveElements(n,e,a,o),v=this._positionChanged(m,n),w=a||!bp(m,e)||v;return w&&(this._active=m,(s.enabled||s.external)&&(this._eventPosition={x:n.x,y:n.y},this.update(!0,a))),w}_getActiveElements(n,a,o,s){const e=this.options;if(n.type==="mouseout")return[];if(!s)return a.filter(v=>this.chart.data.datasets[v.datasetIndex]&&this.chart.getDatasetMeta(v.datasetIndex).controller.getParsed(v.index)!==void 0);const m=this.chart.getElementsAtEventForMode(n,e.mode,e,o);return e.reverse&&m.reverse(),m}_positionChanged(n,a){const{caretX:o,caretY:s,options:e}=this,m=Jf[e.position].call(this,n,a);return m!==!1&&(o!==m.x||s!==m.y)}}var Vc={id:"tooltip",_element:gb,positioners:Jf,afterInit(l,n,a){a&&(l.tooltip=new gb({chart:l,options:a}))},beforeUpdate(l,n,a){l.tooltip&&l.tooltip.initialize(a)},reset(l,n,a){l.tooltip&&l.tooltip.initialize(a)},afterDraw(l){const n=l.tooltip;if(n&&n._willRender()){const a={tooltip:n};if(l.notifyPlugins("beforeTooltipDraw",{...a,cancelable:!0})===!1)return;n.draw(l.ctx),l.notifyPlugins("afterTooltipDraw",a)}},afterEvent(l,n){if(l.tooltip){const a=n.replay;l.tooltip.handleEvent(n.event,a,n.inChartArea)&&(n.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(l,n)=>n.bodyFont.size,boxWidth:(l,n)=>n.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:vv},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:l=>l!=="filter"&&l!=="itemSort"&&l!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Dk=(l,n,a,o)=>(typeof n=="string"?(a=l.push(n)-1,o.unshift({index:a,label:n})):isNaN(n)&&(a=null),a);function Tk(l,n,a,o){const s=l.indexOf(n);if(s===-1)return Dk(l,n,a,o);const e=l.lastIndexOf(n);return s!==e?a:s}const _k=(l,n)=>l===null?null:sn(Math.round(l),0,n);function pb(l){const n=this.getLabels();return l>=0&&l<n.length?n[l]:l}class Wc extends rh{static id="category";static defaults={ticks:{callback:pb}};constructor(n){super(n),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(n){const a=this._addedLabels;if(a.length){const o=this.getLabels();for(const{index:s,label:e}of a)o[s]===e&&o.splice(s,1);this._addedLabels=[]}super.init(n)}parse(n,a){if(dr(n))return null;const o=this.getLabels();return a=isFinite(a)&&o[a]===n?a:Tk(o,n,Ms(a,n),this._addedLabels),_k(a,o.length-1)}determineDataLimits(){const{minDefined:n,maxDefined:a}=this.getUserBounds();let{min:o,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(n||(o=0),a||(s=this.getLabels().length-1)),this.min=o,this.max=s}buildTicks(){const n=this.min,a=this.max,o=this.options.offset,s=[];let e=this.getLabels();e=n===0&&a===e.length-1?e:e.slice(n,a+1),this._valueRange=Math.max(e.length-(o?0:1),1),this._startValue=this.min-(o?.5:0);for(let m=n;m<=a;m++)s.push({value:m});return s}getLabelForValue(n){return pb.call(this,n)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(n){return typeof n!="number"&&(n=this.parse(n)),n===null?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getPixelForTick(n){const a=this.ticks;return n<0||n>a.length-1?null:this.getPixelForValue(a[n].value)}getValueForPixel(n){return Math.round(this._startValue+this.getDecimalForPixel(n)*this._valueRange)}getBasePixel(){return this.bottom}}function Fk(l,n){const a=[],{bounds:s,step:e,min:m,max:v,precision:w,count:N,maxTicks:S,maxDigits:D,includeBounds:L}=l,M=e||1,F=S-1,{min:O,max:P}=n,G=!dr(m),ae=!dr(v),re=!dr(N),Ne=(P-O)/(D+1);let xe=h2((P-O)/F/M)*M,we,Z,ce,ue;if(xe<1e-14&&!G&&!ae)return[{value:O},{value:P}];ue=Math.ceil(P/xe)-Math.floor(O/xe),ue>F&&(xe=h2(ue*xe/F/M)*M),dr(w)||(we=Math.pow(10,w),xe=Math.ceil(xe*we)/we),s==="ticks"?(Z=Math.floor(O/xe)*xe,ce=Math.ceil(P/xe)*xe):(Z=O,ce=P),G&&ae&&e&&L3((v-m)/e,xe/1e3)?(ue=Math.round(Math.min((v-m)/xe,S)),xe=(v-m)/ue,Z=m,ce=v):re?(Z=G?m:Z,ce=ae?v:ce,ue=N-1,xe=(ce-Z)/ue):(ue=(ce-Z)/xe,em(ue,Math.round(ue),xe/1e3)?ue=Math.round(ue):ue=Math.ceil(ue));const Le=Math.max(f2(xe),f2(Z));we=Math.pow(10,dr(w)?Le:w),Z=Math.round(Z*we)/we,ce=Math.round(ce*we)/we;let be=0;for(G&&(L&&Z!==m?(a.push({value:m}),Z<m&&be++,em(Math.round((Z+be*xe)*we)/we,m,xb(m,Ne,l))&&be++):Z<m&&be++);be<ue;++be){const oe=Math.round((Z+be*xe)*we)/we;if(ae&&oe>v)break;a.push({value:oe})}return ae&&L&&ce!==v?a.length&&em(a[a.length-1].value,v,xb(v,Ne,l))?a[a.length-1].value=v:a.push({value:v}):(!ae||ce===v)&&a.push({value:ce}),a}function xb(l,n,{horizontal:a,minRotation:o}){const s=Hl(o),e=(a?Math.sin(s):Math.cos(s))||.001,m=.75*n*(""+l).length;return Math.min(n/e,m)}class Mk extends rh{constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(n,a){return dr(n)||(typeof n=="number"||n instanceof Number)&&!isFinite(+n)?null:+n}handleTickRangeOptions(){const{beginAtZero:n}=this.options,{minDefined:a,maxDefined:o}=this.getUserBounds();let{min:s,max:e}=this;const m=w=>s=a?s:w,v=w=>e=o?e:w;if(n){const w=Vl(s),N=Vl(e);w<0&&N<0?v(0):w>0&&N>0&&m(0)}if(s===e){let w=e===0?1:Math.abs(e*.05);v(e+w),n||m(s-w)}this.min=s,this.max=e}getTickLimit(){const n=this.options.ticks;let{maxTicksLimit:a,stepSize:o}=n,s;return o?(s=Math.ceil(this.max/o)-Math.floor(this.min/o)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${o} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),a=a||11),a&&(s=Math.min(a,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const n=this.options,a=n.ticks;let o=this.getTickLimit();o=Math.max(2,o);const s={maxTicks:o,bounds:n.bounds,min:n.min,max:n.max,precision:a.precision,step:a.stepSize,count:a.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:a.minRotation||0,includeBounds:a.includeBounds!==!1},e=this._range||this,m=Fk(s,e);return n.bounds==="ticks"&&R3(m,this,"value"),n.reverse?(m.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),m}configure(){const n=this.ticks;let a=this.min,o=this.max;if(super.configure(),this.options.offset&&n.length){const s=(o-a)/Math.max(n.length-1,1)/2;a-=s,o+=s}this._startValue=a,this._endValue=o,this._valueRange=o-a}getLabelForValue(n){return Fp(n,this.chart.options.locale,this.options.ticks.format)}}class $c extends Mk{static id="linear";static defaults={ticks:{callback:By.formatters.numeric}};determineDataLimits(){const{min:n,max:a}=this.getMinMax(!0);this.min=an(n)?n:0,this.max=an(a)?a:1,this.handleTickRangeOptions()}computeTickLimit(){const n=this.isHorizontal(),a=n?this.width:this.height,o=Hl(this.options.ticks.minRotation),s=(n?Math.sin(o):Math.cos(o))||.001,e=this._resolveTickFontOptions(0);return Math.ceil(a/Math.min(40,e.lineHeight/s))}getPixelForValue(n){return n===null?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getValueForPixel(n){return this._startValue+this.getDecimalForPixel(n)*this._valueRange}}const Bp={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},zn=Object.keys(Bp);function bb(l,n){return l-n}function yb(l,n){if(dr(n))return null;const a=l._adapter,{parser:o,round:s,isoWeekday:e}=l._parseOpts;let m=n;return typeof o=="function"&&(m=o(m)),an(m)||(m=typeof o=="string"?a.parse(m,o):a.parse(m)),m===null?null:(s&&(m=s==="week"&&(Ku(e)||e===!0)?a.startOf(m,"isoWeek",e):a.startOf(m,s)),+m)}function vb(l,n,a,o){const s=zn.length;for(let e=zn.indexOf(l);e<s-1;++e){const m=Bp[zn[e]],v=m.steps?m.steps:Number.MAX_SAFE_INTEGER;if(m.common&&Math.ceil((a-n)/(v*m.size))<=o)return zn[e]}return zn[s-1]}function Lk(l,n,a,o,s){for(let e=zn.length-1;e>=zn.indexOf(a);e--){const m=zn[e];if(Bp[m].common&&l._adapter.diff(s,o,m)>=n-1)return m}return zn[a?zn.indexOf(a):0]}function Rk(l){for(let n=zn.indexOf(l)+1,a=zn.length;n<a;++n)if(Bp[zn[n]].common)return zn[n]}function wb(l,n,a){if(!a)l[n]=!0;else if(a.length){const{lo:o,hi:s}=px(a,n),e=a[o]>=n?a[o]:a[s];l[e]=!0}}function Ok(l,n,a,o){const s=l._adapter,e=+s.startOf(n[0].value,o),m=n[n.length-1].value;let v,w;for(v=e;v<=m;v=+s.add(v,1,o))w=a[v],w>=0&&(n[w].major=!0);return n}function jb(l,n,a){const o=[],s={},e=n.length;let m,v;for(m=0;m<e;++m)v=n[m],s[v]=m,o.push({value:v,major:!1});return e===0||!a?o:Ok(l,o,s,a)}class Nb extends rh{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(n){super(n),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(n,a={}){const o=n.time||(n.time={}),s=this._adapter=new j6._date(n.adapters.date);s.init(a),Zf(o.displayFormats,s.formats()),this._parseOpts={parser:o.parser,round:o.round,isoWeekday:o.isoWeekday},super.init(n),this._normalized=a.normalized}parse(n,a){return n===void 0?null:yb(this,n)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const n=this.options,a=this._adapter,o=n.time.unit||"day";let{min:s,max:e,minDefined:m,maxDefined:v}=this.getUserBounds();function w(N){!m&&!isNaN(N.min)&&(s=Math.min(s,N.min)),!v&&!isNaN(N.max)&&(e=Math.max(e,N.max))}(!m||!v)&&(w(this._getLabelBounds()),(n.bounds!=="ticks"||n.ticks.source!=="labels")&&w(this.getMinMax(!1))),s=an(s)&&!isNaN(s)?s:+a.startOf(Date.now(),o),e=an(e)&&!isNaN(e)?e:+a.endOf(Date.now(),o)+1,this.min=Math.min(s,e-1),this.max=Math.max(s+1,e)}_getLabelBounds(){const n=this.getLabelTimestamps();let a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return n.length&&(a=n[0],o=n[n.length-1]),{min:a,max:o}}buildTicks(){const n=this.options,a=n.time,o=n.ticks,s=o.source==="labels"?this.getLabelTimestamps():this._generate();n.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const e=this.min,m=this.max,v=z3(s,e,m);return this._unit=a.unit||(o.autoSkip?vb(a.minUnit,this.min,this.max,this._getLabelCapacity(e)):Lk(this,v.length,a.minUnit,this.min,this.max)),this._majorUnit=!o.major.enabled||this._unit==="year"?void 0:Rk(this._unit),this.initOffsets(s),n.reverse&&v.reverse(),jb(this,v,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(n=>+n.value))}initOffsets(n=[]){let a=0,o=0,s,e;this.options.offset&&n.length&&(s=this.getDecimalForValue(n[0]),n.length===1?a=1-s:a=(this.getDecimalForValue(n[1])-s)/2,e=this.getDecimalForValue(n[n.length-1]),n.length===1?o=e:o=(e-this.getDecimalForValue(n[n.length-2]))/2);const m=n.length<3?.5:.25;a=sn(a,0,m),o=sn(o,0,m),this._offsets={start:a,end:o,factor:1/(a+1+o)}}_generate(){const n=this._adapter,a=this.min,o=this.max,s=this.options,e=s.time,m=e.unit||vb(e.minUnit,a,o,this._getLabelCapacity(a)),v=Ms(s.ticks.stepSize,1),w=m==="week"?e.isoWeekday:!1,N=Ku(w)||w===!0,S={};let D=a,L,M;if(N&&(D=+n.startOf(D,"isoWeek",w)),D=+n.startOf(D,N?"day":m),n.diff(o,a,m)>1e5*v)throw new Error(a+" and "+o+" are too far apart with stepSize of "+v+" "+m);const F=s.ticks.source==="data"&&this.getDataTimestamps();for(L=D,M=0;L<o;L=+n.add(L,v,m),M++)wb(S,L,F);return(L===o||s.bounds==="ticks"||M===1)&&wb(S,L,F),Object.keys(S).sort(bb).map(O=>+O)}getLabelForValue(n){const a=this._adapter,o=this.options.time;return o.tooltipFormat?a.format(n,o.tooltipFormat):a.format(n,o.displayFormats.datetime)}format(n,a){const s=this.options.time.displayFormats,e=this._unit,m=a||s[e];return this._adapter.format(n,m)}_tickFormatFunction(n,a,o,s){const e=this.options,m=e.ticks.callback;if(m)return Wr(m,[n,a,o],this);const v=e.time.displayFormats,w=this._unit,N=this._majorUnit,S=w&&v[w],D=N&&v[N],L=o[a],M=N&&D&&L&&L.major;return this._adapter.format(n,s||(M?D:S))}generateTickLabels(n){let a,o,s;for(a=0,o=n.length;a<o;++a)s=n[a],s.label=this._tickFormatFunction(s.value,a,n)}getDecimalForValue(n){return n===null?NaN:(n-this.min)/(this.max-this.min)}getPixelForValue(n){const a=this._offsets,o=this.getDecimalForValue(n);return this.getPixelForDecimal((a.start+o)*a.factor)}getValueForPixel(n){const a=this._offsets,o=this.getDecimalForPixel(n)/a.factor-a.end;return this.min+o*(this.max-this.min)}_getLabelSize(n){const a=this.options.ticks,o=this.ctx.measureText(n).width,s=Hl(this.isHorizontal()?a.maxRotation:a.minRotation),e=Math.cos(s),m=Math.sin(s),v=this._resolveTickFontOptions(0).size;return{w:o*e+v*m,h:o*m+v*e}}_getLabelCapacity(n){const a=this.options.time,o=a.displayFormats,s=o[a.unit]||o.millisecond,e=this._tickFormatFunction(n,0,jb(this,[n],this._majorUnit),s),m=this._getLabelSize(e),v=Math.floor(this.isHorizontal()?this.width/m.w:this.height/m.h)-1;return v>0?v:1}getDataTimestamps(){let n=this._cache.data||[],a,o;if(n.length)return n;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(a=0,o=s.length;a<o;++a)n=n.concat(s[a].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const n=this._cache.labels||[];let a,o;if(n.length)return n;const s=this.getLabels();for(a=0,o=s.length;a<o;++a)n.push(yb(this,s[a]));return this._cache.labels=this._normalized?n:this.normalize(n)}normalize(n){return Ly(n.sort(bb))}}function tp(l,n,a){let o=0,s=l.length-1,e,m,v,w;a?(n>=l[o].pos&&n<=l[s].pos&&({lo:o,hi:s}=Jd(l,"pos",n)),{pos:e,time:v}=l[o],{pos:m,time:w}=l[s]):(n>=l[o].time&&n<=l[s].time&&({lo:o,hi:s}=Jd(l,"time",n)),{time:e,pos:v}=l[o],{time:m,pos:w}=l[s]);const N=m-e;return N?v+(w-v)*(n-e)/N:v}class oC extends Nb{static id="timeseries";static defaults=Nb.defaults;constructor(n){super(n),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const n=this._getTimestampsForTable(),a=this._table=this.buildLookupTable(n);this._minPos=tp(a,this.min),this._tableRange=tp(a,this.max)-this._minPos,super.initOffsets(n)}buildLookupTable(n){const{min:a,max:o}=this,s=[],e=[];let m,v,w,N,S;for(m=0,v=n.length;m<v;++m)N=n[m],N>=a&&N<=o&&s.push(N);if(s.length<2)return[{time:a,pos:0},{time:o,pos:1}];for(m=0,v=s.length;m<v;++m)S=s[m+1],w=s[m-1],N=s[m],Math.round((S+w)/2)!==N&&e.push({time:N,pos:m/(v-1)});return e}_generate(){const n=this.min,a=this.max;let o=super.getDataTimestamps();return(!o.includes(n)||!o.length)&&o.splice(0,0,n),(!o.includes(a)||o.length===1)&&o.push(a),o.sort((s,e)=>s-e)}_getTimestampsForTable(){let n=this._cache.all||[];if(n.length)return n;const a=this.getDataTimestamps(),o=this.getLabelTimestamps();return a.length&&o.length?n=this.normalize(a.concat(o)):n=a.length?a:o,n=this._cache.all=n,n}getDecimalForValue(n){return(tp(this._table,n)-this._minPos)/this._tableRange}getValueForPixel(n){const a=this._offsets,o=this.getDecimalForPixel(n)/a.factor-a.end;return tp(this._table,o*this._tableRange+this._minPos,!0)}}const Pk=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),[]).then(l=>({default:l.Line}))),_1=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Bar}))),Ik=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Doughnut}))),Bk=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Pie})));cl.register(Wc,$c,Bc,dl,zc,bm,Hc,Vc,Uc);let F1=null,kb=0;const zk=60*1e3;function Uk(){const[l,n]=B.useState(null),[a,o]=B.useState(!0),[s,e]=B.useState("overview");Fr(),B.useEffect(()=>{let D=!0;const L=new AbortController,M=async(F=!0)=>{try{const O=Date.now();if(F&&F1&&O-kb<zk){D&&(n(F1),o(!1));return}o(!0);const P=await Ht.get("/dashboard/stats",{signal:L.signal,timeout:3e4,headers:{"Cache-Control":"max-age=300"}}),G=P.data?.data||P.data;D&&(n(G),F1=G,kb=Date.now())}catch(O){!(O.name==="CanceledError"||O.message==="canceled"||O.code==="ERR_CANCELED"||O.config&&O.config.signal&&O.config.signal.aborted)&&D&&(console.error("Error fetching dashboard stats:",O),O.code==="ECONNABORTED"&&console.error("Request timeout - dashboard data is taking too long to load"))}finally{D&&o(!1)}};return M(!0),M(!1),()=>{D=!1,L.signal.aborted||L.abort()}},[]);const m=[{id:"overview",label:"Overview",icon:"grid"},{id:"industry",label:"Industry",icon:"building"},{id:"geography",label:"Geography",icon:"globe"},{id:"designation",label:"Designation & Persona",icon:"briefcase"},{id:"data-quality",label:"Data Quality",icon:"shield"},{id:"ownership",label:"Ownership & Team",icon:"users"}],v=B.useMemo(()=>{if(!l)return{overallScore:0,completeness:0,deduplication:100,freshness:0};const D=l.totalContacts||0,L=D>0?Math.round(((l.emailValidity?.valid||0)/D*.3+(l.outreachReady?.value||0)/D*.3+(l.enrichmentCoverage?.value||0)/D*.2+(1-(l.duplicateRecords?.value||0)/D)*.2)*100):0,M=D>0?Math.round((l.outreachReady?.value||0)/D*100):0,F=D>0?Math.round((1-(l.duplicateRecords?.value||0)/D)*100):100,O=l.enrichmentCoverage?.percent?Math.round(l.enrichmentCoverage.percent):0;return{overallScore:L,completeness:M,deduplication:F,freshness:O}},[l?.totalContacts,l?.emailValidity?.valid,l?.outreachReady?.value,l?.enrichmentCoverage?.value,l?.duplicateRecords?.value,l?.enrichmentCoverage?.percent]),w=B.useMemo(()=>{if(!l?.topIndustries||l.topIndustries.length===0)return null;const D=l.topIndustries.slice(0,5),L=D.reduce((G,ae)=>G+(ae.count||0),0),M=l.topIndustries.reduce((G,ae)=>G+(ae.count||0),0),F=M-L,O=D.map(G=>({label:G.name,value:G.count||0,percentage:M>0?Math.round((G.count||0)/M*100):0}));F>0&&O.push({label:"Others",value:F,percentage:Math.round(F/M*100)});const P=["rgb(59, 130, 246)","rgb(34, 197, 94)","rgb(249, 115, 22)","rgb(239, 68, 68)","rgb(168, 85, 247)","rgb(156, 163, 175)"];return{labels:O.map(G=>`${G.label}: ${G.percentage}%`),data:O.map(G=>G.value),colors:P.slice(0,O.length)}},[l?.topIndustries]),N=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2 mb-2"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]});if(a)return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-4 animate-pulse"}),t.jsx("div",{className:"h-10 bg-gray-200 rounded w-full animate-pulse"})]})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((D,L)=>t.jsx(N,{},L))})})]});if(!l)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"text-center",children:t.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data"})})});const S=B.memo(({title:D,value:L,trend:M,trendDirection:F,icon:O,subtitle:P,percent:G})=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:D}),t.jsx("div",{className:"flex items-baseline gap-2",children:t.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:[typeof L=="number"?L.toLocaleString():L,G&&t.jsxs("span",{className:"text-lg text-gray-500 ml-1",children:["(",G,"%)"]})]})}),P&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:P})]}),t.jsxs("div",{className:"text-gray-400",children:[O==="people"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),O==="building"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),O==="plus"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),O==="check"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),O==="sparkle"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),O==="clock"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),O==="envelope"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),O==="exclamation"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),O==="ban"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})}),O==="duplicate"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})]})]}),M&&t.jsxs("div",{className:`flex items-center gap-1 text-sm ${F==="up"?"text-green-600":"text-red-600"}`,children:[t.jsx("svg",{className:`w-4 h-4 ${F==="down"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),t.jsx("span",{children:M})]})]}));return B.memo(({type:D,title:L,description:M,action:F,actionLabel:O})=>{const P={success:{bg:"bg-green-50",border:"border-green-200",icon:"text-green-600",text:"text-green-800"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:"text-yellow-600",text:"text-yellow-800"},error:{bg:"bg-red-50",border:"border-red-200",icon:"text-red-600",text:"text-red-800"}},G=P[D]||P.success;return t.jsx("div",{className:`${G.bg} border ${G.border} rounded-lg p-6`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsxs("div",{className:`${G.icon} flex-shrink-0`,children:[D==="success"&&t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),D==="warning"&&t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),D==="error"&&t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:`font-semibold ${G.text} mb-2`,children:L}),t.jsx("p",{className:`text-sm ${G.text} mb-4`,children:M}),F&&t.jsxs("button",{onClick:F,className:"text-blue-600 hover:text-blue-800 font-medium text-sm flex items-center gap-1",children:[O,t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})})}),t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Monitor your contact and account data performance"})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:m.map(D=>t.jsxs("button",{onClick:()=>e(D.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${s===D.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[D.icon==="grid"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),D.icon==="building"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),D.icon==="globe"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 002 2h2.945M15 6.055V5a2 2 0 012-2h3.055M21 12.055V19a2 2 0 01-2 2h-3.055M9 3.055V5a2 2 0 012-2h2.945M9 20.945V19a2 2 0 012-2h2.945M21 3.055V5a2 2 0 00-2 2h-3.055M9 20.945V19a2 2 0 00-2-2H3.055"})}),D.icon==="briefcase"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),D.icon==="shield"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),D.icon==="users"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),D.label]},D.id))})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsx(S,{title:"Total Contacts",value:l.totalContacts?.value||0,trend:l.totalContacts?.trend,trendDirection:l.totalContacts?.trendDirection,icon:"people"}),t.jsx(S,{title:"Total Accounts",value:l.totalAccounts?.value||0,trend:l.totalAccounts?.trend,trendDirection:l.totalAccounts?.trendDirection,icon:"building"}),t.jsx(S,{title:"New Contacts",value:l.newContacts?.value||0,trend:l.newContacts?.trend,trendDirection:l.newContacts?.trendDirection,icon:"plus",subtitle:"This month"}),t.jsx(S,{title:"Outreach Ready",value:l.outreachReady?.value||0,percent:l.outreachReady?.percent,trend:l.outreachReady?.trend,trendDirection:l.outreachReady?.trendDirection,icon:"check"}),t.jsx(S,{title:"Enrichment Coverage",value:l.enrichmentCoverage?.percent||0,subtitle:`${l.enrichmentCoverage?.value||0} contacts enriched`,trend:l.enrichmentCoverage?.trend,trendDirection:l.enrichmentCoverage?.trendDirection,icon:"sparkle"}),t.jsx(S,{title:"Stale Enrichment",value:l.staleEnrichment?.value||0,subtitle:">90 days old",trend:l.staleEnrichment?.trend,trendDirection:l.staleEnrichment?.trendDirection,icon:"clock"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(S,{title:"Email Validity",value:l.emailValidity?.percent||0,subtitle:`${l.emailValidity?.valid||0} valid`,trend:l.emailValidity?.trend,trendDirection:l.emailValidity?.trendDirection,icon:"envelope"}),t.jsx(S,{title:"Missing Titles",value:l.missingTitles?.value||0,percent:l.missingTitles?.percent,trend:l.missingTitles?.trend,trendDirection:l.missingTitles?.trendDirection,icon:"exclamation"}),t.jsx(S,{title:"DNC Contacts",value:l.dncContacts?.value||0,percent:l.dncContacts?.percent,trend:l.dncContacts?.trend,trendDirection:l.dncContacts?.trendDirection,icon:"ban"}),t.jsx(S,{title:"Duplicate Records",value:l.duplicateRecords?.value||0,trend:l.duplicateRecords?.trend,trendDirection:l.duplicateRecords?.trendDirection,icon:"duplicate"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact & Account Growth"}),l.monthlyGrowth&&Array.isArray(l.monthlyGrowth)&&l.monthlyGrowth.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Pk,{data:{labels:l.monthlyGrowth.map(D=>D.month||""),datasets:[{label:"Contacts",data:l.monthlyGrowth.map(D=>D.contacts||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!1},{label:"Accounts",data:l.monthlyGrowth.map(D=>D.accounts||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,ticks:{precision:0}}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No growth data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Enrichment Status Distribution"}),l.enrichmentStatus?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Ik,{data:{labels:["Fully Enriched","Partially Enriched","Not Enriched"],datasets:[{data:[l.enrichmentStatus.fullyEnriched?.count||0,l.enrichmentStatus.partiallyEnriched?.count||0,l.enrichmentStatus.notEnriched?.count||0],backgroundColor:["rgb(34, 197, 94)","rgb(249, 115, 22)","rgb(239, 68, 68)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No enrichment data available"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Outreach Readiness Funnel"}),t.jsx("div",{className:"space-y-4",children:l.outreachFunnel&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Total Contacts"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.totalContacts?.toLocaleString()||0," (100%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-gray-400 h-2 rounded-full",style:{width:"100%"}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Has Email"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.hasEmail?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.hasEmail/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.hasEmail/l.outreachFunnel.totalContacts*100:0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Valid Email"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.validEmail?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.validEmail/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.validEmail/l.outreachFunnel.totalContacts*100:0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Has Title"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.hasTitle?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.hasTitle/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.hasTitle/l.outreachFunnel.totalContacts*100:0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Ready for Outreach"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.readyForOutreach?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.readyForOutreach/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.readyForOutreach/l.outreachFunnel.totalContacts*100:0}%`}})})]})]})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Segments"}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Industries"}),t.jsx("div",{className:"space-y-2",children:l.topIndustries&&l.topIndustries.length>0?l.topIndustries.map((D,L)=>t.jsxs("div",{className:"flex items-center justify-between py-1",children:[t.jsx("span",{className:"text-sm text-gray-600",children:D.name}),t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:D.count.toLocaleString()})]},L)):t.jsx("p",{className:"text-xs text-gray-500",children:"No industry data available"})})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top States"}),t.jsx("div",{className:"space-y-2",children:l.topStates&&l.topStates.length>0?l.topStates.map((D,L)=>t.jsxs("div",{className:"flex items-center justify-between py-1",children:[t.jsx("span",{className:"text-sm text-gray-600",children:D.name}),t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:D.count.toLocaleString()})]},L)):t.jsx("p",{className:"text-xs text-gray-500",children:"No geography data available"})})]})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Data Health Score"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:v.overallScore}),t.jsx("p",{className:"text-sm text-gray-600",children:"Overall Score"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:v.completeness}),t.jsx("p",{className:"text-sm text-gray-600",children:"Completeness"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:v.deduplication}),t.jsx("p",{className:"text-sm text-gray-600",children:"Deduplication"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:v.freshness}),t.jsx("p",{className:"text-sm text-gray-600",children:"Freshness"})]})]})]})]}),s==="industry"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Industry Distribution"}),l.topIndustries&&l.topIndustries.length>0?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(_1,{data:{labels:l.topIndustries.map(D=>D.name),datasets:[{label:"Contacts",data:l.topIndustries.map(D=>D.count||0),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0,ticks:{precision:0},grid:{color:"rgba(0, 0, 0, 0.05)",lineWidth:1}},y:{ticks:{maxRotation:45,minRotation:45},grid:{display:!1}}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No industry data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top 5 Industries by Contact Volume"}),w?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Bk,{data:{labels:w.labels,datasets:[{data:w.data,backgroundColor:w.colors,borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{usePointStyle:!0,padding:15,font:{size:12},generateLabels:function(D){const L=D.data;return L.labels.length&&L.datasets.length?L.labels.map((M,F)=>{L.datasets[0].data[F];const O=L.datasets[0].backgroundColor[F];return{text:M,fillStyle:O,hidden:!1,index:F}}):[]}}},tooltip:{callbacks:{label:function(D){const L=D.label||"",M=D.parsed||0;return`${L} - ${M.toLocaleString()} contacts`}}}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No industry data available"})})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Industry Insights"}),l.industryInsights?t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Fastest Growing"}),t.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:l.industryInsights.fastestGrowing?.industry||"N/A"}),t.jsx("p",{className:"text-sm font-semibold text-green-600",children:l.industryInsights.fastestGrowing?`+${l.industryInsights.fastestGrowing.growth.toFixed(0)}% this quarter`:"No data"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Highest Enrichment"}),t.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:l.industryInsights.highestEnrichment?.industry||"N/A"}),t.jsx("p",{className:"text-sm font-semibold text-green-600",children:l.industryInsights.highestEnrichment?`${l.industryInsights.highestEnrichment.enrichment.toFixed(0)}% enriched`:"No data"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Needs Attention"}),t.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:l.industryInsights.needsAttention?.industry||"N/A"}),t.jsx("p",{className:"text-sm font-semibold text-orange-600",children:l.industryInsights.needsAttention?`${l.industryInsights.needsAttention.enrichment.toFixed(0)}% enriched`:"No data"})]})]}):t.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No industry insights available"})]})]}),s==="geography"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Geographic Distribution"}),l.topStates&&l.topStates.length>0?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(_1,{data:{labels:l.topStates.map(D=>D.name),datasets:[{label:"Contacts",data:l.topStates.map(D=>D.count||0),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0,ticks:{precision:0,stepSize:750,font:{size:11},color:"#6B7280"},grid:{color:"rgba(0, 0, 0, 0.08)",lineWidth:1,borderDash:[5,5],drawBorder:!1}},y:{ticks:{font:{size:12},color:"#374151"},grid:{display:!1}}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No geographic data available"})})]})}),s==="data-quality"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Quality Metrics"}),l.dataQualityMetrics?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(_1,{data:{labels:["Email Valid","Phone Valid","Complete Profile","LinkedIn Connected","Recent Activity"],datasets:[{label:"Count",data:[l.dataQualityMetrics.emailValid||0,l.dataQualityMetrics.phoneValid||0,l.dataQualityMetrics.completeProfile||0,l.dataQualityMetrics.linkedinConnected||0,l.dataQualityMetrics.recentActivity||0],backgroundColor:"rgba(59, 130, 246, 0.8)"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No data quality metrics available"})})]})})]})]})}function Hk({category:l,searchParam:n,onApplyFilters:a,onClearFilters:o}){const[s]=n0(),[e,m]=B.useState(!1),v=B.useRef(null),w=s.get("filterKeywords")||"",N=s.get("filterCity")||"",S=s.get("filterState")||"",D=s.get("filterCountry")||"",L=s.get("filterHasLinkedIn")||"",M=s.get("filterHasEmail")||"",F=s.get("filterHasPhone")||"",[O,P]=B.useState({keywords:"",city:"",state:"",country:"",hasLinkedIn:"",hasEmail:"",hasPhone:""});B.useEffect(()=>{P({keywords:w,city:N,state:S,country:D,hasLinkedIn:L,hasEmail:M,hasPhone:F})},[w,N,S,D,L,M,F]),B.useEffect(()=>{const we=Z=>{v.current&&!v.current.contains(Z.target)&&m(!1)};return e&&document.addEventListener("mousedown",we),()=>{document.removeEventListener("mousedown",we)}},[e]);const G=(we,Z)=>{const ce=typeof Z=="string"?Z.trim():Z;P(ue=>({...ue,[we]:ce}))},ae=()=>!!(w||N||S||D||L||M||F),re=()=>{const we={keywords:O.keywords?.trim()||"",city:O.city?.trim()||"",state:O.state?.trim()||"",country:O.country?.trim()||"",hasLinkedIn:O.hasLinkedIn||"",hasEmail:O.hasEmail||"",hasPhone:O.hasPhone||""};a(we),m(!1)},Ne=()=>{P({keywords:"",city:"",state:"",country:"",hasLinkedIn:"",hasEmail:"",hasPhone:""}),o(),m(!1)},xe=()=>[w,N,S,D,L,M,F].filter(we=>we!==""&&we!==null&&we!==void 0).length;return t.jsxs("div",{className:"relative",ref:v,children:[t.jsxs("button",{onClick:()=>m(!e),className:`inline-flex items-center justify-center gap-2 px-5 py-3 rounded-lg transition-all duration-200 font-semibold text-sm shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 ${ae()?"bg-blue-50 border-2 border-blue-500 text-blue-700 hover:bg-blue-100":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400 active:bg-gray-100"}`,title:"Filter contacts",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Filter"}),ae()&&t.jsx("span",{className:"ml-1 px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full font-semibold",children:xe()})]}),e&&t.jsx("div",{className:"absolute right-0 mt-2 w-96 bg-white border border-gray-200 rounded-lg shadow-xl z-50 animate-fade-in-down",children:t.jsxs("div",{className:"p-5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),t.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Keyword",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(searches in keywords field)"})]}),t.jsx("input",{type:"text",value:O.keywords,onChange:we=>G("keywords",we.target.value),placeholder:"Enter keyword...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:we=>{we.key==="Enter"&&(we.preventDefault(),re())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["City",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(case-insensitive)"})]}),t.jsx("input",{type:"text",value:O.city,onChange:we=>G("city",we.target.value),placeholder:"Enter city name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:we=>{we.key==="Enter"&&(we.preventDefault(),re())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["State",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(case-insensitive)"})]}),t.jsx("input",{type:"text",value:O.state,onChange:we=>G("state",we.target.value),placeholder:"Enter state name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:we=>{we.key==="Enter"&&(we.preventDefault(),re())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Country",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(case-insensitive)"})]}),t.jsx("input",{type:"text",value:O.country,onChange:we=>G("country",we.target.value),placeholder:"Enter country name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:we=>{we.key==="Enter"&&(we.preventDefault(),re())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Has Email",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(valid email format)"})]}),t.jsxs("select",{value:O.hasEmail,onChange:we=>G("hasEmail",we.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"All Contacts"}),t.jsx("option",{value:"yes",children:"Has Valid Email"}),t.jsx("option",{value:"no",children:"No Valid Email"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Has LinkedIn",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(person or company)"})]}),t.jsxs("select",{value:O.hasLinkedIn,onChange:we=>G("hasLinkedIn",we.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"All Contacts"}),t.jsx("option",{value:"yes",children:"Has LinkedIn URL"}),t.jsx("option",{value:"no",children:"No LinkedIn URL"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Has Phone",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(phone number available)"})]}),t.jsxs("select",{value:O.hasPhone,onChange:we=>G("hasPhone",we.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"All Contacts"}),t.jsx("option",{value:"yes",children:"Has Phone Number"}),t.jsx("option",{value:"no",children:"No Phone Number"})]})]})]}),t.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t border-gray-200",children:[t.jsx("button",{onClick:Ne,disabled:!ae(),className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${ae()?"text-gray-700 bg-gray-100 hover:bg-gray-200 cursor-pointer":"text-gray-400 bg-gray-50 cursor-not-allowed"}`,children:"Clear All"}),t.jsx("button",{onClick:re,className:"flex-1 px-4 py-2 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 active:bg-blue-800 rounded-lg transition-colors shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Apply Filters"})]}),ae()&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Active filters:"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[w&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Keyword: ",w]}),N&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["City: ",N]}),S&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["State: ",S]}),D&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Country: ",D]}),M&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Email: ",M==="yes"?"Yes":"No"]}),L&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["LinkedIn: ",L==="yes"?"Yes":"No"]}),F&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Phone: ",F==="yes"?"Yes":"No"]})]})]})]})})]})}function Vk(){const[l,n]=B.useState([]),[a,o]=B.useState(!0),[s,e]=B.useState(null),[m,v]=n0(),[w,N]=B.useState([]),[S,D]=B.useState("name"),[L,M]=B.useState("asc"),[F,O]=B.useState({page:1,limit:50,total:0,totalPages:0}),[P,G]=B.useState(""),[ae,re]=B.useState(new Set),[Ne,xe]=B.useState("details"),[we,Z]=B.useState(new Set),[ce,ue]=B.useState([]),[Le,be]=B.useState(!1),oe=Fr(),he=m.get("category")||"All",ye=parseInt(m.get("page")||"1",10),Te=m.get("search")||"",fe=m.get("filterKeywords")||"",_e=m.get("filterCity")||"",We=m.get("filterState")||"",se=m.get("filterCountry")||"",me=m.get("filterHasLinkedIn")||"",W=m.get("filterHasEmail")||"",pe=m.get("filterHasPhone")||"",[Me,Se]=B.useState(["All"]),V=async()=>{try{const dt=(await Ht.get("/categories")).data?.data||[];Se(["All",...dt])}catch(Ie){console.error("Error fetching categories:",Ie),Se(["All","IND-IT & Service","Accounting & Book keeping","Web Design & Development","Enterprise Software","Finance Services - IND","E-commerce","CRM","Middle East","International","USA Chicago","IT Company - USA","IT Company - Chicago","Weam.ai Mumbai Data","ERP Software","ERP NEXT- Manufacturing-Automotive Components & Spares","Salon & Spa - Chicago","SPA & SALON AHMEDABAD","kology"])}};B.useEffect(()=>{V()},[]),B.useEffect(()=>{const Ie=()=>{document.hidden||V()};return document.addEventListener("visibilitychange",Ie),()=>{document.removeEventListener("visibilitychange",Ie)}},[]),B.useEffect(()=>{O(Ie=>({...Ie,page:ye}))},[ye]),B.useEffect(()=>{G(Te)},[Te]),B.useEffect(()=>{Ne==="company"&&H()},[Ne,he,Te,fe,_e,We,se,me,W,pe]),B.useEffect(()=>{Q()},[he,ye,Te,fe,_e,We,se,me,W,pe]);const H=async()=>{try{be(!0);const Ie={};he&&he!=="All"&&(Ie.category=he),Te&&Te.trim()&&(Ie.search=Te.trim()),fe&&(Ie.filterKeywords=fe),_e&&(Ie.filterCity=_e),We&&(Ie.filterState=We),se&&(Ie.filterCountry=se),me&&(Ie.filterHasLinkedIn=me),W&&(Ie.filterHasEmail=W),pe&&(Ie.filterHasPhone=pe);const Tt=(await Ht.get("/contacts/companies",{params:Ie}))?.data?.data||[];ue(Tt)}catch(Ie){console.error("Error fetching companies:",Ie),ue([])}finally{be(!1)}},Q=async()=>{try{o(!0);const Ie={page:ye,limit:50};he&&he!=="All"&&(Ie.category=he),Te&&Te.trim()&&(Ie.search=Te.trim()),fe&&(Ie.filterKeywords=fe),_e&&(Ie.filterCity=_e),We&&(Ie.filterState=We),se&&(Ie.filterCountry=se),me&&(Ie.filterHasLinkedIn=me),W&&(Ie.filterHasEmail=W),pe&&(Ie.filterHasPhone=pe);const dt=await Ht.get("/contacts",{params:Ie}),Tt=dt?.data?.data||dt?.data||[];n(Array.isArray(Tt)?Tt:[]),dt?.data&&O({page:dt.data.page||ye,limit:dt.data.limit||50,total:dt.data.total||0,totalPages:dt.data.totalPages||0}),e(null)}catch(Ie){e("Failed to fetch contacts. Please try again."),console.error("=== Error fetching contacts ==="),console.error("Error details:",Ie),console.error("Error response:",Ie?.response?.data),console.error("Error status:",Ie?.response?.status),console.error("==============================")}finally{o(!1)}},te=Ie=>{const dt=he!=="All"?`?category=${encodeURIComponent(he)}`:"";oe(`/contacts/${Ie}${dt}`)},de=Ie=>{Ie.target.checked?N(l.map(dt=>dt._id)):N([])},ve=Ie=>{N(dt=>dt.includes(Ie)?dt.filter(Tt=>Tt!==Ie):[...dt,Ie])},ke=async()=>{if(w.length===0)return;const Ie=w.length===1?"Are you sure you want to delete this contact?":`Are you sure you want to delete ${w.length} contacts?`;if(window.confirm(Ie))try{o(!0);const dt=w.map(Tt=>Ht.delete(`/contacts/${Tt}`));await Promise.all(dt),N([]),await Q()}catch(dt){console.error("Error deleting contacts:",dt),alert(dt.response?.data?.error||"Failed to delete contacts")}finally{o(!1)}},ne=Ie=>{S===Ie?M(L==="asc"?"desc":"asc"):(D(Ie),M("asc"))},De=(Ie,dt)=>{dt.stopPropagation(),Ie.email&&(window.location.href=`mailto:${Ie.email}`)},He=Ie=>{Ie.preventDefault();const dt=P.trim(),Tt={page:"1"};he!=="All"&&(Tt.category=he),dt&&(Tt.search=dt),fe&&(Tt.filterKeywords=fe),_e&&(Tt.filterCity=_e),We&&(Tt.filterState=We),se&&(Tt.filterCountry=se),me&&(Tt.filterHasLinkedIn=me),W&&(Tt.filterHasEmail=W),pe&&(Tt.filterHasPhone=pe),v(Tt,{replace:!0})},vt=()=>{G("");const Ie={page:"1"};he!=="All"&&(Ie.category=he),fe&&(Ie.filterKeywords=fe),_e&&(Ie.filterCity=_e),We&&(Ie.filterState=We),se&&(Ie.filterCountry=se),me&&(Ie.filterHasLinkedIn=me),W&&(Ie.filterHasEmail=W),pe&&(Ie.filterHasPhone=pe),v(Ie,{replace:!0})},Pe=Ie=>{const dt={page:"1"};he!=="All"&&(dt.category=he),Te&&Te.trim()&&(dt.search=Te.trim()),Ie.keywords&&Ie.keywords.trim()&&(dt.filterKeywords=Ie.keywords.trim()),Ie.city&&Ie.city.trim()&&(dt.filterCity=Ie.city.trim()),Ie.state&&Ie.state.trim()&&(dt.filterState=Ie.state.trim()),Ie.country&&Ie.country.trim()&&(dt.filterCountry=Ie.country.trim()),Ie.hasLinkedIn&&Ie.hasLinkedIn!==""&&(dt.filterHasLinkedIn=Ie.hasLinkedIn),Ie.hasEmail&&Ie.hasEmail!==""&&(dt.filterHasEmail=Ie.hasEmail),Ie.hasPhone&&Ie.hasPhone!==""&&(dt.filterHasPhone=Ie.hasPhone),v(dt,{replace:!0})},Nt=()=>!!(fe||_e||We||se||me||W||pe),st=()=>{const Ie={page:"1"};he!=="All"&&(Ie.category=he),Te&&(Ie.search=Te),v(Ie,{replace:!0})},Xt=[...l].sort((Ie,dt)=>{let Tt=Ie[S]||"",ms=dt[S]||"";return typeof Tt=="string"&&(Tt=Tt.toLowerCase(),ms=ms.toLowerCase()),L==="asc"?Tt>ms?1:Tt<ms?-1:0:Tt<ms?1:Tt>ms?-1:0}),Rt=Ie=>{if(!Ie)return"?";const dt=Ie.trim().split(/\s+/);return dt.length>=2?(dt[0][0]+dt[1][0]).toUpperCase():Ie.substring(0,2).toUpperCase()},Ns=Ie=>{re(dt=>{const Tt=new Set(dt);return Tt.has(Ie)?Tt.delete(Ie):Tt.add(Ie),Tt})},Js=Ie=>{if(!Ie.keywords)return"-";const dt=Ie.keywords.split(",").map(ms=>ms.trim()).filter(ms=>ms),Tt=ae.has(Ie._id);return dt.length<=3||Tt?dt.join(", "):dt.slice(0,3).join(", ")+"..."},ps=Ie=>{Z(dt=>{const Tt=new Set(dt);return Tt.has(Ie)?Tt.delete(Ie):Tt.add(Ie),Tt})},ds=Ie=>{const dt=he!=="All"?`?category=${encodeURIComponent(he)}`:"",Tt=encodeURIComponent(Ie);oe(`/contacts/company/${Tt}${dt}`)};return a?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse"}),t.jsx("div",{className:"relative animate-spin rounded-full h-14 w-14 border-2 border-gray-200 border-t-gray-900 mx-auto"})]}),t.jsx("p",{className:"tracking-wide text-sm uppercase text-gray-500 font-medium",children:"Loading contacts..."})]})}):t.jsx("div",{className:"min-h-screen bg-white py-4 sm:py-8",children:t.jsxs("div",{className:"max-w-full mx-auto px-3 sm:px-4 lg:px-8",children:[t.jsxs("div",{className:"mb-8 animate-fade-in-down",children:[t.jsx("div",{className:"mb-6",children:t.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 tracking-tight",children:"Contacts"}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1 self-start sm:self-auto",children:[t.jsx("button",{onClick:()=>xe("details"),className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-all duration-200 ${Ne==="details"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"View individual contacts",children:"Details"}),t.jsx("button",{onClick:()=>xe("company"),className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-all duration-200 ${Ne==="company"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"View companies grouped by name",children:"Company"})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-gray-50 text-gray-700 border border-gray-200 shadow-sm",children:[F.total.toLocaleString()," ",F.total===1?"contact":"contacts"]}),F.totalPages>1&&t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200 shadow-sm",children:["Page ",ye," of ",F.totalPages]}),t.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t.jsx("span",{className:"text-xs sm:text-sm text-gray-500 font-medium hidden sm:inline",children:"Category:"}),t.jsx("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200 shadow-sm truncate max-w-[150px] sm:max-w-none",children:he})]}),Ne==="company"&&ce.length>0&&t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-emerald-50 text-emerald-700 border border-emerald-200 shadow-sm",children:[ce.length," ",ce.length===1?"company":"companies"]}),Nt()&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 sm:px-3 py-1 sm:py-1.5 rounded-lg text-xs font-semibold bg-yellow-50 text-yellow-700 border border-yellow-200 shadow-sm",children:[t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Filters Active"}),t.jsx("span",{className:"sm:hidden",children:"Filters"})]})]})]})})}),t.jsx("div",{className:"bg-gray-50 rounded-xl p-3 sm:p-5 border border-gray-200 shadow-sm mb-4 sm:mb-6",children:t.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 sm:gap-4 items-stretch lg:items-end",children:[t.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-2 sm:gap-3 w-full",children:[t.jsxs("form",{onSubmit:He,className:"flex-1 flex gap-2",children:[t.jsxs("div",{className:"relative flex-1 group",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:t.jsx("svg",{className:"w-5 h-5 text-gray-400 group-focus-within:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",value:P,onChange:Ie=>G(Ie.target.value),onKeyDown:Ie=>{Ie.key==="Enter"&&He(Ie)},placeholder:"Search by name, email, company, title...",className:"pl-11 pr-11 py-3 w-full border border-gray-300 rounded-lg text-sm text-gray-900 placeholder-gray-400 bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"}),P&&t.jsx("button",{type:"button",onClick:vt,className:"absolute inset-y-0 right-0 flex items-center pr-4 text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-all duration-200 font-semibold text-sm whitespace-nowrap shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Search"})]}),t.jsxs("div",{className:"relative group w-full sm:w-64",children:[t.jsx("select",{value:he,onChange:Ie=>{const dt=Ie.target.value,Tt={page:"1"};dt!=="All"&&(Tt.category=dt),Te&&(Tt.search=Te),fe&&(Tt.filterKeywords=fe),_e&&(Tt.filterCity=_e),We&&(Tt.filterState=We),se&&(Tt.filterCountry=se),me&&(Tt.filterHasLinkedIn=me),W&&(Tt.filterHasEmail=W),pe&&(Tt.filterHasPhone=pe),v(Tt,{replace:!0})},className:"appearance-none bg-white border border-gray-300 rounded-lg px-3 sm:px-4 py-2 sm:py-3 pr-8 sm:pr-10 w-full text-xs sm:text-sm font-medium text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer shadow-sm hover:border-gray-400 hover:shadow-md",children:Me.map(Ie=>t.jsx("option",{value:Ie,children:Ie},Ie))}),t.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 sm:pr-3 pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-500 group-hover:text-gray-700 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),t.jsx(Hk,{category:he,searchParam:Te,onApplyFilters:Pe,onClearFilters:st})]}),t.jsxs("div",{className:"flex gap-2 sm:gap-3 w-full sm:w-auto flex-wrap sm:flex-nowrap",children:[w.length>0&&t.jsxs("button",{onClick:ke,disabled:a,className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 active:bg-red-800 transition-all duration-200 font-semibold text-sm shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transform hover:scale-105 active:scale-100 flex-1 sm:flex-none disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),t.jsxs("span",{className:"hidden sm:inline",children:["Remove ",w.length>1?`(${w.length})`:""]}),t.jsx("span",{className:"sm:hidden",children:"Remove"})]}),t.jsxs("button",{onClick:()=>oe("/import"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 hover:border-gray-400 active:bg-gray-100 transition-all duration-200 font-semibold text-sm shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 flex-1 sm:flex-none",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),t.jsx("span",{className:"hidden sm:inline",children:"Import"})]}),t.jsxs("button",{onClick:()=>oe("/contacts/new"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 active:bg-gray-950 transition-all duration-200 font-semibold text-sm shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transform hover:scale-105 active:scale-100 flex-1 sm:flex-none",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),t.jsx("span",{className:"hidden sm:inline",children:"Add Contact"}),t.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]})})]}),s&&t.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 text-red-700 px-5 py-4 rounded-lg shadow-md animate-shake",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),t.jsx("span",{className:"font-medium",children:s})]})}),l.length===0?t.jsxs("div",{className:"text-center py-16 bg-white rounded-lg shadow-sm border border-gray-200 animate-fade-in",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gray-100 mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No contacts found"}),t.jsx("p",{className:"text-gray-600 mb-2",children:he==="All"?"No contacts found in the database.":t.jsxs(t.Fragment,{children:["No contacts found for category: ",t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200",children:he})]})}),t.jsx("p",{className:"text-sm text-gray-500 mb-8",children:he==="All"?"Try using the search or filters to find contacts, or import contacts to get started.":"Switch to a different category using the dropdown above, or import/add contacts for this category."}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx("button",{onClick:()=>oe("/import"),className:"inline-flex items-center px-5 py-3 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-900 bg-white hover:bg-gray-50 transition-all duration-200 hover:shadow-md",children:"Import CSV/Excel"}),t.jsx("button",{onClick:()=>oe("/contacts/new"),className:"inline-flex items-center px-5 py-3 border border-transparent shadow-md text-sm font-medium rounded-lg text-white bg-gray-900 hover:bg-gray-800 transition-all duration-200 hover:shadow-lg transform hover:scale-105",children:"Add Contact"})]})]}):Ne==="company"?t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden animate-fade-in",children:Le?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading companies..."})]})}):ce.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gray-100 mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No companies found"}),t.jsx("p",{className:"text-gray-600 mb-2",children:Nt()?"No companies match the current filters. Try adjusting your search or filter criteria.":he==="All"?"No companies found in the database.":t.jsxs(t.Fragment,{children:["No companies found for category: ",t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200",children:he})]})}),t.jsx("p",{className:"text-sm text-gray-500 mb-8",children:Nt()?"Clear filters or try a different search term.":"Try using the search or filters to find companies, or import contacts to get started."}),Nt()&&t.jsx("button",{onClick:st,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:"Clear All Filters"})]}):t.jsx("div",{className:"overflow-y-auto",style:{maxHeight:"calc(100vh - 300px)",overscrollBehavior:"contain"},children:t.jsx("div",{className:"divide-y divide-gray-200",children:ce.map(Ie=>{const dt=Ie.name,Tt=we.has(dt);return t.jsxs("div",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("div",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4 flex-1 cursor-pointer",onClick:()=>ds(dt),children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-lg font-bold text-blue-700",children:Rt(dt)})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:dt}),t.jsxs("p",{className:"text-sm text-gray-500",children:[Ie.count," ",Ie.count===1?"person":"people"]})]})]}),t.jsx("button",{onClick:ms=>{ms.stopPropagation(),ps(dt)},className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:`w-5 h-5 transition-transform ${Tt?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),Tt&&t.jsx("div",{className:"bg-gray-50 border-t border-gray-200",children:t.jsxs("div",{className:"px-6 py-4 text-center",children:[t.jsxs("p",{className:"text-gray-600 mb-4",children:["Click on the company name above to view all ",Ie.count," ",Ie.count===1?"contact":"contacts"]}),t.jsx("button",{onClick:()=>ds(dt),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"View All Contacts"})]})})]},dt)})})})}):t.jsxs("div",{className:"bg-white border border-gray-200 overflow-hidden animate-fade-in",children:[t.jsxs("div",{className:"overflow-x-auto overflow-y-auto",style:{maxHeight:"calc(100vh - 300px)",overscrollBehavior:"contain",scrollBehavior:"auto"},children:[t.jsx("div",{className:"hidden md:block",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"w-12 px-4 py-3 whitespace-nowrap",children:t.jsx("input",{type:"checkbox",checked:w.length===l.length&&l.length>0,onChange:de,className:"h-4 w-4 text-gray-900 focus:ring-gray-900 border-gray-300 rounded cursor-pointer"})}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors whitespace-nowrap",style:{minWidth:"150px"},onClick:()=>ne("name"),children:t.jsxs("div",{className:"flex items-center gap-2",children:["NAME",t.jsx("svg",{className:`w-4 h-4 flex-shrink-0 ${S==="name"?"text-gray-900":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"140px"},children:"JOB TITLE"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"180px"},children:"COMPANY"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"130px"},children:"CONTACT NUMBER"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"180px"},children:"EMAIL"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"110px"},children:"LINKEDIN"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"140px"},children:"INDUSTRY"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",style:{minWidth:"180px"},children:"KEYWORDS"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Xt.map(Ie=>t.jsxs("tr",{onClick:()=>te(Ie._id),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",onClick:dt=>dt.stopPropagation(),children:t.jsx("input",{type:"checkbox",checked:w.includes(Ie._id),onChange:()=>ve(Ie._id),className:"h-4 w-4 text-gray-900 focus:ring-gray-900 border-gray-300 rounded cursor-pointer"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm font-medium text-gray-900 underline hover:text-gray-700",children:Ie.name||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Ie.title||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-gray-200 flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-xs font-semibold text-gray-700",children:Rt(Ie.company)})}),t.jsx("div",{className:"text-sm text-gray-900",children:Ie.company||"-"})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Ie.firstPhone?t.jsx("a",{href:`tel:${Ie.firstPhone}`,onClick:dt=>dt.stopPropagation(),className:"hover:text-gray-700 hover:underline",children:Ie.firstPhone}):"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Ie.email?t.jsx("a",{href:`mailto:${Ie.email}`,onClick:dt=>{dt.stopPropagation(),De(Ie,dt)},className:"hover:text-gray-700 hover:underline",children:Ie.email}):"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ie.personLinkedinUrl||Ie.companyLinkedinUrl?t.jsxs("a",{href:Ie.personLinkedinUrl||Ie.companyLinkedinUrl,onClick:dt=>dt.stopPropagation(),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium bg-blue-50 text-blue-700 hover:bg-blue-100 border border-blue-200 transition-colors whitespace-nowrap",children:[t.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("span",{children:"LinkedIn"})]}):t.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Ie.industry||"-"})}),t.jsx("td",{className:"px-6 py-4",children:Ie.keywords?t.jsx("div",{className:"text-sm text-gray-900 cursor-pointer hover:text-blue-600 transition-colors",onClick:dt=>{dt.stopPropagation(),Ie.keywords.split(",").map(ms=>ms.trim()).filter(ms=>ms).length>3&&Ns(Ie._id)},title:Ie.keywords,children:Js(Ie)}):t.jsx("div",{className:"text-sm text-gray-400",children:"-"})})]},Ie._id))})]})}),t.jsx("div",{className:"md:hidden space-y-3 p-3",children:Xt.map(Ie=>t.jsxs("div",{onClick:()=>te(Ie._id),className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[t.jsx("div",{className:"flex items-start justify-between mb-3",children:t.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t.jsx("input",{type:"checkbox",checked:w.includes(Ie._id),onChange:dt=>{dt.stopPropagation(),ve(Ie._id)},className:"h-4 w-4 text-gray-900 focus:ring-gray-900 border-gray-300 rounded cursor-pointer flex-shrink-0 mt-1"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:Ie.name||"-"}),t.jsx("p",{className:"text-xs text-gray-500 truncate",children:Ie.title||"-"})]})]})}),t.jsxs("div",{className:"space-y-2 text-xs",children:[Ie.company&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),t.jsx("span",{className:"text-gray-700 truncate",children:Ie.company})]}),Ie.email&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("a",{href:`mailto:${Ie.email}`,onClick:dt=>dt.stopPropagation(),className:"text-blue-600 hover:underline truncate",children:Ie.email})]}),Ie.firstPhone&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("a",{href:`tel:${Ie.firstPhone}`,onClick:dt=>dt.stopPropagation(),className:"text-blue-600 hover:underline",children:Ie.firstPhone})]}),(Ie.personLinkedinUrl||Ie.companyLinkedinUrl)&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("a",{href:Ie.personLinkedinUrl||Ie.companyLinkedinUrl,onClick:dt=>dt.stopPropagation(),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-xs",children:"LinkedIn Profile"})]}),Ie.industry&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-gray-400 text-xs",children:"Industry:"}),t.jsx("span",{className:"text-gray-700",children:Ie.industry})]}),Ie.keywords&&t.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[t.jsx("span",{className:"text-gray-400 text-xs",children:"Keywords: "}),t.jsx("span",{className:"text-gray-700 text-xs",children:Js(Ie)})]})]})]},Ie._id))})]}),F.totalPages>1&&t.jsxs("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-t border-gray-200 bg-gray-50 flex flex-col sm:flex-row items-center justify-between gap-3",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("span",{className:"text-xs sm:text-sm text-gray-700",children:["Showing ",(ye-1)*F.limit+1," to ",Math.min(ye*F.limit,F.total)," of ",F.total.toLocaleString()," contacts"]})}),t.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t.jsxs("button",{onClick:()=>{if(ye>1){const dt={page:(ye-1).toString()};he!=="All"&&(dt.category=he),Te&&(dt.search=Te),v(dt,{replace:!0})}},disabled:ye===1,className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[t.jsx("span",{className:"hidden sm:inline",children:"Previous"}),t.jsx("span",{className:"sm:hidden",children:"Prev"})]}),t.jsx("div",{className:"flex items-center gap-0.5 sm:gap-1",children:Array.from({length:Math.min(5,F.totalPages)},(Ie,dt)=>{let Tt;return F.totalPages<=5||ye<=3?Tt=dt+1:ye>=F.totalPages-2?Tt=F.totalPages-4+dt:Tt=ye-2+dt,t.jsx("button",{onClick:()=>{const ms={page:Tt.toString()};he!=="All"&&(ms.category=he),Te&&(ms.search=Te),v(ms,{replace:!0})},className:`px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium rounded transition-colors ${ye===Tt?"bg-gray-900 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:Tt},Tt)})}),t.jsx("button",{onClick:()=>{if(ye<F.totalPages){const dt={page:(ye+1).toString()};he!=="All"&&(dt.category=he),Te&&(dt.search=Te),v(dt,{replace:!0})}},disabled:ye>=F.totalPages,className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]})]})]})})}function Wk(){const{id:l}=ci(),n=Fr(),[a]=n0(),o=a.get("category"),s=a.get("returnTo"),[e,m]=B.useState(null),[v,w]=B.useState(!0),[N,S]=B.useState(!1),[D,L]=B.useState(null),[M,F]=B.useState(!1),[O,P]=B.useState(!1),[G,ae]=B.useState("about"),re=B.useRef(!1);B.useEffect(()=>{Ne()},[l]);const Ne=async()=>{try{w(!0);const be=await Ht.get(`/contacts/${l}`);m(be.data?.data||be.data),L(null)}catch(be){L("Failed to fetch contact details."),console.error("Error fetching contact:",be)}finally{w(!1)}},xe=async(be=!1)=>{if(!(!e||!(be&&e.companyLinkedinUrl?e.companyLinkedinUrl:e.personLinkedinUrl||e.companyLinkedinUrl)))try{S(!0);const he=be?`/linkedin/fetch/${l}?type=company`:`/linkedin/fetch/${l}`,ye=await Ht.get(he),Te=ye.data?.data?.contact||ye.data?.contact;Te&&m(Te)}catch(he){console.error("Error fetching LinkedIn data:",he)}finally{S(!1)}};B.useEffect(()=>{e&&(e.personLinkedinUrl||e.companyLinkedinUrl)&&!re.current&&(re.current=!0,xe())},[e]);const we=be=>{if(!be)return"?";const oe=be.trim().split(/\s+/);return oe.length>=2?(oe[0][0]+oe[oe.length-1][0]).toUpperCase():be.substring(0,2).toUpperCase()},Z=be=>{if(!be)return"?";const oe=be.trim().split(/\s+/);return oe.length>=2?(oe[0][0]+oe[1][0]).toUpperCase():be.substring(0,2).toUpperCase()},ce=()=>{if(!e?.company)return;const be=o||e.category||"",oe=be?`?category=${encodeURIComponent(be)}`:"";n(`/contacts/company/${encodeURIComponent(e.company)}${oe}`)};if(v)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[t.jsxs("div",{className:"relative inline-block",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse opacity-30"}),t.jsx("div",{className:"relative animate-spin rounded-full h-16 w-16 border-4 border-gray-200 border-t-blue-600"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wider",children:"Loading Contact"}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Please wait..."})]})]})});if(!e)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[t.jsx("div",{className:"w-20 h-20 mx-auto bg-red-100 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-10 h-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contact Not Found"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"The contact you're looking for doesn't exist or has been removed."}),t.jsxs("button",{onClick:()=>{if(s)n(s);else{const be=o?`?category=${encodeURIComponent(o)}`:"";n(`/contacts${be}`)}},className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),s?"Back":"Back to Contacts"]})]})]})});e.linkedinData;const ue=[e.city,e.state,e.country].filter(Boolean).join(", ")||"Not specified",Le=e.title&&e.company?`${e.title} at ${e.company}`:e.title||e.company||"";return t.jsxs("div",{className:"min-h-screen bg-white",children:[t.jsx("div",{className:"bg-white border-b border-gray-200",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:[t.jsx("nav",{className:"mb-4 sm:mb-6 animate-fade-in-down",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-gray-600 overflow-x-auto",children:[t.jsxs("button",{onClick:()=>{if(s)n(s);else{const be=o||e?.category||"",oe=be?`?category=${encodeURIComponent(be)}`:"";n(`/contacts${oe}`)}},className:"hover:text-gray-900 transition-colors duration-200 flex items-center gap-1 whitespace-nowrap",children:[t.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),t.jsx("span",{className:"hidden sm:inline",children:s?"Back":"Contacts"}),t.jsx("span",{className:"sm:hidden",children:"Back"})]}),t.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),t.jsx("span",{className:"text-gray-900 font-medium truncate",children:e.name})]})}),t.jsx("div",{className:"bg-white rounded-lg sm:rounded-xl border border-gray-200 shadow-sm p-4 sm:p-6 animate-fade-in-up",children:t.jsxs("div",{className:"flex flex-col items-center sm:items-start sm:flex-row gap-4 sm:gap-6",children:[t.jsx("div",{className:"relative flex-shrink-0",children:t.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-xl sm:text-2xl font-bold text-white shadow-lg ring-2 sm:ring-4 ring-blue-50",children:we(e.name)})}),t.jsxs("div",{className:"flex-1 min-w-0 w-full sm:w-auto text-center sm:text-left",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-center sm:items-start gap-2 sm:gap-3 mb-2",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 break-words",children:e.name}),e.category&&t.jsx("span",{className:"px-2 sm:px-3 py-1 bg-blue-50 text-blue-700 text-xs font-semibold rounded-full border border-blue-200 whitespace-nowrap",children:e.category})]}),Le&&t.jsx("p",{className:"text-gray-600 text-base sm:text-lg mb-2 sm:mb-3 font-medium break-words",children:Le}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-center sm:items-center gap-3 sm:gap-6 text-gray-600 text-xs sm:text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),t.jsx("span",{className:"break-words",children:ue})]}),e.industry&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),t.jsx("span",{className:"break-words",children:e.industry})]})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto",children:[(e.personLinkedinUrl||e.companyLinkedinUrl)&&t.jsxs("a",{href:e.personLinkedinUrl||e.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center gap-2 px-4 sm:px-5 py-2 sm:py-2.5 bg-blue-600 text-white font-semibold text-sm rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md w-full sm:w-auto",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("span",{className:"hidden sm:inline",children:"LinkedIn Profile"}),t.jsx("span",{className:"sm:hidden",children:"LinkedIn"})]}),e.email&&t.jsxs("a",{href:`mailto:${e.email}`,className:"inline-flex items-center justify-center gap-2 px-4 sm:px-5 py-2 sm:py-2.5 bg-white text-gray-700 font-semibold text-sm rounded-lg hover:bg-gray-50 transition-all duration-200 border border-gray-300 shadow-sm hover:shadow-md w-full sm:w-auto",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Send Email"}),t.jsx("span",{className:"sm:hidden",children:"Email"})]})]})]})})]})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8 bg-white",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden animate-fade-in-up hover:shadow-md transition-shadow duration-300",children:[t.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 bg-white border-b border-gray-200 flex items-center justify-between cursor-pointer hover:bg-gray-50 transition-colors duration-200",onClick:()=>F(!M),children:[t.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Contact Information"}),t.jsx("span",{className:"sm:hidden",children:"Contact Info"})]}),t.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0",children:t.jsx("svg",{className:`w-5 h-5 transition-transform duration-300 ${M?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!M&&t.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-6 space-y-4 sm:space-y-5 animate-fade-in bg-white",children:[e.email&&t.jsxs("div",{className:"group",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Email"}),t.jsxs("a",{href:`mailto:${e.email}`,className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-50 rounded-lg hover:bg-blue-50 transition-all duration-200 border border-transparent hover:border-blue-200",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 flex-1 truncate min-w-0",children:e.email}),t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 group-hover:text-blue-600 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),e.firstPhone&&t.jsxs("div",{className:"group",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Phone"}),t.jsxs("a",{href:`tel:${e.firstPhone}`,className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 border border-transparent hover:border-gray-200",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 flex-1 break-all",children:e.firstPhone}),t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 group-hover:text-gray-600 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),e.companyPhone&&e.companyPhone!==e.firstPhone&&t.jsxs("div",{className:"group",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Company Phone"}),t.jsxs("a",{href:`tel:${e.companyPhone}`,className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 border border-transparent hover:border-gray-200",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 flex-1 break-all",children:e.companyPhone}),t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 group-hover:text-gray-600 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden animate-fade-in-up hover:shadow-md transition-shadow duration-300",children:[t.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 bg-white border-b border-gray-200 flex items-center justify-between",children:[t.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),t.jsx("span",{className:"hidden sm:inline",children:"Company Insights"}),t.jsx("span",{className:"sm:hidden",children:"Company"})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("button",{className:"p-1.5 sm:p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-200 flex-shrink-0",onClick:()=>P(!O),children:t.jsx("svg",{className:`w-5 h-5 transition-transform duration-300 ${O?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})})]}),!O&&t.jsxs("div",{className:"animate-fade-in",children:[t.jsx("div",{className:"px-4 sm:px-6 pt-3 sm:pt-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex gap-4 sm:gap-6 overflow-x-auto scrollbar-hide",children:[t.jsxs("button",{onClick:()=>ae("about"),className:`pb-2 sm:pb-3 px-1 text-xs sm:text-sm font-semibold transition-all duration-200 whitespace-nowrap relative flex-shrink-0 ${G==="about"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["About",G==="about"&&t.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-full animate-slide-in"})]}),t.jsxs("button",{onClick:()=>ae("employees"),className:`pb-2 sm:pb-3 px-1 text-xs sm:text-sm font-semibold transition-all duration-200 whitespace-nowrap relative flex-shrink-0 ${G==="employees"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["Employees ",e.employees&&t.jsxs("span",{className:"text-gray-400",children:["(",e.employees,")"]}),G==="employees"&&t.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-full animate-slide-in"})]})]})}),t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:e.company&&t.jsxs("div",{className:"mb-4 sm:mb-6",children:[t.jsxs("button",{type:"button",onClick:ce,className:"w-full flex items-center gap-3 sm:gap-4 mb-4 sm:mb-6 p-3 sm:p-4 bg-gray-50 rounded-lg border border-gray-200 text-left hover:bg-blue-50 hover:border-blue-200 transition-colors duration-200",children:[t.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-base sm:text-lg shadow-sm flex-shrink-0",children:Z(e.company)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-1 break-words",children:e.company}),t.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"View company profile & insights"})]}),t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),G==="about"&&t.jsxs("div",{className:"space-y-4 sm:space-y-6 animate-fade-in",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.industry&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Industry"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:e.industry})]}),e.category&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Category"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:e.category})]}),t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Location"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:[e.companyCity,e.companyState,e.companyCountry].filter(Boolean).join(", ")||[e.city,e.state,e.country].filter(Boolean).join(", ")||"Not specified"})]}),e.website&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Website"}),t.jsxs("a",{href:e.website.startsWith("http")?e.website:`https://${e.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs sm:text-sm font-medium text-blue-600 hover:text-blue-700 hover:underline inline-flex items-center gap-1 break-all",children:[e.website,t.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]}),e.companyAddress&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Address"}),t.jsx("p",{className:"text-xs sm:text-sm text-gray-700 break-words",children:e.companyAddress})]}),e.keywords&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 sm:mb-3 block",children:"Keywords"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:e.keywords.split(",").map((be,oe)=>t.jsx("span",{className:"px-2 sm:px-3 py-1 sm:py-1.5 bg-gray-50 text-gray-700 text-xs sm:text-sm font-medium rounded-lg border border-gray-200 hover:bg-gray-100 transition-all duration-200 cursor-default",children:be.trim()},oe))})]})]}),G==="employees"&&t.jsx("div",{className:"animate-fade-in",children:e.employees?t.jsx("div",{className:"p-4 sm:p-6 bg-white rounded-lg border border-gray-200",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:t.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Number of Employees"}),t.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:e.employees})]})}):t.jsxs("div",{className:"text-center py-8 sm:py-12 bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:t.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("p",{className:"text-gray-500 text-xs sm:text-sm",children:"No employees data available"})]})})]})})]})]})})]})})]})}function wv({isOpen:l,onClose:n,type:a,contactName:o,companyName:s,projectId:e,contactId:m,phoneNumber:v,email:w,linkedInProfileUrl:N,activityId:S,editMode:D=!1,lastActivity:L=null}){const[M,F]=B.useState({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),[O,P]=B.useState({}),[G,ae]=B.useState(!1),[re,Ne]=B.useState(!1),[xe,we]=B.useState({phone:!1,email:!1,linkedin:!1}),[Z,ce]=B.useState({phone:null,email:null,linkedin:null}),[ue,Le]=B.useState(!1),[be,oe]=B.useState([]),[he,ye]=B.useState(""),[Te,fe]=B.useState(!1),_e=B.useRef(!1);B.useEffect(()=>{const de=localStorage.getItem("linkedInAccounts");if(de)try{oe(JSON.parse(de))}catch(ve){console.error("Error parsing LinkedIn accounts:",ve),oe([])}else oe([])},[]);const We=()=>{if(he.trim()&&!be.includes(he.trim())){const de=[...be,he.trim()];oe(de),localStorage.setItem("linkedInAccounts",JSON.stringify(de)),F(ve=>({...ve,linkedInAccountName:he.trim()})),ye(""),fe(!1)}},se=async()=>{try{const de=await Ht.get(`/activities/${S}`);if(de.data.success){const ve=de.data.data;F({template:ve.template||"",outcome:ve.outcome||"",conversationNotes:ve.conversationNotes||"",nextAction:ve.nextAction||"",nextActionDate:ve.nextActionDate?new Date(ve.nextActionDate).toISOString().split("T")[0]:"",phoneNumber:ve.phoneNumber||v||"",email:ve.email||w||"",linkedInUrl:ve.linkedInUrl||N||"",status:ve.status||"",linkedInAccountName:ve.linkedInAccountName||"",lnRequestSent:ve.lnRequestSent||"",connected:ve.connected||"",callNumber:ve.callNumber||"",callStatus:ve.callStatus||"",callDate:ve.callDate?new Date(ve.callDate).toISOString().split("T")[0]:"",emailDate:ve.emailDate?new Date(ve.emailDate).toISOString().split("T")[0]:ve.createdAt?new Date(ve.createdAt).toISOString().split("T")[0]:"",linkedinDate:ve.linkedinDate?new Date(ve.linkedinDate).toISOString().split("T")[0]:ve.createdAt?new Date(ve.createdAt).toISOString().split("T")[0]:""}),ce({phone:ve.phoneNumber||v||null,email:ve.email||w||null,linkedin:ve.linkedInUrl||N||null})}}catch(de){console.error("Error fetching activity data:",de),P({submit:"Couldn't load the activity details. Try refreshing."})}},me=async()=>{if(!m||!a)return null;try{const de=await Ht.get(`/activities/contact/${m}`);if(de.data.success&&de.data.data){const ke=de.data.data.filter(ne=>ne.type===a);if(ke.length>0)return ke.sort((ne,De)=>new Date(De.createdAt)-new Date(ne.createdAt)),ke[0]}}catch(de){console.error("Error fetching last activity by type:",de)}return null};if(B.useEffect(()=>{if(l&&!_e.current){setTimeout(()=>Ne(!0),10);const de=new Date().toISOString().split("T")[0];if(_e.current=!0,D&&S)se();else if(L){const ve=L;F({template:ve.template||"",outcome:ve.outcome||"",conversationNotes:ve.conversationNotes||"",nextAction:ve.nextAction||"",nextActionDate:ve.nextActionDate?new Date(ve.nextActionDate).toISOString().split("T")[0]:"",phoneNumber:ve.phoneNumber||v||"",email:ve.email||w||"",linkedInUrl:ve.linkedInUrl||N||"",status:ve.status||"",linkedInAccountName:ve.linkedInAccountName||"",lnRequestSent:ve.lnRequestSent||"",connected:ve.connected||"",callNumber:ve.callNumber||"",callStatus:ve.callStatus||"",callDate:ve.callDate?new Date(ve.callDate).toISOString().split("T")[0]:ve.type==="call"?de:"",emailDate:ve.emailDate?new Date(ve.emailDate).toISOString().split("T")[0]:ve.type==="email"?de:"",linkedinDate:ve.linkedinDate?new Date(ve.linkedinDate).toISOString().split("T")[0]:ve.type==="linkedin"?de:""}),ce({phone:ve.phoneNumber||v||null,email:ve.email||w||null,linkedin:ve.linkedInUrl||N||null}),ve.type!==a&&me().then(ke=>{ke&&F(ne=>{const De={...ne};return a==="call"&&ke.callDate?De.callDate=new Date(ke.callDate).toISOString().split("T")[0]:a==="email"&&ke.emailDate?De.emailDate=new Date(ke.emailDate).toISOString().split("T")[0]:a==="linkedin"&&ke.linkedinDate&&(De.linkedinDate=new Date(ke.linkedinDate).toISOString().split("T")[0]),De})})}else F(ve=>({...ve,phoneNumber:v||"",email:w||"",linkedInUrl:N||"",callDate:a==="call"?de:"",emailDate:a==="email"?de:"",linkedinDate:a==="linkedin"?de:""})),ce({phone:v||null,email:w||null,linkedin:N||null}),me().then(ve=>{ve&&F(ke=>{const ne={...ke};return a==="call"&&ve.callDate?ne.callDate=new Date(ve.callDate).toISOString().split("T")[0]:a==="email"&&ve.emailDate?ne.emailDate=new Date(ve.emailDate).toISOString().split("T")[0]:a==="linkedin"&&ve.linkedinDate&&(ne.linkedinDate=new Date(ve.linkedinDate).toISOString().split("T")[0]),ne})})}else l||(Ne(!1),_e.current=!1)},[l,D,S,a,v,w,N,m||null,L?._id]),!l)return null;const W=()=>{const de="w-5 h-5";switch(a){case"call":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${de} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${de} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${de} text-white`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},pe=()=>{if(D)switch(a){case"call":return"Edit Call Activity";case"email":return"Edit Email Activity";case"linkedin":return"Edit LinkedIn Activity";default:return"Edit Activity"}switch(a){case"call":return"Log Call Activity";case"email":return"Log Email Activity";case"linkedin":return"Log LinkedIn Activity";default:return"Log Activity"}},Me=()=>{switch(a){case"call":return"from-green-50 to-emerald-50";case"email":return"from-blue-50 to-cyan-50";case"linkedin":return"from-blue-50 to-indigo-50";default:return"from-gray-50 to-gray-100"}},Se=(de,ve)=>{F(ke=>({...ke,[de]:ve})),O[de]&&P(ke=>({...ke,[de]:""}))},V=()=>{const de={};if(M.nextAction&&!M.nextActionDate&&(de.nextActionDate="Next action date is required when next action is specified"),M.nextActionDate){const ve=new Date(M.nextActionDate),ke=new Date,ne=new Date(ke);ne.setDate(ne.getDate()+7),ve>ne&&(de.nextActionDate="Next action must be scheduled within 7 days")}return P(de),Object.keys(de).length===0},H=async de=>{if(de.preventDefault(),!!V()){ae(!0);try{const ve=M.conversationNotes.trim()||"";let ke;const ne=M.callDate&&M.callDate.trim()?M.callDate.trim():null,De=M.emailDate&&M.emailDate.trim()?M.emailDate.trim():null,He=M.linkedinDate&&M.linkedinDate.trim()?M.linkedinDate.trim():null;if(D&&S?ke=await Ht.put(`/activities/${S}`,{template:M.template,conversationNotes:ve,nextAction:M.nextAction,nextActionDate:M.nextActionDate,phoneNumber:M.phoneNumber||v||null,email:M.email||w||null,linkedInUrl:M.linkedInUrl||N||null,status:M.status||null,linkedInAccountName:M.linkedInAccountName||null,lnRequestSent:M.lnRequestSent||null,connected:M.connected||null,callNumber:M.callNumber||null,callStatus:M.callStatus||null,callDate:ne,emailDate:De,linkedinDate:He}):ke=await Ht.post("/activities",{projectId:e,contactId:m||null,type:a,template:M.template,outcome:null,conversationNotes:ve,nextAction:M.nextAction,nextActionDate:M.nextActionDate,phoneNumber:M.phoneNumber||v||null,email:M.email||w||null,linkedInUrl:M.linkedInUrl||N||null,status:M.status||null,linkedInAccountName:M.linkedInAccountName||null,lnRequestSent:M.lnRequestSent||null,connected:M.connected||null,callNumber:M.callNumber||null,callStatus:M.callStatus||null,callDate:ne,emailDate:De,linkedinDate:He}),ke.data.success&&M.status&&m&&e)try{await Ht.put(`/projects/${e}/project-contacts/${m}`,{stage:M.status})}catch(vt){console.error("Error updating contact status:",vt)}ke.data.success?(F({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:v||"",email:w||"",linkedInUrl:N||"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),n(!0)):P({submit:ke.data.error||"Couldn't save that activity. Give it another try."})}catch(ve){console.error("Error saving activity:",ve);const ke=ve.response?.data?.error||ve.message||"Something went wrong saving the activity. Try again.";P({submit:ke})}finally{ae(!1)}}},Q=()=>{F({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),P({}),ce({phone:null,email:null,linkedin:null}),we({phone:!1,email:!1,linkedin:!1}),Le(!1),n()},te=async(de,ve,ke)=>{if(m){we(ne=>({...ne,[de]:!0}));try{const ne={[ke]:ve||""};await Ht.put(`/contacts/${m}`,ne),ce(De=>({...De,[de]:ve||null})),de==="phone"?F(De=>({...De,phoneNumber:ve||""})):de==="email"?F(De=>({...De,email:ve||""})):de==="linkedin"&&F(De=>({...De,linkedInUrl:ve||""}))}catch(ne){console.error(`Error saving ${de}:`,ne),P({submit:`Couldn't save ${de}. Give it another shot.`})}finally{we(ne=>({...ne,[de]:!1}))}}};return t.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${re?"opacity-100":"opacity-0"}`,onClick:Q,children:t.jsxs("div",{className:`bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col transform transition-all duration-300 ${re?"scale-100 translate-y-0":"scale-95 translate-y-4"}`,onClick:de=>de.stopPropagation(),children:[t.jsx("div",{className:`bg-gradient-to-r ${Me()} border-b border-gray-200 p-4 flex-shrink-0`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[ue&&t.jsx("button",{onClick:()=>Le(!1),className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-600 hover:text-gray-900 hover:bg-white/50 transition-all duration-200 group",title:"Back to form",children:t.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("div",{className:"animate-pulse-once",children:W()}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-0.5",children:ue&&a==="linkedin"?"LinkedIn Message Variations":ue&&a==="email"?"Email Variations":pe()}),!ue&&t.jsxs("p",{className:"text-xs text-gray-600 font-medium",children:[o," - ",s]})]})]}),t.jsx("button",{onClick:Q,className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-400 hover:text-gray-600 hover:bg-white/50 transition-all duration-200 group",children:t.jsx("svg",{className:"w-5 h-5 group-hover:rotate-90 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),ue&&a==="linkedin"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Existing"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm usually in touch with teams managing residential projects and leasing, so I was just curious how you manage bookings, rentals, and property maintenance across your units."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I mostly connect with people working in residential and leasing rolesit keeps me close to how things really move on a day-to-day basis."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"The world today feels like one connected marketplace, and being part of the real estate ecosystem, I enjoy connecting with people who are building and managing things on the ground. Looking forward to connecting and exchanging perspectives."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I've noticed that no two property teams manage bookings, rentals, and maintenance the same way. I'm always interested in hearing how others handle it in practice."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Always open to exchanging thoughts and learning how things are shaping up on your side. Would be great to stay connected."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We work closely with property teams to simplify how day-to-day operations are managed  from rentals and billing to maintenance  so things feel more connected and easier to handle."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Everyday operational conversations around properties quietly offer the most value in understanding how things really work."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Enjoy grounded conversations around real work and real challenges. Happy to stay connected and exchange insights whenever it makes sense."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We believe real value often comes from reducing small operational frictions and giving teams better visibility into what's happening across their properties."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm always interested in seeing how teams optimize their workflowsdo you have any strategies that make managing bookings and maintenance simpler?"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I value thoughtful conversations with people close to the work. Whenever it feels right, I'd enjoy exchanging insights as things evolve on your side."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"No worries if you didn't catch my earlier message. Just checking if you're up for a chat about possible ways we can team up and grow together."})]})]})]})})})}):ue&&a==="email"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300 w-[15%]",children:"Email"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 4"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I work closely with people involved in residential projects and leasing, and I enjoy staying connected with those who are close to the day-to-day side of property work."}),t.jsx("p",{children:"At Terabits, we focus on making everyday property operations a little easier by keeping rentals, billing, and maintenance in one place."}),t.jsx("p",{children:"Happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working close to residential projects and leasing. I've found those conversations tend to be the most honest and practical."}),t.jsx("p",{children:"I'm part of the Terabits team, where we focus on making everyday property operations easier to manage."}),t.jsx("p",{children:"Nice to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"font-semibold",children:"Subject: Exchanging notes on leasing & residential work"}),t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working on residential projects and leasing. I've found these conversations to be the most practical."}),t.jsx("p",{children:'When it comes to daily management, where do you usually find the most friction or "extra work" in your current process?'})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I tend to reach out to people in residential leasing because the conversations are usually more practical."}),t.jsx("p",{children:`I'm curiouswhen it comes to your daily management, where do things usually get stuck or feel like a "headache" for your team?`}),t.jsx("p",{children:"Nice to connect,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just wanted to follow up on my last note."}),t.jsx("p",{children:"We usually speak with property teams who want a bit more clarity in their daily workflows without changing how they already operate."}),t.jsx("p",{children:"Always good to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just sharing a short follow-up."}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing without adding extra complexity to daily work."}),t.jsx("p",{children:"Happy to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing."}),t.jsx("p",{children:"This is where Terabits usually steps inwe focus on making those everyday operations feel less like a chore so you can focus on the bigger picture."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"That's usually where we come in. At Terabits, we focus on making those messy partslike rentals, maintenance, and billingfeel a lot more manageable."}),t.jsx("p",{children:"We try to keep the tech simple so it actually helps the team instead of adding more work to their day."}),t.jsx("p",{children:"Happy to stay in touch,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing we often notice is that small improvements in visibility can make day-to-day property work feel much more manageable."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that even small clarity in systems can make a big difference in day-to-day property operations."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that small clarity in systems makes a big difference."}),t.jsx("p",{children:"Specifically, we help by automating the repetitive stufflike tracking maintenance requests or streamlining billing workflowswithout adding extra complexity to your day-to-day work."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I've noticed is that just adding a bit of clarity to maintenance tracking or billing can save a lot of hours."}),t.jsx("p",{children:"We mostly help by automating those repetitive tasks so they just happen in the background. It's a small change that usually makes the day-to-day much smoother."}),t.jsx("p",{children:"Thought I'd share that."})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here for now."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Wishing you a great week ahead."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Take care."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here as I don't want to crowd your inbox."}),t.jsx("p",{children:"If you ever want to swap notes on how to make property workflows easier, I'm always happy to chat."}),t.jsx("p",{children:"Wishing you the best,"})]})})]})]})]})})})}):t.jsx("form",{onSubmit:H,className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsxs("div",{className:"space-y-4",children:[a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Phone Number ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("input",{type:"tel",value:M.phoneNumber,onChange:de=>Se("phoneNumber",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:Z.phone||v?"":"Add phone number (e.g., +1 234-567-8900)"})]}),m&&t.jsx("button",{type:"button",onClick:()=>te("phone",M.phoneNumber,"firstPhone"),disabled:xe.phone,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database",children:xe.phone?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),(Z.phone||v)&&t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Z.phone?`Saved in database: ${Z.phone}`:`Fetched from database: ${v}`]})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Address ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("input",{type:"email",value:M.email,onChange:de=>Se("email",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:Z.email||w?"":"Add email address (e.g., contact@example.com)"})]}),m&&t.jsx("button",{type:"button",onClick:()=>te("email",M.email,"email"),disabled:xe.email,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database",children:xe.email?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),(Z.email||w)&&t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Z.email?`Saved in database: ${Z.email}`:`Fetched from database: ${w}`]})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:M.emailDate,onChange:de=>Se("emailDate",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:"Select email date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the email was sent"]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Profile URL ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("input",{type:"url",value:M.linkedInUrl,onChange:de=>Se("linkedInUrl",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:Z.linkedin||N?"":"Add LinkedIn profile URL (e.g., https://linkedin.com/in/username)"})]}),m&&t.jsx("button",{type:"button",onClick:()=>te("linkedin",M.linkedInUrl,"personLinkedinUrl"),disabled:xe.linkedin,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database",children:xe.linkedin?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),(Z.linkedin||N)&&t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Z.linkedin?t.jsxs(t.Fragment,{children:["Saved in database: ",t.jsx("a",{href:Z.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:Z.linkedin})]}):t.jsxs(t.Fragment,{children:["Fetched from database: ",t.jsx("a",{href:N,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:N})]})]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:M.linkedinDate,onChange:de=>Se("linkedinDate",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:"Select LinkedIn date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the LinkedIn activity occurred"]})]}),a!=="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700",children:"Select Template (Optional)"}),(a==="linkedin"||a==="email")&&t.jsxs("button",{type:"button",onClick:()=>Le(!0),className:"px-3 py-1.5 text-xs font-semibold text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-all duration-200 flex items-center gap-1.5",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a==="email"?"View Email Variations":"View Message Variations"]})]}),t.jsxs("select",{value:M.template,onChange:de=>Se("template",de.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"no-template",children:"No Template"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"introduction-email",children:"Introduction Email"}),t.jsx("option",{value:"follow-up-email",children:"Follow-up Email"}),t.jsx("option",{value:"value-proposition-email",children:"Value Proposition Email"})]}):a==="linkedin"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"connection-request-message",children:"Connection Request Message"}),t.jsx("option",{value:"introduction-message",children:"Introduction Message"}),t.jsx("option",{value:"follow-up-message",children:"Follow-up Message"})]}):null]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Use a pre-defined template for consistency"]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Account Used ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsxs("select",{value:M.linkedInAccountName,onChange:de=>Se("linkedInAccountName",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select LinkedIn account"}),be.map((de,ve)=>t.jsx("option",{value:de,children:de},ve))]})]}),t.jsx("button",{type:"button",onClick:()=>fe(!Te),className:"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors whitespace-nowrap",children:Te?"Cancel":"+ Add"})]}),Te&&t.jsxs("div",{className:"mt-3 flex gap-2",children:[t.jsx("input",{type:"text",value:he,onChange:de=>ye(de.target.value),onKeyPress:de=>{de.key==="Enter"&&(de.preventDefault(),We())},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter new LinkedIn account name"}),t.jsx("button",{type:"button",onClick:We,disabled:!he.trim()||be.includes(he.trim()),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Add"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select or add a LinkedIn account that sent the connection request"]})]}),a==="linkedin"&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Ln Request Sent ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.lnRequestSent,onChange:de=>Se("lnRequestSent",de.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"}),t.jsx("option",{value:"Existing Connect",children:"Existing Connect"}),t.jsx("option",{value:"Inactive Profile",children:"Inactive Profile"}),t.jsx("option",{value:"Irrelevant Profile",children:"Irrelevant Profile"}),t.jsx("option",{value:"Open to Work",children:"Open to Work"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status of the LinkedIn connection request"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Connected ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.connected,onChange:de=>Se("connected",de.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Whether the connection was established"]})]})]}),(a==="email"||a==="linkedin")&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.status,onChange:de=>Se("status",de.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 ${O.status?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select status"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Out of Office",children:"Out of Office"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Wrong Person",children:"Wrong Person"}),t.jsx("option",{value:"Bounce",children:"Bounce"}),t.jsx("option",{value:"Opt-Out",children:"Opt-Out"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"})]}):t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"CIP",children:"CIP"}),t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"In-Person Meeting",children:"In-Person Meeting"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"}),t.jsx("option",{value:"SQL",children:"SQL"}),t.jsx("option",{value:"Tech Discussion",children:"Tech Discussion"}),t.jsx("option",{value:"WON",children:"WON"}),t.jsx("option",{value:"Lost",children:"Lost"}),t.jsx("option",{value:"Low Potential - Open",children:"Low Potential - Open"}),t.jsx("option",{value:"Potential Future",children:"Potential Future"})]})]}),O.status&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),O.status]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a==="email"?"Update the contact status based on this email interaction":"Update the contact status based on this interaction"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Call ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsx("div",{children:t.jsxs("select",{value:M.callNumber,onChange:de=>Se("callNumber",de.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select call number"}),t.jsx("option",{value:"1st call",children:"1st call"}),t.jsx("option",{value:"2nd call",children:"2nd call"}),t.jsx("option",{value:"3rd call",children:"3rd call"}),t.jsx("option",{value:"4th call",children:"4th call"}),t.jsx("option",{value:"5th call",children:"5th call"}),t.jsx("option",{value:"6th call",children:"6th call"}),t.jsx("option",{value:"7th call",children:"7th call"}),t.jsx("option",{value:"8th call",children:"8th call"}),t.jsx("option",{value:"9th call",children:"9th call"}),t.jsx("option",{value:"10th call",children:"10th call"})]})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:M.callDate,onChange:de=>Se("callDate",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:"Select call date"})]})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select which call attempt this is and the date when the call was made"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.callStatus,onChange:de=>Se("callStatus",de.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select status"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Ring",children:"Ring"}),t.jsx("option",{value:"Busy",children:"Busy"}),t.jsx("option",{value:"Call Back",children:"Call Back"}),t.jsx("option",{value:"Hang Up",children:"Hang Up"}),t.jsx("option",{value:"Switch Off",children:"Switch Off"}),t.jsx("option",{value:"Future",children:"Future"}),t.jsx("option",{value:"Details Shared",children:"Details Shared"}),t.jsx("option",{value:"Demo Booked",children:"Demo Booked"}),t.jsx("option",{value:"Invalid",children:"Invalid"}),t.jsx("option",{value:"Existing",children:"Existing"}),t.jsx("option",{value:"Demo Completed",children:"Demo Completed"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the status of this call"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Conversation Notes ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(optional, but helpful)"})]}),t.jsx("textarea",{value:M.conversationNotes,onChange:de=>Se("conversationNotes",de.target.value),rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 resize-y font-sans hover:border-gray-400",placeholder:"Document key points, objections, interests, and next steps discussed... (Optional)"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.nextAction,onChange:de=>Se("nextAction",de.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 ${O.nextAction?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"follow-up-call",children:"Follow-up Call"}),t.jsx("option",{value:"send-proposal",children:"Send Proposal"}),t.jsx("option",{value:"schedule-meeting",children:"Schedule Meeting"}),t.jsx("option",{value:"send-email",children:"Send Email"}),t.jsx("option",{value:"connect-linkedin",children:"Connect on LinkedIn"})]}),O.nextAction&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),O.nextAction]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"What should happen next?"})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action Date ",t.jsx("span",{className:M.nextAction?"text-red-500":"text-gray-400 text-xs font-normal",children:M.nextAction?"*":"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",value:M.nextActionDate,onChange:de=>Se("nextActionDate",de.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 ${O.nextActionDate?"border-red-300 bg-red-50":"border-gray-300"}`}),t.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]}),O.nextActionDate&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),O.nextActionDate]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"When should this happen?"})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-4 shadow-sm hover:shadow-md transition-all duration-200",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-lg flex items-center justify-center flex-shrink-0 animate-pulse",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-xs font-bold text-blue-900 mb-2",children:"Quality Check Requirements:"}),t.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),t.jsx("span",{children:"Add notes to keep track of what happened during this interaction"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),t.jsx("span",{children:"Next action must be scheduled within 7 days"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),t.jsx("span",{children:"Next Action and Next Action Date are optional"})]})]})]})]})}),O.submit&&t.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-3 animate-shake",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-medium text-red-700",children:O.submit})]})}),t.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-200",children:[t.jsx("button",{type:"button",onClick:Q,className:"px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 shadow-sm hover:shadow-md",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:G,className:"px-4 py-2 text-xs font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:hover:scale-100",children:G?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Activity"]})})]})]})})]})})}const Gf=l=>l.type==="call"&&l.callDate?new Date(l.callDate):l.type==="email"&&l.emailDate?new Date(l.emailDate):l.type==="linkedin"&&l.linkedinDate?new Date(l.linkedinDate):new Date(l.createdAt);function $k(){const{id:l}=ci(),n=Fr(),[a]=n0(),o=a.get("projectId"),s=a.get("returnTo")||"/projects",[e,m]=B.useState(null),[v,w]=B.useState([]),[N,S]=B.useState(!0),[D,L]=B.useState(null),[M,F]=B.useState("all"),[O,P]=B.useState(!1),[G,ae]=B.useState({name:"",email:"",firstPhone:"",personLinkedinUrl:"",company:""}),[re,Ne]=B.useState(!1),[xe,we]=B.useState({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,activityId:null,editMode:!1});B.useEffect(()=>{l&&(Z(),oe())},[l]);const Z=async()=>{try{const V=await Ht.get(`/contacts/${l}`),H=V.data?.data||V.data;m(H),ae({name:H?.name||"",email:H?.email||"",firstPhone:H?.firstPhone||"",personLinkedinUrl:H?.personLinkedinUrl||H?.companyLinkedinUrl||"",company:H?.company||""})}catch(V){console.error("Error fetching contact:",V),L("Couldn't load the contact details. Try refreshing the page.")}},ce=()=>{P(!0)},ue=()=>{P(!1),e&&ae({name:e.name||"",email:e.email||"",firstPhone:e.firstPhone||"",personLinkedinUrl:e.personLinkedinUrl||e.companyLinkedinUrl||"",company:e.company||""})},Le=async()=>{if(l){Ne(!0);try{const V={name:G.name.trim(),email:G.email.trim(),firstPhone:G.firstPhone.trim(),personLinkedinUrl:G.personLinkedinUrl.trim(),company:G.company.trim()},H=await Ht.put(`/contacts/${l}`,V);H.data.success&&(m(H.data.data),P(!1),oe())}catch(V){console.error("Error updating contact:",V),alert(V.response?.data?.error||"Couldn't save those changes. Give it another try.")}finally{Ne(!1)}}},be=(V,H)=>{ae(Q=>({...Q,[V]:H}))},oe=async()=>{try{S(!0);const V=await Ht.get(`/activities/contact/${l}`);V.data.success&&w(V.data.data||[]),L(null)}catch(V){console.error("Error fetching activities:",V),L("Having trouble loading the activity history. Refresh the page and try again.")}finally{S(!1)}},he=(V,H=null)=>{e&&we({isOpen:!0,type:H?H.type:V,contactName:e.name||"N/A",companyName:e.company||"",projectId:H?H.projectId?._id||H.projectId:o||null,contactId:l,phoneNumber:e.firstPhone||null,email:e.email||null,linkedInProfileUrl:e.personLinkedinUrl||e.companyLinkedinUrl||null,activityId:H?H._id:null,editMode:!!H})},ye=(V=!1)=>{we({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,activityId:null,editMode:!1}),V&&s?setTimeout(()=>{n(s)},100):oe()},Te=V=>{if(!V)return"?";const H=V.trim().split(/\s+/);return H.length>=2?(H[0][0]+H[H.length-1][0]).toUpperCase():V.substring(0,2).toUpperCase()},fe=V=>{if(!V)return"N/A";const H=V instanceof Date?V:new Date(V);return isNaN(H.getTime())?"N/A":H.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},_e=V=>{if(!V)return"N/A";const H=V instanceof Date?V:new Date(V);return isNaN(H.getTime())?"N/A":H.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},We=V=>{switch(V){case"call":return t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-md",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-md",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center shadow-md",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},se=V=>{switch(V){case"call":return"Call";case"email":return"Email";case"linkedin":return"LinkedIn";default:return"Activity"}},me=v.filter(V=>M==="all"?!0:V.type===M).sort((V,H)=>Gf(H)-Gf(V)),W=v.filter(V=>V.type==="call"),pe=v.filter(V=>V.type==="email"),Me=v.filter(V=>V.type==="linkedin"),Se=V=>{const Q={"connected-had-conversation":{bg:"bg-green-100",text:"text-green-800",label:"Connected"},"left-voicemail":{bg:"bg-blue-100",text:"text-blue-800",label:"Voicemail"},"no-answer":{bg:"bg-gray-100",text:"text-gray-800",label:"No Answer"},"email-sent-successfully":{bg:"bg-green-100",text:"text-green-800",label:"Sent"},"received-reply":{bg:"bg-purple-100",text:"text-purple-800",label:"Reply Received"},"connection-request-sent":{bg:"bg-blue-100",text:"text-blue-800",label:"Request Sent"},"message-sent":{bg:"bg-green-100",text:"text-green-800",label:"Message Sent"}}[V]||{bg:"bg-gray-100",text:"text-gray-800",label:V};return t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Q.bg} ${Q.text}`,children:Q.label})};return N?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse"}),t.jsx("div",{className:"relative animate-spin rounded-full h-14 w-14 border-2 border-gray-200 border-t-gray-900 mx-auto"})]}),t.jsx("p",{className:"tracking-wide text-sm uppercase text-gray-500 font-medium",children:"Loading activity history..."})]})}):D&&!e?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[t.jsx("div",{className:"w-20 h-20 mx-auto bg-red-100 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-10 h-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Contact"}),t.jsx("p",{className:"text-gray-600 mb-6",children:D}),t.jsxs("button",{onClick:()=>n(s),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})]})]})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8",children:[t.jsx("nav",{className:"mb-6 animate-fade-in-down",children:t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[t.jsxs("button",{onClick:()=>n(s),className:"hover:text-gray-900 transition-colors duration-200 flex items-center gap-1.5 font-medium",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),t.jsx("span",{children:"Back"})]}),t.jsx("svg",{className:"w-4 h-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),t.jsx("span",{className:"text-gray-700 font-semibold",children:"Activity History"})]})}),t.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-2xl border border-gray-200 shadow-lg p-6 lg:p-8 animate-fade-in-up",children:t.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:items-start gap-6 lg:gap-8",children:[t.jsxs("div",{className:"relative flex-shrink-0",children:[t.jsx("div",{className:"w-20 h-20 lg:w-24 lg:h-24 bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center text-2xl lg:text-3xl font-bold text-white shadow-xl ring-4 ring-blue-50 transform hover:scale-105 transition-transform duration-200",children:e?Te(e.name):"?"}),t.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-4 border-white shadow-md"})]}),t.jsx("div",{className:"flex-1 min-w-0 w-full lg:w-auto text-center lg:text-left",children:O?t.jsxs("div",{className:"space-y-4 w-full max-w-2xl",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),t.jsx("input",{type:"text",value:G.name,onChange:V=>be("name",V.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Contact name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),t.jsx("input",{type:"text",value:G.company,onChange:V=>be("company",V.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Company name"})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),t.jsx("input",{type:"email",value:G.email,onChange:V=>be("email",V.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"email@example.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),t.jsx("input",{type:"tel",value:G.firstPhone,onChange:V=>be("firstPhone",V.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+1234567890"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LinkedIn URL"}),t.jsx("input",{type:"url",value:G.personLinkedinUrl,onChange:V=>be("personLinkedinUrl",V.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://linkedin.com/in/..."})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:Le,disabled:re,className:"px-6 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:re?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})}),t.jsx("button",{onClick:ue,disabled:re,className:"px-6 py-2 bg-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-300 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-2 tracking-tight",children:e?.name||"Contact"}),e?.company&&t.jsx("p",{className:"text-gray-600 text-lg lg:text-xl font-medium",children:e.company})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-center sm:items-center justify-center lg:justify-start gap-4 text-gray-600 text-sm",children:[e?.email&&t.jsxs("a",{href:`mailto:${e.email}`,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-50 hover:bg-blue-50 rounded-lg transition-colors duration-200 border border-gray-200 hover:border-blue-200 group",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{className:"font-medium",children:e.email})]}),e?.firstPhone&&t.jsxs("a",{href:`tel:${e.firstPhone}`,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-50 hover:bg-green-50 rounded-lg transition-colors duration-200 border border-gray-200 hover:border-green-200 group",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-green-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{className:"font-medium",children:e.firstPhone})]}),e?.personLinkedinUrl&&t.jsxs("a",{href:e.personLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-1.5 bg-gray-50 hover:bg-blue-50 rounded-lg transition-colors duration-200 border border-gray-200 hover:border-blue-200 group",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("span",{className:"font-medium",children:"LinkedIn"})]})]})]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full lg:w-auto",children:[!O&&t.jsxs("button",{onClick:ce,className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white font-semibold text-sm rounded-xl hover:from-gray-700 hover:to-gray-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),t.jsx("span",{children:"Edit Contact"})]}),!O&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>he("call"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white font-semibold text-sm rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{children:"Log Call"})]}),t.jsxs("button",{onClick:()=>he("email"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold text-sm rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{children:"Log Email"})]}),t.jsxs("button",{onClick:()=>he("linkedin"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-700 to-indigo-700 text-white font-semibold text-sm rounded-xl hover:from-blue-800 hover:to-indigo-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("span",{children:"Log LinkedIn"})]})]})]})]})})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-10",children:[D&&t.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 text-red-700 px-5 py-4 rounded-xl shadow-md animate-shake",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),t.jsx("span",{className:"font-medium",children:D})]})}),v.length>0&&t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-8",children:[t.jsx("div",{onClick:()=>F("all"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="all"?"from-blue-500 to-blue-600 border-blue-400 text-white":"from-white to-blue-50 border-blue-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="all"?"text-blue-100":"text-gray-600"}`,children:"Total Activities"}),t.jsx("p",{className:`text-3xl font-bold ${M==="all"?"text-white":"text-gray-900"}`,children:v.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="all"?"text-blue-100":"text-gray-500"}`,children:"All interactions"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="all"?"bg-white bg-opacity-20":"bg-gradient-to-br from-blue-500 to-blue-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})]})}),t.jsx("div",{onClick:()=>F("call"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="call"?"from-green-500 to-green-600 border-green-400 text-white":"from-white to-green-50 border-green-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="call"?"text-green-100":"text-gray-600"}`,children:"Calls"}),t.jsx("p",{className:`text-3xl font-bold ${M==="call"?"text-white":"text-gray-900"}`,children:W.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="call"?"text-green-100":"text-gray-500"}`,children:"Phone interactions"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="call"?"bg-white bg-opacity-20":"bg-gradient-to-br from-green-500 to-green-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]})}),t.jsx("div",{onClick:()=>F("email"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="email"?"from-blue-500 to-blue-600 border-blue-400 text-white":"from-white to-blue-50 border-blue-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="email"?"text-blue-100":"text-gray-600"}`,children:"Emails"}),t.jsx("p",{className:`text-3xl font-bold ${M==="email"?"text-white":"text-gray-900"}`,children:pe.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="email"?"text-blue-100":"text-gray-500"}`,children:"Email outreach"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="email"?"bg-white bg-opacity-20":"bg-gradient-to-br from-blue-500 to-blue-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]})}),t.jsx("div",{onClick:()=>F("linkedin"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="linkedin"?"from-indigo-500 to-indigo-600 border-indigo-400 text-white":"from-white to-indigo-50 border-indigo-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="linkedin"?"text-indigo-100":"text-gray-600"}`,children:"LinkedIn"}),t.jsx("p",{className:`text-3xl font-bold ${M==="linkedin"?"text-white":"text-gray-900"}`,children:Me.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="linkedin"?"text-indigo-100":"text-gray-500"}`,children:"LinkedIn activities"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="linkedin"?"bg-white bg-opacity-20":"bg-gradient-to-br from-indigo-500 to-indigo-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})})]})}),(()=>{const V=v.filter(ve=>ve.type==="linkedin"&&ve.status),H=V.length>0?V.sort((ve,ke)=>Gf(ke)-Gf(ve))[0].status:null;if(!H)return null;const Q=ve=>{switch(ve){case"CIP":return"from-white to-blue-50 border-blue-200";case"No Reply":return"from-white to-gray-50 border-gray-200";case"Not Interested":return"from-white to-red-50 border-red-200";case"Meeting Proposed":return"from-white to-yellow-50 border-yellow-200";case"Meeting Scheduled":return"from-white to-cyan-50 border-cyan-200";case"In-Person Meeting":return"from-white to-indigo-50 border-indigo-200";case"Meeting Completed":return"from-white to-green-50 border-green-200";case"SQL":return"from-white to-emerald-50 border-emerald-200";case"Tech Discussion":return"from-white to-purple-50 border-purple-200";case"WON":return"from-white to-green-100 border-green-400 border-2";case"Lost":return"from-white to-red-100 border-red-400 border-2";case"Low Potential - Open":return"from-white to-orange-50 border-orange-200";case"Potential Future":return"from-white to-teal-50 border-teal-200";default:return"from-white to-gray-50 border-gray-200"}},te=ve=>{switch(ve){case"CIP":return"text-blue-800";case"No Reply":return"text-gray-800";case"Not Interested":return"text-red-800";case"Meeting Proposed":return"text-yellow-800";case"Meeting Scheduled":return"text-cyan-800";case"In-Person Meeting":return"text-indigo-800";case"Meeting Completed":return"text-green-800";case"SQL":return"text-emerald-800";case"Tech Discussion":return"text-purple-800";case"WON":return"text-green-900";case"Lost":return"text-red-900";case"Low Potential - Open":return"text-orange-800";case"Potential Future":return"text-teal-800";default:return"text-gray-800"}},de=ve=>{switch(ve){case"CIP":return"bg-blue-100 border-blue-200";case"No Reply":return"bg-gray-100 border-gray-200";case"Not Interested":return"bg-red-100 border-red-200";case"Meeting Proposed":return"bg-yellow-100 border-yellow-200";case"Meeting Scheduled":return"bg-cyan-100 border-cyan-200";case"In-Person Meeting":return"bg-indigo-100 border-indigo-200";case"Meeting Completed":return"bg-green-100 border-green-200";case"SQL":return"bg-emerald-100 border-emerald-200";case"Tech Discussion":return"bg-purple-100 border-purple-200";case"WON":return"bg-green-200 border-green-400 border-2";case"Lost":return"bg-red-200 border-red-400 border-2";case"Low Potential - Open":return"bg-orange-100 border-orange-200";case"Potential Future":return"bg-teal-100 border-teal-200";default:return"bg-gray-100 border-gray-200"}};return t.jsx("div",{className:`bg-gradient-to-br ${Q(H)} rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-shadow duration-200`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-semibold uppercase tracking-wide mb-1",children:"Current Status"}),t.jsx("p",{className:`text-2xl font-bold ${te(H)} mb-1`,children:H}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Latest LinkedIn activity"})]}),t.jsx("div",{className:`w-14 h-14 ${de(H)} rounded-xl flex items-center justify-center shadow-lg`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})})]})})})()]}),v.length>0&&t.jsx("div",{className:"mb-6 bg-white rounded-2xl border border-gray-200 shadow-lg p-2",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs("button",{onClick:()=>F("all"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="all"?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"All (",v.length,")"]}),t.jsxs("button",{onClick:()=>F("call"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="call"?"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Calls (",W.length,")"]}),t.jsxs("button",{onClick:()=>F("email"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="email"?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Emails (",pe.length,")"]}),t.jsxs("button",{onClick:()=>F("linkedin"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="linkedin"?"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),"LinkedIn (",Me.length,")"]})]})}),v.length===0?t.jsxs("div",{className:"text-center py-20 bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-lg border border-gray-200 animate-fade-in",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-2xl bg-gradient-to-br from-gray-100 to-gray-200 mb-6 shadow-inner",children:t.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),t.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No activities yet"}),t.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto text-lg",children:"Start logging activities to track your interactions with this contact and build a comprehensive engagement history."}),t.jsx("div",{className:"flex justify-center gap-3",children:t.jsxs("button",{onClick:()=>he("call"),className:"inline-flex items-center gap-2 px-6 py-3.5 bg-gradient-to-r from-green-600 to-green-700 text-white font-semibold rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-100",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Log First Activity"]})})]}):t.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-lg overflow-hidden",children:[t.jsx("div",{className:"px-6 lg:px-8 py-5 bg-gradient-to-r from-gray-50 to-white border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Activity Timeline"}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Complete interaction history with ",e?.name]})]}),t.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-3 py-1.5 bg-blue-50 rounded-lg border border-blue-100",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("span",{className:"text-xs font-semibold text-blue-700",children:[v.length," ",v.length===1?"activity":"activities"]})]})]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:me.length===0?t.jsxs("div",{className:"text-center py-16",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gray-100 mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:["No ",M==="all"?"":M," activities found"]}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Try selecting a different filter or log a new activity."}),t.jsxs("button",{onClick:()=>{he({call:"call",email:"email",linkedin:"linkedin"}[M]||"call")},className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Log ",M==="all"?"Activity":M.charAt(0).toUpperCase()+M.slice(1)]})]}):me.map((V,H)=>t.jsx("div",{className:"p-6 lg:p-8 hover:bg-gradient-to-r hover:from-gray-50 hover:to-white transition-all duration-200 group",children:t.jsxs("div",{className:"flex gap-5 lg:gap-6",children:[t.jsxs("div",{className:"flex-shrink-0 relative",children:[We(V.type),H<v.length-1&&t.jsx("div",{className:"absolute top-12 left-1/2 transform -translate-x-1/2 w-0.5 h-full bg-gradient-to-b from-gray-200 to-transparent"})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"flex items-start justify-between gap-4 mb-3",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:se(V.type)}),Se(V.outcome),V.status&&(V.type==="linkedin"||V.type==="email")&&t.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${V.status==="CIP"?"bg-blue-100 text-blue-800":V.status==="No Reply"?"bg-gray-100 text-gray-800":V.status==="Not Interested"?"bg-red-100 text-red-800":V.status==="Meeting Proposed"?"bg-yellow-100 text-yellow-800":V.status==="Meeting Scheduled"?"bg-cyan-100 text-cyan-800":V.status==="In-Person Meeting"?"bg-indigo-100 text-indigo-800":V.status==="Meeting Completed"?"bg-green-100 text-green-800":V.status==="SQL"?"bg-emerald-100 text-emerald-800":V.status==="Tech Discussion"?"bg-purple-100 text-purple-800":V.status==="WON"?"bg-green-200 text-green-900 border-2 border-green-400":V.status==="Lost"?"bg-red-200 text-red-900 border-2 border-red-400":V.status==="Low Potential - Open"?"bg-orange-100 text-orange-800":V.status==="Potential Future"?"bg-teal-100 text-teal-800":V.status==="Interested"?"bg-green-100 text-green-800":V.status==="Wrong Person"?"bg-orange-100 text-orange-800":V.status==="Bounce"?"bg-red-100 text-red-800":V.status==="Opt-Out"?"bg-gray-100 text-gray-800":V.status==="Out of Office"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:V.status})]}),t.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("span",{className:"font-medium",children:_e(Gf(V))})]}),V.projectId?.companyName&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-gray-300",children:""}),t.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 rounded-md text-xs font-medium",children:V.projectId.companyName})]})]})]})}),V.type==="call"&&(V.callNumber||V.callDate||V.callStatus)&&t.jsx("div",{className:"mb-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm",children:t.jsxs("div",{className:"flex flex-wrap gap-4",children:[V.callNumber&&t.jsxs("div",{className:"flex-1 min-w-[120px]",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Call"})]}),t.jsx("p",{className:"text-sm font-medium text-green-800",children:V.callNumber})]}),V.callDate&&t.jsxs("div",{className:"flex-1 min-w-[120px]",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Call Date"})]}),t.jsx("p",{className:"text-sm font-medium text-green-800",children:new Date(V.callDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),V.callStatus&&t.jsxs("div",{className:"flex-1 min-w-[120px]",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Status"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${V.callStatus==="Interested"?"bg-green-100 text-green-800":V.callStatus==="Not Interested"?"bg-red-100 text-red-800":V.callStatus==="Ring"?"bg-gray-100 text-gray-800":V.callStatus==="Busy"?"bg-blue-100 text-blue-800":V.callStatus==="Call Back"?"bg-purple-100 text-purple-800":V.callStatus==="Hang Up"?"bg-pink-100 text-pink-800":V.callStatus==="Switch Off"?"bg-amber-100 text-amber-800":V.callStatus==="Future"?"bg-indigo-100 text-indigo-800":V.callStatus==="Details Shared"?"bg-yellow-100 text-yellow-800":V.callStatus==="Demo Booked"?"bg-cyan-100 text-cyan-800":V.callStatus==="Invalid"?"bg-gray-100 text-gray-800":V.callStatus==="Existing"?"bg-orange-100 text-orange-800":(V.callStatus==="Demo Completed","bg-gray-100 text-gray-800")}`,children:V.callStatus})]})]})}),V.type==="linkedin"&&V.linkedInAccountName&&t.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wide",children:"LinkedIn Account Used"})]}),t.jsx("p",{className:"text-sm font-medium text-blue-800",children:V.linkedInAccountName})]}),V.type==="email"&&V.status&&t.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wide",children:"Status"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${V.status==="No Reply"?"bg-gray-100 text-gray-800":V.status==="Not Interested"?"bg-red-100 text-red-800":V.status==="Meeting Proposed"?"bg-yellow-100 text-yellow-800":V.status==="Meeting Scheduled"?"bg-cyan-100 text-cyan-800":V.status==="Meeting Completed"||V.status==="Interested"?"bg-green-100 text-green-800":V.status==="Wrong Person"?"bg-orange-100 text-orange-800":V.status==="Bounce"?"bg-red-100 text-red-800":V.status==="Opt-Out"?"bg-gray-100 text-gray-800":V.status==="Out of Office"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:V.status})]}),V.type==="linkedin"&&(V.lnRequestSent||V.connected)&&t.jsxs("div",{className:"mb-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[V.lnRequestSent&&t.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-semibold text-purple-900 uppercase tracking-wide",children:"Ln Request Sent"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${V.lnRequestSent==="Yes"?"bg-green-100 text-green-800":V.lnRequestSent==="No"?"bg-red-100 text-red-800":V.lnRequestSent==="Existing Connect"?"bg-blue-100 text-blue-800":V.lnRequestSent==="Inactive Profile"?"bg-gray-100 text-gray-800":V.lnRequestSent==="Irrelevant Profile"?"bg-orange-100 text-orange-800":V.lnRequestSent==="Open to Work"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:V.lnRequestSent})]}),V.connected&&t.jsxs("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Connected"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${V.connected==="Yes"?"bg-green-100 text-green-800":V.connected==="No"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:V.connected})]})]}),V.conversationNotes&&(()=>{const te=V.conversationNotes.replace(/\[Contact:.*?\|.*?Email:.*?\|.*?Phone:.*?\|.*?LinkedIn:.*?\]/g,"").trim().replace(/\[Contact:.*?\]/g,"").trim();return te?t.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-xl border border-gray-100",children:t.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap leading-relaxed",children:te})}):null})(),V.nextAction&&t.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm",children:[t.jsx("div",{className:"flex-shrink-0 mt-0.5",children:t.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-semibold text-blue-900 mb-1",children:["Next Action: ",t.jsx("span",{className:"font-bold",children:V.nextAction})]}),V.nextActionDate&&t.jsxs("p",{className:"text-xs text-blue-700 font-medium",children:["Scheduled for ",fe(V.nextActionDate)]})]})]}),t.jsx("div",{className:"mt-4 flex justify-end",children:t.jsxs("button",{onClick:()=>he(null,V),className:`inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg hover:bg-opacity-90 transition-all duration-200 ${V.type==="call"?"text-green-700 bg-green-50 border border-green-200 hover:bg-green-100 hover:border-green-300":V.type==="email"?"text-blue-700 bg-blue-50 border border-blue-200 hover:bg-blue-100 hover:border-blue-300":"text-indigo-700 bg-indigo-50 border border-indigo-200 hover:bg-indigo-100 hover:border-indigo-300"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]})})]})]})},V._id||H))})]})]}),t.jsx(wv,{isOpen:xe.isOpen,onClose:ye,type:xe.type,contactName:xe.contactName,companyName:xe.companyName,projectId:xe.projectId,contactId:xe.contactId,phoneNumber:xe.phoneNumber,email:xe.email,linkedInProfileUrl:xe.linkedInProfileUrl,activityId:xe.activityId,editMode:xe.editMode})]})}function qk(){const{companyName:l}=ci(),n=Fr(),[a]=n0(),o=a.get("category")||"IND-IT & Service",[s,e]=B.useState([]),[m,v]=B.useState(!0),[w,N]=B.useState(null),[S,D]=B.useState(null),[L,M]=B.useState(!1),[F,O]=B.useState(null),P=decodeURIComponent(l);B.useEffect(()=>{G()},[P,o]);const G=async()=>{try{v(!0);const ce={category:o,page:1,limit:1e3},ue=await Ht.get("/contacts",{params:ce}),Le=ue?.data?.data||ue?.data||[],be=Array.isArray(Le)?Le.filter(oe=>(oe.company||"No Company")===P):[];e(be),N(null)}catch(ce){N("Failed to fetch company contacts. Please try again."),console.error("Error fetching contacts:",ce)}finally{v(!1)}},ae=ce=>{if(!ce)return"?";const ue=ce.trim().split(/\s+/);return ue.length>=2?(ue[0][0]+ue[1][0]).toUpperCase():ce.substring(0,2).toUpperCase()},re=ce=>ce?(ce=ce.replace(/^#{1,6}\s+/gm,""),ce=ce.replace(/\*\*([^*]+)\*\*/g,"$1"),ce=ce.replace(/__([^_]+)__/g,"$1"),ce=ce.replace(/\*([^*]+)\*/g,"$1"),ce=ce.replace(/_([^_]+)_/g,"$1"),ce=ce.replace(/^[\s]*[-*+]\s+/gm," "),ce=ce.replace(/^\d+\.\s+/gm,""),ce=ce.replace(/\n{3,}/g,`

`),ce=ce.trim(),ce):"",Ne=ce=>{const ue=`?category=${encodeURIComponent(o)}`;n(`/contacts/${ce}${ue}`)},xe=()=>{const ce=`?category=${encodeURIComponent(o)}`;n(`/contacts${ce}`)},we=async()=>{if(!Z?.website){O("Website URL is required for analysis");return}try{M(!0),O(null);const ce=await Ht.post("/company-analysis/analyze",{companyName:P,website:Z.website});ce.data.success?D(ce.data.data):O(ce.data.error||"Failed to analyze company")}catch(ce){console.error("Error analyzing company:",ce),console.error("Error response:",ce?.response),console.error("Error status:",ce?.response?.status),console.error("Error data:",ce?.response?.data);let ue="Failed to analyze company website. Please try again.";ce?.response?.status===429?ue=ce?.response?.data?.error||"OpenAI API quota exceeded. Please check your OpenAI account billing and add credits.":ce?.response?.status===500?ue=ce?.response?.data?.error||"Server error. Please check if OpenAI API key is configured.":ce?.response?.status===401?ue=ce?.response?.data?.error||"OpenAI API key is invalid. Please check your configuration.":ce?.response?.status===400?ue=ce?.response?.data?.error||"Invalid request. Please check the company website URL.":ce?.code==="ECONNREFUSED"||ce?.message?.includes("Network Error")?ue="Cannot connect to server. Please make sure the backend is running.":ce?.response?.data?.error&&(ue=ce.response.data.error),O(ue)}finally{M(!1)}};if(m)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse"}),t.jsx("div",{className:"relative animate-spin rounded-full h-14 w-14 border-2 border-gray-200 border-t-gray-900 mx-auto"})]}),t.jsx("p",{className:"tracking-wide text-sm uppercase text-gray-500 font-medium",children:"Loading company details..."})]})});if(w)return t.jsx("div",{className:"min-h-screen bg-white py-8",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 text-red-700 px-5 py-4 rounded-lg shadow-md",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),t.jsx("span",{className:"font-medium",children:w})]})})})});const Z=s.length>0?s[0]:null;return t.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsxs("button",{onClick:xe,className:"mb-6 flex items-center gap-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Contacts"]}),Z?.website&&t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-white text-slate-900 shadow-lg border border-slate-100",children:[t.jsx("div",{className:"absolute inset-0 opacity-60 bg-[radial-gradient(circle_at_20%_20%,_#e0f2ff,_transparent_30%),_radial-gradient(circle_at_85%_15%,_#ede9fe,_transparent_28%)]"}),t.jsxs("div",{className:"relative p-6 lg:p-8 flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm uppercase tracking-wide font-semibold text-blue-700",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Groq AI Insight"]}),t.jsx("h2",{className:"text-3xl font-bold text-slate-900",children:P}),t.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-slate-700",children:[Z.website&&t.jsxs("a",{href:Z.website.startsWith("http")?Z.website:`https://${Z.website}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-50 border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition",children:[t.jsxs("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4a8 8 0 100 16 8 8 0 000-16z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2 12h20M12 2c2.5 2.5 4 6 4 10s-1.5 7.5-4 10c-2.5-2.5-4-6-4-10s1.5-7.5 4-10z"})]}),Z.website]}),Z.companyLinkedinUrl&&t.jsxs("a",{href:Z.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-50 border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"LinkedIn"]}),Z.email&&t.jsxs("a",{href:`mailto:${Z.email}`,className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-50 border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),Z.email]})]})]}),t.jsx("div",{className:"flex-shrink-0",children:t.jsx("button",{onClick:we,disabled:L,className:"group inline-flex items-center gap-2 px-5 py-3 bg-blue-600 text-white text-sm font-semibold rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-60 disabled:hover:translate-y-0",children:L?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Summarizing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4 text-white group-hover:translate-x-0.5 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Summarize"]})})})]})]}),F&&t.jsx("div",{className:"mt-3 bg-red-50 border border-red-100 text-red-700 px-4 py-3 rounded-xl shadow-sm animate-fade-in",children:t.jsx("p",{className:"text-sm",children:F})}),S&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mt-6 animate-fade-in space-y-6",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-blue-50/30 rounded-2xl border border-slate-200 shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-100/20 rounded-full -mr-16 -mt-16 blur-2xl"}),t.jsxs("div",{className:"relative p-6 h-full flex flex-col",children:[t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("span",{className:"text-xl font-bold text-white",children:"1"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-xs uppercase tracking-wider text-blue-600 font-bold mb-1",children:"Company Overview"}),t.jsx("p",{className:"text-base text-gray-900 font-semibold",children:"Position & Story"})]})]}),t.jsx("div",{className:"flex-1 text-sm text-gray-700 leading-relaxed whitespace-pre-line overflow-y-auto",children:re(S.analysis.companyOverview||S.fullText.split("1)")[1]?.split("2)")[0]?.trim()||"Analysis not available")}),t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Strategic positioning"})]})})]})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-emerald-50/30 rounded-2xl border border-slate-200 shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-100/20 rounded-full -mr-16 -mt-16 blur-2xl"}),t.jsxs("div",{className:"relative p-6 h-full flex flex-col",children:[t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("span",{className:"text-xl font-bold text-white",children:"2"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-xs uppercase tracking-wider text-emerald-600 font-bold mb-1",children:"Core Offering"}),t.jsx("p",{className:"text-base text-gray-900 font-semibold",children:"Products & Value"})]})]}),t.jsx("div",{className:"flex-1 text-sm text-gray-700 leading-relaxed whitespace-pre-line overflow-y-auto",children:re(S.analysis.coreOffering||S.fullText.split("2)")[1]?.split("3)")[0]?.trim()||"Analysis not available")}),t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Value proposition"})]})})]})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-purple-50/30 rounded-2xl border border-slate-200 shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-100/20 rounded-full -mr-16 -mt-16 blur-2xl"}),t.jsxs("div",{className:"relative p-6 h-full flex flex-col",children:[t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("span",{className:"text-xl font-bold text-white",children:"3"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-xs uppercase tracking-wider text-purple-600 font-bold mb-1",children:"Business Considerations"}),t.jsx("p",{className:"text-base text-gray-900 font-semibold",children:"Risks & Opportunities"})]})]}),t.jsx("div",{className:"flex-1 text-sm text-gray-700 leading-relaxed whitespace-pre-line overflow-y-auto",children:re(S.analysis.businessConsiderations||S.fullText.split("3)")[1]?.trim()||"Analysis not available")}),t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),t.jsx("span",{children:"Strategic insights"})]})})]})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-2 mt-4",children:[S.generatedAt&&t.jsxs("div",{className:"text-xs text-gray-500",children:["Generated on ",new Date(S.generatedAt).toLocaleString()]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:we,disabled:L,className:"text-sm text-blue-600 hover:text-blue-800 font-semibold",children:"Re-run"}),t.jsx("button",{onClick:()=>{D(null),O(null)},className:"text-sm text-gray-600 hover:text-gray-900",children:"Clear"})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 sticky top-4",children:[t.jsxs("div",{className:"flex flex-col items-center mb-6",children:[t.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-lg flex items-center justify-center mb-4",children:t.jsx("span",{className:"text-3xl font-bold text-blue-700",children:ae(P)})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center mb-2",children:P}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),t.jsxs("span",{children:[s.length," ",s.length===1?"person":"people"]})]})]}),t.jsxs("div",{className:"space-y-4 border-t border-gray-200 pt-6",children:[Z?.industry&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Industry"}),t.jsx("p",{className:"text-sm text-gray-900",children:Z.industry})]}),(Z?.companyAddress||Z?.companyCity||Z?.companyState||Z?.companyCountry)&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Address"}),t.jsx("p",{className:"text-sm text-gray-900",children:[Z.companyAddress,Z.companyCity,Z.companyState,Z.companyCountry].filter(Boolean).join(", ")||"Not available"})]}),Z?.companyPhone&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Phone"}),t.jsx("a",{href:`tel:${Z.companyPhone}`,className:"text-sm text-blue-600 hover:text-blue-700 hover:underline",children:Z.companyPhone})]}),Z?.website&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Website"}),t.jsx("a",{href:Z.website.startsWith("http")?Z.website:`https://${Z.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 hover:underline",children:Z.website})]}),Z?.companyLinkedinUrl&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"LinkedIn"}),t.jsxs("a",{href:Z.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 hover:underline",children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"View Company LinkedIn"]})]})]})]})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:["People at ",P]}),s.length===0?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"No contacts found for this company."})}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(ce=>t.jsxs("div",{onClick:()=>Ne(ce._id),className:"bg-gray-50 rounded-lg p-4 border border-gray-200 hover:border-blue-300 hover:shadow-md transition-all cursor-pointer",children:[t.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[t.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-sm font-semibold text-blue-700",children:ce.name?ce.name.substring(0,2).toUpperCase():"?"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-1 truncate",children:ce.name||"Unknown"}),ce.title&&t.jsx("p",{className:"text-xs text-gray-600 mb-2 truncate",children:ce.title})]})]}),t.jsxs("div",{className:"space-y-2",children:[ce.email&&t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("a",{href:`mailto:${ce.email}`,onClick:ue=>ue.stopPropagation(),className:"hover:text-blue-600 hover:underline truncate",children:ce.email})]}),ce.firstPhone&&t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("a",{href:`tel:${ce.firstPhone}`,onClick:ue=>ue.stopPropagation(),className:"hover:text-blue-600 hover:underline",children:ce.firstPhone})]}),(ce.personLinkedinUrl||ce.companyLinkedinUrl)&&t.jsx("div",{className:"flex items-center gap-2 text-xs",children:t.jsxs("a",{href:ce.personLinkedinUrl||ce.companyLinkedinUrl,onClick:ue=>ue.stopPropagation(),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 hover:bg-blue-100 rounded text-xs",children:[t.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"LinkedIn"]})})]})]},ce._id))})]})})]})]})})}function Yk(){const[l,n]=B.useState(null),[a,o]=B.useState(!1),[s,e]=B.useState(""),[m,v]=B.useState(""),[w,N]=B.useState(null),[S,D]=B.useState(""),[L,M]=B.useState([]),[F,O]=B.useState(!0),[P,G]=B.useState(!1),[ae,re]=B.useState(""),[Ne,xe]=B.useState(!1);B.useEffect(()=>{we()},[]);const we=async()=>{try{O(!0);const be=(await Ht.get("/categories")).data?.data||[];M(be),be.length>0&&!S&&D(be[0])}catch(Le){console.error("Error fetching categories:",Le);const be=["IND-IT & Service","Accounting & Book keeping","Web Design & Development","Enterprise Software","Finance Services - IND","E-commerce","CRM","Middle East","International","USA Chicago","IT Company - USA","IT Company - Chicago","Weam.ai Mumbai Data","ERP Software","ERP NEXT- Manufacturing-Automotive Components & Spares","Salon & Spa - Chicago","SPA & SALON AHMEDABAD","kology"];M(be),S||D(be[0])}finally{O(!1)}},Z=async()=>{if(!ae.trim()){v("Please enter a category name");return}try{xe(!0),v(""),(await Ht.post("/categories",{name:ae.trim()})).data.success&&(await we(),D(ae.trim()),re(""),G(!1),e("Category added successfully!"),setTimeout(()=>e(""),3e3))}catch(Le){v(Le.response?.data?.error||"Failed to add category")}finally{xe(!1)}},ce=Le=>{n(Le.target.files?.[0]||null),e(""),v(""),N(null)},ue=async()=>{if(!l){v("Please select a CSV or Excel file.");return}const Le=new FormData;Le.append("file",l),Le.append("category",S);try{o(!0),v(""),e(""),N(null);const be=await Ht.post("/import/upload",Le,{headers:{"Content-Type":"multipart/form-data"}});N(be.data.data),e("Import completed successfully")}catch(be){const oe=be?.response?.data?.error||"Upload failed. Please try again.";v(oe)}finally{o(!1)}};return t.jsx("div",{className:"min-h-screen bg-gray-50 py-10",children:t.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Import Contacts"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Upload a CSV or Excel file with the following columns: Name (required), Company (required), Email (required), Person Linkedin Url (required), Title, First Phone, # Employees, Category, Industry, Keywords, Website, Company Linkedin Url, Facebook Url, Twitter Url, City, State, Country, Company Address, Company City, Company State, Company Country, Company Phone, SEO Description, Technologies, Annual Revenue."}),t.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select category to assign"}),t.jsxs("button",{type:"button",onClick:()=>{G(!P),v(""),e("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),P?"Cancel":"Add New"]})]}),P?t.jsx("div",{className:"space-y-2",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:ae,onChange:Le=>re(Le.target.value),placeholder:"Enter new category name",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyDown:Le=>{Le.key==="Enter"&&Z()}}),t.jsx("button",{type:"button",onClick:Z,disabled:Ne||!ae.trim(),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",children:Ne?"Adding...":"Add"})]})}):t.jsx("select",{value:S,onChange:Le=>D(Le.target.value),disabled:F,className:"border border-gray-300 rounded-lg px-3 py-2 w-full text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:F?t.jsx("option",{children:"Loading categories..."}):L.length===0?t.jsx("option",{children:"No categories available"}):L.map(Le=>t.jsx("option",{value:Le,children:Le},Le))})]}),t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select file (CSV, XLSX, or XLS)"}),t.jsx("input",{type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:ce,className:"block w-full text-sm text-gray-700 border border-gray-300 rounded-lg p-2 mb-4"}),t.jsx("button",{onClick:ue,disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed",children:a?"Uploading...":"Upload & Import"}),s&&t.jsx("div",{className:"mt-4 p-3 bg-green-50 text-green-700 border border-green-200 rounded",children:s}),m&&t.jsx("div",{className:"mt-4 p-3 bg-red-50 text-red-700 border border-red-200 rounded",children:m}),w&&t.jsxs("div",{className:"mt-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-gray-700",children:"Total Rows:"}),t.jsx("span",{className:"ml-2 text-gray-900",children:w.totalRows})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-gray-700",children:"Valid Contacts:"}),t.jsx("span",{className:"ml-2 text-gray-900",children:w.validContacts})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-green-700",children:"Inserted:"}),t.jsx("span",{className:"ml-2 text-green-900 font-semibold",children:w.inserted})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-orange-700",children:"Skipped (Duplicates):"}),t.jsx("span",{className:"ml-2 text-orange-900 font-semibold",children:w.skipped||0})]})]}),w.columnMapping&&t.jsx("div",{className:"mt-4 space-y-3",children:t.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[t.jsx("div",{className:"text-sm font-semibold text-blue-800 mb-3",children:"Column Mapping Information"}),w.columnMapping.detected&&w.columnMapping.detected.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"text-xs font-semibold text-blue-700 mb-1",children:["Detected Columns (",w.columnMapping.detected.length,"):"]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:w.columnMapping.detected.map((Le,be)=>t.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:Le},be))})]}),w.columnMapping.mapped&&w.columnMapping.mapped.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"text-xs font-semibold text-green-700 mb-1",children:["Successfully Mapped (",w.columnMapping.mapped.length,"):"]}),t.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:w.columnMapping.mapped.map((Le,be)=>t.jsxs("div",{className:"text-xs text-gray-700",children:[t.jsx("span",{className:"font-medium",children:Le.original}),t.jsx("span",{className:"mx-2",children:""}),t.jsx("span",{className:"text-green-700",children:Le.mapped})]},be))})]}),w.columnMapping.unmapped&&w.columnMapping.unmapped.length>0&&t.jsxs("div",{children:[t.jsxs("div",{className:"text-xs font-semibold text-orange-700 mb-1",children:["Unmapped Columns (",w.columnMapping.unmapped.length,"):"]}),t.jsx("div",{className:"text-xs text-orange-600 mb-1",children:"These columns were not recognized and will be ignored."}),t.jsx("div",{className:"flex flex-wrap gap-2",children:w.columnMapping.unmapped.map((Le,be)=>t.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:Le},be))})]})]})}),w.errors&&w.errors.length>0&&t.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsxs("div",{className:"text-sm font-semibold text-yellow-800 mb-2",children:["Warnings & Errors (",w.errors.length,"):"]}),t.jsx("ul",{className:"list-disc list-inside text-sm text-yellow-700 space-y-1 max-h-60 overflow-y-auto",children:w.errors.map((Le,be)=>t.jsx("li",{children:Le},be))})]})]})]})]})})}const Cb={name:"",title:"",company:"",email:"",firstPhone:"",employees:"",category:"IND-IT & Service",industry:"",keywords:"",personLinkedinUrl:"",website:"",companyLinkedinUrl:"",facebookUrl:"",twitterUrl:"",city:"",state:"",country:"",companyAddress:"",companyCity:"",companyState:"",companyCountry:"",companyPhone:"",seoDescription:"",technologies:"",annualRevenue:""};function Gk(){const[l,n]=B.useState(Cb),[a,o]=B.useState(!1),[s,e]=B.useState(""),m=Fr(),v=N=>{const{name:S,value:D}=N.target;n(L=>({...L,[S]:D}))},w=async N=>{if(N.preventDefault(),!l.name.trim()){e("Name is required.");return}try{o(!0),e(""),await Ht.post("/contacts",l),m("/contacts")}catch(S){let D=S?.response?.data?.error||"Failed to save contact.";(S?.response?.status===409||S?.response?.data?.duplicate)&&(D=`Duplicate contact detected: ${D}`),e(D)}finally{o(!1)}};return t.jsx("div",{className:"min-h-screen bg-gray-50 py-10",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Add Contact"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Enter the contact details and save to MongoDB."})]}),t.jsx("button",{onClick:()=>m("/contacts"),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Back to Contacts"})]}),s&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded",children:s}),t.jsxs("form",{onSubmit:w,className:"bg-white shadow rounded-lg p-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[[["name","Name",!0],["title","Title"],["company","Company"],["email","Email",!1,"email"],["firstPhone","First Phone"],["employees","# Employees"],["category","Category"],["industry","Industry"],["keywords","Keywords"],["personLinkedinUrl","Person Linkedin Url"],["website","Website"],["companyLinkedinUrl","Company Linkedin Url"],["facebookUrl","Facebook Url"],["twitterUrl","Twitter Url"],["city","City"],["state","State"],["country","Country"],["companyAddress","Company Address"],["companyCity","Company City"],["companyState","Company State"],["companyCountry","Company Country"],["companyPhone","Company Phone"],["seoDescription","SEO Description"],["technologies","Technologies"],["annualRevenue","Annual Revenue"]].map(([N,S,D,L="text"])=>t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1",children:[S,D?" *":""]}),t.jsx("input",{type:L,name:N,value:l[N],onChange:v,required:D,className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]},N)),t.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3 mt-2",children:[t.jsx("button",{type:"button",onClick:()=>n(Cb),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Reset"}),t.jsx("button",{type:"submit",disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400",children:a?"Saving...":"Save Contact"})]})]})]})})}function Kk(){const l=Fr(),[n,a]=B.useState(""),[o,s]=B.useState([]),[e,m]=B.useState(!0),[v,w]=B.useState(null),[N,S]=B.useState({total:0,totalProspects:0,totalActivities:0,activeProjects:0,meetingRate:0,sqlCount:0,avgActivitiesPerProspect:0}),[D,L]=B.useState(null),[M,F]=B.useState(""),[O,P]=B.useState(""),[G,ae]=B.useState(""),[re,Ne]=B.useState({isOpen:!1,project:null});B.useEffect(()=>{xe(),we()},[n,M,O,G]);const xe=async()=>{try{m(!0);const oe={};n&&(oe.search=n),O&&(oe.status=O);const he=await Ht.get("/projects",{params:oe});if(he.data.success){const ye=he.data.data,Te=Array.isArray(ye)?ye:[];let fe=[...Te];G==="active"?fe=fe.filter(se=>se.status==="active"):G==="draft"?fe=fe.filter(se=>se.status==="draft"):G==="completed"&&(fe=fe.filter(se=>se.status==="completed")),s(fe);const _e=Te.reduce((se,me)=>se+(me.totalProspects||0),0),We=Te.filter(se=>se.status==="active").length;S({total:Te.length,totalProspects:_e,totalActivities:0,activeProjects:We,meetingRate:0,sqlCount:0,avgActivitiesPerProspect:0})}}catch(oe){console.error("Error fetching projects:",oe),w("Couldn't load your projects right now. Give it another try in a moment.")}finally{m(!1)}},we=async()=>{try{const oe=await Ht.get("/projects/analytics");if(oe.data.success){const he=oe.data.data;L(he),S(ye=>({...ye,totalProspects:he.overview.totalProspects||ye.totalProspects,totalActivities:he.overview.totalActivities||0,activeProjects:he.overview.activeProjects||ye.activeProjects,meetingRate:he.pipeline?.conversion?.meetingRate||0,sqlCount:he.pipeline?.conversion?.sql||0,avgActivitiesPerProspect:he.overview.totalProspects>0?parseFloat((he.overview.totalActivities/he.overview.totalProspects).toFixed(1)):0}))}}catch(oe){console.error("Error fetching analytics:",oe)}},Z=()=>{l("/projects/new")},ce=oe=>{l(`/projects/${oe}/edit`)},ue=async(oe,he,ye)=>{oe.stopPropagation();const Te=ye==="active",fe=Te?"draft":"active";try{(await Ht.patch(`/projects/${he}/status`,{isActive:!Te})).data.success&&s(We=>We.map(se=>se._id===he?{...se,status:fe}:se))}catch(_e){console.error("Error toggling project status:",_e),alert("Something went wrong updating the project. Try again in a moment.")}},Le=oe=>oe?new Date(oe).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",be=oe=>{if(!oe)return 0;const{interested:he=0,cip:ye=0,detailsShared:Te=0,demoBooked:fe=0,demoCompleted:_e=0,meetingProposed:We=0,meetingScheduled:se=0,meetingCompleted:me=0,sql:W=0,won:pe=0}=oe;return he+ye+Te+fe+_e+We+se+me+W+pe};return t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Project Management"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Manage your outbound campaigns and track what's working"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{onClick:()=>l("/projects/dashboard"),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-colors font-medium text-sm shadow-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Analytics Dashboard"]}),t.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Project"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Portfolio Size"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.total}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Projects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Prospects"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.totalProspects.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Prospects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full shadow-xs",children:"Activities"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.totalActivities.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Activities"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Projects"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.activeProjects}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Active Projects"})]})]}),t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 mb-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",placeholder:"Search by name, company, email...",value:n,onChange:oe=>a(oe.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),t.jsx("div",{className:"w-64",children:t.jsxs("select",{value:"",onChange:oe=>{oe.target.value&&l(`/projects/${oe.target.value}`)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:[t.jsx("option",{value:"",children:"Select a project..."}),o.map(oe=>t.jsxs("option",{value:oe._id,children:[oe.companyName," - ",oe.contactPerson?.fullName||"N/A"]},oe._id))]})})]})}),v&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:v}),e?t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-12",children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):o.length>0?t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-fixed",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"16%"},children:"Company"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"11%"},children:"Created Date"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"11%"},children:"Assigned To"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"16%"},children:"Contact Person"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"10%"},children:"Total Prospects"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"10%"},children:"Leads Generated"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"10%"},children:"Active"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"14%"},children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(oe=>t.jsxs("tr",{onClick:()=>l(`/projects/${oe._id}`),className:"hover:bg-gray-50 transition-colors cursor-pointer",children:[t.jsxs("td",{className:"px-3 py-4",children:[t.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate",children:oe.companyName||"N/A"}),oe.industry&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:oe.industry})]}),t.jsx("td",{className:"px-3 py-4",children:t.jsx("div",{className:"text-sm text-gray-900",children:Le(oe.createdAt)})}),t.jsx("td",{className:"px-3 py-4 text-sm text-gray-900 truncate",children:oe.assignedTo||"-"}),t.jsxs("td",{className:"px-3 py-4",children:[t.jsx("div",{className:"text-sm text-gray-900 truncate",children:oe.contactPerson?.fullName||"N/A"}),oe.contactPerson?.email&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:oe.contactPerson.email})]}),t.jsx("td",{className:"px-3 py-4",children:t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:oe.totalProspects||0})}),t.jsx("td",{className:"px-3 py-4",children:t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:oe.leadsByStatus?be(oe.leadsByStatus):oe.leadsGenerated||0})}),t.jsx("td",{className:"px-3 py-4",onClick:he=>he.stopPropagation(),children:t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:oe.status==="active",onChange:he=>ue(he,oe._id,oe.status),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})}),t.jsx("td",{className:"px-3 py-4",onClick:he=>he.stopPropagation(),children:t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsxs("button",{onClick:he=>{he.stopPropagation(),Ne({isOpen:!0,project:oe})},className:"inline-flex items-center gap-1 px-2 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 hover:border-blue-300 transition-colors",title:"View Project Details",children:[t.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]}),t.jsxs("button",{onClick:he=>{he.stopPropagation(),ce(oe._id)},className:"inline-flex items-center gap-1 px-2 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-colors",title:"Edit Project",children:[t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]})]})})]},oe._id))})]})})}):t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-12",children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No projects yet"}),t.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Create your first project to get started"}),t.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Project"]})]})}),re.isOpen&&re.project&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between z-10",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Project Details"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:re.project.companyName})]}),t.jsx("button",{onClick:()=>Ne({isOpen:!1,project:null}),className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Company Details"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Name"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.companyName||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Website"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.website?t.jsx("a",{href:re.project.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:re.project.website}):"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"City"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.city||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Country"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.country||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Industry"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.industry||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Size"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.companySize||"N/A"})]}),re.project.companyDescription&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Description"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1 whitespace-pre-wrap",children:re.project.companyDescription})]})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Contact Person"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Full Name"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.contactPerson?.fullName||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Designation"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.contactPerson?.designation||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Email"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.contactPerson?.email?t.jsx("a",{href:`mailto:${re.project.contactPerson.email}`,className:"text-blue-600 hover:underline",children:re.project.contactPerson.email}):"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Phone Number"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.contactPerson?.phoneNumber?t.jsx("a",{href:`tel:${re.project.contactPerson.phoneNumber}`,className:"text-blue-600 hover:underline",children:re.project.contactPerson.phoneNumber}):"N/A"})]}),re.project.contactPerson?.linkedInProfileUrl&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"LinkedIn Profile"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.jsx("a",{href:re.project.contactPerson.linkedInProfileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:re.project.contactPerson.linkedInProfileUrl})})]})]})]}),re.project.campaignDetails&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),"Campaign Details"]}),t.jsxs("div",{className:"space-y-4",children:[re.project.campaignDetails.servicesOffered&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Services Offered"}),t.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[re.project.campaignDetails.servicesOffered.leadGeneration&&t.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:"Lead Generation"}),re.project.campaignDetails.servicesOffered.marketResearch&&t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:"Market Research"}),re.project.campaignDetails.servicesOffered.appointmentSetting&&t.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full",children:"Appointment Setting"}),re.project.campaignDetails.servicesOffered.dataEnrichment&&t.jsx("span",{className:"px-3 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded-full",children:"Data Enrichment"}),!re.project.campaignDetails.servicesOffered.leadGeneration&&!re.project.campaignDetails.servicesOffered.marketResearch&&!re.project.campaignDetails.servicesOffered.appointmentSetting&&!re.project.campaignDetails.servicesOffered.dataEnrichment&&t.jsx("span",{className:"text-sm text-gray-500",children:"None selected"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[re.project.campaignDetails.leadQuotaCommitted>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Lead Quota Committed"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.campaignDetails.leadQuotaCommitted})]}),re.project.campaignDetails.startDate&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Start Date"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Le(re.project.campaignDetails.startDate)})]}),re.project.campaignDetails.endDate&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"End Date"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Le(re.project.campaignDetails.endDate)})]})]}),re.project.campaignDetails.expectationsFromUs&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Expectations From Us"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1 whitespace-pre-wrap",children:re.project.campaignDetails.expectationsFromUs})]})]})]}),re.project.channels&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})}),"Channels"]}),t.jsxs("div",{className:"flex flex-wrap gap-3",children:[re.project.channels.linkedInOutreach&&t.jsxs("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 text-sm font-medium rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),"LinkedIn Outreach"]}),re.project.channels.coldEmail&&t.jsxs("span",{className:"px-4 py-2 bg-purple-100 text-purple-800 text-sm font-medium rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Cold Email"]}),re.project.channels.coldCalling&&t.jsxs("span",{className:"px-4 py-2 bg-green-100 text-green-800 text-sm font-medium rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Cold Calling"]}),!re.project.channels.linkedInOutreach&&!re.project.channels.coldEmail&&!re.project.channels.coldCalling&&t.jsx("span",{className:"text-sm text-gray-500",children:"No channels selected"})]})]}),re.project.icpDefinition&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"ICP Definition"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[re.project.icpDefinition.targetIndustries&&re.project.icpDefinition.targetIndustries.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Target Industries"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(re.project.icpDefinition.targetIndustries)?re.project.icpDefinition.targetIndustries.join(", "):re.project.icpDefinition.targetIndustries})]}),re.project.icpDefinition.targetJobTitles&&re.project.icpDefinition.targetJobTitles.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Target Job Titles"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(re.project.icpDefinition.targetJobTitles)?re.project.icpDefinition.targetJobTitles.join(", "):re.project.icpDefinition.targetJobTitles})]}),(re.project.icpDefinition.companySizeMin>0||re.project.icpDefinition.companySizeMax<1e3)&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Size Range"}),t.jsxs("p",{className:"text-sm text-gray-900 mt-1",children:[re.project.icpDefinition.companySizeMin," - ",re.project.icpDefinition.companySizeMax," employees"]})]}),re.project.icpDefinition.geographies&&re.project.icpDefinition.geographies.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Geographies"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(re.project.icpDefinition.geographies)?re.project.icpDefinition.geographies.join(", "):re.project.icpDefinition.geographies})]}),re.project.icpDefinition.keywords&&re.project.icpDefinition.keywords.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Keywords"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(re.project.icpDefinition.keywords)?re.project.icpDefinition.keywords.join(", "):re.project.icpDefinition.keywords})]}),re.project.icpDefinition.exclusionCriteria&&re.project.icpDefinition.exclusionCriteria.length>0&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Exclusion Criteria"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(re.project.icpDefinition.exclusionCriteria)?re.project.icpDefinition.exclusionCriteria.join(", "):re.project.icpDefinition.exclusionCriteria})]})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),"Team Allocation"]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Assigned To"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.assignedTo||"N/A"})]})]})]}),t.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4 flex items-center justify-end gap-3",children:[t.jsx("button",{onClick:()=>Ne({isOpen:!1,project:null}),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"}),t.jsx("button",{onClick:()=>{Ne({isOpen:!1,project:null}),ce(re.project._id)},className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Edit Project"})]})]})})]})}const sp=[{id:1,label:"Company Details"},{id:2,label:"Contact Person"},{id:3,label:"Campaign Details"},{id:4,label:"Channels"},{id:5,label:"ICP Definition"},{id:6,label:"Team Allocation"}];function Sb(){const l=Fr(),{id:n}=ci(),a=!!n,[o,s]=B.useState(1),[e,m]=B.useState(!1),[v,w]=B.useState(a),[N,S]=B.useState(null),[D,L]=B.useState({companyName:"",website:"",city:"",country:"",industry:"",companySize:"",companyDescription:"",contactPerson:{fullName:"",designation:"",email:"",phoneNumber:"",linkedInProfileUrl:""},campaignDetails:{servicesOffered:{leadGeneration:!1,marketResearch:!1,appointmentSetting:!1,dataEnrichment:!1},expectationsFromUs:"",leadQuotaCommitted:0,startDate:"",endDate:""},channels:{linkedInOutreach:!1,coldEmail:!1,coldCalling:!1},icpDefinition:{targetIndustries:"",targetJobTitles:"",companySizeMin:0,companySizeMax:1e3,geographies:"",keywords:"",exclusionCriteria:""},assignedTo:"",teamMembers:[]}),M=(Z,ce)=>{if(Z.includes(".")){const[ue,Le]=Z.split(".");L(be=>({...be,[ue]:{...be[ue],[Le]:ce}}))}else L(ue=>({...ue,[Z]:ce}))},F=(Z,ce,ue)=>{L(Le=>({...Le,[Z]:{...Le[Z],[ce]:ue}}))},O=(Z,ce)=>{L(ue=>({...ue,campaignDetails:{...ue.campaignDetails,servicesOffered:{...ue.campaignDetails.servicesOffered,[Z]:ce}}}))};B.useEffect(()=>{(async()=>{if(a)try{w(!0);const ce=await Ht.get(`/projects/${n}`);if(ce.data.success){const ue=ce.data.data,Le=oe=>oe?new Date(oe).toISOString().split("T")[0]:"",be=oe=>Array.isArray(oe)?oe.join(", "):"";L({companyName:ue.companyName||"",website:ue.website||"",city:ue.city||"",country:ue.country||"",industry:ue.industry||"",companySize:ue.companySize||"",companyDescription:ue.companyDescription||"",contactPerson:{fullName:ue.contactPerson?.fullName||"",designation:ue.contactPerson?.designation||"",email:ue.contactPerson?.email||"",phoneNumber:ue.contactPerson?.phoneNumber||"",linkedInProfileUrl:ue.contactPerson?.linkedInProfileUrl||""},campaignDetails:{servicesOffered:{leadGeneration:ue.campaignDetails?.servicesOffered?.leadGeneration||!1,marketResearch:ue.campaignDetails?.servicesOffered?.marketResearch||!1,appointmentSetting:ue.campaignDetails?.servicesOffered?.appointmentSetting||!1,dataEnrichment:ue.campaignDetails?.servicesOffered?.dataEnrichment||!1},expectationsFromUs:ue.campaignDetails?.expectationsFromUs||"",leadQuotaCommitted:ue.campaignDetails?.leadQuotaCommitted||0,startDate:Le(ue.campaignDetails?.startDate),endDate:Le(ue.campaignDetails?.endDate)},channels:{linkedInOutreach:ue.channels?.linkedInOutreach||!1,coldEmail:ue.channels?.coldEmail||!1,coldCalling:ue.channels?.coldCalling||!1},icpDefinition:{targetIndustries:be(ue.icpDefinition?.targetIndustries),targetJobTitles:be(ue.icpDefinition?.targetJobTitles),companySizeMin:ue.icpDefinition?.companySizeMin||0,companySizeMax:ue.icpDefinition?.companySizeMax||1e3,geographies:be(ue.icpDefinition?.geographies),keywords:be(ue.icpDefinition?.keywords),exclusionCriteria:be(ue.icpDefinition?.exclusionCriteria)},assignedTo:ue.assignedTo||"",teamMembers:Array.isArray(ue.teamMembers)&&ue.teamMembers.length>0?ue.teamMembers:[]})}}catch(ce){console.error("Error fetching project:",ce),S(ce.response?.data?.error||"Couldn't load the project details. Try refreshing the page.")}finally{w(!1)}})()},[n,a]);const P=Z=>{switch(Z){case 1:return D.companyName.trim()?!0:(S("Company Name is required"),!1);case 2:return D.contactPerson.fullName.trim()?!0:(S("Full Name is required"),!1);default:return!0}},G=()=>{P(o)&&(S(null),o<sp.length&&s(o+1))},ae=()=>{o>1&&(s(o-1),S(null))},re=Z=>{Z!==o&&(Z>o&&!P(o)||(S(null),s(Z)))},Ne=()=>{window.confirm("Are you sure you want to cancel? All unsaved data will be lost.")&&l("/projects")},xe=async()=>{if(P(o)){m(!0),S(null);try{const Z=Le=>!Le||typeof Le!="string"?[]:Le.split(",").map(be=>be.trim()).filter(Boolean),ce={...D,icpDefinition:{...D.icpDefinition,targetIndustries:Z(D.icpDefinition.targetIndustries),targetJobTitles:Z(D.icpDefinition.targetJobTitles),geographies:Z(D.icpDefinition.geographies),keywords:Z(D.icpDefinition.keywords),exclusionCriteria:Z(D.icpDefinition.exclusionCriteria),companySizeMin:Number(D.icpDefinition.companySizeMin)||0,companySizeMax:Number(D.icpDefinition.companySizeMax)||0},campaignDetails:{...D.campaignDetails,leadQuotaCommitted:Number(D.campaignDetails.leadQuotaCommitted)||0},teamMembers:Array.isArray(D.teamMembers)?D.teamMembers.map(Le=>(Le||"").trim()).filter(Boolean):[]};let ue;a?ue=await Ht.put(`/projects/${n}`,ce):ue=await Ht.post("/projects",ce),ue.data.success?l("/projects"):S(ue.data.error||`Couldn't ${a?"update":"create"} the project. Something went wrong.`)}catch(Z){console.error(`Error ${a?"updating":"creating"} project:`,Z),S(Z.response?.data?.error||Z.message||`Something went wrong trying to ${a?"update":"create"} the project. Try again.`)}finally{m(!1)}}},we=()=>{switch(o){case 1:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Company Details"}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Company Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:D.companyName,onChange:Z=>M("companyName",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter company name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),t.jsx("input",{type:"url",value:D.website,onChange:Z=>M("website",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),t.jsx("input",{type:"text",value:D.city,onChange:Z=>M("city",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter city"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),t.jsx("input",{type:"text",value:D.country,onChange:Z=>M("country",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter country"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Industry"}),t.jsx("input",{type:"text",value:D.industry,onChange:Z=>M("industry",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter industry"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Size"}),t.jsxs("select",{value:D.companySize,onChange:Z=>M("companySize",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"",children:"Select size"}),t.jsx("option",{value:"1-10",children:"1-10"}),t.jsx("option",{value:"11-50",children:"11-50"}),t.jsx("option",{value:"51-200",children:"51-200"}),t.jsx("option",{value:"201-500",children:"201-500"}),t.jsx("option",{value:"501-1000",children:"501-1000"}),t.jsx("option",{value:"1000+",children:"1000+"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Description"}),t.jsx("textarea",{value:D.companyDescription,onChange:Z=>M("companyDescription",Z.target.value),rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y",placeholder:"Enter company description"})]})]});case 2:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Contact Person"}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Full Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:D.contactPerson.fullName,onChange:Z=>F("contactPerson","fullName",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter full name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Designation"}),t.jsx("input",{type:"text",value:D.contactPerson.designation,onChange:Z=>F("contactPerson","designation",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter designation"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),t.jsx("input",{type:"email",value:D.contactPerson.email,onChange:Z=>F("contactPerson","email",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@example.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),t.jsx("input",{type:"tel",value:D.contactPerson.phoneNumber,onChange:Z=>F("contactPerson","phoneNumber",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+1 234 567 8900"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"LinkedIn Profile URL"}),t.jsx("input",{type:"url",value:D.contactPerson.linkedInProfileUrl,onChange:Z=>F("contactPerson","linkedInProfileUrl",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://linkedin.com/in/username"})]})]});case 3:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Campaign Details"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Services Offered"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.leadGeneration,onChange:Z=>O("leadGeneration",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Lead Generation"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.marketResearch,onChange:Z=>O("marketResearch",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Market Research"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.appointmentSetting,onChange:Z=>O("appointmentSetting",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Appointment Setting"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.dataEnrichment,onChange:Z=>O("dataEnrichment",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Data Enrichment"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expectations from Us"}),t.jsx("textarea",{value:D.campaignDetails.expectationsFromUs,onChange:Z=>F("campaignDetails","expectationsFromUs",Z.target.value),rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y",placeholder:"Enter expectations"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lead Quota Committed"}),t.jsx("input",{type:"number",value:D.campaignDetails.leadQuotaCommitted,onChange:Z=>F("campaignDetails","leadQuotaCommitted",parseInt(Z.target.value)||0),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0",min:"0"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",value:D.campaignDetails.startDate,onChange:Z=>F("campaignDetails","startDate",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",value:D.campaignDetails.endDate,onChange:Z=>F("campaignDetails","endDate",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]})]})]});case 4:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Channels"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Channel Selection"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.channels.linkedInOutreach,onChange:Z=>F("channels","linkedInOutreach",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"LinkedIn Outreach"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.channels.coldEmail,onChange:Z=>F("channels","coldEmail",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Cold Email"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.channels.coldCalling,onChange:Z=>F("channels","coldCalling",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Cold Calling"})]})]})]})]});case 5:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"ICP Definition"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Industries (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.targetIndustries,onChange:Z=>F("icpDefinition","targetIndustries",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Technology, Healthcare, Finance"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Job Titles (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.targetJobTitles,onChange:Z=>F("icpDefinition","targetJobTitles",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., CEO, CTO, VP Sales"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Size Min"}),t.jsx("input",{type:"number",value:D.icpDefinition.companySizeMin,onChange:Z=>F("icpDefinition","companySizeMin",parseInt(Z.target.value)||0),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Size Max"}),t.jsx("input",{type:"number",value:D.icpDefinition.companySizeMax,onChange:Z=>F("icpDefinition","companySizeMax",parseInt(Z.target.value)||1e3),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"1000",min:"0"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Geographies (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.geographies,onChange:Z=>F("icpDefinition","geographies",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., USA, UK, Canada"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Keywords (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.keywords,onChange:Z=>F("icpDefinition","keywords",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., SaaS, Cloud, AI"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exclusion Criteria (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.exclusionCriteria,onChange:Z=>F("icpDefinition","exclusionCriteria",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Government, Non-profit"})]})]});case 6:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Team Allocation"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assigned To"}),t.jsx("input",{type:"text",value:D.assignedTo,onChange:Z=>M("assignedTo",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter assigned person name"}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Enter the name of the person assigned to manage this project"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Team Members"}),t.jsx("button",{type:"button",onClick:()=>{const Z=[...D.teamMembers,""];M("teamMembers",Z)},className:"px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:"+ Add Member"})]}),t.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Add team member email addresses to grant them access to this project"}),D.teamMembers.length===0?t.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"No team members added yet"}),t.jsx("button",{type:"button",onClick:()=>M("teamMembers",[""]),className:"mt-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Add first team member"})]}):t.jsx("div",{className:"space-y-3",children:D.teamMembers.map((Z,ce)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"email",value:Z,onChange:ue=>{const Le=[...D.teamMembers];Le[ce]=ue.target.value.trim(),M("teamMembers",Le)},className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"team.member@example.com"}),t.jsx("button",{type:"button",onClick:()=>{const ue=D.teamMembers.filter((Le,be)=>be!==ce);M("teamMembers",ue)},className:"px-3 py-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove team member",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},ce))})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsxs("p",{className:"text-sm text-blue-800",children:[t.jsx("strong",{children:"Note:"})," Team members will be able to access this project, view all activities, create/edit entries, and their activities will appear in Team Performance."]})})]});default:return null}};return v?t.jsx("div",{className:"p-6 max-w-4xl mx-auto",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):t.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:a?"Edit Project":"Create New Project"}),t.jsx("div",{className:"mb-8",children:t.jsx("div",{className:"flex items-center justify-between",children:sp.map((Z,ce)=>{const ue=Z.id<o,Le=Z.id===o,be=Z.id>o;return t.jsxs("div",{className:"flex items-center flex-1",children:[t.jsxs("button",{type:"button",onClick:()=>re(Z.id),className:"flex flex-col items-center flex-1 focus:outline-none",children:[t.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-all ${ue||Le?"bg-blue-600 text-white":"bg-gray-200 text-gray-500"}`,children:ue?t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):Z.id}),t.jsx("span",{className:`mt-2 text-xs font-medium ${Le?"text-blue-600":be?"text-gray-400":"text-gray-600"}`,children:Z.label})]}),ce<sp.length-1&&t.jsx("div",{className:`flex-1 h-0.5 mx-2 ${ue?"bg-blue-600":"bg-gray-200"}`})]},Z.id)})})}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-8 mb-6",children:[N&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:N}),we()]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:Ne,className:"text-gray-600 hover:text-gray-900 font-medium",children:"Cancel"}),t.jsxs("div",{className:"flex items-center gap-3",children:[o>1&&t.jsxs("button",{onClick:ae,className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-gray-700 font-medium",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]}),o<sp.length?t.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:["Next",t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}):t.jsx("button",{onClick:xe,disabled:e,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:e?a?"Updating...":"Creating...":a?"Update Project":"Create Project & Map ICP"})]})]})]})}function Qk({isOpen:l,onClose:n,projectId:a,onImportSuccess:o}){const[s,e]=B.useState(null),[m,v]=B.useState(""),[w,N]=B.useState("New"),[S,D]=B.useState(!1),[L,M]=B.useState(!1),[F,O]=B.useState(""),[P,G]=B.useState(""),ae=B.useRef(null),re=["New","Contacted","Qualified","Proposal","Negotiation"],Ne=be=>{if(be){const oe=be.name.toLowerCase(),he=[".csv",".xlsx",".xls"],ye=["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/excel","application/x-excel","application/x-msexcel"],Te=he.some(_e=>oe.endsWith(_e)),fe=ye.includes(be.type);if(!Te&&!fe){O("Please upload a CSV, XLSX, or XLS file only");return}e(be),O("")}},xe=be=>{be.preventDefault(),D(!0)},we=be=>{be.preventDefault(),D(!1)},Z=be=>{be.preventDefault(),D(!1);const oe=be.dataTransfer.files[0];Ne(oe)},ce=be=>{const oe=be.target.files[0];Ne(oe)},ue=async()=>{if(!s){O("Please select a file (CSV, XLSX, or XLS)");return}if(!a){O("Project ID is missing");return}M(!0),O(""),G("");try{const be=new FormData;be.append("file",s),be.append("projectId",a),m&&be.append("assignTo",m),be.append("defaultStage",w);const oe=await Ht.post("/projects/bulk-import",be,{headers:{"Content-Type":"multipart/form-data"}});oe.data.success&&(G(`Successfully imported ${oe.data.data.imported} prospects. ${oe.data.data.skipped>0?`${oe.data.data.skipped} duplicates skipped.`:""}`),setTimeout(()=>{o?.(),Le()},2e3))}catch(be){console.error("Import error:",be),O(be.response?.data?.error||"Couldn't import those prospects. Double-check your file format and give it another shot.")}finally{M(!1)}},Le=()=>{e(null),v(""),N("New"),O(""),G(""),D(!1),ae.current&&(ae.current.value=""),n()};return l?t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 animate-fade-in",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto animate-fade-in",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Bulk Import Prospects"}),t.jsx("button",{onClick:Le,className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Upload a CSV, XLSX, or XLS file with the following columns:"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[t.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 list-disc list-inside",children:[t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Name"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Email"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Person Linkedin Url"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Title"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"First Phone"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Employees"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Category"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Industry"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Keywords"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Website"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Linkedin Url"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Facebook Url"})," (optional)"]})]}),t.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 list-disc list-inside",children:[t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Twitter Url"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"City"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"State"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Country"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Address"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company City"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company State"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Country"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Phone"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"SEO Description"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Technologies"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Annual Revenue"})," (optional)"]})]})]})]})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Upload File"}),t.jsxs("div",{onDragOver:xe,onDragLeave:we,onDrop:Z,onClick:()=>ae.current?.click(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${S?"border-blue-500 bg-blue-50":s?"border-green-500 bg-green-50":"border-gray-300 bg-gray-50 hover:border-gray-400"}`,children:[t.jsx("input",{ref:ae,type:"file",accept:".csv,.xlsx,.xls,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/csv",onChange:ce,className:"hidden"}),t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Click to upload or drag and drop"}),t.jsx("p",{className:"text-xs text-gray-500",children:"CSV, XLSX, or XLS files only (max 10MB)"})]}),s&&t.jsx("p",{className:"text-sm text-green-600 font-medium mt-2",children:s.name})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Assign To"}),t.jsx("input",{type:"text",value:m,onChange:be=>v(be.target.value),placeholder:"Enter person name or leave empty for auto-assign",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm bg-white"}),t.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Enter team member name or leave empty to let system auto-assign"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Default Stage"}),t.jsx("select",{value:w,onChange:be=>N(be.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm bg-white",children:re.map(be=>t.jsx("option",{value:be,children:be},be))}),t.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Initial pipeline stage for imported prospects"})]}),t.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("svg",{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"text-sm font-semibold text-yellow-900 mb-2",children:"Quick heads up"}),t.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"We'll skip any duplicate emails automatically"}),t.jsx("li",{children:"Invalid email formats get flagged so you can fix them"}),t.jsx("li",{children:"Large files might take a minute or two to process"})]})]})]})}),F&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-red-700",children:F})}),P&&t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-green-700",children:P})})]}),t.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200",children:[t.jsx("button",{onClick:Le,disabled:L,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{onClick:ue,disabled:L||!s,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:L?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import Prospects"]})})]})]})}):null}function Xk({isOpen:l,onClose:n,type:a,selectedContacts:o,projectId:s,contacts:e}){const[m,v]=B.useState({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),[w,N]=B.useState({}),[S,D]=B.useState(!1),[L,M]=B.useState(!1),[F,O]=B.useState({current:0,total:0,success:0,failed:0}),[P,G]=B.useState({phone:!1,email:!1,linkedin:!1}),[ae,re]=B.useState(!1),[Ne,xe]=B.useState([]),[we,Z]=B.useState(""),[ce,ue]=B.useState(!1);B.useEffect(()=>{const V=localStorage.getItem("linkedInAccounts");if(V)try{xe(JSON.parse(V))}catch(H){console.error("Error parsing LinkedIn accounts:",H),xe([])}else xe([])},[]),B.useEffect(()=>{if(l){setTimeout(()=>M(!0),10),O({current:0,total:o.size,success:0,failed:0});const V=new Date().toISOString().split("T")[0];v(H=>({...H,callDate:a==="call"?V:"",emailDate:a==="email"?V:"",linkedinDate:a==="linkedin"?V:""}))}else M(!1),v({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),N({}),re(!1),ue(!1),Z("")},[l,o.size]);const Le=()=>{if(we.trim()&&!Ne.includes(we.trim())){const V=[...Ne,we.trim()];xe(V),localStorage.setItem("linkedInAccounts",JSON.stringify(V)),v(H=>({...H,linkedInAccountName:we.trim()})),Z(""),ue(!1)}};if(!l)return null;const be=()=>{const V="w-5 h-5";switch(a){case"call":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${V} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${V} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${V} text-white`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},oe=()=>{switch(a){case"call":return"Bulk Log Call Activity";case"email":return"Bulk Log Email Activity";case"linkedin":return"Bulk Log LinkedIn Activity";default:return"Bulk Log Activity"}},he=()=>{switch(a){case"call":return"from-green-50 to-emerald-50";case"email":return"from-blue-50 to-cyan-50";case"linkedin":return"from-blue-50 to-indigo-50";default:return"from-gray-50 to-gray-100"}},ye=(V,H)=>{v(Q=>({...Q,[V]:H})),w[V]&&N(Q=>({...Q,[V]:""}))},Te=()=>{const V={};if(m.nextAction&&!m.nextActionDate&&(V.nextActionDate="Next action date is required when next action is specified"),m.nextActionDate){const H=new Date(m.nextActionDate),Q=new Date,te=new Date(Q);te.setDate(te.getDate()+7),H>te&&(V.nextActionDate="Next action must be scheduled within 7 days")}return N(V),Object.keys(V).length===0},fe=async V=>{if(V.preventDefault(),!Te())return;D(!0);const H=Array.from(o),Q=e.filter(ve=>H.includes((ve._id||ve.name).toString()));O({current:0,total:Q.length,success:0,failed:0});let te=0,de=0;try{for(let ve=0;ve<Q.length;ve++){const ke=Q[ve];let ne=null;ke._id&&(ne=ke._id.toString?ke._id.toString():ke._id,typeof ne=="string"&&ne.length!==24&&(ne=null)),O(De=>({...De,current:ve+1}));try{const De=m.email||ke.email,He=m.phoneNumber||ke.firstPhone,vt=m.linkedInUrl||ke.personLinkedinUrl||ke.companyLinkedinUrl,Pe=m.conversationNotes.trim()||"",Nt={projectId:s,type:a,template:m.template,outcome:null,conversationNotes:Pe,nextAction:m.nextAction,nextActionDate:m.nextActionDate,phoneNumber:He||null,email:De||null,linkedInUrl:vt||null,status:m.status||null,linkedInAccountName:m.linkedInAccountName||null,lnRequestSent:m.lnRequestSent||null,connected:m.connected||null,callNumber:m.callNumber||null,callStatus:m.callStatus||null,callDate:m.callDate||null,emailDate:m.emailDate||null,linkedinDate:m.linkedinDate||null};if(ne&&(Nt.contactId=ne),(await Ht.post("/activities",Nt)).data.success&&m.status&&ne&&s)try{await Ht.put(`/projects/${s}/project-contacts/${ne}`,{stage:m.status})}catch(Xt){console.error("Error updating contact status:",Xt)}te++,O(Xt=>({...Xt,success:te}))}catch(De){console.error(`Error saving activity for ${ke.name}:`,De),de++,O(He=>({...He,failed:de}))}}v({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),setTimeout(()=>{n()},1e3)}catch(ve){console.error("Error in bulk activity logging:",ve),N({submit:"Some activities didn't save properly. Check what went wrong and try again."})}finally{D(!1)}},_e=()=>{S||(v({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),N({}),G({phone:!1,email:!1,linkedin:!1}),n())},We=async(V,H,Q)=>{const te=Array.from(o),de=e.filter(ne=>{const De=ne._id?.toString();return te.includes((ne._id||ne.name).toString())&&De&&typeof De=="string"&&De.length===24});if(de.length===0){N({submit:"No valid contacts selected to save."});return}G(ne=>({...ne,[V]:!0}));let ve=0,ke=0;try{for(const ne of de)try{const De=ne._id.toString();await Ht.put(`/contacts/${De}`,{[Q]:H||""}),ve++}catch(De){console.error(`Error saving ${V} for ${ne.name}:`,De),ke++}ve>0&&(N({}),V==="phone"?v(ne=>({...ne,phoneNumber:H||""})):V==="email"?v(ne=>({...ne,email:H||""})):V==="linkedin"&&v(ne=>({...ne,linkedInUrl:H||""}))),ke>0&&N({submit:`Saved ${V} for ${ve} contact(s), but ${ke} failed.`})}catch(ne){console.error(`Error saving ${V}:`,ne),N({submit:`Couldn't save ${V}. Try again in a moment.`})}finally{G(ne=>({...ne,[V]:!1}))}},se=e.filter(V=>o.has((V._id||V.name).toString())),me=se.some(V=>V.firstPhone),W=se.some(V=>V.email),pe=se.some(V=>V.personLinkedinUrl||V.companyLinkedinUrl),Me=()=>se.map(V=>V.personLinkedinUrl||V.companyLinkedinUrl).filter(V=>V&&V.trim()!==""),Se=()=>{const V=Me();if(V.length>0){const H=V.join(`
`);navigator.clipboard.writeText(H).then(()=>{const Q=document.getElementById("copy-linkedin-urls-btn");if(Q){const te=Q.textContent;Q.textContent="Copied!",Q.classList.add("bg-green-600"),setTimeout(()=>{Q.textContent=te,Q.classList.remove("bg-green-600")},2e3)}}).catch(Q=>{console.error("Failed to copy URLs:",Q)})}};return t.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${L?"opacity-100":"opacity-0"}`,onClick:_e,children:t.jsxs("div",{className:`bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col transform transition-all duration-300 ${L?"scale-100 translate-y-0":"scale-95 translate-y-4"}`,onClick:V=>V.stopPropagation(),children:[t.jsx("div",{className:`bg-gradient-to-r ${he()} border-b border-gray-200 p-4 flex-shrink-0`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[ae&&t.jsx("button",{onClick:()=>re(!1),className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-600 hover:text-gray-900 hover:bg-white/50 transition-all duration-200 group",title:"Back to form",children:t.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("div",{className:"animate-pulse-once",children:be()}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-0.5",children:ae&&a==="linkedin"?"LinkedIn Message Variations":ae&&a==="email"?"Email Variations":oe()}),!ae&&t.jsxs("p",{className:"text-xs text-gray-600 font-medium",children:[se.length," ",se.length===1?"contact":"contacts"," selected"]})]})]}),t.jsx("button",{onClick:_e,disabled:S,className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-400 hover:text-gray-600 hover:bg-white/50 transition-all duration-200 group disabled:opacity-50",children:t.jsx("svg",{className:"w-5 h-5 group-hover:rotate-90 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),S&&t.jsxs("div",{className:"px-4 py-3 bg-blue-50 border-b border-blue-100",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("span",{className:"text-sm font-semibold text-blue-900",children:["Processing ",F.current," of ",F.total," contacts..."]}),t.jsxs("span",{className:"text-sm font-semibold text-blue-700",children:[F.success," success, ",F.failed," failed"]})]}),t.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${F.current/F.total*100}%`}})})]}),t.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200 max-h-32 overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("p",{className:"text-xs font-semibold text-gray-700",children:a==="linkedin"?"Selected LinkedIn URLs:":"Selected Contacts:"}),a==="linkedin"&&Me().length>0&&t.jsxs("button",{id:"copy-linkedin-urls-btn",type:"button",onClick:Se,className:"px-2 py-1 text-xs font-semibold text-blue-600 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition-colors flex items-center gap-1",title:"Copy all LinkedIn URLs",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy All URLs"]})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:a==="linkedin"?t.jsxs(t.Fragment,{children:[se.slice(0,10).map(V=>{const H=V.personLinkedinUrl||V.companyLinkedinUrl;return H?t.jsx("span",{className:"px-2 py-1 bg-white text-xs font-medium text-blue-700 rounded-md border border-blue-200 hover:bg-blue-50 transition-colors break-all",title:H,children:H.length>50?`${H.substring(0,50)}...`:H},V._id||V.name):null}),se.length>10&&t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-xs font-semibold text-blue-700 rounded-md",children:["+",se.length-10," more"]})]}):t.jsxs(t.Fragment,{children:[se.slice(0,10).map(V=>t.jsx("span",{className:"px-2 py-1 bg-white text-xs font-medium text-gray-700 rounded-md border border-gray-200",children:V.name||"N/A"},V._id||V.name)),se.length>10&&t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-xs font-semibold text-blue-700 rounded-md",children:["+",se.length-10," more"]})]})})]}),ae&&a==="linkedin"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Existing"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm usually in touch with teams managing residential projects and leasing, so I was just curious how you manage bookings, rentals, and property maintenance across your units."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I mostly connect with people working in residential and leasing rolesit keeps me close to how things really move on a day-to-day basis."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"The world today feels like one connected marketplace, and being part of the real estate ecosystem, I enjoy connecting with people who are building and managing things on the ground. Looking forward to connecting and exchanging perspectives."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I've noticed that no two property teams manage bookings, rentals, and maintenance the same way. I'm always interested in hearing how others handle it in practice."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Always open to exchanging thoughts and learning how things are shaping up on your side. Would be great to stay connected."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We work closely with property teams to simplify how day-to-day operations are managed  from rentals and billing to maintenance  so things feel more connected and easier to handle."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Everyday operational conversations around properties quietly offer the most value in understanding how things really work."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Enjoy grounded conversations around real work and real challenges. Happy to stay connected and exchange insights whenever it makes sense."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We believe real value often comes from reducing small operational frictions and giving teams better visibility into what's happening across their properties."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm always interested in seeing how teams optimize their workflowsdo you have any strategies that make managing bookings and maintenance simpler?"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I value thoughtful conversations with people close to the work. Whenever it feels right, I'd enjoy exchanging insights as things evolve on your side."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"No worries if you didn't catch my earlier message. Just checking if you're up for a chat about possible ways we can team up and grow together."})]})]})]})})})}):ae&&a==="email"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300 w-[15%]",children:"Email"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 4"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I work closely with people involved in residential projects and leasing, and I enjoy staying connected with those who are close to the day-to-day side of property work."}),t.jsx("p",{children:"At Terabits, we focus on making everyday property operations a little easier by keeping rentals, billing, and maintenance in one place."}),t.jsx("p",{children:"Happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working close to residential projects and leasing. I've found those conversations tend to be the most honest and practical."}),t.jsx("p",{children:"I'm part of the Terabits team, where we focus on making everyday property operations easier to manage."}),t.jsx("p",{children:"Nice to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"font-semibold",children:"Subject: Exchanging notes on leasing & residential work"}),t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working on residential projects and leasing. I've found these conversations to be the most practical."}),t.jsx("p",{children:'When it comes to daily management, where do you usually find the most friction or "extra work" in your current process?'})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I tend to reach out to people in residential leasing because the conversations are usually more practical."}),t.jsx("p",{children:`I'm curiouswhen it comes to your daily management, where do things usually get stuck or feel like a "headache" for your team?`}),t.jsx("p",{children:"Nice to connect,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just wanted to follow up on my last note."}),t.jsx("p",{children:"We usually speak with property teams who want a bit more clarity in their daily workflows without changing how they already operate."}),t.jsx("p",{children:"Always good to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just sharing a short follow-up."}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing without adding extra complexity to daily work."}),t.jsx("p",{children:"Happy to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing."}),t.jsx("p",{children:"This is where Terabits usually steps inwe focus on making those everyday operations feel less like a chore so you can focus on the bigger picture."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"That's usually where we come in. At Terabits, we focus on making those messy partslike rentals, maintenance, and billingfeel a lot more manageable."}),t.jsx("p",{children:"We try to keep the tech simple so it actually helps the team instead of adding more work to their day."}),t.jsx("p",{children:"Happy to stay in touch,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing we often notice is that small improvements in visibility can make day-to-day property work feel much more manageable."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that even small clarity in systems can make a big difference in day-to-day property operations."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that small clarity in systems makes a big difference."}),t.jsx("p",{children:"Specifically, we help by automating the repetitive stufflike tracking maintenance requests or streamlining billing workflowswithout adding extra complexity to your day-to-day work."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I've noticed is that just adding a bit of clarity to maintenance tracking or billing can save a lot of hours."}),t.jsx("p",{children:"We mostly help by automating those repetitive tasks so they just happen in the background. It's a small change that usually makes the day-to-day much smoother."}),t.jsx("p",{children:"Thought I'd share that."})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here for now."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Wishing you a great week ahead."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Take care."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here as I don't want to crowd your inbox."}),t.jsx("p",{children:"If you ever want to swap notes on how to make property workflows easier, I'm always happy to chat."}),t.jsx("p",{children:"Wishing you the best,"})]})})]})]})]})})})}):t.jsx("form",{onSubmit:fe,className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsxs("div",{className:"space-y-4",children:[a!=="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700",children:"Select Template (Optional)"}),(a==="linkedin"||a==="email")&&t.jsxs("button",{type:"button",onClick:()=>re(!0),disabled:S,className:"px-3 py-1.5 text-xs font-semibold text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-all duration-200 flex items-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a==="email"?"View Email Variations":"View Message Variations"]})]}),t.jsxs("select",{value:m.template,onChange:V=>ye("template",V.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"no-template",children:"No Template"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"introduction-email",children:"Introduction Email"}),t.jsx("option",{value:"follow-up-email",children:"Follow-up Email"}),t.jsx("option",{value:"value-proposition-email",children:"Value Proposition Email"})]}):a==="linkedin"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"connection-request-message",children:"Connection Request Message"}),t.jsx("option",{value:"introduction-message",children:"Introduction Message"}),t.jsx("option",{value:"follow-up-message",children:"Follow-up Message"})]}):null]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Account Used ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsxs("select",{value:m.linkedInAccountName,onChange:V=>ye("linkedInAccountName",V.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select LinkedIn account"}),Ne.map((V,H)=>t.jsx("option",{value:V,children:V},H))]})]}),t.jsx("button",{type:"button",onClick:()=>ue(!ce),disabled:S,className:"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",children:ce?"Cancel":"+ Add"})]}),ce&&t.jsxs("div",{className:"mt-3 flex gap-2",children:[t.jsx("input",{type:"text",value:we,onChange:V=>Z(V.target.value),onKeyPress:V=>{V.key==="Enter"&&(V.preventDefault(),Le())},disabled:S,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Enter new LinkedIn account name"}),t.jsx("button",{type:"button",onClick:Le,disabled:!we.trim()||Ne.includes(we.trim())||S,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Add"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select or add a LinkedIn account that sent the connection request"]})]}),a==="linkedin"&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Ln Request Sent ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.lnRequestSent,onChange:V=>ye("lnRequestSent",V.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"}),t.jsx("option",{value:"Existing Connect",children:"Existing Connect"}),t.jsx("option",{value:"Inactive Profile",children:"Inactive Profile"}),t.jsx("option",{value:"Irrelevant Profile",children:"Irrelevant Profile"}),t.jsx("option",{value:"Open to Work",children:"Open to Work"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status of the LinkedIn connection request"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Connected ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.connected,onChange:V=>ye("connected",V.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Whether the connection was established"]})]})]}),(a==="email"||a==="linkedin")&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.status,onChange:V=>ye("status",V.target.value),disabled:S,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed ${w.status?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select status"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Out of Office",children:"Out of Office"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Wrong Person",children:"Wrong Person"}),t.jsx("option",{value:"Bounce",children:"Bounce"}),t.jsx("option",{value:"Opt-Out",children:"Opt-Out"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"})]}):t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"CIP",children:"CIP"}),t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"In-Person Meeting",children:"In-Person Meeting"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"}),t.jsx("option",{value:"SQL",children:"SQL"}),t.jsx("option",{value:"Tech Discussion",children:"Tech Discussion"}),t.jsx("option",{value:"WON",children:"WON"}),t.jsx("option",{value:"Lost",children:"Lost"}),t.jsx("option",{value:"Low Potential - Open",children:"Low Potential - Open"}),t.jsx("option",{value:"Potential Future",children:"Potential Future"})]})]}),w.status&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.status]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a==="email"?"Update the contact status based on this email interaction":"Update the contact status based on this interaction"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Call ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsx("div",{children:t.jsxs("select",{value:m.callNumber,onChange:V=>ye("callNumber",V.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select call number"}),t.jsx("option",{value:"1st call",children:"1st call"}),t.jsx("option",{value:"2nd call",children:"2nd call"}),t.jsx("option",{value:"3rd call",children:"3rd call"}),t.jsx("option",{value:"4th call",children:"4th call"}),t.jsx("option",{value:"5th call",children:"5th call"}),t.jsx("option",{value:"6th call",children:"6th call"}),t.jsx("option",{value:"7th call",children:"7th call"}),t.jsx("option",{value:"8th call",children:"8th call"}),t.jsx("option",{value:"9th call",children:"9th call"}),t.jsx("option",{value:"10th call",children:"10th call"})]})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:m.callDate,onChange:V=>ye("callDate",V.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Select call date"})]})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select which call attempt this is and the date when the call was made"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.callStatus,onChange:V=>ye("callStatus",V.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select status"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Ring",children:"Ring"}),t.jsx("option",{value:"Busy",children:"Busy"}),t.jsx("option",{value:"Call Back",children:"Call Back"}),t.jsx("option",{value:"Hang Up",children:"Hang Up"}),t.jsx("option",{value:"Switch Off",children:"Switch Off"}),t.jsx("option",{value:"Future",children:"Future"}),t.jsx("option",{value:"Details Shared",children:"Details Shared"}),t.jsx("option",{value:"Demo Booked",children:"Demo Booked"}),t.jsx("option",{value:"Invalid",children:"Invalid"}),t.jsx("option",{value:"Existing",children:"Existing"}),t.jsx("option",{value:"Demo Completed",children:"Demo Completed"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the status of this call"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Phone Number ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("input",{type:"tel",value:m.phoneNumber,onChange:V=>ye("phoneNumber",V.target.value),disabled:S||P.phone,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Add phone number (e.g., +1 234-567-8900)"})]}),t.jsx("button",{type:"button",onClick:()=>We("phone",m.phoneNumber,"firstPhone"),disabled:S||P.phone,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database for all selected contacts",children:P.phone?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:me?"Some selected contacts have phone numbers in database. Enter a value to override or leave empty to use existing data.":"This will be applied to all selected contacts. Click Save to store in database for all contacts with valid IDs."})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Address ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("input",{type:"email",value:m.email,onChange:V=>ye("email",V.target.value),disabled:S||P.email,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Add email address (e.g., contact@example.com)"})]}),t.jsx("button",{type:"button",onClick:()=>We("email",m.email,"email"),disabled:S||P.email,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database for all selected contacts",children:P.email?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:W?"Some selected contacts have emails in database. Enter a value to override or leave empty to use existing data.":"This will be applied to all selected contacts. Click Save to store in database for all contacts with valid IDs."})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:m.emailDate,onChange:V=>ye("emailDate",V.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Select email date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the email was sent"]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Profile URL ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("input",{type:"url",value:m.linkedInUrl,onChange:V=>ye("linkedInUrl",V.target.value),disabled:S||P.linkedin,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Add LinkedIn profile URL (e.g., https://linkedin.com/in/username)"})]}),t.jsx("button",{type:"button",onClick:()=>We("linkedin",m.linkedInUrl,"personLinkedinUrl"),disabled:S||P.linkedin,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database for all selected contacts",children:P.linkedin?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:pe?`Using LinkedIn URLs from ${Me().length} selected contact(s). Enter a value to override or leave empty to use existing URLs.`:"This will be applied to all selected contacts. Click Save to store in database for all contacts with valid IDs."}),a==="linkedin"&&Me().length>0&&t.jsxs("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded-md",children:[t.jsxs("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:["LinkedIn URLs from selected contacts (",Me().length,"):"]}),t.jsxs("div",{className:"max-h-20 overflow-y-auto space-y-1",children:[Me().slice(0,5).map((V,H)=>t.jsx("p",{className:"text-xs text-blue-700 break-all font-mono",children:V},H)),Me().length>5&&t.jsxs("p",{className:"text-xs text-blue-600 font-semibold",children:["+",Me().length-5," more URLs"]})]})]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:m.linkedinDate,onChange:V=>ye("linkedinDate",V.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Select LinkedIn date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the LinkedIn activity occurred"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Conversation Notes ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(optional, but helpful)"})]}),t.jsx("textarea",{value:m.conversationNotes,onChange:V=>ye("conversationNotes",V.target.value),disabled:S,rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 resize-y font-sans hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Jot down what happened, any concerns they raised, or what to follow up on. This applies to all selected contacts..."})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.nextAction,onChange:V=>ye("nextAction",V.target.value),disabled:S,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed ${w.nextAction?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"follow-up-call",children:"Follow-up Call"}),t.jsx("option",{value:"send-proposal",children:"Send Proposal"}),t.jsx("option",{value:"schedule-meeting",children:"Schedule Meeting"}),t.jsx("option",{value:"send-email",children:"Send Email"}),t.jsx("option",{value:"connect-linkedin",children:"Connect on LinkedIn"})]}),w.nextAction&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.nextAction]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action Date ",t.jsx("span",{className:m.nextAction?"text-red-500":"text-gray-400 text-xs font-normal",children:m.nextAction?"*":"(Optional)"})]}),t.jsx("div",{className:"relative",children:t.jsx("input",{type:"date",value:m.nextActionDate,onChange:V=>ye("nextActionDate",V.target.value),disabled:S,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed ${w.nextActionDate?"border-red-300 bg-red-50":"border-gray-300"}`})}),w.nextActionDate&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.nextActionDate]})]})]}),w.submit&&t.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-3 animate-shake",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-medium text-red-700",children:w.submit})]})}),t.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-200",children:[t.jsx("button",{type:"button",onClick:_e,disabled:S,className:"px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:S,className:"px-4 py-2 text-xs font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:hover:scale-100",children:S?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Log Activity for ",se.length," ",se.length===1?"Contact":"Contacts"]})})]})]})})]})})}const Bn=l=>l.type==="call"&&l.callDate?new Date(l.callDate):l.type==="email"&&l.emailDate?new Date(l.emailDate):l.type==="linkedin"&&l.linkedinDate?new Date(l.linkedinDate):new Date(l.createdAt),rp=(...l)=>{},Jk=l=>{if(!l._id)return null;try{const n=l._id.toString?l._id.toString():String(l._id);if(n.length>=8){const a=parseInt(n.substring(0,8),16)*1e3;return new Date(a)}}catch(n){console.error("Error extracting import date from contact ID:",n)}return l.createdAt?new Date(l.createdAt):null},Do={};function Zk(){const{id:l}=ci(),n=Fr(),[a,o]=n0(),[s,e]=B.useState(null),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState(null),[L,M]=B.useState(a.get("search")||""),[F,O]=B.useState(""),P=B.useRef(null),G=B.useRef(!1),[ae,re]=B.useState(a.get("quickFilter")||""),[Ne,xe]=B.useState(a.get("filterStatus")||""),[we,Z]=B.useState(a.get("filterActionDate")||""),[ce,ue]=B.useState(a.get("filterActionDateFrom")||""),[Le,be]=B.useState(a.get("filterActionDateTo")||""),[oe,he]=B.useState(a.get("filterLastInteraction")||""),[ye,Te]=B.useState(a.get("filterLastInteractionFrom")||""),[fe,_e]=B.useState(a.get("filterLastInteractionTo")||""),[We,se]=B.useState(a.get("filterImportDate")||""),[me,W]=B.useState(a.get("filterImportDateFrom")||""),[pe,Me]=B.useState(a.get("filterImportDateTo")||""),[Se,V]=B.useState(a.get("filterNoActivity")==="true"),[H,Q]=B.useState(a.get("filterMatchType")||""),[te,de]=B.useState(null),[ve,ke]=B.useState("linkedin"),[ne,De]=B.useState({isOpen:!1,filter:null}),He=B.useCallback(K=>{De({isOpen:!0,filter:K}),de(K);const Ge=new URLSearchParams(a);Ge.set("kpiChannel",K.channel),Ge.set("kpiMetric",K.metric),Ge.set("kpiOpen","1"),o(Ge,{replace:!0})},[a,o]),vt=B.useCallback(()=>{De({isOpen:!1,filter:null}),de(null);const K=new URLSearchParams(a);K.delete("kpiChannel"),K.delete("kpiMetric"),K.delete("kpiOpen"),o(K,{replace:!0})},[a,o]),[Pe,Nt]=B.useState(null),[st,Xt]=B.useState(new Set),[Rt,Ns]=B.useState({}),[Js,ps]=B.useState({}),[ds,Ie]=B.useState({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,lastActivity:null}),[dt,Tt]=B.useState(!1),[ms,nn]=B.useState([]),[rr,$l]=B.useState(new Set),[ln,Vn]=B.useState(!1),[_a,Er]=B.useState({isOpen:!1,type:null}),[Br,Bo]=B.useState({}),[ql,ah]=B.useState({}),[zo,_i]=B.useState(!1),[Ba,Wn]=B.useState(!1),[Zt,Yl]=B.useState(new Set),[Ds,wr]=B.useState(null),[Yc,$n]=B.useState(!1),[Fi,Gl]=B.useState(null),[Dr,ul]=B.useState("asc"),[hl,Mi]=B.useState(!1),Li=B.useRef(null),$r=B.useMemo(()=>{if(!s?.channels)return["call","email","linkedin"];const K=[];return s.channels.coldCalling&&K.push("call"),s.channels.coldEmail&&K.push("email"),s.channels.linkedInOutreach&&K.push("linkedin"),K.length>0?K:["call","email","linkedin"]},[s?.channels]),Fa=B.useMemo(()=>{if(!ms||ms.length===0)return{linkedin:{today:0,tomorrow:0,missed:0},email:{today:0,tomorrow:0,missed:0}};const K=new Date,Ge=new Date(K);Ge.setHours(0,0,0,0);const nt=new Date(Ge);nt.setDate(nt.getDate()+1);const Ue=new Date(nt);Ue.setDate(Ue.getDate()+1);const Xe=new Set,ze=new Set,qe=new Set,Ke=new Set,Be=new Set,Ot=new Set;return ms.forEach(zt=>{if(!zt.nextActionDate||!zt.contactId)return;const Pt=new Date(zt.nextActionDate);Pt.setHours(0,0,0,0);const ht=zt.contactId.toString?zt.contactId.toString():zt.contactId;zt.type==="linkedin"?Pt>=Ge&&Pt<nt?Xe.add(ht):Pt>=nt&&Pt<Ue?ze.add(ht):Pt<Ge&&qe.add(ht):zt.type==="email"&&(Pt>=Ge&&Pt<nt?Ke.add(ht):Pt>=nt&&Pt<Ue?Be.add(ht):Pt<Ge&&Ot.add(ht))}),{linkedin:{today:Xe.size,tomorrow:ze.size,missed:qe.size},email:{today:Ke.size,tomorrow:Be.size,missed:Ot.size}}},[ms]);B.useEffect(()=>{$r.length>0&&!$r.includes(ve)&&ke($r[0])},[$r,ve]),B.useEffect(()=>{const K=Ge=>{Li.current&&!Li.current.contains(Ge.target)&&Mi(!1)};return hl&&document.addEventListener("mousedown",K),()=>{document.removeEventListener("mousedown",K)}},[hl]),B.useEffect(()=>{const K=a.get("search")||"";K&&O(K)},[]),B.useEffect(()=>(P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{O(L)},300),()=>{P.current&&clearTimeout(P.current)}),[L]),B.useEffect(()=>{if(l){a.get("returnTo")||a.get("page")||a.get("kpiChannel")||a.get("kpiMetric")||a.get("kpiOpen")==="1"||(M(""),re(""),xe(""),Z(""),ue(""),be(""),he(""),Te(""),_e(""),se(""),W(""),Me(""),V(!1),Q(""),de(null),De({isOpen:!1,filter:null}),o(new URLSearchParams,{replace:!0}));const Ge=Do[l];Ge&&(Ge.project&&e(Ge.project),Ge.kpiMetrics&&wr(Ge.kpiMetrics),Ge.contacts&&v(Ge.contacts),Ge.allProjectActivities&&nn(Ge.allProjectActivities),N(!1)),oa().then(()=>{const nt=a.get("page"),Ue=nt?parseInt(nt,10):1;Ue!==ur&&Ys(Ue),Promise.all([hi().catch(Xe=>{console.error("Error fetching activities:",Xe)}),Na(Ue).catch(Xe=>{console.error("Error fetching imported contacts:",Xe)}),Ts().catch(Xe=>{console.error("Error fetching KPI metrics:",Xe)})])})}},[l]),B.useEffect(()=>{if(!l)return;const K=a.get("kpiChannel"),Ge=a.get("kpiMetric"),nt=a.get("kpiOpen")==="1";if(K&&Ge){const Ue={channel:K,metric:Ge};de(Ue),nt&&De({isOpen:!0,filter:Ue})}},[l,a]),B.useEffect(()=>{if(!l)return;if(!G.current){G.current=!0;return}Ys(1);const K=new URLSearchParams(a);K.delete("page"),o(K,{replace:!0}),Na(1)},[F,l]),B.useEffect(()=>{if(!l)return;const K=a.get("page"),Ge=K?parseInt(K,10):1;if(Ge!==ur&&Ge>=1&&!F){const nt=setTimeout(()=>{Ge!==ur&&(Ys(Ge),Na(Ge))},50);return()=>clearTimeout(nt)}},[a.get("page"),l,a]);const oa=async()=>{try{N(!0);const K=await Ht.get(`/projects/${l}`);if(K.data.success){const Ge=K.data.data;e(Ge),Do[l]={...Do[l]||{},project:Ge}}}catch(K){console.error("Error fetching project:",K),D("Having trouble loading the project. Refresh the page and try again.")}finally{N(!1)}},Ts=async()=>{try{$n(!0);const K=await Ht.get(`/projects/${l}/kpi-metrics`);if(K.data.success){const Ge=K.data.data;wr(Ge),Do[l]={...Do[l]||{},kpiMetrics:Ge}}}catch(K){console.error("Error fetching KPI metrics:",K)}finally{$n(!1)}},[ur,Ys]=B.useState(()=>{const K=a.get("page");return K?parseInt(K,10):1}),[jr,on]=B.useState(0),[di,Cn]=B.useState(1),fl=50,Na=async(K=1)=>{try{N(!0);const Ge=F?1e4:fl,nt=F?`&search=${encodeURIComponent(F)}`:"",Ue=await Ht.get(`/projects/${l}/project-contacts?page=${K}&limit=${Ge}${nt}`);if(Ue.data.success){const Xe=Ue.data.data||[],ze=Ue.data.pagination||{};on(ze.total||Xe.length),Cn(ze.totalPages||1),Ys(K);const qe=new Map;Xe.forEach(Be=>{const Ot=Be._id?.toString?Be._id.toString():String(Be._id);if(!Ot)return;const zt=qe.get(Ot);if(!zt)qe.set(Ot,Be);else{const Pt=zt.projectContactId!==null&&zt.projectContactId!==void 0;Be.projectContactId!==null&&Be.projectContactId!==void 0&&!Pt&&qe.set(Ot,Be)}});let Ke=Array.from(qe.values());Zt.size>0&&(Ke=Ke.filter(Be=>{if(!Be._id)return!0;const Ot=Be._id.toString?Be._id.toString():String(Be._id);return!Zt.has(Ot)})),v(Ke),K===1&&!F&&(Do[l]={...Do[l]||{},contacts:Ke})}}catch(Ge){console.error("Error fetching imported contacts:",Ge)}finally{N(!1)}},cn=B.useCallback(K=>{if(K>=1&&K!==ur){const Ge=new URLSearchParams(a);K===1?Ge.delete("page"):Ge.set("page",K.toString()),o(Ge,{replace:!0}),Na(K)}},[ur,l,a,o]),Sn=async()=>{try{const K=await Ht.get(`/projects/${l}/similar-contacts`);if(K.data.success){let Ge=K.data.data||[];if(Zt.size>0){const nt=Ge.length;Ge=Ge.filter(Ue=>{if(!Ue._id)return!0;const Xe=Ue._id.toString?Ue._id.toString():String(Ue._id);return!Zt.has(Xe)}),nt!==Ge.length&&rp(`Filtered out ${nt-Ge.length} previously deleted contact(s) from similar contacts`)}return v(Ge),K.data.matchStats&&Nt(K.data.matchStats),K.data.hasICP===!1?(Vn(!1),ln&&alert(K.data.message||"No ICP defined for this project. Please add an ICP definition to get suggestions."),!1):!0}}catch(K){return console.error("Error fetching similar contacts:",K),!1}},ca=s?.icpDefinition?.companySizeMin!==void 0&&s?.icpDefinition?.companySizeMax!==void 0&&!(s.icpDefinition.companySizeMin===0&&s.icpDefinition.companySizeMax===1e3),qr=s?.icpDefinition?.targetIndustries&&Array.isArray(s.icpDefinition.targetIndustries)&&s.icpDefinition.targetIndustries.length>0,zr=s?.icpDefinition?.targetJobTitles&&Array.isArray(s.icpDefinition.targetJobTitles)&&s.icpDefinition.targetJobTitles.length>0,Ma=s?.icpDefinition?.geographies&&Array.isArray(s.icpDefinition.geographies)&&s.icpDefinition.geographies.length>0,ui=s?.icpDefinition?.keywords&&Array.isArray(s.icpDefinition.keywords)&&s.icpDefinition.keywords.length>0,cs=qr||zr||Ma||ui||ca;B.useEffect(()=>{const K=new URLSearchParams;L&&K.set("search",L),ae&&K.set("quickFilter",ae),Ne&&K.set("filterStatus",Ne),we&&K.set("filterActionDate",we),ce&&K.set("filterActionDateFrom",ce),Le&&K.set("filterActionDateTo",Le),oe&&K.set("filterLastInteraction",oe),ye&&K.set("filterLastInteractionFrom",ye),fe&&K.set("filterLastInteractionTo",fe),We&&K.set("filterImportDate",We),me&&K.set("filterImportDateFrom",me),pe&&K.set("filterImportDateTo",pe),Se&&K.set("filterNoActivity","true"),H&&K.set("filterMatchType",H),o(K,{replace:!0})},[L,ae,Ne,we,ce,Le,oe,ye,fe,We,me,pe,Se,H,o]),B.useEffect(()=>{ln&&!cs&&(Vn(!1),Na().catch(K=>{console.error("Error fetching imported contacts:",K)}))},[cs,ln]);const Gc=async()=>{if(!cs){alert("No ICP (Ideal Customer Profile) is defined for this project. Please add an ICP definition in project settings to get suggestions.");return}const K=!ln;Vn(K),K?(!await Sn()||!cs)&&(Vn(!1),cs||alert("No ICP (Ideal Customer Profile) is defined for this project. Please add an ICP definition in project settings to get suggestions.")):await Na()},hi=async()=>{try{const K=await Ht.get(`/activities/project/${l}?limit=5000`);if(K.data.success){const Ge=K.data.data||[];nn(Ge),Do[l]={...Do[l]||{},allProjectActivities:Ge},Ts()}}catch(K){console.error("Error fetching project activities:",K)}},Nr=B.useMemo(()=>{const K={byContactId:new Map,lastActivityByContactId:new Map,nextActionByContactId:new Map,latestActivityStatusByContactId:new Map},Ge=new Date;return ms.forEach(nt=>{if(nt.contactId){const Ue=nt.contactId.toString();K.byContactId.has(Ue)||K.byContactId.set(Ue,[]),K.byContactId.get(Ue).push(nt);const Xe=K.lastActivityByContactId.get(Ue),ze=Bn(nt);if(!Xe)K.lastActivityByContactId.set(Ue,nt);else{const Ke=Bn(Xe);ze>Ke&&K.lastActivityByContactId.set(Ue,nt)}if(nt.nextActionDate&&new Date(nt.nextActionDate)>=Ge){const Ke=K.nextActionByContactId.get(Ue);(!Ke||new Date(nt.nextActionDate)<new Date(Ke.nextActionDate))&&K.nextActionByContactId.set(Ue,nt)}let qe=null;if(nt.type==="call"&&nt.callStatus&&nt.callStatus.trim()!==""?qe=nt.callStatus:nt.status&&nt.status.trim()!==""&&(qe=nt.status),qe){const Ke=K.latestActivityStatusByContactId.get(Ue),Be=Bn(nt);if(!Ke)K.latestActivityStatusByContactId.set(Ue,{status:qe,createdAt:Be,activityDate:Be});else{const Ot=Ke.activityDate?new Date(Ke.activityDate):new Date(Ke.createdAt);Be>Ot&&K.latestActivityStatusByContactId.set(Ue,{status:qe,createdAt:Be,activityDate:Be})}}}}),K},[ms]),kr=B.useCallback(async(K,Ge,nt)=>{if(Js[K])return;const Ue=K?.toString?K.toString():K;if(Ue)try{ps(qe=>({...qe,[K]:!0}));const ze=(Nr.byContactId.get(Ue)||[]).filter(qe=>qe.projectId&&qe.projectId.toString()===l);if(ze.length>0){Ns(qe=>({...qe,[K]:ze.sort((Ke,Be)=>new Date(Be.createdAt)-new Date(Ke.createdAt))})),ps(qe=>({...qe,[K]:!1}));return}try{const qe=await Ht.get(`/activities/contact/${Ue}?projectId=${l}`);if(qe.data.success){const Ke=qe.data.data||[];Ns(Be=>({...Be,[K]:Ke.sort((Ot,zt)=>new Date(zt.createdAt)-new Date(Ot.createdAt))}))}}catch(qe){console.warn(`API call failed for contact ${Ue}, using cached activities:`,qe.message);const Ke=ms.filter(Be=>{if((Be.projectId?.toString?Be.projectId.toString():Be.projectId)!==l)return!1;if(Be.contactId&&(Be.contactId.toString?Be.contactId.toString():Be.contactId)===Ue)return!0;if(Ge||nt){const zt=Ge?.toLowerCase()||"",Pt=nt?.toLowerCase()||"",ht=Be.conversationNotes?.toLowerCase()||"";return ht.includes(zt)||ht.includes(Pt)}return!1});Ns(Be=>({...Be,[K]:Ke.sort((Ot,zt)=>new Date(zt.createdAt)-new Date(Ot.createdAt))}))}}catch(Xe){console.error("Error fetching activities:",Xe)}finally{ps(Xe=>({...Xe,[K]:!1}))}},[Js,Nr,ms]),Uo=B.useCallback(async(K,Ge,nt)=>{st.has(K)?B.startTransition(()=>{Xt(Xe=>{const ze=new Set(Xe);return ze.delete(K),ze})}):(B.startTransition(()=>{Xt(Xe=>new Set(Xe).add(K))}),kr(K,Ge,nt).catch(Xe=>{console.error("Error fetching activities:",Xe)}))},[st,kr]),Mr=(K,Ge)=>{const nt=Ge._id?Ge._id.toString?Ge._id.toString():String(Ge._id):null;let Ue=null,Xe=K;nt&&(Ue=Nr.lastActivityByContactId.get(nt)||null,Ue&&Ue.type&&(Xe=Ue.type)),Ie({isOpen:!0,type:Xe,contactName:Ge.name||"N/A",companyName:Ge.company||"",projectId:l,contactId:nt||null,phoneNumber:Ge.firstPhone||null,email:Ge.email||null,linkedInProfileUrl:Ge.personLinkedinUrl||Ge.companyLinkedinUrl||null,lastActivity:Ue||null})},qn=async(K=!1)=>{Ie({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,lastActivity:null}),await hi(),await new Promise(Ge=>setTimeout(Ge,100)),ln?await Sn():await Na(),st.forEach(Ge=>{const nt=m.find(Ue=>(Ue._id||Ue.name)===Ge);nt&&kr(Ge,nt.email,nt.name)})},Ka=async()=>{Er({isOpen:!1,type:null}),$l(new Set),await hi(),await new Promise(K=>setTimeout(K,100)),ln?await Sn():await Na(),st.forEach(K=>{const Ge=m.find(nt=>(nt._id||nt.name)===K);Ge&&kr(K,Ge.email,Ge.name)})},gs=K=>K?K.split(" ").map(Ge=>Ge[0]).join("").toUpperCase().slice(0,2):"?",An=K=>{const nt={Ring:{bg:"bg-yellow-100",text:"text-yellow-800"},Busy:{bg:"bg-orange-100",text:"text-orange-800"},"Call Back":{bg:"bg-amber-100",text:"text-amber-800"},"Hang Up":{bg:"bg-red-100",text:"text-red-800"},"Switch Off":{bg:"bg-gray-100",text:"text-gray-800"},Invalid:{bg:"bg-red-100",text:"text-red-800"},Future:{bg:"bg-blue-100",text:"text-blue-800"},Existing:{bg:"bg-indigo-100",text:"text-indigo-800"},Interested:{bg:"bg-green-100",text:"text-green-800"},"Not Interested":{bg:"bg-red-100",text:"text-red-800"},"Details Shared":{bg:"bg-cyan-100",text:"text-cyan-800"},"Demo Booked":{bg:"bg-purple-100",text:"text-purple-800"},"Demo Completed":{bg:"bg-emerald-100",text:"text-emerald-800"},CIP:{bg:"bg-blue-100",text:"text-blue-800"},"No Reply":{bg:"bg-gray-100",text:"text-gray-800"},"Out of Office":{bg:"bg-gray-100",text:"text-gray-800"},"Meeting Proposed":{bg:"bg-yellow-100",text:"text-yellow-800"},"Meeting Scheduled":{bg:"bg-cyan-100",text:"text-cyan-800"},"In-Person Meeting":{bg:"bg-indigo-100",text:"text-indigo-800"},"Meeting Completed":{bg:"bg-green-100",text:"text-green-800"},SQL:{bg:"bg-emerald-100",text:"text-emerald-800"},"Tech Discussion":{bg:"bg-purple-100",text:"text-purple-800"},WON:{bg:"bg-green-200",text:"text-green-900",border:"border-2 border-green-400"},Lost:{bg:"bg-red-200",text:"text-red-900",border:"border-2 border-red-400"},"Low Potential - Open":{bg:"bg-orange-100",text:"text-orange-800"},"Potential Future":{bg:"bg-teal-100",text:"text-teal-800"},"Wrong Person":{bg:"bg-red-100",text:"text-red-800"},Bounce:{bg:"bg-red-100",text:"text-red-800"},"Opt-Out":{bg:"bg-red-100",text:"text-red-800"},New:{bg:"bg-blue-100",text:"text-blue-800"},Contacted:{bg:"bg-purple-100",text:"text-purple-800"},Qualified:{bg:"bg-green-100",text:"text-green-800"},Proposal:{bg:"bg-yellow-100",text:"text-yellow-800"},Negotiation:{bg:"bg-orange-100",text:"text-orange-800"}}[K]||{bg:"bg-gray-100",text:"text-gray-800"};return t.jsx("span",{className:`inline-flex items-center justify-center px-2.5 py-1 text-xs font-medium rounded-full whitespace-nowrap ${nt.bg} ${nt.text} ${nt.border||""}`,children:K})},dn=K=>{if(!K)return"N/A";const Ge=K instanceof Date?K:new Date(K);return isNaN(Ge.getTime())?"N/A":Ge.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},Kc=K=>{if(!K)return"N/A";const Ge=K instanceof Date?K:new Date(K);return isNaN(Ge.getTime())?"N/A":Ge.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},Kl=({contact:K,activities:Ge})=>{const nt=()=>{const Ke=Ge.filter(ht=>ht.type==="call").length,Be=Ge.filter(ht=>ht.type==="email").length,Ot=Ge.filter(ht=>ht.type==="linkedin").length,zt=Ge.length,Pt=Math.min(100,Math.max(0,zt*10+(zt>0?30:0)));return{totalInteractions:zt,callsMade:Ke,emailsSent:Be,linkedInMessages:Ot,engagementScore:Pt}},Ue=Ke=>{switch(Ke){case"call":return t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},Xe=Ke=>{switch(Ke){case"call":return"Call";case"email":return"Email";case"linkedin":return"LinkedIn";default:return"Activity"}},ze=Ke=>({"connected-had-conversation":"Connected","left-voicemail":"Left Voicemail","no-answer":"No Answer","wrong-number":"Wrong Number","not-interested":"Not Interested","email-sent-successfully":"Sent","email-bounced":"Bounced","received-reply":"Received Reply","out-of-office-response":"Out of Office","connection-request-sent":"Connection Request Sent","message-sent":"Message Sent","connection-accepted":"Connection Accepted"})[Ke]||Ke,qe=nt();return t.jsxs("div",{className:"py-4 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),t.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Activity Summary"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-600",children:"Calls Made"}),t.jsx("span",{className:"text-xs font-semibold text-gray-900",children:qe.callsMade})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-600",children:"Emails Sent"}),t.jsx("span",{className:"text-xs font-semibold text-gray-900",children:qe.emailsSent})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-600",children:"LinkedIn Messages"}),t.jsx("span",{className:"text-xs font-semibold text-gray-900",children:qe.linkedInMessages})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Engagement Score"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:qe.engagementScore}),t.jsx("div",{className:"text-xs text-gray-500",children:"out of 100"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Interaction Timeline"}),t.jsxs("button",{onClick:()=>Mr("call",K),className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Log Activity"]})]}),Ge.length===0?t.jsx("div",{className:"text-center py-8 text-gray-500 text-sm transition-opacity duration-300",children:'No activities logged yet. Click "Log Activity" to get started.'}):t.jsx("div",{className:"space-y-4 animate-fade-in",children:Ge.sort((Ke,Be)=>Bn(Be)-Bn(Ke)).map((Ke,Be)=>t.jsxs("div",{className:"flex items-start gap-4 pb-4 border-b border-gray-100 last:border-0 transition-all duration-300 hover:bg-gray-50 rounded-lg px-2 -mx-2 py-1",style:{animationDelay:`${Be*50}ms`},children:[t.jsx("div",{className:"flex-shrink-0 mt-1",children:Ue(Ke.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"mb-2",children:t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:Xe(Ke.type)})}),Ke.conversationNotes&&(()=>{const zt=Ke.conversationNotes.replace(/\[Contact:.*?\|.*?Email:.*?\|.*?Phone:.*?\|.*?LinkedIn:.*?\]/g,"").trim().replace(/\[Contact:.*?\]/g,"").trim();return zt?t.jsx("p",{className:"text-sm text-gray-700 mb-2 whitespace-pre-wrap leading-relaxed",children:zt}):null})(),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("span",{className:`px-2 py-0.5 rounded font-medium ${Ke.type==="call"?"bg-blue-100 text-blue-700":Ke.type==="email"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:ze(Ke.outcome)}),t.jsxs("span",{children:["by ",s?.assignedTo||"User"]})]})]}),t.jsx("div",{className:"flex-shrink-0 text-xs text-gray-500 text-right whitespace-nowrap",children:Kc(Bn(Ke))})]},Ke._id))})]})]})},Yn=B.useMemo(()=>m.filter(K=>{if(Ne){const Ge=(K._id?.toString?K._id.toString():K._id)||"";if(((Ge?Nr.latestActivityStatusByContactId.get(Ge):null)?.status||null||K.stage||"New")!==Ne)return!1}if(we||ce||Le){K._id||K.name;const Ge=K._id?.toString?K._id.toString():K._id,nt=Ge?Nr.nextActionByContactId.get(Ge):null;if(we==="custom"&&(ce||Le)){if(!nt||!nt.nextActionDate)return!1;const Ue=new Date(nt.nextActionDate);if(Ue.setHours(0,0,0,0),ce){const Xe=new Date(ce);if(Xe.setHours(0,0,0,0),Ue<Xe)return!1}if(Le){const Xe=new Date(Le);if(Xe.setHours(23,59,59,999),Ue>Xe)return!1}}else if(we&&we!=="custom"){if(!nt||!nt.nextActionDate)return!1;const Ue=new Date(nt.nextActionDate);Ue.setHours(0,0,0,0);const Xe=new Date,ze=new Date(Xe.getFullYear(),Xe.getMonth(),Xe.getDate()),qe=new Date(ze);switch(qe.setDate(qe.getDate()+1),we){case"today":if(Ue<ze||Ue>=qe)return!1;break;case"this-week":const Ke=ze.getDay(),Be=Ke===0?6:Ke-1,Ot=new Date(ze);Ot.setDate(ze.getDate()-Be),Ot.setHours(0,0,0,0);const zt=new Date(Ot);if(zt.setDate(Ot.getDate()+7),Ue<Ot||Ue>=zt)return!1;break;case"this-month":const Pt=new Date(Xe.getFullYear(),Xe.getMonth(),1),ht=new Date(Xe.getFullYear(),Xe.getMonth()+1,1);if(Ue<Pt||Ue>=ht)return!1;break}}}if(oe||ye||fe){const Ge=(K._id?.toString?K._id.toString():K._id)||"",nt=Ge?Nr.lastActivityByContactId.get(Ge):null;if(oe==="custom"&&(ye||fe)){if(!nt)return!1;const Ue=Bn(nt);if(Ue.setHours(0,0,0,0),ye){const Xe=new Date(ye);if(Xe.setHours(0,0,0,0),Ue<Xe)return!1}if(fe){const Xe=new Date(fe);if(Xe.setHours(23,59,59,999),Ue>Xe)return!1}}else if(oe&&oe!=="custom"){if(!nt)return!1;const Ue=Bn(nt);Ue.setHours(0,0,0,0);const Xe=new Date,ze=new Date(Xe.getFullYear(),Xe.getMonth(),Xe.getDate()),qe=new Date(ze);switch(qe.setDate(qe.getDate()+1),oe){case"today":if(Ue<ze||Ue>=qe)return!1;break;case"this-week":const Ke=ze.getDay(),Be=Ke===0?6:Ke-1,Ot=new Date(ze);Ot.setDate(ze.getDate()-Be),Ot.setHours(0,0,0,0);const zt=new Date(Ot);if(zt.setDate(Ot.getDate()+7),Ue<Ot||Ue>=zt)return!1;break;case"this-month":const Pt=new Date(Xe.getFullYear(),Xe.getMonth(),1),ht=new Date(Xe.getFullYear(),Xe.getMonth()+1,1);if(Ue<Pt||Ue>=ht)return!1;break}}}if(We||me||pe){const Ge=Jk(K);if(!Ge)return!1;if(We==="custom"&&(me||pe)){const nt=new Date(Ge);if(nt.setHours(0,0,0,0),me){const Ue=new Date(me);if(Ue.setHours(0,0,0,0),nt<Ue)return!1}if(pe){const Ue=new Date(pe);if(Ue.setHours(23,59,59,999),nt>Ue)return!1}}else if(We&&We!=="custom"){const nt=new Date(Ge);nt.setHours(0,0,0,0);const Ue=new Date,Xe=new Date(Ue.getFullYear(),Ue.getMonth(),Ue.getDate()),ze=new Date(Xe);ze.setDate(ze.getDate()-1);const qe=new Date(Xe);switch(qe.setDate(qe.getDate()+1),We){case"today":if(nt<Xe||nt>=qe)return!1;break;case"yesterday":if(nt<ze||nt>=Xe)return!1;break}}}if(Se){const Ge=(K._id?.toString?K._id.toString():K._id)||"";if((Ge?Nr.lastActivityByContactId.get(Ge):null)||ms.some(Xe=>{if(!Xe.contactId)return!1;if((Xe.contactId.toString?Xe.contactId.toString():Xe.contactId)===Ge)return!0;if(!Ge){const qe=K.email?.toLowerCase()||"",Ke=K.name?.toLowerCase()||"",Be=Xe.conversationNotes?.toLowerCase()||"",Ot=Xe.email?.toLowerCase()||"";return qe&&(Be.includes(qe)||Ot===qe)||Ke&&Be.includes(Ke)}return!1}))return!1}if(te){const Ge=(K._id?.toString?K._id.toString():K._id)||"",nt=ms.filter(Xe=>{if((Xe.projectId?.toString?Xe.projectId.toString():Xe.projectId)!==l)return!1;if(Ge&&Xe.contactId&&(Xe.contactId.toString?Xe.contactId.toString():Xe.contactId)===Ge)return!0;if(!Ge||!Xe.contactId){const qe=Xe.conversationNotes?.toLowerCase()||"",Ke=K.name?.toLowerCase()||"",Be=K.email?.toLowerCase()||"";return qe.includes(Ke)||qe.includes(Be)}return!1});let Ue=!1;if(te.channel==="linkedin"){const Xe=nt.filter(ze=>ze.type==="linkedin");te.metric==="connectionSent"?Ue=Xe.some(ze=>ze.lnRequestSent===!0||ze.lnRequestSent==="Yes"):te.metric==="accepted"?Ue=Xe.some(ze=>ze.connected===!0||ze.connected==="Yes"):te.metric==="followUps"?Ue=Xe.length>1:te.metric==="cip"?Ue=Xe.some(ze=>ze.status&&(ze.status==="CIP"||ze.status==="Conversations in Progress")):te.metric==="meetingProposed"?Ue=Xe.some(ze=>ze.status==="Meeting Proposed"):te.metric==="scheduled"?Ue=Xe.some(ze=>ze.status==="Meeting Scheduled"):te.metric==="completed"?Ue=Xe.some(ze=>ze.status==="Meeting Completed"):te.metric==="sql"?Ue=K.stage==="SQL":te.metric==="win"?Ue=K.stage==="WON":te.metric==="connectionRequestsSent"?Ue=Xe.some(ze=>ze.lnRequestSent===!0||ze.lnRequestSent==="Yes"):te.metric==="connectionAcceptanceRate"?Ue=Xe.some(ze=>ze.connected===!0||ze.connected==="Yes"):te.metric==="messagesSent"?Ue=Xe.some(ze=>ze.status&&ze.status!==""):te.metric==="messageReplyRate"?Ue=Xe.some(ze=>ze.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(ze.status)):te.metric==="meetingsBooked"&&(Ue=Xe.some(ze=>ze.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(ze.status)))}else if(te.channel==="call"){const Xe=nt.filter(ze=>ze.type==="call");te.metric==="allProspects"?Ue=!0:te.metric==="callsAttempted"||te.metric==="totalCalls"?Ue=Xe.length>0:te.metric==="callsConnected"?Ue=Xe.some(ze=>ze.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(ze.callStatus)):te.metric==="decisionMakerReached"?Ue=Xe.some(ze=>ze.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up","Not Interested"].includes(ze.callStatus)):te.metric==="interested"?Ue=Xe.some(ze=>ze.callStatus==="Interested"):te.metric==="notInterested"?Ue=Xe.some(ze=>ze.callStatus==="Not Interested"):te.metric==="detailsShared"?Ue=Xe.some(ze=>ze.callStatus==="Details Shared"):te.metric==="demoBooked"?Ue=Xe.some(ze=>ze.callStatus==="Demo Booked"):te.metric==="demoCompleted"?Ue=Xe.some(ze=>ze.callStatus==="Demo Completed"):te.metric==="sql"?Ue=K.stage==="SQL":te.metric==="won"?Ue=K.stage==="WON":te.metric==="callsMade"?Ue=Xe.length>0:te.metric==="callAnswerRate"?Ue=Xe.some(ze=>ze.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(ze.callStatus)):te.metric==="callInterestedRate"?Ue=Xe.some(ze=>ze.callStatus&&["Interested","Details Shared","Demo Booked","Demo Completed"].includes(ze.callStatus)):te.metric==="meetingsBooked"&&(Ue=Xe.some(ze=>ze.callStatus&&["Demo Booked","Demo Completed"].includes(ze.callStatus)))}else if(te.channel==="email"){const Xe=nt.filter(ze=>ze.type==="email");te.metric==="emailsSent"?Ue=Xe.length>0:te.metric==="accepted"?Ue=Xe.some(ze=>ze.status&&ze.status!=="Bounce"&&ze.status!=="Opt-Out"&&ze.status!=="No Reply"):te.metric==="followups"?Ue=Xe.length>1:te.metric==="cip"?Ue=Xe.some(ze=>ze.status&&(ze.status==="CIP"||ze.status==="Conversations in Progress")):te.metric==="meetingProposed"?Ue=Xe.some(ze=>ze.status==="Meeting Proposed"):te.metric==="scheduled"?Ue=Xe.some(ze=>ze.status==="Meeting Scheduled"):te.metric==="completed"?Ue=Xe.some(ze=>ze.status==="Meeting Completed"):te.metric==="sql"?Ue=K.stage==="SQL":te.metric==="emailBounce"?Ue=Xe.some(ze=>ze.status==="Bounce"):te.metric==="emailOpenRate"?Ue=Xe.some(ze=>ze.status&&ze.status!=="Bounce"&&ze.status!=="Opt-Out"&&ze.status!=="No Reply"):te.metric==="emailReplyRate"?Ue=Xe.some(ze=>ze.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(ze.status)):te.metric==="meetingsBooked"&&(Ue=Xe.some(ze=>ze.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(ze.status)))}if(!Ue)return!1}if(ae==="due-today"){const Ge=new Date;Ge.setHours(0,0,0,0);const nt=new Date(Ge);nt.setDate(nt.getDate()+1);const Ue=(K._id?.toString?K._id.toString():K._id)||"";if(!(Ue?Nr.byContactId.get(Ue)||[]:[]).some(qe=>{if(!qe.nextActionDate)return!1;const Ke=new Date(qe.nextActionDate);return Ke.setHours(0,0,0,0),Ke>=Ge&&Ke<nt}))return!1}else if(ae==="new-prospects"){const Ge=(K._id?.toString?K._id.toString():K._id)||"";if(((Ge?Nr.latestActivityStatusByContactId.get(Ge):null)?.status||null||K.stage||"New")!=="New")return!1}return!0}).sort((K,Ge)=>{if(Fi==="name"){const nt=(K.name||"").toLowerCase(),Ue=(Ge.name||"").toLowerCase();return Dr==="asc"?nt.localeCompare(Ue):Ue.localeCompare(nt)}return 0}),[m,F,ae,Ne,we,ce,Le,oe,ye,fe,We,me,pe,Se,H,te,ms,s,Nr,l,Fi,Dr]),[ys,fi]=B.useState([]),[Qc,Gs]=B.useState(!1),mi=B.useCallback(async()=>{try{Gs(!0),fi([]);const K=await Ht.get(`/projects/${l}/project-contacts?page=1&limit=10000`);if(K.data.success){const Ge=K.data.data||[],Ue=(K.data.pagination||{}).total||Ge.length;let Xe=[...Ge];if(Ge.length<Ue&&Ue>1e4){const Ke=Math.ceil(Ue/1e4),Be=[];for(let Ot=2;Ot<=Ke;Ot++)try{const zt=await Ht.get(`/projects/${l}/project-contacts?page=${Ot}&limit=10000`);zt.data.success&&Be.push(...zt.data.data||[])}catch(zt){console.error(`Error fetching page ${Ot} for KPI:`,zt)}Xe=[...Ge,...Be]}const ze=new Map;Xe.forEach(Ke=>{const Be=Ke._id?.toString?Ke._id.toString():String(Ke._id);if(!Be)return;const Ot=ze.get(Be);if(!Ot)ze.set(Be,Ke);else{const zt=Ot.projectContactId!==null&&Ot.projectContactId!==void 0;Ke.projectContactId!==null&&Ke.projectContactId!==void 0&&!zt&&ze.set(Be,Ke)}});const qe=Array.from(ze.values());fi(qe)}}catch(K){console.error("Error fetching all contacts for KPI:",K),fi([])}finally{Gs(!1)}},[l]),Ho=B.useCallback(K=>K?(ys.length>0?ys:m).filter(nt=>{const Ue=(nt._id?.toString?nt._id.toString():nt._id)||"",ze=(Ue?Nr.byContactId.get(Ue)||[]:[]).filter(Ke=>(Ke.projectId?.toString?Ke.projectId.toString():Ke.projectId)===l);if(ze.length===0&&(!Ue||Ue==="")){const Ke=ms.filter(ht=>{if((ht.projectId?.toString?ht.projectId.toString():ht.projectId)!==l)return!1;const Cs=ht.conversationNotes?.toLowerCase()||"",_s=nt.name?.toLowerCase()||"",ws=nt.email?.toLowerCase()||"";return Cs.includes(_s)||Cs.includes(ws)});if(Ke.length===0)return!1;const Be=Ke.filter(ht=>ht.type==="linkedin"),Ot=Ke.filter(ht=>ht.type==="call"),zt=Ke.filter(ht=>ht.type==="email");let Pt=!1;if(K.channel==="linkedin")K.metric==="connectionSent"?Pt=Be.some(ht=>ht.lnRequestSent===!0||ht.lnRequestSent==="Yes"):K.metric==="accepted"?Pt=Be.some(ht=>ht.connected===!0||ht.connected==="Yes"):K.metric==="followUps"?Pt=Be.length>1:K.metric==="cip"?Pt=Be.some(ht=>ht.status&&(ht.status==="CIP"||ht.status==="Conversations in Progress")):K.metric==="meetingProposed"?Pt=Be.some(ht=>ht.status==="Meeting Proposed"):K.metric==="scheduled"?Pt=Be.some(ht=>ht.status==="Meeting Scheduled"):K.metric==="completed"?Pt=Be.some(ht=>ht.status==="Meeting Completed"):K.metric==="sql"?Pt=nt.stage==="SQL":K.metric==="win"?Pt=nt.stage==="WON":K.metric==="connectionRequestsSent"?Pt=Be.some(ht=>ht.lnRequestSent===!0||ht.lnRequestSent==="Yes"):K.metric==="connectionAcceptanceRate"?Pt=Be.some(ht=>ht.connected===!0||ht.connected==="Yes"):K.metric==="messagesSent"?Pt=Be.some(ht=>ht.status&&ht.status!==""):K.metric==="messageReplyRate"?Pt=Be.some(ht=>ht.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(ht.status)):K.metric==="meetingsBooked"&&(Pt=Be.some(ht=>ht.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(ht.status)));else if(K.channel==="call"){if(K.metric==="allProspects")Pt=!0;else if(K.metric==="callsAttempted")Pt=Ot.length>0;else if(K.metric==="callsConnected")Pt=Ot.some(ht=>ht.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(ht.callStatus));else if(K.metric==="decisionMakerReached")Pt=Ot.some(ht=>ht.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up","Not Interested"].includes(ht.callStatus));else if(K.metric==="interested")Pt=Ot.some(ht=>ht.callStatus==="Interested");else if(K.metric==="notInterested")Pt=Ot.some(ht=>ht.callStatus==="Not Interested");else if(K.metric==="detailsShared")Pt=Ot.some(ht=>ht.callStatus==="Details Shared");else if(K.metric==="demoBooked")Pt=Ot.some(ht=>ht.callStatus==="Demo Booked");else if(K.metric==="demoCompleted")Pt=Ot.some(ht=>ht.callStatus==="Demo Completed");else if(K.metric==="sql")Pt=nt.stage==="SQL";else if(K.metric==="won")Pt=nt.stage==="WON";else if(K.metric==="followups"||K.metric==="todayFollowups"||K.metric==="tomorrowFollowups"||K.metric==="missedFollowups"){const ht=new Date,qt=new Date(ht);qt.setHours(0,0,0,0);const Cs=new Date(qt);Cs.setDate(Cs.getDate()+1);const _s=new Date(Cs);_s.setDate(_s.getDate()+1),Pt=Ot.some(ws=>{if(!ws.nextActionDate)return!1;const kt=new Date(ws.nextActionDate);return kt.setHours(0,0,0,0),K.metric==="followups"?!0:K.metric==="todayFollowups"?kt>=qt&&kt<Cs:K.metric==="tomorrowFollowups"?kt>=Cs&&kt<_s:K.metric==="missedFollowups"?kt<qt:!1})}}else K.channel==="email"&&(K.metric==="followups"?Pt=zt.some(ht=>ht.nextActionDate!=null):K.metric==="emailsSent"?Pt=zt.length>0:K.metric==="accepted"?Pt=zt.some(ht=>ht.status&&ht.status!=="Bounce"&&ht.status!=="Opt-Out"&&ht.status!=="No Reply"):K.metric==="cip"?Pt=zt.some(ht=>ht.status&&(ht.status==="CIP"||ht.status==="Conversations in Progress")):K.metric==="meetingProposed"?Pt=zt.some(ht=>ht.status==="Meeting Proposed"):K.metric==="scheduled"?Pt=zt.some(ht=>ht.status==="Meeting Scheduled"):K.metric==="completed"?Pt=zt.some(ht=>ht.status==="Meeting Completed"):K.metric==="sql"?Pt=nt.stage==="SQL":K.metric==="emailBounce"?Pt=zt.some(ht=>ht.status==="Bounce"):K.metric==="emailOpenRate"?Pt=zt.some(ht=>ht.status&&ht.status!=="Bounce"&&ht.status!=="Opt-Out"&&ht.status!=="No Reply"):K.metric==="emailReplyRate"?Pt=zt.some(ht=>ht.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(ht.status)):K.metric==="meetingsBooked"&&(Pt=zt.some(ht=>ht.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(ht.status))));return Pt}let qe=!1;if(K.channel==="linkedin"){const Ke=ze.filter(Be=>Be.type==="linkedin");if(K.metric==="connectionSent")qe=Ke.some(Be=>Be.lnRequestSent===!0||Be.lnRequestSent==="Yes");else if(K.metric==="accepted")qe=Ke.some(Be=>Be.connected===!0||Be.connected==="Yes");else if(K.metric==="followUps")qe=Ke.length>1;else if(K.metric==="cip")qe=Ke.some(Be=>Be.status&&(Be.status==="CIP"||Be.status==="Conversations in Progress"));else if(K.metric==="meetingProposed")qe=Ke.some(Be=>Be.status==="Meeting Proposed");else if(K.metric==="scheduled")qe=Ke.some(Be=>Be.status==="Meeting Scheduled");else if(K.metric==="completed")qe=Ke.some(Be=>Be.status==="Meeting Completed");else if(K.metric==="sql")qe=nt.stage==="SQL";else if(K.metric==="win")qe=nt.stage==="WON";else if(K.metric==="followups"||K.metric==="todayFollowups"||K.metric==="tomorrowFollowups"||K.metric==="missedFollowups"){const Be=new Date,Ot=new Date(Be);Ot.setHours(0,0,0,0);const zt=new Date(Ot);zt.setDate(zt.getDate()+1);const Pt=new Date(zt);Pt.setDate(Pt.getDate()+1),qe=Ke.some(ht=>{if(!ht.nextActionDate)return!1;const qt=new Date(ht.nextActionDate);return qt.setHours(0,0,0,0),K.metric==="followups"?!0:K.metric==="todayFollowups"?qt>=Ot&&qt<zt:K.metric==="tomorrowFollowups"?qt>=zt&&qt<Pt:K.metric==="missedFollowups"?qt<Ot:!1})}else K.metric==="connectionRequestsSent"?qe=Ke.some(Be=>Be.lnRequestSent===!0||Be.lnRequestSent==="Yes"):K.metric==="connectionAcceptanceRate"?qe=Ke.some(Be=>Be.connected===!0||Be.connected==="Yes"):K.metric==="messagesSent"?qe=Ke.some(Be=>Be.status&&Be.status!==""):K.metric==="messageReplyRate"?qe=Ke.some(Be=>Be.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Be.status)):K.metric==="meetingsBooked"&&(qe=Ke.some(Be=>Be.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Be.status)))}else if(K.channel==="call"){const Ke=ze.filter(Be=>Be.type==="call");if(K.metric==="allProspects")qe=!0;else if(K.metric==="callsAttempted")qe=Ke.length>0;else if(K.metric==="totalCalls")qe=Ke.length>0;else if(K.metric==="callsConnected")qe=Ke.some(Be=>Be.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Be.callStatus));else if(K.metric==="decisionMakerReached")qe=Ke.some(Be=>Be.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up","Not Interested"].includes(Be.callStatus));else if(K.metric==="interested")qe=Ke.some(Be=>Be.callStatus==="Interested");else if(K.metric==="notInterested")qe=Ke.some(Be=>Be.callStatus==="Not Interested");else if(K.metric==="detailsShared")qe=Ke.some(Be=>Be.callStatus==="Details Shared");else if(K.metric==="demoBooked")qe=Ke.some(Be=>Be.callStatus==="Demo Booked");else if(K.metric==="demoCompleted")qe=Ke.some(Be=>Be.callStatus==="Demo Completed");else if(K.metric==="sql")qe=nt.stage==="SQL";else if(K.metric==="won")qe=nt.stage==="WON";else if(K.metric==="followups"||K.metric==="todayFollowups"||K.metric==="tomorrowFollowups"||K.metric==="missedFollowups"){const Be=new Date,Ot=new Date(Be);Ot.setHours(0,0,0,0);const zt=new Date(Ot);zt.setDate(zt.getDate()+1);const Pt=new Date(zt);Pt.setDate(Pt.getDate()+1),qe=Ke.some(ht=>{if(!ht.nextActionDate)return!1;const qt=new Date(ht.nextActionDate);return qt.setHours(0,0,0,0),K.metric==="followups"?!0:K.metric==="todayFollowups"?qt>=Ot&&qt<zt:K.metric==="tomorrowFollowups"?qt>=zt&&qt<Pt:K.metric==="missedFollowups"?qt<Ot:!1})}else K.metric==="callsMade"?qe=Ke.length>0:K.metric==="callAnswerRate"?qe=Ke.some(Be=>Be.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Be.callStatus)):K.metric==="callInterestedRate"?qe=Ke.some(Be=>Be.callStatus&&["Interested","Details Shared","Demo Booked","Demo Completed"].includes(Be.callStatus)):K.metric==="meetingsBooked"&&(qe=Ke.some(Be=>Be.callStatus&&["Demo Booked","Demo Completed"].includes(Be.callStatus)))}else if(K.channel==="email"){const Ke=ze.filter(Be=>Be.type==="email");if(K.metric==="followups"||K.metric==="todayFollowups"||K.metric==="tomorrowFollowups"||K.metric==="missedFollowups"){const Be=new Date,Ot=new Date(Be);Ot.setHours(0,0,0,0);const zt=new Date(Ot);zt.setDate(zt.getDate()+1);const Pt=new Date(zt);Pt.setDate(Pt.getDate()+1),qe=Ke.some(ht=>{if(!ht.nextActionDate)return!1;const qt=new Date(ht.nextActionDate);return qt.setHours(0,0,0,0),K.metric==="followups"?!0:K.metric==="todayFollowups"?qt>=Ot&&qt<zt:K.metric==="tomorrowFollowups"?qt>=zt&&qt<Pt:K.metric==="missedFollowups"?qt<Ot:!1})}else K.metric==="emailsSent"?qe=Ke.length>0:K.metric==="accepted"?qe=Ke.some(Be=>Be.status&&Be.status!=="Bounce"&&Be.status!=="Opt-Out"&&Be.status!=="No Reply"):K.metric==="cip"?qe=Ke.some(Be=>Be.status&&(Be.status==="CIP"||Be.status==="Conversations in Progress")):K.metric==="meetingProposed"?qe=Ke.some(Be=>Be.status==="Meeting Proposed"):K.metric==="scheduled"?qe=Ke.some(Be=>Be.status==="Meeting Scheduled"):K.metric==="completed"?qe=Ke.some(Be=>Be.status==="Meeting Completed"):K.metric==="sql"?qe=nt.stage==="SQL":K.metric==="emailBounce"?qe=Ke.some(Be=>Be.status==="Bounce"):K.metric==="emailOpenRate"?qe=Ke.some(Be=>Be.status&&Be.status!=="Bounce"&&Be.status!=="Opt-Out"&&Be.status!=="No Reply"):K.metric==="emailReplyRate"?qe=Ke.some(Be=>Be.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Be.status)):K.metric==="meetingsBooked"&&(qe=Ke.some(Be=>Be.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Be.status)))}return qe}):[],[ys,m,Nr,ms,l]);B.useEffect(()=>{ne.isOpen&&ne.filter?hi().then(()=>{mi()}):ne.isOpen||fi([])},[ne.isOpen,ne.filter,mi]);const Vo=B.useMemo(()=>Yn.length===0?!1:Yn.every(K=>rr.has((K._id||K.name).toString())),[Yn,rr]),Ri=B.useCallback(K=>{const Ge=K.target.checked;B.startTransition(()=>{$l(nt=>{const Ue=new Set(nt);return Yn.forEach(Xe=>{const ze=(Xe._id||Xe.name).toString();Ge?Ue.add(ze):Ue.delete(ze)}),Ue})})},[Yn]),l0=B.useCallback((K,Ge)=>{B.startTransition(()=>{$l(nt=>{const Ue=new Set(nt);return Ge?Ue.add(K.toString()):Ue.delete(K.toString()),Ue})})},[]),o0=B.useCallback(()=>{B.startTransition(()=>{$l(new Set)})},[]),hr=async()=>{if(rr.size!==0){Wn(!0);try{const K=Array.from(rr),Ge=await Ht.delete(`/projects/${l}/project-contacts`,{data:{contactIds:K}});if(Ge.data.success){const nt=Ge.data.data?.deletedCount||0;if(nt===0){alert("No prospects were removed. They may have already been deleted."),Wn(!1);return}$l(new Set),_i(!1);const Ue=new Set;K.forEach(ze=>{const qe=String(ze);Ue.add(qe),ze&&typeof ze=="object"&&ze.toString&&Ue.add(ze.toString())});const Xe=new Set(Ue);Yl(ze=>{const qe=new Set(ze);return Ue.forEach(Ke=>qe.add(Ke)),qe}),v(ze=>{const qe=ze.filter(Ke=>{if(!Ke._id)return!0;const Be=Ke._id.toString?Ke._id.toString():String(Ke._id),Ot=Ke._id;return!(Ue.has(Be)||Ot&&Ue.has(String(Ot)))});return rp(`Removed ${ze.length-qe.length} contact(s) from UI`),qe}),Xt(ze=>{const qe=new Set(ze);return Ue.forEach(Ke=>{qe.delete(Ke)}),qe}),Ns(ze=>{const qe={...ze};return Ue.forEach(Ke=>{delete qe[Ke]}),qe}),nn(ze=>ze.filter(qe=>{if(!qe.contactId)return!0;const Ke=qe.contactId.toString?qe.contactId.toString():String(qe.contactId);return!Ue.has(Ke)})),setTimeout(async()=>{try{ln?await Sn():await Na(),v(ze=>{const qe=ze.filter(Ke=>{if(!Ke._id)return!0;const Be=Ke._id.toString?Ke._id.toString():String(Ke._id);return!Xe.has(Be)});return ze.length!==qe.length&&rp(`Removed ${ze.length-qe.length} contact(s) that reappeared after refresh`),qe}),await hi()}catch(ze){console.error("Background refresh after deletion:",ze)}},1e3),rp(`Successfully removed ${nt} prospect(s)`)}}catch(K){console.error("Error removing prospects:",K),alert(K.response?.data?.error||"Couldn't remove those prospects. Try again in a moment.")}finally{Wn(!1)}}};return B.useMemo(()=>{const K=new Date;K.setHours(0,0,0,0);const Ge=new Date(K);Ge.setDate(Ge.getDate()+7);let nt=0,Ue=0;return m.forEach(Xe=>{const ze=Xe._id?.toString?Xe._id.toString():Xe._id,qe=ze?Nr.byContactId.get(ze)||[]:[];qe.some(Ot=>Ot.nextActionDate?new Date(Ot.nextActionDate)<K:!1)&&nt++,qe.some(Ot=>{if(!Ot.nextActionDate)return!1;const zt=new Date(Ot.nextActionDate);return zt>=K&&zt<Ge})&&Ue++}),{total:m.length,active:m.filter(Xe=>{const ze=Xe.stage||"New";return ze==="Qualified"||ze==="Proposal"||ze==="Negotiation"}).length,overdue:nt,thisWeek:Ue}},[m,Nr]),w?t.jsx("div",{className:"p-6 flex items-center justify-center min-h-screen",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):S||!s?t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:S||"Project not found"})}):t.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[t.jsxs("div",{className:"flex items-start justify-between mb-6",children:[t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("button",{onClick:()=>n("/projects"),className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors mt-1",title:"Back to Projects",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[s&&t.jsx("h1",{className:"text-3xl font-bold text-indigo-600 mb-1",children:s.companyName}),t.jsx("p",{className:"text-lg font-semibold text-gray-700",children:"Prospect Management"})]})]}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap justify-end",children:[t.jsxs("button",{onClick:()=>n(`/prospects/dashboard?projectId=${l}`),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-colors font-medium text-sm shadow-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Prospect Analytics"]}),t.jsxs("button",{onClick:()=>n(`/projects/${l}/report`),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-lg hover:from-blue-700 hover:to-cyan-700 transition-colors font-medium text-sm shadow-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Report"]}),t.jsxs("button",{onClick:Gc,disabled:!cs,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors font-medium text-sm ${cs?ln?"bg-blue-600 text-white hover:bg-blue-700":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50":"bg-gray-100 border border-gray-300 text-gray-400 cursor-not-allowed"}`,title:cs?"Show prospect suggestions based on ICP":"No ICP defined. Add an ICP definition to get suggestions.",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Prospect Suggestion",!cs&&t.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})]}),t.jsxs("button",{onClick:()=>Tt(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Bulk Import"]})]})]}),Ds&&t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"mb-3 overflow-x-auto -mx-1 px-1 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:[t.jsx("style",{children:`
              .scrollbar-thin::-webkit-scrollbar {
                height: 6px;
              }
              .scrollbar-thin::-webkit-scrollbar-track {
                background: transparent;
              }
              .scrollbar-thin::-webkit-scrollbar-thumb {
                background-color: #cbd5e1;
                border-radius: 3px;
              }
              .scrollbar-thin::-webkit-scrollbar-thumb:hover {
                background-color: #94a3b8;
              }
            `}),t.jsxs("div",{className:"flex gap-2 min-w-max pb-2",children:[$r.includes("linkedin")&&t.jsxs("div",{onClick:()=>ke("linkedin"),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-medium text-xs whitespace-nowrap transition-all cursor-pointer min-w-[150px] justify-center ${ve==="linkedin"?"bg-blue-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("span",{children:"LinkedIn Pipeline"})]}),$r.includes("call")&&t.jsxs("div",{onClick:()=>ke("call"),className:`flex items-center justify-center gap-2.5 px-6 py-3 rounded-xl font-semibold text-sm whitespace-nowrap transition-all duration-200 cursor-pointer min-w-[200px] ${ve==="call"?"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg shadow-green-500/30 hover:shadow-xl hover:shadow-green-500/40":"bg-white text-gray-700 border-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50 shadow-sm"}`,children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{children:"Cold Calling Pipeline"})]}),$r.includes("email")&&t.jsxs("div",{onClick:()=>ke("email"),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-medium text-xs whitespace-nowrap transition-all cursor-pointer min-w-[150px] justify-center ${ve==="email"?"bg-blue-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{children:"Email Pipeline"})]})]})]}),$r.includes("linkedin")&&ve==="linkedin"&&Ds&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-9 gap-2",children:[t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"connectionSent"}),className:`bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="linkedin"&&te?.metric==="connectionSent"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"Sent"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.linkedin?.connectionSent||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Connection Sent"})]}),t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"accepted"}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="linkedin"&&te?.metric==="accepted"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Accepted"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.linkedin?.accepted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Accepted"})]}),t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"followUps"}),className:`bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="linkedin"&&te?.metric==="followUps"?"border-purple-400 ring-2 ring-purple-200":"border-purple-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full",children:"Follow"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.linkedin?.followUps||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Follow-ups"})]}),t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"cip"}),className:`bg-gradient-to-br from-cyan-50 to-blue-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="linkedin"&&te?.metric==="cip"?"border-cyan-400 ring-2 ring-cyan-200":"border-cyan-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full",children:"CIP"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.linkedin?.cip||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"CIP"})]}),t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"meetingProposed"}),className:`bg-gradient-to-br from-yellow-50 to-amber-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="linkedin"&&te?.metric==="meetingProposed"?"border-yellow-400 ring-2 ring-yellow-200":"border-yellow-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-yellow-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-yellow-700 bg-white/70 border border-yellow-100 px-2 py-1 rounded-full",children:"Proposed"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.linkedin?.meetingProposed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Meeting Proposed"})]}),t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"scheduled"}),className:`bg-gradient-to-br from-orange-50 to-red-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="linkedin"&&te?.metric==="scheduled"?"border-orange-400 ring-2 ring-orange-200":"border-orange-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-orange-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-orange-700 bg-white/70 border border-orange-100 px-2 py-1 rounded-full",children:"Scheduled"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.linkedin?.scheduled||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Scheduled"})]}),t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"completed"}),className:`bg-gradient-to-br from-teal-50 to-green-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="linkedin"&&te?.metric==="completed"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Done"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.linkedin?.completed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Completed"})]}),t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"sql"}),className:`bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="linkedin"&&te?.metric==="sql"?"border-indigo-400 ring-2 ring-indigo-200":"border-indigo-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full",children:"SQL"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.linkedin?.sql||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"SQL"})]}),t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"win"}),className:`bg-gradient-to-br from-emerald-50 to-green-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="linkedin"&&te?.metric==="win"?"border-emerald-400 ring-2 ring-emerald-200":"border-emerald-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full",children:"WON"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.linkedin?.win||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Win"})]})]}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-start",children:[t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"todayFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Today's Follow-ups (",Fa.linkedin.today,")"]}),t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"tomorrowFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-emerald-200 text-emerald-700 bg-emerald-50 hover:bg-emerald-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Tomorrow's Follow-ups (",Fa.linkedin.tomorrow,")"]}),t.jsxs("button",{onClick:()=>He({channel:"linkedin",metric:"missedFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-rose-200 text-rose-700 bg-rose-50 hover:bg-rose-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Missed Follow-ups (",Fa.linkedin.missed,")"]})]})]}),$r.includes("call")&&ve==="call"&&Ds&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2",children:[t.jsxs("button",{onClick:()=>He({channel:"call",metric:"callsAttempted"}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="callsAttempted"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Calls"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.callsAttempted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Calls Attempted"})]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"totalCalls"}),className:`bg-gradient-to-br from-teal-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="totalCalls"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5h6m-6 4h6m-6 4h6m-6 4h6"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Total"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.callsMade||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Total Calls"})]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"callsConnected"}),className:`bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="callsConnected"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"Connected"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.callsConnected||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Calls Connected"})]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"decisionMakerReached"}),className:`bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="decisionMakerReached"?"border-purple-400 ring-2 ring-purple-200":"border-purple-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full",children:"DM"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.decisionMakerReached||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Decision Maker Reached"})]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"interested"}),className:`bg-gradient-to-br from-yellow-50 to-amber-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="interested"?"border-yellow-400 ring-2 ring-yellow-200":"border-yellow-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-yellow-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-yellow-700 bg-white/70 border border-yellow-100 px-2 py-1 rounded-full",children:"Interest"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.interested||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Interested"})]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"detailsShared"}),className:`bg-gradient-to-br from-indigo-50 to-blue-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="detailsShared"?"border-indigo-400 ring-2 ring-indigo-200":"border-indigo-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full",children:"Details"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.detailsShared||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Details Shared"})]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"demoBooked"}),className:`bg-gradient-to-br from-teal-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="demoBooked"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Demo"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.demoBooked||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Demo Booked"})]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"demoCompleted"}),className:`bg-gradient-to-br from-emerald-50 to-green-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="demoCompleted"?"border-emerald-400 ring-2 ring-emerald-200":"border-emerald-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full",children:"Done"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.demoCompleted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Demo Completed"})]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"sql"}),className:`bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="sql"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"SQL"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.sql||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"SQL"})]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"won"}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="won"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"WON"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.won||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"WON"})]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"notInterested"}),className:`bg-gradient-to-br from-red-50 to-pink-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="call"&&te?.metric==="notInterested"?"border-red-400 ring-2 ring-red-200":"border-red-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full",children:"Not Interested"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.call?.notInterested||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Not Interested"})]})]}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-start",children:[t.jsxs("button",{onClick:()=>He({channel:"call",metric:"todayFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Today's Follow-ups (",Ds.call?.todayFollowups||0,")"]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"tomorrowFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-emerald-200 text-emerald-700 bg-emerald-50 hover:bg-emerald-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Tomorrow's Follow-ups (",Ds.call?.tomorrowFollowups||0,")"]}),t.jsxs("button",{onClick:()=>He({channel:"call",metric:"missedFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-rose-200 text-rose-700 bg-rose-50 hover:bg-rose-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Missed Follow-ups (",Ds.call?.missedFollowups||0,")"]})]})]}),$r.includes("email")&&ve==="email"&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-9 gap-2",children:[t.jsxs("button",{onClick:()=>He({channel:"email",metric:"emailsSent"}),className:`bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="email"&&te?.metric==="emailsSent"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"Sent"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.email?.emailsSent||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Emails Sent"})]}),t.jsxs("button",{onClick:()=>He({channel:"email",metric:"accepted"}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="email"&&te?.metric==="accepted"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Accepted"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.email?.accepted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Accepted"})]}),t.jsxs("button",{onClick:()=>He({channel:"email",metric:"followups"}),className:`bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="email"&&te?.metric==="followups"?"border-purple-400 ring-2 ring-purple-200":"border-purple-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full",children:"Followups"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.email?.followups||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Follow-ups"})]}),t.jsxs("button",{onClick:()=>He({channel:"email",metric:"cip"}),className:`bg-gradient-to-br from-amber-50 to-yellow-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="email"&&te?.metric==="cip"?"border-amber-400 ring-2 ring-amber-200":"border-amber-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full",children:"CIP"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.email?.cip||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"CIP"})]}),t.jsxs("button",{onClick:()=>He({channel:"email",metric:"meetingProposed"}),className:`bg-gradient-to-br from-teal-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="email"&&te?.metric==="meetingProposed"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Proposed"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.email?.meetingProposed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Meeting Proposed"})]}),t.jsxs("button",{onClick:()=>He({channel:"email",metric:"scheduled"}),className:`bg-gradient-to-br from-indigo-50 to-blue-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="email"&&te?.metric==="scheduled"?"border-indigo-400 ring-2 ring-indigo-200":"border-indigo-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full",children:"Scheduled"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.email?.scheduled||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Scheduled"})]}),t.jsxs("button",{onClick:()=>He({channel:"email",metric:"completed"}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="email"&&te?.metric==="completed"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Completed"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.email?.completed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Completed"})]}),t.jsxs("button",{onClick:()=>He({channel:"email",metric:"sql"}),className:`bg-gradient-to-br from-pink-50 to-rose-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="email"&&te?.metric==="sql"?"border-pink-400 ring-2 ring-pink-200":"border-pink-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-pink-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),t.jsx("span",{className:"text-xs font-semibold text-pink-700 bg-white/70 border border-pink-100 px-2 py-1 rounded-full",children:"SQL"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.email?.sql||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"SQL"})]}),t.jsxs("button",{onClick:()=>He({channel:"email",metric:"emailBounce"}),className:`bg-gradient-to-br from-red-50 to-rose-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${te?.channel==="email"&&te?.metric==="emailBounce"?"border-red-400 ring-2 ring-red-200":"border-red-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full",children:"Bounce"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Ds.email?.emailBounce||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Email Bounce"})]})]}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-start",children:[t.jsxs("button",{onClick:()=>He({channel:"email",metric:"todayFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Today's Follow-ups (",Fa.email.today,")"]}),t.jsxs("button",{onClick:()=>He({channel:"email",metric:"tomorrowFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-emerald-200 text-emerald-700 bg-emerald-50 hover:bg-emerald-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Tomorrow's Follow-ups (",Fa.email.tomorrow,")"]}),t.jsxs("button",{onClick:()=>He({channel:"email",metric:"missedFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-rose-200 text-rose-700 bg-rose-50 hover:bg-rose-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Missed Follow-ups (",Fa.email.missed,")"]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),t.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"})]}),te&&t.jsxs("button",{onClick:()=>de(null),className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear KPI Filter"]})]}),t.jsx("div",{className:"mb-4",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",placeholder:"Search by name, company, email...",value:L,onChange:K=>M(K.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[t.jsx("div",{className:"text-xs font-medium text-gray-500",children:"Quick Filters:"}),t.jsx("button",{onClick:()=>{re(ae==="due-today"?"":"due-today")},className:`px-3 py-1.5 text-xs font-medium rounded-lg transition-all duration-200 ${ae==="due-today"?"bg-blue-600 text-white border border-blue-600 shadow-sm":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200 hover:border-gray-400"}`,children:"Due Today"}),t.jsx("button",{onClick:()=>{const K=ae==="new-prospects"?"":"new-prospects";re(K),K==="new-prospects"?xe("New"):ae==="new-prospects"&&xe("")},className:`px-3 py-1.5 text-xs font-medium rounded-lg transition-all duration-200 ${ae==="new-prospects"?"bg-blue-600 text-white border border-blue-600 shadow-sm":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200 hover:border-gray-400"}`,children:"New Prospects"}),t.jsxs("div",{className:"ml-auto flex items-center gap-3",children:[t.jsxs("select",{value:Ne,onChange:K=>{xe(K.target.value),K.target.value!=="New"&&ae==="new-prospects"&&re("")},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Filter by status"}),t.jsxs("optgroup",{label:"Call Statuses",children:[t.jsx("option",{value:"Ring",children:"Ring"}),t.jsx("option",{value:"Busy",children:"Busy"}),t.jsx("option",{value:"Call Back",children:"Call Back"}),t.jsx("option",{value:"Hang Up",children:"Hang Up"}),t.jsx("option",{value:"Switch Off",children:"Switch Off"}),t.jsx("option",{value:"Invalid",children:"Invalid"}),t.jsx("option",{value:"Future",children:"Future"}),t.jsx("option",{value:"Existing",children:"Existing"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Details Shared",children:"Details Shared"}),t.jsx("option",{value:"Demo Booked",children:"Demo Booked"}),t.jsx("option",{value:"Demo Completed",children:"Demo Completed"})]}),t.jsxs("optgroup",{label:"Email & LinkedIn Statuses",children:[t.jsx("option",{value:"CIP",children:"CIP"}),t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Out of Office",children:"Out of Office"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"In-Person Meeting",children:"In-Person Meeting"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"}),t.jsx("option",{value:"SQL",children:"SQL"}),t.jsx("option",{value:"Tech Discussion",children:"Tech Discussion"}),t.jsx("option",{value:"WON",children:"WON"}),t.jsx("option",{value:"Lost",children:"Lost"}),t.jsx("option",{value:"Low Potential - Open",children:"Low Potential - Open"}),t.jsx("option",{value:"Potential Future",children:"Potential Future"}),t.jsx("option",{value:"Wrong Person",children:"Wrong Person"}),t.jsx("option",{value:"Bounce",children:"Bounce"}),t.jsx("option",{value:"Opt-Out",children:"Opt-Out"})]})]}),t.jsxs("select",{value:we,onChange:K=>{Z(K.target.value),K.target.value!=="custom"&&(ue(""),be(""))},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Action Date"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"this-week",children:"This Week"}),t.jsx("option",{value:"this-month",children:"This Month"}),t.jsx("option",{value:"custom",children:"Custom Range"})]}),we==="custom"&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"date",value:ce,onChange:K=>{ue(K.target.value),K.target.value&&Le&&new Date(K.target.value)>new Date(Le)&&be(K.target.value)},max:Le||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"From"}),t.jsx("span",{className:"text-xs text-gray-500",children:"to"}),t.jsx("input",{type:"date",value:Le,onChange:K=>{be(K.target.value),K.target.value&&ce&&new Date(K.target.value)<new Date(ce)&&ue(K.target.value)},min:ce||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"To"})]}),t.jsxs("select",{value:oe,onChange:K=>{he(K.target.value),K.target.value!=="custom"&&(Te(""),_e(""))},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Last Interaction"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"this-week",children:"This Week"}),t.jsx("option",{value:"this-month",children:"This Month"}),t.jsx("option",{value:"custom",children:"Custom Range"})]}),oe==="custom"&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"date",value:ye,onChange:K=>{Te(K.target.value),K.target.value&&fe&&new Date(K.target.value)>new Date(fe)&&_e(K.target.value)},max:fe||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"From"}),t.jsx("span",{className:"text-xs text-gray-500",children:"to"}),t.jsx("input",{type:"date",value:fe,onChange:K=>{_e(K.target.value),K.target.value&&ye&&new Date(K.target.value)<new Date(ye)&&Te(K.target.value)},min:ye||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"To"})]}),t.jsxs("select",{value:We,onChange:K=>{se(K.target.value),K.target.value!=="custom"&&(W(""),Me(""))},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Import Date"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"yesterday",children:"Yesterday"}),t.jsx("option",{value:"custom",children:"Custom Range"})]}),We==="custom"&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"date",value:me,onChange:K=>{W(K.target.value),K.target.value&&pe&&new Date(K.target.value)>new Date(pe)&&Me(K.target.value)},max:pe||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"From"}),t.jsx("span",{className:"text-xs text-gray-500",children:"to"}),t.jsx("input",{type:"date",value:pe,onChange:K=>{Me(K.target.value),K.target.value&&me&&new Date(K.target.value)<new Date(me)&&W(K.target.value)},min:me||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"To"})]}),t.jsxs("label",{className:"flex items-center gap-2 px-3 py-1.5 text-xs border border-gray-300 rounded-lg bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Se,onChange:K=>V(K.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500 cursor-pointer"}),t.jsx("span",{className:"text-gray-700",children:"No Activity"})]})]})]}),(L||ae||Ne||we||ce||Le||oe||ye||fe||We||me||pe||Se||H)&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 flex items-center gap-2 flex-wrap",children:[t.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Active filters:"}),L&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:['Search: "',L,'"',t.jsx("button",{onClick:()=>M(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),ae==="due-today"&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Due Today",t.jsx("button",{onClick:()=>re(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),ae==="new-prospects"&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["New Prospects",t.jsx("button",{onClick:()=>{re(""),xe("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Ne&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Status: ",Ne,t.jsx("button",{onClick:()=>xe(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(we||ce||Le)&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Action Date: ",we==="custom"&&(ce||Le)?`${ce?dn(ce):"..."} to ${Le?dn(Le):"..."}`:we==="today"?"Today":we==="this-week"?"This Week":we==="this-month"?"This Month":we,t.jsx("button",{onClick:()=>{Z(""),ue(""),be("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(oe||ye||fe)&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Last Interaction: ",oe==="custom"&&(ye||fe)?`${ye?dn(ye):"..."} to ${fe?dn(fe):"..."}`:oe==="today"?"Today":oe==="this-week"?"This Week":oe==="this-month"?"This Month":oe,t.jsx("button",{onClick:()=>{he(""),Te(""),_e("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(We||me||pe)&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Import Date: ",We==="custom"&&(me||pe)?`${me?dn(me):"..."} to ${pe?dn(pe):"..."}`:We==="today"?"Today":We==="yesterday"?"Yesterday":We,t.jsx("button",{onClick:()=>{se(""),W(""),Me("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Se&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["No Activity",t.jsx("button",{onClick:()=>V(!1),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),H&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Match: ",H==="exact"?"Exact":H==="good"?"Good":H==="similar"?"Similar":H==="loose"?"Loose":"Imported",t.jsx("button",{onClick:()=>Q(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("button",{onClick:()=>{M(""),re(""),xe(""),Z(""),ue(""),be(""),he(""),Te(""),_e(""),se(""),W(""),Me(""),V(!1),Q("")},className:"text-xs text-gray-600 hover:text-gray-900 font-medium ml-2",children:"Clear all"})]})]}),t.jsx("div",{className:"mb-3 flex items-center justify-between flex-wrap gap-3",children:t.jsx("div",{className:"flex items-center gap-4 flex-wrap",children:Pe&&t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Pe.imported>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-700 text-xs font-semibold rounded-md border border-purple-200",children:[t.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),Pe.imported," Imported"]}),Pe.exact>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-md border border-green-200",children:[t.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),Pe.exact," Exact"]}),Pe.good>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-md border border-blue-200",children:[t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),Pe.good," Good"]}),Pe.similar>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-semibold rounded-md border border-yellow-200",children:[t.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),Pe.similar," Similar"]})]})})}),ln&&cs&&s?.icpDefinition&&t.jsx("div",{className:"mb-4 bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 border-2 border-indigo-200 rounded-2xl p-5 shadow-lg",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"ICP-Based Recommendations"}),t.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Showing prospects from databank that match your project's Ideal Customer Profile"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mt-4",children:[s.icpDefinition.targetIndustries&&s.icpDefinition.targetIndustries.length>0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Target Industries"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.targetIndustries.slice(0,2).join(", "),s.icpDefinition.targetIndustries.length>2&&` +${s.icpDefinition.targetIndustries.length-2} more`]})]}),s.icpDefinition.targetJobTitles&&s.icpDefinition.targetJobTitles.length>0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Target Job Titles"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.targetJobTitles.slice(0,2).join(", "),s.icpDefinition.targetJobTitles.length>2&&` +${s.icpDefinition.targetJobTitles.length-2} more`]})]}),s.icpDefinition.companySizeMin!==void 0&&s.icpDefinition.companySizeMax!==void 0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Company Size"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.companySizeMin.toLocaleString()," - ",s.icpDefinition.companySizeMax.toLocaleString()," employees"]})]}),s.icpDefinition.geographies&&s.icpDefinition.geographies.length>0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Geographies"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.geographies.slice(0,2).join(", "),s.icpDefinition.geographies.length>2&&` +${s.icpDefinition.geographies.length-2} more`]})]})]}),Pe&&t.jsx("div",{className:"mt-4 flex items-center gap-4 flex-wrap",children:t.jsxs("div",{className:"text-xs text-gray-600 font-medium",children:["Recommendations:",t.jsxs("span",{className:"ml-2 inline-flex items-center gap-2",children:[Pe.exact>0&&t.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full font-semibold",children:[Pe.exact," Exact"]}),Pe.good>0&&t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full font-semibold",children:[Pe.good," Good"]}),Pe.similar>0&&t.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full font-semibold",children:[Pe.similar," Similar"]}),Pe.loose>0&&t.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded-full font-semibold",children:[Pe.loose," Loose"]})]})]})})]})})}),rr.size>0&&t.jsxs("div",{className:"mb-4 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border-2 border-blue-200 rounded-2xl p-5 shadow-xl animate-slide-down backdrop-blur-sm relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 opacity-5",children:t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 animate-pulse"})}),t.jsxs("div",{className:"relative flex items-center justify-between flex-wrap gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-700 rounded-2xl flex items-center justify-center shadow-lg transform hover:scale-110 transition-transform duration-300 ring-4 ring-blue-200 ring-opacity-50 animate-bounce-subtle",children:t.jsx("span",{className:"text-white font-bold text-lg",children:rr.size})}),t.jsx("div",{className:"absolute inset-0 bg-blue-600 rounded-2xl animate-ping opacity-20"})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("p",{className:"text-base font-bold text-gray-900 tracking-tight",children:[rr.size," ",rr.size===1?"prospect":"prospects"," selected"]}),t.jsx("p",{className:"text-xs text-gray-600 font-medium mt-0.5",children:"Choose an activity type to log for all selected prospects"})]})]}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[$r.includes("call")&&t.jsxs("button",{onClick:()=>Er({isOpen:!0,type:"call"}),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-green-500 via-green-600 to-emerald-600 text-white text-sm font-bold rounded-xl hover:from-green-600 hover:via-green-700 hover:to-emerald-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:rotate-12 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{className:"relative z-10",children:"Log Call"})]}),$r.includes("email")&&t.jsxs("button",{onClick:()=>Er({isOpen:!0,type:"email"}),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 via-blue-600 to-cyan-600 text-white text-sm font-bold rounded-xl hover:from-blue-600 hover:via-blue-700 hover:to-cyan-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:scale-110 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{className:"relative z-10",children:"Log Email"})]}),$r.includes("linkedin")&&t.jsxs("button",{onClick:()=>Er({isOpen:!0,type:"linkedin"}),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-700 via-indigo-700 to-purple-700 text-white text-sm font-bold rounded-xl hover:from-blue-800 hover:via-indigo-800 hover:to-purple-800 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:scale-110 transition-transform duration-300",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("span",{className:"relative z-10",children:"Log LinkedIn"})]}),t.jsxs("button",{onClick:()=>_i(!0),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-red-500 via-red-600 to-rose-600 text-white text-sm font-bold rounded-xl hover:from-red-600 hover:via-red-700 hover:to-rose-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:scale-110 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),t.jsx("span",{className:"relative z-10",children:"Remove"})]}),t.jsxs("button",{onClick:o0,className:"group relative inline-flex items-center justify-center gap-2 px-5 py-3 bg-white border-2 border-gray-300 text-gray-700 text-sm font-bold rounded-xl hover:bg-gray-50 hover:border-gray-400 hover:text-gray-900 transition-all duration-300 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95",children:[t.jsx("svg",{className:"w-4 h-4 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})}),t.jsx("span",{children:"Clear"})]})]})]})]}),zo&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full mx-4 transform animate-fade-in-up",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Remove Prospects?"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"This action cannot be undone."})]})]}),t.jsxs("p",{className:"text-sm text-gray-700 mb-6",children:["Are you sure you want to remove ",t.jsx("span",{className:"font-bold text-gray-900",children:rr.size})," ",rr.size===1?"prospect":"prospects"," from this project? They will be removed from the project but will remain in the databank."]}),t.jsxs("div",{className:"flex items-center justify-end gap-3",children:[t.jsx("button",{onClick:()=>_i(!1),disabled:Ba,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{onClick:hr,disabled:Ba,className:"px-4 py-2 text-sm font-medium text-white bg-gradient-to-r from-red-500 to-red-600 rounded-lg hover:from-red-600 hover:to-red-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:Ba?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Removing..."]}):"Remove"})]})]})}),Yn.length>0?t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[jr>0&&t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-white flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",t.jsx("span",{className:"font-semibold",children:(ur-1)*fl+1})," to"," ",t.jsx("span",{className:"font-semibold",children:Math.min(ur*fl,jr)})," ","of ",t.jsx("span",{className:"font-semibold",children:jr.toLocaleString()})," contacts"]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>cn(ur-1),disabled:ur===1||w,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-colors",children:"Previous"}),(()=>{const K=[];let nt=Math.max(1,ur-Math.floor(2.5)),Ue=Math.min(di,nt+5-1);Ue-nt<4&&(nt=Math.max(1,Ue-5+1)),nt>1&&(K.push(t.jsx("button",{onClick:()=>cn(1),className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"1"},1)),nt>2&&K.push(t.jsx("span",{className:"px-2 text-gray-500",children:"..."},"ellipsis1")));for(let Xe=nt;Xe<=Ue;Xe++)K.push(t.jsx("button",{onClick:()=>cn(Xe),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${Xe===ur?"bg-blue-600 text-white border border-blue-600":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:Xe},Xe));return Ue<di&&(Ue<di-1&&K.push(t.jsx("span",{className:"px-2 text-gray-500",children:"..."},"ellipsis2")),K.push(t.jsx("button",{onClick:()=>cn(di),className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:di},di))),K})(),t.jsx("button",{onClick:()=>cn(ur+1),disabled:ur===di||w,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-colors",children:"Next"})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-fixed",children:[t.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-2.5 text-left text-[10px] font-semibold text-gray-700 uppercase tracking-wider w-12",children:t.jsx("input",{type:"checkbox",checked:Vo,onChange:Ri,className:"h-3.5 w-3.5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer",title:"Select all"})}),t.jsx("th",{className:"px-3 py-2.5 text-left text-[10px] font-semibold text-gray-700 uppercase tracking-wider w-12"}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[20%] cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>{Fi==="name"?ul(Dr==="asc"?"desc":"asc"):(Gl("name"),ul("asc"))},children:t.jsxs("div",{className:"flex items-center gap-1.5",children:["Contact",Fi==="name"?Dr==="asc"?t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):t.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]})}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[18%]",children:"Contact Info"}),t.jsxs("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[12%] relative",ref:Li,children:[t.jsxs("div",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 transition-colors rounded px-1 py-0.5 -mx-1 -my-0.5",onClick:()=>Mi(!hl),children:["Status",t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})})]}),hl&&t.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[200px] max-h-96 overflow-y-auto",children:t.jsxs("div",{className:"p-2",children:[t.jsx("button",{onClick:()=>{xe(""),Mi(!1)},className:`w-full text-left px-3 py-2 text-xs rounded hover:bg-gray-100 ${Ne?"text-gray-700":"bg-blue-50 text-blue-700 font-medium"}`,children:"All Statuses"}),["New","Interested","Not Interested","Details Shared","Demo Booked","Demo Completed","SQL","WON","Lost","CIP","No Reply","Meeting Proposed","Meeting Scheduled","Meeting Completed","Ring","Busy","Call Back","Hang Up","Switch Off","Invalid","Future","Existing","Bounce","Opt-Out"].map(K=>t.jsx("button",{onClick:()=>{xe(K),Mi(!1)},className:`w-full text-left px-3 py-2 text-xs rounded hover:bg-gray-100 ${Ne===K?"bg-blue-50 text-blue-700 font-medium":"text-gray-700"}`,children:K},K))]})})]}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[15%]",children:"Last Interaction"}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[18%]",children:"Next Action"}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[12%]",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Yn.map(K=>{const Ge=K._id||K.name,nt=st.has(Ge),Ue=Rt[Ge]||[],Xe=Js[Ge],ze=K._id?.toString?K._id.toString():K._id;let qe=null,Ke=null,Be=null;if(ze){const qt=ze.toString?ze.toString():String(ze);qe=Nr.lastActivityByContactId.get(qt)||null,Ke=Nr.nextActionByContactId.get(qt)||null,Be=Nr.latestActivityStatusByContactId.get(qt)||null}let Ot=Be?.status||null;if((!qe||!Ke||!Be)&&!ze){const qt=K.name?.toLowerCase()||"",Cs=K.email?.toLowerCase()||"";if(!qe&&(qt||Cs)&&(qe=ms.filter(_s=>{if(_s.contactId)return!1;const ws=_s.conversationNotes?.toLowerCase()||"";return ws.includes(qt)||ws.includes(Cs)}).sort((_s,ws)=>Bn(ws)-Bn(_s))[0]),!Ke&&(qt||Cs)){const _s=new Date;Ke=ms.filter(ws=>{if(!ws.nextActionDate||new Date(ws.nextActionDate)<_s||ws.contactId)return!1;const kt=ws.conversationNotes?.toLowerCase()||"";return kt.includes(qt)||kt.includes(Cs)}).sort((ws,kt)=>new Date(ws.nextActionDate)-new Date(kt.nextActionDate))[0]}if(!Be&&(qt||Cs)){const _s=ms.filter(ws=>{if(ws.contactId||!(ws.type==="call"&&ws.callStatus&&ws.callStatus.trim()!==""||ws.status&&ws.status.trim()!==""))return!1;const Oi=ws.conversationNotes?.toLowerCase()||"";return Oi.includes(qt)||Oi.includes(Cs)}).sort((ws,kt)=>Bn(kt)-Bn(ws));if(_s.length>0){const ws=_s[0];Ot=ws.type==="call"&&ws.callStatus?ws.callStatus:ws.status}}}const zt=Ot||K.stage||"New";K.assignedTo||s?.assignedTo;const Pt=ze&&(typeof ze=="string"&&ze.length===24||typeof K._id=="object"&&K._id!==null),ht=qt=>{if(!(qt.target.closest("button")||qt.target.closest("svg")||qt.target.closest("a"))&&Pt&&ze){const Cs=new URLSearchParams;L&&Cs.set("search",L),ae&&Cs.set("quickFilter",ae),Ne&&Cs.set("filterStatus",Ne),we&&Cs.set("filterActionDate",we),ce&&Cs.set("filterActionDateFrom",ce),Le&&Cs.set("filterActionDateTo",Le),oe&&Cs.set("filterLastInteraction",oe),ye&&Cs.set("filterLastInteractionFrom",ye),fe&&Cs.set("filterLastInteractionTo",fe),We&&Cs.set("filterImportDate",We),me&&Cs.set("filterImportDateFrom",me),pe&&Cs.set("filterImportDateTo",pe),Se&&Cs.set("filterNoActivity","true"),H&&Cs.set("filterMatchType",H),Cs.set("page",ur.toString());const _s=`/projects/${l}${Cs.toString()?"?"+Cs.toString():""}`;n(`/contacts/${ze}/activities?projectId=${l}&returnTo=${encodeURIComponent(_s)}`)}};return t.jsxs(Lo.Fragment,{children:[t.jsxs("tr",{onClick:ht,className:`transition-all duration-150 ${Pt?"hover:bg-blue-50 cursor-pointer":"hover:bg-gray-50"} ${nt?"bg-blue-50":""}`,children:[t.jsx("td",{className:"px-3 py-2.5",onClick:qt=>qt.stopPropagation(),children:t.jsx("input",{type:"checkbox",checked:rr.has(Ge.toString()),onChange:qt=>l0(Ge,qt.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"})}),t.jsx("td",{className:"px-3 py-2.5",children:t.jsx("button",{onClick:qt=>{qt.stopPropagation(),Uo(Ge,K.email,K.name)},className:"text-gray-400 hover:text-gray-600 transition-all",title:nt?"Collapse details":"Expand details",children:t.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${nt?"-rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}),t.jsx("td",{className:"px-4 py-2.5",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0 shadow-md",children:t.jsx("span",{className:"text-sm font-semibold text-white",children:gs(K.name)})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsx("div",{className:`text-sm font-semibold ${Pt?"text-gray-900 hover:text-blue-600":"text-gray-900"}`,children:K.name||"N/A"}),!K.isImported&&K.recommendationReasons&&K.recommendationReasons.length>0&&t.jsxs("div",{className:"group relative",children:[t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${K.matchType==="exact"?"bg-green-100 text-green-800":K.matchType==="good"?"bg-blue-100 text-blue-800":K.matchType==="similar"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),K.matchScore,"% Match"]}),t.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 p-4 z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 pointer-events-none",children:[t.jsx("div",{className:"absolute -top-2 left-4 w-4 h-4 bg-white border-l border-t border-gray-200 transform rotate-45"}),t.jsxs("div",{className:"relative",children:[t.jsxs("h4",{className:"text-xs font-bold text-gray-900 mb-2 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Recommended Based on ICP"]}),t.jsx("div",{className:"space-y-2",children:K.recommendationReasons.map((qt,Cs)=>t.jsxs("div",{className:"text-xs text-gray-700 bg-gray-50 rounded p-2 border-l-2 border-blue-500",children:[t.jsxs("div",{className:"font-semibold text-gray-900 mb-1 capitalize",children:[qt.type==="industry"&&" Industry Match",qt.type==="jobTitle"&&" Job Title Match",qt.type==="companySize"&&" Company Size Match",qt.type==="geography"&&" Location Match",qt.type==="keywords"&&" Keywords Match"]}),t.jsx("div",{className:"text-gray-600",children:qt.message})]},Cs))}),t.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200",children:t.jsxs("div",{className:"text-xs text-gray-500",children:[t.jsx("span",{className:"font-semibold",children:"Match Score:"})," ",K.matchScore,"% (",K.matchType,")"]})})]})]})]})]}),t.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:K.company||"N/A"})]})]})}),t.jsx("td",{className:"px-4 py-2.5",children:t.jsxs("div",{className:"space-y-0.5",children:[K.email?(()=>{const Cs=String(K.email).trim().split(/[,\s]+/).filter(ws=>ws.trim()),_s=Cs.length>=2;return t.jsxs("div",{className:"text-sm text-gray-900 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),_s?`${Cs[0]}....`:K.email]})})():t.jsx("div",{className:"text-xs text-gray-400",children:"No email"}),K.firstPhone?t.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),K.firstPhone]}):t.jsx("div",{className:"text-xs text-gray-400",children:"No phone"}),K.personLinkedinUrl||K.companyLinkedinUrl?t.jsxs("div",{className:"text-xs text-blue-600 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("a",{href:K.personLinkedinUrl||K.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"hover:underline truncate",onClick:qt=>qt.stopPropagation(),children:"LinkedIn"})]}):t.jsx("div",{className:"text-xs text-gray-400",children:"No LinkedIn"})]})}),t.jsx("td",{className:"px-4 py-2.5",children:An(zt)}),t.jsx("td",{className:"px-4 py-2.5",children:qe?t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-900 font-medium",children:dn(Bn(qe))}),t.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:qe.type==="call"?"Call":qe.type==="email"?"Email":qe.type==="linkedin"?"LinkedIn":"Activity"})]}):t.jsx("div",{className:"text-sm text-gray-400",children:"-"})}),t.jsx("td",{className:"px-4 py-2.5",children:Ke?t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("svg",{className:`w-4 h-4 flex-shrink-0 ${new Date(Ke.nextActionDate)<new Date?"text-red-600":new Date(Ke.nextActionDate)<=new Date(Date.now()+4320*60*1e3)?"text-orange-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ke.nextAction}),t.jsx("div",{className:`text-xs font-medium mt-0.5 ${new Date(Ke.nextActionDate)<new Date?"text-red-600":new Date(Ke.nextActionDate)<=new Date(Date.now()+4320*60*1e3)?"text-orange-600":"text-gray-500"}`,children:dn(Ke.nextActionDate)})]})]}):t.jsx("div",{className:"text-sm text-gray-400",children:"-"})}),t.jsx("td",{className:"px-4 py-2.5",children:t.jsxs("div",{className:"flex items-center gap-1.5",children:[$r.includes("call")&&t.jsx("button",{onClick:qt=>{qt.stopPropagation(),Mr("call",K)},className:"p-1.5 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Log Call",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),$r.includes("email")&&t.jsx("button",{onClick:qt=>{qt.stopPropagation(),Mr("email",K)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Log Email",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),$r.includes("linkedin")&&t.jsx("button",{onClick:qt=>{qt.stopPropagation(),Mr("linkedin",K)},className:"p-1.5 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Log LinkedIn",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})})]})})]}),nt&&t.jsx("tr",{className:"animate-fade-in",children:t.jsx("td",{colSpan:"7",className:"px-6 py-4 bg-blue-50 border-t-2 border-blue-200 transition-all duration-300",children:Xe?t.jsx("div",{className:"flex items-center justify-center py-8 animate-fade-in",children:t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Loading activities..."})]})}):t.jsx("div",{className:"animate-fade-in-up",children:t.jsx(Kl,{contact:K,activities:Ue})})})})]},Ge)})})]})})]}):t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-12",children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No prospects found"}),t.jsx("p",{className:"text-sm text-gray-600",children:"No similar contacts found for this project"})]})}),t.jsx(wv,{isOpen:ds.isOpen,onClose:qn,type:ds.type,contactName:ds.contactName,companyName:ds.companyName,projectId:ds.projectId,contactId:ds.contactId,phoneNumber:ds.phoneNumber,email:ds.email,linkedInProfileUrl:ds.linkedInProfileUrl,lastActivity:ds.lastActivity}),t.jsx(Qk,{isOpen:dt,onClose:()=>Tt(!1),projectId:l,onImportSuccess:()=>{ln?Sn():Na(1),hi()}}),t.jsx(Xk,{isOpen:_a.isOpen,onClose:Ka,type:_a.type,selectedContacts:rr,projectId:l,contacts:m}),ne.isOpen&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[ne.filter?.channel==="linkedin"&&"LinkedIn Pipeline",ne.filter?.channel==="call"&&"Cold Calling Pipeline",ne.filter?.channel==="email"&&"Email Pipeline"]}),t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[ne.filter?.metric==="connectionSent"&&"Connection Sent",ne.filter?.metric==="accepted"&&"Accepted",(ne.filter?.metric==="followUps"||ne.filter?.metric==="followups")&&"Follow-ups",ne.filter?.metric==="cip"&&"CIP",ne.filter?.metric==="meetingProposed"&&"Meeting Proposed",ne.filter?.metric==="scheduled"&&"Scheduled",ne.filter?.metric==="completed"&&"Completed",ne.filter?.metric==="sql"&&"SQL",ne.filter?.metric==="win"&&"Win",ne.filter?.metric==="connectionRequestsSent"&&"Connection Requests Sent",ne.filter?.metric==="connectionAcceptanceRate"&&"Connection Acceptance Rate",ne.filter?.metric==="messagesSent"&&"Messages Sent",ne.filter?.metric==="messageReplyRate"&&"Message Reply Rate",ne.filter?.metric==="allProspects"&&"All Prospects",ne.filter?.metric==="callsAttempted"&&"Calls Attempted",ne.filter?.metric==="totalCalls"&&"Total Calls",ne.filter?.metric==="callsConnected"&&"Calls Connected",ne.filter?.metric==="decisionMakerReached"&&"Decision Maker Reached",ne.filter?.metric==="interested"&&"Interested",ne.filter?.metric==="detailsShared"&&"Details Shared",ne.filter?.metric==="demoBooked"&&"Demo Booked",ne.filter?.metric==="demoCompleted"&&"Demo Completed",ne.filter?.metric==="sql"&&"SQL",ne.filter?.metric==="won"&&"WON",ne.filter?.metric==="callsMade"&&"Calls Made",ne.filter?.metric==="callAnswerRate"&&"Call Answer Rate",ne.filter?.metric==="callInterestedRate"&&"Call Interested Rate",ne.filter?.metric==="emailsSent"&&"Emails Sent",ne.filter?.metric==="accepted"&&"Accepted",ne.filter?.metric==="followups"&&"Follow-ups",ne.filter?.metric==="cip"&&"CIP",ne.filter?.metric==="meetingProposed"&&"Meeting Proposed",ne.filter?.metric==="scheduled"&&"Scheduled",ne.filter?.metric==="completed"&&"Completed",ne.filter?.metric==="sql"&&"SQL",ne.filter?.metric==="emailBounce"&&"Email Bounce",ne.filter?.metric==="emailOpenRate"&&"Email Open Rate",ne.filter?.metric==="emailReplyRate"&&"Email Reply Rate",ne.filter?.metric==="meetingsBooked"&&"Meetings Booked"]}),!Qc&&ne.filter&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing all ",Ho(ne.filter).length," prospects"]})]}),t.jsx("button",{onClick:vt,className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:Qc?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsx("p",{className:"text-sm font-medium",children:"Loading prospects..."})]}):(()=>{const K=Ho(ne.filter);return K.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm font-medium",children:"No prospects found for this metric"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"CONTACT"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"COMPANY"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"DATE"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"STATUS"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map(Ge=>{const nt=(Ge._id?.toString?Ge._id.toString():Ge._id)||"",Ue=nt?Nr.lastActivityByContactId.get(nt):null,ze=(nt?Nr.latestActivityStatusByContactId.get(nt):null)?.status||Ge.stage||"New",qe=Ue?Bn(Ue):null,Ke=qe?qe.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",Be=nt&&(typeof nt=="string"&&nt.length===24||typeof Ge._id=="object"&&Ge._id!==null),Ot=zt=>{if(!(zt.target.closest("button")||zt.target.closest("svg")||zt.target.closest("a"))&&Be&&nt){const Pt=new URLSearchParams;Pt.set("page",ur.toString());const ht=`/projects/${l}${Pt.toString()?"?"+Pt.toString():""}`;n(`/contacts/${nt}/activities?projectId=${l}&returnTo=${encodeURIComponent(ht)}`)}};return t.jsxs("tr",{onClick:Ot,className:`transition-colors ${Be?"hover:bg-blue-50 cursor-pointer":"hover:bg-gray-50"}`,children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:Ge.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:Ge.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:Ke}),t.jsx("td",{className:"px-4 py-3 text-sm",children:t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded-full border border-green-200",children:ze})})]},Ge._id||Ge.name)})})]})})})()})]})})]})}const e7=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Line}))),Ab=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Bar}))),t7=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Doughnut}))),s7=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Pie})));cl.register(Wc,$c,Bc,dl,zc,bm,Hc,Vc,Uc);function r7(){const l=Fr(),[n,a]=B.useState(null),[o,s]=B.useState(!0),[e,m]=B.useState("overview"),[v,w]=B.useState("30d");B.useEffect(()=>{N()},[v]);const N=async()=>{try{s(!0);const M=await Ht.get("/projects/analytics");M.data.success&&a(M.data.data)}catch(M){console.error("Error fetching project analytics:",M)}finally{s(!1)}},S=[{id:"overview",label:"Overview",icon:"grid"},{id:"pipeline",label:"Pipeline",icon:"funnel"},{id:"channels",label:"Channels",icon:"megaphone"},{id:"team",label:"Team Performance",icon:"users"}],D=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(o)return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((M,F)=>t.jsx(D,{},F))}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[...Array(4)].map((M,F)=>t.jsx(D,{},F))})]})});if(!n)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data"}),t.jsx("button",{onClick:N,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})});const L=({title:M,value:F,subtitle:O,icon:P,trend:G,trendDirection:ae,color:re="blue"})=>{const Ne={blue:{bg:"from-blue-50 to-indigo-50",border:"border-blue-100",icon:"text-indigo-600",badge:"text-blue-700 bg-white/70 border-blue-100"},green:{bg:"from-emerald-50 to-teal-50",border:"border-emerald-100",icon:"text-emerald-600",badge:"text-emerald-700 bg-white/70 border-emerald-100"},purple:{bg:"from-purple-50 to-indigo-50",border:"border-purple-100",icon:"text-purple-600",badge:"text-purple-700 bg-white/70 border-purple-100"},orange:{bg:"from-amber-50 to-orange-50",border:"border-amber-100",icon:"text-amber-600",badge:"text-amber-700 bg-white/70 border-amber-100"}},xe=Ne[re]||Ne.blue;return t.jsxs("div",{className:`bg-gradient-to-br ${xe.bg} rounded-xl border ${xe.border} shadow-sm p-6 hover:shadow-md transition-shadow`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:`w-12 h-12 rounded-lg bg-white/80 border ${xe.border} flex items-center justify-center shadow-xs`,children:P}),G&&t.jsxs("span",{className:`text-xs font-semibold ${xe.badge} px-2 py-1 rounded-full shadow-xs flex items-center gap-1`,children:[ae==="up"?"":""," ",G]})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:F}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:M}),O&&t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:O})]})};return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>l("/projects"),className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors",title:"Back to Projects",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Project Analytics Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Comprehensive insights into your lead generation campaigns"})]})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs("select",{value:v,onChange:M=>w(M.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"7d",children:"Last 7 days"}),t.jsx("option",{value:"30d",children:"Last 30 days"}),t.jsx("option",{value:"90d",children:"Last 90 days"})]})})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:S.map(M=>t.jsx("button",{onClick:()=>m(M.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${e===M.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:M.label},M.id))})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(L,{title:"Total Projects",value:n.overview.totalProjects,icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),color:"blue"}),t.jsx(L,{title:"Win Rate",value:`${n.pipeline.conversion.winRate}%`,subtitle:`${n.pipeline.conversion.won} won / ${n.pipeline.conversion.total} total`,icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green"}),t.jsx(L,{title:"Meeting Rate",value:`${n.pipeline.conversion.meetingRate}%`,subtitle:`${n.pipeline.conversion.meetings} meetings scheduled`,icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),color:"blue"}),t.jsx(L,{title:"SQL Count",value:n.pipeline.conversion.sql||0,subtitle:"Sales Qualified Leads",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),color:"purple"}),t.jsx(L,{title:"Avg Activities/Prospect",value:n.overview.totalProspects>0?(n.overview.totalActivities/n.overview.totalProspects).toFixed(1):"0",subtitle:"Average engagement",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"orange"}),t.jsx(L,{title:"Total Prospects",value:n.overview.totalProspects.toLocaleString(),subtitle:"Across all projects",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),color:"purple"}),t.jsx(L,{title:"Total Activities",value:n.overview.totalActivities.toLocaleString(),subtitle:"Calls, emails & LinkedIn",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"orange"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Trends (Last 7 Days)"}),n.activities.trends.labels.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(e7,{data:{labels:n.activities.trends.labels,datasets:[{label:"Calls",data:n.activities.trends.call,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4},{label:"Emails",data:n.activities.trends.email,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4},{label:"LinkedIn",data:n.activities.trends.linkedin,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Distribution"}),n.activities.byType.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(t7,{data:{labels:n.activities.byType.map(M=>M.type.charAt(0).toUpperCase()+M.type.slice(1)),datasets:[{data:n.activities.byType.map(M=>M.count),backgroundColor:["rgb(34, 197, 94)","rgb(59, 130, 246)","rgb(168, 85, 247)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Project Growth"}),n.growth.monthly.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Ab,{data:{labels:n.growth.monthly.map(M=>M.month),datasets:[{label:"Projects Created",data:n.growth.monthly.map(M=>M.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No growth data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conversion Metrics"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Win Rate"}),t.jsxs("span",{className:"text-lg font-bold text-green-600",children:[n.pipeline.conversion.winRate,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:"bg-green-500 h-3 rounded-full",style:{width:`${n.pipeline.conversion.winRate}%`}})}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n.pipeline.conversion.won," won / ",n.pipeline.conversion.total," total"]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Meeting Rate"}),t.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[n.pipeline.conversion.meetingRate,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:"bg-blue-500 h-3 rounded-full",style:{width:`${n.pipeline.conversion.meetingRate}%`}})}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n.pipeline.conversion.meetings," meetings scheduled"]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.pipeline.conversion.sql}),t.jsx("div",{className:"text-xs text-gray-500",children:"SQL"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.pipeline.conversion.cip}),t.jsx("div",{className:"text-xs text-gray-500",children:"CIP"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:n.pipeline.conversion.lost}),t.jsx("div",{className:"text-xs text-gray-500",children:"Lost"})]})]})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performing Projects"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Project"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Prospects"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Activities"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Won"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Meetings"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:n.projects.topPerformers.slice(0,5).map(M=>t.jsxs("tr",{onClick:()=>l(`/projects/${M.id}`),className:"hover:bg-gray-50 cursor-pointer",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:M.companyName}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.contactCount}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.activityCount}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:M.wonCount}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.meetingCount})]},M.id))})]})})]})]}),e==="pipeline"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pipeline Stage Distribution"}),n.pipeline.stageDistribution.length>0?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Ab,{data:{labels:n.pipeline.stageDistribution.map(M=>M.stage),datasets:[{label:"Prospects",data:n.pipeline.stageDistribution.map(M=>M.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No pipeline data available"})})]})}),e==="channels"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Channel Usage"}),t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(s7,{data:{labels:["LinkedIn","Email","Cold Calling"],datasets:[{data:[n.channels.linkedIn,n.channels.email,n.channels.calling],backgroundColor:["rgb(168, 85, 247)","rgb(59, 130, 246)","rgb(34, 197, 94)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Channel Statistics"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600",children:"LinkedIn Outreach"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.channels.linkedIn}),t.jsx("div",{className:"text-xs text-gray-500",children:"Projects using this channel"})]}),t.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})})]}),t.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Cold Email"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.channels.email}),t.jsx("div",{className:"text-xs text-gray-500",children:"Projects using this channel"})]}),t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),t.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Cold Calling"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.channels.calling}),t.jsx("div",{className:"text-xs text-gray-500",children:"Projects using this channel"})]}),t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]})]})]})]})}),e==="team"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Team Performance"}),n.team.performance.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Team Member"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Activities"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Calls"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Emails"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"LinkedIn"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:n.team.performance.map(M=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:M.name||"Unknown"}),t.jsx("div",{className:"text-xs text-gray-500",children:M.email})]}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-semibold",children:M.totalActivities}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.calls}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.emails}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.linkedin})]},M.id))})]})}):t.jsx("div",{className:"text-center py-12 text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No team performance data available"})})]})})]})]})}const a7=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Line}))),Wu=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Bar}))),ap=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Doughnut}))),n7=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Pie})));cl.register(Wc,$c,Bc,dl,zc,bm,Hc,Vc,Uc);const Eb={},Db={},Tb={},i7=60*1e3,M1=(l,n)=>{const a=l[n];return a?Date.now()-a.timestamp>i7?(delete l[n],null):a.data:null},L1=(l,n,a)=>{l[n]={data:a,timestamp:Date.now()}},l7=l=>l.type==="call"&&l.callDate?new Date(l.callDate):l.type==="email"&&l.emailDate?new Date(l.emailDate):l.type==="linkedin"&&l.linkedinDate?new Date(l.linkedinDate):new Date(l.createdAt);function o7(){const l=Fr(),[n,a]=n0(),[o,s]=B.useState(null),[e,m]=B.useState(!0),[v,w]=B.useState("overview"),[N,S]=B.useState([]),[D,L]=B.useState(n.get("projectId")||""),[M,F]=B.useState(null),[O,P]=B.useState([]),[G,ae]=B.useState(!1),[re,Ne]=B.useState(null),[xe,we]=B.useState("today"),[Z,ce]=B.useState(null),[ue,Le]=B.useState(!1),[be,oe]=B.useState([]),[he,ye]=B.useState(!1);B.useEffect(()=>(M?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[M]),B.useEffect(()=>{fe()},[]),B.useEffect(()=>{_e()},[D]),B.useEffect(()=>{We()},[D,xe]),B.useEffect(()=>{Te()},[D]);const Te=async()=>{try{const H=D||"all",Q=M1(Tb,H);Q?(oe(Q),ye(!1)):ye(!0);const te=D?{projectId:D}:{},de=await Ht.get("/projects/team-member-funnels",{params:te});if(de.data.success){const ve=de.data.data||[];oe(ve),L1(Tb,H,ve)}}catch(H){console.error("Error fetching team member funnels:",H),oe([])}finally{ye(!1)}},fe=async()=>{try{const H=await Ht.get("/projects");H.data.success&&S(H.data.data||[])}catch(H){console.error("Error fetching projects:",H)}},_e=async()=>{try{const H=D||"all",Q=M1(Eb,H);Q?(s(Q),m(!1)):m(!0);const te=D?{projectId:D}:{},de=await Ht.get("/projects/prospect-analytics",{params:te});if(de.data.success){const ve=de.data.data;s(ve),L1(Eb,H,ve)}}catch(H){console.error("Error fetching prospect analytics:",H)}finally{m(!1)}},We=async()=>{try{const H=`${D||"all"}:${xe}`,Q=M1(Db,H);Q?(ce(Q),Le(!1)):Le(!0);const te={timeFilter:xe};D&&(te.projectId=D);const de=await Ht.get("/activities/team-performance",{params:te});if(de.data.success){const ve=de.data.data;ce(ve),L1(Db,H,ve)}}catch(H){console.error("Error fetching team activity data:",H),ce(null)}finally{Le(!1)}},se=H=>{L(H),a(H?{projectId:H}:{})},me=async(H,Q,te,de=null)=>{try{if(ae(!0),F({stage:H,funnelType:Q,funnelData:te,memberId:de}),H==="prospectData"){if(!D){Ne({type:"info",message:"Please select a project to view prospects"}),ae(!1);return}const[ke,ne]=await Promise.all([Ht.get(`/projects/${D}/project-contacts?limit=100`),Ht.get(`/activities/project/${D}?limit=5000`)]);if(ke.data.success){let De=ke.data.data||[],He=ne.data.success?ne.data.data||[]:[];if(de){const Pe=de.toString?de.toString():String(de);He=He.filter(st=>st.createdBy?(st.createdBy?.toString?st.createdBy.toString():st.createdBy?._id?st.createdBy._id.toString():String(st.createdBy))===Pe:!1);const Nt=new Set(He.map(st=>st.contactId?.toString?st.contactId.toString():String(st.contactId)).filter(Boolean));De=De.filter(st=>{const Xt=st._id?.toString?st._id.toString():String(st._id);return Nt.has(Xt)})}const vt=new Map;He.forEach(Pe=>{if(Pe.contactId&&Pe.status&&Pe.status.trim()!==""){const Nt=Pe.contactId.toString?Pe.contactId.toString():String(Pe.contactId),st=l7(Pe),Xt=vt.get(Nt);(!Xt||st>Xt.activityDate)&&vt.set(Nt,{status:Pe.status,activityDate:st})}}),P(De.map(Pe=>{const Nt=Pe._id?.toString?Pe._id.toString():String(Pe._id),Xt=vt.get(Nt)?.status||Pe.stage||"New";return{...Pe,isProspect:!0,displayStatus:Xt}}))}ae(!1);return}if(!D){Ne({type:"info",message:"Please select a project to view stage details"}),ae(!1);return}const ve=await Ht.get(`/activities/project/${D}`);if(ve.data.success){let ke=ve.data.data||[];if(de){const Pe=de.toString?de.toString():String(de);ke=ke.filter(Nt=>Nt.createdBy?(Nt.createdBy?.toString?Nt.createdBy.toString():Nt.createdBy?._id?Nt.createdBy._id.toString():String(Nt.createdBy))===Pe:!1)}let ne=[];if(Q==="call")switch(H){case"callsAttempted":case"callSent":ne=ke.filter(Rt=>Rt.type==="call"&&Rt.callDate);break;case"callsConnected":case"accepted":const Pe=["Interested","Not Interested","Call Back","Future","Details Shared","Demo Booked","Demo Completed","Existing"];ne=ke.filter(Rt=>Rt.type==="call"&&Rt.callStatus&&Pe.includes(Rt.callStatus));break;case"decisionMakerReached":const Nt=["Interested","Details Shared","Demo Booked","Demo Completed"];ne=ke.filter(Rt=>Rt.type==="call"&&Rt.callStatus&&Nt.includes(Rt.callStatus));break;case"interested":ne=ke.filter(Rt=>Rt.type==="call"&&Rt.callStatus==="Interested");break;case"detailsShared":ne=ke.filter(Rt=>Rt.type==="call"&&Rt.callStatus==="Details Shared");break;case"demoBooked":case"scheduled":ne=ke.filter(Rt=>Rt.type==="call"&&Rt.callStatus==="Demo Booked");break;case"demoCompleted":case"completed":ne=ke.filter(Rt=>Rt.type==="call"&&Rt.callStatus==="Demo Completed");break;case"sql":ne=ke.filter(Rt=>Rt.type==="call"&&(Rt.callStatus==="Demo Completed"||Rt.callStatus==="Interested"&&Rt.conversationNotes&&Rt.conversationNotes.length>50||Rt.status==="SQL"));break;case"followups":const st={};ke.filter(Rt=>Rt.type==="call"&&Rt.callDate).forEach(Rt=>{const Ns=Rt.contactId?.toString();Ns&&(st[Ns]=(st[Ns]||0)+1)});const Xt=Object.keys(st).filter(Rt=>st[Rt]>1);ne=ke.filter(Rt=>Rt.type==="call"&&Xt.includes(Rt.contactId?.toString()));break;case"cip":ne=ke.filter(Rt=>Rt.type==="call"&&["Interested","Call Back","Future"].includes(Rt.callStatus));break;case"meetingProposed":ne=ke.filter(Rt=>Rt.type==="call"&&Rt.nextAction&&(Rt.nextAction.toLowerCase().includes("meeting")||Rt.nextAction.toLowerCase().includes("demo")||Rt.nextAction.toLowerCase().includes("call")));break}else if(Q==="email")switch(H){case"emailSent":ne=ke.filter(st=>st.type==="email"&&st.emailDate);break;case"accepted":ne=ke.filter(st=>st.type==="email"&&["Interested","Meeting Proposed","Meeting Scheduled"].includes(st.status));break;case"followups":const Pe={};ke.filter(st=>st.type==="email"&&st.emailDate).forEach(st=>{const Xt=st.contactId?.toString();Xt&&(Pe[Xt]=(Pe[Xt]||0)+1)});const Nt=Object.keys(Pe).filter(st=>Pe[st]>1);ne=ke.filter(st=>st.type==="email"&&Nt.includes(st.contactId?.toString()));break;case"cip":ne=ke.filter(st=>st.type==="email"&&st.status==="CIP");break;case"meetingProposed":ne=ke.filter(st=>st.type==="email"&&st.status==="Meeting Proposed");break;case"scheduled":ne=ke.filter(st=>st.type==="email"&&st.status==="Meeting Scheduled");break;case"completed":ne=ke.filter(st=>st.type==="email"&&st.status==="Meeting Completed");break;case"sql":ne=ke.filter(st=>st.type==="email"&&["SQL","Meeting Completed"].includes(st.status));break}else if(Q==="linkedin")switch(H){case"connectionSent":ne=ke.filter(st=>st.type==="linkedin"&&(st.lnRequestSent==="Yes"||st.lnRequestSent===!0));break;case"accepted":ne=ke.filter(st=>st.type==="linkedin"&&(st.connected==="Yes"||st.connected===!0));break;case"followups":const Pe={};ke.filter(st=>st.type==="linkedin").forEach(st=>{const Xt=st.contactId?.toString();Xt&&(Pe[Xt]=(Pe[Xt]||0)+1)});const Nt=Object.keys(Pe).filter(st=>Pe[st]>1);ne=ke.filter(st=>st.type==="linkedin"&&Nt.includes(st.contactId?.toString()));break;case"cip":ne=ke.filter(st=>st.type==="linkedin"&&st.status==="CIP");break;case"meetingProposed":ne=ke.filter(st=>st.type==="linkedin"&&st.status==="Meeting Proposed");break;case"scheduled":ne=ke.filter(st=>st.type==="linkedin"&&st.status==="Meeting Scheduled");break;case"completed":ne=ke.filter(st=>st.type==="linkedin"&&st.status==="Meeting Completed");break;case"sql":ne=ke.filter(st=>st.type==="linkedin"&&["SQL","Meeting Completed"].includes(st.status));break}const De=[...new Set(ne.map(Pe=>Pe.contactId).filter(Boolean))],He=new Map;De.length>0&&(await Promise.all(De.slice(0,100).map(Nt=>Ht.get(`/contacts/${Nt}`).catch(()=>null)))).forEach((Nt,st)=>{Nt?.data?.success&&He.set(De[st],Nt.data.data)});const vt=ne.map(Pe=>({...Pe,contact:He.get(Pe.contactId?.toString())||null}));P(vt)}}catch(ve){console.error("Error fetching stage data:",ve),P([])}finally{ae(!1)}},W=B.useMemo(()=>{if(!D)return["call","email","linkedin"];const H=N.find(te=>te._id===D);if(!H?.channels)return["call","email","linkedin"];const Q=[];return H.channels.coldCalling&&Q.push("call"),H.channels.coldEmail&&Q.push("email"),H.channels.linkedInOutreach&&Q.push("linkedin"),Q.length>0?Q:["call","email","linkedin"]},[D,N]),pe=B.useMemo(()=>[{id:"overview",label:"Overview"},{id:"pipeline",label:"Pipeline"},{id:"linkedin",label:"LinkedIn"},{id:"calls",label:"Cold Calls"},{id:"email",label:"Email"},{id:"team",label:"Team Performance"}].filter(Q=>["overview","pipeline","team"].includes(Q.id)?!0:Q.id==="linkedin"?W.includes("linkedin"):Q.id==="calls"?W.includes("call"):Q.id==="email"?W.includes("email"):!0),[W]);B.useEffect(()=>{const H=pe.map(Q=>Q.id);H.includes(v)||w(H[0]||"overview")},[pe,v]);const Me=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(e)return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((H,Q)=>t.jsx(Me,{},Q))})})});if(!o)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-600",children:"Having trouble loading the dashboard. Refresh the page."}),t.jsx("button",{onClick:_e,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})});const Se=({title:H,value:Q,subtitle:te,icon:de,color:ve="blue",compact:ke=!1})=>{const ne={blue:{bg:"from-blue-50 to-indigo-50",border:"border-blue-100",icon:"text-indigo-600",badge:"text-blue-700 bg-white/70 border-blue-100"},green:{bg:"from-emerald-50 to-teal-50",border:"border-emerald-100",icon:"text-emerald-600",badge:"text-emerald-700 bg-white/70 border-emerald-100"},purple:{bg:"from-purple-50 to-indigo-50",border:"border-purple-100",icon:"text-purple-600",badge:"text-purple-700 bg-white/70 border-purple-100"},orange:{bg:"from-amber-50 to-orange-50",border:"border-amber-100",icon:"text-amber-600",badge:"text-amber-700 bg-white/70 border-amber-100"}},De=ne[ve]||ne.blue;return ke?t.jsxs("div",{className:`bg-gradient-to-br ${De.bg} rounded-lg border ${De.border} shadow-sm p-4 hover:shadow-md transition-shadow h-full`,children:[t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsx("div",{className:`w-8 h-8 rounded-lg bg-white/80 border ${De.border} flex items-center justify-center shadow-xs`,children:typeof de=="object"&&de.props?Lo.cloneElement(de,{className:"w-4 h-4"}):de})}),t.jsx("div",{className:"text-xl font-bold text-gray-900 leading-tight mb-1",children:Q}),t.jsx("div",{className:"text-xs font-medium text-gray-700",children:H}),te&&t.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:te})]}):t.jsxs("div",{className:`bg-gradient-to-br ${De.bg} rounded-xl border ${De.border} shadow-sm p-6 hover:shadow-md transition-shadow`,children:[t.jsx("div",{className:"flex items-center justify-between mb-3",children:t.jsx("div",{className:`w-12 h-12 rounded-lg bg-white/80 border ${De.border} flex items-center justify-center shadow-xs`,children:de})}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Q}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:H}),te&&t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:te})]})},V=({title:H,data:Q,color:te="blue",funnelType:de="call",totalProspects:ve=null,memberId:ke=null})=>{let ne=[];Q.prospectData===void 0&&ve!==null&&(Q={...Q,prospectData:ve}),Q.callsAttempted!==void 0||Q.callSent!==void 0?(ne=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"callsAttempted",label:"Calls Attempted",clickable:!0},{key:"callsConnected",label:"Calls Connected",clickable:!0},{key:"decisionMakerReached",label:"Decision Maker Reached",clickable:!0},{key:"interested",label:"Interested",clickable:!0},{key:"detailsShared",label:"Details Shared",clickable:!0},{key:"demoBooked",label:"Demo Booked",clickable:!0},{key:"demoCompleted",label:"Demo Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}],Q.callSent!==void 0&&Q.callsAttempted===void 0&&(ne=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"callSent",label:"Call Sent",clickable:!0},{key:"accepted",label:"Accepted",clickable:!0},{key:"followups",label:"Followups",clickable:!0},{key:"cip",label:"CIP",clickable:!0},{key:"meetingProposed",label:"Meeting Proposed",clickable:!0},{key:"scheduled",label:"Scheduled",clickable:!0},{key:"completed",label:"Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}])):Q.emailSent!==void 0?ne=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"emailSent",label:"Email Sent",clickable:!0},{key:"accepted",label:"Accepted",clickable:!0},{key:"followups",label:"Followups",clickable:!0},{key:"cip",label:"CIP",clickable:!0},{key:"meetingProposed",label:"Meeting Proposed",clickable:!0},{key:"scheduled",label:"Scheduled",clickable:!0},{key:"completed",label:"Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}]:Q.connectionSent!==void 0&&(ne=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"connectionSent",label:"Connection Sent",clickable:!0},{key:"accepted",label:"Accepted",clickable:!0},{key:"followups",label:"Followups",clickable:!0},{key:"cip",label:"CIP",clickable:!0},{key:"meetingProposed",label:"Meeting Proposed",clickable:!0},{key:"scheduled",label:"Scheduled",clickable:!0},{key:"completed",label:"Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}]),ne=ne.filter(st=>st.key);const De=Q.prospectData||(Q.prospectData===0?0:1),He={blue:{primary:"rgb(59, 130, 246)",light:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 0.3)",hover:"rgba(59, 130, 246, 0.2)"},green:{primary:"rgb(34, 197, 94)",light:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",hover:"rgba(34, 197, 94, 0.2)"},purple:{primary:"rgb(168, 85, 247)",light:"rgba(168, 85, 247, 0.1)",border:"rgba(168, 85, 247, 0.3)",hover:"rgba(168, 85, 247, 0.2)"}},vt=He[te]||He.blue,Pe=(st,Xt)=>st===0?100:Math.max(15,100-st*10),Nt=st=>{if(st.key==="prospectData"){me(st.key,de,Q,ke);return}st.clickable&&(Q[st.key]||0)>0?me(st.key,de,Q,ke):st.clickable&&(Ne({type:"info",message:`No records found for ${st.label} stage`}),setTimeout(()=>Ne(null),3e3))};return t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow h-full",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4 text-center",children:H}),t.jsx("div",{className:"flex flex-col items-center space-y-0",children:ne.map((st,Xt)=>{const Rt=st.key==="prospectData"?Q[st.key]!==void 0?Q[st.key]:De:Q[st.key]||0,Ns=De>0?(Rt/De*100).toFixed(1):0,Js=Pe(Xt,ne.length),ps=De>0?Rt/De*Js:0,ds=st.clickable;return t.jsxs("div",{className:"relative w-full flex flex-col items-center",children:[t.jsxs("div",{onClick:()=>Nt(st),className:`relative transition-all duration-300 ${ds?"cursor-pointer hover:scale-[1.03] group":"cursor-default"}`,style:{width:`${Js}%`,minHeight:"28px",display:"flex",alignItems:"center",justifyContent:"center"},title:ds?Rt>0?`Click to view ${Rt} ${st.label.toLowerCase()} records`:`Click to view ${st.label.toLowerCase()}`:"",children:[t.jsx("div",{className:`absolute inset-0 transition-all duration-300 ${ds?"group-hover:brightness-110 group-hover:shadow-md":""}`,style:{clipPath:Xt===0?"polygon(0 0, 100% 0, 95% 100%, 5% 100%)":Xt===ne.length-1?"polygon(15% 0, 85% 0, 100% 100%, 0 100%)":"polygon(8% 0, 92% 0, 96% 100%, 4% 100%)",backgroundColor:vt.light,border:`2px solid ${vt.border}`,borderBottom:Xt<ne.length-1?"none":`2px solid ${vt.border}`}}),ps>0&&t.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 transition-all duration-500",style:{width:`${Math.max(20,ps/Js*100)}%`,height:"100%",backgroundColor:vt.primary,clipPath:Xt===0?"polygon(0 0, 100% 0, 95% 100%, 5% 100%)":Xt===ne.length-1?"polygon(15% 0, 85% 0, 100% 100%, 0 100%)":"polygon(8% 0, 92% 0, 96% 100%, 4% 100%)",opacity:.85}}),t.jsxs("div",{className:"relative z-10 w-full px-2 py-1 text-center",children:[t.jsxs("div",{className:`text-xs font-bold mb-0.5 ${ds?"text-gray-800":"text-gray-600"}`,children:[st.label,ds&&t.jsxs("svg",{className:"w-2.5 h-2.5 inline-block ml-1 opacity-70",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})]}),t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx("span",{className:"text-xs font-bold text-gray-900",children:Rt.toLocaleString()}),t.jsxs("span",{className:"text-xs text-gray-500",children:["(",Ns,"%)"]})]})]})]}),Xt<ne.length-1&&t.jsx("div",{className:"w-0.5",style:{height:"4px",backgroundColor:vt.primary,opacity:.3}})]},st.key)})}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-600 mb-1 text-xs font-medium",children:"Conversion"}),t.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[De>0?(Q.sql/De*100).toFixed(1):0,"%"]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-600 mb-1 text-xs font-medium",children:"Meetings"}),t.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[De>0?(Q.scheduled/De*100).toFixed(1):0,"%"]})]})]})})]})};return t.jsxs("div",{className:"min-h-screen bg-gray-50 relative",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-20 shadow-sm backdrop-blur-sm bg-white/95",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>{if(D||o?.project?.id){const H=D||o.project.id;l(`/projects/${H}`)}else l("/projects")},className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors",title:D||o?.project?.id?"Back to Prospect Management":"Back to Projects",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Prospect Analytics Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.project?`Analytics for ${o.project.companyName}`:"Comprehensive insights across all projects"})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("select",{value:D,onChange:H=>se(H.target.value),className:"px-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white min-w-[200px]",children:[t.jsx("option",{value:"",children:"All Projects"}),N.map(H=>t.jsx("option",{value:H._id,children:H.companyName},H._id))]}),o.project&&t.jsx("button",{onClick:()=>l(`/projects/${o.project.id}`),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"View Project"})]})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:pe.map(H=>t.jsx("button",{onClick:()=>w(H.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${v===H.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:H.label},H.id))})]})}),re&&t.jsx("div",{className:"fixed top-20 right-4 z-50",style:{animation:"slideInRight 0.3s ease-out"},children:t.jsx("div",{className:`px-4 py-3 rounded-lg shadow-xl border-2 ${re.type==="info"?"bg-blue-50 border-blue-200 text-blue-800":re.type==="error"?"bg-red-50 border-red-200 text-red-800":"bg-green-50 border-green-200 text-green-800"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[re.type==="info"&&t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"text-sm font-medium",children:re.message}),t.jsx("button",{onClick:()=>Ne(null),className:"ml-2 text-current opacity-70 hover:opacity-100 transition-opacity",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}),t.jsx("style",{children:`
        @keyframes slideInRight {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
      `}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 relative z-0",children:[v==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:[t.jsx(Se,{title:"Total Prospects",value:o.overview.totalProspects.toLocaleString(),icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),color:"blue",compact:!0}),t.jsx(Se,{title:"Total Activities",value:o.overview.totalActivities.toLocaleString(),subtitle:"Calls, emails & LinkedIn",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"green",compact:!0}),t.jsx(Se,{title:"Win Rate",value:`${o.pipeline.conversion.winRate}%`,subtitle:`${o.pipeline.conversion.won} won`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"purple",compact:!0}),t.jsx(Se,{title:"Meeting Rate",value:`${o.pipeline.conversion.meetingRate}%`,subtitle:`${o.pipeline.conversion.meetings} meetings`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),color:"orange",compact:!0}),t.jsx(Se,{title:"SQL Rate",value:o.overview.totalProspects>0?`${(o.pipeline.conversion.sql/o.overview.totalProspects*100).toFixed(1)}%`:"0%",subtitle:`${o.pipeline.conversion.sql} SQL leads`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),color:"blue",compact:!0}),t.jsx(Se,{title:"CIP Rate",value:o.overview.totalProspects>0?`${(o.pipeline.conversion.cip/o.overview.totalProspects*100).toFixed(1)}%`:"0%",subtitle:`${o.pipeline.conversion.cip} CIP prospects`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),color:"green",compact:!0}),t.jsx(Se,{title:"Avg Activities/Prospect",value:o.overview.totalProspects>0?(o.overview.totalActivities/o.overview.totalProspects).toFixed(1):"0",subtitle:"Average engagement",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"purple",compact:!0}),t.jsx(Se,{title:"Lost Deals",value:o.pipeline.conversion.lost||0,subtitle:"Deals lost",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),color:"orange",compact:!0})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Funnel Analytics"}),t.jsx("div",{className:`${W.length===1?"flex justify-center":W.length===2?"flex justify-center gap-6":"overflow-x-auto"}`,children:t.jsxs("div",{className:`${W.length===1?"w-80":W.length===2?"flex gap-6":"flex gap-6 min-w-max pb-2"}`,children:[W.includes("call")&&t.jsx("div",{className:`${W.length===1||W.length===2?"w-80":"flex-shrink-0 w-80"}`,children:t.jsx(V,{title:"Cold Calling Funnel",data:o.funnels.coldCalling,color:"green",funnelType:"call",totalProspects:o.overview?.totalProspects})}),W.includes("email")&&t.jsx("div",{className:`${W.length===1||W.length===2?"w-80":"flex-shrink-0 w-80"}`,children:t.jsx(V,{title:"Email Funnel",data:o.funnels.email,color:"blue",funnelType:"email",totalProspects:o.overview?.totalProspects})}),W.includes("linkedin")&&t.jsx("div",{className:`${W.length===1||W.length===2?"w-80":"flex-shrink-0 w-80"}`,children:t.jsx(V,{title:"LinkedIn Funnel",data:o.funnels.linkedin,color:"purple",funnelType:"linkedin",totalProspects:o.overview?.totalProspects})})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Trends (Last 7 Days)"}),o.activities.trends.labels.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(a7,{data:{labels:o.activities.trends.labels,datasets:[...W.includes("call")?[{label:"Calls",data:o.activities.trends.call,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4}]:[],...W.includes("email")?[{label:"Emails",data:o.activities.trends.email,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4}]:[],...W.includes("linkedin")?[{label:"LinkedIn",data:o.activities.trends.linkedin,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4}]:[]]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Distribution"}),o.activities.byType.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(ap,{data:{labels:o.activities.byType.filter(H=>{const Q=H.type.toLowerCase();return Q==="call"&&W.includes("call")||Q==="email"&&W.includes("email")||Q==="linkedin"&&W.includes("linkedin")}).map(H=>H.type.charAt(0).toUpperCase()+H.type.slice(1)),datasets:[{data:o.activities.byType.filter(H=>{const Q=H.type.toLowerCase();return Q==="call"&&W.includes("call")||Q==="email"&&W.includes("email")||Q==="linkedin"&&W.includes("linkedin")}).map(H=>H.count),backgroundColor:[...W.includes("call")?["rgb(34, 197, 94)"]:[],...W.includes("email")?["rgb(59, 130, 246)"]:[],...W.includes("linkedin")?["rgb(168, 85, 247)"]:[]]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Prospect Stage Distribution"}),o.prospects.stageDistribution.length>0?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Wu,{data:{labels:o.prospects.stageDistribution.map(H=>H.stage),datasets:[{label:"Prospects",data:o.prospects.stageDistribution.map(H=>H.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No stage data available"})})]}),o.topPerformers&&o.topPerformers.length>0&&t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performing Prospects"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Prospect"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Activities"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Last Activity"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:o.topPerformers.map(H=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:H.name}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.company}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-semibold",children:H.activityCount}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.lastActivity?new Date(H.lastActivity).toLocaleDateString():"N/A"})]},H.id))})]})})]})]}),v==="funnels"&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:`${W.length===1?"flex justify-center":W.length===2?"grid grid-cols-1 lg:grid-cols-2 gap-3 justify-center":"grid grid-cols-1 lg:grid-cols-3 gap-3"}`,children:[W.includes("call")&&t.jsx(V,{title:"Cold Calling Funnel",data:o.funnels.coldCalling,color:"green",funnelType:"call",totalProspects:o.overview?.totalProspects}),W.includes("email")&&t.jsx(V,{title:"Email Funnel",data:o.funnels.email,color:"blue",funnelType:"email",totalProspects:o.overview?.totalProspects}),W.includes("linkedin")&&t.jsx(V,{title:"LinkedIn Funnel",data:o.funnels.linkedin,color:"purple",funnelType:"linkedin",totalProspects:o.overview?.totalProspects})]}),M&&t.jsx("div",{className:"text-xs text-gray-500 text-center mt-2",children:"Click on any stage above to view detailed records"})]}),v==="pipeline"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Pipeline Analysis"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Monitor your sales pipeline and conversion metrics"})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Conversion Metrics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:[o.pipeline.conversion.winRate,"%"]}),t.jsx("div",{className:"text-base font-semibold text-gray-700 mb-1",children:"Win Rate"}),t.jsxs("div",{className:"text-sm text-gray-600",children:[o.pipeline.conversion.won," won / ",o.pipeline.conversion.total," total"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"text-4xl font-bold text-green-600 mb-2",children:[o.pipeline.conversion.meetingRate,"%"]}),t.jsx("div",{className:"text-base font-semibold text-gray-700 mb-1",children:"Meeting Rate"}),t.jsxs("div",{className:"text-sm text-gray-600",children:[o.pipeline.conversion.meetings," meetings scheduled"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:o.pipeline.conversion.sql}),t.jsx("div",{className:"text-base font-semibold text-gray-700 mb-1",children:"SQL Count"}),t.jsx("div",{className:"text-sm text-gray-600",children:"Sales Qualified Leads"})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Pipeline Stage Distribution"}),o.prospects.byStage&&o.prospects.byStage.length>0?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Wu,{data:{labels:o.prospects.byStage.map(H=>H.stage||H._id),datasets:[{label:"Prospects",data:o.prospects.byStage.map(H=>H.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0,ticks:{stepSize:50}},y:{ticks:{font:{size:12}}}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No pipeline data available"})})]})]}),W.includes("linkedin")&&v==="linkedin"&&(()=>{const H=o.funnels.linkedin||{},Q=H.connectionSent||0,te=H.accepted||0,de=H.followups||0,ve=H.scheduled||0,ke=H.completed||0,ne=Q>0?te/Q*100:0,De=de>0?de/Q*100:0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"LinkedIn"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Q.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Connection Requests Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ne.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[te.toLocaleString()," accepted"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Messages"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:de.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Messages Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[De.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[de.toLocaleString()," replies"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(ve+ke).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"LinkedIn Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Wu,{data:{labels:["Requests Sent","Accepted","Messages Sent","Replies","Meetings"],datasets:[{label:"LinkedIn Funnel",data:[Q,te,de,de,ve+ke],backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:He=>`${He.label}: ${He.parsed.y.toLocaleString()}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:12}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Connection Acceptance Rate"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(ap,{data:{labels:["Accepted","Not Accepted"],datasets:[{label:"Connection Requests",data:[te,Math.max(0,Q-te)],backgroundColor:["#10B981","#EF4444"],borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:He=>{const vt=He.label||"",Pe=He.parsed||0,Nt=Q>0?Pe/Q*100:0;return`${vt}: ${Pe.toLocaleString()} (${Nt.toFixed(1)}%)`}}}}}})})})]})]})]})})(),W.includes("call")&&v==="calls"&&(()=>{const H=o.funnels.coldCalling||{},Q=H.callsAttempted||0,te=H.callsConnected||0,de=H.decisionMakerReached||0,ve=H.interested||0,ke=(H.demoBooked||0)+(H.demoCompleted||0),ne=Q>0?te/Q*100:0,De=H.callStatusBreakdown||{},He=Object.keys(De).filter(st=>De[st]>0&&De[st]!==void 0),vt=He.map(st=>De[st]),Pe={Interested:"#10B981","Not Interested":"#EF4444",Ring:"#F59E0B",Busy:"#F97316","Call Back":"#3B82F6","Hang Up":"#EF4444","Switch Off":"#6B7280",Future:"#8B5CF6","Details Shared":"#06B6D4","Demo Booked":"#10B981",Invalid:"#9CA3AF",Existing:"#6366F1","Demo Completed":"#059669","No Status":"#D1D5DB"},Nt=He.map(st=>Pe[st]||"#9CA3AF");return He.length===0&&Q>0&&console.log("Call Status Breakdown Debug:",{callStatusBreakdown:De,callData:H,callsMade:Q,statusLabels:He}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Calls"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Q.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Calls Made"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ne.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[te.toLocaleString()," connected"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Decision"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:de.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Decision Maker Connects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Interested"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:ve.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Interested"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:ke.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Cold Call Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Wu,{data:{labels:["Calls Made","Connected","Decision Maker","Interested","Meetings"],datasets:[{label:"Cold Call Funnel",data:[Q,te,de,ve,ke],backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:st=>`${st.label}: ${st.parsed.y.toLocaleString()}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:25}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Call Status Distribution"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:He.length>0?t.jsx(ap,{data:{labels:He,datasets:[{label:"Call Status",data:vt,backgroundColor:Nt,borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle",color:"#374151"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,callbacks:{label:st=>{const Xt=st.label||"",Rt=st.parsed||0,Ns=vt.reduce((ps,ds)=>ps+ds,0),Js=Ns>0?(Rt/Ns*100).toFixed(1):0;return`${Xt}: ${Rt.toLocaleString()} (${Js}%)`}}}}}}):Q>0?t.jsxs("div",{className:"text-gray-500 text-sm text-center",children:[t.jsx("p",{children:"No call status data available"}),t.jsx("p",{className:"text-xs mt-2",children:"Calls have been made but status information is missing"})]}):t.jsx("div",{className:"text-gray-500 text-sm",children:"No calls made yet"})})})]})]})]})})(),W.includes("email")&&v==="email"&&(()=>{const H=o.funnels.email||{},Q=H.emailSent||0,te=H.accepted||0,de=H.scheduled||0,ve=H.completed||0,ke=H.sql||0,ne=Q>0?te/Q*100:0,De=Q>0?ke/Q*100:0,He=de+ve;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Email"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Q.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Emails Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsxs("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ne.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[te.toLocaleString()," opened"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[De.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[ke.toLocaleString()," replies"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:He.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-pink-50 rounded-xl border border-red-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full shadow-xs",children:"Bounce"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:"0.0%"}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Bounce Rate"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Wu,{data:{labels:["Emails Sent","Opened","Replied","Meetings"],datasets:[{label:"Email Funnel",data:[Q,te,ke,He],backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:vt=>`${vt.label}: ${vt.parsed.y.toLocaleString()}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:10}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Status Distribution"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(ap,{data:{labels:["Replied","Opened","No Reply"],datasets:[{label:"Email Status",data:[ke,Math.max(0,te-ke),Math.max(0,Q-te)],backgroundColor:["#10B981","#3B82F6","#9CA3AF"],borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:vt=>{const Pe=vt.label||"",Nt=vt.parsed||0,st=Q>0?Nt/Q*100:0;return`${Pe}: ${Nt.toLocaleString()} (${st.toFixed(1)}%)`}}}}}})})})]})]})]})})(),v==="team"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Team Performance"}),he?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):be.length>0?t.jsx("div",{className:`${be.length===1?"flex justify-center":be.length===2?"grid grid-cols-1 lg:grid-cols-2 gap-6":"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6"}`,children:be.map(H=>{const Q=o?.team?.performance?.find(te=>te.id===H.memberId);return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-100",children:[t.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-1",children:H.name}),t.jsx("p",{className:"text-xs text-gray-600",children:H.email}),Q&&t.jsxs("div",{className:"mt-2 flex gap-4 text-xs text-gray-600",children:[t.jsxs("span",{children:["Total: ",t.jsx("span",{className:"font-semibold text-gray-900",children:Q.totalActivities})]}),W.includes("call")&&t.jsxs("span",{children:["Calls: ",t.jsx("span",{className:"font-semibold text-gray-900",children:Q.calls})]}),W.includes("email")&&t.jsxs("span",{children:["Emails: ",t.jsx("span",{className:"font-semibold text-gray-900",children:Q.emails})]}),W.includes("linkedin")&&t.jsxs("span",{children:["LinkedIn: ",t.jsx("span",{className:"font-semibold text-gray-900",children:Q.linkedin})]})]})]}),t.jsxs("div",{className:"space-y-3",children:[W.includes("call")&&H.funnels.coldCalling&&t.jsx(V,{title:`${H.name} - Cold Calling`,data:H.funnels.coldCalling,color:"green",funnelType:"call",totalProspects:o.overview?.totalProspects,memberId:H.memberId}),W.includes("linkedin")&&H.funnels.linkedin&&t.jsx(V,{title:`${H.name} - LinkedIn`,data:H.funnels.linkedin,color:"purple",funnelType:"linkedin",totalProspects:o.overview?.totalProspects,memberId:H.memberId}),W.includes("email")&&H.funnels.email&&t.jsx(V,{title:`${H.name} - Email`,data:H.funnels.email,color:"blue",funnelType:"email",totalProspects:o.overview?.totalProspects,memberId:H.memberId})]})]},H.memberId)})}):t.jsx("div",{className:"text-center py-12 text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No team performance data available"})})]}),t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Time Period:"}),t.jsx("button",{onClick:()=>we("today"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${xe==="today"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Today"}),t.jsx("button",{onClick:()=>we("last7days"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${xe==="last7days"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Last 7 Days"}),t.jsx("button",{onClick:()=>we("lastMonth"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${xe==="lastMonth"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Last Month"})]})}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Trends"}),ue?t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):Z?.chartData?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-full flex items-center justify-center",children:"Loading chart..."}),children:t.jsx(Wu,{data:Z.chartData,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Activities by Type and Status"}},scales:{x:{stacked:!0},y:{stacked:!0,beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Distribution by Channel"}),ue?t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):Z?.pieData?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-full flex items-center justify-center",children:"Loading chart..."}),children:t.jsx(n7,{data:Z.pieData,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"},title:{display:!0,text:"Activities by Channel"}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]})]})]}),M&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[100] flex items-center justify-center p-4",onClick:()=>{F(null),P([])},style:{position:"fixed",top:0,left:0,right:0,bottom:0},children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] flex flex-col relative z-[101]",onClick:H=>H.stopPropagation(),style:{position:"relative",zIndex:101},children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gradient-to-r from-gray-50 to-white",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900",children:M.memberId?(()=>{const Q=be.find(te=>{const de=te.memberId?.toString?te.memberId.toString():String(te.memberId),ve=M.memberId?.toString?M.memberId.toString():String(M.memberId);return de===ve})?.name||"Team Member";return M.stage==="prospectData"?`${Q} - All Prospects`:`${Q} - ${M.stage.charAt(0).toUpperCase()+M.stage.slice(1)} - ${M.funnelType==="call"?"Cold Calling":M.funnelType==="email"?"Email":"LinkedIn"} Funnel`})():M.stage==="prospectData"?"All Prospects":M.stage.charAt(0).toUpperCase()+M.stage.slice(1)+" - "+(M.funnelType==="call"?"Cold Calling":M.funnelType==="email"?"Email":"LinkedIn")+" Funnel"}),t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[O.length," ",M.stage==="prospectData"?"prospect":"record",O.length!==1?"s":""," found"]})]}),t.jsx("button",{onClick:()=>{F(null),P([])},className:"text-gray-400 hover:text-gray-600 transition-colors p-1 hover:bg-gray-100 rounded-lg",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:G?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}):O.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-200 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:M.stage==="prospectData"?"Prospect":"Contact"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Company"}),M.stage==="prospectData"?t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Phone"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Stage"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Priority"})]}):t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Status"})]})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:O.map((H,Q)=>H.isProspect||M.stage==="prospectData"?t.jsxs("tr",{className:"hover:bg-blue-50/50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:H.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:H.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.email||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.firstPhone||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm",children:(H.displayStatus||H.stage)&&t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-purple-100 text-purple-800 rounded-full border border-purple-200",children:H.displayStatus||H.stage})}),t.jsx("td",{className:"px-4 py-3 text-sm",children:H.priority&&t.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full border ${H.priority==="High"?"bg-red-100 text-red-800 border-red-200":H.priority==="Medium"?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-gray-100 text-gray-800 border-gray-200"}`,children:H.priority})})]},Q):t.jsxs("tr",{className:"hover:bg-blue-50/50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:H.contact?.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:H.contact?.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.callDate||H.emailDate||H.linkedinDate?new Date(H.callDate||H.emailDate||H.linkedinDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):H.createdAt?new Date(H.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}),t.jsxs("td",{className:"px-4 py-3 text-sm",children:[H.status&&t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded-full border border-blue-200",children:H.status}),H.callStatus&&t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded-full border border-green-200",children:H.callStatus}),!H.status&&!H.callStatus&&t.jsx("span",{className:"text-xs text-gray-400",children:"-"})]})]},Q))})]})}):t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm font-medium",children:"No records found for this stage"})]})})]})})]})}const c7=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Line}))),To=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Bar}))),$u=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Doughnut})));cl.register(Wc,$c,Bc,dl,zc,bm,Hc,Vc,Uc);let R1=null,_b=0;const d7=60*1e3;function u7(){const[l,n]=B.useState(null),[a,o]=B.useState(!0),[s,e]=B.useState("executive"),m=B.useRef(!0);B.useEffect(()=>(m.current=!0,(async()=>{const me=Date.now();R1&&me-_b<d7?m.current&&(n(R1),o(!1)):await v()})(),()=>{m.current=!1}),[]);const v=async()=>{if(m.current)try{o(!0);const se=await Ht.get("/master-dashboard");if(se.data.success&&m.current){const me=se.data.data;n(me),R1=me,_b=Date.now()}}catch(se){console.error("Error fetching master dashboard data:",se)}finally{m.current&&o(!1)}},w=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(a)return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(8)].map((se,me)=>t.jsx(w,{},me))})})});if(!l)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-600",children:"Couldn't load the dashboard right now. Try refreshing."}),t.jsx("button",{onClick:v,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})});const N=l?.executive||{},S=l?.rankings||{bestPerformingProjects:[],channelEfficiency:{linkedin:{acceptanceRate:0},call:{connectRate:0},email:{replyRate:0}},teamLeaderboard:[]},D=l?.alerts||{lowActivityProjects:[],highBounceProjects:[],missingFollowUps:[]},L=l?.dataQuality||{leadsAddedDaily:0,leadsAddedWeekly:0,validEmailPercent:0,validPhonePercent:0,duplicatePercent:0,dataQualityScore:0,totalProspects:0,validEmailCount:0,validPhoneCount:0,duplicateCount:0},M=l?.linkedin||{connectionRequestsSent:0,acceptanceRate:0,accepted:0,messagesSent:0,replies:0,replyRate:0,meetingsBooked:0},F=l?.coldCall||{callsMade:0,connectRate:0,connected:0,decisionMakerConnects:0,interested:0,meetingsBooked:0},O=l?.email||{emailsSent:0,bounceRate:0,bounced:0,replyRate:0,replied:0,positiveReplies:0,meetingsBooked:0},P=l?.followUp||{totalDue:0,completed:0,overdueCount:0,completionRate:0,slaCompliance:0,chartData:null,projectData:null},G=se=>{const me=typeof se=="string"?parseFloat(se):se;return typeof me!="number"||isNaN(me)||!isFinite(me)||me<0?0:Math.max(0,Math.min(100,me))},ae=se=>se.map(me=>{const W=typeof me=="string"?parseFloat(me):me;return typeof W!="number"||isNaN(W)||!isFinite(W)?0:W}),re=[S?.channelEfficiency?.linkedin?.acceptanceRate,S?.channelEfficiency?.call?.connectRate,S?.channelEfficiency?.email?.replyRate].map(se=>G(se||0)),Ne={labels:["LinkedIn","Call","Email"],datasets:[{label:"Efficiency Rate (%)",data:ae(re),backgroundColor:["#3B82F6","#10B981","#F59E0B"],borderColor:["#2563EB","#059669","#D97706"],borderWidth:2}]},xe={labels:(S?.teamLeaderboard||[]).slice(0,10).map(se=>se?.name||"Unknown"),datasets:[{label:"Total Activities",data:(S?.teamLeaderboard||[]).slice(0,10).map(se=>{const me=se?.totalActivities||0;return typeof me=="number"&&isFinite(me)?me:0}),backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},we=[L?.validEmailPercent||0,L?.validPhonePercent||0,L?.duplicatePercent||0].map(se=>G(se)),Z={labels:["Valid Email","Valid Phone","Duplicates"],datasets:[{data:ae(we),backgroundColor:["#10B981","#3B82F6","#EF4444"],borderWidth:2,borderColor:"#ffffff",hoverOffset:4}]},ce={labels:["Requests Sent","Accepted","Messages Sent","Replies","Meetings"],datasets:[{label:"LinkedIn Funnel",data:[M?.connectionRequestsSent||0,M?.accepted||0,M?.messagesSent||0,M?.replies||0,M?.meetingsBooked||0].map(se=>typeof se=="number"&&isFinite(se)?se:0),backgroundColor:["#0077B5","#00A0DC","#008CC9","#006699","#004D73"],borderColor:["#005885","#0077B5","#006699","#004D73","#003D5C"],borderWidth:2}]},ue={labels:["Accepted","Not Accepted"],datasets:[{label:"Connection Requests",data:[M?.accepted||0,Math.max(0,(M?.connectionRequestsSent||0)-(M?.accepted||0))].map(se=>typeof se=="number"&&isFinite(se)?se:0),backgroundColor:["#10B981","#EF4444"],borderWidth:2}]},Le={labels:["Calls Made","Connected","Decision Maker","Interested","Meetings"],datasets:[{label:"Cold Call Funnel",data:[F?.callsMade||0,F?.connected||0,F?.decisionMakerConnects||0,F?.interested||0,F?.meetingsBooked||0].map(se=>typeof se=="number"&&isFinite(se)?se:0),backgroundColor:["#3B82F6","#2563EB","#1D4ED8","#1E40AF","#1E3A8A"],borderColor:["#2563EB","#1D4ED8","#1E40AF","#1E3A8A","#1E3A8A"],borderWidth:2}]},be={labels:["Connected","Not Connected"],datasets:[{label:"Call Connections",data:[F?.connected||0,Math.max(0,(F?.callsMade||0)-(F?.connected||0))].map(se=>typeof se=="number"&&isFinite(se)?se:0),backgroundColor:["#10B981","#EF4444"],borderWidth:2}]},oe={labels:["Emails Sent","Replied","Positive Replies","Meetings"],datasets:[{label:"Email Funnel",data:[O?.emailsSent||0,O?.replied||0,O?.positiveReplies||0,O?.meetingsBooked||0].map(se=>typeof se=="number"&&isFinite(se)?se:0),backgroundColor:["#8B5CF6","#7C3AED","#6D28D9","#5B21B6"],borderColor:["#7C3AED","#6D28D9","#5B21B6","#4C1D95"],borderWidth:2}]},he={labels:["Replied","Bounced","No Reply"],datasets:[{label:"Email Status",data:[O?.replied||0,O?.bounced||0,Math.max(0,(O?.emailsSent||0)-(O?.replied||0)-(O?.bounced||0))].map(se=>typeof se=="number"&&isFinite(se)?se:0),backgroundColor:["#10B981","#EF4444","#9CA3AF"],borderWidth:2,borderColor:"#ffffff"}]},ye={labels:["Touches","Meetings"],datasets:[{label:"This Week",data:[N?.totalTouchesThisWeek||0,N?.totalMeetingsBookedThisWeek||0].map(se=>typeof se=="number"&&isFinite(se)?se:0),backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:2},{label:"This Month",data:[N?.totalTouchesThisMonth||0,N?.totalMeetingsBookedThisMonth||0].map(se=>typeof se=="number"&&isFinite(se)?se:0),backgroundColor:"#10B981",borderColor:"#059669",borderWidth:2}]},Te={labels:["LinkedIn","Cold Call","Email"],datasets:[{label:"Activities by Channel",data:[M?.connectionRequestsSent||0,F?.callsMade||0,O?.emailsSent||0].map(se=>typeof se=="number"&&isFinite(se)?se:0),backgroundColor:["#0077B5","#3B82F6","#8B5CF6"],borderWidth:2,borderColor:"#ffffff",hoverOffset:4}]},fe={labels:["Conversion Rate","SLA Compliance"],datasets:[{label:"Performance Metrics (%)",data:[G(N?.weightedConversionRate||0),G(N?.slaCompliance||0)],backgroundColor:["#10B981","#3B82F6"],borderColor:["#059669","#2563EB"],borderWidth:2}]},_e={labels:["Leads in Play","Total Touches","Meetings Booked"],datasets:[{label:"Overall Funnel",data:[N?.totalLeadsInPlay||0,N?.totalTouchesThisMonth||0,N?.totalMeetingsBookedThisMonth||0].map(se=>typeof se=="number"&&isFinite(se)?se:0),backgroundColor:["#3B82F6","#8B5CF6","#10B981"],borderColor:["#2563EB","#7C3AED","#059669"],borderWidth:2}]},We=[{id:"executive",label:"Executive Summary"},{id:"rankings",label:"Rankings"},{id:"alerts",label:"Alerts"},{id:"data",label:"Data Quality"},{id:"linkedin",label:"LinkedIn"},{id:"calls",label:"Cold Calls"},{id:"email",label:"Email"},{id:"followup",label:"Follow-ups"}];return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-20 shadow-sm backdrop-blur-sm bg-white/95",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>window.history.back(),className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors",title:"Go Back",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Master Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"All Projects Summary & Analytics"})]})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium text-sm text-gray-700",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:We.map(se=>t.jsx("button",{onClick:()=>e(se.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${s===se.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:se.label},se.id))})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 relative z-0",children:[s==="executive"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Projects"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N?.activeProjects||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Active Projects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Leads"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(N?.totalLeadsInPlay||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Leads in Play"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full shadow-xs",children:"Activity"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(N?.totalTouchesThisWeek||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Touches This Week"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N?.totalMeetingsBookedThisWeek||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings This Week"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-blue-50 rounded-xl border border-indigo-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full shadow-xs",children:"Activity"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(N?.totalTouchesThisMonth||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Touches This Month"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-rose-50 to-pink-50 rounded-xl border border-rose-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-rose-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-rose-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-rose-700 bg-white/70 border border-rose-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N?.totalMeetingsBookedThisMonth||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings This Month"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-cyan-50 rounded-xl border border-teal-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full shadow-xs",children:"Conversion"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(N?.weightedConversionRate||0).toFixed(1),"%"]}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Weighted Conversion Rate"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl border border-orange-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-orange-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-orange-700 bg-white/70 border border-orange-100 px-2 py-1 rounded-full shadow-xs",children:"Compliance"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(N?.slaCompliance||0).toFixed(1),"%"]}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"SLA Compliance"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Week vs Month Performance"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(To,{data:ye,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{position:"top",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:se=>{const me=typeof se.parsed.y=="number"&&isFinite(se.parsed.y)?se.parsed.y:0;return`${se.dataset.label}: ${me.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:se=>{const me=typeof se=="number"?se:parseFloat(se);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1}},x:{grid:{display:!1}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Activity by Channel"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx($u,{data:Te,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:se=>{const me=se.label||"",W=se.parsed||0,pe=(M?.connectionRequestsSent||0)+(F?.callsMade||0)+(O?.emailsSent||0),Me=pe>0?W/pe*100:0;return`${me}: ${W.toLocaleString()} (${Me.toFixed(1)}%)`}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Overall Sales Funnel"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(To,{data:_e,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:se=>{const me=typeof se.parsed.y=="number"&&isFinite(se.parsed.y)?se.parsed.y:0;return`${se.label}: ${me.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:se=>{const me=typeof se=="number"?se:parseFloat(se);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Key Performance Metrics"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(To,{data:fe,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:se=>{const me=G(se.parsed.y);return`${se.label}: ${me.toFixed(2)}%`}}}},scales:{y:{beginAtZero:!0,max:100,min:0,ticks:{callback:se=>`${G(se)}%`,stepSize:20,maxTicksLimit:6},afterDataLimits:se=>{se.max=100,se.min=0}},x:{grid:{display:!1}}}}})})})]})]})]}),s==="rankings"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Best Performing Projects"}),t.jsx("div",{className:"space-y-3",children:(S?.bestPerformingProjects||[]).slice(0,10).map((se,me)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${me===0?"bg-yellow-100 text-yellow-800":me===1?"bg-gray-100 text-gray-800":me===2?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:me+1}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:se.projectName}),t.jsxs("p",{className:"text-xs text-gray-500",children:[se.totalProspects," prospects"]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-semibold text-gray-900",children:se.meetingsPer100Leads.toFixed(1)}),t.jsx("p",{className:"text-xs text-gray-500",children:"meetings/100 leads"})]})]},me))})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Channel Efficiency Leaderboard"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(To,{data:Ne,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:se=>`Efficiency: ${G(se.parsed.y).toFixed(2)}%`}}},scales:{y:{beginAtZero:!0,max:100,min:0,grace:0,ticks:{callback:se=>`${G(se)}%`,stepSize:20,maxTicksLimit:6,precision:0},afterDataLimits:se=>{se.max=100,se.min=0},afterBuildTicks:se=>{se.ticks=se.ticks.filter(me=>{const W=typeof me.value=="number"?me.value:parseFloat(me.value);return isFinite(W)&&W>=0&&W<=100})}},x:{grid:{display:!1}}}}})})}),t.jsxs("div",{className:"mt-4 space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg border border-blue-200",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"LinkedIn Acceptance"}),t.jsxs("span",{className:"font-bold text-lg text-blue-700",children:[G(S?.channelEfficiency?.linkedin?.acceptanceRate||0).toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-green-100 rounded-lg border border-green-200",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Call Connect Rate"}),t.jsxs("span",{className:"font-bold text-lg text-green-700",children:[G(S?.channelEfficiency?.call?.connectRate||0).toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-amber-50 to-amber-100 rounded-lg border border-amber-200",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Email Reply Rate"}),t.jsxs("span",{className:"font-bold text-lg text-amber-700",children:[G(S?.channelEfficiency?.email?.replyRate||0).toFixed(2),"%"]})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm lg:col-span-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Team Leaderboard"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(To,{data:xe,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2.5,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:se=>`Activities: ${typeof se.parsed.y=="number"&&isFinite(se.parsed.y)?se.parsed.y:0}`}}},scales:{y:{beginAtZero:!0,ticks:{callback:se=>{const me=typeof se=="number"?se:parseFloat(se);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1},afterBuildTicks:se=>{se.ticks=se.ticks.filter(me=>{const W=typeof me.value=="number"?me.value:parseFloat(me.value);return isFinite(W)&&W>=0})}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})}),t.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:(S?.teamLeaderboard||[]).slice(0,10).map((se,me)=>t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900 text-sm",children:se.name||"Unknown"}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[se.totalActivities," activities"]}),t.jsxs("div",{className:"mt-2 flex gap-2 text-xs",children:[t.jsxs("span",{className:"text-blue-600",children:[se.calls," calls"]}),t.jsxs("span",{className:"text-green-600",children:[se.emails," emails"]}),t.jsxs("span",{className:"text-purple-600",children:[se.linkedin," LI"]})]})]},me))})]})]})}),s==="alerts"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Low Activity (Last 3 Days)"}),t.jsx("div",{className:"space-y-2",children:(D?.lowActivityProjects||[]).length>0?(D?.lowActivityProjects||[]).map((se,me)=>t.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900",children:se.projectName}),t.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[se.activityCount," activities / ",se.totalContacts," contacts"]})]},me)):t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No low activity projects"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"High Bounce/Wrong Data"})]}),t.jsx("div",{className:"space-y-2",children:(D?.highBounceProjects||[]).length>0?(D?.highBounceProjects||[]).map((se,me)=>t.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900",children:se.projectName}),t.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[se.errorRate.toFixed(1),"% error rate (",se.bounceCount," bounces, ",se.wrongPersonCount," wrong)"]})]},me)):t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No high bounce projects"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Missing Follow-ups"}),t.jsx("div",{className:"space-y-2",children:(D?.missingFollowUps||[]).length>0?(D?.missingFollowUps||[]).map((se,me)=>t.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900",children:se.projectName}),t.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[se.overdueCount," overdue follow-ups"]})]},me)):t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No missing follow-ups"})})]})]})}),s==="data"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Daily"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:L?.leadsAddedDaily||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Leads Added (Daily)"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Weekly"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:L?.leadsAddedWeekly||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Leads Added (Weekly)"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Quality"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(L?.validEmailPercent||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(L?.validEmailCount||0).toLocaleString()," of ",(L?.totalProspects||0).toLocaleString()]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Quality"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(L?.validPhonePercent||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(L?.validPhoneCount||0).toLocaleString()," of ",(L?.totalProspects||0).toLocaleString()]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 rounded-xl border border-red-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full shadow-xs",children:"Duplicates"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(L?.duplicatePercent||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(L?.duplicateCount||0).toLocaleString()," duplicates"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Score"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(L?.dataQualityScore||0).toFixed(1),"%"]}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Data Quality Score"})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Data Quality Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx($u,{data:Z,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",layout:{padding:{top:20,bottom:20}},plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:se=>{const me=se.label||"",W=G(se.parsed||0),pe=we.reduce((Se,V)=>Se+G(V),0),Me=pe>0?G(se.parsed||0)/pe*100:0;return`${me}: ${W.toFixed(2)}% (${Me.toFixed(1)}% of total)`}}}}}})})})]})]}),s==="linkedin"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"LinkedIn"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(M?.connectionRequestsSent||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Connection Requests Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(M?.acceptanceRate||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(M?.accepted||0).toLocaleString()," accepted"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Messages"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(M?.messagesSent||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Messages Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(M?.replyRate||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(M?.replies||0).toLocaleString()," replies"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:M?.meetingsBooked||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"LinkedIn Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(To,{data:ce,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:se=>{const me=typeof se.parsed.y=="number"&&isFinite(se.parsed.y)?se.parsed.y:0;return`${se.label}: ${me.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:se=>{const me=typeof se=="number"?se:parseFloat(se);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Connection Acceptance Rate"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx($u,{data:ue,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:se=>{const me=se.label||"",W=se.parsed||0,pe=M?.connectionRequestsSent||0,Me=pe>0?W/pe*100:0;return`${me}: ${W.toLocaleString()} (${Me.toFixed(1)}%)`}}}}}})})})]})]})]}),s==="calls"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Calls Made"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:(F?.callsMade||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Connect Rate"}),t.jsxs("p",{className:"text-4xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent",children:[G(F?.connectRate||0).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-medium",children:[(F?.connected||0).toLocaleString()," connected"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Decision Maker Connects"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:(F?.decisionMakerConnects||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 border-2 border-cyan-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Interested"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent",children:(F?.interested||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Meetings Booked"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent",children:F?.meetingsBooked||0})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Cold Call Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(To,{data:Le,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:se=>{const me=typeof se.parsed.y=="number"&&isFinite(se.parsed.y)?se.parsed.y:0;return`${se.label}: ${me.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:se=>{const me=typeof se=="number"?se:parseFloat(se);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Call Connection Rate"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx($u,{data:be,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:se=>{const me=se.label||"",W=se.parsed||0,pe=F?.callsMade||0,Me=pe>0?W/pe*100:0;return`${me}: ${W.toLocaleString()} (${Me.toFixed(1)}%)`}}}}}})})})]})]})]}),s==="email"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Emails Sent"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:(O?.emailsSent||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 border-2 border-red-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Bounce Rate"}),t.jsxs("p",{className:"text-4xl font-bold bg-gradient-to-r from-red-600 to-orange-600 bg-clip-text text-transparent",children:[G(O?.bounceRate||0).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-medium",children:[(O?.bounced||0).toLocaleString()," bounced"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Reply Rate"}),t.jsxs("p",{className:"text-4xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent",children:[G(O?.replyRate||0).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-medium",children:[(O?.replied||0).toLocaleString()," replied"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Positive Replies"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:(O?.positiveReplies||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Meetings Booked"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent",children:O?.meetingsBooked||0})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(To,{data:oe,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:se=>{const me=typeof se.parsed.y=="number"&&isFinite(se.parsed.y)?se.parsed.y:0;return`${se.label}: ${me.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:se=>{const me=typeof se=="number"?se:parseFloat(se);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Status Breakdown"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx($u,{data:he,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:se=>{const me=se.label||"",W=se.parsed||0,pe=O?.emailsSent||0,Me=pe>0?W/pe*100:0;return`${me}: ${W.toLocaleString()} (${Me.toFixed(1)}%)`}}}}}})})})]})]})]}),s==="followup"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Total Due"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(P?.totalDue||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Completed"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(P?.completed||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Overdue Count"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(P?.overdueCount||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Completion Rate"}),t.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[(P?.completionRate||0).toFixed(2),"%"]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"SLA Compliance"}),t.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[(P?.slaCompliance||0).toFixed(2),"%"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-up Status Distribution"}),P?.totalDue>0?t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx($u,{data:{labels:["Completed","Overdue","Pending"],datasets:[{label:"Follow-ups",data:[P.completed||0,P.overdueCount||0,(P.totalDue||0)-(P.completed||0)-(P.overdueCount||0)],backgroundColor:["#10B981","#EF4444","#F59E0B"],borderColor:["#059669","#DC2626","#D97706"],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12}}},tooltip:{callbacks:{label:function(se){const me=se.label||"",W=se.parsed||0,pe=se.dataset.data.reduce((Se,V)=>Se+V,0),Me=pe>0?(W/pe*100).toFixed(1):0;return`${me}: ${W} (${Me}%)`}}}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:"No follow-up data available"})]}),P?.projectData&&P.projectData.labels.length>0?t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-ups by Project (Top 10)"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(To,{data:{labels:P.projectData.labels,datasets:[{label:"Completed",data:P.projectData.completed,backgroundColor:"#10B981",borderColor:"#059669",borderWidth:1},{label:"Overdue",data:P.projectData.overdue,backgroundColor:"#EF4444",borderColor:"#DC2626",borderWidth:1},{label:"Pending",data:P.projectData.total.map((se,me)=>se-P.projectData.completed[me]-P.projectData.overdue[me]),backgroundColor:"#F59E0B",borderColor:"#D97706",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:10,font:{size:12}}},tooltip:{mode:"index",intersect:!1}},scales:{x:{stacked:!0,ticks:{maxRotation:45,minRotation:45,font:{size:10}}},y:{stacked:!0,beginAtZero:!0,ticks:{stepSize:1}}}}})})})]}):t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-ups by Project"}),t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:"No project data available"})]}),P?.chartData&&P.chartData.labels.length>0?t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm lg:col-span-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-up Trends Over Time"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(c7,{data:{labels:P.chartData.labels,datasets:[{label:"Total Due",data:P.chartData.total,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!0,tension:.4},{label:"Completed",data:P.chartData.completed,borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:2,fill:!0,tension:.4},{label:"Overdue",data:P.chartData.overdue,borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderWidth:2,fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12}}},tooltip:{mode:"index",intersect:!1}},scales:{x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}},y:{beginAtZero:!0,ticks:{stepSize:1}}}}})})})]}):t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm lg:col-span-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-up Trends Over Time"}),t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:"No trend data available"})]})]})]})]})]})}const O1=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Bar})));B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Line})));const P1=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Doughnut}))),h7=B.lazy(()=>Da(()=>Promise.resolve().then(()=>Ta),void 0).then(l=>({default:l.Pie})));cl.register(Wc,$c,Bc,dl,zc,bm,Hc,Vc,Uc,Ip);const Fb={},f7=60*1e3;function m7(){const l=Fr(),[n,a]=B.useState(!0),[o,s]=B.useState(null),[e,m]=B.useState(null),[v,w]=B.useState("overview"),[N,S]=B.useState("last7days");B.useEffect(()=>{(async()=>{const ae=Fb[N||"all"];if(ae&&Date.now()-ae.timestamp<f7){const re=ae.data;s(re),re.employees.length>0&&!e&&m(re.employees[0].userId),a(!1)}else await D()})()},[N]);const D=async()=>{try{a(!0);const P=await Ht.get("/projects/employee-performance",{params:{timeFilter:N}});if(P.data.success){const G=P.data.data;s(G),Fb[N||"all"]={data:G,timestamp:Date.now()},G.employees.length>0&&!e&&m(G.employees[0].userId)}}catch(P){console.error("Error fetching employee performance:",P)}finally{a(!1)}},L=B.useMemo(()=>!o||!e?null:o.employees.find(P=>P.userId===e)||o.employees[0],[o,e]),M=B.useMemo(()=>o?{channelDistribution:{labels:["Email","Call","LinkedIn"],datasets:[{label:"Activities by Channel",data:[o.summary.byChannel.email,o.summary.byChannel.call,o.summary.byChannel.linkedin],backgroundColor:["#3B82F6","#10B981","#8B5CF6"],borderWidth:2,borderColor:"#ffffff"}]},employeeComparison:{labels:o.employees.map(P=>P.name),datasets:[{label:"Email",data:o.employees.map(P=>P.byChannel.email.total),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"#3B82F6",borderWidth:1},{label:"Call",data:o.employees.map(P=>P.byChannel.call.total),backgroundColor:"rgba(16, 185, 129, 0.8)",borderColor:"#10B981",borderWidth:1},{label:"LinkedIn",data:o.employees.map(P=>P.byChannel.linkedin.total),backgroundColor:"rgba(139, 92, 246, 0.8)",borderColor:"#8B5CF6",borderWidth:1}]},topPerformers:o.employees.sort((P,G)=>G.totalActivities-P.totalActivities).slice(0,5)}:null,[o]),F=B.useMemo(()=>{if(!L)return null;const P=Object.keys(L.byChannel.email.byStatus||{}),G=Object.keys(L.byChannel.call.byStatus||{}),ae=Object.keys(L.byChannel.linkedin.byStatus||{});return{channelDistribution:{labels:["Email","Call","LinkedIn"],datasets:[{label:"Activities",data:[L.byChannel.email.total,L.byChannel.call.total,L.byChannel.linkedin.total],backgroundColor:["#3B82F6","#10B981","#8B5CF6"],borderWidth:2,borderColor:"#ffffff"}]},emailStatus:{labels:P.length>0?P:["No Status"],datasets:[{label:"Email Status",data:P.length>0?P.map(re=>L.byChannel.email.byStatus[re]):[0],backgroundColor:["#3B82F6","#60A5FA","#93C5FD","#DBEAFE","#EFF6FF"],borderWidth:2,borderColor:"#ffffff"}]},callStatus:{labels:G.length>0?G:["No Status"],datasets:[{label:"Call Status",data:G.length>0?G.map(re=>L.byChannel.call.byStatus[re]):[0],backgroundColor:["#10B981","#34D399","#6EE7B7","#A7F3D0","#D1FAE5"],borderWidth:2,borderColor:"#ffffff"}]},linkedinStatus:{labels:ae.length>0?ae:["No Status"],datasets:[{label:"LinkedIn Status",data:ae.length>0?ae.map(re=>L.byChannel.linkedin.byStatus[re]):[0],backgroundColor:["#8B5CF6","#A78BFA","#C4B5FD","#DDD6FE","#EDE9FE"],borderWidth:2,borderColor:"#ffffff"}]},projectPerformance:{labels:L.byProject.map(re=>re.projectName),datasets:[{label:"Email",data:L.byProject.map(re=>re.email),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"#3B82F6",borderWidth:1},{label:"Call",data:L.byProject.map(re=>re.call),backgroundColor:"rgba(16, 185, 129, 0.8)",borderColor:"#10B981",borderWidth:1},{label:"LinkedIn",data:L.byProject.map(re=>re.linkedin),backgroundColor:"rgba(139, 92, 246, 0.8)",borderColor:"#8B5CF6",borderWidth:1}]}}},[L]);if(n)return t.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-gray-200 border-t-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Loading performance data..."})]})});if(!o||!o.employees||o.employees.length===0)return t.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm p-8 text-center",children:[t.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Employee Data Available"}),t.jsx("p",{className:"text-gray-600",children:"There are no employees with performance data for the selected time period."})]})})});const O={today:"Today",last7days:"Last 7 Days",lastMonth:"Last Month"};return t.jsx("div",{className:"bg-gray-50 min-h-screen",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Employee Performance"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Comprehensive analytics and insights for team performance tracking"})]}),t.jsx("div",{className:"flex items-center gap-2 bg-white rounded-lg border border-gray-200 p-1 shadow-sm",children:["today","last7days","lastMonth"].map(P=>t.jsx("button",{onClick:()=>S(P),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${N===P?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-50"}`,children:O[P]},P))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Total Employees"}),t.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalEmployees})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-green-700",children:"Total Activities"}),t.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalActivities.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Total Projects"}),t.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalProjects})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 border border-amber-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-amber-700",children:"Avg per Employee"}),t.jsx("div",{className:"w-10 h-10 bg-amber-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalEmployees>0?Math.round(o.summary.totalActivities/o.summary.totalEmployees):0})]})]})]}),t.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm mb-6",children:t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"flex -mb-px",children:[t.jsx("button",{onClick:()=>w("overview"),className:`px-6 py-4 text-sm font-semibold border-b-2 transition-colors ${v==="overview"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:"Overview"}),t.jsx("button",{onClick:()=>w("employee"),className:`px-6 py-4 text-sm font-semibold border-b-2 transition-colors ${v==="employee"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:"Employee Details"})]})})}),v==="overview"&&M&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Email Activities"}),t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:o.summary.byChannel.email.toLocaleString()}),t.jsxs("div",{className:"text-xs text-gray-500",children:[(o.summary.byChannel.email/o.summary.totalActivities*100).toFixed(1),"% of total"]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Call Activities"}),t.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:o.summary.byChannel.call.toLocaleString()}),t.jsxs("div",{className:"text-xs text-gray-500",children:[(o.summary.byChannel.call/o.summary.totalActivities*100).toFixed(1),"% of total"]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"LinkedIn Activities"}),t.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:o.summary.byChannel.linkedin.toLocaleString()}),t.jsxs("div",{className:"text-xs text-gray-500",children:[(o.summary.byChannel.linkedin/o.summary.totalActivities*100).toFixed(1),"% of total"]})]})]}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Employee Activity Comparison"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(O1,{data:M.employeeComparison,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{padding:10,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12}},scales:{y:{beginAtZero:!0,ticks:{font:{size:11}},grid:{color:"rgba(0, 0, 0, 0.05)"}},x:{ticks:{font:{size:11}},grid:{display:!1}}}}})})})]})}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Performers"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Ranked by total activities"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Rank"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Employee"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Total Activities"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Call"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"LinkedIn"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Projects"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.topPerformers.map((P,G)=>t.jsxs("tr",{className:G<3?"bg-gradient-to-r from-amber-50 to-yellow-50":"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"flex items-center",children:G<3?t.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-amber-500 text-white font-bold text-sm",children:G+1}):t.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["#",G+1]})})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:P.name}),t.jsx("div",{className:"text-sm text-gray-500",children:P.email})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:P.totalActivities.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-blue-600",children:P.byChannel.email.total.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-green-600",children:P.byChannel.call.total.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-purple-600",children:P.byChannel.linkedin.total.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-gray-900",children:P.projects.length})})]},P.userId))})]})})]})]}),v==="employee"&&L&&F&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Select Employee"}),t.jsx("select",{value:e,onChange:P=>m(P.target.value),className:"w-full md:w-80 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm font-medium",children:o.employees.map(P=>t.jsxs("option",{value:P.userId,children:[P.name," (",P.email,")"]},P.userId))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-blue-700 mb-2",children:"Total Activities"}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:L.totalActivities.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-blue-700 mb-2",children:"Email Activities"}),t.jsx("div",{className:"text-3xl font-bold text-blue-600",children:L.byChannel.email.total.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-green-700 mb-2",children:"Call Activities"}),t.jsx("div",{className:"text-3xl font-bold text-green-600",children:L.byChannel.call.total.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-purple-700 mb-2",children:"LinkedIn Activities"}),t.jsx("div",{className:"text-3xl font-bold text-purple-600",children:L.byChannel.linkedin.total.toLocaleString()})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Channel Distribution"}),t.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-4 text-center",children:[t.jsx("div",{className:"text-xs font-medium text-blue-700 mb-1",children:"Email"}),t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:L.byChannel.email.total.toLocaleString()}),t.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[L.totalActivities>0?(L.byChannel.email.total/L.totalActivities*100).toFixed(1):0,"%"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-lg p-4 text-center",children:[t.jsx("div",{className:"text-xs font-medium text-green-700 mb-1",children:"Call"}),t.jsx("div",{className:"text-2xl font-bold text-green-600",children:L.byChannel.call.total.toLocaleString()}),t.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[L.totalActivities>0?(L.byChannel.call.total/L.totalActivities*100).toFixed(1):0,"%"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-lg p-4 text-center",children:[t.jsx("div",{className:"text-xs font-medium text-purple-700 mb-1",children:"LinkedIn"}),t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:L.byChannel.linkedin.total.toLocaleString()}),t.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:[L.totalActivities>0?(L.byChannel.linkedin.total/L.totalActivities*100).toFixed(1):0,"%"]})]})]}),t.jsx("div",{className:"mb-6",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(O1,{data:{labels:["Email","Call","LinkedIn"],datasets:[{label:"Activities",data:[L.byChannel.email.total,L.byChannel.call.total,L.byChannel.linkedin.total],backgroundColor:["#3B82F6","#10B981","#8B5CF6"],borderRadius:8,borderSkipped:!1}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,callbacks:{label:function(P){const G=L.totalActivities,ae=P.parsed.x,re=G>0?(ae/G*100).toFixed(1):0;return`${ae.toLocaleString()} activities (${re}%)`}}}},scales:{x:{beginAtZero:!0,ticks:{callback:function(P){return P.toLocaleString()}},grid:{color:"rgba(0, 0, 0, 0.05)"}},y:{grid:{display:!1}}}}})})})}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(h7,{data:F.channelDistribution,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,callbacks:{label:function(P){const G=L.totalActivities,ae=P.parsed,re=G>0?(ae/G*100).toFixed(1):0;return`${P.label}: ${ae.toLocaleString()} (${re}%)`}}}}}})})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Email Status"}),t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(P1,{data:F.emailStatus,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:8,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:10}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Call Status"}),t.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(P1,{data:F.callStatus,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:8,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:10}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"LinkedIn Status"}),t.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})})]}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(P1,{data:F.linkedinStatus,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:8,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:10}}}})})})]})]}),L.byProject.length>0&&t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Activity by Project"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(O1,{data:F.projectPerformance,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{padding:10,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12}},scales:{y:{beginAtZero:!0,ticks:{font:{size:11}},grid:{color:"rgba(0, 0, 0, 0.05)"}},x:{ticks:{font:{size:11}},grid:{display:!1}}}}})})})]}),L.projects.length>0&&t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Assigned Projects"})}),t.jsx("div",{className:"divide-y divide-gray-200",children:L.projects.map(P=>t.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>l(`/projects/${P.id}`),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-gray-900",children:P.companyName}),t.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[P.isCreator&&t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-blue-100 text-blue-800 text-xs font-medium mr-2",children:"Creator"}),P.isTeamMember&&t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-green-100 text-green-800 text-xs font-medium",children:"Team Member"})]})]}),t.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},P.id))})]})]})]})})}function g7(){const{id:l}=ci(),n=Fr(),a=e=>{n(e==="linkedin"?`/projects/${l}/linkedin-funnel`:e==="cold-calling"?`/projects/${l}/cold-calling-funnel`:e==="email"?`/projects/${l}/email-funnel`:`/projects/${l}?funnel=${e}`)},o=[{id:"cold-calling",title:"Cold Calling",description:"Manage phone outreach and call activities",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),color:"green",accentColor:"emerald"},{id:"email",title:"Email",description:"Track email campaigns and responses",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),color:"blue",accentColor:"blue"},{id:"linkedin",title:"LinkedIn",description:"Manage LinkedIn connections and messages",icon:t.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),color:"indigo",accentColor:"indigo"}],s=(e,m)=>{const v={green:{bg:"bg-emerald-50",border:"border-emerald-200",hoverBorder:"hover:border-emerald-300",iconBg:"bg-emerald-100",iconColor:"text-emerald-600",title:"text-gray-900",description:"text-gray-600",hoverBg:"hover:bg-emerald-50",hoverShadow:"hover:shadow-lg"},blue:{bg:"bg-blue-50",border:"border-blue-200",hoverBorder:"hover:border-blue-300",iconBg:"bg-blue-100",iconColor:"text-blue-600",title:"text-gray-900",description:"text-gray-600",hoverBg:"hover:bg-blue-50",hoverShadow:"hover:shadow-lg"},indigo:{bg:"bg-indigo-50",border:"border-indigo-200",hoverBorder:"hover:border-indigo-300",iconBg:"bg-indigo-100",iconColor:"text-indigo-600",title:"text-gray-900",description:"text-gray-600",hoverBg:"hover:bg-indigo-50",hoverShadow:"hover:shadow-lg"}};return v[e]||v.blue};return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-12",children:[t.jsxs("div",{className:"mb-12",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 mb-8 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("h1",{className:"text-3xl font-semibold text-gray-900 tracking-tight mb-3",children:"Sales Report"}),t.jsx("div",{className:"w-16 h-0.5 bg-gradient-to-r from-emerald-500 via-blue-500 to-indigo-500 rounded-full"})]}),t.jsx("p",{className:"text-base text-gray-600 mt-4",children:"Select a channel to view and manage prospects"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl",children:o.map(e=>{const m=s(e.color,e.accentColor);return t.jsxs("button",{onClick:()=>a(e.id),className:`group relative bg-white border-2 ${m.border} ${m.hoverBorder} rounded-xl p-8 text-left transition-all duration-200 ${m.hoverBg} ${m.hoverShadow} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-${e.accentColor}-500`,children:[t.jsx("div",{className:`w-14 h-14 ${m.iconBg} rounded-lg flex items-center justify-center mb-5 ${m.iconColor} transition-colors duration-200`,children:e.icon}),t.jsxs("div",{children:[t.jsx("h3",{className:`text-xl font-semibold ${m.title} mb-2`,children:e.title}),t.jsx("p",{className:`text-sm ${m.description} leading-relaxed`,children:e.description})]}),t.jsx("div",{className:"absolute bottom-6 right-6 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:t.jsx("svg",{className:`w-5 h-5 ${m.iconColor}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]},e.id)})})]})})}const jv="label";function Mb(l,n){typeof l=="function"?l(n):l&&(l.current=n)}function p7(l,n){const a=l.options;a&&n&&Object.assign(a,n)}function Nv(l,n){l.labels=n}function kv(l,n,a=jv){const o=[];l.datasets=n.map(s=>{const e=l.datasets.find(m=>m[a]===s[a]);return!e||!s.data||o.includes(e)?{...s}:(o.push(e),Object.assign(e,s),e)})}function x7(l,n=jv){const a={labels:[],datasets:[]};return Nv(a,l.labels),kv(a,l.datasets,n),a}function b7(l,n){return l.getElementsAtEventForMode(n.nativeEvent,"dataset",{intersect:!0},!1)}function y7(l,n){return l.getElementsAtEventForMode(n.nativeEvent,"nearest",{intersect:!0},!1)}function v7(l,n){return l.getElementsAtEventForMode(n.nativeEvent,"index",{intersect:!0},!1)}function w7(l,n){const{height:a=150,width:o=300,redraw:s=!1,datasetIdKey:e,type:m,data:v,options:w,plugins:N=[],fallbackContent:S,updateMode:D,...L}=l,M=B.useRef(null),F=B.useRef(null),O=()=>{M.current&&(F.current=new cl(M.current,{type:m,data:x7(v,e),options:w&&{...w},plugins:N}),Mb(n,F.current))},P=()=>{Mb(n,null),F.current&&(F.current.destroy(),F.current=null)};return B.useEffect(()=>{!s&&F.current&&w&&p7(F.current,w)},[s,w]),B.useEffect(()=>{!s&&F.current&&Nv(F.current.config.data,v.labels)},[s,v.labels]),B.useEffect(()=>{!s&&F.current&&v.datasets&&kv(F.current.config.data,v.datasets,e)},[s,v.datasets]),B.useEffect(()=>{F.current&&(s?(P(),setTimeout(O)):F.current.update(D))},[s,w,v.labels,v.datasets,D]),B.useEffect(()=>{F.current&&(P(),setTimeout(O))},[m]),B.useEffect(()=>(O(),()=>P()),[]),t.jsx("canvas",{ref:M,role:"img",height:a,width:o,...L,children:S})}const Cv=B.forwardRef(w7);function qc(l,n){return cl.register(n),B.forwardRef((a,o)=>t.jsx(Cv,{...a,ref:o,type:l}))}const r0=qc("line",x6),a0=qc("bar",m6),j7=qc("radar",v6),N7=qc("doughnut",rv),k7=qc("polarArea",b6),C7=qc("bubble",g6),S7=qc("pie",y6),A7=qc("scatter",w6),Ta=Object.freeze(Object.defineProperty({__proto__:null,Bar:a0,Bubble:C7,Chart:Cv,Doughnut:N7,Line:r0,Pie:S7,PolarArea:k7,Radar:j7,Scatter:A7,getDatasetAtEvent:b7,getElementAtEvent:y7,getElementsAtEvent:v7},Symbol.toStringTag,{value:"Module"}));cl.register(Wc,$c,Bc,dl,zc,Hc,Vc,Uc,Ip);function E7(){const{id:l}=ci(),n=Fr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({}),[L,M]=B.useState(null),[F,O]=B.useState("month");B.useEffect(()=>{l&&P()},[l]),B.useEffect(()=>{const be=()=>{l&&!w&&P()};return window.addEventListener("focus",be),()=>window.removeEventListener("focus",be)},[l,w]);const P=async()=>{try{N(!0);const be=await Ht.get(`/projects/${l}`);be.data.success&&o(be.data.data);const oe=await Ht.get(`/activities/project/${l}?limit=10000`);if(oe.data.success){const Te=(oe.data.data||[]).filter(fe=>fe.type==="linkedin");e(Te)}const he=await Ht.get(`/projects/${l}/project-contacts`);he.data.success&&v(he.data.data||[]),M(new Date)}catch(be){console.error("Error fetching data:",be)}finally{N(!1)}};B.useEffect(()=>{(s.length>0||m.length>0)&&xe()},[s,m,F]);const G=be=>{const oe=new Date(be),he=oe.toLocaleString("default",{month:"short"}),ye=oe.getFullYear().toString().slice(-2);return`${he} '${ye}`},ae=be=>new Date(be).getFullYear().toString(),re=()=>{const be=new Set;return s.forEach(he=>{he.createdAt&&be.add(G(he.createdAt))}),m.forEach(he=>{he.createdAt&&be.add(G(he.createdAt))}),Array.from(be).sort((he,ye)=>{const[Te,fe]=he.split(" '"),[_e,We]=ye.split(" '"),se=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],me=se.indexOf(Te),W=se.indexOf(_e);return fe!==We?parseInt(fe)-parseInt(We):me-W})},Ne=()=>{const be=new Set;return s.forEach(oe=>{oe.createdAt&&be.add(ae(oe.createdAt))}),m.forEach(oe=>{oe.createdAt&&be.add(ae(oe.createdAt))}),Array.from(be).sort((oe,he)=>parseInt(oe)-parseInt(he))},xe=()=>{const be=F==="month"?re():Ne(),oe={};be.forEach(fe=>{oe[fe]={dataResearch:0,connectionRequestSent:0,connectionAccepted:0,firstMessageSent:0,followupMessagesSent:0,existingConnection:0,conversationsInProgress:0,meetingProposed:0,meetingScheduled:0,meetingCompleted:0}}),m.forEach(fe=>{if(fe.createdAt){const _e=F==="month"?G(fe.createdAt):ae(fe.createdAt);oe[_e]&&oe[_e].dataResearch++}});const he={};s.forEach(fe=>{if(!fe.createdAt)return;const _e=fe.contactId?.toString()||"unknown";he[_e]||(he[_e]=[]),he[_e].push(fe)}),s.forEach(fe=>{const _e=fe.linkedinDate?new Date(fe.linkedinDate):fe.createdAt?new Date(fe.createdAt):null;if(!_e)return;const We=F==="month"?G(_e):ae(_e);if(!oe[We])return;const se=fe.template?.trim()||"";(fe.lnRequestSent==="Yes"||se==="introduction-message")&&oe[We].connectionRequestSent++,fe.lnRequestSent==="Existing Connect"&&oe[We].existingConnection++,fe.connected==="Yes"&&oe[We].connectionAccepted++,fe.status==="CIP"?oe[We].conversationsInProgress++:fe.status==="Meeting Proposed"?oe[We].meetingProposed++:fe.status==="Meeting Scheduled"?oe[We].meetingScheduled++:fe.status==="Meeting Completed"&&oe[We].meetingCompleted++});const ye={},Te={};s.forEach(fe=>{const _e=fe.linkedinDate?new Date(fe.linkedinDate):fe.createdAt?new Date(fe.createdAt):null;if(!_e)return;const We=F==="month"?G(_e):ae(_e);if(!oe[We])return;ye[We]||(ye[We]=new Set),Te[We]||(Te[We]=new Set);const se=fe.contactId?.toString()||"unknown",me=fe.template?.trim()||"";me==="introduction-message"&&ye[We].add(se),me==="follow-up-message"&&Te[We].add(se)}),Object.keys(oe).forEach(fe=>{ye[fe]&&(oe[fe].firstMessageSent=ye[fe].size),Te[fe]&&(oe[fe].followupMessagesSent=Te[fe].size)}),D(oe)},we=[{key:"dataResearch",label:"Data Research manually",section:"DRA"},{key:"connectionRequestSent",label:"Connection Request Sent",section:"DRA"},{key:"connectionAccepted",label:"Connection Accepted",section:"DRA"},{key:"firstMessageSent",label:"First Message Sent",section:"DRA"},{key:"followupMessagesSent",label:"Followup Messages sent",section:"DRA"},{key:"existingConnection",label:"Existing Connection",section:"Linked IN"},{key:"conversationsInProgress",label:"Conversations in Progress",section:"Linked IN",highlight:!0},{key:"meetingProposed",label:"Meeting Proposed",section:"Linked IN",highlight:!0},{key:"meetingScheduled",label:"Meeting Scheduled",section:"Linked IN",highlight:!0},{key:"meetingCompleted",label:"Meeting Completed",section:"Linked IN",highlight:!0}],Z=F==="month"?re():Ne(),ce=B.useMemo(()=>{const be=Z;return{connectionFunnel:{labels:be,datasets:[{label:"Connection Request Sent",data:be.map(oe=>S[oe]?.connectionRequestSent||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0},{label:"Connection Accepted",data:be.map(oe=>S[oe]?.connectionAccepted||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0}]},messageActivity:{labels:be,datasets:[{label:"First Message Sent",data:be.map(oe=>S[oe]?.firstMessageSent||0),borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4,fill:!0},{label:"Followup Messages",data:be.map(oe=>S[oe]?.followupMessagesSent||0),borderColor:"rgb(236, 72, 153)",backgroundColor:"rgba(236, 72, 153, 0.1)",tension:.4,fill:!0}]},meetingPipeline:{labels:be,datasets:[{label:"Meeting Proposed",data:be.map(oe=>S[oe]?.meetingProposed||0),backgroundColor:"rgba(251, 191, 36, 0.8)"},{label:"Meeting Scheduled",data:be.map(oe=>S[oe]?.meetingScheduled||0),backgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Meeting Completed",data:be.map(oe=>S[oe]?.meetingCompleted||0),backgroundColor:"rgba(34, 197, 94, 0.8)"}]},conversationsStatus:{labels:be,datasets:[{label:"Conversations in Progress",data:be.map(oe=>S[oe]?.conversationsInProgress||0),backgroundColor:"rgba(34, 197, 94, 0.8)"}]}}},[Z,S]),ue={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"600"},bodyFont:{size:13},cornerRadius:8,displayColors:!0}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}},x:{grid:{display:!1},ticks:{font:{size:11}}}}},Le={...ue,scales:{...ue.scales,x:{...ue.scales.x,stacked:!0},y:{...ue.scales.y,stacked:!0}}};return w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading report..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}/funnel`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Sales Report"]}),t.jsxs("button",{onClick:P,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh data",children:[t.jsx("svg",{className:`w-4 h-4 ${w?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:[F==="month"?"Monthly":"Yearly"," Report - ",a?.companyName||"Project"]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[L&&t.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",L.toLocaleTimeString()]}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>O("month"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Monthly"}),t.jsx("button",{onClick:()=>O("year"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="year"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Yearly"})]})]})]})})]}),Z.length>0&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Connection Funnel"}),t.jsx("div",{className:"h-64",children:t.jsx(r0,{data:ce.connectionFunnel,options:ue})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Message Activity"}),t.jsx("div",{className:"h-64",children:t.jsx(r0,{data:ce.messageActivity,options:ue})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Meeting Pipeline"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:ce.meetingPipeline,options:Le})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conversations in Progress"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:ce.conversationsStatus,options:ue})})]})]}),t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200",children:"Key Results"}),Z.map(be=>t.jsxs("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200 last:border-r-0",children:[t.jsx("div",{children:be}),t.jsx("div",{className:"text-xs font-normal text-gray-500 mt-1",children:"Progress"})]},be))]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:["DRA","Linked IN"].map(be=>t.jsx(Lo.Fragment,{children:we.filter(oe=>oe.section===be).map((oe,he)=>t.jsxs("tr",{className:oe.highlight?"bg-green-50":"hover:bg-gray-50",children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border-r border-gray-200 ${oe.highlight?"font-semibold":""}`,children:oe.label}),Z.map(ye=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${oe.highlight?"font-semibold text-gray-900":"text-gray-700"}`,children:S[ye]?.[oe.key]||0},ye))]},oe.key))},be))})]})})})]})})}cl.register(Wc,$c,Bc,dl,zc,Hc,Vc,Uc,Ip);function D7(){const{id:l}=ci(),n=Fr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({}),[L,M]=B.useState(null),[F,O]=B.useState("day");B.useEffect(()=>{l&&P()},[l]),B.useEffect(()=>{const he=()=>{l&&!w&&P()};return window.addEventListener("focus",he),()=>window.removeEventListener("focus",he)},[l,w]);const P=async()=>{try{N(!0);const he=await Ht.get(`/projects/${l}`);he.data.success&&o(he.data.data);const ye=await Ht.get(`/activities/project/${l}?limit=10000`);if(ye.data.success){const _e=(ye.data.data||[]).filter(We=>We.type==="call");e(_e)}const Te=await Ht.get(`/projects/${l}/project-contacts`);Te.data.success&&v(Te.data.data||[]),M(new Date)}catch(he){console.error("Error fetching data:",he)}finally{N(!1)}};B.useEffect(()=>{(s.length>0||m.length>0)&&xe()},[s,m,F]);const G=he=>{const ye=new Date(he),Te=ye.getDate(),fe=ye.toLocaleString("default",{month:"short"}),_e=ye.getFullYear().toString().slice(-2);return`${Te} ${fe} '${_e}`},ae=he=>{const ye=new Date(he),Te=ye.toLocaleString("default",{month:"short"}),fe=ye.getFullYear().toString().slice(-2);return`${Te} '${fe}`},re=()=>{const he=new Set;return s.forEach(Te=>{const fe=Te.callDate?new Date(Te.callDate):new Date(Te.createdAt);fe&&he.add(G(fe))}),m.forEach(Te=>{Te.createdAt&&he.add(G(new Date(Te.createdAt)))}),Array.from(he).sort((Te,fe)=>{const _e=new Date(Te.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3")),We=new Date(fe.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3"));return _e-We})},Ne=()=>{const he=new Set;return s.forEach(Te=>{const fe=Te.callDate?new Date(Te.callDate):new Date(Te.createdAt);fe&&he.add(ae(fe))}),m.forEach(Te=>{Te.createdAt&&he.add(ae(new Date(Te.createdAt)))}),Array.from(he).sort((Te,fe)=>{const[_e,We]=Te.split(" '"),[se,me]=fe.split(" '"),W=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pe=W.indexOf(_e),Me=W.indexOf(se);return We!==me?parseInt(We)-parseInt(me):pe-Me})},xe=()=>{const he=F==="day"?re():Ne(),ye={};he.forEach(_e=>{ye[_e]={dataAllocated:0,interested:0,notInterested:0,ring:0,busy:0,hangUp:0,callBack:0,switchOff:0,detailsShared:0,future:0,invalid:0,demoBooked:0,followUps:0,totalCalls:0,freshCalls:0}}),m.forEach(_e=>{if(_e.createdAt){const We=F==="day"?G(new Date(_e.createdAt)):ae(new Date(_e.createdAt));ye[We]&&ye[We].dataAllocated++}});const Te=new Map,fe={};s.forEach(_e=>{const We=_e.callDate?new Date(_e.callDate):new Date(_e.createdAt);if(!We)return;const se=F==="day"?G(We):ae(We);if(!ye[se])return;const me=_e.contactId?.toString()||"unknown";_e.callNumber==="1st call"&&!Te.has(me)&&Te.set(me,se),fe[se]||(fe[se]={}),fe[se][me]||(fe[se][me]=[]),fe[se][me].push(_e)}),s.forEach(_e=>{const We=_e.callDate?new Date(_e.callDate):new Date(_e.createdAt);if(!We)return;const se=F==="day"?G(We):ae(We);if(ye[se]){if(_e.callStatus)switch(_e.callStatus){case"Interested":ye[se].interested++;break;case"Not Interested":ye[se].notInterested++;break;case"Ring":ye[se].ring++;break;case"Busy":ye[se].busy++;break;case"Hang Up":ye[se].hangUp++;break;case"Call Back":ye[se].callBack++;break;case"Switch Off":ye[se].switchOff++;break;case"Details Shared":ye[se].detailsShared++;break;case"Future":ye[se].future++;break;case"Invalid":ye[se].invalid++;break;case"Demo Booked":ye[se].demoBooked++;break}ye[se].totalCalls++}}),Object.keys(fe).forEach(_e=>{const We=fe[_e];let se=0,me=0;Object.keys(We).forEach(W=>{const pe=We[W],Me=Te.get(W);pe.forEach(Se=>{Se.callNumber==="1st call"||Me===_e&&!Se.callNumber?se++:me++})}),ye[_e]&&(ye[_e].freshCalls=se,ye[_e].followUps=me)}),D(ye)},we=[{key:"dataAllocated",label:"Data Allocated",section:"DRA",bold:!1},{key:"interested",label:"Interested",section:"DRA",bold:!0},{key:"notInterested",label:"Not Interested",section:"DRA",bold:!0},{key:"ring",label:"Ring",section:"DRA",bold:!1},{key:"busy",label:"Busy",section:"DRA",bold:!1,highlight:!0},{key:"hangUp",label:"Hang Up",section:"DRA",bold:!1},{key:"callBack",label:"Call Back",section:"DRA",bold:!1},{key:"switchOff",label:"Switch Off",section:"DRA",bold:!1},{key:"detailsShared",label:"Detailed Shared",section:"Cold Calling",bold:!0,highlight:!0},{key:"future",label:"Future",section:"Cold Calling",bold:!1},{key:"invalid",label:"Invalid",section:"Cold Calling",bold:!1},{key:"demoBooked",label:"Demo Booked",section:"Cold Calling",bold:!0,highlight:!0,highlightDark:!0},{key:"followUps",label:"Follow Ups",section:"Cold Calling",bold:!0},{key:"totalCalls",label:"Total Calls",section:"Cold Calling",bold:!0},{key:"freshCalls",label:"(Fresh Calls + FollowUpS)",section:"Cold Calling",bold:!1,isFormula:!0}],Z=F==="day"?re():Ne(),ce=B.useMemo(()=>{const he=Z;return{draMetrics:{labels:he,datasets:[{label:"Interested",data:he.map(ye=>S[ye]?.interested||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0},{label:"Not Interested",data:he.map(ye=>S[ye]?.notInterested||0),borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",tension:.4,fill:!0}]},callStatusBreakdown:{labels:he,datasets:[{label:"Ring",data:he.map(ye=>S[ye]?.ring||0),backgroundColor:"rgba(156, 163, 175, 0.8)"},{label:"Busy",data:he.map(ye=>S[ye]?.busy||0),backgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Call Back",data:he.map(ye=>S[ye]?.callBack||0),backgroundColor:"rgba(168, 85, 247, 0.8)"}]},coldCallingMetrics:{labels:he,datasets:[{label:"Details Shared",data:he.map(ye=>S[ye]?.detailsShared||0),borderColor:"rgb(251, 191, 36)",backgroundColor:"rgba(251, 191, 36, 0.1)",tension:.4,fill:!0},{label:"Demo Booked",data:he.map(ye=>S[ye]?.demoBooked||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0}]},callVolume:{labels:he,datasets:[{label:"Total Calls",data:he.map(ye=>S[ye]?.totalCalls||0),backgroundColor:"rgba(34, 197, 94, 0.8)"},{label:"Fresh Calls",data:he.map(ye=>S[ye]?.freshCalls||0),backgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Follow Ups",data:he.map(ye=>S[ye]?.followUps||0),backgroundColor:"rgba(168, 85, 247, 0.8)"}]}}},[Z,S]),ue={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"600"},bodyFont:{size:13},cornerRadius:8,displayColors:!0}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}},x:{grid:{display:!1},ticks:{font:{size:11}}}}},Le={...ue,scales:{...ue.scales,x:{...ue.scales.x,stacked:!0},y:{...ue.scales.y,stacked:!0}}};if(w)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading report..."})]})});const be=we.filter(he=>he.section==="DRA"),oe=we.filter(he=>he.section==="Cold Calling");return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}/funnel`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Sales Report"]}),t.jsxs("button",{onClick:P,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh data",children:[t.jsx("svg",{className:`w-4 h-4 ${w?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:[F==="day"?"Daily":"Monthly"," Report - ",a?.companyName||"Project"]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[L&&t.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",L.toLocaleTimeString()]}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>O("day"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="day"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Daily"}),t.jsx("button",{onClick:()=>O("month"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Monthly"})]})]})]})})]}),Z.length>0&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"DRA Metrics"}),t.jsx("div",{className:"h-64",children:t.jsx(r0,{data:ce.draMetrics,options:ue})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Call Status Breakdown"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:ce.callStatusBreakdown,options:Le})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cold Calling Metrics"}),t.jsx("div",{className:"h-64",children:t.jsx(r0,{data:ce.coldCallingMetrics,options:ue})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Call Volume"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:ce.callVolume,options:Le})})]})]}),Z.length>0&&t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200",children:"Key Results"}),Z.map(he=>t.jsxs("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200 last:border-r-0 bg-blue-50",children:[t.jsx("div",{children:he}),t.jsx("div",{className:"text-xs font-normal text-gray-500 mt-1",children:"Progress"})]},he))]})}),t.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.jsx("tr",{children:t.jsx("td",{colSpan:Z.length+1,className:"px-6 py-3 bg-yellow-100 border-b-2 border-yellow-200",children:t.jsx("span",{className:"text-sm font-bold text-gray-900",children:"DRA"})})}),be.map(he=>t.jsxs("tr",{className:`${he.highlight?"bg-green-50":"hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm border-r border-gray-200 ${he.bold?"font-bold text-gray-900":"text-gray-700"} ${he.highlightDark?"bg-green-100":""}`,children:he.label}),Z.map(ye=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${he.bold?"font-semibold text-gray-900":"text-gray-700"}`,children:he.isFormula?`(${S[ye]?.freshCalls||0} + ${S[ye]?.followUps||0})`:S[ye]?.[he.key]||0},ye))]},he.key)),t.jsx("tr",{children:t.jsx("td",{colSpan:Z.length+1,className:"px-6 py-3 bg-yellow-100 border-b-2 border-yellow-200",children:t.jsx("span",{className:"text-sm font-bold text-gray-900",children:"Cold Calling"})})}),oe.map(he=>t.jsxs("tr",{className:`${he.highlight?he.highlightDark?"bg-green-200":"bg-green-50":"hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm border-r border-gray-200 ${he.bold?"font-bold text-gray-900":"text-gray-700"} ${he.highlightDark?"bg-green-200":""}`,children:he.label}),Z.map(ye=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${he.bold?"font-semibold text-gray-900":"text-gray-700"}`,children:he.isFormula?`(${S[ye]?.freshCalls||0} + ${S[ye]?.followUps||0})`:S[ye]?.[he.key]||0},ye))]},he.key))]})]})})}),Z.length===0&&!w&&t.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:t.jsx("p",{className:"text-gray-500",children:"No call activities found for this project."})})]})})}cl.register(Wc,$c,Bc,dl,zc,Hc,Vc,Uc,Ip);function T7(){const{id:l}=ci(),n=Fr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({}),[L,M]=B.useState(null),[F,O]=B.useState("month");B.useEffect(()=>{l&&P()},[l]),B.useEffect(()=>{const oe=()=>{l&&!w&&P()};return window.addEventListener("focus",oe),()=>window.removeEventListener("focus",oe)},[l,w]);const P=async()=>{try{N(!0);const oe=await Ht.get(`/projects/${l}`);oe.data.success&&o(oe.data.data);const he=await Ht.get(`/activities/project/${l}?limit=10000`);if(he.data.success){const fe=(he.data.data||[]).filter(_e=>_e.type==="email");e(fe)}const ye=await Ht.get(`/projects/${l}/project-contacts`);ye.data.success&&v(ye.data.data||[]),M(new Date)}catch(oe){console.error("Error fetching data:",oe)}finally{N(!1)}};B.useEffect(()=>{(s.length>0||m.length>0)&&xe()},[s,m,F]);const G=oe=>{const he=new Date(oe),ye=he.toLocaleString("default",{month:"short"}),Te=he.getFullYear().toString().slice(-2);return`${ye} '${Te}`},ae=oe=>new Date(oe).getFullYear().toString(),re=()=>{const oe=new Set;return s.forEach(ye=>{ye.createdAt&&oe.add(G(ye.createdAt))}),m.forEach(ye=>{ye.createdAt&&oe.add(G(new Date(ye.createdAt)))}),Array.from(oe).sort((ye,Te)=>{const[fe,_e]=ye.split(" '"),[We,se]=Te.split(" '"),me=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],W=me.indexOf(fe),pe=me.indexOf(We);return _e!==se?parseInt(_e)-parseInt(se):W-pe})},Ne=()=>{const oe=new Set;return s.forEach(ye=>{ye.createdAt&&oe.add(ae(ye.createdAt))}),m.forEach(ye=>{ye.createdAt&&oe.add(ae(new Date(ye.createdAt)))}),Array.from(oe).sort((ye,Te)=>parseInt(ye)-parseInt(Te))},xe=()=>{const oe=F==="month"?re():Ne(),he={};oe.forEach(ye=>{he[ye]={emailsSent:0,noReply:0,notInterested:0,outOfOffice:0,meetingProposed:0,meetingScheduled:0,interested:0,wrongPerson:0,bounce:0,optOut:0,meetingCompleted:0,totalResponses:0,responseRate:0,openRate:0,clickRate:0}}),s.forEach(ye=>{if(ye.createdAt){const Te=F==="month"?G(ye.createdAt):ae(ye.createdAt);he[Te]&&he[Te].emailsSent++}}),s.forEach(ye=>{if(ye.createdAt&&ye.status){const Te=F==="month"?G(ye.createdAt):ae(ye.createdAt);if(!he[Te])return;switch(ye.status){case"No Reply":he[Te].noReply++;break;case"Not Interested":he[Te].notInterested++,he[Te].totalResponses++;break;case"Out of Office":he[Te].outOfOffice++,he[Te].totalResponses++;break;case"Meeting Proposed":he[Te].meetingProposed++,he[Te].totalResponses++;break;case"Meeting Scheduled":he[Te].meetingScheduled++,he[Te].totalResponses++;break;case"Interested":he[Te].interested++,he[Te].totalResponses++;break;case"Wrong Person":he[Te].wrongPerson++,he[Te].totalResponses++;break;case"Bounce":he[Te].bounce++;break;case"Opt-Out":he[Te].optOut++,he[Te].totalResponses++;break;case"Meeting Completed":he[Te].meetingCompleted++,he[Te].totalResponses++;break}}}),oe.forEach(ye=>{he[ye].emailsSent>0&&(he[ye].responseRate=(he[ye].totalResponses/he[ye].emailsSent*100).toFixed(1))}),D(he)},we=[{key:"emailsSent",label:"Emails Sent",section:"Email Activity",bold:!0},{key:"noReply",label:"No Reply",section:"Email Activity",bold:!1},{key:"notInterested",label:"Not Interested",section:"Email Activity",bold:!1},{key:"outOfOffice",label:"Out of Office",section:"Email Activity",bold:!1},{key:"meetingProposed",label:"Meeting Proposed",section:"Email Activity",bold:!0,highlight:!0},{key:"meetingScheduled",label:"Meeting Scheduled",section:"Email Activity",bold:!0,highlight:!0},{key:"interested",label:"Interested",section:"Email Activity",bold:!0,highlight:!0},{key:"wrongPerson",label:"Wrong Person",section:"Email Activity",bold:!1},{key:"bounce",label:"Bounce",section:"Email Activity",bold:!1},{key:"optOut",label:"Opt-Out",section:"Email Activity",bold:!1},{key:"meetingCompleted",label:"Meeting Completed",section:"Email Activity",bold:!0,highlight:!0,highlightDark:!0},{key:"totalResponses",label:"Total Responses",section:"Email Activity",bold:!0},{key:"responseRate",label:"Response Rate (%)",section:"Email Activity",bold:!0,isPercentage:!0}],Z=F==="month"?re():Ne(),ce=B.useMemo(()=>{const oe=Z;return{emailFunnel:{labels:oe,datasets:[{label:"Emails Sent",data:oe.map(he=>S[he]?.emailsSent||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0},{label:"Total Responses",data:oe.map(he=>S[he]?.totalResponses||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0}]},responseBreakdown:{labels:oe,datasets:[{label:"No Reply",data:oe.map(he=>S[he]?.noReply||0),backgroundColor:"rgba(156, 163, 175, 0.8)"},{label:"Not Interested",data:oe.map(he=>S[he]?.notInterested||0),backgroundColor:"rgba(239, 68, 68, 0.8)"},{label:"Interested",data:oe.map(he=>S[he]?.interested||0),backgroundColor:"rgba(34, 197, 94, 0.8)"},{label:"Meeting Proposed",data:oe.map(he=>S[he]?.meetingProposed||0),backgroundColor:"rgba(251, 191, 36, 0.8)"},{label:"Meeting Scheduled",data:oe.map(he=>S[he]?.meetingScheduled||0),backgroundColor:"rgba(6, 182, 212, 0.8)"}]},meetingPipeline:{labels:oe,datasets:[{label:"Meeting Proposed",data:oe.map(he=>S[he]?.meetingProposed||0),backgroundColor:"rgba(251, 191, 36, 0.8)"},{label:"Meeting Scheduled",data:oe.map(he=>S[he]?.meetingScheduled||0),backgroundColor:"rgba(6, 182, 212, 0.8)"},{label:"Meeting Completed",data:oe.map(he=>S[he]?.meetingCompleted||0),backgroundColor:"rgba(34, 197, 94, 0.8)"}]},responseRate:{labels:oe,datasets:[{label:"Response Rate (%)",data:oe.map(he=>parseFloat(S[he]?.responseRate||0)),borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4,fill:!0}]}}},[Z,S]),ue={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"600"},bodyFont:{size:13},cornerRadius:8,displayColors:!0}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}},x:{grid:{display:!1},ticks:{font:{size:11}}}}},Le={...ue,scales:{...ue.scales,x:{...ue.scales.x,stacked:!0},y:{...ue.scales.y,stacked:!0}}};if(w)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading report..."})]})});const be=we.filter(oe=>oe.section==="Email Activity");return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}/funnel`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Sales Report"]}),t.jsxs("button",{onClick:P,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh data",children:[t.jsx("svg",{className:`w-4 h-4 ${w?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:[F==="month"?"Monthly":"Yearly"," Email Report - ",a?.companyName||"Project"]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[L&&t.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",L.toLocaleTimeString()]}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>O("month"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Monthly"}),t.jsx("button",{onClick:()=>O("year"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="year"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Yearly"})]})]})]})})]}),Z.length>0&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Funnel"}),t.jsx("div",{className:"h-64",children:t.jsx(r0,{data:ce.emailFunnel,options:ue})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Response Breakdown"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:ce.responseBreakdown,options:Le})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Meeting Pipeline"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:ce.meetingPipeline,options:Le})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Response Rate"}),t.jsx("div",{className:"h-64",children:t.jsx(r0,{data:ce.responseRate,options:ue})})]})]}),Z.length>0&&t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200",children:"Key Results"}),Z.map(oe=>t.jsxs("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200 last:border-r-0 bg-blue-50",children:[t.jsx("div",{children:oe}),t.jsx("div",{className:"text-xs font-normal text-gray-500 mt-1",children:"Progress"})]},oe))]})}),t.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.jsx("tr",{children:t.jsx("td",{colSpan:Z.length+1,className:"px-6 py-3 bg-yellow-100 border-b-2 border-yellow-200",children:t.jsx("span",{className:"text-sm font-bold text-gray-900",children:"Email Activity"})})}),be.map(oe=>t.jsxs("tr",{className:`${oe.highlight?oe.highlightDark?"bg-green-200":"bg-green-50":"hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm border-r border-gray-200 ${oe.bold?"font-bold text-gray-900":"text-gray-700"} ${oe.highlightDark?"bg-green-200":""}`,children:oe.label}),Z.map(he=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${oe.bold?"font-semibold text-gray-900":"text-gray-700"}`,children:oe.isPercentage?`${S[he]?.[oe.key]||0}%`:S[he]?.[oe.key]||0},he))]},oe.key))]})]})})}),Z.length===0&&!w&&t.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:t.jsx("p",{className:"text-gray-500",children:"No email activities found for this project."})})]})})}function fp(l){throw new Error('Could not dynamically require "'+l+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var np={exports:{}},mp={exports:{}};var _7=mp.exports,Lb;function F7(){return Lb||(Lb=1,(function(l){var n={version:"1.15.0"};n[437]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[620]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[737]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[850]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[852]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[857]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[861]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[865]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[866]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[874]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[895]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[932]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(o[s[129][e]]=33024+e,a[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(o[s[130][e]]=33280+e,a[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(o[s[131][e]]=33536+e,a[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(o[s[132][e]]=33792+e,a[33792+e]=s[132][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(o[s[135][e]]=34560+e,a[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(o[s[136][e]]=34816+e,a[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(o[s[137][e]]=35072+e,a[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(o[s[138][e]]=35328+e,a[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(o[s[139][e]]=35584+e,a[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(o[s[140][e]]=35840+e,a[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(o[s[141][e]]=36096+e,a[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(o[s[142][e]]=36352+e,a[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(o[s[143][e]]=36608+e,a[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(o[s[144][e]]=36864+e,a[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(o[s[145][e]]=37120+e,a[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(o[s[146][e]]=37376+e,a[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(o[s[147][e]]=37632+e,a[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(o[s[148][e]]=37888+e,a[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(o[s[149][e]]=38144+e,a[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(o[s[150][e]]=38400+e,a[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(o[s[151][e]]=38656+e,a[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(o[s[152][e]]=38912+e,a[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(o[s[153][e]]=39168+e,a[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(o[s[154][e]]=39424+e,a[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(o[s[155][e]]=39680+e,a[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(o[s[156][e]]=39936+e,a[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(o[s[157][e]]=40192+e,a[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(o[s[158][e]]=40448+e,a[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(o[s[159][e]]=40704+e,a[40704+e]=s[159][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(o[s[250][e]]=64e3+e,a[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(o[s[251][e]]=64256+e,a[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(o[s[252][e]]=64512+e,a[64512+e]=s[252][e]);return{enc:o,dec:a}})(),n[936]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(o[s[129][e]]=33024+e,a[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(o[s[130][e]]=33280+e,a[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(o[s[131][e]]=33536+e,a[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(o[s[132][e]]=33792+e,a[33792+e]=s[132][e]);for(s[133]="".split(""),e=0;e!=s[133].length;++e)s[133][e].charCodeAt(0)!==65533&&(o[s[133][e]]=34048+e,a[34048+e]=s[133][e]);for(s[134]="".split(""),e=0;e!=s[134].length;++e)s[134][e].charCodeAt(0)!==65533&&(o[s[134][e]]=34304+e,a[34304+e]=s[134][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(o[s[135][e]]=34560+e,a[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(o[s[136][e]]=34816+e,a[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(o[s[137][e]]=35072+e,a[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(o[s[138][e]]=35328+e,a[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(o[s[139][e]]=35584+e,a[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(o[s[140][e]]=35840+e,a[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(o[s[141][e]]=36096+e,a[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(o[s[142][e]]=36352+e,a[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(o[s[143][e]]=36608+e,a[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(o[s[144][e]]=36864+e,a[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(o[s[145][e]]=37120+e,a[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(o[s[146][e]]=37376+e,a[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(o[s[147][e]]=37632+e,a[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(o[s[148][e]]=37888+e,a[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(o[s[149][e]]=38144+e,a[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(o[s[150][e]]=38400+e,a[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(o[s[151][e]]=38656+e,a[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(o[s[152][e]]=38912+e,a[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(o[s[153][e]]=39168+e,a[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(o[s[154][e]]=39424+e,a[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(o[s[155][e]]=39680+e,a[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(o[s[156][e]]=39936+e,a[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(o[s[157][e]]=40192+e,a[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(o[s[158][e]]=40448+e,a[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(o[s[159][e]]=40704+e,a[40704+e]=s[159][e]);for(s[160]="".split(""),e=0;e!=s[160].length;++e)s[160][e].charCodeAt(0)!==65533&&(o[s[160][e]]=40960+e,a[40960+e]=s[160][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(o[s[170][e]]=43520+e,a[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(o[s[171][e]]=43776+e,a[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(o[s[172][e]]=44032+e,a[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(o[s[173][e]]=44288+e,a[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(o[s[174][e]]=44544+e,a[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(o[s[175][e]]=44800+e,a[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(o[s[199][e]]=50944+e,a[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(o[s[200][e]]=51200+e,a[51200+e]=s[200][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(o[s[201][e]]=51456+e,a[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(o[s[248][e]]=63488+e,a[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(o[s[249][e]]=63744+e,a[63744+e]=s[249][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(o[s[250][e]]=64e3+e,a[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(o[s[251][e]]=64256+e,a[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(o[s[252][e]]=64512+e,a[64512+e]=s[252][e]);for(s[253]="".split(""),e=0;e!=s[253].length;++e)s[253][e].charCodeAt(0)!==65533&&(o[s[253][e]]=64768+e,a[64768+e]=s[253][e]);for(s[254]="".split(""),e=0;e!=s[254].length;++e)s[254][e].charCodeAt(0)!==65533&&(o[s[254][e]]=65024+e,a[65024+e]=s[254][e]);return{enc:o,dec:a}})(),n[949]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(o[s[129][e]]=33024+e,a[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(o[s[130][e]]=33280+e,a[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(o[s[131][e]]=33536+e,a[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(o[s[132][e]]=33792+e,a[33792+e]=s[132][e]);for(s[133]="".split(""),e=0;e!=s[133].length;++e)s[133][e].charCodeAt(0)!==65533&&(o[s[133][e]]=34048+e,a[34048+e]=s[133][e]);for(s[134]="".split(""),e=0;e!=s[134].length;++e)s[134][e].charCodeAt(0)!==65533&&(o[s[134][e]]=34304+e,a[34304+e]=s[134][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(o[s[135][e]]=34560+e,a[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(o[s[136][e]]=34816+e,a[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(o[s[137][e]]=35072+e,a[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(o[s[138][e]]=35328+e,a[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(o[s[139][e]]=35584+e,a[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(o[s[140][e]]=35840+e,a[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(o[s[141][e]]=36096+e,a[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(o[s[142][e]]=36352+e,a[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(o[s[143][e]]=36608+e,a[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(o[s[144][e]]=36864+e,a[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(o[s[145][e]]=37120+e,a[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(o[s[146][e]]=37376+e,a[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(o[s[147][e]]=37632+e,a[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(o[s[148][e]]=37888+e,a[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(o[s[149][e]]=38144+e,a[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(o[s[150][e]]=38400+e,a[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(o[s[151][e]]=38656+e,a[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(o[s[152][e]]=38912+e,a[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(o[s[153][e]]=39168+e,a[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(o[s[154][e]]=39424+e,a[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(o[s[155][e]]=39680+e,a[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(o[s[156][e]]=39936+e,a[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(o[s[157][e]]=40192+e,a[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(o[s[158][e]]=40448+e,a[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(o[s[159][e]]=40704+e,a[40704+e]=s[159][e]);for(s[160]="".split(""),e=0;e!=s[160].length;++e)s[160][e].charCodeAt(0)!==65533&&(o[s[160][e]]=40960+e,a[40960+e]=s[160][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(o[s[170][e]]=43520+e,a[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(o[s[171][e]]=43776+e,a[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(o[s[172][e]]=44032+e,a[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(o[s[173][e]]=44288+e,a[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(o[s[174][e]]=44544+e,a[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(o[s[175][e]]=44800+e,a[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(o[s[199][e]]=50944+e,a[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(o[s[200][e]]=51200+e,a[51200+e]=s[200][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(o[s[248][e]]=63488+e,a[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(o[s[249][e]]=63744+e,a[63744+e]=s[249][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(o[s[250][e]]=64e3+e,a[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(o[s[251][e]]=64256+e,a[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(o[s[252][e]]=64512+e,a[64512+e]=s[252][e]);for(s[253]="".split(""),e=0;e!=s[253].length;++e)s[253][e].charCodeAt(0)!==65533&&(o[s[253][e]]=64768+e,a[64768+e]=s[253][e]);return{enc:o,dec:a}})(),n[950]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(o[s[170][e]]=43520+e,a[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(o[s[171][e]]=43776+e,a[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(o[s[172][e]]=44032+e,a[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(o[s[173][e]]=44288+e,a[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(o[s[174][e]]=44544+e,a[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(o[s[175][e]]=44800+e,a[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(o[s[201][e]]=51456+e,a[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(o[s[248][e]]=63488+e,a[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(o[s[249][e]]=63744+e,a[63744+e]=s[249][e]);return{enc:o,dec:a}})(),n[1250]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1251]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1252]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1253]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1254]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1255]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1256]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1257]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1258]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1e4]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10006]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10007]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10008]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(o[s[199][e]]=50944+e,a[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(o[s[200][e]]=51200+e,a[51200+e]=s[200][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(o[s[201][e]]=51456+e,a[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);return{enc:o,dec:a}})(),n[10029]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10079]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10081]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[28591]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),l.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"&&(l.exports=n);(function(a,o){if(typeof n>"u")if(typeof fp<"u"){var s=n;l.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"?l.exports=o(s):a.cptable=o(s)}else throw new Error("cptable not found");else n=o(n)})(_7,function(a){var o={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},s=[874,1250,1251,1252,1253,1254,1255,1256,1e4],e=[932,936,949,950],m=[65001],v={},w={},N={},S={},D=function(me){return String.fromCharCode(me)},L=function(me){return me.charCodeAt(0)},M=typeof Buffer<"u",F=function(){};if(M){var O=!Buffer.from;if(!O)try{Buffer.from("foo","utf8")}catch{O=!0}F=O?function(se,me){return me?new Buffer(se,me):new Buffer(se)}:Buffer.from.bind(Buffer),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(se){return new Buffer(se)});var P=1024,G=Buffer.allocUnsafe(P),ae=function(me){for(var W=Buffer.allocUnsafe(65536),pe=0;pe<65536;++pe)W[pe]=0;for(var Me=Object.keys(me),Se=Me.length,V=0,H=Me[V];V<Se;++V)(H=Me[V])&&(W[H.charCodeAt(0)]=me[H]);return W},re=function(me){var W=ae(a[me].enc);return function(Me,Se){var V=Me.length,H,Q=0,te=0,de=0,ve=0;if(typeof Me=="string")for(H=Buffer.allocUnsafe(V),Q=0;Q<V;++Q)H[Q]=W[Me.charCodeAt(Q)];else if(Buffer.isBuffer(Me)){for(H=Buffer.allocUnsafe(2*V),te=0,Q=0;Q<V;++Q)de=Me[Q],de<128?H[te++]=W[de]:de<224?(H[te++]=W[((de&31)<<6)+(Me[Q+1]&63)],++Q):de<240?(H[te++]=W[((de&15)<<12)+((Me[Q+1]&63)<<6)+(Me[Q+2]&63)],Q+=2):(ve=((de&7)<<18)+((Me[Q+1]&63)<<12)+((Me[Q+2]&63)<<6)+(Me[Q+3]&63),Q+=3,ve<65536?H[te++]=W[ve]:(ve-=65536,H[te++]=W[55296+(ve>>10&1023)],H[te++]=W[56320+(ve&1023)]));H=H.slice(0,te)}else for(H=Buffer.allocUnsafe(V),Q=0;Q<V;++Q)H[Q]=W[Me[Q].charCodeAt(0)];return!Se||Se==="buf"?H:Se!=="arr"?H.toString("binary"):[].slice.call(H)}},Ne=function(me){var W=a[me].dec,pe=Buffer.allocUnsafe(131072),Me=0,Se="";for(Me=0;Me<W.length;++Me)if(Se=W[Me]){var V=Se.charCodeAt(0);pe[2*Me]=V&255,pe[2*Me+1]=V>>8}return function(Q){var te=Q.length,de=0,ve=0;if(2*te>P&&(P=2*te,G=Buffer.allocUnsafe(P)),Buffer.isBuffer(Q))for(de=0;de<te;de++)ve=2*Q[de],G[2*de]=pe[ve],G[2*de+1]=pe[ve+1];else if(typeof Q=="string")for(de=0;de<te;de++)ve=2*Q.charCodeAt(de),G[2*de]=pe[ve],G[2*de+1]=pe[ve+1];else for(de=0;de<te;de++)ve=2*Q[de],G[2*de]=pe[ve],G[2*de+1]=pe[ve+1];return G.slice(0,2*te).toString("ucs2")}},xe=function(me){for(var W=a[me].enc,pe=Buffer.allocUnsafe(131072),Me=0;Me<131072;++Me)pe[Me]=0;for(var Se=Object.keys(W),V=0,H=Se[V];V<Se.length;++V)if(H=Se[V]){var Q=H.charCodeAt(0);pe[2*Q]=W[H]&255,pe[2*Q+1]=W[H]>>8}return function(de,ve){var ke=de.length,ne=Buffer.allocUnsafe(2*ke),De=0,He=0,vt=0,Pe=0,Nt=0;if(typeof de=="string"){for(De=Pe=0;De<ke;++De)He=de.charCodeAt(De)*2,ne[Pe++]=pe[He+1]||pe[He],pe[He+1]>0&&(ne[Pe++]=pe[He]);ne=ne.slice(0,Pe)}else if(Buffer.isBuffer(de)){for(De=Pe=0;De<ke;++De)Nt=de[De],Nt<128?He=Nt:Nt<224?(He=((Nt&31)<<6)+(de[De+1]&63),++De):Nt<240?(He=((Nt&15)<<12)+((de[De+1]&63)<<6)+(de[De+2]&63),De+=2):(He=((Nt&7)<<18)+((de[De+1]&63)<<12)+((de[De+2]&63)<<6)+(de[De+3]&63),De+=3),He<65536?(He*=2,ne[Pe++]=pe[He+1]||pe[He],pe[He+1]>0&&(ne[Pe++]=pe[He])):(vt=He-65536,He=2*(55296+(vt>>10&1023)),ne[Pe++]=pe[He+1]||pe[He],pe[He+1]>0&&(ne[Pe++]=pe[He]),He=2*(56320+(vt&1023)),ne[Pe++]=pe[He+1]||pe[He],pe[He+1]>0&&(ne[Pe++]=pe[He]));ne=ne.slice(0,Pe)}else for(De=Pe=0;De<ke;De++)He=de[De].charCodeAt(0)*2,ne[Pe++]=pe[He+1]||pe[He],pe[He+1]>0&&(ne[Pe++]=pe[He]);return!ve||ve==="buf"?ne:ve!=="arr"?ne.toString("binary"):[].slice.call(ne)}},we=function(me){var W=a[me].dec,pe=Buffer.allocUnsafe(131072),Me=0,Se,V=0,H=0,Q=0;for(Q=0;Q<65536;++Q)pe[2*Q]=255,pe[2*Q+1]=253;for(Me=0;Me<W.length;++Me)(Se=W[Me])&&(V=Se.charCodeAt(0),H=2*Me,pe[H]=V&255,pe[H+1]=V>>8);return function(de){var ve=de.length,ke=Buffer.allocUnsafe(2*ve),ne=0,De=0,He=0;if(Buffer.isBuffer(de))for(ne=0;ne<ve;ne++)De=2*de[ne],pe[De]===255&&pe[De+1]===253&&(De=2*((de[ne]<<8)+de[ne+1]),++ne),ke[He++]=pe[De],ke[He++]=pe[De+1];else if(typeof de=="string")for(ne=0;ne<ve;ne++)De=2*de.charCodeAt(ne),pe[De]===255&&pe[De+1]===253&&(De=2*((de.charCodeAt(ne)<<8)+de.charCodeAt(ne+1)),++ne),ke[He++]=pe[De],ke[He++]=pe[De+1];else for(ne=0;ne<ve;ne++)De=2*de[ne],pe[De]===255&&pe[De+1]===253&&(De=2*((de[ne]<<8)+de[ne+1]),++ne),ke[He++]=pe[De],ke[He++]=pe[De+1];return ke.slice(0,He).toString("ucs2")}};v[65001]=function se(me){if(typeof me=="string")return se(me.split("").map(L));var W=me.length,pe=0,Me=0;4*W>P&&(P=4*W,G=Buffer.allocUnsafe(P));var Se=0;W>=3&&me[0]==239&&me[1]==187&&me[2]==191&&(Se=3);for(var V=1,H=0,Q=0;Se<W;Se+=V)V=1,Q=me[Se],Q<128?pe=Q:Q<224?(pe=(Q&31)*64+(me[Se+1]&63),V=2):Q<240?(pe=((Q&15)<<12)+(me[Se+1]&63)*64+(me[Se+2]&63),V=3):(pe=(Q&7)*262144+((me[Se+1]&63)<<12)+(me[Se+2]&63)*64+(me[Se+3]&63),V=4),pe<65536?(G[H++]=pe&255,G[H++]=pe>>8):(pe-=65536,Me=55296+(pe>>10&1023),pe=56320+(pe&1023),G[H++]=Me&255,G[H++]=Me>>>8,G[H++]=pe&255,G[H++]=pe>>>8&255);return G.slice(0,H).toString("ucs2")},w[65001]=function(me,W){if(M&&Buffer.isBuffer(me))return!W||W==="buf"?me:W!=="arr"?me.toString("binary"):[].slice.call(me);var pe=me.length,Me=0,Se=0,V=0,H=typeof me=="string";4*pe>P&&(P=4*pe,G=Buffer.allocUnsafe(P));for(var Q=0;Q<pe;++Q)Me=H?me.charCodeAt(Q):me[Q].charCodeAt(0),Me<=127?G[V++]=Me:Me<=2047?(G[V++]=192+(Me>>6),G[V++]=128+(Me&63)):Me>=55296&&Me<=57343?(Me-=55296,++Q,Se=(H?me.charCodeAt(Q):me[Q].charCodeAt(0))-56320+(Me<<10),G[V++]=240+(Se>>>18&7),G[V++]=144+(Se>>>12&63),G[V++]=128+(Se>>>6&63),G[V++]=128+(Se&63)):(G[V++]=224+(Me>>12),G[V++]=128+(Me>>6&63),G[V++]=128+(Me&63));return!W||W==="buf"?G.slice(0,V):W!=="arr"?G.slice(0,V).toString("binary"):[].slice.call(G,0,V)}}var Z=function(){if(M){if(N[s[0]])return;var me=0,W=0;for(me=0;me<s.length;++me)W=s[me],a[W]&&(N[W]=Ne(W),S[W]=re(W));for(me=0;me<e.length;++me)W=e[me],a[W]&&(N[W]=we(W),S[W]=xe(W));for(me=0;me<m.length;++me)W=m[me],v[W]&&(N[W]=v[W]),w[W]&&(S[W]=w[W])}},ce=function(se,me){return""},ue=function(me){delete N[me],delete S[me]},Le=function(){if(M){if(!N[s[0]])return;s.forEach(ue),e.forEach(ue),m.forEach(ue)}ye=ce,Te=0},be={encache:Z,decache:Le,sbcs:s,dbcs:e};Z();var oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",he="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?",ye=ce,Te=0,fe=function se(me,W,pe){if(me===Te&&ye)return ye(W,pe);if(S[me])return ye=S[Te=me],ye(W,pe);M&&Buffer.isBuffer(W)&&(W=W.toString("utf8"));var Me=W.length,Se=M?Buffer.allocUnsafe(4*Me):[],V=0,H=0,Q=0,te=0,de=a[me],ve,ke="",ne=typeof W=="string";if(de&&(ve=de.enc))for(H=0;H<Me;++H,++Q)V=ve[ne?W.charAt(H):W[H]],V>255?(Se[Q]=V>>8,Se[++Q]=V&255):Se[Q]=V&255;else if(ke=o[me])switch(ke){case"utf8":if(M&&ne){Se=F(W,ke),Q=Se.length;break}for(H=0;H<Me;++H,++Q)V=ne?W.charCodeAt(H):W[H].charCodeAt(0),V<=127?Se[Q]=V:V<=2047?(Se[Q]=192+(V>>6),Se[++Q]=128+(V&63)):V>=55296&&V<=57343?(V-=55296,te=(ne?W.charCodeAt(++H):W[++H].charCodeAt(0))-56320+(V<<10),Se[Q]=240+(te>>>18&7),Se[++Q]=144+(te>>>12&63),Se[++Q]=128+(te>>>6&63),Se[++Q]=128+(te&63)):(Se[Q]=224+(V>>12),Se[++Q]=128+(V>>6&63),Se[++Q]=128+(V&63));break;case"ascii":if(M&&typeof W=="string"){Se=F(W,ke),Q=Se.length;break}for(H=0;H<Me;++H,++Q)if(V=ne?W.charCodeAt(H):W[H].charCodeAt(0),V<=127)Se[Q]=V;else throw new Error("bad ascii "+V);break;case"utf16le":if(M&&typeof W=="string"){Se=F(W,ke),Q=Se.length;break}for(H=0;H<Me;++H)V=ne?W.charCodeAt(H):W[H].charCodeAt(0),Se[Q++]=V&255,Se[Q++]=V>>8;break;case"utf16be":for(H=0;H<Me;++H)V=ne?W.charCodeAt(H):W[H].charCodeAt(0),Se[Q++]=V>>8,Se[Q++]=V&255;break;case"utf32le":for(H=0;H<Me;++H)V=ne?W.charCodeAt(H):W[H].charCodeAt(0),V>=55296&&V<=57343&&(V=65536+(V-55296<<10)+(W[++H].charCodeAt(0)-56320)),Se[Q++]=V&255,V>>=8,Se[Q++]=V&255,V>>=8,Se[Q++]=V&255,V>>=8,Se[Q++]=V&255;break;case"utf32be":for(H=0;H<Me;++H)V=ne?W.charCodeAt(H):W[H].charCodeAt(0),V>=55296&&V<=57343&&(V=65536+(V-55296<<10)+(W[++H].charCodeAt(0)-56320)),Se[Q+3]=V&255,V>>=8,Se[Q+2]=V&255,V>>=8,Se[Q+1]=V&255,V>>=8,Se[Q]=V&255,Q+=4;break;case"utf7":for(H=0;H<Me;H++){var De=ne?W.charAt(H):W[H].charAt(0);if(De==="+"){Se[Q++]=43,Se[Q++]=45;continue}if(he.indexOf(De)>-1){Se[Q++]=De.charCodeAt(0);continue}var He=se(1201,De);Se[Q++]=43,Se[Q++]=oe.charCodeAt(He[0]>>2),Se[Q++]=oe.charCodeAt(((He[0]&3)<<4)+((He[1]||0)>>4)),Se[Q++]=oe.charCodeAt(((He[1]&15)<<2)+((He[2]||0)>>6)),Se[Q++]=45}break;default:throw new Error("Unsupported magic: "+me+" "+o[me])}else throw new Error("Unrecognized CP: "+me);return Se=Se.slice(0,Q),M?!pe||pe==="buf"?Se:pe!=="arr"?Se.toString("binary"):[].slice.call(Se):pe=="str"?Se.map(D).join(""):Se},_e=function se(me,W){var pe;if(pe=N[me])return pe(W);if(typeof W=="string")return se(me,W.split("").map(L));var Me=W.length,Se=new Array(Me),V="",H=0,Q=0,te=1,de=0,ve=0,ke=a[me],ne,De="";if(ke&&(ne=ke.dec))for(Q=0;Q<Me;Q+=te){if(te=2,V=ne[(W[Q]<<8)+W[Q+1]],V||(te=1,V=ne[W[Q]]),!V)throw new Error("Unrecognized code: "+W[Q]+" "+W[Q+te-1]+" "+Q+" "+te+" "+ne[W[Q]]);Se[de++]=V}else if(De=o[me])switch(De){case"utf8":for(Me>=3&&W[0]==239&&W[1]==187&&W[2]==191&&(Q=3);Q<Me;Q+=te)te=1,W[Q]<128?H=W[Q]:W[Q]<224?(H=(W[Q]&31)*64+(W[Q+1]&63),te=2):W[Q]<240?(H=((W[Q]&15)<<12)+(W[Q+1]&63)*64+(W[Q+2]&63),te=3):(H=(W[Q]&7)*262144+((W[Q+1]&63)<<12)+(W[Q+2]&63)*64+(W[Q+3]&63),te=4),H<65536||(H-=65536,ve=55296+(H>>10&1023),H=56320+(H&1023),Se[de++]=String.fromCharCode(ve)),Se[de++]=String.fromCharCode(H);break;case"ascii":if(M&&Buffer.isBuffer(W))return W.toString(De);for(Q=0;Q<Me;Q++)Se[Q]=String.fromCharCode(W[Q]);de=Me;break;case"utf16le":if(Me>=2&&W[0]==255&&W[1]==254&&(Q=2),M&&Buffer.isBuffer(W))return W.toString(De);for(te=2;Q+1<Me;Q+=te)Se[de++]=String.fromCharCode((W[Q+1]<<8)+W[Q]);break;case"utf16be":for(Me>=2&&W[0]==254&&W[1]==255&&(Q=2),te=2;Q+1<Me;Q+=te)Se[de++]=String.fromCharCode((W[Q]<<8)+W[Q+1]);break;case"utf32le":for(Me>=4&&W[0]==255&&W[1]==254&&W[2]===0&&W[3]===0&&(Q=4),te=4;Q<Me;Q+=te)H=(W[Q+3]<<24)+(W[Q+2]<<16)+(W[Q+1]<<8)+W[Q],H>65535?(H-=65536,Se[de++]=String.fromCharCode(55296+(H>>10&1023)),Se[de++]=String.fromCharCode(56320+(H&1023))):Se[de++]=String.fromCharCode(H);break;case"utf32be":for(Me>=4&&W[3]==255&&W[2]==254&&W[1]===0&&W[0]===0&&(Q=4),te=4;Q<Me;Q+=te)H=(W[Q]<<24)+(W[Q+1]<<16)+(W[Q+2]<<8)+W[Q+3],H>65535?(H-=65536,Se[de++]=String.fromCharCode(55296+(H>>10&1023)),Se[de++]=String.fromCharCode(56320+(H&1023))):Se[de++]=String.fromCharCode(H);break;case"utf7":for(Me>=4&&W[0]==43&&W[1]==47&&W[2]==118&&(Me>=5&&W[3]==56&&W[4]==45?Q=5:(W[3]==56||W[3]==57||W[3]==43||W[3]==47)&&(Q=4));Q<Me;Q+=te){if(W[Q]!==43){te=1,Se[de++]=String.fromCharCode(W[Q]);continue}if(te=1,W[Q+1]===45){te=2,Se[de++]="+";continue}for(;String.fromCharCode(W[Q+te]).match(/[A-Za-z0-9+\/]/);)te++;var He=0;W[Q+te]===45&&(++te,He=1);for(var vt=[],Pe="",Nt=0,st=0,Xt=0,Rt=0,Ns=0,Js=0,ps=0,ds=1;ds<te-He&&(Rt=oe.indexOf(String.fromCharCode(W[Q+ds++])),Ns=oe.indexOf(String.fromCharCode(W[Q+ds++])),Nt=Rt<<2|Ns>>4,vt.push(Nt),Js=oe.indexOf(String.fromCharCode(W[Q+ds++])),!(Js===-1||(st=(Ns&15)<<4|Js>>2,vt.push(st),ps=oe.indexOf(String.fromCharCode(W[Q+ds++])),ps===-1)));)Xt=(Js&3)<<6|ps,ps<64&&vt.push(Xt);for(Pe=se(1201,vt),ds=0;ds<Pe.length;++ds)Se[de++]=Pe.charAt(ds)}break;default:throw new Error("Unsupported magic: "+me+" "+o[me])}else throw new Error("Unrecognized CP: "+me);return Se.slice(0,de).join("")},We=function(me){return!!(a[me]||o[me])};return a.utils={decode:_e,encode:fe,hascp:We,magic:o,cache:be},a})})(mp)),mp.exports}const M7={},L7=Object.freeze(Object.defineProperty({__proto__:null,default:M7},Symbol.toStringTag,{value:"Module"})),I1=Av(L7);var Rb;function R7(){return Rb||(Rb=1,(function(l,n){var a={};function o(s){s.version="0.18.5",s.style_version="1.2.0";var e,m=1200,v=1252;typeof cptable<"u"?e=cptable:typeof fp<"u"&&(e=F7());var w=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},S=function(r){w.indexOf(r)!=-1&&(v=N[0]=r)},D=function(r){S(m=r)};function L(){D(1200),S(1252)}function M(r){for(var d=[],u=0,h=r.length;u<h;++u)d[u]=r.charCodeAt(u);return d}function F(r){for(var d=[],u=0;u<r.length>>1;++u)d[u]=String.fromCharCode(r.charCodeAt(2*u+1)+(r.charCodeAt(2*u)<<8));return d.join("")}var O=function(r){var d=r.charCodeAt(0),u=r.charCodeAt(1);return d==255&&u==254?(function(h){for(var g=[],b=0;b<h.length>>1;++b)g[b]=String.fromCharCode(h.charCodeAt(2*b)+(h.charCodeAt(2*b+1)<<8));return g.join("")})(r.slice(2)):d==254&&u==255?F(r.slice(2)):d==65279?r.slice(1):r},P=function(r){return String.fromCharCode(r)},G=function(r){return String.fromCharCode(r)};e!==void 0&&(D=function(r){S(m=r)},O=function(r){return r.charCodeAt(0)===255&&r.charCodeAt(1)===254?e.utils.decode(1200,M(r.slice(2))):r},P=function(r){return m===1200?String.fromCharCode(r):e.utils.decode(m,[255&r,r>>8])[0]},G=function(r){return e.utils.decode(v,[r])[0]});var ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function re(r){for(var d,u,h,g,b,x="",y=0,j=0,k=0;k<r.length;)g=(d=r.charCodeAt(k++))>>2,b=(3&d)<<4|(u=r.charCodeAt(k++))>>4,y=(15&u)<<2|(h=r.charCodeAt(k++))>>6,j=63&h,isNaN(u)?y=j=64:isNaN(h)&&(j=64),x+=ae.charAt(g)+ae.charAt(b)+ae.charAt(y)+ae.charAt(j);return x}function Ne(r){var d,u,h,g,b,x,y="";r=r.replace(/[^\w\+\/\=]/g,"");for(var j=0;j<r.length;)d=ae.indexOf(r.charAt(j++))<<2|(g=ae.indexOf(r.charAt(j++)))>>4,y+=String.fromCharCode(d),u=(15&g)<<4|(b=ae.indexOf(r.charAt(j++)))>>2,b!==64&&(y+=String.fromCharCode(u)),h=(3&b)<<6|(x=ae.indexOf(r.charAt(j++))),x!==64&&(y+=String.fromCharCode(h));return y}var xe=typeof Buffer<"u"&&typeof process<"u"&&process.versions!==void 0&&!!process.versions.node,we=(function(){if(typeof Buffer>"u")return function(){};var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(d,u){return u?new Buffer(d,u):new Buffer(d)}:Buffer.from.bind(Buffer)})();function Z(r){return xe?Buffer.alloc?Buffer.alloc(r):new Buffer(r):new(typeof Uint8Array<"u"?Uint8Array:Array)(r)}function ce(r){return xe?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):new(typeof Uint8Array<"u"?Uint8Array:Array)(r)}var ue=function(r){return xe?we(r,"binary"):r.split("").map(function(d){return 255&d.charCodeAt(0)})};function Le(r){if(typeof ArrayBuffer>"u")return ue(r);for(var d=new ArrayBuffer(r.length),u=new Uint8Array(d),h=0;h!=r.length;++h)u[h]=255&r.charCodeAt(h);return d}function be(r){if(Array.isArray(r))return r.map(function(h){return String.fromCharCode(h)}).join("");for(var d=[],u=0;u<r.length;++u)d[u]=String.fromCharCode(r[u]);return d.join("")}function oe(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return oe(new Uint8Array(r));for(var d=new Array(r.length),u=0;u<r.length;++u)d[u]=r[u];return d}var he=xe?function(r){return Buffer.concat(r.map(function(d){return Buffer.isBuffer(d)?d:we(d)}))}:function(r){if(typeof Uint8Array>"u")return[].concat.apply([],r.map(function(b){return Array.isArray(b)?b:[].slice.call(b)}));for(var u=0,d=0,u=0;u<r.length;++u)d+=r[u].length;for(var h,g=new Uint8Array(d),d=u=0;u<r.length;d+=h,++u)if(h=r[u].length,r[u]instanceof Uint8Array)g.set(r[u],d);else{if(typeof r[u]=="string")throw"wtf";g.set(new Uint8Array(r[u]),d)}return g},ye=/\u0000/g,Te=/[\u0001-\u0006]/g;function fe(r){for(var d="",u=r.length-1;0<=u;)d+=r.charAt(u--);return d}function _e(r,d){return r=""+r,d<=r.length?r:jr("0",d-r.length)+r}function We(r,d){return r=""+r,d<=r.length?r:jr(" ",d-r.length)+r}function se(r,d){return r=""+r,d<=r.length?r:r+jr(" ",d-r.length)}var me=Math.pow(2,32);function W(g,d){if(me<g||g<-me)return u=g,h=d,u=""+Math.round(u),h<=u.length?u:jr("0",h-u.length)+u;var u,h,g=Math.round(g);return(d=d)<=(g=""+(g=g)).length?g:jr("0",d-g.length)+g}function pe(r,d){return d=d||0,r.length>=7+d&&(32|r.charCodeAt(d))==103&&(32|r.charCodeAt(d+1))==101&&(32|r.charCodeAt(d+2))==110&&(32|r.charCodeAt(d+3))==101&&(32|r.charCodeAt(d+4))==114&&(32|r.charCodeAt(d+5))==97&&(32|r.charCodeAt(d+6))==108}var Me=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Se=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],V={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},H={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Q={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function te(r,d,u){for(var h=r<0?-1:1,g=r*h,b=0,x=1,y=0,j=1,k=0,E=0,T=Math.floor(g);k<d&&(y=(T=Math.floor(g))*x+b,E=T*k+j,!(g-T<5e-8));)g=1/(g-T),b=x,x=y,j=k,k=E;return d<E&&(y=d<k?(E=j,b):(E=k,x)),u?(u=Math.floor(h*y/E),[u,h*y-u*E,E]):[0,h*y,E]}function de(y,d,u){if(2958465<y||y<0)return null;var h=0|y,g=Math.floor(86400*(y-h)),b=0,x=[],y={D:h,T:g,u:86400*(y-h)-g,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(y.u)<1e-6&&(y.u=0),d&&d.date1904&&(h+=1462),.9999<y.u&&(y.u=0,++g==86400&&(y.T=g=0,++h,++y.D)),h===60?(x=u?[1317,10,29]:[1900,2,29],b=3):h===0?(x=u?[1317,8,29]:[1900,1,0],b=6):(60<h&&--h,(d=new Date(1900,0,1)).setDate(d.getDate()+h-1),x=[d.getFullYear(),d.getMonth()+1,d.getDate()],b=d.getDay(),h<60&&(b=(b+6)%7),u&&(b=(function(j,k){return k[0]-=581,k=j.getDay(),j<60&&(k=(k+6)%7),k})(d,x))),y.y=x[0],y.m=x[1],y.d=x[2],y.S=g%60,g=Math.floor(g/60),y.M=g%60,g=Math.floor(g/60),y.H=g,y.q=b,y}var ve=new Date(1899,11,31,0,0,0),ke=ve.getTime(),ne=new Date(1900,2,1,0,0,0);function De(r,d){var u=r.getTime();return d?u-=1262304e5:ne<=r&&(u+=864e5),(u-(ke+6e4*(r.getTimezoneOffset()-ve.getTimezoneOffset())))/864e5}function He(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function vt(r){var d,u,h,g=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),b=-4<=g&&g<=-1?r.toPrecision(10+g):Math.abs(g)<=9?(u=(d=r)<0?12:11,(h=He(d.toFixed(12))).length<=u||(h=d.toPrecision(10)).length<=u?h:d.toExponential(5)):g===10?r.toFixed(10).substr(0,12):(b=He((r=r).toFixed(11))).length>(r<0?12:11)||b==="0"||b==="-0"?r.toPrecision(6):b;return He((b=b.toUpperCase()).indexOf("E")==-1?b:b.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function Pe(r,d){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(0|r)===r?r.toString(10):vt(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Er(14,De(r,d&&d.date1904),d)}throw new Error("unsupported value in General format: "+r)}function Nt(r){if(r.length<=3)return r;for(var d=r.length%3,u=r.substr(0,d);d!=r.length;d+=3)u+=(0<u.length?",":"")+r.substr(d,3);return u}var st=/%/g,Xt=/# (\?+)( ?)\/( ?)(\d+)/,Rt=/^#*0*\.([0#]+)/,Ns=/\).*[0#]/,Js=/\(###\) ###\\?-####/;function ps(r){for(var d,u="",h=0;h!=r.length;++h)switch(d=r.charCodeAt(h)){case 35:break;case 63:u+=" ";break;case 48:u+="0";break;default:u+=String.fromCharCode(d)}return u}function ds(r,d){return d=Math.pow(10,d),""+Math.round(r*d)/d}function Ie(h,d){var u=h-Math.floor(h),h=Math.pow(10,d);return d<(""+Math.round(u*h)).length?0:Math.round(u*h)}function dt(r,d,u){if(r.charCodeAt(0)===40&&!d.match(Ns)){var h=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?dt("n",h,u):"("+dt("n",h,-u)+")"}if(d.charCodeAt(d.length-1)===44)return(function(z,X,ie){for(var le=X.length-1;X.charCodeAt(le-1)===44;)--le;return ms(z,X.substr(0,le),ie/Math.pow(10,3*(X.length-le)))})(r,d,u);if(d.indexOf("%")!==-1)return y=r,k=u,j=(E=d).replace(st,""),E=E.length-j.length,ms(y,j,k*Math.pow(10,2*E))+jr("%",E);var g;if(d.indexOf("E")!==-1)return(function z(X,ie){var le,Ae=X.indexOf("E")-X.indexOf(".")-1;if(X.match(/^#+0.0E\+0$/)){if(ie==0)return"0.0E+0";if(ie<0)return"-"+z(X,-ie);var Ve=X.indexOf(".");Ve===-1&&(Ve=X.indexOf("E"));var Oe=Math.floor(Math.log(ie)*Math.LOG10E)%Ve;if(Oe<0&&(Oe+=Ve),(le=(ie/Math.pow(10,Oe)).toPrecision(1+Ae+(Ve+Oe)%Ve)).indexOf("e")===-1){var Je=Math.floor(Math.log(ie)*Math.LOG10E);for(le.indexOf(".")===-1?le=le.charAt(0)+"."+le.substr(1)+"E+"+(Je-le.length+Oe):le+="E+"+(Je-Oe);le.substr(0,2)==="0.";)le=(le=le.charAt(0)+le.substr(2,Ve)+"."+le.substr(2+Ve)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");le=le.replace(/\+-/,"-")}le=le.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(pt,xt,at,Ct){return xt+at+Ct.substr(0,(Ve+Oe)%Ve)+"."+Ct.substr(Oe)+"E"})}else le=ie.toExponential(Ae);return X.match(/E\+00$/)&&le.match(/e[+-]\d$/)&&(le=le.substr(0,le.length-1)+"0"+le.charAt(le.length-1)),(le=X.match(/E\-/)&&le.match(/e\+/)?le.replace(/e\+/,"e"):le).replace("e","E")})(d,u);if(d.charCodeAt(0)===36)return"$"+dt(r,d.substr(d.charAt(1)==" "?2:1),u);var b,x,y,j,k,E,T,_=Math.abs(u),R=u<0?"-":"";if(d.match(/^00+$/))return R+W(_,d.length);if(d.match(/^[#?]+$/))return(g=(g=W(u,0))==="0"?"":g).length>d.length?g:ps(d.substr(0,d.length-g.length))+g;if(b=d.match(Xt))return T=b,y=_,j=R,k=parseInt(T[4],10),E=Math.round(y*k),y=Math.floor(E/k),j+(y===0?"":""+y)+" "+((E-=y*k)==0?jr(" ",T[1].length+1+T[4].length):We(E,T[1].length)+T[2]+"/"+T[3]+_e(k,T[4].length));if(d.match(/^#+0+$/))return R+W(_,d.length-d.indexOf("0"));if(b=d.match(Rt))return g=ds(u,b[1].length).replace(/^([^\.]+)$/,"$1."+ps(b[1])).replace(/\.$/,"."+ps(b[1])).replace(/\.(\d*)$/,function(z,X){return"."+X+jr("0",ps(b[1]).length-X.length)}),d.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(d=d.replace(/^#+([0.])/,"$1"),b=d.match(/^(0*)\.(#*)$/))return R+ds(_,b[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,b[1].length?"0.":".");if(b=d.match(/^#{1,3},##0(\.?)$/))return R+Nt(W(_,0));if(b=d.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+dt(r,d,-u):Nt(""+(Math.floor(u)+(T=u,(q=b[1].length)<(""+Math.round((T-Math.floor(T))*Math.pow(10,q))).length?1:0)))+"."+_e(Ie(u,b[1].length),b[1].length);if(b=d.match(/^#,#*,#0/))return dt(r,d.replace(/^#,#*,/,""),u);if(b=d.match(/^([0#]+)(\\?-([0#]+))+$/))return g=fe(dt(r,d.replace(/[\\-]/g,""),u)),x=0,fe(fe(d.replace(/\\/g,"")).replace(/[0#]/g,function(z){return x<g.length?g.charAt(x++):z==="0"?"0":""}));if(d.match(Js))return"("+(g=dt(r,"##########",u)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var q="";if(b=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(b[4].length,7),I=te(_,Math.pow(10,x)-1,!1),g=R,(q=ms("n",b[1],I[1])).charAt(q.length-1)==" "&&(q=q.substr(0,q.length-1)+"0"),g+=q+b[2]+"/"+b[3],(q=se(I[2],x)).length<b[4].length&&(q=ps(b[4].substr(b[4].length-q.length))+q),g+=q;if(b=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(Math.max(b[1].length,b[4].length),7),R+((I=te(_,Math.pow(10,x)-1,!0))[0]||(I[1]?"":"0"))+" "+(I[1]?We(I[1],x)+b[2]+"/"+b[3]+se(I[2],x):jr(" ",2*x+1+b[2].length+b[3].length));if(b=d.match(/^[#0?]+$/))return g=W(u,0),d.length<=g.length?g:ps(d.substr(0,d.length-g.length))+g;if(b=d.match(/^([#0?]+)\.([#0]+)$/)){g=""+u.toFixed(Math.min(b[2].length,10)).replace(/([^0])0+$/,"$1"),x=g.indexOf(".");var I=d.indexOf(".")-x,J=d.length-g.length-I;return ps(d.substr(0,I)+g+d.substr(d.length-J))}if(b=d.match(/^00,000\.([#0]*0)$/))return x=Ie(u,b[1].length),u<0?"-"+dt(r,d,-u):Nt((J=u)<2147483647&&-2147483648<J?""+(0<=J?0|J:J-1|0):""+Math.floor(J)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(z){return"00,"+(z.length<3?_e(0,3-z.length):"")+z})+"."+_e(x,b[1].length);switch(d){case"###,##0.00":return dt(r,"#,##0.00",u);case"###,###":case"##,###":case"#,###":var Y=Nt(W(_,0));return Y!=="0"?R+Y:"";case"###,###.00":return dt(r,"###,##0.00",u).replace(/^0\./,".");case"#,###.00":return dt(r,"#,##0.00",u).replace(/^0\./,".")}throw new Error("unsupported format |"+d+"|")}function Tt(r,d,u){if(r.charCodeAt(0)===40&&!d.match(Ns)){var h=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?Tt("n",h,u):"("+Tt("n",h,-u)+")"}if(d.charCodeAt(d.length-1)===44)return(function(I,J,Y){for(var z=J.length-1;J.charCodeAt(z-1)===44;)--z;return ms(I,J.substr(0,z),Y/Math.pow(10,3*(J.length-z)))})(r,d,u);if(d.indexOf("%")!==-1)return g=r,x=u,h=(b=d).replace(st,""),b=b.length-h.length,ms(g,h,x*Math.pow(10,2*b))+jr("%",b);var g,b,x,y;if(d.indexOf("E")!==-1)return(function I(J,Y){var z,X=J.indexOf("E")-J.indexOf(".")-1;if(J.match(/^#+0.0E\+0$/)){if(Y==0)return"0.0E+0";if(Y<0)return"-"+I(J,-Y);var ie=J.indexOf(".");ie===-1&&(ie=J.indexOf("E"));var le,Ae=Math.floor(Math.log(Y)*Math.LOG10E)%ie;Ae<0&&(Ae+=ie),(z=(Y/Math.pow(10,Ae)).toPrecision(1+X+(ie+Ae)%ie)).match(/[Ee]/)||(le=Math.floor(Math.log(Y)*Math.LOG10E),z.indexOf(".")===-1?z=z.charAt(0)+"."+z.substr(1)+"E+"+(le-z.length+Ae):z+="E+"+(le-Ae),z=z.replace(/\+-/,"-")),z=z.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(Ve,Oe,Je,pt){return Oe+Je+pt.substr(0,(ie+Ae)%ie)+"."+pt.substr(Ae)+"E"})}else z=Y.toExponential(X);return J.match(/E\+00$/)&&z.match(/e[+-]\d$/)&&(z=z.substr(0,z.length-1)+"0"+z.charAt(z.length-1)),(z=J.match(/E\-/)&&z.match(/e\+/)?z.replace(/e\+/,"e"):z).replace("e","E")})(d,u);if(d.charCodeAt(0)===36)return"$"+Tt(r,d.substr(d.charAt(1)==" "?2:1),u);var j,k,E=Math.abs(u),T=u<0?"-":"";if(d.match(/^00+$/))return T+_e(E,d.length);if(d.match(/^[#?]+$/))return(y=u===0?"":""+u).length>d.length?y:ps(d.substr(0,d.length-y.length))+y;if(j=d.match(Xt))return T+((_=E)===0?"":""+_)+jr(" ",(_=j)[1].length+2+_[4].length);if(d.match(/^#+0+$/))return T+_e(E,d.length-d.indexOf("0"));if(j=d.match(Rt))return y=(y=(""+u).replace(/^([^\.]+)$/,"$1."+ps(j[1])).replace(/\.$/,"."+ps(j[1]))).replace(/\.(\d*)$/,function(I,J){return"."+J+jr("0",ps(j[1]).length-J.length)}),d.indexOf("0.")!==-1?y:y.replace(/^0\./,".");if(d=d.replace(/^#+([0.])/,"$1"),j=d.match(/^(0*)\.(#*)$/))return T+(""+E).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,j[1].length?"0.":".");if(j=d.match(/^#{1,3},##0(\.?)$/))return T+Nt(""+E);if(j=d.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+Tt(r,d,-u):Nt(""+u)+"."+jr("0",j[1].length);if(j=d.match(/^#,#*,#0/))return Tt(r,d.replace(/^#,#*,/,""),u);if(j=d.match(/^([0#]+)(\\?-([0#]+))+$/))return y=fe(Tt(r,d.replace(/[\\-]/g,""),u)),k=0,fe(fe(d.replace(/\\/g,"")).replace(/[0#]/g,function(I){return k<y.length?y.charAt(k++):I==="0"?"0":""}));if(d.match(Js))return"("+(y=Tt(r,"##########",u)).substr(0,3)+") "+y.substr(3,3)+"-"+y.substr(6);var _="";if(j=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(j[4].length,7),R=te(E,Math.pow(10,k)-1,!1),y=T,(_=ms("n",j[1],R[1])).charAt(_.length-1)==" "&&(_=_.substr(0,_.length-1)+"0"),y+=_+j[2]+"/"+j[3],(_=se(R[2],k)).length<j[4].length&&(_=ps(j[4].substr(j[4].length-_.length))+_),y+=_;if(j=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(j[1].length,j[4].length),7),T+((R=te(E,Math.pow(10,k)-1,!0))[0]||(R[1]?"":"0"))+" "+(R[1]?We(R[1],k)+j[2]+"/"+j[3]+se(R[2],k):jr(" ",2*k+1+j[2].length+j[3].length));if(j=d.match(/^[#0?]+$/))return y=""+u,d.length<=y.length?y:ps(d.substr(0,d.length-y.length))+y;if(j=d.match(/^([#0]+)\.([#0]+)$/)){y=""+u.toFixed(Math.min(j[2].length,10)).replace(/([^0])0+$/,"$1"),k=y.indexOf(".");var _=d.indexOf(".")-k,R=d.length-y.length-_;return ps(d.substr(0,_)+y+d.substr(d.length-R))}if(j=d.match(/^00,000\.([#0]*0)$/))return u<0?"-"+Tt(r,d,-u):Nt(""+u).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(I){return"00,"+(I.length<3?_e(0,3-I.length):"")+I})+"."+_e(0,j[1].length);switch(d){case"###,###":case"##,###":case"#,###":var q=Nt(""+E);return q!=="0"?T+q:"";default:if(d.match(/\.[0#?]*$/))return Tt(r,d.slice(0,d.lastIndexOf(".")),u)+ps(d.slice(d.lastIndexOf(".")))}throw new Error("unsupported format |"+d+"|")}function ms(r,d,u){return((0|u)===u?Tt:dt)(r,d,u)}var nn=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function rr(r){for(var d=0,u="",h="";d<r.length;)switch(u=r.charAt(d)){case"G":pe(r,d)&&(d+=6),d++;break;case'"':for(;r.charCodeAt(++d)!==34&&d<r.length;);++d;break;case"\\":case"_":d+=2;break;case"@":++d;break;case"B":case"b":if(r.charAt(d+1)==="1"||r.charAt(d+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(d,3).toUpperCase()==="A/P"||r.substr(d,5).toUpperCase()==="AM/PM"||r.substr(d,5).toUpperCase()==="/")return!0;++d;break;case"[":for(h=u;r.charAt(d++)!=="]"&&d<r.length;)h+=r.charAt(d);if(h.match(nn))return!0;break;case".":case"0":case"#":for(;d<r.length&&(-1<"0#?.,E+-%".indexOf(u=r.charAt(++d))||u=="\\"&&r.charAt(d+1)=="-"&&-1<"0#".indexOf(r.charAt(d+2))););break;case"?":for(;r.charAt(++d)===u;);break;case"*":++d,r.charAt(d)!=" "&&r.charAt(d)!="*"||++d;break;case"(":case")":++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;d<r.length&&-1<"0123456789".indexOf(r.charAt(++d)););break;default:++d}return!1}function $l(r,d,u,h){for(var g,b,x,y=[],j="",k=0,E="",T="t",_="H";k<r.length;)switch(E=r.charAt(k)){case"G":if(!pe(r,k))throw new Error("unrecognized character "+E+" in "+r);y[y.length]={t:"G",v:"General"},k+=7;break;case'"':for(j="";(x=r.charCodeAt(++k))!==34&&k<r.length;)j+=String.fromCharCode(x);y[y.length]={t:"t",v:j},++k;break;case"\\":var R=r.charAt(++k),q=R==="("||R===")"?R:"t";y[y.length]={t:q,v:R},++k;break;case"_":y[y.length]={t:"t",v:" "},k+=2;break;case"@":y[y.length]={t:"T",v:d},++k;break;case"B":case"b":if(r.charAt(k+1)==="1"||r.charAt(k+1)==="2"){if(g==null&&(g=de(d,u,r.charAt(k+1)==="2"))==null)return"";y[y.length]={t:"X",v:r.substr(k,2)},T=E,k+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":E=E.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(d<0||g==null&&(g=de(d,u))==null)return"";for(j=E;++k<r.length&&r.charAt(k).toLowerCase()===E;)j+=E;(E=E==="m"&&T.toLowerCase()==="h"?"M":E)==="h"&&(E=_),y[y.length]={t:E,v:j},T=E;break;case"A":case"a":case"":if(R={t:E,v:E},g==null&&(g=de(d,u)),r.substr(k,3).toUpperCase()==="A/P"?(g!=null&&(R.v=12<=g.H?"P":"A"),R.t="T",_="h",k+=3):r.substr(k,5).toUpperCase()==="AM/PM"?(g!=null&&(R.v=12<=g.H?"PM":"AM"),R.t="T",k+=5,_="h"):r.substr(k,5).toUpperCase()==="/"?(g!=null&&(R.v=12<=g.H?"":""),R.t="T",k+=5,_="h"):(R.t="t",++k),g==null&&R.t==="T")return"";y[y.length]=R,T=E;break;case"[":for(j=E;r.charAt(k++)!=="]"&&k<r.length;)j+=r.charAt(k);if(j.slice(-1)!=="]")throw'unterminated "[" block: |'+j+"|";if(j.match(nn)){if(g==null&&(g=de(d,u))==null)return"";y[y.length]={t:"Z",v:j.toLowerCase()},T=j.charAt(1)}else-1<j.indexOf("$")&&(j=(j.match(/\$([^-\[\]]*)/)||[])[1]||"$",rr(r)||(y[y.length]={t:"t",v:j}));break;case".":if(g!=null){for(j=E;++k<r.length&&(E=r.charAt(k))==="0";)j+=E;y[y.length]={t:"s",v:j};break}case"0":case"#":for(j=E;++k<r.length&&-1<"0#?.,E+-%".indexOf(E=r.charAt(k));)j+=E;y[y.length]={t:"n",v:j};break;case"?":for(j=E;r.charAt(++k)===E;)j+=E;y[y.length]={t:E,v:j},T=E;break;case"*":++k,r.charAt(k)!=" "&&r.charAt(k)!="*"||++k;break;case"(":case")":y[y.length]={t:h===1?"t":E,v:E},++k;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(j=E;k<r.length&&-1<"0123456789".indexOf(r.charAt(++k));)j+=r.charAt(k);y[y.length]={t:"D",v:j};break;case" ":y[y.length]={t:E,v:E},++k;break;case"$":y[y.length]={t:"t",v:"$"},++k;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(E)===-1)throw new Error("unrecognized character "+E+" in "+r);y[y.length]={t:"t",v:E},++k}var I,J=0,Y=0;for(k=y.length-1,T="t";0<=k;--k)switch(y[k].t){case"h":case"H":y[k].t=_,T="h",J<1&&(J=1);break;case"s":(I=y[k].v.match(/\.0+$/))&&(Y=Math.max(Y,I[0].length-1)),J<3&&(J=3);case"d":case"y":case"M":case"e":T=y[k].t;break;case"m":T==="s"&&(y[k].t="M",J<2&&(J=2));break;case"X":break;case"Z":(J=(J=J<1&&y[k].v.match(/[Hh]/)?1:J)<2&&y[k].v.match(/[Mm]/)?2:J)<3&&y[k].v.match(/[Ss]/)&&(J=3)}switch(J){case 0:break;case 1:.5<=g.u&&(g.u=0,++g.S),60<=g.S&&(g.S=0,++g.M),60<=g.M&&(g.M=0,++g.H);break;case 2:.5<=g.u&&(g.u=0,++g.S),60<=g.S&&(g.S=0,++g.M)}var z,X="";for(k=0;k<y.length;++k)switch(y[k].t){case"t":case"T":case" ":case"D":break;case"X":y[k].v="",y[k].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":y[k].v=(function(pt,xt,at,Ct){var Vt,Ut="",Ft=0,Mt=0,Dt=at.y,wt=0;switch(pt){case 98:Dt=at.y+543;case 121:switch(xt.length){case 1:case 2:Vt=Dt%100,wt=2;break;default:Vt=Dt%1e4,wt=4}break;case 109:switch(xt.length){case 1:case 2:Vt=at.m,wt=xt.length;break;case 3:return Se[at.m-1][1];case 5:return Se[at.m-1][0];default:return Se[at.m-1][2]}break;case 100:switch(xt.length){case 1:case 2:Vt=at.d,wt=xt.length;break;case 3:return Me[at.q][0];default:return Me[at.q][1]}break;case 104:switch(xt.length){case 1:case 2:Vt=1+(at.H+11)%12,wt=xt.length;break;default:throw"bad hour format: "+xt}break;case 72:switch(xt.length){case 1:case 2:Vt=at.H,wt=xt.length;break;default:throw"bad hour format: "+xt}break;case 77:switch(xt.length){case 1:case 2:Vt=at.M,wt=xt.length;break;default:throw"bad minute format: "+xt}break;case 115:if(xt!="s"&&xt!="ss"&&xt!=".0"&&xt!=".00"&&xt!=".000")throw"bad second format: "+xt;return at.u!==0||xt!="s"&&xt!="ss"?(60*(Mt=2<=Ct?Ct===3?1e3:100:Ct===1?10:1)<=(Ft=Math.round(Mt*(at.S+at.u)))&&(Ft=0),xt==="s"?Ft===0?"0":""+Ft/Mt:(Ut=_e(Ft,2+Ct),xt==="ss"?Ut.substr(0,2):"."+Ut.substr(2,xt.length-1))):_e(at.S,xt.length);case 90:switch(xt){case"[h]":case"[hh]":Vt=24*at.D+at.H;break;case"[m]":case"[mm]":Vt=60*(24*at.D+at.H)+at.M;break;case"[s]":case"[ss]":Vt=60*(60*(24*at.D+at.H)+at.M)+Math.round(at.S+at.u);break;default:throw"bad abstime format: "+xt}wt=xt.length===3?1:2;break;case 101:Vt=Dt,wt=1}return 0<wt?_e(Vt,wt):""})(y[k].t.charCodeAt(0),y[k].v,g,Y),y[k].t="t";break;case"n":case"?":for(z=k+1;y[z]!=null&&((E=y[z].t)==="?"||E==="D"||(E===" "||E==="t")&&y[z+1]!=null&&(y[z+1].t==="?"||y[z+1].t==="t"&&y[z+1].v==="/")||y[k].t==="("&&(E===" "||E==="n"||E===")")||E==="t"&&(y[z].v==="/"||y[z].v===" "&&y[z+1]!=null&&y[z+1].t=="?"));)y[k].v+=y[z].v,y[z]={v:"",t:";"},++z;X+=y[k].v,k=z-1;break;case"G":y[k].t="t",y[k].v=Pe(d,u)}var ie,le,Ae="";if(0<X.length){X.charCodeAt(0)==40?(ie=d<0&&X.charCodeAt(0)===45?-d:d,le=ms("n",X,ie)):(le=ms("n",X,ie=d<0&&1<h?-d:d),ie<0&&y[0]&&y[0].t=="t"&&(le=le.substr(1),y[0].v="-"+y[0].v)),z=le.length-1;for(var Ve=y.length,k=0;k<y.length;++k)if(y[k]!=null&&y[k].t!="t"&&-1<y[k].v.indexOf(".")){Ve=k;break}var Oe=y.length;if(Ve===y.length&&le.indexOf("E")===-1){for(k=y.length-1;0<=k;--k)y[k]!=null&&"n?".indexOf(y[k].t)!==-1&&(z>=y[k].v.length-1?(z-=y[k].v.length,y[k].v=le.substr(z+1,y[k].v.length)):z<0?y[k].v="":(y[k].v=le.substr(0,z+1),z=-1),y[k].t="t",Oe=k);0<=z&&Oe<y.length&&(y[Oe].v=le.substr(0,z+1)+y[Oe].v)}else if(Ve!==y.length&&le.indexOf("E")===-1){for(z=le.indexOf(".")-1,k=Ve;0<=k;--k)if(y[k]!=null&&"n?".indexOf(y[k].t)!==-1){for(b=-1<y[k].v.indexOf(".")&&k===Ve?y[k].v.indexOf(".")-1:y[k].v.length-1,Ae=y[k].v.substr(b+1);0<=b;--b)0<=z&&(y[k].v.charAt(b)==="0"||y[k].v.charAt(b)==="#")&&(Ae=le.charAt(z--)+Ae);y[k].v=Ae,y[k].t="t",Oe=k}for(0<=z&&Oe<y.length&&(y[Oe].v=le.substr(0,z+1)+y[Oe].v),z=le.indexOf(".")+1,k=Ve;k<y.length;++k)if(y[k]!=null&&("n?(".indexOf(y[k].t)!==-1||k===Ve)){for(b=-1<y[k].v.indexOf(".")&&k===Ve?y[k].v.indexOf(".")+1:0,Ae=y[k].v.substr(0,b);b<y[k].v.length;++b)z<le.length&&(Ae+=le.charAt(z++));y[k].v=Ae,y[k].t="t",Oe=k}}}for(k=0;k<y.length;++k)y[k]!=null&&-1<"n?".indexOf(y[k].t)&&(ie=1<h&&d<0&&0<k&&y[k-1].v==="-"?-d:d,y[k].v=ms(y[k].t,y[k].v,ie),y[k].t="t");var Je="";for(k=0;k!==y.length;++k)y[k]!=null&&(Je+=y[k].v);return Je}var ln=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Vn(r,d){if(d!=null){var u=parseFloat(d[2]);switch(d[1]){case"=":if(r==u)return 1;break;case">":if(u<r)return 1;break;case"<":if(r<u)return 1;break;case"<>":if(r!=u)return 1;break;case">=":if(u<=r)return 1;break;case"<=":if(r<=u)return 1}}}function _a(r,d){var u=(function(x){for(var y=[],j=!1,k=0,E=0;k<x.length;++k)switch(x.charCodeAt(k)){case 34:j=!j;break;case 95:case 42:case 92:++k;break;case 59:y[y.length]=x.substr(E,k-E),E=k+1}if(y[y.length]=x.substr(E),j===!0)throw new Error("Format |"+x+"| unterminated string ");return y})(r),h=u.length,g=u[h-1].indexOf("@");if(h<4&&-1<g&&--h,4<u.length)throw new Error("cannot find right format for |"+u.join("|")+"|");if(typeof d!="number")return[4,u.length===4||-1<g?u[u.length-1]:"@"];switch(u.length){case 1:u=-1<g?["General","General","General",u[0]]:[u[0],u[0],u[0],"@"];break;case 2:u=-1<g?[u[0],u[0],u[0],u[1]]:[u[0],u[1],u[0],"@"];break;case 3:u=-1<g?[u[0],u[1],u[0],u[2]]:[u[0],u[1],u[2],"@"]}var b=0<d?u[0]:d<0?u[1]:u[2];return u[0].indexOf("[")===-1&&u[1].indexOf("[")===-1?[h,b]:u[0].match(/\[[=<>]/)==null&&u[1].match(/\[[=<>]/)==null?[h,b]:(r=u[0].match(ln),b=u[1].match(ln),Vn(d,r)?[h,u[0]]:Vn(d,b)?[h,u[1]]:[h,u[r!=null&&b!=null?2:1]])}function Er(r,d,u){u==null&&(u={});var h="";switch(typeof r){case"string":h=r=="m/d/yy"&&u.dateNF?u.dateNF:r;break;case"number":(h=(h=r==14&&u.dateNF?u.dateNF:(u.table!=null?u.table:V)[r])==null?u.table&&u.table[H[r]]||V[H[r]]:h)==null&&(h=Q[r]||"General")}if(pe(h,0))return Pe(d,u);var g=_a(h,d=d instanceof Date?De(d,u.date1904):d);if(pe(g[1]))return Pe(d,u);if(d===!0)d="TRUE";else if(d===!1)d="FALSE";else if(d===""||d==null)return"";return $l(g[1],d,u,g[0])}function Br(r,d){if(typeof d!="number"){d=+d||-1;for(var u=0;u<392;++u)if(V[u]!=null){if(V[u]==r){d=u;break}}else d<0&&(d=u);d<0&&(d=391)}return V[d]=r,d}function Bo(r){for(var d=0;d!=392;++d)r[d]!==void 0&&Br(r[d],d)}function ql(){var r;(r=r||{})[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',V=r}var ah={format:Er,load:Br,_table:V,load_table:Bo,parse_date_code:de,is_date:rr,get_table:function(){return ah._table=V}},zo={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},_i=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,Ba,Wn=(function(){var r={};r.version="1.2.0";var d=(function(){for(var z=0,X=new Array(256),ie=0;ie!=256;++ie)z=1&(z=1&(z=1&(z=1&(z=1&(z=1&(z=1&(z=1&(z=ie)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1,X[ie]=z;return typeof Int32Array<"u"?new Int32Array(X):X})(),u=(function(z){for(var X=0,ie=0,Ae=0,le=new(typeof Int32Array<"u"?Int32Array:Array)(4096),Ae=0;Ae!=256;++Ae)le[Ae]=z[Ae];for(Ae=0;Ae!=256;++Ae)for(ie=z[Ae],X=256+Ae;X<4096;X+=256)ie=le[X]=ie>>>8^z[255&ie];var Ve=[];for(Ae=1;Ae!=16;++Ae)Ve[Ae-1]=typeof Int32Array<"u"?le.subarray(256*Ae,256*Ae+256):le.slice(256*Ae,256*Ae+256);return Ve})(d),h=u[0],g=u[1],b=u[2],x=u[3],y=u[4],j=u[5],k=u[6],E=u[7],T=u[8],_=u[9],R=u[10],q=u[11],I=u[12],J=u[13],Y=u[14];return r.table=d,r.bstr=function(z,X){for(var ie=-1^X,le=0,Ae=z.length;le<Ae;)ie=ie>>>8^d[255&(ie^z.charCodeAt(le++))];return~ie},r.buf=function(z,X){for(var ie=-1^X,le=z.length-15,Ae=0;Ae<le;)ie=Y[z[Ae++]^255&ie]^J[z[Ae++]^ie>>8&255]^I[z[Ae++]^ie>>16&255]^q[z[Ae++]^ie>>>24]^R[z[Ae++]]^_[z[Ae++]]^T[z[Ae++]]^E[z[Ae++]]^k[z[Ae++]]^j[z[Ae++]]^y[z[Ae++]]^x[z[Ae++]]^b[z[Ae++]]^g[z[Ae++]]^h[z[Ae++]]^d[z[Ae++]];for(le+=15;Ae<le;)ie=ie>>>8^d[255&(ie^z[Ae++])];return~ie},r.str=function(z,X){for(var ie,le=-1^X,Ae=0,Ve=z.length,Oe=0;Ae<Ve;)le=(Oe=z.charCodeAt(Ae++))<128?le>>>8^d[255&(le^Oe)]:Oe<2048?(le=le>>>8^d[255&(le^(192|Oe>>6&31))])>>>8^d[255&(le^(128|63&Oe))]:55296<=Oe&&Oe<57344?(Oe=64+(1023&Oe),ie=1023&z.charCodeAt(Ae++),(le=(le=(le=le>>>8^d[255&(le^(240|Oe>>8&7))])>>>8^d[255&(le^(128|Oe>>2&63))])>>>8^d[255&(le^(128|ie>>6&15|(3&Oe)<<4))])>>>8^d[255&(le^(128|63&ie))]):(le=(le=le>>>8^d[255&(le^(224|Oe>>12&15))])>>>8^d[255&(le^(128|Oe>>6&63))])>>>8^d[255&(le^(128|63&Oe))];return~le},r})(),Zt=(function(){var r,d={};function u(ge){if(ge.charAt(ge.length-1)=="/")return ge.slice(0,-1).indexOf("/")===-1?ge:u(ge.slice(0,-1));var it=ge.lastIndexOf("/");return it===-1?ge:ge.slice(0,it+1)}function h(ge){if(ge.charAt(ge.length-1)=="/")return h(ge.slice(0,-1));var it=ge.lastIndexOf("/");return it===-1?ge:ge.slice(it+1)}function g(ge){ka(ge,0);for(var it,Ee={};ge.l<=ge.length-4;){var rt=ge.read_shift(2),Ce=ge.read_shift(2),jt=ge.l+Ce,Ze={};rt===21589&&(1&(it=ge.read_shift(1))&&(Ze.mtime=ge.read_shift(4)),5<Ce&&(2&it&&(Ze.atime=ge.read_shift(4)),4&it&&(Ze.ctime=ge.read_shift(4))),Ze.mtime&&(Ze.mt=new Date(1e3*Ze.mtime))),ge.l=jt,Ee[rt]=Ze}return Ee}function b(){return r=r||I1}function x(ge,it){if(ge[0]==80&&ge[1]==75)return qs(ge,it);if((32|ge[0])==109&&(32|ge[1])==105)return(function(Et,as){if(z(Et.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var $t=as&&as.root||"",_t=(xe&&Buffer.isBuffer(Et)?Et.toString("binary"):z(Et)).split(`\r
`),os=0,ns="";for(os=0;os<_t.length;++os)if(ns=_t[os],/^Content-Location:/i.test(ns)&&(ns=ns.slice(ns.indexOf("file")),$t=$t||ns.slice(0,ns.lastIndexOf("/")+1),ns.slice(0,$t.length)!=$t))for(;0<$t.length&&($t=($t=$t.slice(0,$t.length-1)).slice(0,$t.lastIndexOf("/")+1),ns.slice(0,$t.length)!=$t););if(Et=(_t[1]||"").match(/boundary="(.*?)"/),!Et)throw new Error("MAD cannot find boundary");var gr="--"+(Et[1]||""),us={FileIndex:[],FullPaths:[]};j(us);var js,es=0;for(os=0;os<_t.length;++os){var Us=_t[os];Us!==gr&&Us!==gr+"--"||(es++&&(function(Rs,i,c){for(var f,p="",C="",A="",U=0;U<10;++U){var ee=i[U];if(!ee||ee.match(/^\s*$/))break;var je=ee.match(/^(.*?):\s*([^\s].*)$/);if(je)switch(je[1].toLowerCase()){case"content-location":p=je[2].trim();break;case"content-type":A=je[2].trim();break;case"content-transfer-encoding":C=je[2].trim()}}switch(++U,C.toLowerCase()){case"base64":f=ue(Ne(i.slice(U).join("")));break;case"quoted-printable":f=(function(Ye){for(var ut=[],mt=0;mt<Ye.length;++mt){for(var et=Ye[mt];mt<=Ye.length&&et.charAt(et.length-1)=="=";)et=et.slice(0,et.length-1)+Ye[++mt];ut.push(et)}for(var lt=0;lt<ut.length;++lt)ut[lt]=ut[lt].replace(/[=][0-9A-Fa-f]{2}/g,function(ts){return String.fromCharCode(parseInt(ts.slice(1),16))});return ue(ut.join(`\r
`))})(i.slice(U));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+C)}c=Pn(Rs,p.slice(c.length),f,{unsafe:!0}),A&&(c.ctype=A)})(us,_t.slice(js,os),$t),js=os)}return us})(ge,it);if(ge.length<512)throw new Error("CFB file size "+ge.length+" < 512");var Ee,rt,Ce,jt=3,Ze=512,Lt=0,ot=[],Qe=ge.slice(0,512);ka(Qe,0);var ft=(function(Et){if(Et[Et.l]==80&&Et[Et.l+1]==75)return[0,0];Et.chk(q,"Header Signature: "),Et.l+=16;var as=Et.read_shift(2,"u");return[Et.read_shift(2,"u"),as]})(Qe);switch(jt=ft[0]){case 3:Ze=512;break;case 4:Ze=4096;break;case 0:if(ft[1]==0)return qs(ge,it);default:throw new Error("Major Version: Expected 3 or 4 saw "+jt)}Ze!==512&&ka(Qe=ge.slice(0,Ze),28);var At=ge.slice(0,Ze);(function(Et,as){var $t=9;switch(Et.l+=2,$t=Et.read_shift(2)){case 9:if(as!=3)throw new Error("Sector Shift: Expected 9 saw "+$t);break;case 12:if(as!=4)throw new Error("Sector Shift: Expected 12 saw "+$t);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+$t)}Et.chk("0600","Mini Sector Shift: "),Et.chk("000000000000","Reserved: ")})(Qe,jt);var rs=Qe.read_shift(4,"i");if(jt===3&&rs!==0)throw new Error("# Directory Sectors: Expected 0 saw "+rs);Qe.l+=4,rt=Qe.read_shift(4,"i"),Qe.l+=4,Qe.chk("00100000","Mini Stream Cutoff Size: "),Ce=Qe.read_shift(4,"i"),Ee=Qe.read_shift(4,"i"),ss=Qe.read_shift(4,"i"),Lt=Qe.read_shift(4,"i");for(var Kt,Gt=0;Gt<109&&!((Kt=Qe.read_shift(4,"i"))<0);++Gt)ot[Gt]=Kt;var Bt=(function(Et,as){for(var $t=Math.ceil(Et.length/as)-1,_t=[],os=1;os<$t;++os)_t[os-1]=Et.slice(os*as,(os+1)*as);return _t[$t-1]=Et.slice($t*as),_t})(ge,Ze);(function Et(as,$t,_t,os,ns){var gr=R;if(as===R){if($t!==0)throw new Error("DIFAT chain shorter than expected")}else if(as!==-1){var us=_t[as],js=(os>>>2)-1;if(us){for(var es=0;es<js&&(gr=Ql(us,4*es))!==R;++es)ns.push(gr);Et(Ql(us,os-4),$t-1,_t,os,ns)}}})(ss,Lt,Bt,Ze,ot);var Qt=(function(Et,as,$t,_t){var os=Et.length,ns=[],gr=[],us=[],js=[],es=_t-1,Us=0,Rs=0,i=0,c=0;for(Us=0;Us<os;++Us)if(us=[],os<=(i=Us+as)&&(i-=os),!gr[i]){js=[];var f=[];for(Rs=i;0<=Rs;){f[Rs]=!0,gr[Rs]=!0,us[us.length]=Rs,js.push(Et[Rs]);var p=$t[Math.floor(4*Rs/_t)];if(_t<4+(c=4*Rs&es))throw new Error("FAT boundary crossed: "+Rs+" 4 "+_t);if(!Et[p]||(Rs=Ql(Et[p],c),f[Rs]))break}ns[i]={nodes:us,data:wm([js])}}return ns})(Bt,rt,ot,Ze);Qt[rt].name="!Directory",0<Ee&&Ce!==R&&(Qt[Ce].name="!MiniFAT"),Qt[ot[0]].name="!FAT",Qt.fat_addrs=ot,Qt.ssz=Ze;var rs=[],ss=[],Lt=[];return(function(Et,as,$t,_t,os,ns,gr){for(var us,js=0,es=$t.length?2:0,Us=Et[rt].data,Rs=0,i=0;Rs<Us.length;Rs+=128){var c=Us.slice(Rs,Rs+128);ka(c,64),i=c.read_shift(2),us=h0(c,0,i-es),$t.push(us);var f={name:us,type:c.read_shift(1),color:c.read_shift(1),L:c.read_shift(4,"i"),R:c.read_shift(4,"i"),C:c.read_shift(4,"i"),clsid:c.read_shift(16),state:c.read_shift(4,"i"),start:0,size:0};c.read_shift(2)+c.read_shift(2)+c.read_shift(2)+c.read_shift(2)!==0&&(f.ct=y(c,c.l-8)),c.read_shift(2)+c.read_shift(2)+c.read_shift(2)+c.read_shift(2)!==0&&(f.mt=y(c,c.l-8)),f.start=c.read_shift(4,"i"),f.size=c.read_shift(4,"i"),f.size<0&&f.start<0&&(f.size=f.type=0,f.start=R,f.name=""),f.type===5?(js=f.start,0<_t&&js!==R&&(Et[js].name="!StreamData")):4096<=f.size?(f.storage="fat",Et[f.start]===void 0&&(Et[f.start]=(function(p,C,A,U,ee){var je=[],Ye=[];ee=ee||[];var ut=U-1,mt=0,et=0;for(mt=C;0<=mt;){ee[mt]=!0,je[je.length]=mt,Ye.push(p[mt]);var lt=A[Math.floor(4*mt/U)];if(U<4+(et=4*mt&ut))throw new Error("FAT boundary crossed: "+mt+" 4 "+U);if(!p[lt])break;mt=Ql(p[lt],et)}return{nodes:je,data:wm([Ye])}})(as,f.start,Et.fat_addrs,Et.ssz)),Et[f.start].name=f.name,f.content=Et[f.start].data.slice(0,f.size)):(f.storage="minifat",f.size<0?f.size=0:js!==R&&f.start!==R&&Et[js]&&(f.content=(function(p,C,A){for(var U=p.start,ee=p.size,je=[],Ye=U;A&&0<ee&&0<=Ye;)je.push(C.slice(Ye*_,Ye*_+_)),ee-=_,Ye=Ql(A,4*Ye);return je.length===0?gt(0):he(je).slice(0,p.size)})(f,Et[js].data,(Et[gr]||{}).data))),f.content&&ka(f.content,0),os[us]=f,ns.push(f)}})(Qt,Bt,rs,Ee,{},ss,Ce),(function(Et,as,$t){for(var _t=0,os=0,ns=0,gr=0,us=0,js=$t.length,es=[],Us=[];_t<js;++_t)es[_t]=Us[_t]=_t,as[_t]=$t[_t];for(;us<Us.length;++us)_t=Us[us],os=Et[_t].L,ns=Et[_t].R,gr=Et[_t].C,es[_t]===_t&&(os!==-1&&es[os]!==os&&(es[_t]=es[os]),ns!==-1&&es[ns]!==ns&&(es[_t]=es[ns])),gr!==-1&&(es[gr]=_t),os!==-1&&_t!=es[_t]&&(es[os]=es[_t],Us.lastIndexOf(os)<us&&Us.push(os)),ns!==-1&&_t!=es[_t]&&(es[ns]=es[_t],Us.lastIndexOf(ns)<us&&Us.push(ns));for(_t=1;_t<js;++_t)es[_t]===_t&&(ns!==-1&&es[ns]!==ns?es[_t]=es[ns]:os!==-1&&es[os]!==os&&(es[_t]=es[os]));for(_t=1;_t<js;++_t)if(Et[_t].type!==0){if((us=_t)!=es[us])for(;us=es[us],as[_t]=as[us]+"/"+as[_t],us!==0&&es[us]!==-1&&us!=es[us];);es[_t]=-1}for(as[0]+="/",_t=1;_t<js;++_t)Et[_t].type!==2&&(as[_t]+="/")})(ss,Lt,rs),rs.shift(),Lt={FileIndex:ss,FullPaths:Lt},it&&it.raw&&(Lt.raw={header:At,sectors:Bt}),Lt}function y(ge,it){return new Date(1e3*(ga(ge,it+4)/1e7*Math.pow(2,32)+ga(ge,it)/1e7-11644473600))}function j(ge,rt){var Ee=rt||{},rt=Ee.root||"Root Entry";if(ge.FullPaths||(ge.FullPaths=[]),ge.FileIndex||(ge.FileIndex=[]),ge.FullPaths.length!==ge.FileIndex.length)throw new Error("inconsistent CFB structure");ge.FullPaths.length===0&&(ge.FullPaths[0]=rt+"/",ge.FileIndex[0]={name:rt,type:5}),Ee.CLSID&&(ge.FileIndex[0].clsid=Ee.CLSID),rt=ge,Ee="Sh33tJ5",Zt.find(rt,"/"+Ee)||((ge=gt(4))[0]=55,ge[1]=ge[3]=50,ge[2]=54,rt.FileIndex.push({name:Ee,type:2,content:ge,size:4,L:69,R:69,C:69}),rt.FullPaths.push(rt.FullPaths[0]+Ee),k(rt))}function k(ge,it){j(ge);for(var Ee=!1,rt=!1,Ce=ge.FullPaths.length-1;0<=Ce;--Ce){var jt=ge.FileIndex[Ce];switch(jt.type){case 0:rt?Ee=!0:(ge.FileIndex.pop(),ge.FullPaths.pop());break;case 1:case 2:case 5:rt=!0,isNaN(jt.R*jt.L*jt.C)&&(Ee=!0),-1<jt.R&&-1<jt.L&&jt.R==jt.L&&(Ee=!0);break;default:Ee=!0}}if(Ee||it){for(var Ze=new Date(1987,1,19),ot=0,Qe=Object.create?Object.create(null):{},ft=[],Ce=0;Ce<ge.FullPaths.length;++Ce)Qe[ge.FullPaths[Ce]]=!0,ge.FileIndex[Ce].type!==0&&ft.push([ge.FullPaths[Ce],ge.FileIndex[Ce]]);for(Ce=0;Ce<ft.length;++Ce){var At=u(ft[Ce][0]);(rt=Qe[At])||(ft.push([At,{name:h(At).replace("/",""),type:1,clsid:J,ct:Ze,mt:Ze,content:null}]),Qe[At]=!0)}for(ft.sort(function(Bt,Qt){return(function(rs,ss){for(var Lt,Et=rs.split("/"),as=ss.split("/"),$t=0,_t=Math.min(Et.length,as.length);$t<_t;++$t){if(Lt=Et[$t].length-as[$t].length)return Lt;if(Et[$t]!=as[$t])return Et[$t]<as[$t]?-1:1}return Et.length-as.length})(Bt[0],Qt[0])}),ge.FullPaths=[],ge.FileIndex=[],Ce=0;Ce<ft.length;++Ce)ge.FullPaths[Ce]=ft[Ce][0],ge.FileIndex[Ce]=ft[Ce][1];for(Ce=0;Ce<ft.length;++Ce){var Kt=ge.FileIndex[Ce],Gt=ge.FullPaths[Ce];if(Kt.name=h(Gt).replace("/",""),Kt.L=Kt.R=Kt.C=-(Kt.color=1),Kt.size=Kt.content?Kt.content.length:0,Kt.start=0,Kt.clsid=Kt.clsid||J,Ce===0)Kt.C=1<ft.length?1:-1,Kt.size=0,Kt.type=5;else if(Gt.slice(-1)=="/"){for(ot=Ce+1;ot<ft.length&&u(ge.FullPaths[ot])!=Gt;++ot);for(Kt.C=ot>=ft.length?-1:ot,ot=Ce+1;ot<ft.length&&u(ge.FullPaths[ot])!=u(Gt);++ot);Kt.R=ot>=ft.length?-1:ot,Kt.type=1}else u(ge.FullPaths[Ce+1]||"")==u(Gt)&&(Kt.R=Ce+1),Kt.type=2}}}function E(ge,it){var Ee=it||{};if(Ee.fileType=="mad")return(function(Gt,Bt){for(var Qt=Bt||{},rs=Qt.boundary||"SheetJS",ss=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(rs="------="+rs).slice(2)+'"',"","",""],Lt=Gt.FullPaths[0],Et=Lt,as=Gt.FileIndex[0],$t=1;$t<Gt.FullPaths.length;++$t)if(Et=Gt.FullPaths[$t].slice(Lt.length),(as=Gt.FileIndex[$t]).size&&as.content&&Et!="Sh33tJ5"){Et=Et.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(es){return"_x"+es.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(es){return"_u"+es.charCodeAt(0).toString(16)+"_"});for(var _t=as.content,os=xe&&Buffer.isBuffer(_t)?_t.toString("binary"):z(_t),ns=0,gr=Math.min(1024,os.length),us=0,js=0;js<=gr;++js)32<=(us=os.charCodeAt(js))&&us<128&&++ns;_t=4*gr/5<=ns,ss.push(rs),ss.push("Content-Location: "+(Qt.root||"file:///C:/SheetJS/")+Et),ss.push("Content-Transfer-Encoding: "+(_t?"quoted-printable":"base64")),ss.push("Content-Type: "+(function(i,Us){if(i.ctype)return i.ctype;var Rs=i.name||"",i=Rs.match(/\.([^\.]+)$/);return i&&fa[i[1]]||Us&&(i=(Rs=Us).match(/[\.\\]([^\.\\])+$/))&&fa[i[1]]?fa[i[1]]:"application/octet-stream"})(as,Et)),ss.push(""),ss.push((_t?function(es){es=es.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(A){return A=A.charCodeAt(0).toString(16).toUpperCase(),"="+(A.length==1?"0"+A:A)}),(es=es.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)==`
`&&(es="=0D"+es.slice(1)),es=es.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,`
=0A`).replace(/([^\r\n])\n/gm,"$1=0A");for(var Us=[],Rs=es.split(`\r
`),i=0;i<Rs.length;++i){var c=Rs[i];if(c.length!=0)for(var f=0;f<c.length;){var p=76,C=c.slice(f,f+p);C.charAt(p-1)=="="?p--:C.charAt(p-2)=="="?p-=2:C.charAt(p-3)=="="&&(p-=3),C=c.slice(f,f+p),(f+=p)<c.length&&(C+="="),Us.push(C)}else Us.push("")}return Us.join(`\r
`)}:function(es){for(var Us=re(es),Rs=[],i=0;i<Us.length;i+=76)Rs.push(Us.slice(i,i+76));return Rs.join(`\r
`)+`\r
`})(os))}return ss.push(rs+`--\r
`),ss.join(`\r
`)})(ge,Ee);if(k(ge),Ee.fileType==="zip")return(function(Gt,Qt){var Qt=Qt||{},rs=[],ss=[],Lt=gt(1),Et=Qt.compression?8:0,as=0,$t=0,_t=0,os=0,ns=0,gr=Gt.FullPaths[0],us=gr,js=Gt.FileIndex[0],es=[],Us=0;for($t=1;$t<Gt.FullPaths.length;++$t)if(us=Gt.FullPaths[$t].slice(gr.length),(js=Gt.FileIndex[$t]).size&&js.content&&us!="Sh33tJ5"){var Rs=os,i=gt(us.length);for(_t=0;_t<us.length;++_t)i.write_shift(1,127&us.charCodeAt(_t));i=i.slice(0,i.l),es[ns]=Wn.buf(js.content,0);var c=js.content;Et==8&&(c=(function(f){return T?T.deflateRawSync(f):Wt(f)})(c)),(Lt=gt(30)).write_shift(4,67324752),Lt.write_shift(2,20),Lt.write_shift(2,as),Lt.write_shift(2,Et),js.mt?(function(f,p){var C=(p=typeof p=="string"?new Date(p):p).getHours();C=(C=C<<6|p.getMinutes())<<5|p.getSeconds()>>>1,f.write_shift(2,C),C=(C=(C=p.getFullYear()-1980)<<4|p.getMonth()+1)<<5|p.getDate(),f.write_shift(2,C)})(Lt,js.mt):Lt.write_shift(4,0),Lt.write_shift(-4,es[ns]),Lt.write_shift(4,c.length),Lt.write_shift(4,js.content.length),Lt.write_shift(2,i.length),Lt.write_shift(2,0),os+=Lt.length,rs.push(Lt),os+=i.length,rs.push(i),os+=c.length,rs.push(c),(Lt=gt(46)).write_shift(4,33639248),Lt.write_shift(2,0),Lt.write_shift(2,20),Lt.write_shift(2,as),Lt.write_shift(2,Et),Lt.write_shift(4,0),Lt.write_shift(-4,es[ns]),Lt.write_shift(4,c.length),Lt.write_shift(4,js.content.length),Lt.write_shift(2,i.length),Lt.write_shift(2,0),Lt.write_shift(2,0),Lt.write_shift(2,0),Lt.write_shift(2,0),Lt.write_shift(4,0),Lt.write_shift(4,Rs),Us+=Lt.l,ss.push(Lt),Us+=i.length,ss.push(i),++ns}return(Lt=gt(22)).write_shift(4,101010256),Lt.write_shift(2,0),Lt.write_shift(2,0),Lt.write_shift(2,ns),Lt.write_shift(2,ns),Lt.write_shift(4,Us),Lt.write_shift(4,os),Lt.write_shift(2,0),he([he(rs),he(ss),Lt])})(ge,Ee);for(var rt=(function(Gt){for(var Bt=0,Qt=0,rs=0;rs<Gt.FileIndex.length;++rs){var ss=Gt.FileIndex[rs];ss.content&&0<(ss=ss.content.length)&&(ss<4096?Bt+=ss+63>>6:Qt+=ss+511>>9)}for(var Lt=Gt.FullPaths.length+3>>2,Et=Bt+127>>7,as=(Bt+7>>3)+Qt+Lt+Et,$t=as+127>>7,_t=$t<=109?0:Math.ceil(($t-109)/127);$t<as+$t+_t+127>>7;)_t=++$t<=109?0:Math.ceil(($t-109)/127);return Lt=[1,_t,$t,Et,Lt,Qt,Bt,0],Gt.FileIndex[0].size=Bt<<6,Lt[7]=(Gt.FileIndex[0].start=Lt[0]+Lt[1]+Lt[2]+Lt[3]+Lt[4]+Lt[5])+(Lt[6]+7>>3),Lt})(ge),Ce=gt(rt[7]<<9),Ze=0,jt=0,Ze=0;Ze<8;++Ze)Ce.write_shift(1,I[Ze]);for(Ze=0;Ze<8;++Ze)Ce.write_shift(2,0);for(Ce.write_shift(2,62),Ce.write_shift(2,3),Ce.write_shift(2,65534),Ce.write_shift(2,9),Ce.write_shift(2,6),Ze=0;Ze<3;++Ze)Ce.write_shift(2,0);for(Ce.write_shift(4,0),Ce.write_shift(4,rt[2]),Ce.write_shift(4,rt[0]+rt[1]+rt[2]+rt[3]-1),Ce.write_shift(4,0),Ce.write_shift(4,4096),Ce.write_shift(4,rt[3]?rt[0]+rt[1]+rt[2]-1:R),Ce.write_shift(4,rt[3]),Ce.write_shift(-4,rt[1]?rt[0]-1:R),Ce.write_shift(4,rt[1]),Ze=0;Ze<109;++Ze)Ce.write_shift(-4,Ze<rt[2]?rt[1]+Ze:-1);if(rt[1])for(jt=0;jt<rt[1];++jt){for(;Ze<236+127*jt;++Ze)Ce.write_shift(-4,Ze<rt[2]?rt[1]+Ze:-1);Ce.write_shift(-4,jt===rt[1]-1?R:jt+1)}function ot(Gt){for(jt+=Gt;Ze<jt-1;++Ze)Ce.write_shift(-4,Ze+1);Gt&&(++Ze,Ce.write_shift(-4,R))}for(jt=Ze=0,jt+=rt[1];Ze<jt;++Ze)Ce.write_shift(-4,Y.DIFSECT);for(jt+=rt[2];Ze<jt;++Ze)Ce.write_shift(-4,Y.FATSECT);ot(rt[3]),ot(rt[4]);for(var Qe=0,ft=0,At=ge.FileIndex[0];Qe<ge.FileIndex.length;++Qe)(At=ge.FileIndex[Qe]).content&&((ft=At.content.length)<4096||(At.start=jt,ot(ft+511>>9)));for(ot(rt[6]+7>>3);511&Ce.l;)Ce.write_shift(-4,Y.ENDOFCHAIN);for(Qe=jt=Ze=0;Qe<ge.FileIndex.length;++Qe)(At=ge.FileIndex[Qe]).content&&(!(ft=At.content.length)||4096<=ft||(At.start=jt,ot(ft+63>>6)));for(;511&Ce.l;)Ce.write_shift(-4,Y.ENDOFCHAIN);for(Ze=0;Ze<rt[4]<<2;++Ze){var Kt=ge.FullPaths[Ze];if(Kt&&Kt.length!==0){if(At=ge.FileIndex[Ze],Ze===0&&(At.start=At.size?At.start-1:R),Kt=Ze===0&&Ee.root||At.name,ft=2*(Kt.length+1),Ce.write_shift(64,Kt,"utf16le"),Ce.write_shift(2,ft),Ce.write_shift(1,At.type),Ce.write_shift(1,At.color),Ce.write_shift(-4,At.L),Ce.write_shift(-4,At.R),Ce.write_shift(-4,At.C),At.clsid)Ce.write_shift(16,At.clsid,"hex");else for(Qe=0;Qe<4;++Qe)Ce.write_shift(4,0);Ce.write_shift(4,At.state||0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,At.start),Ce.write_shift(4,At.size),Ce.write_shift(4,0)}else{for(Qe=0;Qe<17;++Qe)Ce.write_shift(4,0);for(Qe=0;Qe<3;++Qe)Ce.write_shift(4,-1);for(Qe=0;Qe<12;++Qe)Ce.write_shift(4,0)}}for(Ze=1;Ze<ge.FileIndex.length;++Ze)if(4096<=(At=ge.FileIndex[Ze]).size)if(Ce.l=At.start+1<<9,xe&&Buffer.isBuffer(At.content))At.content.copy(Ce,Ce.l,0,At.size),Ce.l+=At.size+511&-512;else{for(Qe=0;Qe<At.size;++Qe)Ce.write_shift(1,At.content[Qe]);for(;511&Qe;++Qe)Ce.write_shift(1,0)}for(Ze=1;Ze<ge.FileIndex.length;++Ze)if(0<(At=ge.FileIndex[Ze]).size&&At.size<4096)if(xe&&Buffer.isBuffer(At.content))At.content.copy(Ce,Ce.l,0,At.size),Ce.l+=At.size+63&-64;else{for(Qe=0;Qe<At.size;++Qe)Ce.write_shift(1,At.content[Qe]);for(;63&Qe;++Qe)Ce.write_shift(1,0)}if(xe)Ce.l=Ce.length;else for(;Ce.l<Ce.length;)Ce.write_shift(1,0);return Ce}d.version="1.2.1";var T,_=64,R=-2,q="d0cf11e0a1b11ae1",I=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function z(ge){for(var it=new Array(ge.length),Ee=0;Ee<ge.length;++Ee)it[Ee]=String.fromCharCode(ge[Ee]);return it.join("")}for(var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Ae,Ve=typeof Uint8Array<"u",Oe=Ve?new Uint8Array(256):[],Je=0;Je<256;++Je)Oe[Je]=255&((Ae=139536&((Ae=Je)<<1|Ae<<11)|558144&(Ae<<5|Ae<<15))>>16|Ae>>8|Ae);function pt(ge,rt){var Ee=7&rt,rt=rt>>>3;return(ge[rt]|(Ee<=5?0:ge[1+rt]<<8))>>>Ee&7}function xt(ge,rt){var Ee=7&rt,rt=rt>>>3;return(ge[rt]|(Ee<=3?0:ge[1+rt]<<8))>>>Ee&31}function at(ge,rt){var Ee=7&rt,rt=rt>>>3;return(ge[rt]|(Ee<=1?0:ge[1+rt]<<8))>>>Ee&127}function Ct(ge,Ze,Ee){var rt=7&Ze,Ce=Ze>>>3,jt=(1<<Ee)-1,Ze=ge[Ce]>>>rt;return Ee<8-rt?Ze&jt:(Ze|=ge[1+Ce]<<8-rt,Ee<16-rt?Ze&jt:(Ze|=ge[2+Ce]<<16-rt,Ee<24-rt?Ze&jt:(Ze|=ge[3+Ce]<<24-rt)&jt))}function Vt(ge,it,Ee){var rt=7&it,Ce=it>>>3;return rt<=5?ge[Ce]|=(7&Ee)<<rt:(ge[Ce]|=Ee<<rt&255,ge[1+Ce]=(7&Ee)>>8-rt),it+3}function Ut(ge,it,Ee){var rt=it>>>3;return Ee<<=7&it,ge[rt]|=255&Ee,Ee>>>=8,ge[1+rt]=Ee,it+8}function Ft(ge,it,Ee){var rt=it>>>3;return Ee<<=7&it,ge[rt]|=255&Ee,Ee>>>=8,ge[1+rt]=255&Ee,ge[2+rt]=Ee>>>8,it+16}function Mt(ge,it){var Ee=ge.length,rt=it<2*Ee?2*Ee:it+5,Ce=0;if(it<=Ee)return ge;if(xe){var jt=ce(rt);if(ge.copy)ge.copy(jt);else for(;Ce<ge.length;++Ce)jt[Ce]=ge[Ce];return jt}if(Ve){var Ze=new Uint8Array(rt);if(Ze.set)Ze.set(ge);else for(;Ce<Ee;++Ce)Ze[Ce]=ge[Ce];return Ze}return ge.length=rt,ge}function Dt(ge){for(var it=new Array(ge),Ee=0;Ee<ge;++Ee)it[Ee]=0;return it}function wt(ge,it,Ee){for(var rt,Ce=1,ft=0,jt=0,Ze=0,ot=ge.length,Qe=Ve?new Uint16Array(32):Dt(32),ft=0;ft<32;++ft)Qe[ft]=0;for(ft=ot;ft<Ee;++ft)ge[ft]=0;ot=ge.length;var At=Ve?new Uint16Array(ot):Dt(ot);for(ft=0;ft<ot;++ft)Qe[rt=ge[ft]]++,Ce<rt&&(Ce=rt),At[ft]=0;for(Qe[0]=0,ft=1;ft<=Ce;++ft)Qe[ft+16]=Ze=Ze+Qe[ft-1]<<1;for(ft=0;ft<ot;++ft)(Ze=ge[ft])!=0&&(At[ft]=Qe[Ze+16]++);var Kt,Gt,Bt,Qt;for(ft=0;ft<ot;++ft)if((Kt=ge[ft])!=0)for(Gt=At[ft],Bt=Ce,Qt=void 0,Qt=Oe[255&Gt],Ze=(Bt<=8?Qt>>>8-Bt:(Qt=Qt<<8|Oe[Gt>>8&255],Bt<=16?Qt>>>16-Bt:(Qt=Qt<<8|Oe[Gt>>16&255])>>>24-Bt))>>Ce-Kt,jt=(1<<Ce+4-Kt)-1;0<=jt;--jt)it[Ze|jt<<Kt]=15&Kt|ft<<4;return Ce}var Yt=Ve?new Uint16Array(512):Dt(512),Jt=Ve?new Uint16Array(32):Dt(32);if(!Ve){for(var is=0;is<512;++is)Yt[is]=0;for(is=0;is<32;++is)Jt[is]=0}(function(){for(var ge=[],it=0;it<32;it++)ge.push(5);wt(ge,Jt,32);for(var Ee=[],it=0;it<=143;it++)Ee.push(8);for(;it<=255;it++)Ee.push(9);for(;it<=279;it++)Ee.push(7);for(;it<=287;it++)Ee.push(8);wt(Ee,Yt,288)})();var Fs=(function(){for(var ge=Ve?new Uint8Array(32768):[],it=0,Ee=0;it<le.length-1;++it)for(;Ee<le[it+1];++Ee)ge[Ee]=it;for(;Ee<32768;++Ee)ge[Ee]=29;for(var rt=Ve?new Uint8Array(259):[],it=0,Ee=0;it<ie.length-1;++it)for(;Ee<ie[it+1];++Ee)rt[Ee]=it;return function(Ce,jt){return(Ce.length<8?function(Ze,ot){for(var Qe=0;Qe<Ze.length;){var ft=Math.min(65535,Ze.length-Qe),At=Qe+ft==Ze.length;for(ot.write_shift(1,+At),ot.write_shift(2,ft),ot.write_shift(2,65535&~ft);0<ft--;)ot[ot.l++]=Ze[Qe++]}return ot.l}:function(Ze,ot){for(var Qe=0,ft=0,At=Ve?new Uint16Array(32768):[];ft<Ze.length;){var Kt=Math.min(65535,Ze.length-ft);if(Kt<10){for(7&(Qe=Vt(ot,Qe,+(ft+Kt==Ze.length)))&&(Qe+=8-(7&Qe)),ot.l=Qe/8|0,ot.write_shift(2,Kt),ot.write_shift(2,65535&~Kt);0<Kt--;)ot[ot.l++]=Ze[ft++];Qe=8*ot.l}else{Qe=Vt(ot,Qe,+(ft+Kt==Ze.length)+2);for(var Gt=0;0<Kt--;){var Bt=Ze[ft],Gt=32767&(Gt<<5^Bt),Qt=-1,rs=0;if((Qt=At[Gt])&&(ft<(Qt|=-32768&ft)&&(Qt-=32768),Qt<ft))for(;Ze[Qt+rs]==Ze[ft+rs]&&rs<250;)++rs;if(2<rs){(Bt=rt[rs])<=22?Qe=Ut(ot,Qe,Oe[Bt+1]>>1)-1:(Ut(ot,Qe,3),Ut(ot,Qe+=5,Oe[Bt-23]>>5),Qe+=3);var ss=Bt<8?0:Bt-4>>2;0<ss&&(Ft(ot,Qe,rs-ie[Bt]),Qe+=ss),Bt=ge[ft-Qt],Qe=Ut(ot,Qe,Oe[Bt]>>3),Qe-=3;var Lt=Bt<4?0:Bt-2>>1;0<Lt&&(Ft(ot,Qe,ft-Qt-le[Bt]),Qe+=Lt);for(var Et=0;Et<rs;++Et)At[Gt]=32767&ft,Gt=32767&(Gt<<5^Ze[ft]),++ft;Kt-=rs-1}else Bt<=143?Bt+=48:(ss=((ss=1)&ss)<<(7&(Lt=Qe)),ot[Lt>>>3]|=ss,Qe=Lt+1),Qe=Ut(ot,Qe,Oe[Bt]),At[Gt]=32767&ft,++ft}Qe=Ut(ot,Qe,0)-1}}return ot.l=(Qe+7)/8|0,ot.l})(Ce,jt)}})();function Wt(Ee){var it=gt(50+Math.floor(1.1*Ee.length)),Ee=Fs(Ee,it);return it.slice(0,Ee)}var St=Ve?new Uint16Array(32768):Dt(32768),xs=Ve?new Uint16Array(32768):Dt(32768),Hs=Ve?new Uint16Array(128):Dt(128),Is=1,tr=1;function Ir(ge,it){if(ge[0]==3&&!(3&ge[1]))return[Z(it),2];for(var Ee=0,rt=0,Ce=ce(it||1<<18),jt=0,Ze=Ce.length>>>0,ot=0,Qe=0;(1&rt)==0;)if(rt=pt(ge,Ee),Ee+=3,rt>>>1!=0)for(Qe=rt>>1==1?(ot=9,5):(Ee=(function(rs,ss){var Lt,Et,as,$t=xt(rs,ss)+257,_t=xt(rs,ss+=5)+1,os=(as=7&(Et=ss+=5),4+(((Lt=rs)[Et=Et>>>3]|(as<=4?0:Lt[1+Et]<<8))>>>as&15));ss+=4;for(var ns=0,gr=Ve?new Uint8Array(19):Dt(19),us=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],js=1,es=Ve?new Uint8Array(8):Dt(8),Us=Ve?new Uint8Array(8):Dt(8),Rs=gr.length,i=0;i<os;++i)gr[X[i]]=ns=pt(rs,ss),js<ns&&(js=ns),es[ns]++,ss+=3;var c=0;for(es[0]=0,i=1;i<=js;++i)Us[i]=c=c+es[i-1]<<1;for(i=0;i<Rs;++i)(c=gr[i])!=0&&(us[i]=Us[c]++);for(var f,i=0;i<Rs;++i)if((f=gr[i])!=0){c=Oe[us[i]]>>8-f;for(var p=(1<<7-f)-1;0<=p;--p)Hs[c|p<<f]=7&f|i<<3}for(var C,A,U,ee=[],js=1;ee.length<$t+_t;)switch(ss+=7&(c=Hs[at(rs,ss)]),c>>>=3){case 16:for(ns=3+(U=void 0,U=7&(A=ss),((C=rs)[A=A>>>3]|(U<=6?0:C[1+A]<<8))>>>U&3),ss+=2,c=ee[ee.length-1];0<ns--;)ee.push(c);break;case 17:for(ns=3+pt(rs,ss),ss+=3;0<ns--;)ee.push(0);break;case 18:for(ns=11+at(rs,ss),ss+=7;0<ns--;)ee.push(0);break;default:ee.push(c),js<c&&(js=c)}var je=ee.slice(0,$t),Ye=ee.slice($t);for(i=$t;i<286;++i)je[i]=0;for(i=_t;i<30;++i)Ye[i]=0;return Is=wt(je,St,286),tr=wt(Ye,xs,30),ss})(ge,Ee),ot=Is,tr);;){!it&&Ze<jt+32767&&(Ze=(Ce=Mt(Ce,jt+32767)).length);var ft=Ct(ge,Ee,ot),At=(rt>>>1==1?Yt:St)[ft];if(Ee+=15&At,((At>>>=4)>>>8&255)==0)Ce[jt++]=At;else{if(At==256)break;var Kt=(At-=257)<8?0:At-4>>2;5<Kt&&(Kt=0);var Gt=jt+ie[At];0<Kt&&(Gt+=Ct(ge,Ee,Kt),Ee+=Kt),ft=Ct(ge,Ee,Qe),Ee+=15&(At=(rt>>>1==1?Jt:xs)[ft]);var ft=(At>>>=4)<4?0:At-2>>1,Bt=le[At];for(0<ft&&(Bt+=Ct(ge,Ee,ft),Ee+=ft),!it&&Ze<Gt&&(Ze=(Ce=Mt(Ce,Gt+100)).length);jt<Gt;)Ce[jt]=Ce[jt-Bt],++jt}}else{7&Ee&&(Ee+=8-(7&Ee));var Qt=ge[Ee>>>3]|ge[1+(Ee>>>3)]<<8;if(Ee+=32,0<Qt)for(!it&&Ze<jt+Qt&&(Ze=(Ce=Mt(Ce,jt+Qt)).length);0<Qt--;)Ce[jt++]=ge[Ee>>>3],Ee+=8}return it?[Ce,Ee+7>>>3]:[Ce.slice(0,jt),Ee+7>>>3]}function Fe(ge,it){return it=Ir(ge.slice(ge.l||0),it),ge.l+=it[1],it[0]}function sr(ge,it){if(!ge)throw new Error(it);typeof console<"u"&&console.error(it)}function qs(ge,it){var Ee=ge;ka(Ee,0);var rt={FileIndex:[],FullPaths:[]};j(rt,{root:it.root});for(var Ce=Ee.length-4;(Ee[Ce]!=80||Ee[Ce+1]!=75||Ee[Ce+2]!=5||Ee[Ce+3]!=6)&&0<=Ce;)--Ce;Ee.l=Ce+4,Ee.l+=4;var jt=Ee.read_shift(2);for(Ee.l+=6,it=Ee.read_shift(4),Ee.l=it,Ce=0;Ce<jt;++Ce){Ee.l+=20;var Ze=Ee.read_shift(4),ot=Ee.read_shift(4),Qe=Ee.read_shift(2),ft=Ee.read_shift(2),At=Ee.read_shift(2);Ee.l+=8;var Kt=Ee.read_shift(4),Gt=g(Ee.slice(Ee.l+Qe,Ee.l+Qe+ft));Ee.l+=Qe+ft+At,At=Ee.l,Ee.l=Kt+4,(function(Bt,Qt,rs,ss,Lt){Bt.l+=2;var Et=Bt.read_shift(2),as=Bt.read_shift(2),$t=(function(C){var i=65535&C.read_shift(2),c=65535&C.read_shift(2),f=new Date,p=31&c,C=15&(c>>>=5);return c>>>=4,f.setMilliseconds(0),f.setFullYear(1980+c),f.setMonth(C-1),f.setDate(p),C=31&i,p=63&(i>>>=5),i>>>=6,f.setHours(i),f.setMinutes(p),f.setSeconds(C<<1),f})(Bt);if(8257&Et)throw new Error("Unsupported ZIP encryption");Bt.read_shift(4);for(var _t,os=Bt.read_shift(4),ns=Bt.read_shift(4),gr=Bt.read_shift(2),us=Bt.read_shift(2),js="",es=0;es<gr;++es)js+=String.fromCharCode(Bt[Bt.l++]);us&&(((_t=g(Bt.slice(Bt.l,Bt.l+us)))[21589]||{}).mt&&($t=_t[21589].mt),((Lt||{})[21589]||{}).mt&&($t=Lt[21589].mt)),Bt.l+=us;var Us=Bt.slice(Bt.l,Bt.l+os);switch(as){case 8:Us=(function(Rs,f){if(!T)return Fe(Rs,f);var c=new T.InflateRaw,f=c._processChunk(Rs.slice(Rs.l),c._finishFlushFlag);return Rs.l+=c.bytesRead,f})(Bt,ns);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+as)}us=!1,8&Et&&(Bt.read_shift(4)==134695760&&(Bt.read_shift(4),us=!0),os=Bt.read_shift(4),ns=Bt.read_shift(4)),os!=Qt&&sr(us,"Bad compressed size: "+Qt+" != "+os),ns!=rs&&sr(us,"Bad uncompressed size: "+rs+" != "+ns),Pn(ss,js,Us,{unsafe:!0,mt:$t})})(Ee,Ze,ot,rt,Gt),Ee.l=At}return rt}var fa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Pn(ge,it,Ee,rt){var Ce=rt&&rt.unsafe;Ce||j(ge);var jt,Ze=!Ce&&Zt.find(ge,it);return Ze||(jt=ge.FullPaths[0],jt=it.slice(0,jt.length)==jt?it:(jt.slice(-1)!="/"&&(jt+="/"),(jt+it).replace("//","/")),Ze={name:h(it),type:2},ge.FileIndex.push(Ze),ge.FullPaths.push(jt),Ce||Zt.utils.cfb_gc(ge)),Ze.content=Ee,Ze.size=Ee?Ee.length:0,rt&&(rt.CLSID&&(Ze.clsid=rt.CLSID),rt.mt&&(Ze.mt=rt.mt),rt.ct&&(Ze.ct=rt.ct)),Ze}return d.find=function(ge,it){var Ee=ge.FullPaths.map(function(Qe){return Qe.toUpperCase()}),rt=Ee.map(function(Qe){var ft=Qe.split("/");return ft[ft.length-(Qe.slice(-1)=="/"?2:1)]}),Ce=!1;it.charCodeAt(0)===47?(Ce=!0,it=Ee[0].slice(0,-1)+it):Ce=it.indexOf("/")!==-1;var ot=it.toUpperCase(),jt=(Ce===!0?Ee:rt).indexOf(ot);if(jt!==-1)return ge.FileIndex[jt];var Ze=!ot.match(Te),ot=ot.replace(ye,"");for(Ze&&(ot=ot.replace(Te,"!")),jt=0;jt<Ee.length;++jt)if((Ze?Ee[jt].replace(Te,"!"):Ee[jt]).replace(ye,"")==ot||(Ze?rt[jt].replace(Te,"!"):rt[jt]).replace(ye,"")==ot)return ge.FileIndex[jt];return null},d.read=function(ge,it){var Ee,rt,Ce=it&&it.type;switch(Ce||xe&&Buffer.isBuffer(ge)&&(Ce="buffer"),Ce||"base64"){case"file":return Ee=ge,rt=it,b(),x(r.readFileSync(Ee),rt);case"base64":return x(ue(Ne(ge)),it);case"binary":return x(ue(ge),it)}return x(ge,it)},d.parse=x,d.write=function(ge,it){var Ee=E(ge,it);switch(it&&it.type||"buffer"){case"file":return b(),r.writeFileSync(it.filename,Ee),Ee;case"binary":return typeof Ee=="string"?Ee:z(Ee);case"base64":return re(typeof Ee=="string"?Ee:z(Ee));case"buffer":if(xe)return Buffer.isBuffer(Ee)?Ee:we(Ee);case"array":return typeof Ee=="string"?ue(Ee):Ee}return Ee},d.writeFile=function(ge,it,Ee){b(),Ee=E(ge,Ee),r.writeFileSync(it,Ee)},d.utils={cfb_new:function(ge){var it={};return j(it,ge),it},cfb_add:Pn,cfb_del:function(ge,it){j(ge);var Ee=Zt.find(ge,it);if(Ee){for(var rt=0;rt<ge.FileIndex.length;++rt)if(ge.FileIndex[rt]==Ee)return ge.FileIndex.splice(rt,1),ge.FullPaths.splice(rt,1),!0}return!1},cfb_mov:function(ge,it,Ee){j(ge);var rt=Zt.find(ge,it);if(rt){for(var Ce=0;Ce<ge.FileIndex.length;++Ce)if(ge.FileIndex[Ce]==rt)return ge.FileIndex[Ce].name=h(Ee),ge.FullPaths[Ce]=Ee,!0}return!1},cfb_gc:function(ge){k(ge,!0)},ReadShift:Go,CheckField:jm,prep_blob:ka,bconcat:he,use_zlib:function(ge){try{var it=new ge.InflateRaw;if(it._processChunk(new Uint8Array([3,0]),it._finishFlushFlag),!it.bytesRead)throw new Error("zlib does not expose bytesRead");T=ge}catch(Ee){console.error("cannot use native zlib: "+(Ee.message||Ee))}},_deflateRaw:Wt,_inflateRaw:Fe,consts:Y},d})();if(typeof fp<"u")try{Ba=I1}catch{}function Yl(r){return typeof r=="string"?Le(r):Array.isArray(r)?(function(d){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(d)})(r):r}function Ds(r,d,u){if(Ba!==void 0&&Ba.writeFileSync)return u?Ba.writeFileSync(r,d,u):Ba.writeFileSync(r,d);if(typeof Deno<"u"){if(u&&typeof d=="string")switch(u){case"utf8":d=new TextEncoder(u).encode(d);break;case"binary":d=Le(d);break;default:throw new Error("Unsupported encoding "+u)}return Deno.writeFileSync(r,d)}var h=u=="utf8"?Ke(d):d;if(typeof IE_SaveFile<"u")return IE_SaveFile(h,r);if(typeof Blob<"u"){if(h=new Blob([Yl(h)],{type:"application/octet-stream"}),typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(h,r);if(typeof saveAs<"u")return saveAs(h,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var g=URL.createObjectURL(h);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),chrome.downloads.download({url:g,filename:r,saveAs:!0});if(h=document.createElement("a"),h.download!=null)return h.download=r,h.href=g,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),g}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var b=File(r);return b.open("w"),b.encoding="binary",Array.isArray(d)&&(d=be(d)),b.write(d),b.close(),d}catch(x){if(!x.message||!x.message.match(/onstruct/))throw x}throw new Error("cannot save file "+r)}function wr(r){for(var d=Object.keys(r),u=[],h=0;h<d.length;++h)Object.prototype.hasOwnProperty.call(r,d[h])&&u.push(d[h]);return u}function Yc(r,d){for(var u=[],h=wr(r),g=0;g!==h.length;++g)u[r[h[g]][d]]==null&&(u[r[h[g]][d]]=h[g]);return u}function $n(r){for(var d=[],u=wr(r),h=0;h!==u.length;++h)d[r[u[h]]]=u[h];return d}function Fi(r){for(var d=[],u=wr(r),h=0;h!==u.length;++h)d[r[u[h]]]=parseInt(u[h],10);return d}var Gl=new Date(1899,11,30,0,0,0);function Dr(r,d){var u=r.getTime();return(u-(Gl.getTime()+6e4*(r.getTimezoneOffset()-Gl.getTimezoneOffset())))/864e5}var ul=new Date,hl=Gl.getTime()+6e4*(ul.getTimezoneOffset()-Gl.getTimezoneOffset()),Mi=ul.getTimezoneOffset();function Li(r){var d=new Date;return d.setTime(24*r*60*60*1e3+hl),d.getTimezoneOffset()!==Mi&&d.setTime(d.getTime()+6e4*(d.getTimezoneOffset()-Mi)),d}var $r=new Date("2017-02-19T19:06:09.000Z"),Fa=isNaN($r.getFullYear())?new Date("2/19/17"):$r,oa=Fa.getFullYear()==2017;function Ts(r,d){var u=new Date(r);return oa?(0<d?u.setTime(u.getTime()+60*u.getTimezoneOffset()*1e3):d<0&&u.setTime(u.getTime()-60*u.getTimezoneOffset()*1e3),u):r instanceof Date?r:Fa.getFullYear()==1917&&!isNaN(u.getFullYear())?(d=u.getFullYear(),-1<r.indexOf(""+d)||u.setFullYear(u.getFullYear()+100),u):(u=r.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+u[0],+u[1]-1,+u[2],+u[3]||0,+u[4]||0,+u[5]||0),u=-1<r.indexOf("Z")?new Date(u.getTime()-60*u.getTimezoneOffset()*1e3):u)}function ur(r,d){if(xe&&Buffer.isBuffer(r)){if(d){if(r[0]==255&&r[1]==254)return Ke(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return Ke(F(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(d){if(r[0]==255&&r[1]==254)return Ke(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return Ke(new TextDecoder("utf-16be").decode(r.slice(2)))}var u={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(b){return u[b]||b})}catch{}for(var h=[],g=0;g!=r.length;++g)h.push(String.fromCharCode(r[g]));return h.join("")}function Ys(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var d,u={};for(d in r)Object.prototype.hasOwnProperty.call(r,d)&&(u[d]=Ys(r[d]));return u}function jr(r,d){for(var u="";u.length<d;)u+=r;return u}function on(h){var d=Number(h);if(!isNaN(d))return isFinite(d)?d:NaN;if(!/\d/.test(h))return d;var u=1,h=h.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return u*=100,""});return isNaN(d=Number(h))?(h=h.replace(/[(](.*)[)]/,function(g,b){return u=-u,b}),isNaN(d=Number(h))?d:d/u):d/u}var di=["january","february","march","april","may","june","july","august","september","october","november","december"];function Cn(r){var d=new Date(r),u=new Date(NaN),h=d.getYear(),g=d.getMonth(),b=d.getDate();if(isNaN(b))return u;var x=r.toLowerCase();if(x.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(x=x.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&di.indexOf(x)==-1)return u}else if(x.match(/[a-z]/))return u;return h<0||8099<h||(!(0<g||1<b)||h==101)&&r.match(/[^-0-9:,\/\\]/)?u:d}var fl,Na=(fl="abacaba".split(/(:?b)/i).length==5,function(r,d,u){if(fl||typeof d=="string")return r.split(d);for(var h=r.split(d),g=[h[0]],b=1;b<h.length;++b)g.push(u),g.push(h[b]);return g});function cn(r){return r?r.content&&r.type?ur(r.content,!0):r.data?O(r.data):r.asNodeBuffer&&xe?O(r.asNodeBuffer().toString("binary")):r.asBinary?O(r.asBinary()):r._data&&r._data.getContent?O(ur(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function Sn(r){if(!r)return null;if(r.data)return M(r.data);if(r.asNodeBuffer&&xe)return r.asNodeBuffer();if(r._data&&r._data.getContent){var d=r._data.getContent();return typeof d=="string"?M(d):Array.prototype.slice.call(d)}return r.content&&r.type?r.content:null}function ca(r,d){for(var u=r.FullPaths||wr(r.files),h=d.toLowerCase().replace(/[\/]/g,"\\"),g=h.replace(/\\/g,"/"),b=0;b<u.length;++b){var x=u[b].replace(/^Root Entry[\/]/,"").toLowerCase();if(h==x||g==x)return r.files?r.files[u[b]]:r.FileIndex[b]}return null}function qr(r,d){if(r=ca(r,d),r==null)throw new Error("Cannot find file "+d+" in zip");return r}function zr(r,d,u){if(!u)return((u=qr(r,d))&&u.name.slice(-4)===".bin"?Sn:cn)(u);if(!d)return null;try{return zr(r,d)}catch{return null}}function Ma(r,d,u){if(!u)return cn(qr(r,d));if(!d)return null;try{return Ma(r,d)}catch{return null}}function ui(r){for(var d=r.FullPaths||wr(r.files),u=[],h=0;h<d.length;++h)d[h].slice(-1)!="/"&&u.push(d[h].replace(/^Root Entry[\/]/,""));return u.sort()}function cs(r,d,u){if(r.FullPaths){if(typeof u=="string"){var h=(xe?we:function(g){for(var b=[],x=0,y=g.length+250,j=Z(g.length+255),k=0;k<g.length;++k){var E,T=g.charCodeAt(k);T<128?j[x++]=T:T<2048?(j[x++]=192|T>>6&31,j[x++]=128|63&T):55296<=T&&T<57344?(T=64+(1023&T),E=1023&g.charCodeAt(++k),j[x++]=240|T>>8&7,j[x++]=128|T>>2&63,j[x++]=128|E>>6&15|(3&T)<<4,j[x++]=128|63&E):(j[x++]=224|T>>12&15,j[x++]=128|T>>6&63,j[x++]=128|63&T),y<x&&(b.push(j.slice(0,x)),x=0,j=Z(65535),y=65530)}return b.push(j.slice(0,x)),he(b)})(u);return Zt.utils.cfb_add(r,d,h)}Zt.utils.cfb_add(r,d,u)}else r.file(d,u)}function Gc(){return Zt.utils.cfb_new()}function hi(r,d){switch(d.type){case"base64":return Zt.read(r,{type:"base64"});case"binary":return Zt.read(r,{type:"binary"});case"buffer":case"array":return Zt.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+d.type)}function Nr(r,d){if(r.charAt(0)=="/")return r.slice(1);var u=d.split("/");d.slice(-1)!="/"&&u.pop();for(var h=r.split("/");h.length!==0;){var g=h.shift();g===".."?u.pop():g!=="."&&u.push(g)}return u.join("/")}var kr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Uo=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Fd=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Mr=kr.match(Fd)?Fd:/<[^>]*>/g,qn=/<\w*:/,Ka=/<(\/?)\w+:/;function gs(r,d,u){for(var h={},g=0,b=0;g!==r.length&&(b=r.charCodeAt(g))!==32&&b!==10&&b!==13;++g);if(d||(h[0]=r.slice(0,g)),g===r.length)return h;var x,y,j,k=r.match(Uo),E=0,T=0,_="",R="";if(k)for(T=0;T!=k.length;++T){for(R=k[T],b=0;b!=R.length&&R.charCodeAt(b)!==61;++b);for(_=R.slice(0,b).trim();R.charCodeAt(b+1)==32;)++b;for(y=(g=R.charCodeAt(b+1))==34||g==39?1:0,x=R.slice(b+1+y,R.length-y),E=0;E!=_.length&&_.charCodeAt(E)!==58;++E);E===_.length?(h[_=0<_.indexOf("_")?_.slice(0,_.indexOf("_")):_]=x,h[_.toLowerCase()]=x):h[j=(E===5&&_.slice(0,5)==="xmlns"?"xmlns":"")+_.slice(E+1)]&&_.slice(E-3,E)=="ext"||(h[j]=x,h[j.toLowerCase()]=x)}return h}function An(r){return r.replace(Ka,"<$1")}var dn,Kc,Kl={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Yn=$n(Kl),ys=(dn=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,Kc=/_x([\da-fA-F]{4})_/gi,function r(d){var u=d+"",h=u.indexOf("<![CDATA[");return h==-1?u.replace(dn,function(g,b){return Kl[g]||String.fromCharCode(parseInt(b,-1<g.indexOf("x")?16:10))||g}).replace(Kc,function(g,b){return String.fromCharCode(parseInt(b,16))}):(d=u.indexOf("]]>"),r(u.slice(0,h))+u.slice(h+9,d)+r(u.slice(d+3)))}),fi=/[&<>'"]/g,Qc=/[\u0000-\u0008\u000b-\u001f]/g;function Gs(r){return(r+"").replace(fi,function(d){return Yn[d]}).replace(Qc,function(d){return"_x"+("000"+d.charCodeAt(0).toString(16)).slice(-4)+"_"})}function mi(r){return Gs(r).replace(/ /g,"_x0020_")}var Ho=/[\u0000-\u001f]/g;function Vo(r){return(r+"").replace(fi,function(d){return Yn[d]}).replace(/\n/g,"<br/>").replace(Ho,function(d){return"&#x"+("000"+d.charCodeAt(0).toString(16)).slice(-4)+";"})}var Ri,l0=(Ri=/&#(\d+);/g,function(r){return r.replace(Ri,o0)});function o0(r,d){return String.fromCharCode(parseInt(d,10))}function hr(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function K(r){for(var d,u,h,g,b="",x=0,y=0;x<r.length;)(d=r.charCodeAt(x++))<128?b+=String.fromCharCode(d):(u=r.charCodeAt(x++),191<d&&d<224?(y=(31&d)<<6,y|=63&u,b+=String.fromCharCode(y)):(h=r.charCodeAt(x++),d<240?b+=String.fromCharCode((15&d)<<12|(63&u)<<6|63&h):(g=((7&d)<<18|(63&u)<<12|(63&h)<<6|63&(y=r.charCodeAt(x++)))-65536,b+=String.fromCharCode(55296+(g>>>10&1023)),b+=String.fromCharCode(56320+(1023&g)))));return b}function Ge(r){for(var d,u,h=Z(2*r.length),g=1,b=0,x=0,y=0;y<r.length;y+=g)g=1,(u=r.charCodeAt(y))<128?d=u:u<224?(d=64*(31&u)+(63&r.charCodeAt(y+1)),g=2):u<240?(d=4096*(15&u)+64*(63&r.charCodeAt(y+1))+(63&r.charCodeAt(y+2)),g=3):(g=4,d=262144*(7&u)+4096*(63&r.charCodeAt(y+1))+64*(63&r.charCodeAt(y+2))+(63&r.charCodeAt(y+3)),x=55296+((d-=65536)>>>10&1023),d=56320+(1023&d)),x!==0&&(h[b++]=255&x,h[b++]=x>>>8,x=0),h[b++]=d%256,h[b++]=d>>>8;return h.slice(0,b).toString("ucs2")}function nt(r){return we(r,"binary").toString("utf8")}var Ue,Xe,ze,Si="foo bar baz",qe=xe&&(nt(Si)==K(Si)?nt:Ge(Si)==K(Si)&&Ge)||K,Ke=xe?function(r){return we(r,"utf8").toString("binary")}:function(r){for(var d,u=[],h=0,g=0;h<r.length;)switch(!0){case(g=r.charCodeAt(h++))<128:u.push(String.fromCharCode(g));break;case g<2048:u.push(String.fromCharCode(192+(g>>6))),u.push(String.fromCharCode(128+(63&g)));break;case(55296<=g&&g<57344):g-=55296,d=r.charCodeAt(h++)-56320+(g<<10),u.push(String.fromCharCode(240+(d>>18&7))),u.push(String.fromCharCode(144+(d>>12&63))),u.push(String.fromCharCode(128+(d>>6&63))),u.push(String.fromCharCode(128+(63&d)));break;default:u.push(String.fromCharCode(224+(g>>12))),u.push(String.fromCharCode(128+(g>>6&63))),u.push(String.fromCharCode(128+(63&g)))}return u.join("")},Be=(Ue={},function(r,d){var u=r+"|"+(d||"");return Ue[u]||(Ue[u]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",d||""))}),Ot=(Xe=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]}),function(r){for(var d=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),u=0;u<Xe.length;++u)d=d.replace(Xe[u][0],Xe[u][1]);return d}),zt=(ze={},function(r){return ze[r]!==void 0?ze[r]:ze[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}),Pt=/<\/?(?:vt:)?variant>/g,ht=/<(?:vt:)([^>]*)>([\s\S]*)</;function qt(h,d){var u=gs(h),h=h.match(zt(u.baseType))||[],g=[];if(h.length==u.size)return h.forEach(function(b){b=b.replace(Pt,"").match(ht),b&&g.push({v:qe(b[2]),t:b[1]})}),g;if(d.WTF)throw new Error("unexpected vector length "+h.length+" != "+u.size);return g}var Cs=/(^\s|\s$|\n)/;function _s(r,d){return"<"+r+(d.match(Cs)?' xml:space="preserve"':"")+">"+d+"</"+r+">"}function ws(r){return wr(r).map(function(d){return" "+d+'="'+r[d]+'"'}).join("")}function kt(r,d,u){return"<"+r+(u!=null?ws(u):"")+(d!=null?(d.match(Cs)?' xml:space="preserve"':"")+">"+d+"</"+r:"/")+">"}function Oi(r,d){try{return r.toISOString().replace(/\.\d*/,"")}catch(u){if(d)throw u}return""}function c0(r){if(xe&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return qe(be(oe(r)));throw new Error("Bad input format: expected Buffer or string")}var ml=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Yr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},gl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Cr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function pl(r){for(var d=[],u=0;u<r[0].length;++u)if(r[0][u])for(var h=0,g=r[0][u].length;h<g;h+=10240)d.push.apply(d,r[0][u].slice(h,h+10240));return d}function Xc(r,d,u){for(var h=[],g=d;g<u;g+=2)h.push(String.fromCharCode(Pi(r,g)));return h.join("").replace(ye,"")}function Wo(r,d,u){for(var h=[],g=d;g<d+u;++g)h.push(("0"+r[g].toString(16)).slice(-2));return h.join("")}function ym(r,d,u){for(var h=[],g=d;g<u;g++)h.push(String.fromCharCode(Yo(r,g)));return h.join("")}function d0(r,d){var u=ga(r,d);return 0<u?qo(r,d+4,d+4+u-1):""}function u0(r,d){var u=ga(r,d);return 0<u?qo(r,d+4,d+4+u-1):""}function $o(r,d){var u=2*ga(r,d);return 0<u?qo(r,d+4,d+4+u-1):""}function Jc(r,d){var u=ga(r,d);return 0<u?h0(r,d+4,d+4+u):""}function nh(r,d){var u=ga(r,d);return 0<u?qo(r,d+4,d+4+u):""}function vm(r,d){for(var u=1-2*(r[d+7]>>>7),h=((127&r[d+7])<<4)+(r[d+6]>>>4&15),g=15&r[d+6],b=5;0<=b;--b)g=256*g+r[d+b];return h==2047?g==0?1/0*u:NaN:(h==0?h=-1022:(h-=1023,g+=Math.pow(2,52)),u*Math.pow(2,h-52)*g)}var wm=xe?function(r){return 0<r[0].length&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(d){return Buffer.isBuffer(d)?d:we(d)})):pl(r)}:pl,h0=xe?function(r,d,u){return Buffer.isBuffer(r)?r.toString("utf16le",d,u).replace(ye,""):Xc(r,d,u)}:Xc,f0=xe?function(r,d,u){return Buffer.isBuffer(r)?r.toString("hex",d,d+u):Wo(r,d,u)}:Wo,qo=xe?function(r,d,u){return Buffer.isBuffer(r)?r.toString("utf8",d,u):ym(r,d,u)}:ym,ih=d0,lh=u0,oh=$o,ch=Jc,m0=nh,g0=vm,dh=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};xe&&(ih=function(r,d){if(!Buffer.isBuffer(r))return d0(r,d);var u=r.readUInt32LE(d);return 0<u?r.toString("utf8",d+4,d+4+u-1):""},lh=function(r,d){if(!Buffer.isBuffer(r))return u0(r,d);var u=r.readUInt32LE(d);return 0<u?r.toString("utf8",d+4,d+4+u-1):""},oh=function(r,d){if(!Buffer.isBuffer(r))return $o(r,d);var u=2*r.readUInt32LE(d);return r.toString("utf16le",d+4,d+4+u-1)},ch=function(r,d){if(!Buffer.isBuffer(r))return Jc(r,d);var u=r.readUInt32LE(d);return r.toString("utf16le",d+4,d+4+u)},m0=function(r,d){if(!Buffer.isBuffer(r))return nh(r,d);var u=r.readUInt32LE(d);return r.toString("utf8",d+4,d+4+u)},g0=function(r,d){return Buffer.isBuffer(r)?r.readDoubleLE(d):vm(r,d)},dh=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array}),e!==void 0&&(h0=function(r,d,u){return e.utils.decode(1200,r.slice(d,u)).replace(ye,"")},qo=function(r,d,u){return e.utils.decode(65001,r.slice(d,u))},ih=function(r,d){var u=ga(r,d);return 0<u?e.utils.decode(v,r.slice(d+4,d+4+u-1)):""},lh=function(r,d){var u=ga(r,d);return 0<u?e.utils.decode(m,r.slice(d+4,d+4+u-1)):""},oh=function(r,d){var u=2*ga(r,d);return 0<u?e.utils.decode(1200,r.slice(d+4,d+4+u-1)):""},ch=function(r,d){var u=ga(r,d);return 0<u?e.utils.decode(1200,r.slice(d+4,d+4+u)):""},m0=function(r,d){var u=ga(r,d);return 0<u?e.utils.decode(65001,r.slice(d+4,d+4+u)):""});var Yo=function(r,d){return r[d]},Pi=function(r,d){return 256*r[d+1]+r[d]},uh=function(r,d){return d=256*r[d+1]+r[d],d<32768?d:-1*(65535-d+1)},ga=function(r,d){return r[d+3]*(1<<24)+(r[d+2]<<16)+(r[d+1]<<8)+r[d]},Ql=function(r,d){return r[d+3]<<24|r[d+2]<<16|r[d+1]<<8|r[d]},zp=function(r,d){return r[d]<<24|r[d+1]<<16|r[d+2]<<8|r[d+3]};function Go(r,d){var u,h,g,b,x,y,j="",k=[];switch(d){case"dbcs":if(y=this.l,xe&&Buffer.isBuffer(this))j=this.slice(this.l,this.l+2*r).toString("utf16le");else for(x=0;x<r;++x)j+=String.fromCharCode(Pi(this,y)),y+=2;r*=2;break;case"utf8":j=qo(this,this.l,this.l+r);break;case"utf16le":r*=2,j=h0(this,this.l,this.l+r);break;case"wstr":if(e===void 0)return Go.call(this,r,"dbcs");j=e.utils.decode(m,this.slice(this.l,this.l+2*r)),r*=2;break;case"lpstr-ansi":j=ih(this,this.l),r=4+ga(this,this.l);break;case"lpstr-cp":j=lh(this,this.l),r=4+ga(this,this.l);break;case"lpwstr":j=oh(this,this.l),r=4+2*ga(this,this.l);break;case"lpp4":r=4+ga(this,this.l),j=ch(this,this.l),2&r&&(r+=2);break;case"8lpp4":r=4+ga(this,this.l),j=m0(this,this.l),3&r&&(r+=4-(3&r));break;case"cstr":for(r=0,j="";(g=Yo(this,this.l+r++))!==0;)k.push(P(g));j=k.join("");break;case"_wstr":for(r=0,j="";(g=Pi(this,this.l+r))!==0;)k.push(P(g)),r+=2;r+=2,j=k.join("");break;case"dbcs-cont":for(j="",y=this.l,x=0;x<r;++x){if(this.lens&&this.lens.indexOf(y)!==-1)return g=Yo(this,y),this.l=y+1,b=Go.call(this,r-x,g?"dbcs-cont":"sbcs-cont"),k.join("")+b;k.push(P(Pi(this,y))),y+=2}j=k.join(""),r*=2;break;case"cpstr":if(e!==void 0){j=e.utils.decode(m,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(j="",y=this.l,x=0;x!=r;++x){if(this.lens&&this.lens.indexOf(y)!==-1)return g=Yo(this,y),this.l=y+1,b=Go.call(this,r-x,g?"dbcs-cont":"sbcs-cont"),k.join("")+b;k.push(P(Yo(this,y))),y+=1}j=k.join("");break;default:switch(r){case 1:return u=Yo(this,this.l),this.l++,u;case 2:return u=(d==="i"?uh:Pi)(this,this.l),this.l+=2,u;case 4:case-4:return d==="i"||(128&this[this.l+3])==0?(u=(0<r?Ql:zp)(this,this.l),this.l+=4,u):(h=ga(this,this.l),this.l+=4,h);case 8:case-8:if(d==="f")return h=r==8?g0(this,this.l):g0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,h;r=8;case 16:j=f0(this,this.l,r)}}return this.l+=r,j}var Up=function(r,d,u){r[u]=255&d,r[u+1]=d>>>8&255,r[u+2]=d>>>16&255,r[u+3]=d>>>24&255},Hp=function(r,d,u){r[u]=255&d,r[u+1]=d>>8&255,r[u+2]=d>>16&255,r[u+3]=d>>24&255},Vp=function(r,d,u){r[u]=255&d,r[u+1]=d>>>8&255};function Wp(r,d,u){var h=0,g=0;if(u==="dbcs"){for(g=0;g!=d.length;++g)Vp(this,d.charCodeAt(g),this.l+2*g);h=2*d.length}else if(u==="sbcs"){if(e!==void 0&&v==874)for(g=0;g!=d.length;++g){var b=e.utils.encode(v,d.charAt(g));this[this.l+g]=b[0]}else for(d=d.replace(/[^\x00-\x7F]/g,"_"),g=0;g!=d.length;++g)this[this.l+g]=255&d.charCodeAt(g);h=d.length}else{if(u==="hex"){for(;g<r;++g)this[this.l++]=parseInt(d.slice(2*g,2*g+2),16)||0;return this}if(u==="utf16le"){for(var x=Math.min(this.l+r,this.length),g=0;g<Math.min(d.length,r);++g){var y=d.charCodeAt(g);this[this.l++]=255&y,this[this.l++]=y>>8}for(;this.l<x;)this[this.l++]=0;return this}switch(r){case 1:h=1,this[this.l]=255&d;break;case 2:h=2,this[this.l]=255&d,d>>>=8,this[this.l+1]=255&d;break;case 3:h=3,this[this.l]=255&d,d>>>=8,this[this.l+1]=255&d,d>>>=8,this[this.l+2]=255&d;break;case 4:h=4,Up(this,d,this.l);break;case 8:if(h=8,u==="f"){(function(j,k,E){var T=(k<0||1/k==-1/0?1:0)<<7,_=0,R=0,q=T?-k:k;isFinite(q)?q==0?_=R=0:(_=Math.floor(Math.log(q)/Math.LN2),R=q*Math.pow(2,52-_),_<=-1023&&(!isFinite(R)||R<Math.pow(2,52))?_=-1022:(R-=Math.pow(2,52),_+=1023)):(_=2047,R=isNaN(k)?26985:0);for(var I=0;I<=5;++I,R/=256)j[E+I]=255&R;j[E+6]=(15&_)<<4|15&R,j[E+7]=_>>4|T})(this,d,this.l);break}case 16:break;case-4:h=4,Hp(this,d,this.l)}}return this.l+=h,this}function jm(r,d){var u=f0(this,this.l,r.length>>1);if(u!==r)throw new Error(d+"Expected "+r+" saw "+u);this.l+=r.length>>1}function ka(r,d){r.l=d,r.read_shift=Go,r.chk=jm,r.write_shift=Wp}function La(r,d){r.l+=d}function gt(r){return r=Z(r),ka(r,0),r}function Ii(r,d,u){if(r){ka(r,r.l||0);for(var h,g=r.length,b=0;r.l<g;){128&(b=r.read_shift(1))&&(b=(127&b)+((127&r.read_shift(1))<<7));for(var x,y=No[b]||No[65535],j=127&(x=r.read_shift(1)),k=1;k<4&&128&x;++k)j+=(127&(x=r.read_shift(1)))<<7*k;h=r.l+j;var E=y.f&&y.f(r,j,u);if(r.l=h,d(E,y,b))return}}}function Ra(){function r(x){return ka(x=gt(x),0),x}function d(){b&&(b.length>b.l&&((b=b.slice(0,b.l)).l=b.length),0<b.length&&h.push(b),b=null)}function u(x){return b&&x<b.length-b.l?b:(d(),b=r(Math.max(x+1,g)))}var h=[],g=xe?256:2048,b=r(g);return{next:u,push:function(x){d(),(b=x).l==null&&(b.l=b.length),u(g)},end:function(){return d(),he(h)},_bufs:h}}function yt(r,d,u,h){var g=+d;if(!isNaN(g)){d=1+(128<=g?1:0)+1,128<=(h=h||No[g].p||(u||[]).length||0)&&++d,16384<=h&&++d,2097152<=h&&++d;var b=r.next(d);g<=127?b.write_shift(1,g):(b.write_shift(1,128+(127&g)),b.write_shift(1,g>>7));for(var x=0;x!=4;++x){if(!(128<=h)){b.write_shift(1,h);break}b.write_shift(1,128+(127&h)),h>>=7}0<h&&dh(u)&&r.push(u)}}function Zc(r,d,u){var h=Ys(r);if(d.s?(h.cRel&&(h.c+=d.s.c),h.rRel&&(h.r+=d.s.r)):(h.cRel&&(h.c+=d.c),h.rRel&&(h.r+=d.r)),!u||u.biff<12){for(;256<=h.c;)h.c-=256;for(;65536<=h.r;)h.r-=65536}return h}function hh(r,d,u){return r=Ys(r),r.s=Zc(r.s,d.s,u),r.e=Zc(r.e,d.s,u),r}function Ko(r,d){if(r.cRel&&r.c<0)for(r=Ys(r);r.c<0;)r.c+=8<d?16384:256;if(r.rRel&&r.r<0)for(r=Ys(r);r.r<0;)r.r+=8<d?1048576:5<d?65536:16384;var u=vs(r);return r.cRel||r.cRel==null||(u=u.replace(/^([A-Z])/,"$$$1")),u=!r.rRel&&r.rRel!=null?u.replace(/([A-Z]|^)(\d+)$/,"$1$$$2"):u}function p0(r,d){return r.s.r!=0||r.s.rRel||r.e.r!=(12<=d.biff?1048575:8<=d.biff?65536:16384)||r.e.rRel?r.s.c!=0||r.s.cRel||r.e.c!=(12<=d.biff?16383:255)||r.e.cRel?Ko(r.s,d.biff)+":"+Ko(r.e,d.biff):(r.s.rRel?"":"$")+Ur(r.s.r)+":"+(r.e.rRel?"":"$")+Ur(r.e.r):(r.s.cRel?"":"$")+Tr(r.s.c)+":"+(r.e.cRel?"":"$")+Tr(r.e.c)}function x0(r){return parseInt(r.replace(/\$(\d+)$/,"$1"),10)-1}function Ur(r){return""+(r+1)}function xl(r){for(var d=r.replace(/^\$([A-Z])/,"$1"),u=0,h=0;h!==d.length;++h)u=26*u+d.charCodeAt(h)-64;return u-1}function Tr(r){if(r<0)throw new Error("invalid column "+r);var d="";for(++r;r;r=Math.floor((r-1)/26))d=String.fromCharCode((r-1)%26+65)+d;return d}function Hr(r){for(var d=0,u=0,h=0;h<r.length;++h){var g=r.charCodeAt(h);48<=g&&g<=57?d=10*d+(g-48):65<=g&&g<=90&&(u=26*u+(g-64))}return{c:u-1,r:d-1}}function vs(r){for(var d=r.c+1,u="";d;d=(d-1)/26|0)u=String.fromCharCode((d-1)%26+65)+u;return u+(r.r+1)}function Oa(r){var d=r.indexOf(":");return d==-1?{s:Hr(r),e:Hr(r)}:{s:Hr(r.slice(0,d)),e:Hr(r.slice(d+1))}}function Ss(r,d){return d===void 0||typeof d=="number"?Ss(r.s,r.e):(r=typeof r!="string"?vs(r):r)==(d=typeof d!="string"?vs(d):d)?r:r+":"+d}function Ls(r){for(var d={s:{c:0,r:0},e:{c:0,r:0}},b=0,u=0,h=0,g=r.length,b=0;u<g&&!((h=r.charCodeAt(u)-64)<1||26<h);++u)b=26*b+h;for(d.s.c=--b,b=0;u<g&&!((h=r.charCodeAt(u)-48)<0||9<h);++u)b=10*b+h;if(d.s.r=--b,u===g||h!=10)return d.e.c=d.s.c,d.e.r=d.s.r,d;for(++u,b=0;u!=g&&!((h=r.charCodeAt(u)-64)<1||26<h);++u)b=26*b+h;for(d.e.c=--b,b=0;u!=g&&!((h=r.charCodeAt(u)-48)<0||9<h);++u)b=10*b+h;return d.e.r=--b,d}function ed(r,d){var u=r.t=="d"&&d instanceof Date;if(r.z!=null)try{return r.w=Er(r.z,u?Dr(d):d)}catch{}try{return r.w=Er((r.XF||{}).numFmtId||(u?14:0),u?Dr(d):d)}catch{return""+d}}function gi(r,d,u){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&u&&u.dateNF&&(r.z=u.dateNF),r.t=="e"?Qn[r.v]||r.v:ed(r,d??r.v))}function Gn(r,h){var u=h&&h.sheet?h.sheet:"Sheet1",h={};return h[u]=r,{SheetNames:[u],Sheets:h}}function fh(r,d,u){var h=u||{},g=r?Array.isArray(r):h.dense,b=r||(g?[]:{}),x=0,y=0;b&&h.origin!=null&&(typeof h.origin=="number"?x=h.origin:(x=(j=typeof h.origin=="string"?Hr(h.origin):h.origin).r,y=j.c),b["!ref"]||(b["!ref"]="A1:A1"));var j,k={s:{c:1e7,r:1e7},e:{c:0,r:0}};b["!ref"]&&(j=Ls(b["!ref"]),k.s.c=j.s.c,k.s.r=j.s.r,k.e.c=Math.max(k.e.c,j.e.c),k.e.r=Math.max(k.e.r,j.e.r),x==-1&&(k.e.r=x=j.e.r+1));for(var E=0;E!=d.length;++E)if(d[E]){if(!Array.isArray(d[E]))throw new Error("aoa_to_sheet expects an array of arrays");for(var T=0;T!=d[E].length;++T)if(d[E][T]!==void 0){var _={v:d[E][T]},R=x+E,q=y+T;if(k.s.r>R&&(k.s.r=R),k.s.c>q&&(k.s.c=q),k.e.r<R&&(k.e.r=R),k.e.c<q&&(k.e.c=q),!d[E][T]||typeof d[E][T]!="object"||Array.isArray(d[E][T])||d[E][T]instanceof Date)if(Array.isArray(_.v)&&(_.f=d[E][T][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(h.nullError)_.t="e",_.v=0;else{if(!h.sheetStubs)continue;_.t="z"}else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=h.dateNF||V[14],h.cellDates?(_.t="d",_.w=Er(_.z,Dr(_.v))):(_.t="n",_.v=Dr(_.v),_.w=Er(_.z,_.v))):_.t="s";else _=d[E][T];g?(b[R]||(b[R]=[]),b[R][q]&&b[R][q].z&&(_.z=b[R][q].z),b[R][q]=_):(b[R=vs({c:q,r:R})]&&b[R].z&&(_.z=b[R].z),b[R]=_)}}return k.s.c<1e7&&(b["!ref"]=Ss(k)),b}function Xl(r,d){return fh(null,r,d)}function un(r,d){return(d=d||gt(4)).write_shift(4,r),d}function pa(r){var d=r.read_shift(4);return d===0?"":r.read_shift(d,"dbcs")}function da(r,d){var u=!1;return d==null&&(u=!0,d=gt(4+2*r.length)),d.write_shift(4,r.length),0<r.length&&d.write_shift(0,r,"dbcs"),u?d.slice(0,d.l):d}function b0(r,d){var u,h=r.l,g=r.read_shift(1),x=pa(r),b=[],x={t:x,h:x};if((1&g)!=0){for(var y=r.read_shift(4),j=0;j!=y;++j)b.push({ich:(u=r).read_shift(2),ifnt:u.read_shift(2)});x.r=b}else x.r=[{ich:0,ifnt:0}];return r.l=h+d,x}var Nm=b0;function $p(r,d){var u,h=!1;return d==null&&(h=!0,d=gt(23+4*r.t.length)),d.write_shift(1,1),da(r.t,d),d.write_shift(4,1),u={ich:0,ifnt:0},(r=(r=d)||gt(4)).write_shift(2,u.ich||0),r.write_shift(2,u.ifnt||0),h?d.slice(0,d.l):d}function En(r){var d=r.read_shift(4),u=r.read_shift(2);return u+=r.read_shift(1)<<16,r.l++,{c:d,iStyleRef:u}}function Jl(r,d){return(d=d??gt(8)).write_shift(-4,r.c),d.write_shift(3,r.iStyleRef||r.s),d.write_shift(1,0),d}function Zl(r){var d=r.read_shift(2);return d+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:d}}function eo(r,d){return(d=d??gt(4)).write_shift(3,r.iStyleRef||r.s),d.write_shift(1,0),d}var hn=pa,Qo=da;function y0(r){var d=r.read_shift(4);return d===0||d===4294967295?"":r.read_shift(d,"dbcs")}function td(r,d){var u=!1;return d==null&&(u=!0,d=gt(127)),d.write_shift(4,0<r.length?r.length:4294967295),0<r.length&&d.write_shift(0,r,"dbcs"),u?d.slice(0,d.l):d}var km=pa,v0=y0,sd=td;function mh(r){var d=r.slice(r.l,r.l+4),u=1&d[0],h=2&d[0];return r.l+=4,d=h==0?g0([0,0,0,0,252&d[0],d[1],d[2],d[3]],0):Ql(d,0)>>2,u?d/100:d}function to(r,d){d==null&&(d=gt(4));var u=0,h=0,g=100*r;if(r==(0|r)&&-536870912<=r&&r<1<<29?h=1:g==(0|g)&&-536870912<=g&&g<1<<29&&(u=h=1),!h)throw new Error("unsupported RkNumber "+r);d.write_shift(-4,((u?g:r)<<2)+(u+2))}function w0(r){var d={s:{},e:{}};return d.s.r=r.read_shift(4),d.e.r=r.read_shift(4),d.s.c=r.read_shift(4),d.e.c=r.read_shift(4),d}var Kn=w0,bl=function(r,d){return(d=d||gt(16)).write_shift(4,r.s.r),d.write_shift(4,r.e.r),d.write_shift(4,r.s.c),d.write_shift(4,r.e.c),d};function Ca(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Dn(r,d){return(d||gt(8)).write_shift(8,r,"f")}function Bi(r,d){if(d=d||gt(8),!r||r.auto)return d.write_shift(4,0),d.write_shift(4,0),d;r.index!=null?(d.write_shift(1,2),d.write_shift(1,r.index)):r.theme!=null?(d.write_shift(1,6),d.write_shift(1,r.theme)):(d.write_shift(1,5),d.write_shift(1,0));var u=r.tint||0;return 0<u?u*=32767:u<0&&(u*=32768),d.write_shift(2,u),r.rgb&&r.theme==null?(typeof(r=r.rgb||"FFFFFF")=="number"&&(r=("000000"+r.toString(16)).slice(-6)),d.write_shift(1,parseInt(r.slice(0,2),16)),d.write_shift(1,parseInt(r.slice(2,4),16)),d.write_shift(1,parseInt(r.slice(4,6),16)),d.write_shift(1,255)):(d.write_shift(2,0),d.write_shift(1,0),d.write_shift(1,0)),d}function j0(r,d){var u=r.read_shift(4);switch(u){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[r.read_shift(4)]||""}if(400<u)throw new Error("Unsupported Clipboard: "+u.toString(16));return r.l-=4,r.read_shift(0,d==1?"lpstr":"lpwstr")}var N0=2,sa=3,gh=12,ph=81,Cm=[80,ph],xh={1:{n:"CodePage",t:N0},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:sa},5:{n:"LineCount",t:sa},6:{n:"ParagraphCount",t:sa},7:{n:"SlideCount",t:sa},8:{n:"NoteCount",t:sa},9:{n:"HiddenCount",t:sa},10:{n:"MultimediaClipCount",t:sa},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:sa},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:sa,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},bh={1:{n:"CodePage",t:N0},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:sa},15:{n:"WordCount",t:sa},16:{n:"CharCount",t:sa},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:sa},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Sm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Am=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Xo=Ys([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(r){return[r>>16&255,r>>8&255,255&r]})),Qn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Tn={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Jo={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},za={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function yl(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function k0(r,d){var u,h=(function(j){for(var k=[],E=wr(j),T=0;T!==E.length;++T)k[j[E[T]]]==null&&(k[j[E[T]]]=[]),k[j[E[T]]].push(E[T]);return k})(Jo),g=[];g[g.length]=kr,g[g.length]=kt("Types",null,{xmlns:Yr.CT,"xmlns:xsd":Yr.xsd,"xmlns:xsi":Yr.xsi}),g=g.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(j){return kt("Default",null,{Extension:j[0],ContentType:j[1]})}));function b(j){r[j]&&0<r[j].length&&(u=r[j][0],g[g.length]=kt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:za[j][d.bookType]||za[j].xlsx}))}function x(j){(r[j]||[]).forEach(function(k){g[g.length]=kt("Override",null,{PartName:(k[0]=="/"?"":"/")+k,ContentType:za[j][d.bookType]||za[j].xlsx})})}function y(j){(r[j]||[]).forEach(function(k){g[g.length]=kt("Override",null,{PartName:(k[0]=="/"?"":"/")+k,ContentType:h[j][0]})})}return b("workbooks"),x("sheets"),x("charts"),y("themes"),["strs","styles"].forEach(b),["coreprops","extprops","custprops"].forEach(y),y("vba"),y("comments"),y("threadedcomments"),y("drawings"),x("metadata"),y("people"),2<g.length&&(g[g.length]="</Types>",g[1]=g[1].replace("/>",">")),g.join("")}var ks={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vl(r){var d=r.lastIndexOf("/");return r.slice(0,d+1)+"_rels/"+r.slice(d+1)+".rels"}function so(r,d){var u={"!id":{}};if(!r)return u;d.charAt(0)!=="/"&&(d="/"+d);var h={};return(r.match(Mr)||[]).forEach(function(g){var b,x=gs(g);x[0]==="<Relationship"&&((b={}).Type=x.Type,b.Target=x.Target,b.Id=x.Id,x.TargetMode&&(b.TargetMode=x.TargetMode),g=x.TargetMode==="External"?x.Target:Nr(x.Target,d),u[g]=b,h[x.Id]=b)}),u["!id"]=h,u}function _n(r){var d=[kr,kt("Relationships",null,{xmlns:Yr.RELS})];return wr(r["!id"]).forEach(function(u){d[d.length]=kt("Relationship",null,r["!id"][u])}),2<d.length&&(d[d.length]="</Relationships>",d[1]=d[1].replace("/>",">")),d.join("")}function nr(r,d,u,h,g,b){if(g=g||{},r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),d<0)for(d=r["!idx"];r["!id"]["rId"+d];++d);if(r["!idx"]=d+1,g.Id="rId"+d,g.Type=h,g.Target=u,-1<[ks.HLINK,ks.XPATH,ks.XMISS].indexOf(g.Type)&&(g.TargetMode="External"),r["!id"][g.Id])throw new Error("Cannot rewrite rId "+d);return r["!id"][g.Id]=g,r[("/"+g.Target).replace("//","/")]=g,d}var C0="application/vnd.oasis.opendocument.spreadsheet";function ro(r,d,u){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(u||"odf")+"#"+d+`"/>
`,`  </rdf:Description>
`].join("")}function Em(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+s.version+"</meta:generator></office:meta></office:document-meta>"}var Lr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],yh=(function(){for(var r=new Array(Lr.length),d=0;d<Lr.length;++d){var u=Lr[d],u="(?:"+u[0].slice(0,u[0].indexOf(":"))+":)"+u[0].slice(u[0].indexOf(":")+1);r[d]=new RegExp("<"+u+"[^>]*>([\\s\\S]*?)</"+u+">")}return r})();function pi(r){var d={};r=qe(r);for(var u=0;u<Lr.length;++u){var h=Lr[u],g=r.match(yh[u]);g!=null&&0<g.length&&(d[h[1]]=ys(g[1])),h[2]==="date"&&d[h[1]]&&(d[h[1]]=Ts(d[h[1]]))}return d}function S0(r,d,u,h,g){g[r]==null&&d!=null&&d!==""&&(d=Gs(g[r]=d),h[h.length]=u?kt(r,d,u):_s(r,d))}function rd(r,d){var u=d||{},h=[kr,kt("cp:coreProperties",null,{"xmlns:cp":Yr.CORE_PROPS,"xmlns:dc":Yr.dc,"xmlns:dcterms":Yr.dcterms,"xmlns:dcmitype":Yr.dcmitype,"xmlns:xsi":Yr.xsi})],g={};if(!r&&!u.Props)return h.join("");r&&(r.CreatedDate!=null&&S0("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:Oi(r.CreatedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},h,g),r.ModifiedDate!=null&&S0("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:Oi(r.ModifiedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},h,g));for(var b=0;b!=Lr.length;++b){var x=Lr[b],y=u.Props&&u.Props[x[1]]!=null?u.Props[x[1]]:r?r[x[1]]:null;y===!0?y="1":y===!1?y="0":typeof y=="number"&&(y=String(y)),y!=null&&S0(x[0],y,null,h,g)}return 2<h.length&&(h[h.length]="</cp:coreProperties>",h[1]=h[1].replace("/>",">")),h.join("")}var fn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],A0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function vh(r,d,u,h){var g=[];if(typeof r=="string")g=qt(r,h);else for(var b=0;b<r.length;++b)g=g.concat(r[b].map(function(E){return{v:E}}));var x,y=typeof d=="string"?qt(d,h).map(function(E){return E.v}):d,j=0;if(0<y.length)for(var k=0;k!==g.length;k+=2){switch(x=+g[k+1].v,g[k].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":u.Worksheets=x,u.SheetNames=y.slice(j,j+x);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":u.NamedRanges=x,u.DefinedNames=y.slice(j,j+x);break;case"Charts":case"Diagramme":u.Chartsheets=x,u.ChartNames=y.slice(j,j+x)}j+=x}}function E0(r){var d=[],u=kt;return(r=r||{}).Application="SheetJS",d[d.length]=kr,d[d.length]=kt("Properties",null,{xmlns:Yr.EXT_PROPS,"xmlns:vt":Yr.vt}),fn.forEach(function(h){if(r[h[1]]!==void 0){var g;switch(h[2]){case"string":g=Gs(String(r[h[1]]));break;case"bool":g=r[h[1]]?"true":"false"}g!==void 0&&(d[d.length]=u(h[0],g))}}),d[d.length]=u("HeadingPairs",u("vt:vector",u("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+u("vt:variant",u("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),d[d.length]=u("TitlesOfParts",u("vt:vector",r.SheetNames.map(function(h){return"<vt:lpstr>"+Gs(h)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),2<d.length&&(d[d.length]="</Properties>",d[1]=d[1].replace("/>",">")),d.join("")}var Dm=/<[^>]+>[^<]*/g;function mn(r){var d=[kr,kt("Properties",null,{xmlns:Yr.CUST_PROPS,"xmlns:vt":Yr.vt})];if(!r)return d.join("");var u=1;return wr(r).forEach(function(h){++u,d[d.length]=kt("property",(function(g,b){switch(typeof g){case"string":var x=kt("vt:lpwstr",Gs(g));return x=x.replace(/&quot;/g,"_x0022_");case"number":return kt((0|g)==g?"vt:i4":"vt:r8",Gs(String(g)));case"boolean":return kt("vt:bool",g?"true":"false")}if(g instanceof Date)return kt("vt:filetime",Oi(g));throw new Error("Unable to serialize "+g)})(r[h]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:u,name:Gs(h)})}),2<d.length&&(d[d.length]="</Properties>",d[1]=d[1].replace("/>",">")),d.join("")}var ao,wl={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Zo(u){var d=u.read_shift(4),u=u.read_shift(4);return new Date(1e3*(u/1e7*Math.pow(2,32)+d/1e7-11644473600)).toISOString().replace(/\.000/,"")}function ec(r,d,u){var h=r.l,g=r.read_shift(0,"lpstr-cp");if(u)for(;r.l-h&3;)++r.l;return g}function gn(r,d,u){var h=r.read_shift(0,"lpwstr");return h}function pn(r,d,u){return d===31?gn(r):ec(r,0,u)}function zi(r,d,u){return pn(r,d,u===!1?0:4)}function xi(r){for(var d,u,h,g=r.read_shift(4),b=[],x=0;x<g/2;++x)b.push((h=u=void 0,u=(d=r).l,h=ad(d,ph),d[d.l]==0&&d[d.l+1]==0&&d.l-u&2&&(d.l+=2),[h,ad(d,sa)]));return b}function Xn(r,d){for(var u=r.read_shift(4),h={},g=0;g!=u;++g){var b=r.read_shift(4),x=r.read_shift(4);h[b]=r.read_shift(x,d===1200?"utf16le":"utf8").replace(ye,"").replace(Te,"!"),d===1200&&x%2&&(r.l+=2)}return 3&r.l&&(r.l=r.l>>3<<2),h}function bi(r){var d=r.read_shift(4),u=r.slice(r.l,r.l+d);return r.l+=d,0<(3&d)&&(r.l+=4-(3&d)&3),u}function ad(r,d,u){var h,g,b=r.read_shift(2),x=u||{};if(r.l+=2,d!==gh&&b!==d&&Cm.indexOf(d)===-1&&((65534&d)!=4126||(65534&b)!=4126))throw new Error("Expected type "+d+" saw "+b);switch(d===gh?b:d){case 2:return h=r.read_shift(2,"i"),x.raw||(r.l+=2),h;case 3:return h=r.read_shift(4,"i");case 11:return r.read_shift(4)!==0;case 19:return h=r.read_shift(4);case 30:return ec(r,0,4).replace(ye,"");case 31:return gn(r);case 64:return Zo(r);case 65:return bi(r);case 71:return(g={}).Size=(h=r).read_shift(4),h.l+=g.Size+3-(g.Size-1)%4,g;case 80:return zi(r,b,!x.raw).replace(ye,"");case 81:return(function(y,j){if(!j)throw new Error("VtUnalignedString must have positive length");return pn(y,j,0)})(r,b).replace(ye,"");case 4108:return xi(r);case 4126:case 4127:return(b==4127?function(y){for(var j=y.read_shift(4),k=[],E=0;E!=j;++E){var T=y.l;k[E]=y.read_shift(0,"lpwstr").replace(ye,""),y.l-T&2&&(y.l+=2)}return k}:function(y){for(var j=y.read_shift(4),k=[],E=0;E!=j;++E)k[E]=y.read_shift(0,"lpstr-cp").replace(ye,"");return k})(r);default:throw new Error("TypedPropertyValue unrecognized type "+d+" "+b)}}function D0(r,d){var u,h,g,b=gt(4),x=gt(4);switch(b.write_shift(4,r==80?31:r),r){case 3:x.write_shift(-4,d);break;case 5:(x=gt(8)).write_shift(8,d,"f");break;case 11:x.write_shift(4,d?1:0);break;case 64:h=(typeof(u=d)=="string"?new Date(Date.parse(u)):u).getTime()/1e3+11644473600,g=h%Math.pow(2,32),u=(h-g)/Math.pow(2,32),u*=1e7,0<(h=(g*=1e7)/Math.pow(2,32)|0)&&(g%=Math.pow(2,32),u+=h),(h=gt(8)).write_shift(4,g),h.write_shift(4,u),x=h;break;case 31:case 80:for((x=gt(4+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,d.length+1),x.write_shift(0,d,"dbcs");x.l!=x.length;)x.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+d)}return he([b,x])}function T0(r,d){for(var u=r.l,h=r.read_shift(4),g=r.read_shift(4),b=[],k=0,x=0,y=-1,j={},k=0;k!=g;++k){var E=r.read_shift(4),T=r.read_shift(4);b[k]=[E,T+u]}b.sort(function(Y,z){return Y[1]-z[1]});var _={};for(k=0;k!=g;++k){if(r.l!==b[k][1]){var R=!0;if(0<k&&d)switch(d[b[k-1][0]].t){case 2:r.l+2===b[k][1]&&(r.l+=2,R=!1);break;case 80:case 4108:r.l<=b[k][1]&&(r.l=b[k][1],R=!1)}if((!d||k==0)&&r.l<=b[k][1]&&(R=!1,r.l=b[k][1]),R)throw new Error("Read Error: Expected address "+b[k][1]+" at "+r.l+" :"+k)}if(d){var q=d[b[k][0]];if(_[q.n]=ad(r,q.t,{raw:!0}),q.p==="version"&&(_[q.n]=String(_[q.n]>>16)+"."+("0000"+String(65535&_[q.n])).slice(-4)),q.n=="CodePage")switch(_[q.n]){case 0:_[q.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:D(x=_[q.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[q.n])}}else if(b[k][0]===1)x=_.CodePage=ad(r,N0),D(x),y!==-1&&(J=r.l,r.l=b[y][1],j=Xn(r,x),r.l=J);else if(b[k][0]===0)x!==0?j=Xn(r,x):(y=k,r.l=b[k+1][1]);else{var I,J=j[b[k][0]];switch(r[r.l]){case 65:r.l+=4,I=bi(r);break;case 30:case 31:r.l+=4,I=zi(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,I=r.read_shift(4,"i");break;case 19:r.l+=4,I=r.read_shift(4);break;case 5:r.l+=4,I=r.read_shift(8,"f");break;case 11:r.l+=4,I=er(r,4);break;case 64:r.l+=4,I=Ts(Zo(r));break;default:throw new Error("unparsed value: "+r[r.l])}_[J]=I}}return r.l=u+h,_}var wh=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function xa(r,d,u){var h,g,b,x,y=gt(8),j=[],k=[],E=8,T=0,_=gt(8),R=gt(8);if(_.write_shift(4,2),_.write_shift(4,1200),R.write_shift(4,1),k.push(_),j.push(R),E+=8+_.length,!d){(R=gt(8)).write_shift(4,0),j.unshift(R);var q=[gt(4)];for(q[0].write_shift(4,r.length),T=0;T<r.length;++T){var I=r[T][0];for((_=gt(8+2*(I.length+1)+(I.length%2?0:2))).write_shift(4,T+2),_.write_shift(4,I.length+1),_.write_shift(0,I,"dbcs");_.l!=_.length;)_.write_shift(1,0);q.push(_)}_=he(q),k.unshift(_),E+=8+_.length}for(T=0;T<r.length;++T)d&&!d[r[T][0]]||-1<wh.indexOf(r[T][0])||-1<A0.indexOf(r[T][0])||r[T][1]!=null&&(b=r[T][1],h=0,_=d?((x=u[h=+d[r[T][0]]]).p=="version"&&typeof b=="string"&&(b=(+(g=b.split("."))[0]<<16)+(+g[1]||0)),D0(x.t,b)):((x=(function(Y){switch(typeof Y){case"boolean":return 11;case"number":return(0|Y)==Y?3:5;case"string":return 31;case"object":if(Y instanceof Date)return 64}return-1})(b))==-1&&(x=31,b=String(b)),D0(x,b)),k.push(_),(R=gt(8)).write_shift(4,d?h:2+T),j.push(R),E+=8+_.length);for(var J=8*(k.length+1),T=0;T<k.length;++T)j[T].write_shift(4,J),J+=k[T].length;return y.write_shift(4,E),y.write_shift(4,k.length),he([y].concat(j).concat(k))}function Sr(r,d,u){var h=r.content;if(!h)return{};ka(h,0);var g,b=0;h.chk("feff","Byte Order: "),h.read_shift(2);var x=h.read_shift(4),y=h.read_shift(16);if(y!==Zt.utils.consts.HEADER_CLSID&&y!==u)throw new Error("Bad PropertySet CLSID "+y);if((r=h.read_shift(4))!==1&&r!==2)throw new Error("Unrecognized #Sets: "+r);if(u=h.read_shift(16),y=h.read_shift(4),r===1&&y!==h.l)throw new Error("Length mismatch: "+y+" !== "+h.l);r===2&&(g=h.read_shift(16),b=h.read_shift(4));var j,k,E=T0(h,d),T={SystemIdentifier:x};for(j in E)T[j]=E[j];if(T.FMTID=u,r===1)return T;if(b-h.l==2&&(h.l+=2),h.l!==b)throw new Error("Length mismatch 2: "+h.l+" !== "+b);try{k=T0(h,null)}catch{}for(j in k)T[j]=k[j];return T.FMTID=[u,g],T}function Vs(r,d,u,h,g,b){var x=gt(g?68:48),y=[x];return x.write_shift(2,65534),x.write_shift(2,0),x.write_shift(4,842412599),x.write_shift(16,Zt.utils.consts.HEADER_CLSID,"hex"),x.write_shift(4,g?2:1),x.write_shift(16,d,"hex"),x.write_shift(4,g?68:48),h=xa(r,u,h),y.push(h),g&&(g=xa(g,null,null),x.write_shift(16,b,"hex"),x.write_shift(4,68+h.length),y.push(g)),he(y)}function Ua(r,d){return r.read_shift(d),null}function er(r,d){return r.read_shift(d)===1}function Sa(r,d){return(d=d||gt(2)).write_shift(2,+!!r),d}function xr(r){return r.read_shift(2,"u")}function xn(r,d){return(d=d||gt(2)).write_shift(2,r),d}function jh(r,d){return(function(u,h,g){for(var b=[],x=u.l+h;u.l<x;)b.push(g(u,x-u.l));if(x!==u.l)throw new Error("Slurp error");return b})(r,d,xr)}function no(r,d,u){return(u=u||gt(2)).write_shift(1,d=="e"?+r:+!!r),u.write_shift(1,d=="e"?1:0),u}function Jn(r,d,u){var h=r.read_shift(u&&12<=u.biff?2:1),g="sbcs-cont",b=m;return u&&8<=u.biff&&(m=1200),u&&u.biff!=8?u.biff==12&&(g="wstr"):r.read_shift(1)&&(g="dbcs-cont"),2<=u.biff&&u.biff<=5&&(g="cpstr"),g=h?r.read_shift(h,g):"",m=b,g}function Ui(r,d,u){if(u){if(2<=u.biff&&u.biff<=5)return r.read_shift(d,"cpstr");if(12<=u.biff)return r.read_shift(d,"dbcs-cont")}return r.read_shift(1)===0?r.read_shift(d,"sbcs-cont"):r.read_shift(d,"dbcs-cont")}function Hi(r,d,u){var h=r.read_shift(u&&u.biff==2?1:2);return h===0?(r.l++,""):Ui(r,h,u)}function Vi(r,d,u){if(5<u.biff)return Hi(r,0,u);var h=r.read_shift(1);return h===0?(r.l++,""):r.read_shift(h,u.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function jl(r,d,u){return(u=u||gt(3+2*r.length)).write_shift(2,r.length),u.write_shift(1,1),u.write_shift(31,r,"utf16le"),u}function Wi(r){var d,u,h,g,b=r.read_shift(16);switch(b){case"e0c9ea79f9bace118c8200aa004ba90b":return u=(d=r).read_shift(4),h=d.l,g=!1,24<u&&(d.l+=u-24,d.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(g=!0),d.l=h),u=d.read_shift((g?u-24:u)>>1,"utf16le").replace(ye,""),g&&(d.l+=24),u;case"0303000000000000c000000000000046":return(function(x){for(var y=x.read_shift(2),j="";0<y--;)j+="../";var k=x.read_shift(0,"lpstr-ansi");if(x.l+=2,x.read_shift(2)!=57005)throw new Error("Bad FileMoniker");if(x.read_shift(4)===0)return j+k.replace(/\\/g,"/");if(k=x.read_shift(4),x.read_shift(2)!=3)throw new Error("Bad FileMoniker");return j+x.read_shift(k>>1,"utf16le").replace(ye,"")})(r);default:throw new Error("Unsupported Moniker "+b)}}function Zn(r){var d=r.read_shift(4);return 0<d?r.read_shift(d,"utf16le").replace(ye,""):""}function yi(r,d){(d=d||gt(6+2*r.length)).write_shift(4,1+r.length);for(var u=0;u<r.length;++u)d.write_shift(2,r.charCodeAt(u));return d.write_shift(2,0),d}function _0(r){return[r.read_shift(1),r.read_shift(1),r.read_shift(1),r.read_shift(1)]}function F0(r){return r=_0(r),r[3]=0,r}function Ha(r){return{r:r.read_shift(2),c:r.read_shift(2),ixfe:r.read_shift(2)}}function vi(r,d,u,h){return(h=h||gt(6)).write_shift(2,r),h.write_shift(2,d),h.write_shift(2,u||0),h}function Nl(r){return[r.read_shift(2),mh(r)]}function ra(r){var d=r.read_shift(2),u=r.read_shift(2);return{s:{c:r.read_shift(2),r:d},e:{c:r.read_shift(2),r:u}}}function nd(r,d){return(d=d||gt(8)).write_shift(2,r.s.r),d.write_shift(2,r.e.r),d.write_shift(2,r.s.c),d.write_shift(2,r.e.c),d}function Nh(r){var d=r.read_shift(2),u=r.read_shift(2);return{s:{c:r.read_shift(1),r:d},e:{c:r.read_shift(1),r:u}}}var qp=Nh;function Tm(r){r.l+=4;var d=r.read_shift(2),u=r.read_shift(2),h=r.read_shift(2);return r.l+=12,[u,d,h]}function Pa(r){r.l+=2,r.l+=r.read_shift(2)}var aa={0:Pa,4:Pa,5:Pa,6:Pa,7:function(r){return r.l+=4,r.cf=r.read_shift(2),{}},8:Pa,9:Pa,10:Pa,11:Pa,12:Pa,13:function(r){var d={};return r.l+=4,r.l+=16,d.fSharedNote=r.read_shift(2),r.l+=4,d},14:Pa,15:Pa,16:Pa,17:Pa,18:Pa,19:Pa,20:Pa,21:Tm};function tc(r,d){var u={BIFFVer:0,dt:0};switch(u.BIFFVer=r.read_shift(2),2<=(d-=2)&&(u.dt=r.read_shift(2),r.l-=2),u.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<d)throw new Error("Unexpected BIFF Ver "+u.BIFFVer)}return r.read_shift(d),u}function io(r,d,u){var h=1536,g=16;switch(u.bookType){case"biff8":break;case"biff5":h=1280,g=8;break;case"biff4":h=4,g=6;break;case"biff3":h=3,g=6;break;case"biff2":h=2,g=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}return u=gt(g),u.write_shift(2,h),u.write_shift(2,d),4<g&&u.write_shift(2,29282),6<g&&u.write_shift(2,1997),8<g&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function id(r){var d=gt(8);d.write_shift(4,r.Count),d.write_shift(4,r.Unique);for(var u,h,g,b=[],x=0;x<r.length;++x)b[x]=(u=r[x],g=h=void 0,h=u.t||"",(g=gt(3)).write_shift(2,h.length),g.write_shift(1,1),(u=gt(2*h.length)).write_shift(2*h.length,h,"utf16le"),he([g,u]));var y=he([d].concat(b));return y.parts=[d.length].concat(b.map(function(j){return j.length})),y}function M0(r,d,u){var h=0;return u&&u.biff==2||(h=r.read_shift(2)),r=r.read_shift(2),u&&u.biff==2&&(h=1-(r>>15),r&=32767),[{Unsynced:1&h,DyZero:(2&h)>>1,ExAsc:(4&h)>>2,ExDsc:(8&h)>>3},r]}var Pl=Vi;function lo(r,b,x){var h=r.l+b,y=x.biff!=8&&x.biff?2:4,g=r.read_shift(y),b=r.read_shift(y),x=r.read_shift(2),y=r.read_shift(2);return r.l=h,{s:{r:g,c:x},e:{r:b,c:y}}}function oo(r,d,u,h){return u=u&&u.biff==5,(h=h||gt(u?16:20)).write_shift(2,0),r.style?(h.write_shift(2,r.numFmtId||0),h.write_shift(2,65524)):(h.write_shift(2,r.numFmtId||0),h.write_shift(2,d<<4)),d=0,0<r.numFmtId&&u&&(d|=1024),h.write_shift(4,d),h.write_shift(4,0),u||h.write_shift(4,0),h.write_shift(2,0),h}function _m(r,d,u){var h=Ha(r);return u.biff!=2&&d!=9||++r.l,r=(d=r).read_shift(1),r=d.read_shift(1)===1?r:r===1,h.val=r,h.t=r===!0||r===!1?"b":"e",h}function kh(r,d,u){return d===0?"":Vi(r,0,u)}function Fm(r,d,u){var h,g=r.read_shift(2),g={fBuiltIn:1&g,fWantAdvise:g>>>1&1,fWantPict:g>>>2&1,fOle:g>>>3&1,fOleLink:g>>>4&1,cf:g>>>5&1023,fIcon:g>>>15&1};return u.sbcch===14849&&(h=(function(b,k,y){b.l+=4,k-=4;var j=b.l+k,k=Jn(b,0,y);if((y=b.read_shift(2))!==(j-=b.l))throw new Error("Malformed AddinUdf: padding = "+j+" != "+y);return b.l+=y,k})(r,d-2,u)),g.body=h||r.read_shift(d-2),typeof h=="string"&&(g.Name=h),g}var Mm=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function kl(r,j,u){var h=r.l+j,g=r.read_shift(2),b=r.read_shift(1),x=r.read_shift(1),y=r.read_shift(u&&u.biff==2?1:2),j=0;return(!u||5<=u.biff)&&(u.biff!=5&&(r.l+=2),j=r.read_shift(2),u.biff==5&&(r.l+=2),r.l+=4),x=Ui(r,x,u),32&g&&(x=Mm[x.charCodeAt(0)]),g=h-r.l,u&&u.biff==2&&--g,{chKey:b,Name:x,itab:j,rgce:h!=r.l&&y!==0&&0<g?(function(k,q,T,I){var R,q=k.l+q,I=Ed(k,I,T);return q!==k.l&&(R=vo(k,q-k.l,I,T)),[I,R]})(r,g,u,y):[]}}function L0(r,d,u){if(u.biff<8)return(function(y,j){return y[y.l+1]==3&&y[y.l]++,j=Jn(y,0,j),j.charCodeAt(0)==3?j.slice(1):j})(r,u);for(var h,g,b=[],d=r.l+d,x=r.read_shift(8<u.biff?4:2);x--!=0;)b.push((h=r,u.biff,g=8<(g=u).biff?4:2,[h.read_shift(g),h.read_shift(g,"i"),h.read_shift(g,"i")]));if(r.l!=d)throw new Error("Bad ExternSheet: "+r.l+" != "+d);return b}function ld(r,d,u){var h=qp(r);switch(u.biff){case 2:r.l++,d-=7;break;case 3:case 4:r.l+=2,d-=8;break;default:r.l+=6,d-=12}return[h,(function(g,b,x){var y,j=g.l+b,k=x.biff==2?1:2,E=g.read_shift(k);if(E==65535)return[[],La(g,b-2)];var T=Ed(g,E,x);return b!==E+k&&(y=vo(g,b-E-k,T,x)),g.l=j,[T,y]})(r,d,u)]}var Lm={8:function(r,d){var u=r.l+d;r.l+=10;var h=r.read_shift(2);return r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4,d=r.read_shift(1),r.l+=d,r.l=u,{fmt:h}}};function sc(r){var d=gt(24),u=Hr(r[0]);d.write_shift(2,u.r),d.write_shift(2,u.r),d.write_shift(2,u.c),d.write_shift(2,u.c);for(var h="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),g=0;g<16;++g)d.write_shift(1,parseInt(h[g],16));return he([d,(function(b){var x=gt(512),y=0,j=b.Target,k=-1<(b=(j=j.slice(0,7)=="file://"?j.slice(7):j).indexOf("#"))?31:23;switch(j.charAt(0)){case"#":k=28;break;case".":k&=-3}x.write_shift(4,2),x.write_shift(4,k);for(var E=[8,6815827,6619237,4849780,83],y=0;y<E.length;++y)x.write_shift(4,E[y]);if(k==28)yi(j=j.slice(1),x);else if(2&k){for(E="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),y=0;y<E.length;++y)x.write_shift(1,parseInt(E[y],16));var T=-1<b?j.slice(0,b):j;for(x.write_shift(4,2*(T.length+1)),y=0;y<T.length;++y)x.write_shift(2,T.charCodeAt(y));x.write_shift(2,0),8&k&&yi(-1<b?j.slice(b+1):"",x)}else{for(E="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),y=0;y<E.length;++y)x.write_shift(1,parseInt(E[y],16));for(var _=0;j.slice(3*_,3*_+3)=="../"||j.slice(3*_,3*_+3)=="..\\";)++_;for(x.write_shift(2,_),x.write_shift(4,j.length-3*_+1),y=0;y<j.length-3*_;++y)x.write_shift(1,255&j.charCodeAt(y+3*_));for(x.write_shift(1,0),x.write_shift(2,65535),x.write_shift(2,57005),y=0;y<6;++y)x.write_shift(4,0)}return x.slice(0,x.l)})(r[1])])}function R0(r,j,u){if(!u.cellStyles)return La(r,j);var h=u&&12<=u.biff?4:2,g=r.read_shift(h),b=r.read_shift(h),x=r.read_shift(h),y=r.read_shift(h),j=r.read_shift(2);return h==2&&(r.l+=2),y={s:g,e:b,w:x,ixfe:y,flags:j},(5<=u.biff||!u.biff)&&(y.level=j>>8&7),y}var O0=Ha,P0=jh,If=Hi,Ch,Sh,wi,co=[2,3,48,49,131,139,140,245],I0=(Ch={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},Sh=$n({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),wi={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(r,d){try{return Gn(Ah(r,d),d)}catch(u){if(d&&d.WTF)throw u}return{SheetNames:[],Sheets:{}}},to_sheet:Ah,from_sheet:function(r,d){if(0<=+(d=d||{}).codepage&&D(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");for(var u=Ra(),h=(d=Ou(r,{header:1,raw:!0,cellDates:!0}))[0],g=d.slice(1),b=r["!cols"]||[],k=0,x=0,y=0,j=1,k=0;k<h.length;++k)if(((b[k]||{}).DBF||{}).name)h[k]=b[k].DBF.name,++y;else if(h[k]!=null){if(++y,typeof h[k]=="number"&&(h[k]=h[k].toString(10)),typeof h[k]!="string")throw new Error("DBF Invalid column name "+h[k]+" |"+typeof h[k]+"|");if(h.indexOf(h[k])!==k){for(x=0;x<1024;++x)if(h.indexOf(h[k]+"_"+x)==-1){h[k]+="_"+x;break}}}var E=Ls(r["!ref"]),T=[],_=[],R=[];for(k=0;k<=E.e.c-E.s.c;++k){for(var q="",I="",J=0,Y=[],x=0;x<g.length;++x)g[x][k]!=null&&Y.push(g[x][k]);if(Y.length!=0&&h[k]!=null){for(x=0;x<Y.length;++x){switch(typeof Y[x]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=Y[x]instanceof Date?"D":"C";break;default:I="C"}J=Math.max(J,String(Y[x]).length),q=q&&q!=I?"C":I}250<J&&(J=250),(I=((b[k]||{}).DBF||{}).type)=="C"&&b[k].DBF.len>J&&(J=b[k].DBF.len),q=="B"&&I=="N"&&(q="N",R[k]=b[k].DBF.dec,J=b[k].DBF.len),_[k]=q=="C"||I=="N"?J:wi[q]||0,j+=_[k],T[k]=q}else T[k]="?"}var z,X,ie=u.next(32);for(ie.write_shift(4,318902576),ie.write_shift(4,g.length),ie.write_shift(2,296+32*y),ie.write_shift(2,j),k=0;k<4;++k)ie.write_shift(4,0);for(ie.write_shift(4,0|(+Sh[v]||3)<<8),x=k=0;k<h.length;++k)h[k]!=null&&(z=u.next(32),X=(h[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),z.write_shift(1,X,"sbcs"),z.write_shift(1,T[k]=="?"?"C":T[k],"sbcs"),z.write_shift(4,x),z.write_shift(1,_[k]||wi[T[k]]||0),z.write_shift(1,R[k]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),x+=_[k]||wi[T[k]]||0);var le=u.next(264);for(le.write_shift(4,13),k=0;k<65;++k)le.write_shift(4,0);for(k=0;k<g.length;++k){var Ae=u.next(j);for(Ae.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(T[x]){case"L":Ae.write_shift(1,g[k][x]==null?63:g[k][x]?84:70);break;case"B":Ae.write_shift(8,g[k][x]||0,"f");break;case"N":var Ve="0";for(typeof g[k][x]=="number"&&(Ve=g[k][x].toFixed(R[x]||0)),y=0;y<_[x]-Ve.length;++y)Ae.write_shift(1,32);Ae.write_shift(1,Ve,"sbcs");break;case"D":g[k][x]?(Ae.write_shift(4,("0000"+g[k][x].getFullYear()).slice(-4),"sbcs"),Ae.write_shift(2,("00"+(g[k][x].getMonth()+1)).slice(-2),"sbcs"),Ae.write_shift(2,("00"+g[k][x].getDate()).slice(-2),"sbcs")):Ae.write_shift(8,"00000000","sbcs");break;case"C":var Oe=String(g[k][x]!=null?g[k][x]:"").slice(0,_[x]);for(Ae.write_shift(1,Oe,"sbcs"),y=0;y<_[x]-Oe.length;++y)Ae.write_shift(1,32)}}return u.next(1).write_shift(1,26),u.end()}});function Ah(r,d){return d=d||{},d.dateNF||(d.dateNF="yyyymmdd"),r=Xl((function(u,h){var g=[],b=Z(1);switch(h.type){case"base64":b=ue(Ne(u));break;case"binary":b=ue(u);break;case"buffer":case"array":b=u}ka(b,0);var x=b.read_shift(1),y=!!(136&x),j=!1,k=!1;switch(x){case 2:case 3:break;case 48:case 49:y=j=!0;break;case 131:case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var E=0,T=521;x==2&&(E=b.read_shift(2)),b.l+=3,1048576<(E=x!=2?b.read_shift(4):E)&&(E=1e6),x!=2&&(T=b.read_shift(2));var _=b.read_shift(2),R=h.codepage||1252;x!=2&&(b.l+=16,b.read_shift(1),b[b.l]!==0&&(R=Ch[b[b.l]]),b.l+=1,b.l+=2),k&&(b.l+=36);for(var q=[],I={},J=Math.min(b.length,x==2?521:T-10-(j?264:0)),Y=k?32:11;b.l<J&&b[b.l]!=13;)switch((I={}).name=e.utils.decode(R,b.slice(b.l,b.l+Y)).replace(/[\u0000\r\n].*$/g,""),b.l+=Y,I.type=String.fromCharCode(b.read_shift(1)),x==2||k||(I.offset=b.read_shift(4)),I.len=b.read_shift(1),x==2&&(I.offset=b.read_shift(2)),I.dec=b.read_shift(1),I.name.length&&q.push(I),x!=2&&(b.l+=k?13:14),I.type){case"B":j&&I.len==8||!h.WTF||console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(b[b.l]!==13&&(b.l=T-1),b.read_shift(1)!==13)throw new Error("DBF Terminator not found "+b.l+" "+b[b.l]);b.l=T;var z=0,X=0;for(g[0]=[],X=0;X!=q.length;++X)g[0][X]=q[X].name;for(;0<E--;)if(b[b.l]!==42)for(++b.l,g[++z]=[],X=X=0;X!=q.length;++X){var ie=b.slice(b.l,b.l+q[X].len);b.l+=q[X].len,ka(ie,0);var le=e.utils.decode(R,ie);switch(q[X].type){case"C":le.trim().length&&(g[z][X]=le.replace(/\s+$/,""));break;case"D":le.length===8?g[z][X]=new Date(+le.slice(0,4),+le.slice(4,6)-1,+le.slice(6,8)):g[z][X]=le;break;case"F":g[z][X]=parseFloat(le.trim());break;case"+":case"I":g[z][X]=k?2147483648^ie.read_shift(-4,"i"):ie.read_shift(4,"i");break;case"L":switch(le.trim().toUpperCase()){case"Y":case"T":g[z][X]=!0;break;case"N":case"F":g[z][X]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+le+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));g[z][X]="##MEMO##"+(k?parseInt(le.trim(),10):ie.read_shift(4));break;case"N":(le=le.replace(/\u0000/g,"").trim())&&le!="."&&(g[z][X]=+le||0);break;case"@":g[z][X]=new Date(ie.read_shift(-8,"f")-621356832e5);break;case"T":g[z][X]=new Date(864e5*(ie.read_shift(4)-2440588)+ie.read_shift(4));break;case"Y":g[z][X]=ie.read_shift(4,"i")/1e4+ie.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[z][X]=-ie.read_shift(-8,"f");break;case"B":if(j&&q[X].len==8){g[z][X]=ie.read_shift(8,"f");break}case"G":case"P":ie.l+=q[X].len;break;case"0":if(q[X].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+q[X].type)}}else b.l+=_;if(x!=2&&b.l<b.length&&b[b.l++]!=26)throw new Error("DBF EOF Marker missing "+(b.l-1)+" of "+b.length+" "+b[b.l-1].toString(16));return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),h.DBF=q,g})(r,d),d),r["!cols"]=d.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete d.DBF,r}var $i,rc,od,ac,cd=($i={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},rc=new RegExp("\x1BN("+wr($i).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),od=function(r,d){return d=$i[d],typeof d=="number"?G(d):d},ac=function(r,d,u){return u=d.charCodeAt(0)-32<<4|u.charCodeAt(0)-48,u==59?r:G(u)},$i["|"]=254,{to_workbook:function(r,d){return Gn(Cl(r,d),d)},to_sheet:Cl,from_sheet:function(r,d){var u,h,g=["ID;PWXL;N;E"],b=[],x=Ls(r["!ref"]),y=Array.isArray(r),j=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),r["!cols"]&&(u=g,r["!cols"].forEach(function(_,R){R="F;W"+(R+1)+" "+(R+1)+" ",_.hidden?R+="0":(typeof _.width!="number"||_.wpx||(_.wpx=dc(_.width)),typeof _.wpx!="number"||_.wch||(_.wch=Al(_.wpx)),typeof _.wch=="number"&&(R+=Math.round(_.wch))),R.charAt(R.length-1)!=" "&&u.push(R)})),r["!rows"]&&(h=g,r["!rows"].forEach(function(_,R){var q="F;";_.hidden?q+="M0;":_.hpt?q+="M"+20*_.hpt+";":_.hpx&&(q+="M"+20*uc(_.hpx)+";"),2<q.length&&h.push(q+"R"+(R+1))})),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var k=x.s.r;k<=x.e.r;++k)for(var E=x.s.c;E<=x.e.c;++E){var T=vs({r:k,c:E});(T=y?(r[k]||[])[E]:r[T])&&(T.v!=null||T.f&&!T.F)&&b.push((function(_,R,q){var I="C;Y"+(R+1)+";X"+(q+1)+";K";switch(_.t){case"n":I+=_.v||0,_.f&&!_.F&&(I+=";E"+au(_.f,{r:R,c:q}));break;case"b":I+=_.v?"TRUE":"FALSE";break;case"e":I+=_.w||_.v;break;case"d":I+='"'+(_.w||_.v)+'"';break;case"s":I+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return I})(T,k,E))}return g.join(j)+j+b.join(j)+j+"E"+j}});function dd(_,d){var u,h,g=_.split(/[\n\r]+/),b=-1,x=-1,y=0,j=0,k=[],E=[],T=null,_={},R=[],q=[],I=0;for(0<=+d.codepage&&D(+d.codepage);y!==g.length;++y){I=0;var J,Y=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,ac).replace(rc,od),z=Y.replace(/;;/g,"\0").split(";").map(function(Ct){return Ct.replace(/\u0000/g,";")}),X=z[0];if(0<Y.length)switch(X){case"ID":case"E":case"B":case"O":case"W":break;case"P":z[1].charAt(0)=="P"&&E.push(Y.slice(3).replace(/;;/g,";"));break;case"C":for(var ie=!1,le=!1,Ae=!1,Ve=!1,Oe=-1,Je=-1,j=1;j<z.length;++j)switch(z[j].charAt(0)){case"A":break;case"X":x=parseInt(z[j].slice(1))-1,le=!0;break;case"Y":for(b=parseInt(z[j].slice(1))-1,le||(x=0),h=k.length;h<=b;++h)k[h]=[];break;case"K":(J=z[j].slice(1)).charAt(0)==='"'?J=J.slice(1,J.length-1):J==="TRUE"?J=!0:J==="FALSE"?J=!1:isNaN(on(J))?isNaN(Cn(J).getDate())||(J=Ts(J)):(J=on(J),T!==null&&rr(T)&&(J=Li(J))),e!==void 0&&typeof J=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(J=e.utils.decode(d.codepage,J)),ie=!0;break;case"E":Ve=!0;var pt=bo(z[j].slice(1),{r:b,c:x});k[b][x]=[k[b][x],pt];break;case"S":Ae=!0,k[b][x]=[k[b][x],"S5S"];break;case"G":break;case"R":Oe=parseInt(z[j].slice(1))-1;break;case"C":Je=parseInt(z[j].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+Y)}if(ie&&(k[b][x]&&k[b][x].length==2?k[b][x][0]=J:k[b][x]=J,T=null),Ae){if(Ve)throw new Error("SYLK shared formula cannot have own formula");var xt=-1<Oe&&k[Oe][Je];if(!xt||!xt[1])throw new Error("SYLK shared formula cannot find base");k[b][x][1]=Cd(xt[1],{r:b-Oe,c:x-Je})}break;case"F":var at=0;for(j=1;j<z.length;++j)switch(z[j].charAt(0)){case"X":x=parseInt(z[j].slice(1))-1,++at;break;case"Y":for(b=parseInt(z[j].slice(1))-1,h=k.length;h<=b;++h)k[h]=[];break;case"M":I=parseInt(z[j].slice(1))/20;break;case"F":case"G":break;case"P":T=E[parseInt(z[j].slice(1))];break;case"S":case"D":case"N":break;case"W":for(u=z[j].slice(1).split(" "),h=parseInt(u[0],10);h<=parseInt(u[1],10);++h)I=parseInt(u[2],10),q[h-1]=I===0?{hidden:!0}:{wch:I},El(q[h-1]);break;case"C":q[x=parseInt(z[j].slice(1))-1]||(q[x]={});break;case"R":R[b=parseInt(z[j].slice(1))-1]||(R[b]={}),0<I?(R[b].hpt=I,R[b].hpx=xo(I)):I===0&&(R[b].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+Y)}at<1&&(T=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+Y)}}return 0<R.length&&(_["!rows"]=R),0<q.length&&(_["!cols"]=q),[k=d&&d.sheetRows?k.slice(0,d.sheetRows):k,_]}function Cl(h,d){var u=(function(x,y){switch(y.type){case"base64":return dd(Ne(x),y);case"binary":return dd(x,y);case"buffer":return dd(xe&&Buffer.isBuffer(x)?x.toString("binary"):be(x),y);case"array":return dd(ur(x),y)}throw new Error("Unrecognized type "+y.type)})(h,d),h=u[0],g=u[1],b=Xl(h,d);return wr(g).forEach(function(x){b[x]=g[x]}),b}var Eh={to_workbook:function(r,d){return Gn(B0(r,d),d)},to_sheet:B0,from_sheet:function(r){var d=[],u=Ls(r["!ref"]),h=Array.isArray(r);nc(d,"TABLE",0,1,"sheetjs"),nc(d,"VECTORS",0,u.e.r-u.s.r+1,""),nc(d,"TUPLES",0,u.e.c-u.s.c+1,""),nc(d,"DATA",0,0,"");for(var g=u.s.r;g<=u.e.r;++g){Aa(d,-1,0,"BOT");for(var b=u.s.c;b<=u.e.c;++b){var x,y=vs({r:g,c:b});if(x=h?(r[g]||[])[b]:r[y])switch(x.t){case"n":var j=x.w;(j=!j&&x.v!=null?x.v:j)==null?x.f&&!x.F?Aa(d,1,0,"="+x.f):Aa(d,1,0,""):Aa(d,0,j,"V");break;case"b":Aa(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":Aa(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Er(x.z||V[14],Dr(Ts(x.v)))),Aa(d,0,x.w,"V");break;default:Aa(d,1,0,"")}else Aa(d,1,0,"")}}return Aa(d,-1,0,"EOD"),d.join(`\r
`)}};function ei(r,d){for(var u=r.split(`
`),h=-1,g=-1,b=0,x=[];b!==u.length;++b)if(u[b].trim()!=="BOT"){if(!(h<0)){for(var y=u[b].trim().split(","),j=y[0],k=y[1],E=u[++b]||"";1&(E.match(/["]/g)||[]).length&&b<u.length-1;)E+=`
`+u[++b];switch(E=E.trim(),+j){case-1:if(E==="BOT"){x[++h]=[],g=0;continue}if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?x[h][g]=!0:E==="FALSE"?x[h][g]=!1:isNaN(on(k))?isNaN(Cn(k).getDate())?x[h][g]=k:x[h][g]=Ts(k):x[h][g]=on(k),++g;break;case 1:E=(E=E.slice(1,E.length-1)).replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),x[h][g++]=E!==""?E:null}if(E==="EOD")break}}else x[++h]=[],g=0;return x=d&&d.sheetRows?x.slice(0,d.sheetRows):x}function B0(r,d){return Xl((function(u,h){switch(h.type){case"base64":return ei(Ne(u),h);case"binary":return ei(u,h);case"buffer":return ei(xe&&Buffer.isBuffer(u)?u.toString("binary"):be(u),h);case"array":return ei(ur(u),h)}throw new Error("Unrecognized type "+h.type)})(r,d),d)}function nc(r,d,u,h,g){r.push(d),r.push(u+","+h),r.push('"'+g.replace(/"/g,'""')+'"')}function Aa(r,d,u,h){r.push(d+","+u),r.push(d==1?'"'+h.replace(/"/g,'""')+'"':h)}var qi,uo,z0,U0,ic=(qi=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),uo=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,z0=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),U0="--SocialCalcSpreadsheetControlSave--",{to_workbook:function(r,d){return Gn(Dh(r,d),d)},to_sheet:Dh,from_sheet:function(r){return[qi,uo,z0,uo,(function(d){if(!d||!d["!ref"])return"";for(var u,h,g=[],b=[],x=Oa(d["!ref"]),y=Array.isArray(d),j=x.s.r;j<=x.e.r;++j)for(var k=x.s.c;k<=x.e.c;++k)if(h=vs({r:j,c:k}),(u=y?(d[j]||[])[k]:d[h])&&u.v!=null&&u.t!=="z"){switch(b=["cell",h,"t"],u.t){case"s":case"str":b.push(ho(u.v));break;case"n":u.f?(b[2]="vtf",b[3]="n",b[4]=u.v,b[5]=ho(u.f)):(b[2]="v",b[3]=u.v);break;case"b":b[2]="vt"+(u.f?"f":"c"),b[3]="nl",b[4]=u.v?"1":"0",b[5]=ho(u.f||(u.v?"TRUE":"FALSE"));break;case"d":var E=Dr(Ts(u.v));b[2]="vtc",b[3]="nd",b[4]=""+E,b[5]=u.w||Er(u.z||V[14],E);break;case"e":continue}g.push(b.join(":"))}return g.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)})(r),U0].join(`
`)}});function ho(r){return r.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function Dh(r,d){return Xl((function(u,h){for(var g,b=u.split(`
`),x=-1,y=0,j=[];y!==b.length;++y){var k=b[y].trim().split(":");if(k[0]==="cell"){var E=Hr(k[1]);if(j.length<=E.r)for(x=j.length;x<=E.r;++x)j[x]||(j[x]=[]);switch(x=E.r,g=E.c,k[2]){case"t":j[x][g]=k[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`);break;case"v":j[x][g]=+k[3];break;case"vtf":var T=k[k.length-1];case"vtc":k[3]==="nl"?j[x][g]=!!+k[4]:j[x][g]=+k[4],k[2]=="vtf"&&(j[x][g]=[j[x][g],T])}}}return j=h&&h.sheetRows?j.slice(0,h.sheetRows):j})(r,d),d)}var H0,Yi,Gi=(H0={44:",",9:"	",59:";",124:"|"},Yi={44:3,9:2,59:1,124:0},{to_workbook:function(r,d){return Gn(yn(r,d),d)},to_sheet:yn,from_sheet:function(r){for(var d=[],u=Ls(r["!ref"]),h=Array.isArray(r),g=u.s.r;g<=u.e.r;++g){for(var b=[],x=u.s.c;x<=u.e.c;++x){var y=vs({r:g,c:x});if((y=h?(r[g]||[])[x]:r[y])&&y.v!=null){for(var j=(y.w||(gi(y),y.w)||"").slice(0,10);j.length<10;)j+=" ";b.push(j+(x===0?" ":""))}else b.push("          ")}d.push(b.join(""))}return d.join(`
`)}});function Th(r,d,u,h,g){g.raw?d[u][h]=r:r===""||(r==="TRUE"?d[u][h]=!0:r==="FALSE"?d[u][h]=!1:isNaN(on(r))?isNaN(Cn(r).getDate())?d[u][h]=r:d[u][h]=Ts(r):d[u][h]=on(r))}function V0(r){for(var d={},u=!1,h=0,g=0;h<r.length;++h)(g=r.charCodeAt(h))==34?u=!u:!u&&g in H0&&(d[g]=(d[g]||0)+1);for(h in g=[],d)Object.prototype.hasOwnProperty.call(d,h)&&g.push([d[h],h]);if(!g.length)for(h in d=Yi)Object.prototype.hasOwnProperty.call(d,h)&&g.push([d[h],h]);return g.sort(function(b,x){return b[0]-x[0]||Yi[b[1]]-Yi[x[1]]}),H0[g.pop()[1]]||44}function _h(r,h){var u=h||{},h="",g=u.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};r.slice(0,4)=="sep="?r.charCodeAt(5)==13&&r.charCodeAt(6)==10?(h=r.charAt(4),r=r.slice(7)):r.charCodeAt(5)==13||r.charCodeAt(5)==10?(h=r.charAt(4),r=r.slice(6)):h=V0(r.slice(0,1024)):h=u&&u.FS?u.FS:V0(r.slice(0,1024));var x=0,y=0,j=0,k=0,E=0,T=h.charCodeAt(0),_=!1,R=0,q=r.charCodeAt(0);r=r.replace(/\r\n/gm,`
`);var I=u.dateNF!=null?(h=(h=typeof(h=u.dateNF)=="number"?V[h]:h).replace(_i,"(\\d+)"),new RegExp("^"+h+"$")):null;function J(){var Y,z=r.slice(k,E),X={};if((z=z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'?z.slice(1,-1).replace(/""/g,'"'):z).length===0?X.t="z":u.raw||z.trim().length===0?(X.t="s",X.v=z):z.charCodeAt(0)==61?z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(X.t="s",X.v=z.slice(2,-1).replace(/""/g,'"')):z.length!=1?(X.t="n",X.f=z.slice(1)):(X.t="s",X.v=z):z=="TRUE"?(X.t="b",X.v=!0):z=="FALSE"?(X.t="b",X.v=!1):isNaN(j=on(z))?!isNaN(Cn(z).getDate())||I&&z.match(I)?(X.z=u.dateNF||V[14],Y=0,I&&z.match(I)&&(z=(function(ie,le){var Ae=-1,Ve=-1,Oe=-1,Je=-1,pt=-1,xt=-1;(ie.match(_i)||[]).forEach(function(Ct,Vt){var Ut=parseInt(le[Vt+1],10);switch(Ct.toLowerCase().charAt(0)){case"y":Ae=Ut;break;case"d":Oe=Ut;break;case"h":Je=Ut;break;case"s":xt=Ut;break;case"m":0<=Je?pt=Ut:Ve=Ut}}),0<=xt&&pt==-1&&0<=Ve&&(pt=Ve,Ve=-1);var at=(""+(0<=Ae?Ae:new Date().getFullYear())).slice(-4)+"-"+("00"+(1<=Ve?Ve:1)).slice(-2)+"-"+("00"+(1<=Oe?Oe:1)).slice(-2);return(at=at.length==7?"0"+at:at).length==8&&(at="20"+at),ie=("00"+(0<=Je?Je:0)).slice(-2)+":"+("00"+(0<=pt?pt:0)).slice(-2)+":"+("00"+(0<=xt?xt:0)).slice(-2),Je==-1&&pt==-1&&xt==-1?at:Ae==-1&&Ve==-1&&Oe==-1?ie:at+"T"+ie})(u.dateNF,z.match(I)||[]),Y=1),u.cellDates?(X.t="d",X.v=Ts(z,Y)):(X.t="n",X.v=Dr(Ts(z,Y))),u.cellText!==!1&&(X.w=Er(X.z,X.v instanceof Date?Dr(X.v):X.v)),u.cellNF||delete X.z):(X.t="s",X.v=z):(!(X.t="n")!==u.cellText&&(X.w=z),X.v=j),X.t=="z"||(u.dense?(g[x]||(g[x]=[]),g[x][y]=X):g[vs({c:y,r:x})]=X),k=E+1,q=r.charCodeAt(k),b.e.c<y&&(b.e.c=y),b.e.r<x&&(b.e.r=x),R!=T)return y=0,++x,u.sheetRows&&u.sheetRows<=x?1:void 0;++y}e:for(;E<r.length;++E)switch(R=r.charCodeAt(E)){case 34:q===34&&(_=!_);break;case T:case 10:case 13:if(!_&&J())break e}return 0<E-k&&J(),g["!ref"]=Ss(b),g}function bn(r,d){return!d||!d.PRN||d.FS||r.slice(0,4)=="sep="||0<=r.indexOf("	")||0<=r.indexOf(",")||0<=r.indexOf(";")?_h(r,d):Xl((function(u,h){var g=h||{},b=[];if(!u||u.length===0)return b;for(var x=u.split(/[\r\n]/),y=x.length-1;0<=y&&x[y].length===0;)--y;for(var j=10,k=0,E=0;E<=y;++E)(k=x[E].indexOf(" "))==-1?k=x[E].length:k++,j=Math.max(j,k);for(E=0;E<=y;++E){b[E]=[];var T=0;for(Th(x[E].slice(0,j).trim(),b,E,T,g),T=1;T<=(x[E].length-j)/10+1;++T)Th(x[E].slice(j+10*(T-1),j+10*T).trim(),b,E,T,g)}return b=g.sheetRows?b.slice(0,g.sheetRows):b})(r,d),d)}function yn(r,d){var u="",h=d.type=="string"?[0,0,0,0]:_f(r,d);switch(d.type){case"base64":u=Ne(r);break;case"binary":u=r;break;case"buffer":u=d.codepage==65001?r.toString("utf8"):d.codepage&&e!==void 0?e.utils.decode(d.codepage,r):xe&&Buffer.isBuffer(r)?r.toString("binary"):be(r);break;case"array":u=ur(r);break;case"string":u=r;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?u=qe(u.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?u=qe(u):d.type=="binary"&&e!==void 0&&d.codepage&&(u=e.utils.decode(d.codepage,e.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?ic.to_sheet(d.type=="string"?u:qe(u),d):bn(u,d)}var ti,ud,W0,Ki,ua=(ti={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},ud=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""],W0={0:{n:"BOF",f:xr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(r,d,u){var h={s:{c:0,r:0},e:{c:0,r:0}};return d==8&&u.qpro?(h.s.c=r.read_shift(1),r.l++,h.s.r=r.read_shift(2),h.e.c=r.read_shift(1),r.l++,h.e.r=r.read_shift(2)):(h.s.c=r.read_shift(2),h.s.r=r.read_shift(2),d==12&&u.qpro&&(r.l+=2),h.e.c=r.read_shift(2),h.e.r=r.read_shift(2),d==12&&u.qpro&&(r.l+=2),h.s.c==65535&&(h.s.c=h.e.c=h.s.r=h.e.r=0)),h}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(r,d,u){return(u=Fn(r,0,u))[1].v=r.read_shift(2,"i"),u}},14:{n:"NUMBER",f:function(r,d,u){return(u=Fn(r,0,u))[1].v=r.read_shift(8,"f"),u}},15:{n:"LABEL",f:As},16:{n:"FORMULA",f:function(r,d,u){var h=r.l+d;return(d=Fn(r,0,u))[1].v=r.read_shift(8,"f"),u.qpro?r.l=h:(h=r.read_shift(2),(function(g,b){ka(g,0);for(var x=[],y=0,j="",k="",E="",T="";g.l<g.length;){var _=g[g.l++];switch(_){case 0:x.push(g.read_shift(8,"f"));break;case 1:k=Zs(b[0].c,g.read_shift(2),!0),j=Zs(b[0].r,g.read_shift(2),!1),x.push(k+j);break;case 2:var R=Zs(b[0].c,g.read_shift(2),!0),q=Zs(b[0].r,g.read_shift(2),!1);k=Zs(b[0].c,g.read_shift(2),!0),j=Zs(b[0].r,g.read_shift(2),!1),x.push(R+q+":"+k+j);break;case 3:if(g.l<g.length)return console.error("WK1 premature formula end");break;case 4:x.push("("+x.pop()+")");break;case 5:x.push(g.read_shift(2));break;case 6:for(var I="";_=g[g.l++];)I+=String.fromCharCode(_);x.push('"'+I.replace(/"/g,'""')+'"');break;case 8:x.push("-"+x.pop());break;case 23:x.push("+"+x.pop());break;case 22:x.push("NOT("+x.pop()+")");break;case 20:case 21:T=x.pop(),E=x.pop(),x.push(["AND","OR"][_-20]+"("+E+","+T+")");break;default:if(_<32&&ud[_])T=x.pop(),E=x.pop(),x.push(E+ud[_]+T);else{if(!ti[_])return _<=7?console.error("WK1 invalid opcode "+_.toString(16)):_<=24?console.error("WK1 unsupported op "+_.toString(16)):_<=30?console.error("WK1 invalid opcode "+_.toString(16)):_<=115?console.error("WK1 unsupported function opcode "+_.toString(16)):console.error("WK1 unrecognized opcode "+_.toString(16));if((y=(y=ti[_][1])==69?g[g.l++]:y)>x.length)return console.error("WK1 bad formula parse 0x"+_.toString(16)+":|"+x.join("|")+"|");q=x.slice(-y),x.length-=y,x.push(ti[_][0]+"("+q.join(",")+")")}}}x.length==1?b[1].f=""+x[0]:console.error("WK1 bad formula parse |"+x.join("|")+"|")})(r.slice(r.l,r.l+h),d),r.l+=h),d}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:As},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Sl},222:{n:"SHEETNAMELP",f:function(r,d){var u=r[r.l++];d-1<u&&(u=d-1);for(var h="";h.length<u;)h+=String.fromCharCode(r[r.l++]);return h}},65535:{n:""}},Ki={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(r,d){var u=Rr(r);return u[1].t="s",u[1].v=r.read_shift(d-4,"cstr"),u}},23:{n:"NUMBER17",f:hd},24:{n:"NUMBER18",f:function(r,d){var u=Rr(r);u[1].v=r.read_shift(2);var h=u[1].v>>1;if(1&u[1].v)switch(7&h){case 0:h=5e3*(h>>3);break;case 1:h=500*(h>>3);break;case 2:h=(h>>3)/20;break;case 3:h=(h>>3)/200;break;case 4:h=(h>>3)/2e3;break;case 5:h=(h>>3)/2e4;break;case 6:h=(h>>3)/16;break;case 7:h=(h>>3)/64}return u[1].v=h,u}},25:{n:"FORMULA19",f:function(r,d){var u=hd(r);return r.l+=d-14,u}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(r,d){for(var u={},h=r.l+d;r.l<h;){var g=r.read_shift(2);if(g==14e3){for(u[g]=[0,""],u[g][0]=r.read_shift(2);r[r.l];)u[g][1]+=String.fromCharCode(r[r.l]),r.l++;r.l++}}return u}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(h,d){var u=Rr(h),h=h.read_shift(4);return u[1].v=h>>6,u}},38:{n:"??"},39:{n:"NUMBER27",f:fo},40:{n:"FORMULA28",f:function(r,d){var u=fo(r);return r.l+=d-10,u}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Sl},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(r,d,u){if(u.qpro&&!(d<21))return u=r.read_shift(1),r.l+=17,r.l+=1,r.l+=2,[u,r.read_shift(d-21,"cstr")]}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},{sheet_to_wk1:function(r,d){var u=d||{};if(0<=+u.codepage&&D(+u.codepage),u.type=="string")throw new Error("Cannot write WK1 to JS string");var h=Ra(),g=Ls(r["!ref"]),b=Array.isArray(r),x=[];It(h,0,(d=1030,(u=gt(2)).write_shift(2,d),u)),It(h,6,(d=g,(u=gt(8)).write_shift(2,d.s.c),u.write_shift(2,d.s.r),u.write_shift(2,d.e.c),u.write_shift(2,d.e.r),u));for(var y,j,k,E,T=Math.min(g.e.r,8191),_=g.s.r;_<=T;++_)for(var R=Ur(_),q=g.s.c;q<=g.e.c;++q){_===g.s.r&&(x[q]=Tr(q));var I=x[q]+R,I=b?(r[_]||[])[q]:r[I];I&&I.t!="z"&&(I.t=="n"?(0|I.v)==I.v&&-32768<=I.v&&I.v<=32767?It(h,13,(y=_,j=q,k=I.v,E=void 0,(E=gt(7)).write_shift(1,255),E.write_shift(2,j),E.write_shift(2,y),E.write_shift(2,k,"i"),E)):It(h,14,(j=_,y=q,k=I.v,E=void 0,(E=gt(13)).write_shift(1,255),E.write_shift(2,y),E.write_shift(2,j),E.write_shift(8,k,"f"),E)):It(h,15,(function(J,Y,z){var X=gt(7+z.length);X.write_shift(1,255),X.write_shift(2,Y),X.write_shift(2,J),X.write_shift(1,39);for(var ie=0;ie<X.length;++ie){var le=z.charCodeAt(ie);X.write_shift(1,128<=le?95:le)}return X.write_shift(1,0),X})(_,q,gi(I).slice(0,239))))}return It(h,1),h.end()},book_to_wk3:function(r,d){if(0<=+(d=d||{}).codepage&&D(+d.codepage),d.type=="string")throw new Error("Cannot write WK3 to JS string");var u=Ra();It(u,0,(function(I){var J=gt(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var Y=0,z=0,X=0,ie=0;ie<I.SheetNames.length;++ie){var le=I.SheetNames[ie],le=I.Sheets[le];le&&le["!ref"]&&(++X,le=Oa(le["!ref"]),Y<le.e.r&&(Y=le.e.r),z<le.e.c&&(z=le.e.c))}return 8191<Y&&(Y=8191),J.write_shift(2,Y),J.write_shift(1,X),J.write_shift(1,z),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J})(r));for(var h=0,g=0;h<r.SheetNames.length;++h)(r.Sheets[r.SheetNames[h]]||{})["!ref"]&&It(u,27,(function(I,J){var Y=gt(5+I.length);Y.write_shift(2,14e3),Y.write_shift(2,J);for(var z=0;z<I.length;++z){var X=I.charCodeAt(z);Y[Y.l++]=127<X?95:X}return Y[Y.l++]=0,Y})(r.SheetNames[h],g++));for(var b=0,h=0;h<r.SheetNames.length;++h){var x=r.Sheets[r.SheetNames[h]];if(x&&x["!ref"]){for(var y=Ls(x["!ref"]),j=Array.isArray(x),k=[],E=Math.min(y.e.r,8191),T=y.s.r;T<=E;++T)for(var _=Ur(T),R=y.s.c;R<=y.e.c;++R){T===y.s.r&&(k[R]=Tr(R));var q=k[R]+_,q=j?(x[T]||[])[R]:x[q];q&&q.t!="z"&&(q.t=="n"?It(u,23,(function(Ae,Oe,Ve,X){var ie=gt(14);if(ie.write_shift(2,Ae),ie.write_shift(1,Ve),ie.write_shift(1,Oe),X==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var le=0,Ae=0,Ve=0,Oe=0;return X<0&&(le=1,X=-X),Ae=0|Math.log2(X),X/=Math.pow(2,Ae-31),(2147483648&(Oe=X>>>0))==0&&(++Ae,Oe=(X/=2)>>>0),X-=Oe,Oe|=2147483648,Oe>>>=0,X*=Math.pow(2,32),Ve=X>>>0,ie.write_shift(4,Ve),ie.write_shift(4,Oe),Ae+=16383+(le?32768:0),ie.write_shift(2,Ae),ie})(T,R,b,q.v)):It(u,22,(function(J,Y,z,X){var ie=gt(6+X.length);ie.write_shift(2,J),ie.write_shift(1,z),ie.write_shift(1,Y),ie.write_shift(1,39);for(var le=0;le<X.length;++le){var Ae=X.charCodeAt(le);ie.write_shift(1,128<=Ae?95:Ae)}return ie.write_shift(1,0),ie})(T,R,b,gi(q).slice(0,239))))}++b}}return It(u,1),u.end()},to_workbook:function(r,d){switch(d.type){case"base64":return lc(ue(Ne(r)),d);case"binary":return lc(ue(r),d);case"buffer":case"array":return lc(r,d)}throw"Unsupported type "+d.type}});function Gr(r,d,u){if(r){ka(r,r.l||0);for(var h=u.Enum||W0;r.l<r.length;){var g=r.read_shift(2),b=h[g]||h[65535],y=r.read_shift(2),x=r.l+y,y=b.f&&b.f(r,y,u);if(r.l=x,d(y,b,g))return}}}function lc(r,d){if(!r)return r;var u=d||{},h=u.dense?[]:{},g="Sheet1",b="",x=0,y={},j=[],k=[],E={s:{r:0,c:0},e:{r:0,c:0}},T=u.sheetRows||0;if(r[2]==0&&(r[3]==8||r[3]==9)&&16<=r.length&&r[14]==5&&r[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(r[2]==2)u.Enum=W0,Gr(r,function(I,J,Y){switch(Y){case 0:4096<=(u.vers=I)&&(u.qpro=!0);break;case 6:E=I;break;case 204:I&&(b=I);break;case 222:b=I;break;case 15:case 51:u.qpro||(I[1].v=I[1].v.slice(1));case 13:case 14:case 16:Y==14&&(112&I[2])==112&&1<(15&I[2])&&(15&I[2])<15&&(I[1].z=u.dateNF||V[14],u.cellDates&&(I[1].t="d",I[1].v=Li(I[1].v))),u.qpro&&I[3]>x&&(h["!ref"]=Ss(E),y[g]=h,j.push(g),h=u.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},x=I[3],g=b||"Sheet"+(x+1),b="");var z=u.dense?(h[I[0].r]||[])[I[0].c]:h[vs(I[0])];if(z){z.t=I[1].t,z.v=I[1].v,I[1].z!=null&&(z.z=I[1].z),I[1].f!=null&&(z.f=I[1].f);break}u.dense?(h[I[0].r]||(h[I[0].r]=[]),h[I[0].r][I[0].c]=I[1]):h[vs(I[0])]=I[1]}},u);else{if(r[2]!=26&&r[2]!=14)throw new Error("Unrecognized LOTUS BOF "+r[2]);u.Enum=Ki,r[2]==14&&(u.qpro=!0,r.l=0),Gr(r,function(I,J,Y){switch(Y){case 204:g=I;break;case 22:I[1].v=I[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(I[3]>x&&(h["!ref"]=Ss(E),y[g]=h,j.push(g),h=u.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},x=I[3],g="Sheet"+(x+1)),0<T&&I[0].r>=T)break;u.dense?(h[I[0].r]||(h[I[0].r]=[]),h[I[0].r][I[0].c]=I[1]):h[vs(I[0])]=I[1],E.e.c<I[0].c&&(E.e.c=I[0].c),E.e.r<I[0].r&&(E.e.r=I[0].r);break;case 27:I[14e3]&&(k[I[14e3][0]]=I[14e3][1]);break;case 1537:k[I[0]]=I[1],I[0]==x&&(g=I[1])}},u)}if(h["!ref"]=Ss(E),y[b||g]=h,j.push(b||g),!k.length)return{SheetNames:j,Sheets:y};for(var _={},R=[],q=0;q<k.length;++q)y[j[q]]?(R.push(k[q]||j[q]),_[k[q]]=y[k[q]]||y[j[q]]):(R.push(k[q]),_[k[q]]={"!ref":"A1"});return{SheetNames:R,Sheets:_}}function Fn(r,d,u){var h=[{c:0,r:0},{t:"n",v:0},0,0];return u.qpro&&u.vers!=20768?(h[0].c=r.read_shift(1),h[3]=r.read_shift(1),h[0].r=r.read_shift(2),r.l+=2):(h[2]=r.read_shift(1),h[0].c=r.read_shift(2),h[0].r=r.read_shift(2)),h}function As(r,g,u){var h=r.l+g,g=Fn(r,0,u);return g[1].t="s",u.vers!=20768?(u.qpro&&r.l++,g[1].v=r.read_shift(h-r.l,"cstr"),g):(r.l++,h=r.read_shift(1),g[1].v=r.read_shift(h,"utf8"),g)}function Zs(r,d,u){var h=32768&d;return(h?"":"$")+(u?Tr:Ur)(d=(h?r:0)+(8192<=(d&=-32769)?d-16384:d))}function Rr(r){var d=[{c:0,r:0},{t:"n",v:0},0];return d[0].r=r.read_shift(2),d[3]=r[r.l++],d[0].c=r[r.l++],d}function hd(b,d){var u=Rr(b),h=b.read_shift(4),g=b.read_shift(4);if((x=b.read_shift(2))==65535)return h===0&&g===3221225472?(u[1].t="e",u[1].v=15):h===0&&g===3489660928?(u[1].t="e",u[1].v=42):u[1].v=0,u;var b=32768&x,x=(32767&x)-16446;return u[1].v=(1-2*b)*(g*Math.pow(2,32+x)+h*Math.pow(2,x)),u}function fo(h,d){var u=Rr(h),h=h.read_shift(8,"f");return u[1].v=h,u}function Sl(r,d){return r[r.l+d-1]==0?r.read_shift(d,"cstr"):""}var fd,oc,mo,Rm,Kr=(fd=Be("t"),oc=Be("rPr"),mo=/<(?:\w+:)?r>/g,Rm=/<\/(?:\w+:)?r>/,function(r){return r.replace(mo,"").split(Rm).map(Fh).filter(function(d){return d.v})});function Fh(r){var d=r.match(fd);return d?(d={t:"s",v:ys(d[1])},r=r.match(oc),r&&(d.s=(function(u){var h={},g=u.match(Mr),b=0,x=!1;if(g)for(;b!=g.length;++b){var y=gs(g[b]);switch(y[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!y.val)break;case"<shadow>":case"<shadow/>":h.shadow=1;break;case"</shadow>":break;case"<charset":if(y.val=="1")break;h.cp=N[parseInt(y.val,10)];break;case"<outline":if(!y.val)break;case"<outline>":case"<outline/>":h.outline=1;break;case"</outline>":break;case"<rFont":h.name=y.val;break;case"<sz":h.sz=y.val;break;case"<strike":if(!y.val)break;case"<strike>":case"<strike/>":h.strike=1;break;case"</strike>":break;case"<u":if(!y.val)break;switch(y.val){case"double":h.uval="double";break;case"singleAccounting":h.uval="single-accounting";break;case"doubleAccounting":h.uval="double-accounting"}case"<u>":case"<u/>":h.u=1;break;case"</u>":break;case"<b":if(y.val=="0")break;case"<b>":case"<b/>":h.b=1;break;case"</b>":break;case"<i":if(y.val=="0")break;case"<i>":case"<i/>":h.i=1;break;case"</i>":break;case"<color":y.rgb&&(h.color=y.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":h.family=y.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":h.valign=y.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":x=!0;break;case"</ext>":x=!1;break;default:if(y[0].charCodeAt(1)!==47&&!x)throw new Error("Unrecognized rich format "+y[0])}}return h})(r[1])),d):{t:"s",v:""}}var $0,Om=($0=/(\r\n|\n)/g,function(r){return r.map(Pm).join("")});function Pm(r){var d,u,h,g=[[],r.v,[]];return r.v?(r.s&&(d=r.s,u=g[0],h=g[2],r=[],d.u&&r.push("text-decoration: underline;"),d.uval&&r.push("text-underline-style:"+d.uval+";"),d.sz&&r.push("font-size:"+d.sz+"pt;"),d.outline&&r.push("text-effect: outline;"),d.shadow&&r.push("text-shadow: auto;"),u.push('<span style="'+r.join("")+'">'),d.b&&(u.push("<b>"),h.push("</b>")),d.i&&(u.push("<i>"),h.push("</i>")),d.strike&&(u.push("<s>"),h.push("</s>")),(r=d.valign||"")=="superscript"||r=="super"?r="sup":r=="subscript"&&(r="sub"),r!=""&&(u.push("<"+r+">"),h.push("</"+r+">")),h.push("</span>")),g[0].join("")+g[1].replace($0,"<br/>")+g[2].join("")):""}var Yp=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Mh=/<(?:\w+:)?r>/,Lh=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function md(r,h){var u=!h||h.cellHTML,h={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(h.t=ys(qe(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),h.r=qe(r),u&&(h.h=Vo(h.t))):r.match(Mh)&&(h.r=qe(r),h.t=ys(qe((r.replace(Lh,"").match(Yp)||[]).join("").replace(Mr,""))),u&&(h.h=Om(Kr(h.r)))),h):{t:""}}var Va=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Jr=/<(?:\w+:)?(?:si|sstItem)>/g,q0=/<\/(?:\w+:)?(?:si|sstItem)>/,gd=/^\s|\s$|[\t\n\r]/;function pd(r,d){if(!d.bookSST)return"";var u=[kr];u[u.length]=kt("sst",null,{xmlns:gl[0],count:r.Count,uniqueCount:r.Unique});for(var h,g,b=0;b!=r.length;++b)r[b]!=null&&(g="<si>",(h=r[b]).r?g+=h.r:(g+="<t",h.t||(h.t=""),h.t.match(gd)&&(g+=' xml:space="preserve"'),g+=">"+Gs(h.t)+"</t>"),g+="</si>",u[u.length]=g);return 2<u.length&&(u[u.length]="</sst>",u[1]=u[1].replace("/>",">")),u.join("")}var Rh=function(r,d){var u=!1;return d==null&&(u=!0,d=gt(15+4*r.t.length)),d.write_shift(1,0),da(r.t,d),u?d.slice(0,d.l):d};function Qi(r){var d,u,h=Ra();yt(h,159,(d=r,(u=u||gt(8)).write_shift(4,d.Count),u.write_shift(4,d.Unique),u));for(var g=0;g<r.length;++g)yt(h,19,Rh(r[g]));return yt(h,160),h.end()}function xd(r){if(e!==void 0)return e.utils.encode(v,r);for(var d=[],u=r.split(""),h=0;h<u.length;++h)d[h]=u[h].charCodeAt(0);return d}function si(r,d){var u={};return u.Major=r.read_shift(2),u.Minor=r.read_shift(2),4<=d&&(r.l+=d-4),u}function Oh(r){var d=[];r.l+=4;for(var u=r.read_shift(4);0<u--;)d.push((function(h){for(var b=h.read_shift(4),g=h.l+b-4,b={},x=h.read_shift(4),y=[];0<x--;)y.push({t:h.read_shift(4),v:h.read_shift(0,"lpp4")});if(b.name=h.read_shift(0,"lpp4"),b.comps=y,h.l!=g)throw new Error("Bad DataSpaceMapEntry: "+h.l+" != "+g);return b})(r));return d}function Im(r){var d,u,u=(u={},(d=r).read_shift(4),d.l+=4,u.id=d.read_shift(0,"lpp4"),u.name=d.read_shift(0,"lpp4"),u.R=si(d,4),u.U=si(d,4),u.W=si(d,4),u);if(u.ename=r.read_shift(0,"8lpp4"),u.blksz=r.read_shift(4),u.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return u}function Ph(r,u){var u=r.l+u,h={};h.Flags=63&r.read_shift(4),r.l+=4,h.AlgID=r.read_shift(4);var g=!1;switch(h.AlgID){case 26126:case 26127:case 26128:g=h.Flags==36;break;case 26625:g=h.Flags==4;break;case 0:g=h.Flags==16||h.Flags==4||h.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+h.AlgID}if(!g)throw new Error("Encryption Flags/AlgID mismatch");return h.AlgIDHash=r.read_shift(4),h.KeySize=r.read_shift(4),h.ProviderType=r.read_shift(4),r.l+=8,h.CSPName=r.read_shift(u-r.l>>1,"utf16le"),r.l=u,h}function Ih(r,h){var u={},h=r.l+h;return r.l+=4,u.Salt=r.slice(r.l,r.l+16),r.l+=16,u.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),u.VerifierHash=r.slice(r.l,h),r.l=h,u}function Bm(r){var d=si(r);switch(d.Minor){case 2:return[d.Minor,(function(g){if((63&g.read_shift(4))!=36)throw new Error("EncryptionInfo mismatch");var h=g.read_shift(4),h=Ph(g,h),g=Ih(g,g.length-g.l);return{t:"Std",h,v:g}})(r)];case 3:return[d.Minor,(function(){throw new Error("File is password-protected: ECMA-376 Extensible")})()];case 4:return[d.Minor,(function(g){var h=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];g.l+=4;var g=g.read_shift(g.length-g.l,"utf8"),b={};return g.replace(Mr,function(x){var y=gs(x);switch(An(y[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":h.forEach(function(j){b[j]=y[j]});break;case"<dataIntegrity":b.encryptedHmacKey=y.encryptedHmacKey,b.encryptedHmacValue=y.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":b.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":b.uri=y.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":b.encs.push(y);break;default:throw y[0]}}),b})(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+d.Minor)}function Y0(r){var d,u=0,h=xd(r),g=h.length+1,b=Z(g);for(b[0]=h.length,d=1;d!=g;++d)b[d]=h[d-1];for(d=g-1;0<=d;--d)u=(((16384&u)==0?0:1)|u<<1&32767)^b[d];return 52811^u}var G0,K0,Bh,zm=(G0=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],K0=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],Bh=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],function(r){for(var d,u,h=xd(r),g=(function(j){for(var k=K0[j.length-1],E=104,T=j.length-1;0<=T;--T)for(var _=j[T],R=0;R!=7;++R)64&_&&(k^=Bh[E]),_*=2,--E;return k})(h),b=h.length,x=Z(16),y=0;y!=16;++y)x[y]=0;for((1&b)==1&&(d=g>>8,x[b]=go(G0[0],d),--b,d=255&g,r=h[h.length-1],x[b]=go(r,d));0<b;)d=g>>8,x[--b]=go(h[b],d),d=255&g,x[--b]=go(h[b],d);for(u=(b=15)-h.length;0<u;)d=g>>8,x[b]=go(G0[u],d),--u,d=255&g,x[--b]=go(h[b],d),--b,--u;return x});function go(r,d){return 255&((d=r^d)/2|128*d)}var Um=function(r){var d=0,u=zm(r);return function(h){return h=(function(g,b,x,y,j){var k,E;for(j=j||b,y=y||zm(g),k=0;k!=b.length;++k)E=b[k],E=255&((E^=y[x])>>5|E<<3),j[k]=E,++x;return[j,x,y]})("",h,d,u),d=h[1],h[0]}};function Hm(r,d,u){return u=u||{},u.Info=r.read_shift(2),r.l-=2,u.Info===1?u.Data=(function(h){var g={},b=g.EncryptionVersionInfo=si(h,4);if(b.Major!=1||b.Minor!=1)throw"unrecognized version code "+b.Major+" : "+b.Minor;return g.Salt=h.read_shift(16),g.EncryptedVerifier=h.read_shift(16),g.EncryptedVerifierHash=h.read_shift(16),g})(r):u.Data=(function(h,g){var b={},x=b.EncryptionVersionInfo=si(h,4);if(g-=4,x.Minor!=2)throw new Error("unrecognized minor version code: "+x.Minor);if(4<x.Major||x.Major<2)throw new Error("unrecognized major version code: "+x.Major);return b.Flags=h.read_shift(4),g-=4,x=h.read_shift(4),g-=4,b.EncryptionHeader=Ph(h,x),g-=x,b.EncryptionVerifier=Ih(h,g),b})(r,d),u}var Q0={to_workbook:function(r,d){return Gn(zh(r,d),d)},to_sheet:zh,from_sheet:function(r){for(var d=["{\\rtf1\\ansi"],u=Ls(r["!ref"]),h=Array.isArray(r),g=u.s.r;g<=u.e.r;++g){d.push("\\trowd\\trautofit1");for(var b=u.s.c;b<=u.e.c;++b)d.push("\\cellx"+(b+1));for(d.push("\\pard\\intbl"),b=u.s.c;b<=u.e.c;++b){var x=vs({r:g,c:b});(x=h?(r[g]||[])[b]:r[x])&&(x.v!=null||x.f&&!x.F)&&(d.push(" "+(x.w||(gi(x),x.w))),d.push("\\cell"))}d.push("\\pard\\intbl\\row")}return d.join("")+"}"}};function zh(r,d){switch(d.type){case"base64":return bd(Ne(r),d);case"binary":return bd(r,d);case"buffer":return bd(xe&&Buffer.isBuffer(r)?r.toString("binary"):be(r),d);case"array":return bd(ur(r),d)}throw new Error("Unrecognized type "+d.type)}function bd(h,d){var u=(d||{}).dense?[]:{},h=h.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(b,x){Array.isArray(u)&&(u[x]=[]);for(var y,j=/\\\w+\b/g,k=0,E=-1;y=j.exec(b);)y[0]==="\\cell"&&(++E,(y=(y=b.slice(k,j.lastIndex-y[0].length))[0]==" "?y.slice(1):y).length&&(y={v:y,t:"s"},Array.isArray(u)?u[x][E]=y:u[vs({r:x,c:E})]=y)),k=j.lastIndex;E>g.e.c&&(g.e.c=E)}),u["!ref"]=Ss(g),u}function cc(r){for(var d=0,u=1;d!=3;++d)u=256*u+(255<r[d]?255:r[d]<0?0:r[d]);return u.toString(16).toUpperCase().slice(1)}function yd(r,d){return d===0?r:(r=(function(E){var h=E[0]/255,g=E[1]/255,b=E[2]/255,x=Math.max(h,g,b),y=Math.min(h,g,b),j=x-y;if(j==0)return[0,0,h];var k=0,E=0,E=j/(1<(y=x+y)?2-y:y);switch(x){case h:k=((g-b)/j+6)%6;break;case g:k=(b-h)/j+2;break;case b:k=(h-g)/j+4}return[k/6,E,y/2]})((r=(r=r).slice(r[0]==="#"?1:0).slice(0,6),[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)])),r[2]=d<0?r[2]*(1+d):1-(1-r[2])*(1-d),cc((function(x){var h,g=x[0],b=x[1],x=x[2],y=2*b*(x<.5?x:1-x),j=[x=x-y/2,x,x],k=6*g;if(b!==0)switch(0|k){case 0:case 6:h=y*k,j[0]+=y,j[1]+=h;break;case 1:h=y*(2-k),j[0]+=h,j[1]+=y;break;case 2:h=y*(k-2),j[1]+=y,j[2]+=h;break;case 3:h=y*(4-k),j[1]+=h,j[2]+=y;break;case 4:h=y*(k-4),j[2]+=y,j[0]+=h;break;case 5:h=y*(6-k),j[2]+=h,j[0]+=y}for(var E=0;E!=3;++E)j[E]=Math.round(255*j[E]);return j})(r)))}var Uh=6,Gp=15,Vm=1,Zr=Uh;function dc(r){return Math.floor((r+Math.round(128/Zr)/256)*Zr)}function Al(r){return Math.floor((r-5)/Zr*100+.5)/100}function po(r){return Math.round((r*Zr+5)/Zr*256)/256}function X0(r){return po(Al(dc(r)))}function vd(r){var d=Math.abs(r-X0(r)),u=Zr;if(.005<d)for(Zr=Vm;Zr<Gp;++Zr)Math.abs(r-X0(r))<=d&&(d=Math.abs(r-X0(r)),u=Zr);Zr=u}function El(r){r.width?(r.wpx=dc(r.width),r.wch=Al(r.wpx),r.MDW=Zr):r.wpx?(r.wch=Al(r.wpx),r.width=po(r.wch),r.MDW=Zr):typeof r.wch=="number"&&(r.width=po(r.wch),r.wpx=dc(r.width),r.MDW=Zr),r.customWidth&&delete r.customWidth}var Hh=96;function uc(r){return 96*r/Hh}function xo(r){return r*Hh/96}var Wm={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},wd=["numFmtId","fillId","fontId","borderId","xfId"],hc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Vh,Wh,J0,$h,qh,jd,Yh=(Vh=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,Wh=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,J0=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,$h=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,qh=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(r,d,u){var h,g,b,x,y,j={};return r&&((h=(r=r.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(Vh))&&(function(k,E,T){E.NumberFmt=[];for(var _=wr(V),R=0;R<_.length;++R)E.NumberFmt[_[R]]=V[_[R]];var q=k[0].match(Mr);if(q)for(R=0;R<q.length;++R){var I=gs(q[R]);switch(An(I[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var J=ys(qe(I.formatCode)),Y=parseInt(I.numFmtId,10);if(E.NumberFmt[Y]=J,0<Y){if(392<Y){for(Y=392;60<Y&&E.NumberFmt[Y]!=null;--Y);E.NumberFmt[Y]=J}Br(J,Y)}break;case"</numFmt>":break;default:if(T.WTF)throw new Error("unrecognized "+I[0]+" in numFmts")}}})(h,j,u),(h=r.match($h))&&(function(k,E,T,_){E.Fonts=[];var R={},q=!1;(k[0].match(Mr)||[]).forEach(function(I){var J,Y=gs(I);switch(An(Y[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":E.Fonts.push(R),R={};break;case"<name":Y.val&&(R.name=qe(Y.val));break;case"<name/>":case"</name>":break;case"<b":R.bold=Y.val?hr(Y.val):1;break;case"<b/>":R.bold=1;break;case"<i":R.italic=Y.val?hr(Y.val):1;break;case"<i/>":R.italic=1;break;case"<u":switch(Y.val){case"none":R.underline=0;break;case"single":R.underline=1;break;case"double":R.underline=2;break;case"singleAccounting":R.underline=33;break;case"doubleAccounting":R.underline=34}break;case"<u/>":R.underline=1;break;case"<strike":R.strike=Y.val?hr(Y.val):1;break;case"<strike/>":R.strike=1;break;case"<outline":R.outline=Y.val?hr(Y.val):1;break;case"<outline/>":R.outline=1;break;case"<shadow":R.shadow=Y.val?hr(Y.val):1;break;case"<shadow/>":R.shadow=1;break;case"<condense":R.condense=Y.val?hr(Y.val):1;break;case"<condense/>":R.condense=1;break;case"<extend":R.extend=Y.val?hr(Y.val):1;break;case"<extend/>":R.extend=1;break;case"<sz":Y.val&&(R.sz=+Y.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":Y.val&&(R.vertAlign=Y.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":Y.val&&(R.family=parseInt(Y.val,10));break;case"<family/>":case"</family>":break;case"<scheme":Y.val&&(R.scheme=Y.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(Y.val=="1")break;Y.codepage=N[parseInt(Y.val,10)];break;case"<color":R.color||(R.color={}),Y.auto&&(R.color.auto=hr(Y.auto)),Y.rgb?R.color.rgb=Y.rgb.slice(-6):Y.indexed?(R.color.index=parseInt(Y.indexed,10),J=Xo[R.color.index],J=(J=R.color.index==81?Xo[1]:J)||Xo[1],R.color.rgb=J[0].toString(16)+J[1].toString(16)+J[2].toString(16)):Y.theme&&(R.color.theme=parseInt(Y.theme,10),Y.tint&&(R.color.tint=parseFloat(Y.tint)),Y.theme&&T.themeElements&&T.themeElements.clrScheme&&(R.color.rgb=yd(T.themeElements.clrScheme[R.color.theme].rgb,R.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":q=!0;break;case"</AlternateContent>":q=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":q=!0;break;case"</ext>":q=!1;break;default:if(_&&_.WTF&&!q)throw new Error("unrecognized "+Y[0]+" in fonts")}})})(h,j,d,u),(h=r.match(J0))&&(function(k,E,T){E.Fills=[];var _={},R=!1;(k[0].match(Mr)||[]).forEach(function(q){var I=gs(q);switch(An(I[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":_={},E.Fills.push(_);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":E.Fills.push(_),_={};break;case"<patternFill":case"<patternFill>":I.patternType&&(_.patternType=I.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":_.bgColor||(_.bgColor={}),I.indexed&&(_.bgColor.indexed=parseInt(I.indexed,10)),I.theme&&(_.bgColor.theme=parseInt(I.theme,10)),I.tint&&(_.bgColor.tint=parseFloat(I.tint)),I.rgb&&(_.bgColor.rgb=I.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":_.fgColor||(_.fgColor={}),I.theme&&(_.fgColor.theme=parseInt(I.theme,10)),I.tint&&(_.fgColor.tint=parseFloat(I.tint)),I.rgb!=null&&(_.fgColor.rgb=I.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":R=!0;break;case"</ext>":R=!1;break;default:if(T&&T.WTF&&!R)throw new Error("unrecognized "+I[0]+" in fills")}})})(h,j,u),(h=r.match(qh))&&(function(k,E,T){E.Borders=[];var _={},R=!1;(k[0].match(Mr)||[]).forEach(function(q){var I=gs(q);switch(An(I[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":_={},I.diagonalUp&&(_.diagonalUp=hr(I.diagonalUp)),I.diagonalDown&&(_.diagonalDown=hr(I.diagonalDown)),E.Borders.push(_);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":R=!0;break;case"</ext>":R=!1;break;default:if(T&&T.WTF&&!R)throw new Error("unrecognized "+I[0]+" in borders")}})})(h,j,u),(h=r.match(Wh))&&(h=h,b=u,y=!((g=j).CellXf=[]),(h[0].match(Mr)||[]).forEach(function(k){var E=gs(k),T=0;switch(An(E[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(x=E)[0],T=0;T<wd.length;++T)x[wd[T]]&&(x[wd[T]]=parseInt(x[wd[T]],10));for(T=0;T<hc.length;++T)x[hc[T]]&&(x[hc[T]]=hr(x[hc[T]]));if(g.NumberFmt&&392<x.numFmtId){for(T=392;60<T;--T)if(g.NumberFmt[x.numFmtId]==g.NumberFmt[T]){x.numFmtId=T;break}}g.CellXf.push(x);break;case"</xf>":break;case"<alignment":case"<alignment/>":var _={};E.vertical&&(_.vertical=E.vertical),E.horizontal&&(_.horizontal=E.horizontal),E.textRotation!=null&&(_.textRotation=E.textRotation),E.indent&&(_.indent=E.indent),E.wrapText&&(_.wrapText=hr(E.wrapText)),x.alignment=_;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":y=!0;break;case"</AlternateContent>":y=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":y=!0;break;case"</ext>":y=!1;break;default:if(b&&b.WTF&&!y)throw new Error("unrecognized "+E[0]+" in cellXfs")}}))),j});function Gh(r,d){if(jd!==void 0)return jd.toXml();var u,h,g,b,x=[kr,kt("styleSheet",null,{xmlns:gl[0],"xmlns:vt":Yr.vt})];return r.SSF&&(h=r.SSF,g=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(y){for(var j=y[0];j<=y[1];++j)h[j]!=null&&(g[g.length]=kt("numFmt",null,{numFmtId:j,formatCode:Gs(h[j])}))}),(u=g.length===1?"":(g[g.length]="</numFmts>",g[0]=kt("numFmts",null,{count:g.length-2}).replace("/>",">"),g.join("")))!=null)&&(x[x.length]=u),x[x.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',x[x.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',x[x.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',x[x.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',d=d.cellXfs,(b=[])[b.length]="<cellXfs/>",d.forEach(function(y){b[b.length]=kt("xf",null,y)}),b[b.length]="</cellXfs>",(u=b.length===2?"":(b[0]=kt("cellXfs",null,{count:b.length-2}).replace("/>",">"),b.join("")))&&(x[x.length]=u),x[x.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',x[x.length]='<dxfs count="0"/>',x[x.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<x.length&&(x[x.length]="</styleSheet>",x[1]=x[1].replace("/>",">")),x.join("")}function $m(r,d){var u;(d=d||gt(153)).write_shift(2,20*r.sz),u=r,h=(h=d)||gt(2),u=(u.italic?2:0)|(u.strike?8:0)|(u.outline?16:0)|(u.shadow?32:0)|(u.condense?64:0)|(u.extend?128:0),h.write_shift(1,u),h.write_shift(1,0),d.write_shift(2,r.bold?700:400);var h=0;return r.vertAlign=="superscript"?h=1:r.vertAlign=="subscript"&&(h=2),d.write_shift(2,h),d.write_shift(1,r.underline||0),d.write_shift(1,r.family||0),d.write_shift(1,r.charset||0),d.write_shift(1,0),Bi(r.color,d),h=0,r.scheme=="major"&&(h=1),r.scheme=="minor"&&(h=2),d.write_shift(1,h),da(r.name,d),d.length>d.l?d.slice(0,d.l):d}var Z0,qm=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ym=La;function Gm(r,d){d=d||gt(84),r=(Z0=Z0||$n(qm))[r.patternType],r==null&&(r=40),d.write_shift(4,r);var u=0;if(r!=40)for(Bi({auto:1},d),Bi({auto:1},d);u<12;++u)d.write_shift(4,0);else{for(;u<4;++u)d.write_shift(4,0);for(;u<12;++u)d.write_shift(4,0)}return d.length>d.l?d.slice(0,d.l):d}function Km(r,d,u){return(u=u||gt(16)).write_shift(2,d||0),u.write_shift(2,r.numFmtId||0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u}function fc(r,d){return(d=d||gt(10)).write_shift(1,0),d.write_shift(1,0),d.write_shift(4,0),d.write_shift(4,0),d}ul=La;function Nd(r,d){var u;d&&(u=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g=h[0];g<=h[1];++g)d[g]!=null&&++u}),u!=0&&(yt(r,615,un(u)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g,b,x,y=h[0];y<=h[1];++y)d[y]!=null&&yt(r,44,(g=y,b=d[y],(x=(x=void 0)||gt(6+4*b.length)).write_shift(2,g),da(b,x),b=x.length>x.l?x.slice(0,x.l):x,x.l==null&&(x.l=x.length),b))}),yt(r,616)))}function Kh(r){var d;yt(r,613,un(1)),yt(r,46,((d=d||gt(51)).write_shift(1,0),fc(0,d),fc(0,d),fc(0,d),fc(0,d),fc(0,d),d.length>d.l?d.slice(0,d.l):d)),yt(r,614)}function eu(r){var d,u;yt(r,619,un(1)),yt(r,48,(d={xfId:0,builtinId:0,name:"Normal"},(u=u||gt(52)).write_shift(4,d.xfId),u.write_shift(2,1),u.write_shift(1,+d.builtinId),u.write_shift(1,0),td(d.name||"",u),u.length>u.l?u.slice(0,u.l):u)),yt(r,620)}function Qm(r){var d,u,h,g;yt(r,508,(d=0,u="TableStyleMedium9",h="PivotStyleMedium4",(g=gt(2052)).write_shift(4,d),td(u,g),td(h,g),g.length>g.l?g.slice(0,g.l):g)),yt(r,509)}function Xm(r,d){var u,h=Ra();return yt(h,278),Nd(h,r.SSF),yt(r=h,611,un(1)),yt(r,43,$m({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),yt(r,612),yt(r=h,603,un(2)),yt(r,45,Gm({patternType:"none"})),yt(r,45,Gm({patternType:"gray125"})),yt(r,604),Kh(h),yt(r=h,626,un(1)),yt(r,47,Km({numFmtId:0},65535)),yt(r,627),u=h,d=d.cellXfs,yt(u,617,un(d.length)),d.forEach(function(g){yt(u,47,Km(g,0))}),yt(u,618),eu(h),yt(d=h,505,un(0)),yt(d,506),Qm(h),yt(h,279),h.end()}var kd=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Jm(r,d,u){d.themeElements.clrScheme=[];var h={};(r[0].match(Mr)||[]).forEach(function(g){var b=gs(g);switch(b[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":h.rgb=b.val;break;case"<a:sysClr":h.rgb=b.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":b[0].charAt(1)==="/"?(d.themeElements.clrScheme[kd.indexOf(b[0])]=h,h={}):h.name=b[0].slice(3,b[0].length-1);break;default:if(u&&u.WTF)throw new Error("Unrecognized "+b[0]+" in clrScheme")}})}function Qh(){}function Zm(){}var Xh=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Jh=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eg=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,tg=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Dl(r,d){var u,h,g,b,x,y={};if(!(u=(r=!r||r.length===0?tu():r).match(tg)))throw new Error("themeElements not found in theme");return h=u[0],b=d,(g=y).themeElements={},[["clrScheme",Xh,Jm],["fontScheme",Jh,Qh],["fmtScheme",eg,Zm]].forEach(function(j){if(!(x=h.match(j[1])))throw new Error(j[0]+" not found in themeElements");j[2](x,g,b)}),y.raw=r,y}function tu(r,d){return d&&d.themeXLSX?d.themeXLSX:r&&typeof r.raw=="string"?r.raw:(r=[kr],r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join(""))}function sg(r){var d={};switch(d.xclrType=r.read_shift(2),d.nTintShade=r.read_shift(2),d.xclrType){case 0:r.l+=4;break;case 1:d.xclrValue=La(r,4);break;case 2:d.xclrValue=_0(r);break;case 3:d.xclrValue=r.read_shift(4);break;case 4:r.l+=4}return r.l+=8,d}function rg(r){var d=r.read_shift(2),u=r.read_shift(2)-4,h=[d];switch(d){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:h[1]=sg(r);break;case 6:h[1]=La(r,u);break;case 14:case 15:h[1]=r.read_shift(u==1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+d+" "+u)}return h}function su(){var r,d,u,h=Ra();return yt(h,332),yt(h,334,un(1)),yt(h,335,((u=gt(12+2*(d={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,d.flags),u.write_shift(4,d.version),da(d.name,u),u.slice(0,u.l))),yt(h,336),yt(h,339,(r=1,(u=gt(8+2*(d="XLDAPR").length)).write_shift(4,r),da(d,u),u.slice(0,u.l))),yt(h,52),yt(h,35,un(514)),yt(h,4096,un(0)),yt(h,4097,xn(1)),yt(h,36),yt(h,53),yt(h,340),yt(h,337,(r=1,d=!0,(u=gt(8)).write_shift(4,r),u.write_shift(4,d?1:0),u)),yt(h,51,(function(g){var b=gt(4+8*g.length);b.write_shift(4,g.length);for(var x=0;x<g.length;++x)b.write_shift(4,g[x][0]),b.write_shift(4,g[x][1]);return b})([[1,0]])),yt(h,338),yt(h,333),h.end()}function Zh(){var r=[kr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}var Tl=1024;function ef(r,d){for(var u=[21600,21600],h=["m0,0l0",u[1],u[0],u[1],u[0],"0xe"].join(","),g=[kt("xml",null,{"xmlns:v":Cr.v,"xmlns:o":Cr.o,"xmlns:x":Cr.x,"xmlns:mv":Cr.mv}).replace(/\/>/,">"),kt("o:shapelayout",kt("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),kt("v:shapetype",[kt("v:stroke",null,{joinstyle:"miter"}),kt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:u.join(","),path:h})];Tl<1e3*r;)Tl+=1e3;return d.forEach(function(b){var x=Hr(b[0]),j={color2:"#BEFF82",type:"gradient"};j.type=="gradient"&&(j.angle="-180");var y=j.type=="gradient"?kt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,j=kt("v:fill",y,j);++Tl,g=g.concat(["<v:shape"+ws({id:"_x0000_s"+Tl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(b[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",j,kt("v:shadow",null,{on:"t",obscured:"t"}),kt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_s("x:Anchor",[x.c+1,0,x.r+1,0,x.c+3,20,x.r+5,20].join(",")),_s("x:AutoFill","False"),_s("x:Row",String(x.r)),_s("x:Column",String(x.c)),b[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),g.push("</xml>"),g.join("")}function tf(r,d,u,h){var g,b=Array.isArray(r);d.forEach(function(x){var y,j=Hr(x.ref);(g=b?(r[j.r]||(r[j.r]=[]),r[j.r][j.c]):r[x.ref])||(g={t:"z"},b?r[j.r][j.c]=g:r[x.ref]=g,(y=Ls(r["!ref"]||"BDWGO1000001:A1")).s.r>j.r&&(y.s.r=j.r),y.e.r<j.r&&(y.e.r=j.r),y.s.c>j.c&&(y.s.c=j.c),y.e.c<j.c&&(y.e.c=j.c),(y=Ss(y))!==r["!ref"]&&(r["!ref"]=y)),g.c||(g.c=[]);var k={a:x.author,t:x.t,r:x.r,T:u};x.h&&(k.h=x.h);for(var E=g.c.length-1;0<=E;--E){if(!u&&g.c[E].T)return;u&&!g.c[E].T&&g.c.splice(E,1)}if(u&&h){for(E=0;E<h.length;++E)if(k.a==h[E].id){k.a=h[E].name||k.a;break}}g.c.push(k)})}function ag(r){var d=[kr,kt("comments",null,{xmlns:gl[0]})],u=[];return d.push("<authors>"),r.forEach(function(h){h[1].forEach(function(g){var b=Gs(g.a);u.indexOf(b)==-1&&(u.push(b),d.push("<author>"+b+"</author>")),g.T&&g.ID&&u.indexOf("tc="+g.ID)==-1&&(u.push("tc="+g.ID),d.push("<author>tc="+g.ID+"</author>"))})}),u.length==0&&(u.push("SheetJ5"),d.push("<author>SheetJ5</author>")),d.push("</authors>"),d.push("<commentList>"),r.forEach(function(h){var g=0,b=[];if(h[1][0]&&h[1][0].T&&h[1][0].ID?g=u.indexOf("tc="+h[1][0].ID):h[1].forEach(function(j){j.a&&(g=u.indexOf(Gs(j.a))),b.push(j.t||"")}),d.push('<comment ref="'+h[0]+'" authorId="'+g+'"><text>'),b.length<=1)d.push(_s("t",Gs(b[0]||"")));else{for(var x=`Comment:
    `+b[0]+`
`,y=1;y<b.length;++y)x+=`Reply:
    `+b[y]+`
`;d.push(_s("t",Gs(x)))}d.push("</text></comment>")}),d.push("</commentList>"),2<d.length&&(d[d.length]="</comments>",d[1]=d[1].replace("/>",">")),d.join("")}$r=pa;function sf(r){var d=Ra(),u=[];return yt(d,628),yt(d,630),r.forEach(function(h){h[1].forEach(function(g){-1<u.indexOf(g.a)||(u.push(g.a.slice(0,54)),yt(d,632,da(g.a.slice(0,54))))})}),yt(d,631),yt(d,633),r.forEach(function(h){h[1].forEach(function(g){g.iauthor=u.indexOf(g.a);var b,x={s:Hr(h[0]),e:Hr(h[0])};yt(d,635,(x=[x,g],(b=b??gt(36)).write_shift(4,x[1].iauthor),bl(x[0],b),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b)),g.t&&0<g.t.length&&yt(d,637,$p(g)),yt(d,636),delete g.iauthor})}),yt(d,634),yt(d,629),d.end()}var na="application/vnd.ms-office.vbaProject",ba=["xlsb","xlsm","xlam","biff8","xla"],ru,rf,bo=(rf=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,function(r,d){return ru=d,r.replace(rf,ng)});function ng(r,d,u,h){var g=!1,b=!1;return u.length==0?b=!0:u.charAt(0)=="["&&(b=!0,u=u.slice(1,-1)),h.length==0?g=!0:h.charAt(0)=="["&&(g=!0,h=h.slice(1,-1)),u=0<u.length?0|parseInt(u,10):0,h=0<h.length?0|parseInt(h,10):0,g?h+=ru.c:--h,b?u+=ru.r:--u,d+(g?"":"$")+Tr(h)+(b?"":"$")+Ur(u)}var yo=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,au=function(r,d){return r.replace(yo,function(u,h,g,b,x,y){return b=xl(b)-(g?0:d.c),y=x0(y)-(x?0:d.r),h+"R"+(y==0?"":x?1+y:"["+y+"]")+"C"+(b==0?"":g?1+b:"["+b+"]")})};function Cd(r,d){return r.replace(yo,function(u,h,g,b,x,y){return h+(g=="$"?g+b:Tr(xl(b)+d.c))+(x=="$"?x+y:Ur(x0(y)+d.r))})}function af(r){return r.replace(/_xlfn\./g,"")}function ia(r){r.l+=1}function ri(r,d){return d=r.read_shift(d==1?1:2),[16383&d,d>>14&1,d>>15&1]}function nu(x,d,g){var b=2;if(g){if(2<=g.biff&&g.biff<=5)return nf(x);g.biff==12&&(b=4)}var h=x.read_shift(b),g=x.read_shift(b),b=ri(x,2),x=ri(x,2);return{s:{r:h,c:b[0],cRel:b[1],rRel:b[2]},e:{r:g,c:x[0],cRel:x[1],rRel:x[2]}}}function nf(g){var d=ri(g,2),u=ri(g,2),h=g.read_shift(1),g=g.read_shift(1);return{s:{r:d[0],c:h,cRel:d[1],rRel:d[2]},e:{r:u[0],c:g,cRel:u[1],rRel:u[2]}}}function lf(x,d,b){if(b&&2<=b.biff&&b.biff<=5)return g=ri(h=x,2),h=h.read_shift(1),{r:g[0],c:h,cRel:g[1],rRel:g[2]};var h,g,b=x.read_shift(b&&b.biff==12?4:2),x=ri(x,2);return{r:b,c:x[0],cRel:x[1],rRel:x[2]}}function ig(x,d,b){if(b=b&&b.biff?b.biff:8,2<=b&&b<=5)return(function(T){var j=T.read_shift(2),k=T.read_shift(1),E=(32768&j)>>15,T=(16384&j)>>14;return j&=16383,E==1&&8192<=j&&(j-=16384),T==1&&128<=k&&(k-=256),{r:j,c:k,cRel:T,rRel:E}})(x);var h=x.read_shift(12<=b?4:2),g=x.read_shift(2),b=(16384&g)>>14,x=(32768&g)>>15;if(g&=16383,x==1)for(;524287<h;)h-=1048576;if(b==1)for(;8191<g;)g-=16384;return{r:h,c:g,cRel:b,rRel:x}}function iu(r){var d=1&r[r.l+1];return r.l+=4,[d,1]}function lu(r){return[r.read_shift(1),r.read_shift(1)]}function of(r,d,u){var h=0,g=0;u.biff==12?(h=r.read_shift(4),g=r.read_shift(4)):(g=1+r.read_shift(1),h=1+r.read_shift(2)),2<=u.biff&&u.biff<8&&(--h,--g==0&&(g=256));for(var b=0,x=[];b!=h&&(x[b]=[]);++b)for(var y=0;y!=g;++y)x[b][y]=(function(j,k){var E=[j.read_shift(1)];if(k==12)switch(E[0]){case 2:E[0]=4;break;case 4:E[0]=16;break;case 0:E[0]=1;break;case 1:E[0]=2}switch(E[0]){case 4:E[1]=er(j,1)?"TRUE":"FALSE",k!=12&&(j.l+=7);break;case 37:case 16:E[1]=Qn[j[j.l]],j.l+=k==12?4:8;break;case 0:j.l+=8;break;case 1:E[1]=Ca(j);break;case 2:E[1]=Vi(j,0,{biff:0<k&&k<8?2:k});break;default:throw new Error("Bad SerAr: "+E[0])}return E})(r,u.biff);return x}function mc(r,d,u){return r.l+=2,[(r=(h=r).read_shift(2),h=h.read_shift(2),{r,c:255&h,fQuoted:!!(16384&h),cRel:h>>15,rRel:h>>15})];var h}function Sd(r){return r.l+=6,[]}function Ad(r){return r.l+=2,[xr(r),1&r.read_shift(2)]}var cf=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],df={1:{n:"PtgExp",f:function(r,d,u){return r.l++,u&&u.biff==12?[r.read_shift(4,"i"),0]:[r.read_shift(2),r.read_shift(u&&u.biff==2?1:2)]}},2:{n:"PtgTbl",f:La},3:{n:"PtgAdd",f:ia},4:{n:"PtgSub",f:ia},5:{n:"PtgMul",f:ia},6:{n:"PtgDiv",f:ia},7:{n:"PtgPower",f:ia},8:{n:"PtgConcat",f:ia},9:{n:"PtgLt",f:ia},10:{n:"PtgLe",f:ia},11:{n:"PtgEq",f:ia},12:{n:"PtgGe",f:ia},13:{n:"PtgGt",f:ia},14:{n:"PtgNe",f:ia},15:{n:"PtgIsect",f:ia},16:{n:"PtgUnion",f:ia},17:{n:"PtgRange",f:ia},18:{n:"PtgUplus",f:ia},19:{n:"PtgUminus",f:ia},20:{n:"PtgPercent",f:ia},21:{n:"PtgParen",f:ia},22:{n:"PtgMissArg",f:ia},23:{n:"PtgStr",f:function(r,d,u){return r.l++,Jn(r,0,u)}},26:{n:"PtgSheet",f:function(r,d,u){return r.l+=5,r.l+=2,r.l+=u.biff==2?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(r,d,u){return r.l+=u.biff==2?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(r){return r.l++,Qn[r.read_shift(1)]}},29:{n:"PtgBool",f:function(r){return r.l++,r.read_shift(1)!==0}},30:{n:"PtgInt",f:function(r){return r.l++,r.read_shift(2)}},31:{n:"PtgNum",f:function(r){return r.l++,Ca(r)}},32:{n:"PtgArray",f:function(r,d,u){var h=(96&r[r.l++])>>5;return r.l+=u.biff==2?6:u.biff==12?14:7,[h]}},33:{n:"PtgFunc",f:function(r,d,u){var h=(96&r[r.l])>>5;return r.l+=1,u=r.read_shift(u&&u.biff<=3?1:2),[dg[u],hf[u],h]}},34:{n:"PtgFuncVar",f:function(r,d,u){var h=r[r.l++],g=r.read_shift(1),b=u&&u.biff<=3?[h==88?-1:0,r.read_shift(1)]:[(b=r)[b.l+1]>>7,32767&b.read_shift(2)];return[g,(b[0]===0?hf:_l)[b[1]]]}},35:{n:"PtgName",f:function(r,d,u){var h=r.read_shift(1)>>>5&3,g=!u||8<=u.biff?4:2,g=r.read_shift(g);switch(u.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12}return[h,0,g]}},36:{n:"PtgRef",f:function(r,d,u){var h=(96&r[r.l])>>5;return r.l+=1,[h,lf(r,0,u)]}},37:{n:"PtgArea",f:function(r,d,u){return[(96&r[r.l++])>>5,nu(r,2<=u.biff&&u.biff,u)]}},38:{n:"PtgMemArea",f:function(r,d,u){var h=r.read_shift(1)>>>5&3;return r.l+=u&&u.biff==2?3:4,[h,r.read_shift(u&&u.biff==2?1:2)]}},39:{n:"PtgMemErr",f:La},40:{n:"PtgMemNoMem",f:La},41:{n:"PtgMemFunc",f:function(r,d,u){return[r.read_shift(1)>>>5&3,r.read_shift(u&&u.biff==2?1:2)]}},42:{n:"PtgRefErr",f:function(r,d,u){var h=r.read_shift(1)>>>5&3;return r.l+=4,u.biff<8&&r.l--,u.biff==12&&(r.l+=2),[h]}},43:{n:"PtgAreaErr",f:function(r,d,u){var h=(96&r[r.l++])>>5;return r.l+=u&&8<u.biff?12:u.biff<8?6:8,[h]}},44:{n:"PtgRefN",f:function(r,d,u){var h=(96&r[r.l])>>5;return r.l+=1,[h,ig(r,0,u)]}},45:{n:"PtgAreaN",f:function(r,d,u){return[(96&r[r.l++])>>5,(function(j,y){if(y.biff<8)return nf(j);var b=j.read_shift(y.biff==12?4:2),x=j.read_shift(y.biff==12?4:2),y=ri(j,2),j=ri(j,2);return{s:{r:b,c:y[0],cRel:y[1],rRel:y[2]},e:{r:x,c:j[0],cRel:j[1],rRel:j[2]}}})(r,u)]}},46:{n:"PtgMemAreaN",f:function(r){return[r.read_shift(1)>>>5&3,r.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(r){return[r.read_shift(1)>>>5&3,r.read_shift(2)]}},57:{n:"PtgNameX",f:function(r,d,u){return u.biff==5?(function(h){var g=h.read_shift(1)>>>5&3,b=h.read_shift(2,"i");h.l+=8;var x=h.read_shift(2);return h.l+=12,[g,b,x]})(r):[r.read_shift(1)>>>5&3,r.read_shift(2),r.read_shift(4)]}},58:{n:"PtgRef3d",f:function(r,d,u){var h=(96&r[r.l])>>5;r.l+=1;var g=r.read_shift(2);return u&&u.biff==5&&(r.l+=12),[h,g,lf(r,0,u)]}},59:{n:"PtgArea3d",f:function(r,d,u){var h=(96&r[r.l++])>>5,g=r.read_shift(2,"i");return u&&u.biff===5&&(r.l+=12),[h,g,nu(r,0,u)]}},60:{n:"PtgRefErr3d",f:function(r,d,u){var h=(96&r[r.l++])>>5,g=r.read_shift(2),b=4;if(u)switch(u.biff){case 5:b=15;break;case 12:b=6}return r.l+=b,[h,g]}},61:{n:"PtgAreaErr3d",f:function(r,d,u){var h=(96&r[r.l++])>>5,g=r.read_shift(2),b=8;if(u)switch(u.biff){case 5:r.l+=12,b=6;break;case 12:b=12}return r.l+=b,[h,g]}},255:{}},uf={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lg={1:{n:"PtgElfLel",f:Ad},2:{n:"PtgElfRw",f:mc},3:{n:"PtgElfCol",f:mc},6:{n:"PtgElfRwV",f:mc},7:{n:"PtgElfColV",f:mc},10:{n:"PtgElfRadical",f:mc},11:{n:"PtgElfRadicalS",f:Sd},13:{n:"PtgElfColS",f:Sd},15:{n:"PtgElfColSV",f:Sd},16:{n:"PtgElfRadicalLel",f:Ad},25:{n:"PtgList",f:function(b){b.l+=2;var d=b.read_shift(2),u=b.read_shift(2),h=b.read_shift(4),g=b.read_shift(2),b=b.read_shift(2);return{ixti:d,coltype:3&u,rt:cf[u>>2&31],idx:h,c:g,C:b}}},29:{n:"PtgSxName",f:function(r){return r.l+=2,[r.read_shift(4)]}},255:{}},Xi={0:{n:"PtgAttrNoop",f:function(r){return r.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(r,d,u){var h=255&r[r.l+1]?1:0;return r.l+=u&&u.biff==2?3:4,[h]}},2:{n:"PtgAttrIf",f:function(r,d,u){var h=255&r[r.l+1]?1:0;return r.l+=2,[h,r.read_shift(u&&u.biff==2?1:2)]}},4:{n:"PtgAttrChoose",f:function(r,d,u){r.l+=2;for(var h=r.read_shift(u&&u.biff==2?1:2),g=[],b=0;b<=h;++b)g.push(r.read_shift(u&&u.biff==2?1:2));return g}},8:{n:"PtgAttrGoto",f:function(r,d,u){var h=255&r[r.l+1]?1:0;return r.l+=2,[h,r.read_shift(u&&u.biff==2?1:2)]}},16:{n:"PtgAttrSum",f:function(r,d,u){r.l+=u&&u.biff==2?3:4}},32:{n:"PtgAttrBaxcel",f:iu},33:{n:"PtgAttrBaxcel",f:iu},64:{n:"PtgAttrSpace",f:function(r){return r.read_shift(2),lu(r)}},65:{n:"PtgAttrSpaceSemi",f:function(r){return r.read_shift(2),lu(r)}},128:{n:"PtgAttrIfError",f:function(r){var d=255&r[r.l+1]?1:0;return r.l+=2,[d,r.read_shift(2)]}},255:{}};function vo(r,d,u,h){if(h.biff<8)return La(r,d);for(var g=r.l+d,b=[],x=0;x!==u.length;++x)switch(u[x][0]){case"PtgArray":u[x][1]=of(r,0,h),b.push(u[x][1]);break;case"PtgMemArea":u[x][2]=(function(y,j){for(var k=y.read_shift(j.biff==12?4:2),E=[],T=0;T!=k;++T)E.push((j.biff==12?Kn:ra)(y));return E})(r,(u[x][1],h)),b.push(u[x][2]);break;case"PtgExp":h&&h.biff==12&&(u[x][1][1]=r.read_shift(4),b.push(u[x][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+u[x][0]}return(d=g-r.l)!==0&&b.push(La(r,d)),b}function Ed(r,d,u){for(var h,g,b=r.l+d,x=[];b!=r.l;)d=b-r.l,g=r[r.l],h=df[g]||df[uf[g]],(h=g===24||g===25?(g===24?lg:Xi)[r[r.l+1]]:h)&&h.f?x.push([h.n,h.f(r,d,u)]):La(r,d);return x}var og={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ji(r,d,u){if(!r)return"SH33TJSERR0";if(8<u.biff&&(!r.XTI||!r.XTI[d]))return r.SheetNames[d];if(!r.XTI)return"SH33TJSERR6";var h=r.XTI[d];if(u.biff<8)return 1e4<d&&(d-=65536),(d=d<0?-d:d)==0?"":r.XTI[d-1];if(!h)return"SH33TJSERR1";var g="";if(8<u.biff)switch(r[h[0]][0]){case 357:return g=h[1]==-1?"#REF":r.SheetNames[h[1]],h[1]==h[2]?g:g+":"+r.SheetNames[h[2]];case 358:return u.SID!=null?r.SheetNames[u.SID]:"SH33TJSSAME"+r[h[0]][0];default:return"SH33TJSSRC"+r[h[0]][0]}switch(r[h[0]][0][0]){case 1025:return g=h[1]==-1?"#REF":r.SheetNames[h[1]]||"SH33TJSERR3",h[1]==h[2]?g:g+":"+r.SheetNames[h[2]];case 14849:return r[h[0]].slice(1).map(function(b){return b.Name}).join(";;");default:return r[h[0]][0][3]?(g=h[1]==-1?"#REF":r[h[0]][0][3][h[1]]||"SH33TJSERR4",h[1]==h[2]?g:g+":"+r[h[0]][0][3][h[2]]):"SH33TJSERR2"}}function ou(r,d,u){return d=ji(r,d,u),d=="#REF"?d:(function(h,g){if(!(h||g&&g.biff<=5&&2<=g.biff))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(h)?"'"+h+"'":h})(d,u)}function Ia(r,d,u,h,g){var b,x,y,j=g&&g.biff||8,k={s:{c:0,r:0}},E=[],T=0,_=0,R="";if(!r[0]||!r[0][0])return"";for(var q=-1,I="",J=0,Y=r[0].length;J<Y;++J){var z=r[0][J];switch(z[0]){case"PtgUminus":E.push("-"+E.pop());break;case"PtgUplus":E.push("+"+E.pop());break;case"PtgPercent":E.push(E.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(Vt=E.pop(),b=E.pop(),0<=q){switch(r[0][q][1][0]){case 0:I=jr(" ",r[0][q][1][1]);break;case 1:I=jr("\r",r[0][q][1][1]);break;default:if(I="",g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][q][1][0])}b+=I,q=-1}E.push(b+og[z[0]]+Vt);break;case"PtgIsect":Vt=E.pop(),b=E.pop(),E.push(b+" "+Vt);break;case"PtgUnion":Vt=E.pop(),b=E.pop(),E.push(b+","+Vt);break;case"PtgRange":Vt=E.pop(),b=E.pop(),E.push(b+":"+Vt);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":x=Zc(z[1][1],k,g),E.push(Ko(x,j));break;case"PtgRefN":x=u?Zc(z[1][1],u,g):z[1][1],E.push(Ko(x,j));break;case"PtgRef3d":T=z[1][1],x=Zc(z[1][2],k,g),R=ou(h,T,g),E.push(R+"!"+Ko(x,j));break;case"PtgFunc":case"PtgFuncVar":var ie=z[1][0],X=z[1][1],ie=ie||0,le=(ie&=127)==0?[]:E.slice(-ie);E.length-=ie,X==="User"&&(X=le.shift()),E.push(X+"("+le.join(",")+")");break;case"PtgBool":E.push(z[1]?"TRUE":"FALSE");break;case"PtgInt":E.push(z[1]);break;case"PtgNum":E.push(String(z[1]));break;case"PtgStr":E.push('"'+z[1].replace(/"/g,'""')+'"');break;case"PtgErr":E.push(z[1]);break;case"PtgAreaN":y=hh(z[1][1],u?{s:u}:k,g),E.push(p0(y,g));break;case"PtgArea":y=hh(z[1][1],k,g),E.push(p0(y,g));break;case"PtgArea3d":T=z[1][1],y=z[1][2],R=ou(h,T,g),E.push(R+"!"+p0(y,g));break;case"PtgAttrSum":E.push("SUM("+E.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=z[1][2];var Ae=(h.names||[])[_-1]||(h[0]||[])[_],Ve=Ae?Ae.Name:"SH33TJSNAME"+String(_);Ve&&Ve.slice(0,6)=="_xlfn."&&!g.xlfn&&(Ve=Ve.slice(6)),E.push(Ve);break;case"PtgNameX":var Oe,Je=z[1][1],_=z[1][2];if(!(g.biff<=5)){Ae="",((h[Je]||[])[0]||[])[0]==14849||(((h[Je]||[])[0]||[])[0]==1025?h[Je][_]&&0<h[Je][_].itab&&(Ae=h.SheetNames[h[Je][_].itab-1]+"!"):Ae=h.SheetNames[_-1]+"!"),h[Je]&&h[Je][_]?Ae+=h[Je][_].Name:h[0]&&h[0][_]?Ae+=h[0][_].Name:(Ve=(ji(h,Je,g)||"").split(";;"))[_-1]?Ae=Ve[_-1]:Ae+="SH33TJSERRX",E.push(Ae);break}Oe=(Oe=h[Je=Je<0?-Je:Je]?h[Je][_]:Oe)||{Name:"SH33TJSERRY"},E.push(Oe.Name);break;case"PtgParen":var pt="(",xt=")";if(0<=q){switch(I="",r[0][q][1][0]){case 2:pt=jr(" ",r[0][q][1][1])+pt;break;case 3:pt=jr("\r",r[0][q][1][1])+pt;break;case 4:xt=jr(" ",r[0][q][1][1])+xt;break;case 5:xt=jr("\r",r[0][q][1][1])+xt;break;default:if(g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][q][1][0])}q=-1}E.push(pt+E.pop()+xt);break;case"PtgRefErr":case"PtgRefErr3d":E.push("#REF!");break;case"PtgExp":x={c:z[1][1],r:z[1][0]};var at={c:u.c,r:u.r};if(h.sharedf[vs(x)])Je=h.sharedf[vs(x)],E.push(Ia(Je,0,at,h,g));else{for(var Ct=!1,Vt=0;Vt!=h.arrayf.length;++Vt)if(b=h.arrayf[Vt],!(x.c<b[0].s.c||x.c>b[0].e.c||x.r<b[0].s.r||x.r>b[0].e.r)){E.push(Ia(b[1],0,at,h,g)),Ct=!0;break}Ct||E.push(z[1])}break;case"PtgArray":E.push("{"+(function(Mt){for(var Dt=[],wt=0;wt<Mt.length;++wt){for(var Yt=Mt[wt],Jt=[],is=0;is<Yt.length;++is){var Fs=Yt[is];Fs?Fs[0]===2?Jt.push('"'+Fs[1].replace(/"/g,'""')+'"'):Jt.push(Fs[1]):Jt.push("")}Dt.push(Jt.join(","))}return Dt.join(";")})(z[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":q=J;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":E.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":E.push("#REF!");break;case"PtgList":E.push("Table"+z[1].idx+"[#"+z[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(z))}if(g.biff!=3&&0<=q&&["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(r[0][J][0])==-1){var Ut=!0;switch((z=r[0][q])[1][0]){case 4:Ut=!1;case 0:I=jr(" ",z[1][1]);break;case 5:Ut=!1;case 1:I=jr("\r",z[1][1]);break;default:if(I="",g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+z[1][0])}E.push((Ut?I:"")+E.pop()+(Ut?"":I)),q=-1}}if(1<E.length&&g.WTF)throw new Error("bad formula stack");return E[0]}function gc(r,x,u){var h=r.l+x,g=Ha(r);u.biff==2&&++r.l;var b=(function(y){var j;if(Pi(y,y.l+6)!==65535)return[Ca(y),"n"];switch(y[y.l]){case 0:return y.l+=8,["String","s"];case 1:return j=y[y.l+2]===1,y.l+=8,[j,"b"];case 2:return j=y[y.l+2],y.l+=8,[j,"e"];case 3:return y.l+=8,["","s"]}return[]})(r),x=r.read_shift(1);return u.biff!=2&&(r.read_shift(1),5<=u.biff&&r.read_shift(4)),u=(function(y,j,k){var E,T=y.l+j,_=k.biff==2?1:2,R=y.read_shift(_);if(R==65535)return[[],La(y,j-2)];var q=Ed(y,R,k);return j!==R+_&&(E=vo(y,j-R-_,q,k)),y.l=T,[q,E]})(r,h-r.l,u),{cell:g,val:b[0],formula:u,shared:x>>3&1,tt:b[1]}}function Dd(r,d,u,h,g){d=vi(d,u,g),g=(u=r.v)!=null?Dn(typeof u=="number"?u:0):((u=gt(8)).write_shift(1,3),u.write_shift(1,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,65535),u),u=gt(6),u.write_shift(2,33),u.write_shift(4,0);for(var b=gt(r.bf.length),x=0;x<r.bf.length;++x)b[x]=r.bf[x];return he([d,g,u,b])}function fr(r,d,u){var g=r.read_shift(4),h=Ed(r,g,u),g=r.read_shift(4);return[h,0<g?vo(r,g,h,u):null]}var Kp=fr,cu=fr,cg=fr,Td=fr,_l={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},hf={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dg={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function pc(r){return(r=(r=(r=(r=(r=r.slice(0,3)=="of:"?r.slice(3):r).charCodeAt(0)==61&&(r=r.slice(1)).charCodeAt(0)==61?r.slice(1):r).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(d,u){return u.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Mn(r){return r=r.split(":"),[r[0].split(".")[0],r[0].split(".")[1]+(1<r.length?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var xc={},Fl={},bc=typeof Map<"u";function _d(r,d,u){var h=0,g=r.length;if(u){if(bc?u.has(d):Object.prototype.hasOwnProperty.call(u,d)){for(var b=bc?u.get(d):u[d];h<b.length;++h)if(r[b[h]].t===d)return r.Count++,b[h]}}else for(;h<g;++h)if(r[h].t===d)return r.Count++,h;return r[g]={t:d},r.Count++,r.Unique++,u&&(bc?(u.has(d)||u.set(d,[]),u.get(d).push(g)):(Object.prototype.hasOwnProperty.call(u,d)||(u[d]=[]),u[d].push(g))),g}function yc(h,d){var u={min:h+1,max:h+1},h=-1;return d.MDW&&(Zr=d.MDW),d.width!=null?u.customWidth=1:d.wpx!=null?h=Al(d.wpx):d.wch!=null&&(h=d.wch),-1<h?(u.width=po(h),u.customWidth=1):d.width!=null&&(u.width=d.width),d.hidden&&(u.hidden=!0),d.level!=null&&(u.outlineLevel=u.level=d.level),u}function Ni(r,d){r&&(d=d=="xlml"?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],r.left==null&&(r.left=d[0]),r.right==null&&(r.right=d[1]),r.top==null&&(r.top=d[2]),r.bottom==null&&(r.bottom=d[3]),r.header==null&&(r.header=d[4]),r.footer==null&&(r.footer=d[5]))}function Ji(r,d,u){if(jd!==void 0){if(/^\d+$/.exec(d.s)||d.s&&d.s==+d.s)return d.s;var h=d.s||{};return d.z&&(h.numFmt=d.z),jd.addStyle(h)}var g=u.revssf[d.z!=null?d.z:"General"],b=60,x=r.length;if(g==null&&u.ssf){for(;b<392;++b)if(u.ssf[b]==null){Br(d.z,b),u.ssf[b]=d.z,u.revssf[d.z]=g=b;break}}for(b=0;b!=x;++b)if(r[b].numFmtId===g)return b;return r[x]={numFmtId:g,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},x}function ki(r,d,u,h,g,b){try{h.cellNF&&(r.z=V[d])}catch(y){if(h.WTF)throw y}if(r.t!=="z"||h.cellStyles){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Ts(r.v)),(!h||h.cellText!==!1)&&r.t!=="z")try{if(V[d]==null&&Br(zo[d]||"General",d),r.t==="e")r.w=r.w||Qn[r.v];else if(d===0)if(r.t==="n")(0|r.v)===r.v?r.w=r.v.toString(10):r.w=vt(r.v);else if(r.t==="d"){var x=Dr(r.v);r.w=(0|x)===x?x.toString(10):vt(x)}else{if(r.v===void 0)return;r.w=Pe(r.v,Fl)}else r.t==="d"?r.w=Er(d,Dr(r.v),Fl):r.w=Er(d,r.v,Fl)}catch(y){if(h.WTF)throw y}if(h.cellStyles&&u!=null)try{r.s=b.Fills[u],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=yd(g.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),h.WTF&&(r.s.fgColor.raw_rgb=g.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=yd(g.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),h.WTF&&(r.s.bgColor.raw_rgb=g.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(y){if(h.WTF&&b.Fills)throw y}}}var la=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,ff=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,ug=/<(?:\w:)?hyperlink [^>]*>/gm,ya=/"(\w*:\w*)"/,Qp=/<(?:\w:)?col\b[^>]*[\/]?>/g,hg=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,fg=/<(?:\w:)?pageMargins[^>]*\/>/g,_r=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Qa=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Zi=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function mg(r,d,u,h,g,b,x){if(!r)return r;h=h||{"!id":{}};var y=d.dense?[]:{},j={s:{r:2e6,c:2e6},e:{r:0,c:0}},k="",Ve="",E=r.match(ff);E?(k=r.slice(0,E.index),Ve=r.slice(E.index+E[0].length)):k=Ve=r;var T=k.match(_r);T?du(T[0],0,g,u):(T=k.match(Qa))&&(r=T[0],T[1],T=y,_=g,R=u,du(r.slice(0,r.indexOf(">")),0,_,R));var _,R,q=(k.match(/<(?:\w*:)?dimension/)||{index:-1}).index;0<q&&(_=k.slice(q,q+50).match(ya))&&(R=y,(J=Ls(J=_[1])).s.r<=J.e.r&&J.s.c<=J.e.c&&0<=J.s.r&&0<=J.s.c&&(R["!ref"]=Ss(J)));var I,J=k.match(Zi);J&&J[1]&&(z=J[1],(I=g).Views||(I.Views=[{}]),(z.match(uu)||[]).forEach(function(Oe,Je){Oe=gs(Oe),I.Views[Je]||(I.Views[Je]={}),+Oe.zoomScale&&(I.Views[Je].zoom=+Oe.zoomScale),hr(Oe.rightToLeft)&&(I.Views[Je].RTL=!0)}));var Y,z=[];d.cellStyles&&(Y=k.match(Qp))&&(function(Oe,Je){for(var pt=!1,xt=0;xt!=Je.length;++xt){var at=gs(Je[xt],!0);at.hidden&&(at.hidden=hr(at.hidden));var Ct=parseInt(at.min,10)-1,Vt=parseInt(at.max,10)-1;for(at.outlineLevel&&(at.level=+at.outlineLevel||0),delete at.min,delete at.max,at.width=+at.width,!pt&&at.width&&(pt=!0,vd(at.width)),El(at);Ct<=Vt;)Oe[Ct++]=Ys(at)}})(z,Y),E&&el(E[1],y,d,j,b,x),x=Ve.match(hg),x&&(y["!autofilter"]={ref:(x[0].match(/ref="([^"]*)"/)||[])[1]});var X=[],ie=Ve.match(la);if(ie)for(q=0;q!=ie.length;++q)X[q]=Ls(ie[q].slice(ie[q].indexOf('"')+1));x=Ve.match(ug),x&&(function(Oe,Je,pt){for(var xt=Array.isArray(Oe),at=0;at!=Je.length;++at){var Ct=gs(qe(Je[at]),!0);if(!Ct.ref)return;var Vt=((pt||{})["!id"]||[])[Ct.id];Vt?(Ct.Target=Vt.Target,Ct.location&&(Ct.Target+="#"+ys(Ct.location))):(Ct.Target="#"+ys(Ct.location),Vt={Target:Ct.Target,TargetMode:"Internal"}),Ct.Rel=Vt,Ct.tooltip&&(Ct.Tooltip=Ct.tooltip,delete Ct.tooltip);for(var Ut=Ls(Ct.ref),Ft=Ut.s.r;Ft<=Ut.e.r;++Ft)for(var Mt=Ut.s.c;Mt<=Ut.e.c;++Mt){var Dt=vs({c:Mt,r:Ft});xt?(Oe[Ft]||(Oe[Ft]=[]),Oe[Ft][Mt]||(Oe[Ft][Mt]={t:"z",v:void 0}),Oe[Ft][Mt].l=Ct):(Oe[Dt]||(Oe[Dt]={t:"z",v:void 0}),Oe[Dt].l=Ct)}}})(y,x,h);var le,Ae,Ve=Ve.match(fg);return Ve&&(y["!margins"]=(le=gs(Ve[0]),Ae={},["left","right","top","bottom","header","footer"].forEach(function(Oe){le[Oe]&&(Ae[Oe]=parseFloat(le[Oe]))}),Ae)),!y["!ref"]&&j.e.c>=j.s.c&&j.e.r>=j.s.r&&(y["!ref"]=Ss(j)),0<d.sheetRows&&y["!ref"]&&(Ve=Ls(y["!ref"]),d.sheetRows<=+Ve.e.r&&(Ve.e.r=d.sheetRows-1,Ve.e.r>j.e.r&&(Ve.e.r=j.e.r),Ve.e.r<Ve.s.r&&(Ve.s.r=Ve.e.r),Ve.e.c>j.e.c&&(Ve.e.c=j.e.c),Ve.e.c<Ve.s.c&&(Ve.s.c=Ve.e.c),y["!fullref"]=y["!ref"],y["!ref"]=Ss(Ve))),0<z.length&&(y["!cols"]=z),0<X.length&&(y["!merges"]=X),y}function du(r,d,u,h){r=gs(r),u.Sheets[h]||(u.Sheets[h]={}),r.codeName&&(u.Sheets[h].CodeName=ys(qe(r.codeName)))}var gg=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Xp=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],uu=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,Wa,Ln,mf,$a,gf,Ci,Ml,el=(Wa=/<(?:\w+:)?c[ \/>]/,Ln=/<\/(?:\w+:)?row>/,mf=/r=["']([^"']*)["']/,$a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,gf=/ref=["']([^"']*)["']/,Ci=Be("v"),Ml=Be("f"),function(r,d,u,h,g,b){for(var x,y,j,k,E,T,_=0,R="",q=[],I=[],J=0,Y=0,z="",X=0,ie=0,le=0,Ae=0,Ve=Array.isArray(b.CellXf),Oe=[],Je=[],pt=Array.isArray(d),xt=[],at={},Ct=!1,Vt=!!u.sheetStubs,Ut=r.split(Ln),Ft=0,Mt=Ut.length;Ft!=Mt;++Ft){var Dt=(R=Ut[Ft].trim()).length;if(Dt!==0){var wt=0;e:for(_=0;_<Dt;++_)switch(R[_]){case">":if(R[_-1]!="/"){++_;break e}if(u&&u.cellStyles){if(X=(j=gs(R.slice(wt,_),!0)).r!=null?parseInt(j.r,10):X+1,ie=-1,u.sheetRows&&u.sheetRows<X)continue;Ct=!(at={}),j.ht&&(Ct=!0,at.hpt=parseFloat(j.ht),at.hpx=xo(at.hpt)),j.hidden=="1"&&(Ct=!0,at.hidden=!0),j.outlineLevel!=null&&(Ct=!0,at.level=+j.outlineLevel),Ct&&(xt[X-1]=at)}break;case"<":wt=_}if(_<=wt)break;if(X=(j=gs(R.slice(wt,_),!0)).r!=null?parseInt(j.r,10):X+1,ie=-1,!(u.sheetRows&&u.sheetRows<X)){h.s.r>X-1&&(h.s.r=X-1),h.e.r<X-1&&(h.e.r=X-1),u&&u.cellStyles&&(Ct=!(at={}),j.ht&&(Ct=!0,at.hpt=parseFloat(j.ht),at.hpx=xo(at.hpt)),j.hidden=="1"&&(Ct=!0,at.hidden=!0),j.outlineLevel!=null&&(Ct=!0,at.level=+j.outlineLevel),Ct&&(xt[X-1]=at)),q=R.slice(_).split(Wa);for(var Yt,Jt=0;Jt!=q.length&&q[Jt].trim().charAt(0)=="<";++Jt);for(q=q.slice(Jt),_=0;_!=q.length;++_)if((R=q[_].trim()).length!==0){if(I=R.match(mf),J=_,Y=0,R="<c "+(R.slice(0,1)=="<"?">":"")+R,I!=null&&I.length===2){for(J=0,z=I[1],Y=0;Y!=z.length&&!((x=z.charCodeAt(Y)-64)<1||26<x);++Y)J=26*J+x;ie=--J}else++ie;for(Y=0;Y!=R.length&&R.charCodeAt(Y)!==62;++Y);if(++Y,(j=gs(R.slice(0,Y),!0)).r||(j.r=vs({r:X-1,c:ie})),y={t:""},(I=(z=R.slice(Y)).match(Ci))!=null&&I[1]!==""&&(y.v=ys(I[1])),u.cellFormula){(I=z.match(Ml))!=null&&I[1]!==""?(y.f=ys(qe(I[1])).replace(/\r\n/g,`
`),u.xlfn||(y.f=af(y.f)),-1<I[0].indexOf('t="array"')?(y.F=(z.match(gf)||[])[1],-1<y.F.indexOf(":")&&Oe.push([Ls(y.F),y.F])):-1<I[0].indexOf('t="shared"')&&(E=gs(I[0]),Yt=ys(qe(I[1])),u.xlfn||(Yt=af(Yt)),Je[parseInt(E.si,10)]=[E,Yt,j.r])):(I=z.match(/<f[^>]*\/>/))&&Je[(E=gs(I[0])).si]&&(y.f=(T=Je[E.si][1],Wt=Je[E.si][2],Yt=j.r,Wt=Oa(Wt).s,Yt=Hr(Yt),Cd(T,{r:Yt.r-Wt.r,c:Yt.c-Wt.c})));for(var is=Hr(j.r),Y=0;Y<Oe.length;++Y)is.r>=Oe[Y][0].s.r&&is.r<=Oe[Y][0].e.r&&is.c>=Oe[Y][0].s.c&&is.c<=Oe[Y][0].e.c&&(y.F=Oe[Y][1])}if(j.t==null&&y.v===void 0)if(y.f||y.F)y.v=0,y.t="n";else{if(!Vt)continue;y.t="z"}else y.t=j.t||"n";switch(h.s.c>ie&&(h.s.c=ie),h.e.c<ie&&(h.e.c=ie),y.t){case"n":if(y.v==""||y.v==null){if(!Vt)continue;y.t="z"}else y.v=parseFloat(y.v);break;case"s":if(y.v===void 0){if(!Vt)continue;y.t="z"}else k=xc[parseInt(y.v,10)],y.v=k.t,y.r=k.r,u.cellHTML&&(y.h=k.h);break;case"str":y.t="s",y.v=y.v!=null?qe(y.v):"",u.cellHTML&&(y.h=Vo(y.v));break;case"inlineStr":I=z.match($a),y.t="s",I!=null&&(k=md(I[1]))?(y.v=k.t,u.cellHTML&&(y.h=k.h)):y.v="";break;case"b":y.v=hr(y.v);break;case"d":u.cellDates?y.v=Ts(y.v,1):(y.v=Dr(Ts(y.v,1)),y.t="n");break;case"e":u&&u.cellText===!1||(y.w=y.v),y.v=Tn[y.v]}var Fs,le=Ae=0,Wt=null;Ve&&j.s!==void 0&&(Wt=b.CellXf[j.s])!=null&&(Wt.numFmtId!=null&&(le=Wt.numFmtId),u.cellStyles&&Wt.fillId!=null&&(Ae=Wt.fillId)),ki(y,le,Ae,u,g,b),u.cellDates&&Ve&&y.t=="n"&&rr(V[le])&&(y.t="d",y.v=Li(y.v)),j.cm&&u.xlmeta&&(Fs=(u.xlmeta.Cell||[])[+j.cm-1])&&Fs.type=="XLDAPR"&&(y.D=!0),pt?(d[(Fs=Hr(j.r)).r]||(d[Fs.r]=[]),d[Fs.r][Fs.c]=y):d[j.r]=y}}}}0<xt.length&&(d["!rows"]=xt)});function pf(r,d){for(var u,h,g,b,x=[],y=[],j=Ls(r["!ref"]),k=[],E=0,I=0,T=r["!rows"],_=Array.isArray(r),R={r:""},q=-1,I=j.s.c;I<=j.e.c;++I)k[I]=Tr(I);for(E=j.s.r;E<=j.e.r;++E){for(y=[],g=Ur(E),I=j.s.c;I<=j.e.c;++I){h=k[I]+g;var J=_?(r[E]||[])[I]:r[h];J!==void 0&&(u=(function(Y,z,X,ie){if(Y.c&&X["!comments"].push([z,Y.c]),Y.v===void 0&&typeof Y.f!="string"||Y.t==="z"&&!Y.f)return"";var le="",Ae=Y.t,Ve=Y.v;if(Y.t!=="z")switch(Y.t){case"b":le=Y.v?"1":"0";break;case"n":le=""+Y.v;break;case"e":le=Qn[Y.v];break;case"d":le=ie&&ie.cellDates?Ts(Y.v,-1).toISOString():((Y=Ys(Y)).t="n",""+(Y.v=Dr(Ts(Y.v)))),Y.z===void 0&&(Y.z=V[14]);break;default:le=Y.v}var Oe=_s("v",Gs(le)),Je={r:z},pt=Ji(ie.cellXfs,Y,ie);switch(pt!==0&&(Je.s=pt),Y.t){case"n":break;case"d":Je.t="d";break;case"b":Je.t="b";break;case"e":Je.t="e";break;case"z":break;default:if(Y.v==null){delete Y.t;break}if(32767<Y.v.length)throw new Error("Text length must not exceed 32767 characters");if(ie&&ie.bookSST){Oe=_s("v",""+_d(ie.Strings,Y.v,ie.revStrings)),Je.t="s";break}Je.t="str"}return Y.t!=Ae&&(Y.t=Ae,Y.v=Ve),typeof Y.f=="string"&&Y.f&&(Ve=Y.F&&Y.F.slice(0,z.length)==z?{t:"array",ref:Y.F}:null,Oe=kt("f",Gs(Y.f),Ve)+(Y.v!=null?Oe:"")),Y.l&&X["!links"].push([z,Y.l]),Y.D&&(Je.cm=1),kt("c",Oe,Je)})(J,h,r,d))!=null&&y.push(u)}(0<y.length||T&&T[E])&&(R={r:g},T&&T[E]&&((b=T[E]).hidden&&(R.hidden=1),q=-1,b.hpx?q=uc(b.hpx):b.hpt&&(q=b.hpt),-1<q&&(R.ht=q,R.customHeight=1),b.level&&(R.outlineLevel=b.level)),x[x.length]=kt("row",y.join(""),R))}if(T)for(;E<T.length;++E)T&&T[E]&&(R={r:E+1},(b=T[E]).hidden&&(R.hidden=1),q=-1,b.hpx?q=uc(b.hpx):b.hpt&&(q=b.hpt),-1<q&&(R.ht=q,R.customHeight=1),b.level&&(R.outlineLevel=b.level),x[x.length]=kt("row","",R));return x.join("")}function hu(r,d,u,h){var g,b,x=[kr,kt("worksheet",null,{xmlns:gl[0],"xmlns:r":Yr.r})],y=u.SheetNames[r],j=u.Sheets[y],k=(j=j??{})["!ref"]||"A1",E=Ls(k);if(16383<E.e.c||1048575<E.e.r){if(d.WTF)throw new Error("Range "+k+" exceeds format limit A1:XFD1048576");E.e.c=Math.min(E.e.c,16383),E.e.r=Math.min(E.e.c,1048575),k=Ss(E)}h=h||{},j["!comments"]=[];var T,_,R=[];(function(Y,z,X,ie,le){var Ae=!1,Ve={},Oe=null;if(ie.bookType!=="xlsx"&&z.vbaraw){var Je=z.SheetNames[X];try{z.Workbook&&(Je=z.Workbook.Sheets[X].CodeName||Je)}catch{}Ae=!0,Ve.codeName=Ke(Gs(Je))}Y&&Y["!outline"]&&(ie={summaryBelow:1,summaryRight:1},Y["!outline"].above&&(ie.summaryBelow=0),Y["!outline"].left&&(ie.summaryRight=0),Oe=(Oe||"")+kt("outlinePr",null,ie)),(Ae||Oe)&&(le[le.length]=kt("sheetPr",Oe,Ve))})(j,u,r,d,x),x[x.length]=kt("dimension",null,{ref:k}),x[x.length]=(y={workbookViewId:"0"},((((E=u)||{}).Workbook||{}).Views||[])[0]&&(y.rightToLeft=E.Workbook.Views[0].RTL?"1":"0"),kt("sheetViews",kt("sheetView",null,y),{})),d.sheetFormat&&(x[x.length]=kt("sheetFormatPr",null,{defaultRowHeight:d.sheetFormat.defaultRowHeight||"16",baseColWidth:d.sheetFormat.baseColWidth||"10",outlineLevelRow:d.sheetFormat.outlineLevelRow||"7"})),j["!cols"]!=null&&0<j["!cols"].length&&(x[x.length]=(function(Y){for(var z,X=["<cols>"],ie=0;ie!=Y.length;++ie)(z=Y[ie])&&(X[X.length]=kt("col",null,yc(ie,z)));return X[X.length]="</cols>",X.join("")})(j["!cols"])),x[g=x.length]="<sheetData/>",j["!links"]=[],j["!ref"]!=null&&0<(b=pf(j,d)).length&&(x[x.length]=b),x.length>g+1&&(x[x.length]="</sheetData>",x[g]=x[g].replace("/>",">")),j["!protect"]&&(x[x.length]=(T=j["!protect"],_={sheet:1},gg.forEach(function(Y){T[Y]!=null&&T[Y]&&(_[Y]="1")}),Xp.forEach(function(Y){T[Y]==null||T[Y]||(_[Y]="0")}),T.password&&(_.password=Y0(T.password).toString(16).toUpperCase()),kt("sheetProtection",null,_))),j["!autofilter"]!=null&&(x[x.length]=(function(Y,z,X,ie){var le=typeof Y.ref=="string"?Y.ref:Ss(Y.ref);X.Workbook||(X.Workbook={Sheets:[]}),X.Workbook.Names||(X.Workbook.Names=[]);var Ae=X.Workbook.Names;(Y=Oa(le)).s.r==Y.e.r&&(Y.e.r=Oa(z["!ref"]).e.r,le=Ss(Y));for(var Ve=0;Ve<Ae.length;++Ve){var Oe=Ae[Ve];if(Oe.Name=="_xlnm._FilterDatabase"&&Oe.Sheet==ie){Oe.Ref="'"+X.SheetNames[ie]+"'!"+le;break}}return Ve==Ae.length&&Ae.push({Name:"_xlnm._FilterDatabase",Sheet:ie,Ref:"'"+X.SheetNames[ie]+"'!"+le}),kt("autoFilter",null,{ref:le})})(j["!autofilter"],j,u,r)),j["!merges"]!=null&&0<j["!merges"].length&&(x[x.length]=(function(Y){if(Y.length===0)return"";for(var z='<mergeCells count="'+Y.length+'">',X=0;X!=Y.length;++X)z+='<mergeCell ref="'+Ss(Y[X])+'"/>';return z+"</mergeCells>"})(j["!merges"]));var q,I,J=-1;return 0<j["!links"].length&&(x[x.length]="<hyperlinks>",j["!links"].forEach(function(Y){Y[1].Target&&(I={ref:Y[0]},Y[1].Target.charAt(0)!="#"&&(J=nr(h,-1,Gs(Y[1].Target).replace(/#.*$/,""),ks.HLINK),I["r:id"]="rId"+J),-1<(q=Y[1].Target.indexOf("#"))&&(I.location=Gs(Y[1].Target.slice(q+1))),Y[1].Tooltip&&(I.tooltip=Gs(Y[1].Tooltip)),x[x.length]=kt("hyperlink",null,I))}),x[x.length]="</hyperlinks>"),delete j["!links"],j["!margins"]!=null&&(x[x.length]=(Ni(u=j["!margins"]),kt("pageMargins",null,u))),d&&!d.ignoreEC&&d.ignoreEC!=null||(x[x.length]=_s("ignoredErrors",kt("ignoredError",null,{numberStoredAsText:1,sqref:k}))),0<R.length&&(J=nr(h,-1,"../drawings/drawing"+(r+1)+".xml",ks.DRAW),x[x.length]=kt("drawing",null,{"r:id":"rId"+J}),j["!drawing"]=R),0<j["!comments"].length&&(J=nr(h,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ks.VML),x[x.length]=kt("legacyDrawing",null,{"r:id":"rId"+J}),j["!legacy"]=J),1<x.length&&(x[x.length]="</worksheet>",x[1]=x[1].replace("/>",">")),x.join("")}function ai(r,d,u,h){u=(function(g,b,x){var y=gt(145),j=(x["!rows"]||[])[g]||{};y.write_shift(4,g),y.write_shift(4,0);var E=320;j.hpx?E=20*uc(j.hpx):j.hpt&&(E=20*j.hpt),y.write_shift(2,E),y.write_shift(1,0),E=0,j.level&&(E|=j.level),j.hidden&&(E|=16),(j.hpx||j.hpt)&&(E|=32),y.write_shift(1,E),y.write_shift(1,0);var k=0,E=y.l;y.l+=4;for(var T={r:g,c:0},_=0;_<16;++_)if(!(b.s.c>_+1<<10||b.e.c<_<<10)){for(var R=-1,q=-1,I=_<<10;I<_+1<<10;++I)T.c=I,(Array.isArray(x)?(x[T.r]||[])[T.c]:x[vs(T)])&&(R<0&&(R=I),q=I);R<0||(++k,y.write_shift(4,R),y.write_shift(4,q))}return g=y.l,y.l=E,y.write_shift(4,k),y.l=g,y.length>y.l?y.slice(0,y.l):y})(h,u,d),(17<u.length||(d["!rows"]||[])[h])&&yt(r,0,u)}var Fd=Kn,vc=bl;function wc(r){return[Zl(r),Ca(r),"n"]}var Si=Kn,jc=bl,xf=["left","right","top","bottom","header","footer"];function pg(r,d,u,h,g,b,x){if(d.v===void 0)return!1;var y="";switch(d.t){case"b":y=d.v?"1":"0";break;case"d":(d=Ys(d)).z=d.z||V[14],d.v=Dr(Ts(d.v)),d.t="n";break;case"n":case"e":y=""+d.v;break;default:y=d.v}var j,k,E,T,_,R,q,I,J,Y,z,X,ie,le,Ae,Ve,Oe,Je,pt,xt,at={r:u,c:h};switch(at.s=Ji(g.cellXfs,d,g),d.l&&b["!links"].push([vs(at),d.l]),d.c&&b["!comments"].push([vs(at),d.c]),d.t){case"s":case"str":return g.bookSST?(y=_d(g.Strings,d.v,g.revStrings),at.t="s",at.v=y,x?yt(r,18,(eo(Oe=at,Je=Je??gt(8)),Je.write_shift(4,Oe.v),Je)):yt(r,7,(Jl(Oe=at,Ve=Ve??gt(12)),Ve.write_shift(4,Oe.v),Ve))):(at.t="str",x?yt(r,17,(le=d,eo(at,Ae=Ae??gt(8+4*le.v.length)),da(le.v,Ae),Ae.length>Ae.l?Ae.slice(0,Ae.l):Ae)):yt(r,6,(le=d,Jl(at,ie=ie??gt(12+4*le.v.length)),da(le.v,ie),ie.length>ie.l?ie.slice(0,ie.l):ie))),!0;case"n":return d.v==(0|d.v)&&-1e3<d.v&&d.v<1e3?x?yt(r,13,(z=d,eo(at,X=X??gt(8)),to(z.v,X),X)):yt(r,2,(z=d,Jl(at,Y=Y??gt(12)),to(z.v,Y),Y)):x?yt(r,16,(I=d,eo(at,J=J??gt(12)),Dn(I.v,J),J)):yt(r,5,(I=d,Jl(at,q=q??gt(16)),Dn(I.v,q),q)),!0;case"b":return at.t="b",x?yt(r,15,(_=d,eo(at,R=R??gt(5)),R.write_shift(1,_.v?1:0),R)):yt(r,4,(_=d,Jl(at,T=T??gt(9)),T.write_shift(1,_.v?1:0),T)),!0;case"e":return at.t="e",x?yt(r,14,(k=d,eo(at,E=E??gt(8)),E.write_shift(1,k.v),E.write_shift(2,0),E.write_shift(1,0),E)):yt(r,3,(k=d,Jl(at,j=j??gt(9)),j.write_shift(1,k.v),j)),!0}return x?yt(r,12,eo(at,xt=xt??gt(4))):yt(r,1,Jl(at,pt=pt??gt(8))),!0}function Md(r,d){var u,h;d&&d["!merges"]&&(yt(r,177,(u=d["!merges"].length,(h=h??gt(4)).write_shift(4,u),h)),d["!merges"].forEach(function(g){yt(r,176,jc(g))}),yt(r,178))}function xg(r,d){d&&d["!cols"]&&(yt(r,390),d["!cols"].forEach(function(u,h){u&&yt(r,60,(function(g,b,x){x==null&&(x=gt(18));var y=yc(g,b);return x.write_shift(-4,g),x.write_shift(-4,g),x.write_shift(4,256*(y.width||10)),x.write_shift(4,0),g=0,b.hidden&&(g|=1),typeof y.width=="number"&&(g|=2),b.level&&(g|=b.level<<8),x.write_shift(2,g),x})(h,u))}),yt(r,391))}function fu(r,d){var u;d&&d["!ref"]&&(yt(r,648),yt(r,649,(u=Ls(d["!ref"]),(d=gt(24)).write_shift(4,4),d.write_shift(4,1),bl(u,d),d)),yt(r,650))}function bg(r,d,u){d["!links"].forEach(function(h){var g,b;h[1].Target&&(g=nr(u,-1,h[1].Target.replace(/#.*$/,""),ks.HLINK),yt(r,494,(b=g,h=gt(50+4*((g=h)[1].Target.length+(g[1].Tooltip||"").length)),bl({s:Hr(g[0]),e:Hr(g[0])},h),sd("rId"+b,h),da(((b=g[1].Target.indexOf("#"))==-1?"":g[1].Target.slice(b+1))||"",h),da(g[1].Tooltip||"",h),da("",h),h.slice(0,h.l))))}),delete d["!links"]}function Jp(r,d,u){yt(r,133),yt(r,137,(function(h,g){g==null&&(g=gt(30));var b=924;return(((h||{}).Views||[])[0]||{}).RTL&&(b|=32),g.write_shift(2,b),g.write_shift(4,0),g.write_shift(4,0),g.write_shift(4,0),g.write_shift(1,0),g.write_shift(1,0),g.write_shift(2,0),g.write_shift(2,100),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(4,0),g})(u)),yt(r,138),yt(r,134)}function Zp(r,d){var u,h;d["!protect"]&&yt(r,535,(u=d["!protect"],(h=h??gt(66)).write_shift(2,u.password?Y0(u.password):0),h.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(g){g[1]?h.write_shift(4,u[g[0]]==null||u[g[0]]?0:1):h.write_shift(4,u[g[0]]!=null&&u[g[0]]?0:1)}),h))}function ar(r,d,u,h){var g=Ra(),k=u.SheetNames[r],b=u.Sheets[k]||{},x=k;try{u&&u.Workbook&&(x=u.Workbook.Sheets[r].CodeName||x)}catch{}var y,j,k=Ls(b["!ref"]||"A1");if(16383<k.e.c||1048575<k.e.r){if(d.WTF)throw new Error("Range "+(b["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");k.e.c=Math.min(k.e.c,16383),k.e.r=Math.min(k.e.c,1048575)}return b["!links"]=[],b["!comments"]=[],yt(g,129),(u.vbaraw||b["!outline"])&&yt(g,147,(function(E,T,_){_==null&&(_=gt(84+4*E.length));var R=192;T&&(T.above&&(R&=-65),T.left&&(R&=-129)),_.write_shift(1,R);for(var q=1;q<3;++q)_.write_shift(1,0);return Bi({auto:1},_),_.write_shift(-4,-1),_.write_shift(-4,-1),Qo(E,_),_.slice(0,_.l)})(x,b["!outline"])),yt(g,148,vc(k)),Jp(g,0,u.Workbook),xg(g,b),(function(E,T,_){var R,q=Ls(T["!ref"]||"A1"),I=[];yt(E,145);var J=Array.isArray(T),Y=q.e.r;T["!rows"]&&(Y=Math.max(q.e.r,T["!rows"].length-1));for(var z=q.s.r;z<=Y;++z){R=Ur(z),ai(E,T,q,z);var X=!1;if(z<=q.e.r)for(var ie=q.s.c;ie<=q.e.c;++ie){z===q.s.r&&(I[ie]=Tr(ie)),le=I[ie]+R;var le=J?(T[z]||[])[ie]:T[le];le?X=pg(E,le,z,ie,_,T,X):X=!1}}yt(E,146)})(g,b,d),Zp(g,b),(function(E,T,_,R){if(T["!autofilter"]){var J=T["!autofilter"],q=typeof J.ref=="string"?J.ref:Ss(J.ref);_.Workbook||(_.Workbook={Sheets:[]}),_.Workbook.Names||(_.Workbook.Names=[]);var I=_.Workbook.Names,J=Oa(q);J.s.r==J.e.r&&(J.e.r=Oa(T["!ref"]).e.r,q=Ss(J));for(var Y=0;Y<I.length;++Y){var z=I[Y];if(z.Name=="_xlnm._FilterDatabase"&&z.Sheet==R){z.Ref="'"+_.SheetNames[R]+"'!"+q;break}}Y==I.length&&I.push({Name:"_xlnm._FilterDatabase",Sheet:R,Ref:"'"+_.SheetNames[R]+"'!"+q}),yt(E,161,bl(Ls(q))),yt(E,162)}})(g,b,u,r),Md(g,b),bg(g,b,h),b["!margins"]&&yt(g,476,(y=b["!margins"],j==null&&(j=gt(48)),Ni(y),xf.forEach(function(E){Dn(y[E],j)}),j)),d&&!d.ignoreEC&&d.ignoreEC!=null||fu(g,b),k=g,d=r,h=h,0<(b=b)["!comments"].length&&(d=nr(h,-1,"../drawings/vmlDrawing"+(d+1)+".vml",ks.VML),yt(k,551,sd("rId"+d)),b["!legacy"]=d),yt(g,130),g.end()}function br(r,d,u,h,g,b){var x=b||{"!type":"chart"};if(!r)return b;var y,j=0,k=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(T){var _=(function(R){var q,I=[],J=R.match(/^<c:numCache>/);(R.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(z){z=z.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/),z&&(I[+z[1]]=J?+z[2]:z[2])});var Y=ys((R.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(R.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(z){q=z.replace(/<.*?>/g,"")}),[I,Y,q]})(T);E.s.r=E.s.c=0,E.e.c=j,y=Tr(j),_[0].forEach(function(R,q){x[y+Ur(q)]={t:"n",v:R,z:_[1]},k=q}),E.e.r<k&&(E.e.r=k),++j}),0<j&&(x["!ref"]=Ss(E)),x}var Ps=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Ws=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],cr=[],vn=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function tl(r,d){for(var u=0;u!=r.length;++u)for(var h=r[u],g=0;g!=d.length;++g){var b=d[g];if(h[b[0]]==null)h[b[0]]=b[1];else switch(b[2]){case"bool":typeof h[b[0]]=="string"&&(h[b[0]]=hr(h[b[0]]));break;case"int":typeof h[b[0]]=="string"&&(h[b[0]]=parseInt(h[b[0]],10))}}}function wo(r,d){for(var u=0;u!=d.length;++u){var h=d[u];if(r[h[0]]==null)r[h[0]]=h[1];else switch(h[2]){case"bool":typeof r[h[0]]=="string"&&(r[h[0]]=hr(r[h[0]]));break;case"int":typeof r[h[0]]=="string"&&(r[h[0]]=parseInt(r[h[0]],10))}}}function mu(r){wo(r.WBProps,Ps),wo(r.CalcPr,vn),tl(r.WBView,Ws),tl(r.Sheets,cr),Fl.date1904=hr(r.WBProps.date1904)}var sl="][*?/\\".split("");function Vr(r,d){if(31<r.length)throw new Error("Sheet names cannot exceed 31 chars");var u=!0;return sl.forEach(function(h){if(r.indexOf(h)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),u}function rl(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var d,u,h,g=r.Workbook&&r.Workbook.Sheets||[];d=r.SheetNames,u=g,h=!!r.vbaraw,d.forEach(function(x,y){Vr(x);for(var j=0;j<y;++j)if(x==d[j])throw new Error("Duplicate Sheet Name: "+x);if(h){var k=u&&u[y]&&u[y].CodeName||x;if(k.charCodeAt(0)==95&&22<k.length)throw new Error("Bad Code Name: Worksheet"+k)}});for(var b=0;b<r.SheetNames.length;++b)(function(x,y){if(x&&x["!ref"]){var j=Ls(x["!ref"]);if(j.e.c<j.s.c||j.e.r<j.s.r)throw new Error("Bad range ("+y+"): "+x["!ref"])}})(r.Sheets[r.SheetNames[b]],(r.SheetNames[b],b))}var jo=/<\w+:workbook/;function gu(r){var d=[kr];d[d.length]=kt("workbook",null,{xmlns:gl[0],"xmlns:r":Yr.r});var u=r.Workbook&&0<(r.Workbook.Names||[]).length,h={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(Ps.forEach(function(y){r.Workbook.WBProps[y[0]]!=null&&r.Workbook.WBProps[y[0]]!=y[1]&&(h[y[0]]=r.Workbook.WBProps[y[0]])}),r.Workbook.WBProps.CodeName&&(h.codeName=r.Workbook.WBProps.CodeName,delete h.CodeName)),d[d.length]=kt("workbookPr",null,h);var g=r.Workbook&&r.Workbook.Sheets||[],b=0;if(g&&g[0]&&g[0].Hidden){for(d[d.length]="<bookViews>",b=0;b!=r.SheetNames.length&&g[b]&&g[b].Hidden;++b);b==r.SheetNames.length&&(b=0),d[d.length]='<workbookView firstSheet="'+b+'" activeTab="'+b+'"/>',d[d.length]="</bookViews>"}for(d[d.length]="<sheets>",b=0;b!=r.SheetNames.length;++b){var x={name:Gs(r.SheetNames[b].slice(0,31))};if(x.sheetId=""+(b+1),x["r:id"]="rId"+(b+1),g[b])switch(g[b].Hidden){case 1:x.state="hidden";break;case 2:x.state="veryHidden"}d[d.length]=kt("sheet",null,x)}return d[d.length]="</sheets>",u&&(d[d.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(y){var j={name:y.Name};y.Comment&&(j.comment=y.Comment),y.Sheet!=null&&(j.localSheetId=""+y.Sheet),y.Hidden&&(j.hidden="1"),y.Ref&&(d[d.length]=kt("definedName",Gs(y.Ref),j))}),d[d.length]="</definedNames>"),2<d.length&&(d[d.length]="</workbook>",d[1]=d[1].replace("/>",">")),d.join("")}function wn(r,d){var u={};return r.read_shift(4),u.ArchID=r.read_shift(4),r.l+=d-8,u}function Nc(r,d){yt(r,143);for(var u,h=0;h!=d.SheetNames.length;++h){var g={Hidden:d.Workbook&&d.Workbook.Sheets&&d.Workbook.Sheets[h]&&d.Workbook.Sheets[h].Hidden||0,iTabID:h+1,strRelID:"rId"+(h+1),name:d.SheetNames[h]};yt(r,156,(u=g,(g=(g=void 0)||gt(127)).write_shift(4,u.Hidden),g.write_shift(4,u.iTabID),sd(u.strRelID,g),da(u.name.slice(0,31),g),g.length>g.l?g.slice(0,g.l):g))}yt(r,144)}function Ld(r,d){if(d.Workbook&&d.Workbook.Sheets){for(var u,h=d.Workbook.Sheets,g=0,b=-1,x=-1;g<h.length;++g)!h[g]||!h[g].Hidden&&b==-1?b=g:h[g].Hidden==1&&x==-1&&(x=g);b<x||(yt(r,135),yt(r,158,(d=b,(u=u||gt(29)).write_shift(-4,0),u.write_shift(-4,460),u.write_shift(4,28800),u.write_shift(4,17600),u.write_shift(4,500),u.write_shift(4,d),u.write_shift(4,d),u.write_shift(1,120),u.length>u.l?u.slice(0,u.l):u)),yt(r,136))}}function Xa(r,d){var u=Ra();return yt(u,131),yt(u,128,(function(h){h=h||gt(127);for(var g=0;g!=4;++g)h.write_shift(4,0);return da("SheetJS",h),da(s.version,h),da(s.version,h),da("7262",h),h.length>h.l?h.slice(0,h.l):h})()),yt(u,153,(function(h,g){g=g||gt(72);var b=0;return h&&h.filterPrivacy&&(b|=8),g.write_shift(4,b),g.write_shift(4,0),Qo(h&&h.CodeName||"ThisWorkbook",g),g.slice(0,g.l)})(r.Workbook&&r.Workbook.WBProps||null)),Ld(u,r),Nc(u,r),yt(u,132),u.end()}function bf(r,d,u){return(d.slice(-4)===".bin"?function(h,g){var b={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},x=[],y=!1;(g=g||{}).biff=12;var j=[],k=[[]];return k.SheetNames=[],k.XTI=[],No[16]={n:"BrtFRTArchID$",f:wn},Ii(h,function(E,T,_){switch(_){case 156:k.SheetNames.push(E.name),b.Sheets.push(E);break;case 153:b.WBProps=E;break;case 39:E.Sheet!=null&&(g.SID=E.Sheet),E.Ref=Ia(E.Ptg,0,null,k,g),delete g.SID,delete E.Ptg,j.push(E);break;case 1036:break;case 357:case 358:case 355:case 667:k[0].length?k.push([_,E]):k[0]=[_,E],k[k.length-1].XTI=[];break;case 362:k.length===0&&(k[0]=[],k[0].XTI=[]),k[k.length-1].XTI=k[k.length-1].XTI.concat(E),k.XTI=k.XTI.concat(E);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:x.push(_),y=!0;break;case 36:x.pop(),y=!1;break;case 37:x.push(_),y=!0;break;case 38:x.pop(),y=!1;break;case 16:break;default:if(!T.T&&(!y||g.WTF&&x[x.length-1]!=37&&x[x.length-1]!=35))throw new Error("Unexpected record 0x"+_.toString(16))}},g),mu(b),b.Names=j,b.supbooks=k,b}:function(h,g){if(!h)throw new Error("Could not find file");var b={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},x=!1,y="xmlns",j={},k=0;if(h.replace(Mr,function(E,T){var _=gs(E);switch(An(_[0])){case"<?xml":break;case"<workbook":E.match(jo)&&(y="xmlns"+E.match(/<(\w+):/)[1]),b.xmlns=_[y];break;case"</workbook>":break;case"<fileVersion":delete _[0],b.AppVersion=_;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ps.forEach(function(R){if(_[R[0]]!=null)switch(R[2]){case"bool":b.WBProps[R[0]]=hr(_[R[0]]);break;case"int":b.WBProps[R[0]]=parseInt(_[R[0]],10);break;default:b.WBProps[R[0]]=_[R[0]]}}),_.codeName&&(b.WBProps.CodeName=qe(_.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete _[0],b.WBView.push(_);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(_.state){case"hidden":_.Hidden=1;break;case"veryHidden":_.Hidden=2;break;default:_.Hidden=0}delete _.state,_.name=ys(qe(_.name)),delete _[0],b.Sheets.push(_);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":x=!0;break;case"</definedNames>":x=!1;break;case"<definedName":(j={}).Name=qe(_.name),_.comment&&(j.Comment=_.comment),_.localSheetId&&(j.Sheet=+_.localSheetId),hr(_.hidden||"0")&&(j.Hidden=!0),k=T+E.length;break;case"</definedName>":j.Ref=ys(qe(h.slice(k,T))),b.Names.push(j);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete _[0],b.CalcPr=_;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":x=!0;break;case"</ext>":x=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":x=!0;break;case"</AlternateContent>":x=!1;break;case"<revisionPtr":break;default:if(!x&&g.WTF)throw new Error("unrecognized "+_[0]+" in workbook")}return E}),gl.indexOf(b.xmlns)===-1)throw new Error("Unknown Namespace: "+b.xmlns);return mu(b),b})(r,u)}function pu(r,d,u,h,g,b,x,y){return(d.slice(-4)===".bin"?function(j,k,E,T,_,R,q){if(!j)return j;var I=k||{};T=T||{"!id":{}};var J,Y,z,X,ie,le,Ae,Ve,Oe,Je,pt=I.dense?[]:{},xt={s:{r:2e6,c:2e6},e:{r:0,c:0}},at=!1,Ct=!1,Vt=[];I.biff=12;var Ut=I["!row"]=0,Ft=!1,Mt=[],Dt={},wt=I.supbooks||_.supbooks||[[]];if(wt.sharedf=Dt,wt.arrayf=Mt,wt.SheetNames=_.SheetNames||_.Sheets.map(function(St){return St.name}),!I.supbooks&&(I.supbooks=wt,_.Names))for(var Yt=0;Yt<_.Names.length;++Yt)wt[0][Yt+1]=_.Names[Yt];var Jt,is=[],Fs=[],Wt=!1;return No[16]={n:"BrtShortReal",f:wc},Ii(j,function(St,xs,Hs){if(!Ct)switch(Hs){case 148:J=St;break;case 0:Y=St,I.sheetRows&&I.sheetRows<=Y.r&&(Ct=!0),Oe=Ur(ie=Y.r),I["!row"]=Y.r,(St.hidden||St.hpt||St.level!=null)&&(St.hpt&&(St.hpx=xo(St.hpt)),Fs[St.r]=St);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(z={t:St[2]},St[2]){case"n":z.v=St[1];break;case"s":Ve=xc[St[1]],z.v=Ve.t,z.r=Ve.r;break;case"b":z.v=!!St[1];break;case"e":z.v=St[1],I.cellText!==!1&&(z.w=Qn[z.v]);break;case"str":z.t="s",z.v=St[1];break;case"is":z.t="s",z.v=St[1].t}if((X=q.CellXf[St[0].iStyleRef])&&ki(z,X.numFmtId,null,I,R,q),le=St[0].c==-1?le+1:St[0].c,I.dense?(pt[ie]||(pt[ie]=[]),pt[ie][le]=z):pt[Tr(le)+Oe]=z,I.cellFormula){for(Ft=!1,Ut=0;Ut<Mt.length;++Ut){var Is=Mt[Ut];Y.r>=Is[0].s.r&&Y.r<=Is[0].e.r&&le>=Is[0].s.c&&le<=Is[0].e.c&&(z.F=Ss(Is[0]),Ft=!0)}!Ft&&3<St.length&&(z.f=St[3])}xt.s.r>Y.r&&(xt.s.r=Y.r),xt.s.c>le&&(xt.s.c=le),xt.e.r<Y.r&&(xt.e.r=Y.r),xt.e.c<le&&(xt.e.c=le),I.cellDates&&X&&z.t=="n"&&rr(V[X.numFmtId])&&(tr=de(z.v))&&(z.t="d",z.v=new Date(tr.y,tr.m-1,tr.d,tr.H,tr.M,tr.S,tr.u)),Jt&&(Jt.type=="XLDAPR"&&(z.D=!0),Jt=void 0);break;case 1:case 12:if(!I.sheetStubs||at)break;z={t:"z",v:void 0},le=St[0].c==-1?le+1:St[0].c,I.dense?(pt[ie]||(pt[ie]=[]),pt[ie][le]=z):pt[Tr(le)+Oe]=z,xt.s.r>Y.r&&(xt.s.r=Y.r),xt.s.c>le&&(xt.s.c=le),xt.e.r<Y.r&&(xt.e.r=Y.r),xt.e.c<le&&(xt.e.c=le),Jt&&(Jt.type=="XLDAPR"&&(z.D=!0),Jt=void 0);break;case 176:Vt.push(St);break;case 49:Jt=((I.xlmeta||{}).Cell||[])[St-1];break;case 494:var tr=T["!id"][St.relId];for(tr?(St.Target=tr.Target,St.loc&&(St.Target+="#"+St.loc),St.Rel=tr):St.relId==""&&(St.Target="#"+St.loc),ie=St.rfx.s.r;ie<=St.rfx.e.r;++ie)for(le=St.rfx.s.c;le<=St.rfx.e.c;++le)I.dense?(pt[ie]||(pt[ie]=[]),pt[ie][le]||(pt[ie][le]={t:"z",v:void 0}),pt[ie][le].l=St):(Ae=vs({c:le,r:ie}),pt[Ae]||(pt[Ae]={t:"z",v:void 0}),pt[Ae].l=St);break;case 426:if(!I.cellFormula)break;Mt.push(St),(Je=I.dense?pt[ie][le]:pt[Tr(le)+Oe]).f=Ia(St[1],0,{r:Y.r,c:le},wt,I),Je.F=Ss(St[0]);break;case 427:if(!I.cellFormula)break;Dt[vs(St[0].s)]=St[1],(Je=I.dense?pt[ie][le]:pt[Tr(le)+Oe]).f=Ia(St[1],0,{r:Y.r,c:le},wt,I);break;case 60:if(!I.cellStyles)break;for(;St.e>=St.s;)is[St.e--]={width:St.w/256,hidden:!!(1&St.flags),level:St.level},Wt||(Wt=!0,vd(St.w/256)),El(is[St.e+1]);break;case 161:pt["!autofilter"]={ref:Ss(St)};break;case 476:pt["!margins"]=St;break;case 147:_.Sheets[E]||(_.Sheets[E]={}),St.name&&(_.Sheets[E].CodeName=St.name),(St.above||St.left)&&(pt["!outline"]={above:St.above,left:St.left});break;case 137:_.Views||(_.Views=[{}]),_.Views[0]||(_.Views[0]={}),St.RTL&&(_.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:at=!0;break;case 36:at=!1;break;case 37:at=!0;break;case 38:at=!1;break;default:if(!xs.T&&(!at||I.WTF))throw new Error("Unexpected record 0x"+Hs.toString(16))}},I),delete I.supbooks,delete I["!row"],!pt["!ref"]&&(xt.s.r<2e6||J&&(0<J.e.r||0<J.e.c||0<J.s.r||0<J.s.c))&&(pt["!ref"]=Ss(J||xt)),I.sheetRows&&pt["!ref"]&&(j=Ls(pt["!ref"]),I.sheetRows<=+j.e.r&&(j.e.r=I.sheetRows-1,j.e.r>xt.e.r&&(j.e.r=xt.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>xt.e.c&&(j.e.c=xt.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),pt["!fullref"]=pt["!ref"],pt["!ref"]=Ss(j))),0<Vt.length&&(pt["!merges"]=Vt),0<is.length&&(pt["!cols"]=is),0<Fs.length&&(pt["!rows"]=Fs),pt}:mg)(r,h,u,g,b,x,y)}function yg(r,d,u,h,g,b){return d.slice(-4)===".bin"?(function(x,y,j,k,E){if(!x)return x;k=k||{"!id":{}};var T={"!type":"chart","!drawel":null,"!rel":""},_=!1;return Ii(x,function(R,q,I){switch(I){case 550:T["!rel"]=R;break;case 651:E.Sheets[j]||(E.Sheets[j]={}),R.name&&(E.Sheets[j].CodeName=R.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:_=!0;break;case 36:_=!1;break;case 37:break;case 38:break;default:if(!(0<q.T)){if(!(q.T<0)){if(!_||y.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}}},y),k["!id"][T["!rel"]]&&(T["!drawel"]=k["!id"][T["!rel"]]),T})(r,h,u,g,b):(function(x,y,j,k){if(!x)return x;j=j||{"!id":{}};var E={"!type":"chart","!drawel":null,"!rel":""},T=x.match(_r);return T&&du(T[0],0,k,y),(x=x.match(/drawing r:id="(.*?)"/))&&(E["!rel"]=x[1]),j["!id"][E["!rel"]]&&(E["!drawel"]=j["!id"][E["!rel"]]),E})(r,u,g,b)}function xu(r,d,u,h){return(d.slice(-4)===".bin"?function(g,b,x){var y,j={NumberFmt:[]};for(y in V)j.NumberFmt[y]=V[y];j.CellXf=[],j.Fonts=[];var k=[],E=!1;return Ii(g,function(T,_,R){switch(R){case 44:j.NumberFmt[T[0]]=T[1],Br(T[1],T[0]);break;case 43:j.Fonts.push(T),T.color.theme!=null&&b&&b.themeElements&&b.themeElements.clrScheme&&(T.color.rgb=yd(b.themeElements.clrScheme[T.color.theme].rgb,T.color.tint||0));break;case 1025:case 45:case 46:break;case 47:k[k.length-1]==617&&j.CellXf.push(T);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:E=!0;break;case 36:E=!1;break;case 37:k.push(R),E=!0;break;case 38:k.pop(),E=!1;break;default:if(0<_.T)k.push(R);else if(_.T<0)k.pop();else if(!E||x.WTF&&k[k.length-1]!=37)throw new Error("Unexpected record 0x"+R.toString(16))}}),j}:Yh)(r,u,h)}function bu(r,d,u){return d.slice(-4)===".bin"?(h=u,b=!(g=[]),Ii(r,function(x,y,j){switch(j){case 159:g.Count=x[0],g.Unique=x[1];break;case 19:g.push(x);break;case 160:return 1;case 35:b=!0;break;case 36:b=!1;break;default:if(y.T,!b||h.WTF)throw new Error("Unexpected record 0x"+j.toString(16))}}),g):(function(x,y){var j=[],k="";if(!x)return j;if(x=x.match(Va)){k=x[2].replace(Jr,"").split(q0);for(var E=0;E!=k.length;++E){var T=md(k[E].trim(),y);T!=null&&(j[j.length]=T)}x=gs(x[1]),j.Count=x.count,j.Unique=x.uniqueCount}return j})(r,u);var h,g,b}function Ll(r,d,u){return d.slice(-4)===".bin"?(h=u,g=[],b=[],y=!(x={}),Ii(r,function(j,k,E){switch(E){case 632:b.push(j);break;case 635:x=j;break;case 637:x.t=j.t,x.h=j.h,x.r=j.r;break;case 636:if(x.author=b[x.iauthor],delete x.iauthor,h.sheetRows&&x.rfx&&h.sheetRows<=x.rfx.r)break;x.t||(x.t=""),delete x.rfx,g.push(x);break;case 3072:break;case 35:y=!0;break;case 36:y=!1;break;case 37:case 38:break;default:if(!k.T&&(!y||h.WTF))throw new Error("Unexpected record 0x"+E.toString(16))}}),g):(function(j,k){if(j.match(/<(?:\w+:)?comments *\/>/))return[];var E=[],T=[],_=j.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);return _&&_[1]&&_[1].split(/<\/\w*:?author>/).forEach(function(R){R===""||R.trim()===""||(R=R.match(/<(?:\w+:)?author[^>]*>(.*)/))&&E.push(R[1])}),(j=j.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&j[1]&&j[1].split(/<\/\w*:?comment>/).forEach(function(R){var q,I;R===""||R.trim()===""||(q=R.match(/<(?:\w+:)?comment[^>]*>/))&&(q={author:(I=gs(q[0])).authorId&&E[I.authorId]||"sheetjsghost",ref:I.ref,guid:I.guid},I=Hr(I.ref),k.sheetRows&&k.sheetRows<=I.r||(R=!!(R=R.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!R[1]&&md(R[1])||{r:"",t:"",h:""},q.r=R.r,R.r=="<t></t>"&&(R.t=R.h=""),q.t=(R.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),k.cellHTML&&(q.h=R.h),T.push(q)))}),T})(r,u);var h,g,b,x,y}function ha(r,d){return d.slice(-4)===".bin"?(u=[],Ii(r,function(h,g,b){if(b===63)u.push(h);else if(!g.T)throw new Error("Unexpected record 0x"+b.toString(16))}),u):(function(h){var g=[];if(!h)return g;var b=1;return(h.match(Mr)||[]).forEach(function(x){var y=gs(x);switch(y[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete y[0],y.i?b=y.i:y.i=b,g.push(y)}}),g})(r);var u}function Rl(r,d,u,h){if(u.slice(-4)===".bin")return(function(g,b){if(!g)return g;var x=b||{},y=!1;Ii(g,function(j,k,E){switch(E){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:y=!0;break;case 36:y=!1;break;default:if(!k.T&&(!y||x.WTF))throw new Error("Unexpected record 0x"+E.toString(16))}},x)})(r,h)}function kc(r,d,u){return d.slice(-4)===".bin"?(h={Types:[],Cell:[],Value:[]},g=u||{},x=!(b=[]),y=2,Ii(r,function(j,k,E){switch(E){case 335:h.Types.push({name:j.name});break;case 51:j.forEach(function(T){y==1?h.Cell.push({type:h.Types[T[0]-1].name,index:T[1]}):y==0&&h.Value.push({type:h.Types[T[0]-1].name,index:T[1]})});break;case 337:y=j?1:0;break;case 338:y=2;break;case 35:b.push(E),x=!0;break;case 36:b.pop(),x=!1;break;default:if(!k.T&&(!x||g.WTF&&b[b.length-1]!=35))throw new Error("Unexpected record 0x"+E.toString(16))}}),h):(function(j,k){var E={Types:[],Cell:[],Value:[]};if(!j)return E;var T,_=!1,R=2;return j.replace(Mr,function(q){var I=gs(q);switch(An(I[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":E.Types.push({name:I.name});break;case"</metadataType>":break;case"<futureMetadata":for(var J=0;J<E.Types.length;++J)E.Types[J].name==I.name&&(T=E.Types[J]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":R==1?E.Cell.push({type:E.Types[I.t-1].name,index:+I.v}):R==0&&E.Value.push({type:E.Types[I.t-1].name,index:+I.v});break;case"</rc>":break;case"<cellMetadata":R=1;break;case"</cellMetadata>":R=2;break;case"<valueMetadata":R=0;break;case"</valueMetadata>":R=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":_=!0;break;case"</ext>":_=!1;break;case"<rvb":if(!T)break;T.offsets||(T.offsets=[]),T.offsets.push(+I.i);break;default:if(!_&&k.WTF)throw new Error("unrecognized "+I[0]+" in metadata")}return q}),E})(r,u);var h,g,b,x,y}var jn,yu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,vu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Rn(r,d){var u=r.split(/\s+/),h=[];if(h[0]=u[0],u.length===1)return h;var g,b,x,y=r.match(yu);if(y)for(x=0;x!=y.length;++x)(b=(g=y[x].match(vu))[1].indexOf(":"))===-1?h[g[1]]=g[2].slice(1,g[2].length-1):h[g[1].slice(0,6)==="xmlns:"?"xmlns"+g[1].slice(6):g[1].slice(b+1)]=g[2].slice(1,g[2].length-1);return h}function Rd(r,d,u){if(r.t!=="z"){if(!u||u.cellText!==!1)try{r.t==="e"?r.w=r.w||Qn[r.v]:d==="General"?r.t==="n"?(0|r.v)===r.v?r.w=r.v.toString(10):r.w=vt(r.v):r.w=Pe(r.v):r.w=(h=d||"General",g=r.v,(h=jn[h]||ys(h))==="General"?Pe(g):Er(h,g))}catch(x){if(u.WTF)throw x}var h,g;try{var b=jn[d]||d||"General";u.cellNF&&(r.z=b),u.cellDates&&r.t=="n"&&rr(b)&&(b=de(r.v))&&(r.t="d",r.v=new Date(b.y,b.m-1,b.d,b.H,b.M,b.S,b.u))}catch(x){if(u.WTF)throw x}}}function Od(r,d){var u=d||{};ql();var h,g=O(c0(r)),b=(g=u.type=="binary"||u.type=="array"||u.type=="base64"?e!==void 0?e.utils.decode(65001,M(g)):qe(g):g).slice(0,1024).toLowerCase(),x=!1;if((1023&(b=b.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&b.indexOf(","),1023&b.indexOf(";"))){var y=Ys(u);return y.type="string",Gi.to_workbook(g,y)}if(b.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ce){0<=b.indexOf("<"+Ce)&&(x=!0)}),x)return(function(Ce,jt){if(Ce=Ce.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi),!Ce||Ce.length==0)throw new Error("Invalid HTML: could not find <table>");if(Ce.length==1)return Gn(zd(Ce[0],jt),jt);var Ze=Pf();return Ce.forEach(function(ot,Qe){zu(Ze,zd(ot,jt),"Sheet"+(Qe+1))}),Ze})(g,u);jn={"General Number":"General","General Date":V[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":V[15],"Short Date":V[14],"Long Time":V[19],"Medium Time":V[18],"Short Time":V[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:V[2],Standard:V[4],Percent:V[10],Scientific:V[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var j,k=[],E,T={},_=[],R=u.dense?[]:{},q="",I={},J={},Y=Rn('<Data ss:Type="String">'),z=0,X=0,ie=0,le={s:{r:2e6,c:2e6},e:{r:0,c:0}},Ae={},Ve={},Oe="",Je=0,pt=[],xt={},at={},Ct=0,Vt=[],Ut=[],Ft={},Mt=[],Dt=!1,wt=[],Yt=[],Jt={},is=0,Fs=0,Wt={Sheets:[],WBProps:{date1904:!1}},St={};ml.lastIndex=0,g=g.replace(/<!--([\s\S]*?)-->/gm,"");for(var xs,Hs,Is,tr,Ir="";h=ml.exec(g);)switch(h[3]=(Ir=h[3]).toLowerCase()){case"data":if(Ir=="data"){if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break}if(k[k.length-1][1])break;h[1]==="/"?(function(Ce,jt,Ze,ot,Qe,ft,At,Kt,Gt,Bt){var Qt="General",rs=ot.StyleID,ss={};Bt=Bt||{};var Lt=[],Et=0;for((rs=rs===void 0&&Kt?Kt.StyleID:rs)===void 0&&At&&(rs=At.StyleID);ft[rs]!==void 0&&(ft[rs].nf&&(Qt=ft[rs].nf),ft[rs].Interior&&Lt.push(ft[rs].Interior),ft[rs].Parent);)rs=ft[rs].Parent;switch(Ze.Type){case"Boolean":ot.t="b",ot.v=hr(Ce);break;case"String":ot.t="s",ot.r=l0(ys(Ce)),ot.v=-1<Ce.indexOf("<")?ys(jt||Ce).replace(/<.*?>/g,""):ot.r;break;case"DateTime":Ce.slice(-1)!="Z"&&(Ce+="Z"),ot.v=(Ts(Ce)-new Date(Date.UTC(1899,11,30)))/864e5,ot.v!=ot.v?ot.v=ys(Ce):ot.v<60&&(ot.v=ot.v-1),Qt&&Qt!="General"||(Qt="yyyy-mm-dd");case"Number":ot.v===void 0&&(ot.v=+Ce),ot.t||(ot.t="n");break;case"Error":ot.t="e",ot.v=Tn[Ce],Bt.cellText!==!1&&(ot.w=Ce);break;default:Ce==""&&jt==""?ot.t="z":(ot.t="s",ot.v=l0(jt||Ce))}if(Rd(ot,Qt,Bt),Bt.cellFormula!==!1)if(ot.Formula)Ze=ys(ot.Formula),Ze.charCodeAt(0)==61&&(Ze=Ze.slice(1)),ot.f=bo(Ze,Qe),delete ot.Formula,ot.ArrayRange=="RC"?ot.F=bo("RC:RC",Qe):ot.ArrayRange&&(ot.F=bo(ot.ArrayRange,Qe),Gt.push([Ls(ot.F),ot.F]));else for(Et=0;Et<Gt.length;++Et)Qe.r>=Gt[Et][0].s.r&&Qe.r<=Gt[Et][0].e.r&&Qe.c>=Gt[Et][0].s.c&&Qe.c<=Gt[Et][0].e.c&&(ot.F=Gt[Et][1]);Bt.cellStyles&&(Lt.forEach(function(as){!ss.patternType&&as.patternType&&(ss.patternType=as.patternType)}),ot.s=ss),ot.StyleID!==void 0&&(ot.ixfe=ot.StyleID)})(g.slice(z,h.index),Oe,Y,k[k.length-1][0]=="comment"?Ft:I,{c:X,r:ie},Ae,Mt[X],J,wt,u):(Oe="",Y=Rn(h[0]),z=h.index+h[0].length);break;case"cell":if(h[1]==="/")if(0<Ut.length&&(I.c=Ut),(!u.sheetRows||u.sheetRows>ie)&&I.v!==void 0&&(u.dense?(R[ie]||(R[ie]=[]),R[ie][X]=I):R[Tr(X)+Ur(ie)]=I),I.HRef&&(I.l={Target:ys(I.HRef)},I.HRefScreenTip&&(I.l.Tooltip=I.HRefScreenTip),delete I.HRef,delete I.HRefScreenTip),(I.MergeAcross||I.MergeDown)&&(is=X+(0|parseInt(I.MergeAcross,10)),Fs=ie+(0|parseInt(I.MergeDown,10)),pt.push({s:{c:X,r:ie},e:{c:is,r:Fs}})),u.sheetStubs)if(I.MergeAcross||I.MergeDown){for(var Fe=X;Fe<=is;++Fe)for(var sr=ie;sr<=Fs;++sr)(X<Fe||ie<sr)&&(u.dense?(R[sr]||(R[sr]=[]),R[sr][Fe]={t:"z"}):R[Tr(Fe)+Ur(sr)]={t:"z"});X=is+1}else++X;else I.MergeAcross?X=is+1:++X;else(X=(I=(function(Ce){var jt={};if(Ce.split(/\s+/).length===1)return jt;var Ze,ot,Qe,ft=Ce.match(yu);if(ft)for(Qe=0;Qe!=ft.length;++Qe)(ot=(Ze=ft[Qe].match(vu))[1].indexOf(":"))===-1?jt[Ze[1]]=Ze[2].slice(1,Ze[2].length-1):jt[Ze[1].slice(0,6)==="xmlns:"?"xmlns"+Ze[1].slice(6):Ze[1].slice(ot+1)]=Ze[2].slice(1,Ze[2].length-1);return jt})(h[0])).Index?+I.Index-1:X)<le.s.c&&(le.s.c=X),X>le.e.c&&(le.e.c=X),h[0].slice(-2)==="/>"&&++X,Ut=[];break;case"row":h[1]==="/"||h[0].slice(-2)==="/>"?(ie<le.s.r&&(le.s.r=ie),ie>le.e.r&&(le.e.r=ie),h[0].slice(-2)==="/>"&&(J=Rn(h[0])).Index&&(ie=+J.Index-1),X=0,++ie):((J=Rn(h[0])).Index&&(ie=+J.Index-1),Jt={},J.AutoFitHeight!="0"&&!J.Height||(Jt.hpx=parseInt(J.Height,10),Jt.hpt=uc(Jt.hpx),Yt[ie]=Jt),J.Hidden=="1"&&(Jt.hidden=!0,Yt[ie]=Jt));break;case"worksheet":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"));_.push(q),le.s.r<=le.e.r&&le.s.c<=le.e.c&&(R["!ref"]=Ss(le),u.sheetRows&&u.sheetRows<=le.e.r&&(R["!fullref"]=R["!ref"],le.e.r=u.sheetRows-1,R["!ref"]=Ss(le))),pt.length&&(R["!merges"]=pt),0<Mt.length&&(R["!cols"]=Mt),0<Yt.length&&(R["!rows"]=Yt),T[q]=R}else le={s:{r:2e6,c:2e6},e:{r:0,c:0}},ie=X=0,k.push([h[3],!1]),j=Rn(h[0]),q=ys(j.Name),R=u.dense?[]:{},pt=[],wt=[],Yt=[],St={name:q,Hidden:0},Wt.Sheets.push(St);break;case"table":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else{if(h[0].slice(-2)=="/>")break;k.push([h[3],!1]),Dt=!(Mt=[])}break;case"style":h[1]==="/"?(Hs=Ae,Is=Ve,(tr=u).cellStyles&&(!Is.Interior||(tr=Is.Interior).Pattern&&(tr.patternType=Wm[tr.Pattern]||tr.Pattern)),Hs[Is.ID]=Is):Ve=Rn(h[0]);break;case"numberformat":Ve.nf=ys(Rn(h[0]).Format||"General"),jn[Ve.nf]&&(Ve.nf=jn[Ve.nf]);for(var qs=0;qs!=392&&V[qs]!=Ve.nf;++qs);if(qs==392){for(qs=57;qs!=392;++qs)if(V[qs]==null){Br(Ve.nf,qs);break}}break;case"column":if(k[k.length-1][0]!=="table")break;if((E=Rn(h[0])).Hidden&&(E.hidden=!0,delete E.Hidden),E.Width&&(E.wpx=parseInt(E.Width,10)),!Dt&&10<E.wpx){Dt=!0,Zr=Uh;for(var fa=0;fa<Mt.length;++fa)Mt[fa]&&El(Mt[fa])}Dt&&El(E),Mt[E.Index-1||Mt.length]=E;for(var Pn=0;Pn<+E.Span;++Pn)Mt[Mt.length]=Ys(E);break;case"namedrange":if(h[1]==="/")break;Wt.Names||(Wt.Names=[]);var ge=gs(h[0]),it={Name:ge.Name,Ref:bo(ge.RefersTo.slice(1),{r:0,c:0})};0<Wt.Sheets.length&&(it.Sheet=Wt.Sheets.length-1),Wt.Names.push(it);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":if(h[0].slice(-2)==="/>")break;h[1]==="/"?Oe+=g.slice(Je,h.index):Je=h.index+h[0].length;break;case"interior":if(!u.cellStyles)break;Ve.Interior=Rn(h[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(h[0].slice(-2)==="/>")break;h[1]==="/"?(Is=xt,ge=Ir,it=g.slice(Ct,h.index),Is[ge=(ao=ao||$n(wl))[ge]||ge]=it):Ct=h.index+h[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else k.push([h[3],!1]);break;case"comment":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"));(xs=Ft).t=xs.v||"",xs.t=xs.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),xs.v=xs.w=xs.ixfe=void 0,Ut.push(Ft)}else k.push([h[3],!1]),Ft={a:(j=Rn(h[0])).Author};break;case"autofilter":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&(xs=Rn(h[0]),R["!autofilter"]={ref:bo(xs.Range).replace(/\$/g,"")},k.push([h[3],!0]));break;case"name":break;case"datavalidation":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break;case"null":break;default:if(k.length==0&&h[3]=="document"||k.length==0&&h[3]=="uof")return Cu(g,u);var Ee=!0;switch(k[k.length-1][0]){case"officedocumentsettings":switch(h[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Ee=!1}break;case"componentoptions":switch(h[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Ee=!1}break;case"excelworkbook":switch(h[3]){case"date1904":Wt.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Ee=!1}break;case"workbookoptions":switch(h[3]){case"owcversion":case"height":case"width":break;default:Ee=!1}break;case"worksheetoptions":switch(h[3]){case"visible":if(h[0].slice(-2)!=="/>")if(h[1]==="/")switch(g.slice(Ct,h.index)){case"SheetHidden":St.Hidden=1;break;case"SheetVeryHidden":St.Hidden=2}else Ct=h.index+h[0].length;break;case"header":R["!margins"]||Ni(R["!margins"]={},"xlml"),isNaN(+gs(h[0]).Margin)||(R["!margins"].header=+gs(h[0]).Margin);break;case"footer":R["!margins"]||Ni(R["!margins"]={},"xlml"),isNaN(+gs(h[0]).Margin)||(R["!margins"].footer=+gs(h[0]).Margin);break;case"pagemargins":var rt=gs(h[0]);R["!margins"]||Ni(R["!margins"]={},"xlml"),isNaN(+rt.Top)||(R["!margins"].top=+rt.Top),isNaN(+rt.Left)||(R["!margins"].left=+rt.Left),isNaN(+rt.Right)||(R["!margins"].right=+rt.Right),isNaN(+rt.Bottom)||(R["!margins"].bottom=+rt.Bottom);break;case"displayrighttoleft":Wt.Views||(Wt.Views=[]),Wt.Views[0]||(Wt.Views[0]={}),Wt.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":break;case"nosummaryrowsbelowdetail":R["!outline"]||(R["!outline"]={}),R["!outline"].above=!0;break;case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":R["!outline"]||(R["!outline"]={}),R["!outline"].left=!0;break;case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:Ee=!1}break;case"pivottable":case"pivotcache":switch(h[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Ee=!1}break;case"pagebreaks":switch(h[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Ee=!1}break;case"autofilter":switch(h[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Ee=!1}break;case"querytable":switch(h[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Ee=!1}break;case"datavalidation":switch(h[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Ee=!1}break;case"sorting":case"conditionalformatting":switch(h[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Ee=!1}break;case"mapinfo":case"schema":case"data":switch(h[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Ee=!1}break;case"smarttags":break;default:Ee=!1}if(Ee||h[3].match(/!\[CDATA/))break;if(!k[k.length-1][1])throw"Unrecognized tag: "+h[3]+"|"+k.join("|");if(k[k.length-1][0]==="customdocumentproperties"){if(h[0].slice(-2)==="/>")break;h[1]==="/"?(function(Ce,jt,Ze,ot){var Qe=ot;switch((Ze[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":Qe=hr(ot);break;case"i2":case"int":Qe=parseInt(ot,10);break;case"r4":case"float":Qe=parseFloat(ot);break;case"date":case"dateTime.tz":Qe=Ts(ot);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+Ze[0])}Ce[ys(jt)]=Qe})(at,Ir,Vt,g.slice(Ct,h.index)):Ct=(Vt=h).index+h[0].length;break}if(u.WTF)throw"Unrecognized tag: "+h[3]+"|"+k.join("|")}return y={},u.bookSheets||u.bookProps||(y.Sheets=T),y.SheetNames=_,y.Workbook=Wt,y.SSF=Ys(V),y.Props=xt,y.Custprops=at,y}function qa(r,d){switch(Ef(d=d||{}),d.type||"base64"){case"base64":return Od(Ne(r),d);case"binary":case"buffer":case"file":return Od(r,d);case"array":return Od(be(r),d)}}function vg(r,d){var u,h,g,b,x,y,j,k=[];return r.Props&&k.push((u=r.Props,h=d,g=[],wr(wl).map(function(E){for(var T=0;T<Lr.length;++T)if(Lr[T][1]==E)return Lr[T];for(T=0;T<fn.length;++T)if(fn[T][1]==E)return fn[T];throw E}).forEach(function(E){var T;u[E[1]]!=null&&(T=(h&&h.Props&&h.Props[E[1]]!=null?h.Props:u)[E[1]],typeof(T=E[2]==="date"?new Date(T).toISOString().replace(/\.\d*Z/,"Z"):T)=="number"?T=String(T):T===!0||T===!1?T=T?"1":"0":T instanceof Date&&(T=new Date(T).toISOString().replace(/\.\d*Z/,"")),g.push(_s(wl[E[1]]||E[1],T)))}),kt("DocumentProperties",g.join(""),{xmlns:Cr.o}))),r.Custprops&&k.push((b=r.Props,x=r.Custprops,y=["Worksheets","SheetNames"],r="CustomDocumentProperties",j=[],b&&wr(b).forEach(function(E){if(Object.prototype.hasOwnProperty.call(b,E)){for(var T=0;T<Lr.length;++T)if(E==Lr[T][1])return;for(T=0;T<fn.length;++T)if(E==fn[T][1])return;for(T=0;T<y.length;++T)if(E==y[T])return;var _="string",R=typeof(R=b[E])=="number"?(_="float",String(R)):R===!0||R===!1?(_="boolean",R?"1":"0"):String(R);j.push(kt(mi(E),R,{"dt:dt":_}))}}),x&&wr(x).forEach(function(E){var T,_;Object.prototype.hasOwnProperty.call(x,E)&&(b&&Object.prototype.hasOwnProperty.call(b,E)||(T="string",_=typeof(_=x[E])=="number"?(T="float",String(_)):_===!0||_===!1?(T="boolean",_?"1":"0"):_ instanceof Date?(T="dateTime.tz",_.toISOString()):String(_),j.push(kt(mi(E),_,{"dt:dt":T}))))}),"<"+r+' xmlns="'+Cr.o+'">'+j.join("")+"</"+r+">")),k.join("")}function Ya(r){return kt("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+au(r.Ref,{r:0,c:0})})}function wg(r,d,u,h,g,b,x){if(!r||r.v==null&&r.f==null)return"";var y={};if(r.f&&(y["ss:Formula"]="="+Gs(au(r.f,x))),r.F&&r.F.slice(0,d.length)==d&&(d=Hr(r.F.slice(d.length+1)),y["ss:ArrayRange"]="RC:R"+(d.r==x.r?"":"["+(d.r-x.r)+"]")+"C"+(d.c==x.c?"":"["+(d.c-x.c)+"]")),r.l&&r.l.Target&&(y["ss:HRef"]=Gs(r.l.Target),r.l.Tooltip&&(y["x:HRefScreenTip"]=Gs(r.l.Tooltip))),u["!merges"])for(var j=u["!merges"],k=0;k!=j.length;++k)j[k].s.c==x.c&&j[k].s.r==x.r&&(j[k].e.c>j[k].s.c&&(y["ss:MergeAcross"]=j[k].e.c-j[k].s.c),j[k].e.r>j[k].s.r&&(y["ss:MergeDown"]=j[k].e.r-j[k].s.r));var E="",T="";switch(r.t){case"z":if(!h.sheetStubs)return"";break;case"n":E="Number",T=String(r.v);break;case"b":E="Boolean",T=r.v?"1":"0";break;case"e":E="Error",T=Qn[r.v];break;case"d":E="DateTime",T=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||V[14]);break;case"s":E="String",T=((r.v||"")+"").replace(fi,function(_){return Yn[_]}).replace(Ho,function(_){return"&#x"+_.charCodeAt(0).toString(16).toUpperCase()+";"})}return u=Ji(h.cellXfs,r,h),y["ss:StyleID"]="s"+(21+u),y["ss:Index"]=x.c+1,u=r.v!=null?T:"",u=r.t=="z"?"":'<Data ss:Type="'+E+'">'+u+"</Data>",0<(r.c||[]).length&&(u+=r.c.map(function(_){var R=kt("ss:Data",(_.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return kt("Comment",R,{"ss:Author":_.a})}).join("")),kt("Cell",u,y)}function jg(r,d){if(!r["!ref"])return"";var u=Ls(r["!ref"]),h=r["!merges"]||[],g=0,b=[];r["!cols"]&&r["!cols"].forEach(function(J,ie){El(J);var z=!!J.width,X=yc(ie,J),ie={"ss:Index":ie+1};z&&(ie["ss:Width"]=dc(X.width)),J.hidden&&(ie["ss:Hidden"]="1"),b.push(kt("Column",null,ie))});for(var x,y,j=Array.isArray(r),k=u.s.r;k<=u.e.r;++k){for(var E=[(x=k,y=(r["!rows"]||[])[k],x='<Row ss:Index="'+(x+1)+'"',y&&(y.hpt&&!y.hpx&&(y.hpx=xo(y.hpt)),y.hpx&&(x+=' ss:AutoFitHeight="0" ss:Height="'+y.hpx+'"'),y.hidden&&(x+=' ss:Hidden="1"')),x+">")],T=u.s.c;T<=u.e.c;++T){for(var _,R,q,I=!1,g=0;g!=h.length;++g)if(!(h[g].s.c>T||h[g].s.r>k||h[g].e.c<T||h[g].e.r<k)){h[g].s.c==T&&h[g].s.r==k||(I=!0);break}I||(R=vs(_={r:k,c:T}),q=j?(r[k]||[])[T]:r[R],E.push(wg(q,R,r,d,0,0,_)))}E.push("</Row>"),2<E.length&&b.push(E.join(""))}return b.join("")}function e1(r,d,u){var h=[],b=u.SheetNames[r],g=u.Sheets[b],b=g?(function(x,y,j){if(!x||!((j||{}).Workbook||{}).Names)return"";for(var k=j.Workbook.Names,E=[],T=0;T<k.length;++T){var _=k[T];_.Sheet==y&&(_.Name.match(/^_xlfn\./)||E.push(Ya(_)))}return E.join("")})(g,r,u):"";return 0<b.length&&h.push("<Names>"+b+"</Names>"),0<(b=g?jg(g,d):"").length&&h.push("<Table>"+b+"</Table>"),h.push((function(x,y,j){if(!x)return"";var k=[];if(x["!margins"]&&(k.push("<PageSetup>"),x["!margins"].header&&k.push(kt("Header",null,{"x:Margin":x["!margins"].header})),x["!margins"].footer&&k.push(kt("Footer",null,{"x:Margin":x["!margins"].footer})),k.push(kt("PageMargins",null,{"x:Bottom":x["!margins"].bottom||"0.75","x:Left":x["!margins"].left||"0.7","x:Right":x["!margins"].right||"0.7","x:Top":x["!margins"].top||"0.75"})),k.push("</PageSetup>")),j&&j.Workbook&&j.Workbook.Sheets&&j.Workbook.Sheets[y])if(j.Workbook.Sheets[y].Hidden)k.push(kt("Visible",j.Workbook.Sheets[y].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var E=0;E<y&&(!j.Workbook.Sheets[E]||j.Workbook.Sheets[E].Hidden);++E);E==y&&k.push("<Selected/>")}return((((j||{}).Workbook||{}).Views||[])[0]||{}).RTL&&k.push("<DisplayRightToLeft/>"),x["!protect"]&&(k.push(_s("ProtectContents","True")),x["!protect"].objects&&k.push(_s("ProtectObjects","True")),x["!protect"].scenarios&&k.push(_s("ProtectScenarios","True")),x["!protect"].selectLockedCells==null||x["!protect"].selectLockedCells?x["!protect"].selectUnlockedCells==null||x["!protect"].selectUnlockedCells||k.push(_s("EnableSelection","UnlockedCells")):k.push(_s("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(T){x["!protect"][T[0]]&&k.push("<"+T[1]+"/>")})),k.length==0?"":kt("WorksheetOptions",k.join(""),{xmlns:Cr.x})})(g,r,u)),h.join("")}function Ol(r,d){d=d||{},r.SSF||(r.SSF=Ys(V)),r.SSF&&(ql(),Bo(r.SSF),d.revssf=Fi(r.SSF),d.revssf[r.SSF[65535]]=0,d.ssf=r.SSF,d.cellXfs=[],Ji(d.cellXfs,{},{revssf:{General:0}}));var u=[];u.push(vg(r,d)),u.push(""),u.push(""),u.push("");for(var h,g=0;g<r.SheetNames.length;++g)u.push(kt("Worksheet",e1(g,d,r),{"ss:Name":Gs(r.SheetNames[g])}));return u[2]=(h=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],d.cellXfs.forEach(function(b,x){var y=[];y.push(kt("NumberFormat",null,{"ss:Format":Gs(V[b.numFmtId])})),x={"ss:ID":"s"+(21+x)},h.push(kt("Style",y.join(""),x))}),kt("Styles",h.join(""))),u[3]=(function(b){if(!((b||{}).Workbook||{}).Names)return"";for(var x=b.Workbook.Names,y=[],j=0;j<x.length;++j){var k=x[j];k.Sheet==null&&(k.Name.match(/^_xlfn\./)||y.push(Ya(k)))}return kt("Names",y.join(""))})(r),kr+kt("Workbook",u.join(""),{xmlns:Cr.ss,"xmlns:o":Cr.o,"xmlns:x":Cr.x,"xmlns:ss":Cr.ss,"xmlns:dt":Cr.dt,"xmlns:html":Cr.html})}function wu(r){var d={},u=r.content;return u.l=28,d.AnsiUserType=u.read_shift(0,"lpstr-ansi"),d.AnsiClipboardFormat=j0(u,1),u.length-u.l<=4?d:(r=u.read_shift(4),r==0||40<r?d:(u.l-=4,d.Reserved1=u.read_shift(0,"lpstr-ansi"),u.length-u.l<=4||(r=u.read_shift(4))!==1907505652?d:(d.UnicodeClipboardFormat=j0(u,2),(r=u.read_shift(4))==0||40<r?d:(u.l-=4,void(d.Reserved2=u.read_shift(0,"lpwstr"))))))}var yf=[60,1084,2066,2165,2175];function Ga(r,d,u){if(r.t!=="z"&&r.XF){var h,g=0;try{g=r.z||r.XF.numFmtId||0,d.cellNF&&(r.z=V[g])}catch(b){if(d.WTF)throw b}if(!d||d.cellText!==!1)try{r.t==="e"?r.w=r.w||Qn[r.v]:g===0||g=="General"?r.t==="n"?(0|r.v)===r.v?r.w=r.v.toString(10):r.w=vt(r.v):r.w=Pe(r.v):r.w=Er(g,r.v,{date1904:!!u,dateNF:d&&d.dateNF})}catch(b){if(d.WTF)throw b}d.cellDates&&g&&r.t=="n"&&rr(V[g]||String(g))&&(h=de(r.v))&&(r.t="d",r.v=new Date(h.y,h.m-1,h.d,h.H,h.M,h.S,h.u))}}function Pd(r,d,u){return{v:r,ixfe:d,t:u}}function Ng(r,d){var u={opts:{}},h={};function g(Qe){return!(Qe<8)&&Qe<64&&Ae[Qe-8]||Xo[Qe]}function b(Qe,ft,At){if(!(1<Dt||At.sheetRows&&Qe.r>=At.sheetRows)){var Kt,Gt,Bt;if(At.cellStyles&&ft.XF&&ft.XF.data&&(Gt=At,(Bt=(Kt=ft).XF.data)&&Bt.patternType&&Gt&&Gt.cellStyles&&(Kt.s={},Kt.s.patternType=Bt.patternType,(Gt=cc(g(Bt.icvFore)))&&(Kt.s.fgColor={rgb:Gt}),(Gt=cc(g(Bt.icvBack)))&&(Kt.s.bgColor={rgb:Gt}))),delete ft.ixfe,delete ft.XF,z=vs(x=Qe),R&&R.s&&R.e||(R={s:{r:0,c:0},e:{r:0,c:0}}),Qe.r<R.s.r&&(R.s.r=Qe.r),Qe.c<R.s.c&&(R.s.c=Qe.c),Qe.r+1>R.e.r&&(R.e.r=Qe.r+1),Qe.c+1>R.e.c&&(R.e.c=Qe.c+1),At.cellFormula&&ft.f){for(var Qt=0;Qt<ie.length;++Qt)if(!(ie[Qt][0].s.c>Qe.c||ie[Qt][0].s.r>Qe.r||ie[Qt][0].e.c<Qe.c||ie[Qt][0].e.r<Qe.r)){ft.F=Ss(ie[Qt][0]),ie[Qt][0].s.c==Qe.c&&ie[Qt][0].s.r==Qe.r||delete ft.f,ft.f&&(ft.f=""+Ia(ie[Qt][1],0,Qe,Ut,Je));break}}At.dense?(T[Qe.r]||(T[Qe.r]=[]),T[Qe.r][Qe.c]=ft):T[z]=ft}}var x,y,j,k,E,T=d.dense?[]:{},_={},R={},q=null,I=[],J="",Y={},z="",X={},ie=[],le=[],Ae=[],Ve={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Oe={},Je={enc:!1,sbcch:0,snames:[],sharedf:X,arrayf:ie,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!d&&!!d.cellStyles,WTF:!!d&&!!d.wtf};d.password&&(Je.password=d.password);var pt=[],xt=[],at=[],Ct=[],Vt=!1,Ut=[];Ut.SheetNames=Je.snames,Ut.sharedf=Je.sharedf,Ut.arrayf=Je.arrayf,Ut.names=[],Ut.XTI=[];var Ft,Mt=0,Dt=0,wt=0,Yt=[],Jt=[];Je.codepage=1200,D(1200);for(var is=!1;r.l<r.length-1;){var Fs=r.l,Wt=r.read_shift(2);if(Wt===0&&Mt===10)break;var St=r.l===r.length?0:r.read_shift(2),xs=vf[Wt];if(xs&&xs.f){if(d.bookSheets&&Mt===133&&Wt!==133)break;if(Mt=Wt,xs.r===2||xs.r==12){var Hs=r.read_shift(2);if(St-=2,!Je.enc&&Hs!==Wt&&((255&Hs)<<8|Hs>>8)!==Wt)throw new Error("rt mismatch: "+Hs+"!="+Wt);xs.r==12&&(r.l+=10,St-=10)}var Is,tr,Ir,Fe={},Fe=Wt===10?xs.f(r,St,Je):(function(Qe,ft,At,Kt,Gt){var Bt=Kt,Qt=[],rs=At.slice(At.l,At.l+Bt);if(Gt&&Gt.enc&&Gt.enc.insitu&&0<rs.length)switch(Qe){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:Gt.enc.insitu(rs)}Qt.push(rs),At.l+=Bt;for(var ss=Pi(At,At.l),Lt=vf[ss],Et=0;Lt!=null&&-1<yf.indexOf(ss);)Bt=Pi(At,At.l+2),Et=At.l+4,ss==2066?Et+=4:ss!=2165&&ss!=2175||(Et+=12),rs=At.slice(Et,At.l+4+Bt),Qt.push(rs),At.l+=4+Bt,Lt=vf[ss=Pi(At,At.l)];var as=he(Qt);ka(as,0);var $t=0;as.lens=[];for(var _t=0;_t<Qt.length;++_t)as.lens.push($t),$t+=Qt[_t].length;if(as.length<Kt)throw"XLS Record 0x"+Qe.toString(16)+" Truncated: "+as.length+" < "+Kt;return ft.f(as,as.length,Gt)})(Wt,xs,r,St,Je);if(Dt!=0||[9,521,1033,2057].indexOf(Mt)!==-1)switch(Wt){case 34:u.opts.Date1904=Ve.WBProps.date1904=Fe;break;case 134:u.opts.WriteProtect=!0;break;case 47:if(Je.enc||(r.l=0),Je.enc=Fe,!d.password)throw new Error("File is password-protected");if(Fe.valid==null)throw new Error("Encryption scheme unsupported");if(!Fe.valid)throw new Error("Password is incorrect");break;case 92:Je.lastuser=Fe;break;case 66:var sr=Number(Fe);switch(sr){case 21010:sr=1200;break;case 32768:sr=1e4;break;case 32769:sr=1252}D(Je.codepage=sr),is=!0;break;case 317:Je.rrtabid=Fe;break;case 25:Je.winlocked=Fe;break;case 439:u.opts.RefreshAll=Fe;break;case 12:u.opts.CalcCount=Fe;break;case 16:u.opts.CalcDelta=Fe;break;case 17:u.opts.CalcIter=Fe;break;case 13:u.opts.CalcMode=Fe;break;case 14:u.opts.CalcPrecision=Fe;break;case 95:u.opts.CalcSaveRecalc=Fe;break;case 15:Je.CalcRefMode=Fe;break;case 2211:u.opts.FullCalc=Fe;break;case 129:Fe.fDialog&&(T["!type"]="dialog"),Fe.fBelow||((T["!outline"]||(T["!outline"]={})).above=!0),Fe.fRight||((T["!outline"]||(T["!outline"]={})).left=!0);break;case 224:le.push(Fe);break;case 430:Ut.push([Fe]),Ut[Ut.length-1].XTI=[];break;case 35:case 547:Ut[Ut.length-1].push(Fe);break;case 24:case 536:Ft={Name:Fe.Name,Ref:Ia(Fe.rgce,0,null,Ut,Je)},0<Fe.itab&&(Ft.Sheet=Fe.itab-1),Ut.names.push(Ft),Ut[0]||(Ut[0]=[],Ut[0].XTI=[]),Ut[Ut.length-1].push(Fe),Fe.Name=="_xlnm._FilterDatabase"&&0<Fe.itab&&Fe.rgce&&Fe.rgce[0]&&Fe.rgce[0][0]&&Fe.rgce[0][0][0]=="PtgArea3d"&&(Jt[Fe.itab-1]={ref:Ss(Fe.rgce[0][0][1][2])});break;case 22:Je.ExternCount=Fe;break;case 23:Ut.length==0&&(Ut[0]=[],Ut[0].XTI=[]),Ut[Ut.length-1].XTI=Ut[Ut.length-1].XTI.concat(Fe),Ut.XTI=Ut.XTI.concat(Fe);break;case 2196:if(Je.biff<8)break;Ft!=null&&(Ft.Comment=Fe[1]);break;case 18:T["!protect"]=Fe;break;case 19:Fe!==0&&Je.WTF&&console.error("Password verifier: "+Fe);break;case 133:_[Fe.pos]=Fe,Je.snames.push(Fe.name);break;case 10:if(--Dt)break;R.e&&(0<R.e.r&&0<R.e.c&&(R.e.r--,R.e.c--,T["!ref"]=Ss(R),d.sheetRows&&d.sheetRows<=R.e.r&&(qs=R.e.r,R.e.r=d.sheetRows-1,T["!fullref"]=T["!ref"],T["!ref"]=Ss(R),R.e.r=qs),R.e.r++,R.e.c++),0<pt.length&&(T["!merges"]=pt),0<xt.length&&(T["!objects"]=xt),0<at.length&&(T["!cols"]=at),0<Ct.length&&(T["!rows"]=Ct),Ve.Sheets.push(Oe)),J===""?Y=T:h[J]=T,T=d.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(Je.biff===8&&(Je.biff={9:2,521:3,1033:4}[Wt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Fe.BIFFVer]||8),Je.biffguess=Fe.BIFFVer==0,Fe.BIFFVer==0&&Fe.dt==4096&&(Je.biff=5,is=!0,D(Je.codepage=28591)),Je.biff==8&&Fe.BIFFVer==0&&Fe.dt==16&&(Je.biff=2),Dt++)break;var qs,T=d.dense?[]:{};Je.biff<8&&!is&&(is=!0,D(Je.codepage=d.codepage||1252)),Je.biff<5||Fe.BIFFVer==0&&Fe.dt==4096?(J===""&&(J="Sheet1"),R={s:{r:0,c:0},e:{r:0,c:0}},qs={pos:r.l-St,name:J},_[qs.pos]=qs,Je.snames.push(J)):J=(_[Fs]||{name:""}).name,Fe.dt==32&&(T["!type"]="chart"),Fe.dt==64&&(T["!type"]="macro"),pt=[],xt=[],Je.arrayf=ie=[],at=[],Vt=!(Ct=[]),Oe={Hidden:(_[Fs]||{hs:0}).hs,name:J};break;case 515:case 3:case 2:T["!type"]=="chart"&&(d.dense?(T[Fe.r]||[])[Fe.c]:T[vs({c:Fe.c,r:Fe.r})])&&++Fe.c,ge={ixfe:Fe.ixfe,XF:le[Fe.ixfe]||{},v:Fe.val,t:"n"},0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ga(ge,d,u.opts.Date1904),b({c:Fe.c,r:Fe.r},ge,d);break;case 5:case 517:ge={ixfe:Fe.ixfe,XF:le[Fe.ixfe],v:Fe.val,t:Fe.t},0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ga(ge,d,u.opts.Date1904),b({c:Fe.c,r:Fe.r},ge,d);break;case 638:ge={ixfe:Fe.ixfe,XF:le[Fe.ixfe],v:Fe.rknum,t:"n"},0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ga(ge,d,u.opts.Date1904),b({c:Fe.c,r:Fe.r},ge,d);break;case 189:for(var fa=Fe.c;fa<=Fe.C;++fa){var Pn=Fe.rkrec[fa-Fe.c][0],ge={ixfe:Pn,XF:le[Pn],v:Fe.rkrec[fa-Fe.c][1],t:"n"};0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ga(ge,d,u.opts.Date1904),b({c:fa,r:Fe.r},ge,d)}break;case 6:case 518:case 1030:if(Fe.val=="String"){q=Fe;break}(ge=Pd(Fe.val,Fe.cell.ixfe,Fe.tt)).XF=le[ge.ixfe],d.cellFormula&&(!((it=Fe.formula)&&it[0]&&it[0][0]&&it[0][0][0]=="PtgExp")||X[Ir=vs({r:Is=it[0][0][1][0],c:tr=it[0][0][1][1]})]?ge.f=""+Ia(Fe.formula,0,Fe.cell,Ut,Je):ge.F=((d.dense?(T[Is]||[])[tr]:T[Ir])||{}).F),0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ga(ge,d,u.opts.Date1904),b(Fe.cell,ge,d),q=Fe;break;case 7:case 519:if(!q)throw new Error("String record expects Formula");(ge=Pd(q.val=Fe,q.cell.ixfe,"s")).XF=le[ge.ixfe],d.cellFormula&&(ge.f=""+Ia(q.formula,0,q.cell,Ut,Je)),0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ga(ge,d,u.opts.Date1904),b(q.cell,ge,d),q=null;break;case 33:case 545:ie.push(Fe);var it=vs(Fe[0].s),Ee=d.dense?(T[Fe[0].s.r]||[])[Fe[0].s.c]:T[it];if(d.cellFormula&&Ee){if(!q||!it||!Ee)break;Ee.f=""+Ia(Fe[1],0,Fe[0],Ut,Je),Ee.F=Ss(Fe[0])}break;case 1212:if(!d.cellFormula)break;if(z){if(!q)break;X[vs(q.cell)]=Fe[0],((Ee=d.dense?(T[q.cell.r]||[])[q.cell.c]:T[vs(q.cell)])||{}).f=""+Ia(Fe[0],0,x,Ut,Je)}break;case 253:ge=Pd(I[Fe.isst].t,Fe.ixfe,"s"),I[Fe.isst].h&&(ge.h=I[Fe.isst].h),ge.XF=le[ge.ixfe],0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ga(ge,d,u.opts.Date1904),b({c:Fe.c,r:Fe.r},ge,d);break;case 513:d.sheetStubs&&(ge={ixfe:Fe.ixfe,XF:le[Fe.ixfe],t:"z"},0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ga(ge,d,u.opts.Date1904),b({c:Fe.c,r:Fe.r},ge,d));break;case 190:if(d.sheetStubs)for(var rt=Fe.c;rt<=Fe.C;++rt){var Ce=Fe.ixfe[rt-Fe.c];ge={ixfe:Ce,XF:le[Ce],t:"z"},0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ga(ge,d,u.opts.Date1904),b({c:rt,r:Fe.r},ge,d)}break;case 214:case 516:case 4:(ge=Pd(Fe.val,Fe.ixfe,"s")).XF=le[ge.ixfe],0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ga(ge,d,u.opts.Date1904),b({c:Fe.c,r:Fe.r},ge,d);break;case 0:case 512:Dt===1&&(R=Fe);break;case 252:I=Fe;break;case 1054:if(Je.biff==4){Yt[wt++]=Fe[1];for(var jt=0;jt<wt+163&&V[jt]!=Fe[1];++jt);163<=jt&&Br(Fe[1],wt+163)}else Br(Fe[1],Fe[0]);break;case 30:Yt[wt++]=Fe;for(var Ze=0;Ze<wt+163&&V[Ze]!=Fe;++Ze);163<=Ze&&Br(Fe,wt+163);break;case 229:pt=pt.concat(Fe);break;case 93:xt[Fe.cmo[0]]=Je.lastobj=Fe;break;case 438:Je.lastobj.TxO=Fe;break;case 127:Je.lastobj.ImData=Fe;break;case 440:for(j=Fe[0].s.r;j<=Fe[0].e.r;++j)for(y=Fe[0].s.c;y<=Fe[0].e.c;++y)(Ee=d.dense?(T[j]||[])[y]:T[vs({c:y,r:j})])&&(Ee.l=Fe[1]);break;case 2048:for(j=Fe[0].s.r;j<=Fe[0].e.r;++j)for(y=Fe[0].s.c;y<=Fe[0].e.c;++y)(Ee=d.dense?(T[j]||[])[y]:T[vs({c:y,r:j})])&&Ee.l&&(Ee.l.Tooltip=Fe[1]);break;case 28:if(Je.biff<=5&&2<=Je.biff)break;Ee=d.dense?(T[Fe[0].r]||[])[Fe[0].c]:T[vs(Fe[0])];var ot=xt[Fe[2]];Ee||(Ee=d.dense?(T[Fe[0].r]||(T[Fe[0].r]=[]),T[Fe[0].r][Fe[0].c]={t:"z"}):T[vs(Fe[0])]={t:"z"},R.e.r=Math.max(R.e.r,Fe[0].r),R.s.r=Math.min(R.s.r,Fe[0].r),R.e.c=Math.max(R.e.c,Fe[0].c),R.s.c=Math.min(R.s.c,Fe[0].c)),Ee.c||(Ee.c=[]),ot={a:Fe[1],t:ot.TxO.t},Ee.c.push(ot);break;case 2173:le[Fe.ixfe],Fe.ext.forEach(function(ft){ft[0]});break;case 125:if(!Je.cellStyles)break;for(;Fe.e>=Fe.s;)at[Fe.e--]={width:Fe.w/256,level:Fe.level||0,hidden:!!(1&Fe.flags)},Vt||(Vt=!0,vd(Fe.w/256)),El(at[Fe.e+1]);break;case 520:ot={},Fe.level!=null&&((Ct[Fe.r]=ot).level=Fe.level),Fe.hidden&&((Ct[Fe.r]=ot).hidden=!0),Fe.hpt&&((Ct[Fe.r]=ot).hpt=Fe.hpt,ot.hpx=xo(Fe.hpt));break;case 38:case 39:case 40:case 41:T["!margins"]||Ni(T["!margins"]={}),T["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Wt]]=Fe;break;case 161:T["!margins"]||Ni(T["!margins"]={}),T["!margins"].header=Fe.header,T["!margins"].footer=Fe.footer;break;case 574:Fe.RTL&&(Ve.Views[0].RTL=!0);break;case 146:Ae=Fe;break;case 2198:E=Fe;break;case 140:k=Fe;break;case 442:J?Oe.CodeName=Fe||Oe.name:Ve.WBProps.CodeName=Fe||"ThisWorkbook"}}else xs||console.error("Missing Info for XLS Record 0x"+Wt.toString(16)),r.l+=St}return u.SheetNames=wr(_).sort(function(Qe,ft){return Number(Qe)-Number(ft)}).map(function(Qe){return _[Qe].name}),d.bookSheets||(u.Sheets=h),!u.SheetNames.length&&Y["!ref"]?(u.SheetNames.push("Sheet1"),u.Sheets&&(u.Sheets.Sheet1=Y)):u.Preamble=Y,u.Sheets&&Jt.forEach(function(Qe,ft){u.Sheets[u.SheetNames[ft]]["!autofilter"]=Qe}),u.Strings=I,u.SSF=Ys(V),Je.enc&&(u.Encryption=Je.enc),E&&(u.Themes=E),u.Metadata={},k!==void 0&&(u.Metadata.Country=k),0<Ut.names.length&&(Ve.Names=Ut.names),u.Workbook=Ve,u}var Cc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Id(r,d){var u,h,g,b,x;if(Ef(d=d||{}),L(),d.codepage&&S(d.codepage),r.FullPaths){if(Zt.find(r,"/encryption"))throw new Error("File is password-protected");u=Zt.find(r,"!CompObj"),g=Zt.find(r,"/Workbook")||Zt.find(r,"/Book")}else{switch(d.type){case"base64":r=ue(Ne(r));break;case"binary":r=ue(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r))}ka(r,0),g={content:r}}if(u&&wu(u),d.bookProps&&!d.bookSheets)h={};else{var y=xe?"buffer":"array";if(g&&g.content)h=Ng(g.content,d);else if((g=Zt.find(r,"PerfectOffice_MAIN"))&&g.content)h=ua.to_workbook(g.content,(d.type=y,d));else{if(!(g=Zt.find(r,"NativeContent_MAIN"))||!g.content)throw(g=Zt.find(r,"MN0"))&&g.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");h=ua.to_workbook(g.content,(d.type=y,d))}d.bookVBA&&r.FullPaths&&Zt.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(h.vbaraw=(b=r,x=Zt.utils.cfb_new({root:"R"}),b.FullPaths.forEach(function(j,k){j.slice(-1)!=="/"&&j.match(/_VBA_PROJECT_CUR/)&&(j=j.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),Zt.utils.cfb_add(x,j,b.FileIndex[k].content))}),Zt.write(x)))}return y={},r.FullPaths&&(function(j,k,E){var T=Zt.find(j,"/!DocumentSummaryInformation");if(T&&0<T.size)try{var _,R=Sr(T,xh,Cc.DSI);for(_ in R)k[_]=R[_]}catch(Y){if(E.WTF)throw Y}var q=Zt.find(j,"/!SummaryInformation");if(q&&0<q.size)try{var I,J=Sr(q,bh,Cc.SI);for(I in J)k[I]==null&&(k[I]=J[I])}catch(Y){if(E.WTF)throw Y}k.HeadingPairs&&k.TitlesOfParts&&(vh(k.HeadingPairs,k.TitlesOfParts,k,E),delete k.HeadingPairs,delete k.TitlesOfParts)})(r,y,d),h.Props=h.Custprops=y,d.bookFiles&&(h.cfb=r),h}function ju(r,b){var u,h,g=b||{},b=Zt.utils.cfb_new({root:"R"}),x="/Workbook";switch(g.bookType||"xls"){case"xls":g.bookType="biff8";case"xla":g.bookType||(g.bookType="xla");case"biff8":x="/Workbook",g.biff=8;break;case"biff5":x="/Book",g.biff=5;break;default:throw new Error("invalid type "+g.bookType+" for XLS CFB")}return Zt.utils.cfb_add(b,x,wf(r,g)),g.biff==8&&(r.Props||r.Custprops)&&(function(y,j){var k,E=[],T=[],_=[],R=0,q=Yc(xh,"n"),I=Yc(bh,"n");if(y.Props)for(k=wr(y.Props),R=0;R<k.length;++R)(Object.prototype.hasOwnProperty.call(q,k[R])?E:Object.prototype.hasOwnProperty.call(I,k[R])?T:_).push([k[R],y.Props[k[R]]]);if(y.Custprops)for(k=wr(y.Custprops),R=0;R<k.length;++R)Object.prototype.hasOwnProperty.call(y.Props||{},k[R])||(Object.prototype.hasOwnProperty.call(q,k[R])?E:Object.prototype.hasOwnProperty.call(I,k[R])?T:_).push([k[R],y.Custprops[k[R]]]);for(var J=[],R=0;R<_.length;++R)-1<wh.indexOf(_[R][0])||-1<A0.indexOf(_[R][0])||_[R][1]!=null&&J.push(_[R]);T.length&&Zt.utils.cfb_add(j,"/SummaryInformation",Vs(T,Cc.SI,I,bh)),(E.length||J.length)&&Zt.utils.cfb_add(j,"/DocumentSummaryInformation",Vs(E,Cc.DSI,q,xh,J.length?J:null,Cc.UDI))})(r,b),g.biff==8&&r.vbaraw&&(u=b,(h=Zt.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})).FullPaths.forEach(function(y,j){j==0||(y=y.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)!=="/"&&Zt.utils.cfb_add(u,y,h.FileIndex[j].content)})),b}var No={0:{f:function(r,d){var u={},h=r.l+d;u.r=r.read_shift(4),r.l+=4;var g=r.read_shift(2);return r.l+=1,d=r.read_shift(1),r.l=h,7&d&&(u.level=7&d),16&d&&(u.hidden=!0),32&d&&(u.hpt=g/20),u}},1:{f:function(r){return[En(r)]}},2:{f:function(r){return[En(r),mh(r),"n"]}},3:{f:function(r){return[En(r),r.read_shift(1),"e"]}},4:{f:function(r){return[En(r),r.read_shift(1),"b"]}},5:{f:function(r){return[En(r),Ca(r),"n"]}},6:{f:function(r){return[En(r),pa(r),"str"]}},7:{f:function(r){return[En(r),r.read_shift(4),"s"]}},8:{f:function(r,d,u){var h=r.l+d,g=En(r);g.r=u["!row"];var b=[g,pa(r),"str"];return u.cellFormula?(r.l+=2,d=cu(r,h-r.l,u),b[3]=Ia(d,0,g,u.supbooks,u)):r.l=h,b}},9:{f:function(r,d,u){var h=r.l+d,g=En(r);g.r=u["!row"];var b=[g,Ca(r),"n"];return u.cellFormula?(r.l+=2,d=cu(r,h-r.l,u),b[3]=Ia(d,0,g,u.supbooks,u)):r.l=h,b}},10:{f:function(r,d,u){var h=r.l+d,g=En(r);g.r=u["!row"];var b=[g,r.read_shift(1),"b"];return u.cellFormula?(r.l+=2,d=cu(r,h-r.l,u),b[3]=Ia(d,0,g,u.supbooks,u)):r.l=h,b}},11:{f:function(r,d,u){var h=r.l+d,g=En(r);g.r=u["!row"];var b=[g,r.read_shift(1),"e"];return u.cellFormula?(r.l+=2,d=cu(r,h-r.l,u),b[3]=Ia(d,0,g,u.supbooks,u)):r.l=h,b}},12:{f:function(r){return[Zl(r)]}},13:{f:function(r){return[Zl(r),mh(r),"n"]}},14:{f:function(r){return[Zl(r),r.read_shift(1),"e"]}},15:{f:function(r){return[Zl(r),r.read_shift(1),"b"]}},16:{f:wc},17:{f:function(r){return[Zl(r),pa(r),"str"]}},18:{f:function(r){return[Zl(r),r.read_shift(4),"s"]}},19:{f:b0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(r,x,y){var h=r.l+x;r.l+=4,r.l+=1;var g=r.read_shift(4),b=km(r),x=cg(r,0,y),y=y0(r);return r.l=h,x={Name:b,Ptg:x},g<268435455&&(x.Sheet=g),y&&(x.Comment=y),x}},40:{},42:{},43:{f:function(r,d,u){var h={};h.sz=r.read_shift(2)/20;var g,b=(b=(g=r).read_shift(1),g.l++,{fBold:1&b,fItalic:2&b,fUnderline:4&b,fStrikeout:8&b,fOutline:16&b,fShadow:32&b,fCondense:64&b,fExtend:128&b});switch(b.fItalic&&(h.italic=1),b.fCondense&&(h.condense=1),b.fExtend&&(h.extend=1),b.fShadow&&(h.shadow=1),b.fOutline&&(h.outline=1),b.fStrikeout&&(h.strike=1),r.read_shift(2)===700&&(h.bold=1),r.read_shift(2)){case 1:h.vertAlign="superscript";break;case 2:h.vertAlign="subscript"}switch((b=r.read_shift(1))!=0&&(h.underline=b),0<(b=r.read_shift(1))&&(h.family=b),0<(b=r.read_shift(1))&&(h.charset=b),r.l++,h.color=(function(x){var y={},j=x.read_shift(1)>>>1,k=x.read_shift(1),E=x.read_shift(2,"i"),T=x.read_shift(1),_=x.read_shift(1),R=x.read_shift(1);switch(x.l++,j){case 0:y.auto=1;break;case 1:y.index=k;var q=Xo[k];q&&(y.rgb=cc(q));break;case 2:y.rgb=cc([T,_,R]);break;case 3:y.theme=k}return E!=0&&(y.tint=0<E?E/32767:E/32768),y})(r),r.read_shift(1)){case 1:h.scheme="major";break;case 2:h.scheme="minor"}return h.name=pa(r),h}},44:{f:function(r,d){return[r.read_shift(2),pa(r)]}},45:{f:Ym},46:{f:ul},47:{f:function(r,g){var u=r.l+g,h=r.read_shift(2),g=r.read_shift(2);return r.l=u,{ixfe:h,numFmtId:g}}},48:{},49:{f:function(r){return r.read_shift(4,"i")}},50:{},51:{f:function(r){for(var d=[],u=r.read_shift(4);0<u--;)d.push([r.read_shift(4),r.read_shift(4)]);return d}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:R0},62:{f:function(r){return[En(r),b0(r),"is"]}},63:{f:function(r){var d={};d.i=r.read_shift(4);var u={};return u.r=r.read_shift(4),u.c=r.read_shift(4),d.r=vs(u),2&(r=r.read_shift(1))&&(d.l="1"),8&r&&(d.a="1"),d}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:La,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(r){var d=r.read_shift(2);return r.l+=28,{RTL:32&d}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(r,d){var u={},h=r[r.l];return++r.l,u.above=!(64&h),u.left=!(128&h),r.l+=18,u.name=hn(r),u}},148:{f:Fd,p:16},151:{f:function(){}},152:{},153:{f:function(r,d){var u={},h=r.read_shift(4);return u.defaultThemeVersion=r.read_shift(4),0<(r=8<d?pa(r):"").length&&(u.CodeName=r),u.autoCompressPictures=!!(65536&h),u.backupFile=!!(64&h),u.checkCompatibility=!!(4096&h),u.date1904=!!(1&h),u.filterPrivacy=!!(8&h),u.hidePivotFieldList=!!(1024&h),u.promptedSolutions=!!(16&h),u.publishItems=!!(2048&h),u.refreshAllConnections=!!(262144&h),u.saveExternalLinkValues=!!(128&h),u.showBorderUnselectedTables=!!(4&h),u.showInkAnnotation=!!(32&h),u.showObjects=["all","placeholders","none"][h>>13&3],u.showPivotChartFilter=!!(32768&h),u.updateLinks=["userSet","never","always"][h>>8&3],u}},154:{},155:{},156:{f:function(r,d){var u={};return u.Hidden=r.read_shift(4),u.iTabID=r.read_shift(4),u.strRelID=v0(r),u.name=pa(r),u}},157:{},158:{},159:{T:1,f:function(r){return[r.read_shift(4),r.read_shift(4)]}},160:{T:-1},161:{T:1,f:Kn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Si},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(r,d){return{flags:r.read_shift(4),version:r.read_shift(4),name:pa(r)}}},336:{T:-1},337:{f:function(r){return r.l+=4,r.read_shift(4)!=0},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:v0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:L0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(r,b,u){var h=r.l+b,g=w0(r),b=r.read_shift(1);return(g=[g])[2]=b,u.cellFormula?(u=Kp(r,h-r.l,u),g[1]=u):r.l=h,g}},427:{f:function(r,g,u){var h=r.l+g,g=[Kn(r)];return u.cellFormula&&(u=Td(r,h-r.l,u),g[1]=u),r.l=h,g}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(r){var d={};return xf.forEach(function(u){d[u]=Ca(r)}),d}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(r,y){var u=r.l+y,h=Kn(r),g=y0(r),b=pa(r),x=pa(r),y=pa(r);return r.l=u,y={rfx:h,relId:g,loc:b,display:y},x&&(y.Tooltip=x),y}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:v0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$r},633:{T:1},634:{T:-1},635:{T:1,f:function(r){var d={};d.iauthor=r.read_shift(4);var u=Kn(r);return d.rfx=u.s,d.ref=vs(u.s),r.l+=16,d}},636:{T:-1},637:{f:Nm},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(r,d){return r.l+=10,{name:pa(r)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},vf={6:{f:gc},10:{f:Ua},12:{f:xr},13:{f:xr},14:{f:er},15:{f:er},16:{f:Ca},17:{f:er},18:{f:er},19:{f:xr},20:{f:kh},21:{f:kh},23:{f:L0},24:{f:kl},25:{f:er},26:{},27:{},28:{f:function(r,d,u){return(function(h,g){if(!(g.biff<8)){var b=h.read_shift(2),x=h.read_shift(2),y=h.read_shift(2),j=h.read_shift(2),k=Vi(h,0,g);return g.biff<8&&h.read_shift(1),[{r:b,c:x},k,j,y]}})(r,u)}},29:{},34:{f:er},35:{f:Fm},38:{f:Ca},39:{f:Ca},40:{f:Ca},41:{f:Ca},42:{f:er},43:{f:er},47:{f:function(r,d,u){var h={Type:8<=u.biff?r.read_shift(2):0};return h.Type?Hm(r,d-2,h):(d=r,u.biff,r=u,u=h,d={key:xr(d),verificationBytes:xr(d)},r.password&&(d.verifier=Y0(r.password)),u.valid=d.verificationBytes===d.verifier,u.valid&&(u.insitu=Um(r.password))),h}},49:{f:function(r,d,u){var h={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(u&&u.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10}return h.name=Jn(r,0,u),h}},51:{f:xr},60:{},61:{f:function(r){return{Pos:[r.read_shift(2),r.read_shift(2)],Dim:[r.read_shift(2),r.read_shift(2)],Flags:r.read_shift(2),CurTab:r.read_shift(2),FirstTab:r.read_shift(2),Selected:r.read_shift(2),TabRatio:r.read_shift(2)}}},64:{f:er},65:{f:function(){}},66:{f:xr},77:{},80:{},81:{},82:{},85:{f:xr},89:{},90:{},91:{},92:{f:function(r,d,g){if(g.enc)return r.l+=d,"";var h=r.l,g=Vi(r,0,g);return r.read_shift(d+h-r.l),g}},93:{f:function(r,d,u){return u&&u.biff<8?(function(h,g,b){h.l+=4;var x=h.read_shift(2),y=h.read_shift(2),j=h.read_shift(2);h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=6,g-=36;var k=[];return k.push((Lm[x]||La)(h,g,b)),{cmo:[y,x,j],ft:k}})(r,d,u):{cmo:u=Tm(r),ft:(function(h,g){for(var b=h.l+g,x=[];h.l<b;){var y=h.read_shift(2);h.l-=2;try{x.push(aa[y](h,b-h.l))}catch{return h.l=b,x}}return h.l!=b&&(h.l=b),x})(r,d-22,u[1])}}},94:{},95:{f:er},96:{},97:{},99:{f:er},125:{f:R0},128:{f:function(r){if(r.l+=4,(r=[r.read_shift(2),r.read_shift(2)])[0]!==0&&r[0]--,r[1]!==0&&r[1]--,7<r[0]||7<r[1])throw new Error("Bad Gutters: "+r.join("|"));return r}},129:{f:function(r,d,u){return{fDialog:16&(d=u&&u.biff==8||d==2?r.read_shift(2):(r.l+=d,0)),fBelow:64&d,fRight:128&d}}},130:{f:xr},131:{f:er},132:{f:er},133:{f:function(r,d,u){var h=r.read_shift(4),g=3&r.read_shift(1),b=r.read_shift(1);switch(b){case 0:b="Worksheet";break;case 1:b="Macrosheet";break;case 2:b="Chartsheet";break;case 6:b="VBAModule"}return u=Jn(r,0,u),{pos:h,hs:g,dt:b,name:u=u.length===0?"Sheet1":u}}},134:{},140:{f:function(r){var d=[0,0],u=r.read_shift(2);return d[0]=Sm[u]||u,u=r.read_shift(2),d[1]=Sm[u]||u,d}},141:{f:xr},144:{},146:{f:function(r){for(var d=r.read_shift(2),u=[];0<d--;)u.push(F0(r));return u}},151:{},152:{},153:{},154:{},155:{},156:{f:xr},157:{},158:{},160:{f:P0},161:{f:function(r,d){var u={};return d<32||(r.l+=16,u.header=Ca(r),u.footer=Ca(r),r.l+=2),u}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(r,d){for(var u=r.l+d-2,h=r.read_shift(2),g=r.read_shift(2),b=[];r.l<u;)b.push(Nl(r));if(r.l!==u)throw new Error("MulRK read error");if(d=r.read_shift(2),b.length!=d-g+1)throw new Error("MulRK length mismatch");return{r:h,c:g,C:d,rkrec:b}}},190:{f:function(r,d){for(var u=r.l+d-2,h=r.read_shift(2),g=r.read_shift(2),b=[];r.l<u;)b.push(r.read_shift(2));if(r.l!==u)throw new Error("MulBlank read error");if(d=r.read_shift(2),b.length!=d-g+1)throw new Error("MulBlank length mismatch");return{r:h,c:g,C:d,ixfe:b}}},193:{f:Ua},197:{},198:{},199:{},200:{},201:{},202:{f:er},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:xr},220:{},221:{f:er},222:{},224:{f:function(r,d,u){var h,g,b,x={};return x.ifnt=r.read_shift(2),x.numFmtId=r.read_shift(2),x.flags=r.read_shift(2),x.fStyle=x.flags>>2&1,d-=6,x.data=(h=r,x.fStyle,g=u,b={},d=h.read_shift(4),r=h.read_shift(4),u=h.read_shift(4),h=h.read_shift(2),b.patternType=Am[u>>26],g.cellStyles&&(b.alc=7&d,b.fWrap=d>>3&1,b.alcV=d>>4&7,b.fJustLast=d>>7&1,b.trot=d>>8&255,b.cIndent=d>>16&15,b.fShrinkToFit=d>>20&1,b.iReadOrder=d>>22&2,b.fAtrNum=d>>26&1,b.fAtrFnt=d>>27&1,b.fAtrAlc=d>>28&1,b.fAtrBdr=d>>29&1,b.fAtrPat=d>>30&1,b.fAtrProt=d>>31&1,b.dgLeft=15&r,b.dgRight=r>>4&15,b.dgTop=r>>8&15,b.dgBottom=r>>12&15,b.icvLeft=r>>16&127,b.icvRight=r>>23&127,b.grbitDiag=r>>30&3,b.icvTop=127&u,b.icvBottom=u>>7&127,b.icvDiag=u>>14&127,b.dgDiag=u>>21&15,b.icvFore=127&h,b.icvBack=h>>7&127,b.fsxButton=h>>14&1),b),x}},225:{f:function(r,d){return d===0||r.read_shift(2),1200}},226:{f:Ua},227:{},229:{f:function(r,d){for(var u=[],h=r.read_shift(2);h--;)u.push(ra(r));return u}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(r,d){for(var u=r.l+d,d=r.read_shift(4),h=r.read_shift(4),g=[],b=0;b!=h&&r.l<u;++b)g.push((function(y){var j=m;m=1200;var k,E=y.read_shift(2),T=4&(I=y.read_shift(1)),_=8&I,R=1+(1&I),q=0,I={};return _&&(q=y.read_shift(2)),T&&(k=y.read_shift(4)),R=R==2?"dbcs-cont":"sbcs-cont",R=E===0?"":y.read_shift(E,R),_&&(y.l+=4*q),T&&(y.l+=k),I.t=R,_||(I.raw="<t>"+I.t+"</t>",I.r=I.t),m=j,I})(r));return g.Count=d,g.Unique=h,g}},253:{f:function(r){var d=Ha(r);return d.isst=r.read_shift(4),d}},255:{f:function(r,d){var u={};return u.dsst=r.read_shift(2),r.l+=d-2,u}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:jh},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:er},353:{f:Ua},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(r,b,u){var h=r.l+b,g=r.read_shift(2),b=r.read_shift(2);if((u.sbcch=b)==1025||b==14849)return[b,g];if(b<1||255<b)throw new Error("Unexpected SupBook type: "+b);for(var u=Ui(r,b),x=[];h>r.l;)x.push(Hi(r));return[b,g,u,x]}},431:{f:er},432:{},433:{},434:{},437:{},438:{f:function(r,d,u){var h=r.l,g="";try{r.l+=4;var b=(u.lastobj||{cmo:[0,0]}).cmo[1];[0,5,7,11,12,14].indexOf(b)==-1?r.l+=6:(function(k){var E=k.read_shift(1);k.l++;var T=k.read_shift(2);k.l+=2})(r);var x=r.read_shift(2);r.read_shift(2),xr(r),b=r.read_shift(2),r.l+=b;for(var y=1;y<r.lens.length-1;++y){if(r.l-h!=r.lens[y])throw new Error("TxO: bad continue record");var j=r[r.l];if((g+=Ui(r,r.lens[y+1]-r.lens[y]-1)).length>=(j?x:2*x))break}if(g.length!==x&&g.length!==2*x)throw new Error("cchText: "+x+" != "+g.length);return r.l=h+d,{t:g}}catch{return r.l=h+d,{t:g}}}},439:{f:er},440:{f:function(r,d){var u=ra(r);return r.l+=16,[u,(function(h,g){var b=h.l+g;if((T=h.read_shift(4))!==2)throw new Error("Unrecognized streamVersion: "+T);g=h.read_shift(2),h.l+=2;var x,y,j,k,E,T="";16&g&&(x=Zn(h,h.l)),128&g&&(y=Zn(h,h.l)),(257&g)==257&&(j=Zn(h,h.l)),(257&g)==1&&(_=Wi(h,h.l)),8&g&&(T=Zn(h,h.l)),32&g&&(k=h.read_shift(16)),64&g&&(E=Zo(h)),h.l=b;var _=y||j||_||"";return _&&T&&(_+="#"+T),_=_||"#"+T,_={Target:_=2&g&&_.charAt(0)=="/"&&_.charAt(1)!="/"?"file://"+_:_},k&&(_.guid=k),E&&(_.time=E),x&&(_.Tooltip=x),_})(r,d-24)]}},441:{},442:{f:Hi},443:{},444:{f:xr},445:{},446:{},448:{f:Ua},449:{f:function(r){return r.read_shift(2),r.read_shift(4)},r:2},450:{f:Ua},512:{f:lo},513:{f:O0},515:{f:function(r,d,u){return u.biffguess&&u.biff==2&&(u.biff=5),u=Ha(r),r=Ca(r),u.val=r,u}},516:{f:function(r,d,u){return u.biffguess&&u.biff==2&&(u.biff=5),r.l,d=Ha(r),u.biff==2&&r.l++,u=Hi(r,r.l,u),d.val=u,d}},517:{f:_m},519:{f:If},520:{f:function(r){var d={};d.r=r.read_shift(2),d.c=r.read_shift(2),d.cnt=r.read_shift(2)-d.c;var u=r.read_shift(2);r.l+=4;var h=r.read_shift(1);return r.l+=3,7&h&&(d.level=7&h),32&h&&(d.hidden=!0),64&h&&(d.hpt=u/20),d}},523:{},545:{f:ld},549:{f:M0},566:{},574:{f:function(r,d,u){return u&&2<=u.biff&&u.biff<5?{}:{RTL:64&r.read_shift(2)}}},638:{f:function(h){var d=h.read_shift(2),u=h.read_shift(2),h=Nl(h);return{r:d,c:u,ixfe:h[0],rknum:h[1]}}},659:{},1048:{},1054:{f:function(r,d,u){return[r.read_shift(2),Vi(r,0,u)]}},1084:{},1212:{f:function(r,d,u){var h=Nh(r);r.l++;var g=r.read_shift(1);return[(function(b,x,y){var j,k=b.l+x,E=b.read_shift(2),T=Ed(b,E,y);return E==65535?[[],La(b,x-2)]:(x!==E+2&&(j=vo(b,k-E-2,T,y)),[T,j])})(r,d-=8,u),g,h]}},2048:{f:function(r,d){return r.read_shift(2),[ra(r),r.read_shift((d-10)/2,"dbcs-cont").replace(ye,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ua},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(r){r.l+=2;var d={cxfs:0,crc:0};return d.cxfs=r.read_shift(2),d.crc=r.read_shift(4),d},r:12},2173:{f:function(r,d){r.l,r.l+=2,d=r.read_shift(2),r.l+=2;for(var u=r.read_shift(2),h=[];0<u--;)h.push(rg(r,r.l));return{ixfe:d,ext:h}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:er,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(r,d,u){if(!(u.biff<8)){var h=r.read_shift(2),g=r.read_shift(2);return[Ui(r,h,u),Ui(r,g,u)]}r.l+=d},r:12},2197:{},2198:{f:function(r,d,u){var h=r.l+d;if(r.read_shift(4)!==124226)if(u.cellStyles){var g,b=r.slice(r.l);r.l=h;try{g=hi(b,{type:"array"})}catch{return}if(d=Ma(g,"theme/theme/theme1.xml",!0),d)return Dl(d,u)}else r.l=h},r:12},2199:{},2200:{},2201:{},2202:{f:function(r){return[r.read_shift(4)!==0,r.read_shift(4)!==0,r.read_shift(4)]},r:12},2203:{f:Ua},2204:{},2205:{},2206:{},2207:{},2211:{f:function(r){var d,u,h=(u=(d=r).read_shift(2),h=d.read_shift(2),d.l+=8,{type:u});if(h.type!=2211)throw new Error("Invalid Future Record "+h.type);return r.read_shift(4)!==0}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:xr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(r,d,u){var h={area:!1};return u.biff!=5?r.l+=d:(d=r.read_shift(1),r.l+=3,16&d&&(h.area=!0)),h}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(r){for(var d=r.read_shift(2),u=[];0<d--;)u.push(F0(r));return u}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:lo},1:{},2:{f:function(r){var d=Ha(r);return++r.l,r=r.read_shift(2),d.t="n",d.val=r,d}},3:{f:function(r){var d=Ha(r);return++r.l,r=Ca(r),d.t="n",d.val=r,d}},4:{f:function(r,d,u){u.biffguess&&u.biff==5&&(u.biff=2);var h=Ha(r);return++r.l,u=Vi(r,0,u),h.t="str",h.val=u,h}},5:{f:_m},7:{f:function(r){var d=r.read_shift(1);return d===0?(r.l++,""):r.read_shift(d,"sbcs-cont")}},8:{},9:{f:tc},11:{},22:{f:xr},30:{f:Pl},31:{},32:{},33:{f:ld},36:{},37:{f:M0},50:{f:function(r,d){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=d-13}},62:{},52:{},67:{},68:{f:xr},69:{},86:{},126:{},127:{f:function(r){var d=r.read_shift(2),h=r.read_shift(2),u=r.read_shift(4),h={fmt:d,env:h,len:u,data:r.slice(r.l,r.l+u)};return r.l+=u,h}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(r,b,x){var h=r.l+b,g=Ha(r),b=r.read_shift(2),x=Ui(r,b,x);return r.l=h,g.t="str",g.val=x,g}},223:{},234:{},354:{},421:{},518:{f:gc},521:{f:tc},536:{f:kl},547:{f:Fm},561:{},579:{},1030:{f:gc},1033:{f:tc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function It(r,d,u,h){var g=d;isNaN(g)||(d=h||(u||[]).length||0,(h=r.next(4)).write_shift(2,g),h.write_shift(2,d),0<d&&dh(u)&&r.push(u))}function Bd(r,d,u){return(r=r||gt(7)).write_shift(2,d),r.write_shift(2,u),r.write_shift(2,0),r.write_shift(1,0),r}function kg(r,d,u,h){if(d.v!=null)switch(d.t){case"d":case"n":var g=d.t=="d"?Dr(Ts(d.v)):d.v;return void(g==(0|g)&&0<=g&&g<65536?It(r,2,(E=u,T=h,_=g,Bd(R=gt(9),E,T),R.write_shift(2,_),R)):It(r,3,(_=u,R=h,g=g,Bd(k=gt(15),_,R),k.write_shift(8,g,"f"),k)));case"b":case"e":return void It(r,5,(k=u,b=h,x=d.v,y=d.t,Bd(j=gt(9),k,b),no(x,y||"b",j),j));case"s":case"str":return void It(r,4,(b=u,x=h,y=(d.v||"").slice(0,255),Bd(j=gt(8+2*y.length),b,x),j.write_shift(1,y.length),j.write_shift(y.length,y,"sbcs"),j.l<j.length?j.slice(0,j.l):j))}var b,x,y,j,k,E,T,_,R;It(r,1,Bd(null,u,h))}function Cg(r,d){for(var u=d||{},d=Ra(),h=0,g=0;g<r.SheetNames.length;++g)r.SheetNames[g]==u.sheet&&(h=g);if(h==0&&u.sheet&&r.SheetNames[0]!=u.sheet)throw new Error("Sheet not found: "+u.sheet);return It(d,u.biff==4?1033:u.biff==3?521:9,io(0,16,u)),(function(b,x,y){var j,k,E=Array.isArray(x),T=Ls(x["!ref"]||"A1"),_=[];if(255<T.e.c||16383<T.e.r){if(y.WTF)throw new Error("Range "+(x["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,16383),j=Ss(T)}for(var R=T.s.r;R<=T.e.r;++R){k=Ur(R);for(var q=T.s.c;q<=T.e.c;++q){R===T.s.r&&(_[q]=Tr(q)),j=_[q]+k;var I=E?(x[R]||[])[q]:x[j];I&&kg(b,I,R,q)}}})(d,r.Sheets[r.SheetNames[h]],u),It(d,10),d.end()}function Sc(r,d,u){var h,g;It(r,49,(g=(h={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(r=gt((u=(r=u)&&r.biff==5)?15+g.length:16+2*g.length)).write_shift(2,20*(h.sz||12)),r.write_shift(4,0),r.write_shift(2,400),r.write_shift(4,0),r.write_shift(2,0),r.write_shift(1,g.length),u||r.write_shift(1,1),r.write_shift((u?1:2)*g.length,g,u?"sbcs":"utf16le"),r))}function Nu(r,d,u){d&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g,b,x,y,j=h[0];j<=h[1];++j)d[j]!=null&&It(r,1054,(g=j,b=d[j],y=void 0,x=(x=u)&&x.biff==5,(y=y||gt(x?3+b.length:5+2*b.length)).write_shift(2,g),y.write_shift(x?1:2,b.length),x||y.write_shift(1,1),y.write_shift((x?1:2)*b.length,b,x?"sbcs":"utf16le"),(y=y.length>y.l?y.slice(0,y.l):y).l==null&&(y.l=y.length),y))})}function Sg(r,d){for(var u=0;u<d["!links"].length;++u){var h=d["!links"][u];It(r,440,sc(h)),h[1].Tooltip&&It(r,2048,(function(g){var b=g[1].Tooltip,x=gt(10+2*(b.length+1));x.write_shift(2,2048),g=Hr(g[0]),x.write_shift(2,g.r),x.write_shift(2,g.r),x.write_shift(2,g.c),x.write_shift(2,g.c);for(var y=0;y<b.length;++y)x.write_shift(2,b.charCodeAt(y));return x.write_shift(2,0),x})(h))}delete d["!links"]}function Ag(r,d){var u;d&&(u=0,d.forEach(function(h,g){var b;++u<=256&&h&&It(r,125,(b=yc(g,h),h=g,(g=gt(12)).write_shift(2,h),g.write_shift(2,h),g.write_shift(2,256*b.width),g.write_shift(2,0),h=0,b.hidden&&(h|=1),g.write_shift(1,h),h=b.level||0,g.write_shift(1,h),g.write_shift(2,0),g))}))}function Eg(r,d,u,h,g){var b,x,y,j,k,E,T,_,R,q,I,J=16+Ji(g.cellXfs,d,g);if(d.v!=null||d.bf)if(d.bf)It(r,6,Dd(d,u,h,0,J));else switch(d.t){case"d":case"n":var Y=d.t=="d"?Dr(Ts(d.v)):d.v;It(r,515,(E=u,T=h,_=Y,R=J,q=gt(14),vi(E,T,R,q),Dn(_,q),q));break;case"b":case"e":It(r,517,(Y=u,E=h,T=d.v,R=J,_=d.t,q=gt(8),vi(Y,E,R,q),no(T,_,q),q));break;case"s":case"str":g.bookSST?(I=_d(g.Strings,d.v,g.revStrings),It(r,253,(b=u,x=h,y=I,j=J,k=gt(10),vi(b,x,j,k),k.write_shift(4,y),k))):It(r,516,(I=u,b=h,x=(d.v||"").slice(0,255),j=J,y=gt(+(k=!(y=g)||y.biff==8)+8+(1+k)*x.length),vi(I,b,j,y),y.write_shift(2,x.length),k&&y.write_shift(1,1),y.write_shift((1+k)*x.length,x,k?"utf16le":"sbcs"),y));break;default:It(r,513,vi(u,h,J))}else It(r,513,vi(u,h,J))}function Dg(r,d,u){var h,g,b=Ra(),X=u.SheetNames[r],x=u.Sheets[X]||{},y=(u||{}).Workbook||{},j=(y.Sheets||[])[r]||{},k=Array.isArray(x),E=d.biff==8,T=[],_=Ls(x["!ref"]||"A1"),R=E?65536:16384;if(255<_.e.c||_.e.r>=R){if(d.WTF)throw new Error("Range "+(x["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,R-1)}It(b,2057,io(0,16,d)),It(b,13,xn(1)),It(b,12,xn(100)),It(b,15,Sa(!0)),It(b,17,Sa(!1)),It(b,16,Dn(.001)),It(b,95,Sa(!0)),It(b,42,Sa(!1)),It(b,43,Sa(!1)),It(b,130,xn(1)),It(b,128,(u=[0,0],(r=gt(8)).write_shift(4,0),r.write_shift(2,u[0]?u[0]+1:0),r.write_shift(2,u[1]?u[1]+1:0),r)),It(b,131,Sa(!1)),It(b,132,Sa(!1)),E&&Ag(b,x["!cols"]),It(b,512,(R=_,(u=gt(2*(r=(u=d).biff!=8&&u.biff?2:4)+6)).write_shift(r,R.s.r),u.write_shift(r,R.e.r+1),u.write_shift(2,R.s.c),u.write_shift(2,R.e.c+1),u.write_shift(2,0),u)),E&&(x["!links"]=[]);for(var q=_.s.r;q<=_.e.r;++q){g=Ur(q);for(var I=_.s.c;I<=_.e.c;++I){q===_.s.r&&(T[I]=Tr(I)),h=T[I]+g;var J=k?(x[q]||[])[I]:x[h];J&&(Eg(b,J,q,I,d),E&&J.l&&x["!links"].push([h,J.l]))}}var Y,z,X=j.CodeName||j.name||X;return E&&It(b,574,(y=(y.Views||[])[0],z=gt(18),Y=1718,y&&y.RTL&&(Y|=64),z.write_shift(2,Y),z.write_shift(4,0),z.write_shift(4,64),z.write_shift(4,0),z.write_shift(4,0),z)),E&&(x["!merges"]||[]).length&&It(b,229,(function(ie){var le=gt(2+8*ie.length);le.write_shift(2,ie.length);for(var Ae=0;Ae<ie.length;++Ae)nd(ie[Ae],le);return le})(x["!merges"])),E&&Sg(b,x),It(b,442,jl(X)),E&&(Y=b,z=x,(X=gt(19)).write_shift(4,2151),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,3),X.write_shift(1,1),X.write_shift(4,0),It(Y,2151,X),(X=gt(39)).write_shift(4,2152),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,3),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(2,1),X.write_shift(4,4),X.write_shift(2,0),nd(Ls(z["!ref"]||"A1"),X),X.write_shift(4,4),It(Y,2152,X)),It(b,10),b.end()}function Tg(r,d,u){var h=Ra(),y=(r||{}).Workbook||{},g=y.Sheets||[],b=y.WBProps||{},x=u.biff==8,y=u.biff==5;It(h,2057,io(0,5,u)),u.bookType=="xla"&&It(h,135),It(h,225,x?xn(1200):null),It(h,193,(function(Y,z){z=z||gt(Y);for(var X=0;X<Y;++X)z.write_shift(1,0);return z})(2)),y&&It(h,191),y&&It(h,192),It(h,226),It(h,92,(function(Y){var z=!Y||Y.biff==8,X=gt(z?112:54);for(X.write_shift(Y.biff==8?2:1,7),z&&X.write_shift(1,0),X.write_shift(4,859007059),X.write_shift(4,5458548|(z?0:536870912));X.l<X.length;)X.write_shift(1,z?0:32);return X})(u)),It(h,66,xn(x?1200:1252)),x&&It(h,353,xn(0)),x&&It(h,448),It(h,317,(function(Y){for(var z=gt(2*Y),X=0;X<Y;++X)z.write_shift(2,X+1);return z})(r.SheetNames.length)),x&&r.vbaraw&&It(h,211),x&&r.vbaraw&&It(h,442,jl(b.CodeName||"ThisWorkbook")),It(h,156,xn(17)),It(h,25,Sa(!1)),It(h,18,Sa(!1)),It(h,19,xn(0)),x&&It(h,431,Sa(!1)),x&&It(h,444,xn(0)),It(h,61,((y=gt(18)).write_shift(2,0),y.write_shift(2,0),y.write_shift(2,29280),y.write_shift(2,17600),y.write_shift(2,56),y.write_shift(2,0),y.write_shift(2,0),y.write_shift(2,1),y.write_shift(2,500),y)),It(h,64,Sa(!1)),It(h,141,xn(0)),It(h,34,Sa(((b=r).Workbook&&b.Workbook.WBProps&&hr(b.Workbook.WBProps.date1904)?"true":"false")=="true")),It(h,14,Sa(!0)),x&&It(h,439,Sa(!1)),It(h,218,xn(0)),Sc(h,0,u),Nu(h,r.SSF,u),(function(Y,z){for(var X=0;X<16;++X)It(Y,224,oo({numFmtId:0,style:!0},0,z));z.cellXfs.forEach(function(ie){It(Y,224,oo(ie,0,z))})})(h,u),x&&It(h,352,Sa(!1)),y=h.end(),b=Ra(),x&&It(b,140,((J=J||gt(4)).write_shift(2,1),J.write_shift(2,1),J)),x&&u.Strings&&(function(Y,z,X){var ie=(X||[]).length||0;if(ie<=8224)return It(Y,z,X,ie);if(!isNaN(z)){for(var le=X.parts||[],Ae=0,Ve=0,Oe=0;Oe+(le[Ae]||8224)<=8224;)Oe+=le[Ae]||8224,Ae++;var Je=Y.next(4);for(Je.write_shift(2,z),Je.write_shift(2,Oe),Y.push(X.slice(Ve,Ve+Oe)),Ve+=Oe;Ve<ie;){for((Je=Y.next(4)).write_shift(2,60),Oe=0;Oe+(le[Ae]||8224)<=8224;)Oe+=le[Ae]||8224,Ae++;Je.write_shift(2,Oe),Y.push(X.slice(Ve,Ve+Oe)),Ve+=Oe}}})(b,252,id(u.Strings)),It(b,10);for(var h=b.end(),j=Ra(),k=0,E=0,E=0;E<r.SheetNames.length;++E)k+=(x?12:11)+(x?2:1)*r.SheetNames[E].length;var T,_,R,q,I=y.length+k+h.length;for(E=0;E<r.SheetNames.length;++E)It(j,133,(T={pos:I,hs:(g[E]||{}).Hidden||0,dt:0,name:r.SheetNames[E]},q=R=void 0,R=!(_=u)||8<=_.biff?2:1,(q=gt(8+R*T.name.length)).write_shift(4,T.pos),q.write_shift(1,T.hs||0),q.write_shift(1,T.dt),q.write_shift(1,T.name.length),8<=_.biff&&q.write_shift(1,1),q.write_shift(R*T.name.length,T.name,_.biff<8?"sbcs":"utf16le"),(_=q.slice(0,q.l)).l=q.l,_)),I+=d[E].length;var J=j.end();if(k!=J.length)throw new Error("BS8 "+k+" != "+J.length);return b=[],y.length&&b.push(y),J.length&&b.push(J),h.length&&b.push(h),he(b)}function wf(r,d){for(var u=0;u<=r.SheetNames.length;++u){var h=r.Sheets[r.SheetNames[u]];h&&h["!ref"]&&255<Oa(h["!ref"]).e.c&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[u]+"' extends beyond column IV (255).  Data may be lost.")}var g=d||{};switch(g.biff||2){case 8:case 5:return(function(b,x){var y=x||{},j=[];b&&!b.SSF&&(b.SSF=Ys(V)),b&&b.SSF&&(ql(),Bo(b.SSF),y.revssf=Fi(b.SSF),y.revssf[b.SSF[65535]]=0,y.ssf=b.SSF),y.Strings=[],y.Strings.Count=0,y.Strings.Unique=0,Fu(y),y.cellXfs=[],Ji(y.cellXfs,{},{revssf:{General:0}}),b.Props||(b.Props={});for(var k=0;k<b.SheetNames.length;++k)j[j.length]=Dg(k,y,b);return j.unshift(Tg(b,j,y)),he(j)})(r,d);case 4:case 3:case 2:return Cg(r,d)}throw new Error("invalid type "+g.bookType+" for BIFF")}function zd(r,d){var u=d||{},h=u.dense?[]:{},g=(r=r.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!g)throw new Error("Invalid HTML: could not find <table>");for(var b,d=r.match(/<\/table/i),_=g.index,x=d&&d.index||r.length,y=Na(r.slice(_,x),/(:?<tr[^>]*>)/i,"<tr>"),j=-1,k=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},T=[],_=0;_<y.length;++_){var R=y[_].trim(),q=R.slice(0,3).toLowerCase();if(q!="<tr"){if(q=="<td"||q=="<th")for(var I=R.split(/<\/t[dh]>/i),x=0;x<I.length;++x){var J=I[x].trim();if(J.match(/<t[dh]/i)){for(var Y=J,z=0;Y.charAt(0)=="<"&&-1<(z=Y.indexOf(">"));)Y=Y.slice(z+1);for(var X=0;X<T.length;++X){var ie=T[X];ie.s.c==k&&ie.s.r<j&&j<=ie.e.r&&(k=ie.e.c+1,X=-1)}var le=gs(J.slice(0,J.indexOf(">"))),Ae=le.colspan?+le.colspan:1;(1<(b=+le.rowspan)||1<Ae)&&T.push({s:{r:j,c:k},e:{r:j+(b||1)-1,c:k+Ae-1}}),J=le.t||le["data-t"]||"",Y.length&&(Y=Ot(Y),E.s.r>j&&(E.s.r=j),E.e.r<j&&(E.e.r=j),E.s.c>k&&(E.s.c=k),E.e.c<k&&(E.e.c=k),Y.length&&(le={t:"s",v:Y},u.raw||!Y.trim().length||J=="s"||(Y==="TRUE"?le={t:"b",v:!0}:Y==="FALSE"?le={t:"b",v:!1}:isNaN(on(Y))?isNaN(Cn(Y).getDate())||(le={t:"d",v:Ts(Y)},(le=u.cellDates?le:{t:"n",v:Dr(le.v)}).z=u.dateNF||V[14]):le={t:"n",v:on(Y)}),u.dense?(h[j]||(h[j]=[]),h[j][k]=le):h[vs({r:j,c:k})]=le)),k+=Ae}}}else{if(++j,u.sheetRows&&u.sheetRows<=j){--j;break}k=0}}return h["!ref"]=Ss(E),T.length&&(h["!merges"]=T),h}function jf(r,d,u,h){for(var g=r["!merges"]||[],b=[],x=d.s.c;x<=d.e.c;++x){for(var y,j,k,E,T=0,_=0,R=0;R<g.length;++R)if(!(g[R].s.r>u||g[R].s.c>x||g[R].e.r<u||g[R].e.c<x)){if(g[R].s.r<u||g[R].s.c<x){T=-1;break}T=g[R].e.r-g[R].s.r+1,_=g[R].e.c-g[R].s.c+1;break}T<0||(y=vs({r:u,c:x}),k=(j=h.dense?(r[u]||[])[x]:r[y])&&j.v!=null&&(j.h||Vo(j.w||(gi(j),j.w)||""))||"",E={},1<T&&(E.rowspan=T),1<_&&(E.colspan=_),h.editable?k='<span contenteditable="true">'+k+"</span>":j&&(E["data-t"]=j&&j.t||"z",j.v!=null&&(E["data-v"]=j.v),j.z!=null&&(E["data-z"]=j.z),j.l&&(j.l.Target||"#").charAt(0)!="#"&&(k='<a href="'+j.l.Target+'">'+k+"</a>")),E.id=(h.id||"sjs")+"-"+y,b.push(kt("td",k,E)))}return"<tr>"+b.join("")+"</tr>"}var Nf='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ir="</body></html>";function ku(r,d,u){return[].join("")+"<table"+(u&&u.id?' id="'+u.id+'"':"")+">"}function _g(r,g){var u=g||{},h=u.header!=null?u.header:Nf,g=u.footer!=null?u.footer:ir,b=[h],x=Oa(r["!ref"]);u.dense=Array.isArray(r),b.push(ku(0,0,u));for(var y=x.s.r;y<=x.e.r;++y)b.push(jf(r,x,y,u));return b.push("</table>"+g),b.join("")}function kf(r,d,u){var h=u||{},g=0,b=0;h.origin!=null&&(typeof h.origin=="number"?g=h.origin:(g=(u=typeof h.origin=="string"?Hr(h.origin):h.origin).r,b=u.c));var x=d.getElementsByTagName("tr"),y=Math.min(h.sheetRows||1e7,x.length),j={s:{r:0,c:0},e:{r:g,c:b}};r["!ref"]&&(d=Oa(r["!ref"]),j.s.r=Math.min(j.s.r,d.s.r),j.s.c=Math.min(j.s.c,d.s.c),j.e.r=Math.max(j.e.r,d.e.r),j.e.c=Math.max(j.e.c,d.e.c),g==-1&&(j.e.r=g=d.e.r+1));var k,E,T=[],_=0,R=r["!rows"]||(r["!rows"]=[]),q=0,I=0,J=0,Y=0;for(r["!cols"]||(r["!cols"]=[]);q<x.length&&I<y;++q){var z=x[q];if(Mg(z)){if(h.display)continue;R[I]={hidden:!0}}for(var X=z.children,J=Y=0;J<X.length;++J){var ie=X[J];if(!h.display||!Mg(ie)){for(var le=ie.hasAttribute("data-v")?ie.getAttribute("data-v"):ie.hasAttribute("v")?ie.getAttribute("v"):Ot(ie.innerHTML),Ae=ie.getAttribute("data-z")||ie.getAttribute("z"),_=0;_<T.length;++_){var Ve=T[_];Ve.s.c==Y+b&&Ve.s.r<I+g&&I+g<=Ve.e.r&&(Y=Ve.e.c+1-b,_=-1)}E=+ie.getAttribute("colspan")||1,(1<(k=+ie.getAttribute("rowspan")||1)||1<E)&&T.push({s:{r:I+g,c:Y+b},e:{r:I+g+(k||1)-1,c:Y+b+(E||1)-1}});var Oe={t:"s",v:le},Je=ie.getAttribute("data-t")||ie.getAttribute("t")||"";le!=null&&(le.length==0?Oe.t=Je||"z":h.raw||le.trim().length==0||Je=="s"||(le==="TRUE"?Oe={t:"b",v:!0}:le==="FALSE"?Oe={t:"b",v:!1}:isNaN(on(le))?isNaN(Cn(le).getDate())||(Oe={t:"d",v:Ts(le)},(Oe=h.cellDates?Oe:{t:"n",v:Dr(Oe.v)}).z=h.dateNF||V[14]):Oe={t:"n",v:on(le)})),Oe.z===void 0&&Ae!=null&&(Oe.z=Ae);var pt="",xt=ie.getElementsByTagName("A");if(xt&&xt.length)for(var at=0;at<xt.length&&(!xt[at].hasAttribute("href")||(pt=xt[at].getAttribute("href")).charAt(0)=="#");++at);pt&&pt.charAt(0)!="#"&&(Oe.l={Target:pt}),h.dense?(r[I+g]||(r[I+g]=[]),r[I+g][Y+b]=Oe):r[vs({c:Y+b,r:I+g})]=Oe,j.e.c<Y+b&&(j.e.c=Y+b),Y+=E}}++I}return T.length&&(r["!merges"]=(r["!merges"]||[]).concat(T)),j.e.r=Math.max(j.e.r,I-1+g),r["!ref"]=Ss(j),y<=I&&(r["!fullref"]=Ss((j.e.r=x.length-q+I-1+g,j))),r}function Fg(r,d){return kf((d||{}).dense?[]:{},r,d)}function Mg(r){var u,d="",u=(u=r).ownerDocument.defaultView&&typeof u.ownerDocument.defaultView.getComputedStyle=="function"?u.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null;return(d=(d=u?u(r).getPropertyValue("display"):d)||r.style&&r.style.display)==="none"}var Lg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ud(r,d){var u=d||{},h,g,b,x,y,j=c0(r),k=[],E={name:""},T="",_=0,R={},q=[],I=u.dense?[]:{},J={value:""},Y="",z=0,X=[],ie=-1,le=-1,Ae={s:{r:1e6,c:1e7},e:{r:0,c:0}},Ve=0,Oe={},Je=[],pt={},xt=[],at=1,Ct=1,Vt=[],Ut={Names:[]},Ft={},Mt=["",""],Dt=[],wt={},Yt="",Jt=0,is=!1,Fs=!1,Wt=0;for(ml.lastIndex=0,j=j.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=ml.exec(j);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(Ae.e.c>=Ae.s.c&&Ae.e.r>=Ae.s.r?I["!ref"]=Ss(Ae):I["!ref"]="A1:A1",0<u.sheetRows&&u.sheetRows<=Ae.e.r&&(I["!fullref"]=I["!ref"],Ae.e.r=u.sheetRows-1,I["!ref"]=Ss(Ae)),Je.length&&(I["!merges"]=Je),xt.length&&(I["!rows"]=xt),b.name=b.||b.name,typeof JSON<"u"&&JSON.stringify(b),q.push(b.name),R[b.name]=I,Fs=!1):x[0].charAt(x[0].length-2)!=="/"&&(b=gs(x[0],!1),ie=le=-1,Ae.s.r=Ae.s.c=1e7,Ae.e.r=Ae.e.c=0,I=u.dense?[]:{},Je=[],xt=[],Fs=!0);break;case"table-row-group":x[1]==="/"?--Ve:++Ve;break;case"table-row":case"":if(x[1]==="/"){ie+=at,at=1;break}if((St=gs(x[0],!1)).?ie=St.-1:ie==-1&&(ie=0),(at=+St["number-rows-repeated"]||1)<10)for(Wt=0;Wt<at;++Wt)0<Ve&&(xt[ie+Wt]={level:Ve});le=-1;break;case"covered-table-cell":x[1]!=="/"&&++le,u.sheetStubs&&(u.dense?(I[ie]||(I[ie]=[]),I[ie][le]={t:"z"}):I[vs({r:ie,c:le})]={t:"z"}),Y="",X=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++le,J=gs(x[0],!1),Ct=parseInt(J["number-columns-repeated"]||"1",10),y={t:"z",v:null},J.formula&&u.cellFormula!=0&&(y.f=pc(ys(J.formula))),(J.||J["value-type"])=="string"&&(y.t="s",y.v=ys(J["string-value"]||""),u.dense?(I[ie]||(I[ie]=[]),I[ie][le]=y):I[vs({r:ie,c:le})]=y),le+=Ct-1;else if(x[1]!=="/"){Y="",z=0,X=[],Ct=1;var St=at?ie+at-1:ie;if(++le>Ae.e.c&&(Ae.e.c=le),le<Ae.s.c&&(Ae.s.c=le),ie<Ae.s.r&&(Ae.s.r=ie),St>Ae.e.r&&(Ae.e.r=St),Dt=[],wt={},y={t:(J=gs(x[0],!1)).||J["value-type"],v:null},u.cellFormula)if(J.formula&&(J.formula=ys(J.formula)),J["number-matrix-columns-spanned"]&&J["number-matrix-rows-spanned"]&&(pt={s:{r:ie,c:le},e:{r:ie+(parseInt(J["number-matrix-rows-spanned"],10)||0)-1,c:le+(parseInt(J["number-matrix-columns-spanned"],10)||0)-1}},y.F=Ss(pt),Vt.push([pt,y.F])),J.formula)y.f=pc(J.formula);else for(Wt=0;Wt<Vt.length;++Wt)ie>=Vt[Wt][0].s.r&&ie<=Vt[Wt][0].e.r&&le>=Vt[Wt][0].s.c&&le<=Vt[Wt][0].e.c&&(y.F=Vt[Wt][1]);switch((J["number-columns-spanned"]||J["number-rows-spanned"])&&(pt={s:{r:ie,c:le},e:{r:ie+(parseInt(J["number-rows-spanned"],10)||0)-1,c:le+(parseInt(J["number-columns-spanned"],10)||0)-1}},Je.push(pt)),J["number-columns-repeated"]&&(Ct=parseInt(J["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=hr(J["boolean-value"]);break;case"float":case"percentage":case"currency":y.t="n",y.v=parseFloat(J.value);break;case"date":y.t="d",y.v=Ts(J["date-value"]),u.cellDates||(y.t="n",y.v=Dr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=(function(Is){var tr=0,Ir=0,Fe=!1,sr=Is.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!sr)throw new Error("|"+Is+"| is not an ISO8601 Duration");for(var qs=1;qs!=sr.length;++qs)if(sr[qs]){switch(Ir=1,3<qs&&(Fe=!0),sr[qs].slice(sr[qs].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+sr[qs].slice(sr[qs].length-1));case"D":Ir*=24;case"H":Ir*=60;case"M":if(!Fe)throw new Error("Unsupported ISO Duration Field: M");Ir*=60}tr+=Ir*parseInt(sr[qs],10)}return tr})(J["time-value"])/86400,u.cellDates&&(y.t="d",y.v=Li(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(J.);break;default:if(y.t!=="string"&&y.t!=="text"&&y.t)throw new Error("Unsupported value type "+y.t);y.t="s",J["string-value"]!=null&&(Y=ys(J["string-value"]),X=[])}}else{if(is=!1,y.t==="s"&&(y.v=Y||"",X.length&&(y.R=X),is=z==0),Ft.Target&&(y.l=Ft),0<Dt.length&&(y.c=Dt,Dt=[]),Y&&u.cellText!==!1&&(y.w=Y),is&&(y.t="z",delete y.v),(!is||u.sheetStubs)&&!(u.sheetRows&&u.sheetRows<=ie))for(var xs=0;xs<at;++xs){if(Ct=parseInt(J["number-columns-repeated"]||"1",10),u.dense)for(I[ie+xs]||(I[ie+xs]=[]),I[ie+xs][le]=xs==0?y:Ys(y);0<--Ct;)I[ie+xs][le+Ct]=Ys(y);else for(I[vs({r:ie+xs,c:le})]=y;0<--Ct;)I[vs({r:ie+xs,c:le+Ct})]=Ys(y);Ae.e.c<=le&&(Ae.e.c=le)}le+=(Ct=parseInt(J["number-columns-repeated"]||"1",10))-1,Ct=0,y={},Y="",X=[]}Ft={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((h=k.pop())[0]!==x[3])throw"Bad state: "+h}else x[0].charAt(x[0].length-2)!=="/"&&k.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((h=k.pop())[0]!==x[3])throw"Bad state: "+h;wt.t=Y,X.length&&(wt.R=X),wt.a=Yt,Dt.push(wt)}else x[0].charAt(x[0].length-2)!=="/"&&k.push([x[3],!1]);Y=Yt="",z=Jt=0,X=[];break;case"creator":x[1]==="/"?Yt=j.slice(Jt,x.index):Jt=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((h=k.pop())[0]!==x[3])throw"Bad state: "+h}else x[0].charAt(x[0].length-2)!=="/"&&k.push([x[3],!1]);Y="",z=0,X=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(Oe[E.name]=T,(h=k.pop())[0]!==x[3])throw"Bad state: "+h}else x[0].charAt(x[0].length-2)!=="/"&&(T="",E=gs(x[0],!1),k.push([x[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(k[k.length-1][0]){case"time-style":case"date-style":g=gs(x[0],!1),T+=Lg[x[3]][g.style==="long"?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(k[k.length-1][0]){case"time-style":case"date-style":g=gs(x[0],!1),T+=Lg[x[3]][g.style==="long"?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(k[k.length-1][0]){case"number-style":case"date-style":case"time-style":T+=j.slice(_,x.index)}else _=x.index+x[0].length;break;case"named-range":Mt=Mn((g=gs(x[0],!1))["cell-range-address"]);var Hs={Name:g.name,Ref:Mt[0]+"!"+Mt[1]};Fs&&(Hs.Sheet=q.length),Ut.Names.push(Hs);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":if(-1<["master-styles"].indexOf(k[k.length-1][0]))break;x[1]!=="/"||J&&J["string-value"]?(gs(x[0],!1),z=x.index+x[0].length):(Hs=(Hs=j.slice(z,x.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(Is,tr){return Array(parseInt(tr,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),Hs=[ys(Hs.replace(/<[^>]*>/g,""))],Y=(0<Y.length?Y+`
`:"")+Hs[0]);break;case"s":break;case"database-range":if(x[1]==="/")break;try{R[(Mt=Mn(gs(x[0])["target-range-address"]))[0]]["!autofilter"]={ref:Mt[1]}}catch{}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if(x[1]!=="/"){if(!(Ft=gs(x[0],!1)).href)break;Ft.Target=ys(Ft.href),delete Ft.href,Ft.Target.charAt(0)=="#"&&-1<Ft.Target.indexOf(".")?(Mt=Mn(Ft.Target.slice(1)),Ft.Target="#"+Mt[0]+"!"+Mt[1]):Ft.Target.match(/^\.\.[\\\/]/)&&(Ft.Target=Ft.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(u.WTF)throw new Error(x)}}return r={Sheets:R,SheetNames:q,Workbook:Ut},u.bookSheets&&delete r.Sheets,r}function ko(r,d){d=d||{},ca(r,"META-INF/manifest.xml")&&(function(h,g){for(var b,x,y=c0(h);b=ml.exec(y);)switch(b[3]){case"manifest":break;case"file-entry":if((x=gs(b[0],!1)).path=="/"&&x.type!==C0)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(g&&g.WTF)throw b}})(zr(r,"META-INF/manifest.xml"),d);var u=Ma(r,"content.xml");if(!u)throw new Error("Missing content.xml in ODS / UOF file");return d=Ud(qe(u),d),ca(r,"meta.xml")&&(d.Props=pi(zr(r,"meta.xml"))),d}function Cu(r,d){return Ud(r,d)}var Su=(function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),d="<office:document-styles "+ws({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return kr+d}})(),Au=(function(){function r(u,h,g){var b=[];b.push('      <table:table table:name="'+Gs(h.SheetNames[g])+`" table:style-name="ta1">
`);var x=0,y=0,j=Oa(u["!ref"]||"A1"),k=u["!merges"]||[],E=0,T=Array.isArray(u);if(u["!cols"])for(y=0;y<=j.e.c;++y)b.push("        <table:table-column"+(u["!cols"][y]?' table:style-name="co'+u["!cols"][y].ods+'"':"")+`></table:table-column>
`);for(var _="",R=u["!rows"]||[],x=0;x<j.s.r;++x)_=R[x]?' table:style-name="ro'+R[x].ods+'"':"",b.push("        <table:table-row"+_+`></table:table-row>
`);for(;x<=j.e.r;++x){for(_=R[x]?' table:style-name="ro'+R[x].ods+'"':"",b.push("        <table:table-row"+_+`>
`),y=0;y<j.s.c;++y)b.push(d);for(;y<=j.e.c;++y){for(var q=!1,I={},J="",E=0;E!=k.length;++E)if(!(k[E].s.c>y||k[E].s.r>x||k[E].e.c<y||k[E].e.r<x)){k[E].s.c==y&&k[E].s.r==x||(q=!0),I["table:number-columns-spanned"]=k[E].e.c-k[E].s.c+1,I["table:number-rows-spanned"]=k[E].e.r-k[E].s.r+1;break}if(q)b.push(`          <table:covered-table-cell/>
`);else{var Y=vs({r:x,c:y}),z=T?(u[x]||[])[y]:u[Y];if(z&&z.f&&(I["table:formula"]=Gs(("of:="+z.f.replace(yo,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),z.F&&z.F.slice(0,Y.length)==Y&&(X=Oa(z.F),I["table:number-matrix-columns-spanned"]=X.e.c-X.s.c+1,I["table:number-matrix-rows-spanned"]=X.e.r-X.s.r+1)),z){switch(z.t){case"b":J=z.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=z.v?"true":"false";break;case"n":J=z.w||String(z.v||0),I["office:value-type"]="float",I["office:value"]=z.v||0;break;case"s":case"str":J=z.v==null?"":z.v,I["office:value-type"]="string";break;case"d":J=z.w||Ts(z.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=Ts(z.v).toISOString(),I["table:style-name"]="ce1";break;default:b.push(d);continue}var X,Y=Gs(J).replace(/  +/g,function(le){return'<text:s text:c="'+le.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");z.l&&z.l.Target&&(Y=kt("text:a",Y,{"xlink:href":(X=(X=(X=z.l.Target).charAt(0)=="#"?"#"+X.slice(1).replace(/\./,"!"):X).charAt(0)!="#"&&!X.match(/^\w+:/)?"../"+X:X).replace(/&/g,"&amp;")})),b.push("          "+kt("table:table-cell",kt("text:p",Y,{}),I)+`
`)}else b.push(d)}}b.push(`        </table:table-row>
`)}return b.push(`      </table:table>
`),b.join("")}var d=`          <table:table-cell />
`;return function(u,h){var g=[kr],b=ws({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=ws({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(g.push("<office:document"+b+x+`>
`),g.push(Em().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+b+`>
`),(function(j,k){j.push(` <office:automatic-styles>
`),j.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),j.push(`   <number:month number:style="long"/>
`),j.push(`   <number:text>/</number:text>
`),j.push(`   <number:day number:style="long"/>
`),j.push(`   <number:text>/</number:text>
`),j.push(`   <number:year/>
`),j.push(`  </number:date-style>
`);var E=0;k.SheetNames.map(function(_){return k.Sheets[_]}).forEach(function(_){if(_&&_["!cols"]){for(var R=0;R<_["!cols"].length;++R)if(_["!cols"][R]){var q=_["!cols"][R];if(q.width==null&&q.wpx==null&&q.wch==null)continue;El(q),q.ods=E,q=_["!cols"][R].wpx+"px",j.push('  <style:style style:name="co'+E+`" style:family="table-column">
`),j.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+q+`"/>
`),j.push(`  </style:style>
`),++E}}});var T=0;k.SheetNames.map(function(_){return k.Sheets[_]}).forEach(function(_){if(_&&_["!rows"])for(var R,q=0;q<_["!rows"].length;++q)_["!rows"][q]&&(_["!rows"][q].ods=T,R=_["!rows"][q].hpx+"px",j.push('  <style:style style:name="ro'+T+`" style:family="table-row">
`),j.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+R+`"/>
`),j.push(`  </style:style>
`),++T)}),j.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),j.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),j.push(`  </style:style>
`),j.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),j.push(` </office:automatic-styles>
`)})(g,u),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var y=0;y!=u.SheetNames.length;++y)g.push(r(u.Sheets[u.SheetNames[y]],u,y));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),h.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}})();function al(r,d){if(d.bookType=="fods")return Au(r,d);var u=Gc(),h=[],g=[];return cs(u,"mimetype","application/vnd.oasis.opendocument.spreadsheet"),cs(u,"content.xml",Au(r,d)),h.push(["content.xml","text/xml"]),g.push(["content.xml","ContentFile"]),cs(u,"styles.xml",Su(r,d)),h.push(["styles.xml","text/xml"]),g.push(["styles.xml","StylesFile"]),cs(u,"meta.xml",kr+Em()),h.push(["meta.xml","text/xml"]),g.push(["meta.xml","MetadataFile"]),cs(u,"manifest.rdf",(function(b){var x=[kr];x.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var y=0;y!=b.length;++y)x.push(ro(b[y][0],b[y][1])),x.push([`  <rdf:Description rdf:about="">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+b[y][0]+`"/>
`,`  </rdf:Description>
`].join(""));return x.push(ro("","Document","pkg")),x.push("</rdf:RDF>"),x.join("")})(g)),h.push(["manifest.rdf","application/rdf+xml"]),cs(u,"META-INF/manifest.xml",(function(b){var x=[kr];x.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),x.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var y=0;y<b.length;++y)x.push('  <manifest:file-entry manifest:full-path="'+b[y][0]+'" manifest:media-type="'+b[y][1]+`"/>
`);return x.push("</manifest:manifest>"),x.join("")})(h)),u}function va(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Co(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):qe(be(r))}function Rg(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):ue(Ke(r))}function nl(r){var d=r.reduce(function(g,b){return g+b.length},0),u=new Uint8Array(d),h=0;return r.forEach(function(g){u.set(g,h),h+=g.length}),u}function Cf(r){return 16843009*((r=(858993459&(r-=r>>1&1431655765))+(r>>2&858993459))+(r>>4)&252645135)>>>24}function Ac(r,d){var u=d?d[0]:0,h=127&r[u];return 128<=r[u++]&&(h|=(127&r[u])<<7,r[u++]<128||(h|=(127&r[u])<<14,r[u++]<128||(h|=(127&r[u])<<21,r[u++]<128||(h+=(127&r[u])*Math.pow(2,28),++u,r[u++]<128||(h+=(127&r[u])*Math.pow(2,35),++u,r[u++]<128||(h+=(127&r[u])*Math.pow(2,42),++u,r[u++])))))),d&&(d[0]=u),h}function Ks(r){var d=new Uint8Array(7);d[0]=127&r;var u=1;return 127<r&&(d[u-1]|=128,d[u]=r>>7&127,++u,r<=16383||(d[u-1]|=128,d[u]=r>>14&127,++u,r<=2097151||(d[u-1]|=128,d[u]=r>>21&127,++u,r<=268435455||(d[u-1]|=128,d[u]=r/256>>>21&127,++u,r<=34359738367||(d[u-1]|=128,d[u]=r/65536>>>21&127,++u,r<=4398046511103||(d[u-1]|=128,d[u]=r/16777216>>>21&127,++u)))))),d.slice(0,u)}function Or(r){var d=0,u=127&r[0];return 128<=r[d++]&&(u|=(127&r[1])<<7,r[d++]<128||(u|=(127&r[2])<<14,r[d++]<128||(u|=(127&r[3])<<21,r[+d]<128||(u|=(127&r[4])<<28)))),u}function zs(r){for(var d=[],u=[0];u[0]<r.length;){var h,g=u[0],b=Ac(r,u),x=7&b,y=0;if((b=Math.floor(b/8))==0)break;switch(x){case 0:for(var j=u[0];128<=r[u[0]++];);h=r.slice(j,u[0]);break;case 5:y=4,h=r.slice(u[0],u[0]+y),u[0]+=y;break;case 1:y=8,h=r.slice(u[0],u[0]+y),u[0]+=y;break;case 2:y=Ac(r,u),h=r.slice(u[0],u[0]+y),u[0]+=y;break;default:throw new Error("PB Type ".concat(x," for Field ").concat(b," at offset ").concat(g))}var k={data:h,type:x};d[b]==null?d[b]=[k]:d[b].push(k)}return d}function Pr(r){var d=[];return r.forEach(function(u,h){h!=0&&u.forEach(function(g){g.data&&(d.push(Ks(8*h+g.type)),g.type==2&&d.push(Ks(g.data.length)),d.push(g.data))})}),nl(d)}function Eu(r,d){return r?.map(function(u){return d(u.data)})||[]}function On(r){for(var d=[],u=[0];u[0]<r.length;){var h=Ac(r,u),g=zs(r.slice(u[0],u[0]+h));u[0]+=h;var b={id:Or(g[1][0].data),messages:[]};g[2].forEach(function(j){var y=zs(j.data),j=Or(y[3][0].data);b.messages.push({meta:y,data:r.slice(u[0],u[0]+j)}),u[0]+=j}),(h=g[3])!=null&&h[0]&&(b.merge=0<Or(g[3][0].data)>>>0),d.push(b)}return d}function il(r){var d=[];return r.forEach(function(u){var h=[[],[{data:Ks(u.id),type:0}],[]];u.merge!=null&&(h[3]=[{data:Ks(+!!u.merge),type:0}]);var g=[];u.messages.forEach(function(b){g.push(b.data),b.meta[3]=[{type:0,data:Ks(b.data.length)}],h[2].push({data:Pr(b.meta),type:2})}),u=Pr(h),d.push(Ks(u.length)),d.push(u),g.forEach(function(b){return d.push(b)})}),nl(d)}function Ja(r){for(var d=[],u=0;u<r.length;){var h=r[u++],g=r[u]|r[u+1]<<8|r[u+2]<<16;u+=3,d.push((function(b,x){if(b!=0)throw new Error("Unexpected Snappy chunk type ".concat(b));for(var y=[0],j=Ac(x,y),k=[];y[0]<x.length;){var E=3&x[y[0]];if(E!=0){var T=0,_=0;if(E==1?(_=4+(x[y[0]]>>2&7),T=(224&x[y[0]++])<<3,T|=x[y[0]++]):(_=1+(x[y[0]++]>>2),E==2?(T=x[y[0]]|x[y[0]+1]<<8,y[0]+=2):(T=(x[y[0]]|x[y[0]+1]<<8|x[y[0]+2]<<16|x[y[0]+3]<<24)>>>0,y[0]+=4)),k=[nl(k)],T==0)throw new Error("Invalid offset 0");if(T>k[0].length)throw new Error("Invalid offset beyond length");if(T<=_)for(k.push(k[0].slice(-T)),_-=T;_>=k[k.length-1].length;)k.push(k[k.length-1]),_-=k[k.length-1].length;k.push(k[0].slice(-T,-T+_))}else E=x[y[0]++]>>2,E<60?++E:(T=E-59,E=x[y[0]],1<T&&(E|=x[y[0]+1]<<8),2<T&&(E|=x[y[0]+2]<<16),3<T&&(E|=x[y[0]+3]<<24),E>>>=0,E++,y[0]+=T),k.push(x.slice(y[0],y[0]+E)),y[0]+=E}if((b=nl(k)).length!=j)throw new Error("Unexpected length: ".concat(b.length," != ").concat(j));return b})(h,r.slice(u,u+g))),u+=g}if(u!==r.length)throw new Error("data is not a valid framed stream!");return nl(d)}function So(r){for(var d=[],u=0;u<r.length;){var h=Math.min(r.length-u,268435455),g=new Uint8Array(4);d.push(g);var b=Ks(h),x=b.length;d.push(b),h<=60?(x++,d.push(new Uint8Array([h-1<<2]))):h<=256?(x+=2,d.push(new Uint8Array([240,h-1&255]))):h<=65536?(x+=3,d.push(new Uint8Array([244,h-1&255,h-1>>8&255]))):h<=16777216?(x+=4,d.push(new Uint8Array([248,h-1&255,h-1>>8&255,h-1>>16&255]))):h<=4294967296&&(x+=5,d.push(new Uint8Array([252,h-1&255,h-1>>8&255,h-1>>16&255,h-1>>>24&255]))),d.push(r.slice(u,u+h)),x+=h,g[0]=0,g[1]=255&x,g[2]=x>>8&255,g[3]=x>>16&255,u+=h}return nl(d)}function t1(r,d,u){var h,g=va(r),b=g.getUint32(8,!0),x=12,y=-1,j=-1,k=NaN,E=NaN,T=new Date(2001,0,1);switch(1&b&&(k=(function(_,R){for(var q=(127&_[R+15])<<7|_[R+14]>>1,I=1&_[R+14],J=R+13;R<=J;--J)I=256*I+_[J];return(128&_[R+15]?-I:I)*Math.pow(10,q-6176)})(r,x),x+=16),2&b&&(E=g.getFloat64(x,!0),x+=8),4&b&&(T.setTime(T.getTime()+1e3*g.getFloat64(x,!0)),x+=8),8&b&&(j=g.getUint32(x,!0),x+=4),16&b&&(y=g.getUint32(x,!0),x+=4),r[1]){case 0:break;case 2:h={t:"n",v:k};break;case 3:h={t:"s",v:d[j]};break;case 5:h={t:"d",v:T};break;case 6:h={t:"b",v:0<E};break;case 7:h={t:"n",v:E/86400};break;case 8:h={t:"e",v:0};break;case 9:if(!(-1<y))throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(31&b," : ").concat(r.slice(0,4)));h={t:"s",v:u[y]};break;case 10:h={t:"n",v:k};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(31&b," : ").concat(r.slice(0,4)))}return h}function Ao(r,d){var u=new Uint8Array(32),h=va(u),g=12,b=0;switch(u[0]=5,r.t){case"n":u[1]=2,(function(x,y,j){var k=Math.floor(j==0?0:Math.LOG10E*Math.log(Math.abs(j)))+6176-16,E=j/Math.pow(10,k-6176);x[y+15]|=k>>7,x[y+14]|=(127&k)<<1;for(var T=0;1<=E;++T,E/=256)x[y+T]=255&E;x[y+15]|=0<=j?0:128})(u,g,r.v),b|=1,g+=16;break;case"b":u[1]=6,h.setFloat64(g,r.v?1:0,!0),b|=2,g+=8;break;case"s":if(d.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));u[1]=3,h.setUint32(g,d.indexOf(r.v),!0),b|=8,g+=4;break;default:throw"unsupported cell type "+r.t}return h.setUint32(8,b,!0),u.slice(0,g)}function Sf(r,d){var u=new Uint8Array(32),h=va(u),g=12,b=0;switch(u[0]=3,r.t){case"n":u[2]=2,h.setFloat64(g,r.v,!0),b|=32,g+=8;break;case"b":u[2]=6,h.setFloat64(g,r.v?1:0,!0),b|=32,g+=8;break;case"s":if(d.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));u[2]=3,h.setUint32(g,d.indexOf(r.v),!0),b|=16,g+=4;break;default:throw"unsupported cell type "+r.t}return h.setUint32(4,b,!0),u.slice(0,g)}function Og(r,d,u){switch(r[0]){case 0:case 1:case 2:case 3:return(function(h,g,b,x){var y,j=va(h),k=j.getUint32(4,!0),E=(1<x?12:8)+4*Cf(k&(1<x?3470:398)),T=-1,_=-1,R=NaN,q=new Date(2001,0,1);switch(512&k&&(T=j.getUint32(E,!0),E+=4),E+=4*Cf(k&(1<x?12288:4096)),16&k&&(_=j.getUint32(E,!0),E+=4),32&k&&(R=j.getFloat64(E,!0),E+=8),64&k&&(q.setTime(q.getTime()+1e3*j.getFloat64(E,!0)),E+=8),h[2]){case 0:break;case 2:y={t:"n",v:R};break;case 3:y={t:"s",v:g[_]};break;case 5:y={t:"d",v:q};break;case 6:y={t:"b",v:0<R};break;case 7:y={t:"n",v:R/86400};break;case 8:y={t:"e",v:0};break;case 9:if(-1<T)y={t:"s",v:b[T]};else if(-1<_)y={t:"s",v:g[_]};else{if(isNaN(R))throw new Error("Unsupported cell type ".concat(h.slice(0,4)));y={t:"n",v:R}}break;default:throw new Error("Unsupported cell type ".concat(h.slice(0,4)))}return y})(r,d,u,r[0]);case 5:return t1(r,d,u);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function hs(r){return Ac(zs(r)[1][0].data)}function Du(r,h){var h=zs(h.data),u=Or(h[1][0].data),h=h[3],g=[];return(h||[]).forEach(function(b){var x=zs(b.data),y=Or(x[1][0].data)>>>0;switch(u){case 1:g[y]=Co(x[3][0].data);break;case 8:var k=zs(r[hs(x[9][0].data)][0].data),j=r[hs(k[1][0].data)][0],k=Or(j.meta[1][0].data);if(k!=2001)throw new Error("2000 unexpected reference to ".concat(k));j=zs(j.data),g[y]=j[3].map(function(E){return Co(E.data)}).join("")}}),g}function Tu(r,g){var u=zs(g.data),h=(g=u?.[7])!=null&&g[0]?0<Or(u[7][0].data)>>>0?1:0:-1,g=Eu(u[5],function(b){return(function(x,y){var j,k,E,T=zs(x),_=Or(T[1][0].data)>>>0,R=Or(T[2][0].data)>>>0,q=((x=(q=T[8])==null?void 0:q[0])==null?void 0:x.data)&&0<Or(T[8][0].data)||!1;if((x=(x=T[7])==null?void 0:x[0])!=null&&x.data&&y!=0)k=(j=(j=T[7])==null?void 0:j[0])==null?void 0:j.data,E=(j=(j=T[6])==null?void 0:j[0])==null?void 0:j.data;else{if((j=(j=T[4])==null?void 0:j[0])==null||!j.data||y==1)throw"NUMBERS Tile missing ".concat(y," cell storage");k=(y=(y=T[4])==null?void 0:y[0])==null?void 0:y.data,E=(T=(T=T[3])==null?void 0:T[0])==null?void 0:T.data}for(var I=q?4:1,J=va(k),Y=[],z=0;z<k.length/2;++z){var X=J.getUint16(2*z,!0);X<65535&&Y.push([z,X])}if(Y.length!=R)throw"Expected ".concat(R," cells, found ").concat(Y.length);for(var ie=[],z=0;z<Y.length-1;++z)ie[Y[z][0]]=E.subarray(Y[z][1]*I,Y[z+1][1]*I);return 1<=Y.length&&(ie[Y[Y.length-1][0]]=E.subarray(Y[Y.length-1][1]*I)),{R:_,cells:ie}})(b,h)});return{nrows:Or(u[4][0].data)>>>0,data:g.reduce(function(b,x){return b[x.R]||(b[x.R]=[]),x.cells.forEach(function(y,j){if(b[x.R][j])throw new Error("Duplicate cell r=".concat(x.R," c=").concat(j));b[x.R][j]=y}),b},[])}}function Af(r,g){var u={"!ref":"A1"},h=r[hs(zs(g.data)[2][0].data)],g=Or(h[0].meta[1][0].data);if(g!=6001)throw new Error("6000 unexpected reference to ".concat(g));return(function(b,j,y){var T=zs(j.data);if((j={s:{r:0,c:0},e:{r:0,c:0}}).e.r=(Or(T[6][0].data)>>>0)-1,j.e.r<0)throw new Error("Invalid row varint ".concat(T[6][0].data));if(j.e.c=(Or(T[7][0].data)>>>0)-1,j.e.c<0)throw new Error("Invalid col varint ".concat(T[7][0].data));y["!ref"]=Ss(j);var j=zs(T[4][0].data),k=Du(b,b[hs(j[4][0].data)][0]),E=(T=j[17])!=null&&T[0]?Du(b,b[hs(j[17][0].data)][0]):[],T=zs(j[3][0].data),_=0;if(T[1].forEach(function(q){var I=zs(q.data),q=b[hs(I[2][0].data)][0],I=Or(q.meta[1][0].data);if(I!=6002)throw new Error("6001 unexpected reference to ".concat(I));q=Tu(0,q),q.data.forEach(function(J,Y){J.forEach(function(z,X){X=vs({r:_+Y,c:X}),z=Og(z,k,E),z&&(y[X]=z)})}),_+=q.nrows}),(T=j[13])!=null&&T[0]){if(T=b[hs(j[13][0].data)][0],j=Or(T.meta[1][0].data),j!=6144)throw new Error("Expected merge type 6144, found ".concat(j));y["!merges"]=(T=zs(T.data))==null?void 0:T[1].map(function(q){var I=zs(q.data),q=va(zs(I[1][0].data)[1][0].data),I=va(zs(I[2][0].data)[1][0].data);return{s:{r:q.getUint16(0,!0),c:q.getUint16(2,!0)},e:{r:q.getUint16(0,!0)+I.getUint16(0,!0)-1,c:q.getUint16(2,!0)+I.getUint16(2,!0)-1}}})}})(r,h[0],u),u}function Pg(r,d){var u=Pf(),h=zs(d.data);if((d=h[2])!=null&&d[0])throw new Error("Keynote presentations are not supported");if(Eu(h[1],hs).forEach(function(g){r[g].forEach(function(b){var x,y,j,k;Or(b.meta[1][0].data)==2&&(y=r,b=zs((j=b).data),k={name:(j=b[1])!=null&&j[0]?Co(b[1][0].data):"",sheets:[]},Eu(b[2],hs).forEach(function(E){y[E].forEach(function(T){Or(T.meta[1][0].data)==6e3&&k.sheets.push(Af(y,T))})}),(x=k).sheets.forEach(function(E,T){zu(u,E,T==0?x.name:x.name+"_"+T,!0)}))})}),u.SheetNames.length==0)throw new Error("Empty NUMBERS file");return u}function _u(r){var d={},u=[];if(r.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var b,x;try{b=Ja(g.content)}catch(y){return console.log("?? "+g.content.length+" "+(y.message||y))}try{x=On(b)}catch(y){return console.log("## "+(y.message||y))}x.forEach(function(y){d[y.id]=y.messages,u.push(y.id)})}}),!u.length)throw new Error("File has no messages");if((r=(r=(r=(r=d?.[1])==null?void 0:r[0])==null?void 0:r.meta)==null?void 0:r[1])!=null&&r[0].data&&Or(d[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var h=((r=(r=(r=(r=d?.[1])==null?void 0:r[0])==null?void 0:r.meta)==null?void 0:r[1])==null?void 0:r[0].data)&&Or(d[1][0].meta[1][0].data)==1&&d[1][0];if(h||u.forEach(function(g){d[g].forEach(function(b){if(Or(b.meta[1][0].data)>>>0==1){if(h)throw new Error("Document has multiple roots");h=b}})}),!h)throw new Error("Cannot find Document root");return Pg(d,h)}function Hd(r,d){if(!d||!d.numbers)throw new Error("Must pass a `numbers` option -- check the README");var u=r.Sheets[r.SheetNames[0]];1<r.SheetNames.length&&console.error("The Numbers writer currently writes only the first table");var h=Oa(u["!ref"]);h.s.r=h.s.c=0;var g=!1;9<h.e.c&&(g=!0,h.e.c=9),49<h.e.r&&(g=!0,h.e.r=49),g&&console.error("The Numbers writer is currently limited to ".concat(Ss(h)));var b=Ou(u,{range:h,header:1}),x=["~Sh33tJ5~"];b.forEach(function(Ft){return Ft.forEach(function(Mt){typeof Mt=="string"&&x.push(Mt)})});var y={},j=[],k=Zt.read(d.numbers,{type:"base64"});k.FileIndex.map(function(Ft,Mt){return[Ft,k.FullPaths[Mt]]}).forEach(function(Ft){var Mt=Ft[0],Dt=Ft[1];Mt.type==2&&Mt.name.match(/\.iwa/)&&On(Ja(Mt.content)).forEach(function(wt){j.push(wt.id),y[wt.id]={deps:[],location:Dt,type:Or(wt.messages[0].meta[1][0].data)}})}),j.sort(function(Ft,Mt){return Ft-Mt});var E=j.filter(function(Ft){return 1<Ft}).map(function(Ft){return[Ft,Ks(Ft)]});k.FileIndex.map(function(Ft,Mt){return[Ft,k.FullPaths[Mt]]}).forEach(function(Ft){var Mt=Ft[0];Ft[1],Mt.name.match(/\.iwa/)&&On(Ja(Mt.content)).forEach(function(Dt){Dt.messages.forEach(function(wt){E.forEach(function(Yt){Dt.messages.some(function(Jt){return Or(Jt.meta[1][0].data)!=11006&&(function(is,Fs){e:for(var Wt=0;Wt<=is.length-Fs.length;++Wt){for(var St=0;St<Fs.length;++St)if(is[Wt+St]!=Fs[St])continue e;return!0}return!1})(Jt.data,Yt[1])})&&y[Yt[0]].deps.push(Dt.id)})})})});for(var T,_=Zt.find(k,y[1].location),R=On(Ja(_.content)),q=0;q<R.length;++q){var I=R[q];I.id==1&&(T=I)}for(var J=hs(zs(T.messages[0].data)[1][0].data),R=On(Ja((_=Zt.find(k,y[J].location)).content)),q=0;q<R.length;++q)(I=R[q]).id==J&&(T=I);var pt=zs(T.messages[0].data);for(pt[1]=[{type:2,data:Rg(r.SheetNames[0])}],T.messages[0].data=Pr(pt),_.content=So(il(R)),_.size=_.content.length,J=hs(pt[2][0].data),R=On(Ja((_=Zt.find(k,y[J].location)).content)),q=0;q<R.length;++q)(I=R[q]).id==J&&(T=I);for(J=hs(zs(T.messages[0].data)[2][0].data),R=On(Ja((_=Zt.find(k,y[J].location)).content)),q=0;q<R.length;++q)(I=R[q]).id==J&&(T=I);g=zs(T.messages[0].data),g[6][0].data=Ks(h.e.r+1),g[7][0].data=Ks(h.e.c+1);for(var Y=hs(g[46][0].data),d=Zt.find(k,y[Y].location),z=On(Ja(d.content)),X=0;X<z.length&&z[X].id!=Y;++X);if(z[X].id!=Y)throw"Bad ColumnRowUIDMapArchive";var ie=zs(z[X].messages[0].data);ie[1]=[],ie[2]=[],ie[3]=[];for(var le=0;le<=h.e.c;++le)ie[1].push({type:2,data:Pr([[],[{type:0,data:Ks(le+420690)}],[{type:0,data:Ks(le+420690)}]])}),ie[2].push({type:0,data:Ks(le)}),ie[3].push({type:0,data:Ks(le)});ie[4]=[],ie[5]=[],ie[6]=[];for(var Ae=0;Ae<=h.e.r;++Ae)ie[4].push({type:2,data:Pr([[],[{type:0,data:Ks(Ae+726270)}],[{type:0,data:Ks(Ae+726270)}]])}),ie[5].push({type:0,data:Ks(Ae)}),ie[6].push({type:0,data:Ks(Ae)});if(z[X].messages[0].data=Pr(ie),d.content=So(il(z)),d.size=d.content.length,delete g[46],r=zs(g[4][0].data),r[7][0].data=Ks(h.e.r+1),pt=hs(zs(r[1][0].data)[2][0].data),(z=On(Ja((d=Zt.find(k,y[pt].location)).content)))[0].id!=pt)throw"Bad HeaderStorageBucket";for(var Ve=zs(z[0].messages[0].data),Ae=0;Ae<b.length;++Ae){var Oe=zs(Ve[2][0].data);Oe[1][0].data=Ks(Ae),Oe[4][0].data=Ks(b[Ae].length),Ve[2][Ae]={type:Ve[2][0].type,data:Pr(Oe)}}z[0].messages[0].data=Pr(Ve),d.content=So(il(z)),d.size=d.content.length;var Je,pt=hs(r[2][0].data);if((z=On(Ja((d=Zt.find(k,y[pt].location)).content)))[0].id!=pt)throw"Bad HeaderStorageBucket";for(Ve=zs(z[0].messages[0].data),le=0;le<=h.e.c;++le)(Oe=zs(Ve[2][0].data))[1][0].data=Ks(le),Oe[4][0].data=Ks(h.e.r+1),Ve[2][le]={type:Ve[2][0].type,data:Pr(Oe)};z[0].messages[0].data=Pr(Ve),d.content=So(il(z)),d.size=d.content.length,u["!merges"]&&(Vt=(function(Ft){for(var Mt=927262;Mt<2e6;++Mt)if(!y[Mt])return y[Mt]=Ft,Mt;throw new Error("Too many messages")})({type:6144,deps:[J],location:y[J].location}),Je=[[],[]],u["!merges"].forEach(function(Ft){Je[1].push({type:2,data:Pr([[],[{type:2,data:Pr([[],[{type:5,data:new Uint8Array(new Uint16Array([Ft.s.r,Ft.s.c]).buffer)}]])}],[{type:2,data:Pr([[],[{type:5,data:new Uint8Array(new Uint16Array([Ft.e.r-Ft.s.r+1,Ft.e.c-Ft.s.c+1]).buffer)}]])}]])})}),r[13]=[{type:2,data:Pr([[],[{type:0,data:Ks(Vt)}]])}],R.push({id:Vt,messages:[(Ct=6144,Vt=Pr(Je),{meta:[[],[{type:0,data:Ks(Ct)}]],data:Vt})]}));var xt=hs(r[4][0].data);(function(){for(var Ft,Mt=Zt.find(k,y[xt].location),Dt=On(Ja(Mt.content)),wt=0;wt<Dt.length;++wt){var Yt=Dt[wt];Yt.id==xt&&(Ft=Yt)}var Jt=zs(Ft.messages[0].data);Jt[3]=[],x.forEach(function(is,Fs){Jt[3].push({type:2,data:Pr([[],[{type:0,data:Ks(Fs)}],[{type:0,data:Ks(1)}],[{type:2,data:Rg(is)}]])})}),Ft.messages[0].data=Pr(Jt),Mt.content=So(il(Dt)),Mt.size=Mt.content.length})();var at=zs(r[3][0].data),Ct=at[1][0];delete at[2];var Ct,Vt,Vt=zs(Ct.data),Ut=hs(Vt[2][0].data);return(function(){for(var Ft,Mt=Zt.find(k,y[Ut].location),Dt=On(Ja(Mt.content)),wt=0;wt<Dt.length;++wt){var Yt=Dt[wt];Yt.id==Ut&&(Ft=Yt)}var Jt=zs(Ft.messages[0].data);delete Jt[6],delete at[7];var is=new Uint8Array(Jt[5][0].data);Jt[5]=[];for(var Fs=0,Wt=0;Wt<=h.e.r;++Wt){var St=zs(is);Fs+=(function(xs,Hs,Is){var tr,Ir;if((tr=xs[6])==null||!tr[0]||(Ir=xs[7])==null||!Ir[0])throw"Mutation only works on post-BNC storages!";if((Ir=(Ir=xs[8])==null?void 0:Ir[0])!=null&&Ir.data&&0<Or(xs[8][0].data))throw"Math only works with normal offsets";for(var Fe,sr,qs=0,fa=va(xs[7][0].data),Pn=0,ge=[],it=va(xs[4][0].data),Ee=0,rt=[],Ce=0;Ce<Hs.length;++Ce)if(Hs[Ce]!=null){switch(fa.setUint16(2*Ce,Pn,!0),it.setUint16(2*Ce,Ee,!0),typeof Hs[Ce]){case"string":Fe=Ao({t:"s",v:Hs[Ce]},Is),sr=Sf({t:"s",v:Hs[Ce]},Is);break;case"number":Fe=Ao({t:"n",v:Hs[Ce]},Is),sr=Sf({t:"n",v:Hs[Ce]},Is);break;case"boolean":Fe=Ao({t:"b",v:Hs[Ce]},Is),sr=Sf({t:"b",v:Hs[Ce]},Is);break;default:throw new Error("Unsupported value "+Hs[Ce])}ge.push(Fe),Pn+=Fe.length,rt.push(sr),Ee+=sr.length,++qs}else fa.setUint16(2*Ce,65535,!0),it.setUint16(2*Ce,65535);for(xs[2][0].data=Ks(qs);Ce<xs[7][0].data.length/2;++Ce)fa.setUint16(2*Ce,65535,!0),it.setUint16(2*Ce,65535,!0);return xs[6][0].data=nl(ge),xs[3][0].data=nl(rt),qs})(St,b[Wt],x),St[1][0].data=Ks(Wt),Jt[5].push({data:Pr(St),type:2})}Jt[1]=[{type:0,data:Ks(h.e.c+1)}],Jt[2]=[{type:0,data:Ks(h.e.r+1)}],Jt[3]=[{type:0,data:Ks(Fs)}],Jt[4]=[{type:0,data:Ks(h.e.r+1)}],Ft.messages[0].data=Pr(Jt),Mt.content=So(il(Dt)),Mt.size=Mt.content.length})(),Ct.data=Pr(Vt),r[3][0].data=Pr(at),g[4][0].data=Pr(r),T.messages[0].data=Pr(g),_.content=So(il(R)),_.size=_.content.length,k}function Vd(r){return function(d){for(var u=0;u!=r.length;++u){var h=r[u];d[h[0]]===void 0&&(d[h[0]]=h[1]),h[2]==="n"&&(d[h[0]]=Number(d[h[0]]))}}}function Ef(r){Vd([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function Fu(r){Vd([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function s1(r,d){if(!r)return 0;try{r=d.map(function(u){return u.id||(u.id=u.strRelID),[u.name,r["!id"][u.id].Target,(u=r["!id"][u.id].Type,-1<ks.WS.indexOf(u)?"sheet":ks.CS&&u==ks.CS?"chart":ks.DS&&u==ks.DS?"dialog":ks.MS&&u==ks.MS?"macro":u&&u.length?u:"sheet")]})}catch{return null}return r&&r.length!==0?r:null}function r1(r,d,u,h,g,b,x,y,j,k,E,T){try{b[h]=so(Ma(r,u,!0),d);var _=zr(r,d);switch(y){case"sheet":I=pu(_,d,g,j,b[h],k,E,T);break;case"chart":if(!(I=yg(_,d,g,j,b[h],k))||!I["!drawel"])break;var q=Nr(I["!drawel"].Target,d),R=vl(q),z=Nr((z=Ma(r,q,!0),R=so(Ma(r,R,!0),q),z?(z=(z.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],R["!id"][z].Target):"??"),q),q=vl(z),I=br(Ma(r,z,!0),0,0,so(Ma(r,q,!0),z),0,I);break;case"macro":Y=d,b[h],Y.slice(-4),I={"!type":"macro"};break;case"dialog":Y=d,b[h],Y.slice(-4),I={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+y)}x[h]=I;var J=[];b&&b[h]&&wr(b[h]).forEach(function(X){var ie,le,Ae,Ve,Oe,Je,pt="";if(b[h][X].Type==ks.CMNT){pt=Nr(b[h][X].Target,d);var xt=Ll(zr(r,pt,!0),pt,j);if(!xt||!xt.length)return;tf(I,xt,!1)}b[h][X].Type==ks.TCMNT&&(pt=Nr(b[h][X].Target,d),J=J.concat((ie=zr(r,pt,!0),le=j,Ve=!(Ae=[]),Oe={},Je=0,ie.replace(Mr,function(at,Ct){var Vt=gs(at);switch(An(Vt[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":Oe={author:Vt.personId,guid:Vt.id,ref:Vt.ref,T:1};break;case"</threadedComment>":Oe.t!=null&&Ae.push(Oe);break;case"<text>":case"<text":Je=Ct+at.length;break;case"</text>":Oe.t=ie.slice(Je,Ct).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":Ve=!0;break;case"</mentions>":Ve=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":Ve=!0;break;case"</ext>":Ve=!1;break;default:if(!Ve&&le.WTF)throw new Error("unrecognized "+Vt[0]+" in threaded comments")}return at}),Ae)))}),J&&J.length&&tf(I,J,!0,j.people||[])}catch(X){if(j.WTF)throw X}var Y,z}function Nn(r){return r.charAt(0)=="/"?r.slice(1):r}function Df(r,d){if(ql(),Ef(d=d||{}),ca(r,"META-INF/manifest.xml")||ca(r,"objectdata.xml"))return ko(r,d);if(ca(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(r.FileIndex)return _u(r);var u=Zt.utils.cfb_new();return ui(r).forEach(function(Dt){cs(u,Dt,(function(Yt,Jt,is){return Sn(qr(Yt,Jt))})(r,Dt))}),_u(u)}if(!ca(r,"[Content_Types].xml"))throw ca(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ca(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var h,g,b=ui(r),x=(function(Dt){var wt=yl();if(!Dt||!Dt.match)return wt;var Yt={};if((Dt.match(Mr)||[]).forEach(function(Jt){var is=gs(Jt);switch(is[0].replace(qn,"<")){case"<?xml":break;case"<Types":wt.xmlns=is["xmlns"+(is[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":Yt[is.Extension]=is.ContentType;break;case"<Override":wt[Jo[is.ContentType]]!==void 0&&wt[Jo[is.ContentType]].push(is.PartName)}}),wt.xmlns!==Yr.CT)throw new Error("Unknown Namespace: "+wt.xmlns);return wt.calcchain=0<wt.calcchains.length?wt.calcchains[0]:"",wt.sst=0<wt.strs.length?wt.strs[0]:"",wt.style=0<wt.styles.length?wt.styles[0]:"",wt.defaults=Yt,delete wt.calcchains,wt})(Ma(r,"[Content_Types].xml")),Oe=!1;if(x.workbooks.length===0&&zr(r,g="xl/workbook.xml",!0)&&x.workbooks.push(g),x.workbooks.length===0){if(!zr(r,g="xl/workbook.bin",!0))throw new Error("Could not find workbook");x.workbooks.push(g),Oe=!0}x.workbooks[0].slice(-3)=="bin"&&(Oe=!0);var y={},j={};if(!d.bookSheets&&!d.bookProps){if(xc=[],x.sst)try{xc=bu(zr(r,Nn(x.sst)),x.sst,d)}catch(Dt){if(d.WTF)throw Dt}d.cellStyles&&x.themes.length&&(q=Ma(r,x.themes[0].replace(/^\//,""),!0)||"",x.themes[0],y=Dl(q,d)),x.style&&(j=xu(zr(r,Nn(x.style)),x.style,y,d))}x.links.map(function(Dt){try{return so(Ma(r,vl(Nn(Dt))),Dt),Rl(zr(r,Nn(Dt)),0,Dt,d)}catch{}});var k,E,T,_=bf(zr(r,Nn(x.workbooks[0])),x.workbooks[0],d),R={},q="";x.coreprops.length&&((q=zr(r,Nn(x.coreprops[0]),!0))&&(R=pi(q)),x.extprops.length!==0&&(q=zr(r,Nn(x.extprops[0]),!0))&&(I=d,T={},E=(E=R)||{},k=qe(k=q),fn.forEach(function(Dt){var wt=(k.match(Be(Dt[0]))||[])[1];switch(Dt[2]){case"string":wt&&(E[Dt[1]]=ys(wt));break;case"bool":E[Dt[1]]=wt==="true";break;case"raw":var Yt=k.match(new RegExp("<"+Dt[0]+"[^>]*>([\\s\\S]*?)</"+Dt[0]+">"));Yt&&0<Yt.length&&(T[Dt[1]]=Yt[1])}}),T.HeadingPairs&&T.TitlesOfParts&&vh(T.HeadingPairs,T.TitlesOfParts,E,I)));var I={};d.bookSheets&&!d.bookProps||x.custprops.length!==0&&(q=Ma(r,Nn(x.custprops[0]),!0))&&(I=(function(Dt,wt){var Yt={},Jt="",is=Dt.match(Dm);if(is)for(var Fs=0;Fs!=is.length;++Fs){var Wt=is[Fs],St=gs(Wt);switch(St[0]){case"<?xml":case"<Properties":break;case"<property":Jt=ys(St.name);break;case"</property>":Jt=null;break;default:if(Wt.indexOf("<vt:")===0){var xs=Wt.split(">"),Hs=xs[0].slice(4),Is=xs[1];switch(Hs){case"lpstr":case"bstr":case"lpwstr":Yt[Jt]=ys(Is);break;case"bool":Yt[Jt]=hr(Is);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":Yt[Jt]=parseInt(Is,10);break;case"r4":case"r8":case"decimal":Yt[Jt]=parseFloat(Is);break;case"filetime":case"date":Yt[Jt]=Ts(Is);break;case"cy":case"error":Yt[Jt]=ys(Is);break;default:if(Hs.slice(-1)=="/")break;wt.WTF&&typeof console<"u"&&console.warn("Unexpected",Wt,Hs,xs)}}else if(Wt.slice(0,2)!=="</"&&wt.WTF)throw new Error(Wt)}}return Yt})(q,d));var J={};if((d.bookSheets||d.bookProps)&&(_.Sheets?h=_.Sheets.map(function(Dt){return Dt.name}):R.Worksheets&&0<R.SheetNames.length&&(h=R.SheetNames),d.bookProps&&(J.Props=R,J.Custprops=I),d.bookSheets&&h!==void 0&&(J.SheetNames=h),d.bookSheets?J.SheetNames:d.bookProps))return J;h={},q={},d.bookDeps&&x.calcchain&&(q=ha(zr(r,Nn(x.calcchain)),x.calcchain));var Y,z,X=0,ie={},le=_.Sheets;R.Worksheets=le.length,R.SheetNames=[];for(var Ae=0;Ae!=le.length;++Ae)R.SheetNames[Ae]=le[Ae].name;var Ve=Oe?"bin":"xml",Oe=x.workbooks[0].lastIndexOf("/"),Je=(x.workbooks[0].slice(0,Oe+1)+"_rels/"+x.workbooks[0].slice(Oe+1)+".rels").replace(/^\//,"");ca(r,Je)||(Je="xl/_rels/workbook."+Ve+".rels");var pt,xt,at,Ct=so(Ma(r,Je,!0),Je.replace(/_rels.*/,"s5s"));1<=(x.metadata||[]).length&&(d.xlmeta=kc(zr(r,Nn(x.metadata[0])),x.metadata[0],d)),1<=(x.people||[]).length&&(d.people=(Oe=zr(r,Nn(x.people[0])),pt=d,at=!(xt=[]),Oe.replace(Mr,function(Dt){var wt=gs(Dt);switch(An(wt[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":xt.push({name:wt.displayname,id:wt.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":at=!0;break;case"</ext>":at=!1;break;default:if(!at&&pt.WTF)throw new Error("unrecognized "+wt[0]+" in threaded comments")}return Dt}),xt)),Ct=Ct&&s1(Ct,_.Sheets);var Vt=zr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(X=0;X!=R.Worksheets;++X){var Ut="sheet";if(Ct&&Ct[X]?(Y="xl/"+Ct[X][1].replace(/[\/]?xl\//,""),ca(r,Y)||(Y=Ct[X][1]),ca(r,Y)||(Y=Je.replace(/_rels\/.*$/,"")+Ct[X][1]),Ut=Ct[X][2]):Y=(Y="xl/worksheets/sheet"+(X+1-Vt)+"."+Ve).replace(/sheet0\./,"sheet."),z=Y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),d&&d.sheets!=null)switch(typeof d.sheets){case"number":if(X!=d.sheets)continue e;break;case"string":if(R.SheetNames[X].toLowerCase()!=d.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(d.sheets)){for(var Ft=!1,Mt=0;Mt!=d.sheets.length;++Mt)typeof d.sheets[Mt]=="number"&&d.sheets[Mt]==X&&(Ft=1),typeof d.sheets[Mt]=="string"&&d.sheets[Mt].toLowerCase()==R.SheetNames[X].toLowerCase()&&(Ft=1);if(!Ft)continue e}}r1(r,Y,z,R.SheetNames[X],X,ie,h,Ut,d,_,y,j)}return J={Directory:x,Workbook:_,Props:R,Custprops:I,Deps:q,Sheets:h,SheetNames:R.SheetNames,Strings:xc,Styles:j,Themes:y,SSF:Ys(V)},d&&d.bookFiles&&(r.files?(J.keys=b,J.files=r.files):(J.keys=[],J.files={},r.FullPaths.forEach(function(Dt,wt){Dt=Dt.replace(/^Root Entry[\/]/,""),J.keys.push(Dt),J.files[Dt]=r.FileIndex[wt]}))),d&&d.bookVBA&&(0<x.vba.length?J.vbaraw=zr(r,Nn(x.vba[0]),!0):x.defaults&&x.defaults.bin===na&&(J.vbaraw=zr(r,"xl/vbaProject.bin",!0))),J}function mr(r,d){var u,h=d||{},g="Workbook",b=Zt.find(r,g);try{if(g="/!DataSpaces/Version",!(b=Zt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(x=b.content,(u={}).id=x.read_shift(0,"lpp4"),u.R=si(x,4),u.U=si(x,4),u.W=si(x,4),g="/!DataSpaces/DataSpaceMap",!(b=Zt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);var x=Oh(b.content);if(x.length!==1||x[0].comps.length!==1||x[0].comps[0].t!==0||x[0].name!=="StrongEncryptionDataSpace"||x[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+g);if(g="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(b=Zt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(x=(function(y){var j=[];y.l+=4;for(var k=y.read_shift(4);0<k--;)j.push(y.read_shift(0,"lpp4"));return j})(b.content),x.length!=1||x[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+g);if(g="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(b=Zt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);Im(b.content)}catch{}if(g="/EncryptionInfo",!(b=Zt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(d=Bm(b.content),g="/EncryptedPackage",!(b=Zt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],b.content,h.password||"",h);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],b.content,h.password||"",h);throw new Error("File is password-protected")}function Tf(r,d){return(d.bookType=="ods"?al:d.bookType=="numbers"?Hd:d.bookType=="xlsb"?function(u,h){Tl=1024,u&&!u.SSF&&(u.SSF=Ys(V)),u&&u.SSF&&(ql(),Bo(u.SSF),h.revssf=Fi(u.SSF),h.revssf[u.SSF[65535]]=0,h.ssf=u.SSF),h.rels={},h.wbrels={},h.Strings=[],h.Strings.Count=0,h.Strings.Unique=0,bc?h.revStrings=new Map:(h.revStrings={},h.revStrings.foo=[],delete h.revStrings.foo);var g=h.bookType=="xlsb"?"bin":"xml",b=-1<ba.indexOf(h.bookType),x=yl();Fu(h=h||{});var y=Gc(),j="",k=0;if(h.cellXfs=[],Ji(h.cellXfs,{},{revssf:{General:0}}),u.Props||(u.Props={}),cs(y,j="docProps/core.xml",rd(u.Props,h)),x.coreprops.push(j),nr(h.rels,2,j,ks.CORE_PROPS),j="docProps/app.xml",!u.Props||!u.Props.SheetNames)if(u.Workbook&&u.Workbook.Sheets){for(var E=[],T=0;T<u.SheetNames.length;++T)(u.Workbook.Sheets[T]||{}).Hidden!=2&&E.push(u.SheetNames[T]);u.Props.SheetNames=E}else u.Props.SheetNames=u.SheetNames;for(u.Props.Worksheets=u.Props.SheetNames.length,cs(y,j,E0(u.Props)),x.extprops.push(j),nr(h.rels,3,j,ks.EXT_PROPS),u.Custprops!==u.Props&&0<wr(u.Custprops||{}).length&&(cs(y,j="docProps/custom.xml",mn(u.Custprops)),x.custprops.push(j),nr(h.rels,4,j,ks.CUST_PROPS)),k=1;k<=u.SheetNames.length;++k){var _,R,q,I={"!id":{}},J=u.Sheets[u.SheetNames[k-1]];cs(y,j="xl/worksheets/sheet"+k+"."+g,(function(Y,z,X,ie,le){return(z.slice(-4)===".bin"?ar:hu)(Y,X,ie,le)})(k-1,j,h,u,I)),x.sheets.push(j),nr(h.wbrels,-1,"worksheets/sheet"+k+"."+g,ks.WS[0]),J&&(_=J["!comments"],R=!1,q="",_&&0<_.length&&(cs(y,q="xl/comments"+k+"."+g,(function(Y,z,X){return(z.slice(-4)===".bin"?sf:ag)(Y)})(_,q)),x.comments.push(q),nr(I,-1,"../comments"+k+"."+g,ks.CMNT),R=!0),J["!legacy"]&&R&&cs(y,"xl/drawings/vmlDrawing"+k+".vml",ef(k,J["!comments"])),delete J["!comments"],delete J["!legacy"]),I["!id"].rId1&&cs(y,vl(j),_n(I))}return h.Strings!=null&&0<h.Strings.length&&(cs(y,j="xl/sharedStrings."+g,(function(Y,z,X){return(z.slice(-4)===".bin"?Qi:pd)(Y,X)})(h.Strings,j,h)),x.strs.push(j),nr(h.wbrels,-1,"sharedStrings."+g,ks.SST)),cs(y,j="xl/workbook."+g,(function(Y,z,X){return(z.slice(-4)===".bin"?Xa:gu)(Y)})(u,j)),x.workbooks.push(j),nr(h.rels,1,j,ks.WB),cs(y,j="xl/theme/theme1.xml",tu(u.Themes,h)),x.themes.push(j),nr(h.wbrels,-1,"theme/theme1.xml",ks.THEME),cs(y,j="xl/styles."+g,(function(Y,z,X){return(z.slice(-4)===".bin"?Xm:Gh)(Y,X)})(u,j,h)),x.styles.push(j),nr(h.wbrels,-1,"styles."+g,ks.STY),u.vbaraw&&b&&(cs(y,j="xl/vbaProject.bin",u.vbaraw),x.vba.push(j),nr(h.wbrels,-1,"vbaProject.bin",ks.VBA)),cs(y,j="xl/metadata."+g,(function(Y){return(Y.slice(-4)===".bin"?su:Zh)()})(j)),x.metadata.push(j),nr(h.wbrels,-1,"metadata."+g,ks.XLMETA),cs(y,"[Content_Types].xml",k0(x,h)),cs(y,"_rels/.rels",_n(h.rels)),cs(y,"xl/_rels/workbook."+g+".rels",_n(h.wbrels)),delete h.revssf,delete h.ssf,y}:wa)(r,d)}function wa(r,d){Tl=1024,r&&!r.SSF&&(r.SSF=Ys(V)),r&&r.SSF&&(ql(),Bo(r.SSF),d.revssf=Fi(r.SSF),d.revssf[r.SSF[65535]]=0,d.ssf=r.SSF),d.rels={},d.wbrels={},d.Strings=[],d.Strings.Count=0,d.Strings.Unique=0,bc?d.revStrings=new Map:(d.revStrings={},d.revStrings.foo=[],delete d.revStrings.foo);var u="xml",h=-1<ba.indexOf(d.bookType),g=yl();Fu(d=d||{});var b=Gc(),x="",y=0;if(d.cellXfs=[],Ji(d.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),x="docProps/core.xml",cs(b,x,rd(r.Props,d)),g.coreprops.push(x),nr(d.rels,2,x,ks.CORE_PROPS),x="docProps/app.xml",!r.Props||!r.Props.SheetNames)if(r.Workbook&&r.Workbook.Sheets){for(var j=[],k=0;k<r.SheetNames.length;++k)(r.Workbook.Sheets[k]||{}).Hidden!=2&&j.push(r.SheetNames[k]);r.Props.SheetNames=j}else r.Props.SheetNames=r.SheetNames;r.Props.Worksheets=r.Props.SheetNames.length,cs(b,x,E0(r.Props)),g.extprops.push(x),nr(d.rels,3,x,ks.EXT_PROPS),r.Custprops!==r.Props&&0<wr(r.Custprops||{}).length&&(cs(b,x="docProps/custom.xml",mn(r.Custprops)),g.custprops.push(x),nr(d.rels,4,x,ks.CUST_PROPS));var E,T=["SheetJ5"];for(d.tcid=0,y=1;y<=r.SheetNames.length;++y){var _,R,q,I,J={"!id":{}},Y=r.Sheets[r.SheetNames[y-1]];cs(b,x="xl/worksheets/sheet"+y+"."+u,hu(y-1,d,r,J)),g.sheets.push(x),nr(d.wbrels,-1,"worksheets/sheet"+y+"."+u,ks.WS[0]),Y&&(R=!1,q="",(_=Y["!comments"])&&0<_.length&&(I=!1,_.forEach(function(z){z[1].forEach(function(X){X.T==1&&(I=!0)})}),I&&(cs(b,q="xl/threadedComments/threadedComment"+y+"."+u,(function(z,X,ie){var le=[kr,kt("ThreadedComments",null,{xmlns:Yr.TCMNT}).replace(/[\/]>/,">")];return z.forEach(function(Ae){var Ve="";(Ae[1]||[]).forEach(function(Oe,Je){var pt;Oe.T?(Oe.a&&X.indexOf(Oe.a)==-1&&X.push(Oe.a),pt={ref:Ae[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+ie.tcid++).slice(-12)+"}"},Je==0?Ve=pt.id:pt.parentId=Ve,Oe.ID=pt.id,Oe.a&&(pt.personId="{54EE7950-7262-4200-6969-"+("000000000000"+X.indexOf(Oe.a)).slice(-12)+"}"),le.push(kt("threadedComment",_s("text",Oe.t||""),pt))):delete Oe.ID})}),le.push("</ThreadedComments>"),le.join("")})(_,T,d)),g.threadedcomments.push(q),nr(J,-1,"../threadedComments/threadedComment"+y+"."+u,ks.TCMNT)),cs(b,q="xl/comments"+y+"."+u,ag(_)),g.comments.push(q),nr(J,-1,"../comments"+y+"."+u,ks.CMNT),R=!0),Y["!legacy"]&&R&&cs(b,"xl/drawings/vmlDrawing"+y+".vml",ef(y,Y["!comments"])),delete Y["!comments"],delete Y["!legacy"]),J["!id"].rId1&&cs(b,vl(x),_n(J))}return d.Strings!=null&&0<d.Strings.length&&(cs(b,x="xl/sharedStrings.xml",pd(d.Strings,d)),g.strs.push(x),nr(d.wbrels,-1,"sharedStrings.xml",ks.SST)),cs(b,x="xl/workbook.xml",gu(r)),g.workbooks.push(x),nr(d.rels,1,x,ks.WB),cs(b,x="xl/theme/theme1.xml",tu(r.Themes,d)),g.themes.push(x),nr(d.wbrels,-1,"theme/theme1.xml",ks.THEME),cs(b,x="xl/styles.xml",Gh(r,d)),g.styles.push(x),nr(d.wbrels,-1,"styles.xml",ks.STY),r.vbaraw&&h&&(cs(b,x="xl/vbaProject.bin",r.vbaraw),g.vba.push(x),nr(d.wbrels,-1,"vbaProject.bin",ks.VBA)),cs(b,x="xl/metadata.xml",Zh()),g.metadata.push(x),nr(d.wbrels,-1,"metadata.xml",ks.XLMETA),1<T.length&&(cs(b,x="xl/persons/person.xml",(h=T,E=[kr,kt("personList",null,{xmlns:Yr.TCMNT,"xmlns:x":gl[0]}).replace(/[\/]>/,">")],h.forEach(function(z,X){E.push(kt("person",null,{displayName:z,id:"{54EE7950-7262-4200-6969-"+("000000000000"+X).slice(-12)+"}",userId:z,providerId:"None"}))}),E.push("</personList>"),E.join(""))),g.people.push(x),nr(d.wbrels,-1,"persons/person.xml",ks.PEOPLE)),cs(b,"[Content_Types].xml",k0(g,d)),cs(b,"_rels/.rels",_n(d.rels)),cs(b,"xl/_rels/workbook.xml.rels",_n(d.wbrels)),delete d.revssf,delete d.ssf,b}function _f(r,d){var u="";switch((d||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":u=Ne(r.slice(0,12));break;case"binary":u=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(d&&d.type||"undefined"))}return[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3),u.charCodeAt(4),u.charCodeAt(5),u.charCodeAt(6),u.charCodeAt(7)]}function Ff(r,d){var u=0;e:for(;u<r.length;)switch(r.charCodeAt(u)){case 10:case 13:case 32:++u;break;case 60:return qa(r.slice(u),d);default:break e}return Gi.to_workbook(r,d)}function Mf(r,d,u,h){return h?(u.type="string",Gi.to_workbook(r,u)):Gi.to_workbook(d,u)}function Ec(r,d){L();var u=d||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Ec(new Uint8Array(r),((u=Ys(u)).type="array",u));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!u.type&&(u.type=typeof Deno<"u"?"buffer":"array");var h,g,b,x,y,j=r,k=!1;if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),Fl={},u.dateNF&&(Fl.dateNF=u.dateNF),u.type||(u.type=xe&&Buffer.isBuffer(r)?"buffer":"base64"),u.type=="file"&&(u.type=xe?"buffer":"binary",j=(function(T){if(Ba!==void 0)return Ba.readFileSync(T);if(typeof Deno<"u")return Deno.readFileSync(T);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var _=File(T);_.open("r"),_.encoding="binary";var R=_.read();return _.close(),R}catch(q){if(!q.message||!q.message.match(/onstruct/))throw q}throw new Error("Cannot access file "+T)})(r),typeof Uint8Array>"u"||xe||(u.type="array")),u.type=="string"&&(k=!0,u.type="binary",u.codepage=65001,j=(E=r).match(/[^\x00-\x7F]/)?Ke(E):E),u.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var E=new ArrayBuffer(3),E=new Uint8Array(E);if(E.foo="bar",!E.foo)return(u=Ys(u)).type="array",Ec(oe(j),u)}switch((h=_f(j,u))[0]){case 208:if(h[1]===207&&h[2]===17&&h[3]===224&&h[4]===161&&h[5]===177&&h[6]===26&&h[7]===225)return x=Zt.read(j,u),y=u,(Zt.find(x,"EncryptedPackage")?mr:Id)(x,y);break;case 9:if(h[1]<=8)return Id(j,u);break;case 60:return qa(j,u);case 73:if(h[1]===73&&h[2]===42&&h[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(h[1]===68)return(function(T,_){var R=_||{},q=!!R.WTF;R.WTF=!0;try{var I=cd.to_workbook(T,R);return R.WTF=q,I}catch(J){if(R.WTF=q,!J.message.match(/SYLK bad record ID/)&&q)throw J;return Gi.to_workbook(T,_)}})(j,u);break;case 84:if(h[1]===65&&h[2]===66&&h[3]===76)return Eh.to_workbook(j,u);break;case 80:return h[1]===75&&h[2]<9&&h[3]<9?(b=y=j,(g=(g=u)||{}).type||(g.type=xe&&Buffer.isBuffer(y)?"buffer":"base64"),Df(hi(b,g),g)):Mf(r,j,u,k);case 239:return h[3]===60?qa(j,u):Mf(r,j,u,k);case 255:if(h[1]===254)return b=j,(g=u).type=="base64"&&(b=Ne(b)),b=e.utils.decode(1200,b.slice(2),"str"),g.type="binary",Ff(b,g);if(h[1]===0&&h[2]===2&&h[3]===0)return ua.to_workbook(j,u);break;case 0:if(h[1]===0&&(2<=h[2]&&h[3]===0||h[2]===0&&(h[3]===8||h[3]===9)))return ua.to_workbook(j,u);break;case 3:case 131:case 139:case 140:return I0.to_workbook(j,u);case 123:if(h[1]===92&&h[2]===114&&h[3]===116)return Q0.to_workbook(j,u);break;case 10:case 13:case 32:return(function(T,_){var R="",q=_f(T,_);switch(_.type){case"base64":R=Ne(T);break;case"binary":R=T;break;case"buffer":R=T.toString("binary");break;case"array":R=ur(T);break;default:throw new Error("Unrecognized type "+_.type)}return q[0]==239&&q[1]==187&&q[2]==191&&(R=qe(R)),_.type="binary",Ff(R,_)})(j,u);case 137:if(h[1]===80&&h[2]===78&&h[3]===71)throw new Error("PNG Image File is not a spreadsheet")}return-1<co.indexOf(h[0])&&h[2]<=12&&h[3]<=31?I0.to_workbook(j,u):Mf(r,j,u,k)}function Mu(r,d){return d=d||{},d.type="file",Ec(r,d)}function Wd(r,d){switch(d.type){case"base64":case"binary":break;case"buffer":case"array":d.type="";break;case"file":return Ds(d.file,Zt.write(r,{type:xe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+d.bookType+"' files");default:throw new Error("Unrecognized type "+d.type)}return Zt.write(r,d)}function Lf(r,d){var u={},h=xe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(d.compression&&(u.compression="DEFLATE"),d.password)u.type=h;else switch(d.type){case"base64":u.type="base64";break;case"binary":u.type="string";break;case"string":throw new Error("'string' output type invalid for '"+d.bookType+"' files");case"buffer":case"file":u.type=h;break;default:throw new Error("Unrecognized type "+d.type)}if(r=r.FullPaths?Zt.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[u.type]||u.type,compression:!!d.compression}):r.generate(u),typeof Deno<"u"&&typeof r=="string"){if(d.type=="binary"||d.type=="base64")return r;r=new Uint8Array(Le(r))}return d.password&&typeof encrypt_agile<"u"?Wd(encrypt_agile(r,d.password),d):d.type==="file"?Ds(d.file,r):d.type=="string"?qe(r):r}function ni(r,d,u){var h=(u=u||"")+r;switch(d.type){case"base64":return re(Ke(h));case"binary":return Ke(h);case"string":return r;case"file":return Ds(d.file,h,"utf8");case"buffer":return xe?we(h,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(h):ni(h,{type:"binary"}).split("").map(function(g){return g.charCodeAt(0)})}throw new Error("Unrecognized type "+d.type)}function Dc(r,d){switch(d.type){case"string":case"base64":case"binary":for(var u="",h=0;h<r.length;++h)u+=String.fromCharCode(r[h]);return d.type=="base64"?re(u):d.type=="string"?qe(u):u;case"file":return Ds(d.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+d.type)}}function $d(r,d){L(),rl(r);var u,h=Ys(d||{});return h.cellStyles&&(h.cellNF=!0,h.sheetStubs=!0),h.type!="array"?(u=r,d=Ys((d=h)||{}),Lf(wa(u,d),d)):(h.type="binary",r=$d(r,h),h.type="array",Le(r))}function Lu(r,d){L(),rl(r);var u=Ys(d||{});if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),u.type=="array")return u.type="binary",d=Lu(r,u),u.type="array",Le(d);var h,g,b,x=0;if(u.sheet&&(x=typeof u.sheet=="number"?u.sheet:r.SheetNames.indexOf(u.sheet),!r.SheetNames[x]))throw new Error("Sheet not found: "+u.sheet+" : "+typeof u.sheet);switch(u.bookType||"xlsb"){case"xml":case"xlml":return ni(Ol(r,u),u);case"slk":case"sylk":return ni(cd.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"htm":case"html":return ni(_g(r.Sheets[r.SheetNames[x]],u),u);case"txt":return(function(y,j){switch(j.type){case"base64":return re(y);case"binary":case"string":return y;case"file":return Ds(j.file,y,"binary");case"buffer":return xe?we(y,"binary"):y.split("").map(function(k){return k.charCodeAt(0)})}throw new Error("Unrecognized type "+j.type)})(Of(r.Sheets[r.SheetNames[x]],u),u);case"csv":return ni(Pu(r.Sheets[r.SheetNames[x]],u),u,"\uFEFF");case"dif":return ni(Eh.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"dbf":return Dc(I0.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"prn":return ni(Gi.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"rtf":return ni(Q0.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"eth":return ni(ic.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"fods":return ni(al(r,u),u);case"wk1":return Dc(ua.sheet_to_wk1(r.Sheets[r.SheetNames[x]],u),u);case"wk3":return Dc(ua.book_to_wk3(r,u),u);case"biff2":u.biff||(u.biff=2);case"biff3":u.biff||(u.biff=3);case"biff4":return u.biff||(u.biff=4),Dc(wf(r,u),u);case"biff5":u.biff||(u.biff=5);case"biff8":case"xla":case"xls":return u.biff||(u.biff=8),Wd(ju(r,b=(b=u)||{}),b);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return h=r,b=Ys((g=u)||{}),jd=new zg(g),Lf(Tf(h,b),b);default:throw new Error("Unrecognized bookType |"+u.bookType+"|")}}function Ru(r){var d;r.bookType||((d=r.file.slice(r.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(r.bookType=d.slice(1)),r.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[r.bookType]||r.bookType)}function Ig(r,d,u){return u=u||{},u.type="file",u.file=d,Ru(u),Lu(r,u)}function Rf(r,d,u,h,g,b,x,y){var j=Ur(u),k=y.defval,E=y.raw||!Object.prototype.hasOwnProperty.call(y,"raw"),T=!0,_=g===1?[]:{};if(g!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:u,enumerable:!1})}catch{_.__rowNum__=u}else _.__rowNum__=u;if(!x||r[u])for(var R=d.s.c;R<=d.e.c;++R){var q=x?r[u][R]:r[h[R]+j];if(q!==void 0&&q.t!==void 0){var I=q.v;switch(q.t){case"z":if(I==null)break;continue;case"e":I=I==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+q.t)}if(b[R]!=null){if(I==null)if(q.t=="e"&&I===null)_[b[R]]=null;else if(k!==void 0)_[b[R]]=k;else{if(!E||I!==null)continue;_[b[R]]=null}else _[b[R]]=E&&(q.t!=="n"||q.t==="n"&&y.rawNumbers!==!1)?I:gi(q,I,y);I!=null&&(T=!1)}}else k!==void 0&&b[R]!=null&&(_[b[R]]=k)}return{row:_,isempty:T}}function Ou(r,d){if(r==null||r["!ref"]==null)return[];var u,h={t:"n",v:0},g=0,b=1,x=[],y="",j={s:{r:0,c:0},e:{r:0,c:0}},k=d||{},E=k.range!=null?k.range:r["!ref"];switch(k.header===1?g=1:k.header==="A"?g=2:Array.isArray(k.header)?g=3:k.header==null&&(g=0),typeof E){case"string":j=Ls(E);break;case"number":(j=Ls(r["!ref"])).s.r=E;break;default:j=E}0<g&&(b=0);var T=Ur(j.s.r),_=[],R=[],q=0,I=0,J=Array.isArray(r),Y=j.s.r,z=0,X={};J&&!r[Y]&&(r[Y]=[]);for(var ie,le=k.skipHidden&&r["!cols"]||[],Ae=k.skipHidden&&r["!rows"]||[],z=j.s.c;z<=j.e.c;++z)if(!(le[z]||{}).hidden)switch(_[z]=Tr(z),h=J?r[Y][z]:r[_[z]+T],g){case 1:x[z]=z-j.s.c;break;case 2:x[z]=_[z];break;case 3:x[z]=k.header[z-j.s.c];break;default:if(y=u=gi(h=h??{w:"__EMPTY",t:"s"},null,k),I=X[u]||0){for(;y=u+"_"+I++,X[y];);X[u]=I,X[y]=1}else X[u]=1;x[z]=y}for(Y=j.s.r+b;Y<=j.e.r;++Y)(Ae[Y]||{}).hidden||(ie=Rf(r,j,Y,_,g,x,J,k)).isempty!==!1&&(g===1?k.blankrows===!1:!k.blankrows)||(R[q++]=ie.row);return R.length=q,R}var Bg=/"/g;function ll(r,d,u,h,g,b,x,y){for(var j=!0,k=[],E="",T=Ur(u),_=d.s.c;_<=d.e.c;++_)if(h[_]){var R=y.dense?(r[u]||[])[_]:r[h[_]+T];if(R==null)E="";else if(R.v!=null){j=!1,E=""+(y.rawNumbers&&R.t=="n"?R.v:gi(R,null,y));for(var q,I=0;I!==E.length;++I)if((q=E.charCodeAt(I))===g||q===b||q===34||y.forceQuotes){E='"'+E.replace(Bg,'""')+'"';break}E=="ID"&&(E='"ID"')}else R.f==null||R.F?E="":(j=!1,0<=(E="="+R.f).indexOf(",")&&(E='"'+E.replace(Bg,'""')+'"'));k.push(E)}return y.blankrows===!1&&j?null:k.join(x)}function Pu(r,d){var u=[],h=d??{};if(r==null||r["!ref"]==null)return"";var g=Ls(r["!ref"]),b=h.FS!==void 0?h.FS:",",x=b.charCodeAt(0),y=h.RS!==void 0?h.RS:`
`,j=y.charCodeAt(0),k=new RegExp((b=="|"?"\\|":b)+"+$"),E="",T=[];h.dense=Array.isArray(r);for(var _=h.skipHidden&&r["!cols"]||[],R=h.skipHidden&&r["!rows"]||[],q=g.s.c;q<=g.e.c;++q)(_[q]||{}).hidden||(T[q]=Tr(q));for(var I=0,J=g.s.r;J<=g.e.r;++J)(R[J]||{}).hidden||(E=ll(r,g,J,T,x,j,b,h))!=null&&(!(E=h.strip?E.replace(k,""):E)&&h.blankrows===!1||u.push((I++?y:"")+E));return delete h.dense,u.join("")}function Of(r,d){return(d=d||{}).FS="	",d.RS=`
`,r=Pu(r,d),e===void 0||d.type=="string"?r:(r=e.utils.encode(1200,r,"str"),""+r)}function Iu(E,d,u){var h,g=u||{},b=+!g.skipHeader,x=E||{},y=0,j=0;x&&g.origin!=null&&(typeof g.origin=="number"?y=g.origin:(k=typeof g.origin=="string"?Hr(g.origin):g.origin,y=k.r,j=k.c));var k,E={s:{c:0,r:0},e:{c:j,r:y+d.length-1+b}};x["!ref"]?(k=Ls(x["!ref"]),E.e.c=Math.max(E.e.c,k.e.c),E.e.r=Math.max(E.e.r,k.e.r),y==-1&&(y=k.e.r+1,E.e.r=y+d.length-1+b)):y==-1&&(y=0,E.e.r=d.length-1+b);var T=g.header||[],_=0;d.forEach(function(q,I){wr(q).forEach(function(ie){(_=T.indexOf(ie))==-1&&(T[_=T.length]=ie);var Y=q[ie],z="z",X="",ie=vs({c:j+_,r:y+I+b});h=Bu(x,ie),!Y||typeof Y!="object"||Y instanceof Date?(typeof Y=="number"?z="n":typeof Y=="boolean"?z="b":typeof Y=="string"?z="s":Y instanceof Date?(z="d",g.cellDates||(z="n",Y=Dr(Y)),X=g.dateNF||V[14]):Y===null&&g.nullError&&(z="e",Y=0),h?(h.t=z,h.v=Y,delete h.w,delete h.R,X&&(h.z=X)):x[ie]=h={t:z,v:Y},X&&(h.z=X)):x[ie]=Y})}),E.e.c=Math.max(E.e.c,j+T.length-1);var R=Ur(y);if(b)for(_=0;_<T.length;++_)x[Tr(_+j)+R]={t:"s",v:T[_]};return x["!ref"]=Ss(E),x}function Bu(r,d,u){return typeof d!="string"?Bu(r,vs(typeof d!="number"?d:{r:d,c:u||0})):Array.isArray(r)?(u=Hr(d),r[u.r]||(r[u.r]=[]),r[u.r][u.c]||(r[u.r][u.c]={t:"z"})):r[d]||(r[d]={t:"z"})}function Pf(){return{SheetNames:[],Sheets:{}}}function zu(r,d,u,h){var g=1;if(!u)for(;g<=65535&&r.SheetNames.indexOf(u="Sheet"+g)!=-1;++g,u=void 0);if(!u||65535<=r.SheetNames.length)throw new Error("Too many worksheets");if(h&&0<=r.SheetNames.indexOf(u)){var h=u.match(/(^.*?)(\d+)$/),g=h&&+h[2]||0,b=h&&h[1]||u;for(++g;g<=65535&&r.SheetNames.indexOf(u=b+g)!=-1;++g);}if(Vr(u),0<=r.SheetNames.indexOf(u))throw new Error("Worksheet with name |"+u+"| already exists!");return r.SheetNames.push(u),r.Sheets[u]=d,u}function Uu(r,d,u){return d?(r.l={Target:d},u&&(r.l.Tooltip=u)):delete r.l,r}var Tc,If={encode_col:Tr,encode_row:Ur,encode_cell:vs,encode_range:Ss,decode_col:xl,decode_row:x0,split_cell:function(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Hr,decode_range:Oa,format_cell:gi,sheet_add_aoa:fh,sheet_add_json:Iu,sheet_add_dom:kf,aoa_to_sheet:Xl,json_to_sheet:function(r,d){return Iu(null,r,d)},table_to_sheet:Fg,table_to_book:function(r,d){return Gn(Fg(r,d),d)},sheet_to_csv:Pu,sheet_to_txt:Of,sheet_to_json:Ou,sheet_to_html:_g,sheet_to_formulae:function(r){var d,u="",h="";if(r==null||r["!ref"]==null)return[];for(var g,b=Ls(r["!ref"]),x=[],y=[],j=Array.isArray(r),k=b.s.c;k<=b.e.c;++k)x[k]=Tr(k);for(var E=b.s.r;E<=b.e.r;++E)for(g=Ur(E),k=b.s.c;k<=b.e.c;++k)if(u=x[k]+g,h="",(d=j?(r[E]||[])[k]:r[u])!==void 0){if(d.F!=null){if(u=d.F,!d.f)continue;h=d.f,u.indexOf(":")==-1&&(u=u+":"+u)}if(d.f!=null)h=d.f;else{if(d.t=="z")continue;if(d.t=="n"&&d.v!=null)h=""+d.v;else if(d.t=="b")h=d.v?"TRUE":"FALSE";else if(d.w!==void 0)h="'"+d.w;else{if(d.v===void 0)continue;h=d.t=="s"?"'"+d.v:""+d.v}}y[y.length]=u+"="+h}return y},sheet_to_row_object_array:Ou,sheet_get_cell:Bu,book_new:Pf,book_append_sheet:zu,book_set_sheet_visibility:function(r,d,u){switch(r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]),d=(function(h,g){if(typeof g=="number"){if(0<=g&&h.SheetNames.length>g)return g;throw new Error("Cannot find sheet # "+g)}if(typeof g!="string")throw new Error("Cannot find sheet |"+g+"|");if(-1<(h=h.SheetNames.indexOf(g)))return h;throw new Error("Cannot find sheet name |"+g+"|")})(r,d),r.Workbook.Sheets[d]||(r.Workbook.Sheets[d]={}),u){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+u)}r.Workbook.Sheets[d].Hidden=u},cell_set_number_format:function(r,d){return r.z=d,r},cell_set_hyperlink:Uu,cell_set_internal_link:function(r,d,u){return Uu(r,"#"+d,u)},cell_add_comment:function(r,d,u){r.c||(r.c=[]),r.c.push({t:d,a:u||"SheetJS"})},sheet_set_array_formula:function(r,d,u,h){for(var g=typeof d!="string"?d:Ls(d),b=typeof d=="string"?d:Ss(d),x=g.s.r;x<=g.e.r;++x)for(var y=g.s.c;y<=g.e.c;++y){var j=Bu(r,x,y);j.t="n",j.F=b,delete j.v,x==g.s.r&&y==g.s.c&&(j.f=u,h&&(j.D=!0))}return r},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function kn(r){Tc=r}var Pl={to_json:function(r,d){var u=Tc({objectMode:!0});if(r==null||r["!ref"]==null)return u.push(null),u;var h,g={t:"n",v:0},b=0,x=1,y=[],j="",k={s:{r:0,c:0},e:{r:0,c:0}},E=d||{},T=E.range!=null?E.range:r["!ref"];switch(E.header===1?b=1:E.header==="A"?b=2:Array.isArray(E.header)&&(b=3),typeof T){case"string":k=Ls(T);break;case"number":(k=Ls(r["!ref"])).s.r=T;break;default:k=T}0<b&&(x=0);var _=Ur(k.s.r),R=[],q=0,I=Array.isArray(r),J=k.s.r,Y=0,z={};I&&!r[J]&&(r[J]=[]);for(var X=E.skipHidden&&r["!cols"]||[],ie=E.skipHidden&&r["!rows"]||[],Y=k.s.c;Y<=k.e.c;++Y)if(!(X[Y]||{}).hidden)switch(R[Y]=Tr(Y),g=I?r[J][Y]:r[R[Y]+_],b){case 1:y[Y]=Y-k.s.c;break;case 2:y[Y]=R[Y];break;case 3:y[Y]=E.header[Y-k.s.c];break;default:if(j=h=gi(g=g??{w:"__EMPTY",t:"s"},null,E),q=z[h]||0){for(;j=h+"_"+q++,z[j];);z[h]=q,z[j]=1}else z[h]=1;y[Y]=j}return J=k.s.r+x,u._read=function(){for(;J<=k.e.r;)if(!(ie[J-1]||{}).hidden){var le=Rf(r,k,J,R,b,y,I,E);if(++J,le.isempty===!1||(b===1?E.blankrows!==!1:E.blankrows))return void u.push(le.row)}return u.push(null)},u},to_html:function(r,g){var u=Tc(),h=g||{},g=h.header!=null?h.header:Nf,b=h.footer!=null?h.footer:ir;u.push(g);var x=Oa(r["!ref"]);h.dense=Array.isArray(r),u.push(ku(0,0,h));var y=x.s.r,j=!1;return u._read=function(){if(y>x.e.r)return j||(j=!0,u.push("</table>"+b)),u.push(null);for(;y<=x.e.r;){u.push(jf(r,x,y,h)),++y;break}},u},to_csv:function(r,d){var u=Tc(),h=d??{};if(r==null||r["!ref"]==null)return u.push(null),u;var g=Ls(r["!ref"]),b=h.FS!==void 0?h.FS:",",x=b.charCodeAt(0),y=h.RS!==void 0?h.RS:`
`,j=y.charCodeAt(0),k=new RegExp((b=="|"?"\\|":b)+"+$"),E="",T=[];h.dense=Array.isArray(r);for(var _=h.skipHidden&&r["!cols"]||[],R=h.skipHidden&&r["!rows"]||[],q=g.s.c;q<=g.e.c;++q)(_[q]||{}).hidden||(T[q]=Tr(q));var I=g.s.r,J=!1,Y=0;return u._read=function(){if(!J)return J=!0,u.push("\uFEFF");for(;I<=g.e.r;)if(++I,!(R[I-1]||{}).hidden&&(E=ll(r,g,I-1,T,x,j,b,h),E!=null&&((E=h.strip?E.replace(k,""):E)||h.blankrows!==!1)))return u.push((Y++?y:"")+E);return u.push(null)},u},set_readable:kn},$s=(function(){function r(d,u,h){return this instanceof r?(this.tagName=d,this._attributes=u||{},this._children=h||[],this._prefix="",this):new r(d,u,h)}return r.prototype.createElement=function(){return new r(arguments)},r.prototype.children=function(){return this._children},r.prototype.append=function(d){return this._children.push(d),this},r.prototype.prefix=function(d){return arguments.length==0?this._prefix:(this._prefix=d,this)},r.prototype.attr=function(d,u){if(u==null)return delete this._attributes[d],this;if(arguments.length==0)return this._attributes;if(typeof d=="string"&&arguments.length==1)return this._attributes.attr[d];if(typeof d=="object"&&arguments.length==1)for(var h in d)this._attributes[h]=d[h];else arguments.length==2&&typeof d=="string"&&(this._attributes[d]=u);return this},r.prototype.escapeAttributeValue=function(d){return'"'+d.replace(/\"/g,"&quot;")+'"'},r.prototype.toXml=function(d){var u=(d=d||this)._prefix;if(u+="<"+d.tagName,d._attributes)for(var h in d._attributes)u+=" "+h+"="+this.escapeAttributeValue(""+d._attributes[h]);if(d._children&&0<d._children.length){u+=">";for(var g=0;g<d._children.length;g++)u+=this.toXml(d._children[g]);u+="</"+d.tagName+">"}else u+="/>";return u},r})(),zg=function(r){var d,u=164,h={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},g={};for(d in h)g[h[d]]=d;var b={};return{initialize:function(x){this.$fonts=$s("fonts").attr("count",0).attr("x14ac:knownFonts","1"),this.$fills=$s("fills").attr("count",0),this.$borders=$s("borders").attr("count",0),this.$numFmts=$s("numFmts").attr("count",0),this.$cellStyleXfs=$s("cellStyleXfs"),this.$xf=$s("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0),this.$cellXfs=$s("cellXfs").attr("count",0),this.$cellStyles=$s("cellStyles").append($s("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0)),this.$dxfs=$s("dxfs").attr("count","0"),this.$tableStyles=$s("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4"),this.$styles=$s("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);var y=x.defaultCellStyle||{};return y.font||(y.font={name:"Calibri",sz:"11"}),y.font.name||(y.font.name="Calibri"),y.font.sz||(y.font.sz=11),y.fill||(y.fill={patternType:"none",fgColor:{}}),y.border||(y.border={}),y.numFmt||(y.numFmt=0),this.defaultStyle=y,x=JSON.parse(JSON.stringify(y)),x.fill={patternType:"gray125",fgColor:{}},this.addStyles([y,x]),this},addStyle:function(x){var y=JSON.stringify(x),j=b[y];return j==null?(j=this._addXf(x),b[y]=j):j=b[y],j},addStyles:function(x){var y=this;return x.map(function(j){return y.addStyle(j)})},_duckTypeStyle:function(x){return typeof x=="object"&&(x.patternFill||x.fgColor)?{fill:x}:x.font||x.numFmt||x.border||x.fill?x:this._getStyleCSS(x)},_getStyleCSS:function(x){return x},_addXf:function(x){var y=this._addFont(x.font),j=this._addFill(x.fill),k=this._addBorder(x.border),E=this._addNumFmt(x.numFmt),T=$s("xf").attr("numFmtId",E).attr("fontId",y).attr("fillId",j).attr("borderId",k).attr("xfId","0");return 0<y&&T.attr("applyFont","1"),0<j&&T.attr("applyFill","1"),0<k&&T.attr("applyBorder","1"),0<E&&T.attr("applyNumberFormat","1"),x.alignment&&(E=$s("alignment"),x.alignment.horizontal&&E.attr("horizontal",x.alignment.horizontal),x.alignment.vertical&&E.attr("vertical",x.alignment.vertical),x.alignment.indent&&E.attr("indent",x.alignment.indent),x.alignment.readingOrder&&E.attr("readingOrder",x.alignment.readingOrder),x.alignment.wrapText&&E.attr("wrapText",x.alignment.wrapText),x.alignment.textRotation!=null&&E.attr("textRotation",x.alignment.textRotation),T.append(E).attr("applyAlignment",1)),this.$cellXfs.append(T),T=+this.$cellXfs.children().length,this.$cellXfs.attr("count",T),T-1},_addFont:function(x){if(!x)return 0;var y=$s("font").append($s("sz").attr("val",x.sz||this.defaultStyle.font.sz)).append($s("name").attr("val",x.name||this.defaultStyle.font.name));return x.bold&&y.append($s("b")),x.underline&&y.append($s("u")),x.italic&&y.append($s("i")),x.strike&&y.append($s("strike")),x.outline&&y.append($s("outline")),x.shadow&&y.append($s("shadow")),x.vertAlign&&y.append($s("vertAlign").attr("val",x.vertAlign)),x.color&&(x.color.theme?(y.append($s("color").attr("theme",x.color.theme)),x.color.tint&&y.append($s("tint").attr("theme",x.color.tint))):x.color.rgb&&y.append($s("color").attr("rgb",x.color.rgb))),this.$fonts.append(y),y=this.$fonts.children().length,this.$fonts.attr("count",y),y-1},_addNumFmt:function(x){if(!x)return 0;if(typeof x=="string"){var y=g[x];if(0<=y)return y}return/^[0-9]+$/.exec(x)?x:(x=x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),x=$s("numFmt").attr("numFmtId",++u).attr("formatCode",x),this.$numFmts.append(x),x=this.$numFmts.children().length,this.$numFmts.attr("count",x),u)},_addFill:function(x){if(!x)return 0;var y,j=$s("patternFill").attr("patternType",x.patternType||"solid");return x.fgColor&&(y=$s("fgColor"),x.fgColor.rgb?(x.fgColor.rgb.length==6&&(x.fgColor.rgb="FF"+x.fgColor.rgb),y.attr("rgb",x.fgColor.rgb),j.append(y)):x.fgColor.theme&&(y.attr("theme",x.fgColor.theme),x.fgColor.tint&&y.attr("tint",x.fgColor.tint),j.append(y)),x.bgColor||(x.bgColor={indexed:"64"})),x.bgColor&&(x=$s("bgColor").attr(x.bgColor),j.append(x)),j=$s("fill").append(j),this.$fills.append(j),j=this.$fills.children().length,this.$fills.attr("count",j),j-1},_getSubBorder:function(x,y){var j=$s(x);return y&&(j.attr("style",y.style||"medium"),y.color&&(x=$s("color"),y.color.auto?x.attr("auto",y.color.auto):y.color.rgb?x.attr("rgb",y.color.rgb):(y.color.theme||y.color.tint)&&(x.attr("theme",y.color.theme||"1"),x.attr("tint",y.color.tint||"0")),j.append(x))),j},_addBorder:function(x){if(!x)return 0;var y=this,j=$s("border").attr("diagonalUp",x.diagonalUp).attr("diagonalDown",x.diagonalDown);["left","right","top","bottom","diagonal"].forEach(function(E){j.append(y._getSubBorder(E,x[E]))}),this.$borders.append(j);var k=this.$borders.children().length;return this.$borders.attr("count",k),k-1},toXml:function(){return this.$styles.toXml()}}.initialize(r||{})};Id!==void 0&&(s.parse_xlscfb=Id),s.parse_zip=Df,s.read=Ec,s.readFile=Mu,s.readFileSync=Mu,s.write=Lu,s.writeFile=Ig,s.writeFileSync=Ig,s.writeFileAsync=function(r,d,u,h){var g=u||{};return g.type="file",g.file=r,Ru(g),g.type="buffer",h instanceof Function||(h=u),Ba.writeFile(r,Lu(d,g),h)},s.utils=If,s.writeXLSX=$d,s.writeFileXLSX=function(r,d,u){return(u=u||{}).type="file",u.file=d,Ru(u),$d(r,u)},s.SSF=ah,Pl!==void 0&&(s.stream=Pl),Zt!==void 0&&(s.CFB=Zt),typeof fp>"u"||((Pl=I1)||{}).Readable&&kn(Pl.Readable)}if(o(n),typeof window<"u"&&!window.XLSX)try{window.XLSX=a}catch{}})(np,np.exports)),np.exports}var Kf=R7();function O7(){const{id:l}=ci(),n=Fr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState(!1),[L,M]=B.useState({}),[F,O]=B.useState("day"),[P,G]=B.useState(null),[ae,re]=B.useState({isOpen:!1,metric:null,period:null,channel:null,section:null}),[Ne,xe]=B.useState([]),[we,Z]=B.useState(!1),ce=Lo.useRef(null),ue=B.useMemo(()=>a?{call:a.channels?.coldCalling||!1,linkedin:a.channels?.linkedInOutreach||!1,email:a.channels?.coldEmail||!1}:{call:!1,linkedin:!1,email:!1},[a]);B.useEffect(()=>{if(!l)return;const H=ce.current;H&&H.projectId===l?(o(H.project),e(H.activities),v(H.contacts),M(H.reportData||{}),N(!1)):Le()},[l]);const Le=async()=>{try{N(!0),G(null);const[H,Q,te]=await Promise.all([Ht.get(`/projects/${l}`),Ht.get(`/activities/project/${l}?limit=10000`),Ht.get(`/projects/${l}/project-contacts?limit=10000`)]);let de=a,ve=s,ke=m;H.data.success&&(de=H.data.data,o(de)),Q.data.success&&(ve=Q.data.data||[],e(ve)),te.data.success&&(ke=te.data.data||[],v(ke)),ce.current={projectId:l,project:de,activities:ve,contacts:ke,reportData:L}}catch(H){console.error("Error fetching data:",H),G(H.response?.data?.error||"Failed to load report data. Please try again.")}finally{N(!1)}},be=B.useCallback(H=>{const Q=new Date(H),te=Q.getDate(),de=Q.toLocaleString("default",{month:"short"}),ve=Q.getFullYear().toString().slice(-2);return`${te} ${de} '${ve}`},[]),oe=B.useCallback(H=>{const Q=new Date(H),te=Q.toLocaleString("default",{month:"short"}),de=Q.getFullYear().toString().slice(-2);return`${te} '${de}`},[]),he=B.useCallback(H=>new Date(H).toLocaleString("default",{month:"long"}),[]),ye=B.useMemo(()=>{if(F==="month"){const H=new Set;return s.forEach(te=>{const de=te.callDate?new Date(te.callDate):te.emailDate?new Date(te.emailDate):te.linkedinDate?new Date(te.linkedinDate):te.createdAt?new Date(te.createdAt):null;de&&!isNaN(de.getTime())&&H.add(oe(de))}),m.forEach(te=>{te.createdAt&&H.add(oe(new Date(te.createdAt)))}),[{month:null,periods:Array.from(H).sort((te,de)=>{const[ve,ke]=te.split(" '"),[ne,De]=de.split(" '"),He=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],vt=He.indexOf(ve),Pe=He.indexOf(ne);return ke!==De?parseInt(ke)-parseInt(De):vt-Pe})}]}else{const H={};return s.forEach(te=>{const de=te.callDate?new Date(te.callDate):te.emailDate?new Date(te.emailDate):new Date(te.createdAt);if(de&&!isNaN(de.getTime())){const ve=be(de),ke=oe(de),ne=he(de);H[ke]||(H[ke]={month:ne,monthKey:ke,periods:[]}),H[ke].periods.includes(ve)||H[ke].periods.push(ve)}}),m.forEach(te=>{if(te.createdAt){const de=new Date(te.createdAt),ve=be(de),ke=oe(de),ne=he(de);H[ke]||(H[ke]={month:ne,monthKey:ke,periods:[]}),H[ke].periods.includes(ve)||H[ke].periods.push(ve)}}),Object.keys(H).forEach(te=>{H[te].periods.sort((de,ve)=>{const ke=new Date(de.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3")),ne=new Date(ve.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3"));return ke-ne})}),Object.values(H).sort((te,de)=>{const[ve,ke]=te.monthKey.split(" '"),[ne,De]=de.monthKey.split(" '"),He=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],vt=He.indexOf(ve),Pe=He.indexOf(ne);return ke!==De?parseInt(ke)-parseInt(De):vt-Pe})}},[s,m,F,be,oe,he]),Te=B.useMemo(()=>ye.flatMap(H=>H.periods),[ye]),fe=B.useCallback(()=>{if(s.length===0&&m.length===0){M({});return}D(!0);const Q=setTimeout(()=>{const te={};Te.forEach(ne=>{te[ne]={dataAllocated:0,dataResearch:0,interested:0,notInterested:0,ring:0,busy:0,hangUp:0,callBack:0,switchOff:0,detailsShared:0,future:0,invalid:0,demoBooked:0,followUps:0,totalCalls:0,freshCalls:0,connectionRequestSent:0,connectionAccepted:0,firstMessageSent:0,followupMessagesSent:0,existingConnection:0,conversationsInProgress:0,meetingProposed:0,meetingScheduled:0,meetingCompleted:0,emailsSent:0,noReply:0,outOfOffice:0,wrongPerson:0,bounce:0,optOut:0,totalResponses:0,responseRate:0}}),m.forEach(ne=>{if(ne.createdAt){const De=F==="day"?be(new Date(ne.createdAt)):oe(new Date(ne.createdAt));te[De]&&(te[De].dataAllocated++,te[De].dataResearch++)}});const de=ue.call?s.filter(ne=>ne.type==="call"):[],ve=ue.linkedin?s.filter(ne=>ne.type==="linkedin"):[],ke=ue.email?s.filter(ne=>ne.type==="email"):[];if(ue.call&&de.length>0){const ne=new Map,De={};de.forEach(He=>{const vt=He.callDate?new Date(He.callDate):new Date(He.createdAt);if(!vt||isNaN(vt.getTime()))return;const Pe=F==="day"?be(vt):oe(vt);if(!te[Pe])return;const Nt=He.contactId?.toString()||"unknown";He.callNumber==="1st call"&&!ne.has(Nt)&&ne.set(Nt,Pe),De[Pe]||(De[Pe]={}),De[Pe][Nt]||(De[Pe][Nt]=[]),De[Pe][Nt].push(He)}),de.forEach(He=>{const vt=He.callDate?new Date(He.callDate):new Date(He.createdAt);if(!vt||isNaN(vt.getTime()))return;const Pe=F==="day"?be(vt):oe(vt);if(te[Pe]){if(He.callStatus)switch(He.callStatus){case"Interested":te[Pe].interested++;break;case"Not Interested":te[Pe].notInterested++;break;case"Ring":te[Pe].ring++;break;case"Busy":te[Pe].busy++;break;case"Hang Up":te[Pe].hangUp++;break;case"Call Back":te[Pe].callBack++;break;case"Switch Off":te[Pe].switchOff++;break;case"Details Shared":te[Pe].detailsShared++;break;case"Future":te[Pe].future++;break;case"Invalid":te[Pe].invalid++;break;case"Demo Booked":te[Pe].demoBooked++;break}te[Pe].totalCalls++}}),Object.keys(De).forEach(He=>{const vt=De[He];let Pe=0,Nt=0;Object.keys(vt).forEach(st=>{const Xt=vt[st],Rt=ne.get(st);Xt.forEach(Ns=>{Ns.callNumber==="1st call"||Rt===He&&!Ns.callNumber?Pe++:Nt++})}),te[He]&&(te[He].freshCalls=Pe,te[He].followUps=Nt)})}if(ue.linkedin&&ve.length>0){const ne={};Te.forEach(De=>{ne[De]={connectionRequestSent:new Set,connectionAccepted:new Set,existingConnection:new Set,conversationsInProgress:new Set,meetingProposed:new Set,meetingScheduled:new Set,meetingCompleted:new Set,firstMessageSent:new Set,followupMessagesSent:new Set}}),ve.forEach(De=>{const He=De.linkedinDate?new Date(De.linkedinDate):De.createdAt?new Date(De.createdAt):null;if(!He)return;const vt=De.contactId?.toString()||"unknown",Pe=F==="day"?be(He):oe(He);if(!ne[Pe])return;const Nt=De.template?.trim()||"";(De.lnRequestSent==="Yes"||Nt==="introduction-message")&&ne[Pe].connectionRequestSent.add(vt),De.lnRequestSent==="Existing Connect"&&ne[Pe].existingConnection.add(vt),De.connected==="Yes"&&ne[Pe].connectionAccepted.add(vt),De.status==="CIP"?ne[Pe].conversationsInProgress.add(vt):De.status==="Meeting Proposed"?ne[Pe].meetingProposed.add(vt):De.status==="Meeting Scheduled"?ne[Pe].meetingScheduled.add(vt):De.status==="Meeting Completed"&&ne[Pe].meetingCompleted.add(vt),Nt==="introduction-message"?ne[Pe].firstMessageSent.add(vt):Nt==="follow-up-message"&&ne[Pe].followupMessagesSent.add(vt)}),Te.forEach(De=>{te[De]&&ne[De]&&(te[De].connectionRequestSent=ne[De].connectionRequestSent.size,te[De].connectionAccepted=ne[De].connectionAccepted.size,te[De].existingConnection=ne[De].existingConnection.size,te[De].conversationsInProgress=ne[De].conversationsInProgress.size,te[De].meetingProposed=ne[De].meetingProposed.size,te[De].meetingScheduled=ne[De].meetingScheduled.size,te[De].meetingCompleted=ne[De].meetingCompleted.size,te[De].firstMessageSent=ne[De].firstMessageSent.size,te[De].followupMessagesSent=ne[De].followupMessagesSent.size)})}ue.email&&ke.length>0&&(ke.forEach(ne=>{if(!ne.createdAt)return;const De=F==="day"?be(new Date(ne.createdAt)):oe(new Date(ne.createdAt));if(te[De]){if(te[De].emailsSent++,ne.status)switch(ne.status){case"No Reply":te[De].noReply++;break;case"Out of Office":te[De].outOfOffice++;break;case"Wrong Person":te[De].wrongPerson++;break;case"Bounce":te[De].bounce++;break;case"Opt Out":te[De].optOut++;break}ne.status&&ne.status!=="No Reply"&&ne.status!=="Bounce"&&ne.status!=="Opt Out"&&te[De].totalResponses++}}),Te.forEach(ne=>{te[ne]&&te[ne].emailsSent>0&&(te[ne].responseRate=parseFloat((te[ne].totalResponses/te[ne].emailsSent*100).toFixed(2)))})),M(te),D(!1)},0);return()=>clearTimeout(Q)},[s,m,F,ue,Te,be,oe]);B.useEffect(()=>{fe()},[fe]);const _e=B.useMemo(()=>{const H=[];return ue.call&&!ue.linkedin&&!ue.email?H.push({key:"dataAllocated",label:"Data Allocated",section:"Cold Calling",bold:!1},{key:"interested",label:"Interested",section:"Cold Calling",bold:!0},{key:"notInterested",label:"Not Interested",section:"Cold Calling",bold:!0},{key:"ring",label:"Ring",section:"Cold Calling",bold:!1},{key:"busy",label:"Busy",section:"Cold Calling",bold:!1,highlight:!0},{key:"hangUp",label:"Hang Up",section:"Cold Calling",bold:!1},{key:"callBack",label:"Call Back",section:"Cold Calling",bold:!1},{key:"switchOff",label:"Switch Off",section:"Cold Calling",bold:!1},{key:"detailsShared",label:"Detailed Shared",section:"Cold Calling",bold:!0,highlight:!0},{key:"future",label:"Future",section:"Cold Calling",bold:!1},{key:"invalid",label:"Invalid",section:"Cold Calling",bold:!1},{key:"demoBooked",label:"Demo Booked",section:"Cold Calling",bold:!0,highlight:!0,highlightDark:!0},{key:"followUps",label:"Follow Ups",section:"Cold Calling",bold:!0},{key:"totalCalls",label:"Total Calls",section:"Cold Calling",bold:!0},{key:"freshCalls",label:"(Fresh Calls + FollowUpS)",section:"Cold Calling",bold:!1,isFormula:!0}):ue.linkedin?(H.push({key:"dataResearch",label:"Data Research manually",section:"Linked IN",bold:!1},{key:"connectionRequestSent",label:"Connection Request Sent",section:"Linked IN",bold:!1},{key:"connectionAccepted",label:"Connection Accepted",section:"Linked IN",bold:!1},{key:"firstMessageSent",label:"First Message Sent",section:"Linked IN",bold:!1},{key:"followupMessagesSent",label:"Followup Messages sent",section:"Linked IN",bold:!1},{key:"existingConnection",label:"Existing Connection",section:"Linked IN",bold:!1},{key:"conversationsInProgress",label:"Conversations in Progress",section:"Linked IN",bold:!0,highlight:!0},{key:"meetingProposed",label:"Meeting Proposed",section:"Linked IN",bold:!1,highlight:!0},{key:"meetingScheduled",label:"Meeting Scheduled",section:"Linked IN",bold:!1,highlight:!0},{key:"meetingCompleted",label:"Meeting Completed",section:"Linked IN",bold:!1,highlight:!0}),ue.call&&H.push({key:"dataAllocated",label:"Data Allocated",section:"Cold Calling",bold:!1},{key:"interested",label:"Interested",section:"Cold Calling",bold:!0},{key:"notInterested",label:"Not Interested",section:"Cold Calling",bold:!0},{key:"ring",label:"Ring",section:"Cold Calling",bold:!1},{key:"busy",label:"Busy",section:"Cold Calling",bold:!1,highlight:!0},{key:"hangUp",label:"Hang Up",section:"Cold Calling",bold:!1},{key:"callBack",label:"Call Back",section:"Cold Calling",bold:!1},{key:"switchOff",label:"Switch Off",section:"Cold Calling",bold:!1},{key:"detailsShared",label:"Detailed Shared",section:"Cold Calling",bold:!0,highlight:!0},{key:"future",label:"Future",section:"Cold Calling",bold:!1},{key:"invalid",label:"Invalid",section:"Cold Calling",bold:!1},{key:"demoBooked",label:"Demo Booked",section:"Cold Calling",bold:!0,highlight:!0,highlightDark:!0},{key:"followUps",label:"Follow Ups",section:"Cold Calling",bold:!0},{key:"totalCalls",label:"Total Calls",section:"Cold Calling",bold:!0}),ue.email&&H.push({key:"emailsSent",label:"Emails Sent",section:"Email",bold:!1},{key:"noReply",label:"No Reply",section:"Email",bold:!1},{key:"outOfOffice",label:"Out of Office",section:"Email",bold:!1},{key:"wrongPerson",label:"Wrong Person",section:"Email",bold:!1},{key:"bounce",label:"Bounce",section:"Email",bold:!1},{key:"optOut",label:"Opt Out",section:"Email",bold:!1},{key:"totalResponses",label:"Total Responses",section:"Email",bold:!0},{key:"responseRate",label:"Response Rate (%)",section:"Email",bold:!1})):ue.email&&H.push({key:"emailsSent",label:"Emails Sent",section:"Email",bold:!1},{key:"noReply",label:"No Reply",section:"Email",bold:!1},{key:"outOfOffice",label:"Out of Office",section:"Email",bold:!1},{key:"wrongPerson",label:"Wrong Person",section:"Email",bold:!1},{key:"bounce",label:"Bounce",section:"Email",bold:!1},{key:"optOut",label:"Opt Out",section:"Email",bold:!1},{key:"totalResponses",label:"Total Responses",section:"Email",bold:!0},{key:"responseRate",label:"Response Rate (%)",section:"Email",bold:!1}),H},[ue]),We=B.useMemo(()=>{const H={};return _e.forEach(Q=>{H[Q.section]||(H[Q.section]=[]),H[Q.section].push(Q)}),H},[_e]),se=B.useCallback(H=>H==="Cold Calling"?"call":H==="Linked IN"?"linkedin":H==="Email"?"email":null,[]),me=B.useMemo(()=>{const H={byPeriodAndContact:new Map,byPeriodAndType:new Map,contactPeriods:new Map};return s.forEach(Q=>{if((Q.projectId?.toString?Q.projectId.toString():Q.projectId)!==l)return;const de=Q.callDate?new Date(Q.callDate):Q.emailDate?new Date(Q.emailDate):Q.linkedinDate?new Date(Q.linkedinDate):Q.createdAt?new Date(Q.createdAt):null;if(!de||isNaN(de.getTime()))return;const ve=F==="day"?be(de):oe(de),ke=Q.type;H.byPeriodAndContact.has(ve)||H.byPeriodAndContact.set(ve,new Map);const ne=H.byPeriodAndContact.get(ve);if(Q.contactId){const He=Q.contactId.toString?Q.contactId.toString():Q.contactId;ne.has(He)||ne.set(He,[]),ne.get(He).push(Q),H.contactPeriods.has(He)||H.contactPeriods.set(He,new Set),H.contactPeriods.get(He).add(ve)}H.byPeriodAndType.has(ve)||H.byPeriodAndType.set(ve,new Map);const De=H.byPeriodAndType.get(ve);De.has(ke)||De.set(ke,[]),De.get(ke).push(Q)}),H},[s,l,F,be,oe]),W=B.useCallback((H,Q,te)=>{if(!H||!Q||!te)return[];const de=Ne.length>0?Ne:m;if(s.filter(ne=>ne.type==="linkedin"),te==="all"&&H==="allForPeriod")return de.filter(ne=>{const De=(ne._id?.toString?ne._id.toString():ne._id)||"",He=me.contactPeriods.get(De),vt=He?He.has(Q):!1;let Pe=!1;return ne.createdAt&&(Pe=(F==="day"?be(new Date(ne.createdAt)):oe(new Date(ne.createdAt)))===Q),vt||Pe});const ve=me.byPeriodAndType.get(Q)?.get(te)||[],ke=new Set;return ve.forEach(ne=>{if(ne.contactId){const De=ne.contactId.toString?ne.contactId.toString():ne.contactId;ke.add(De)}}),de.filter(ne=>{const De=(ne._id?.toString?ne._id.toString():ne._id)||"",vt=(me.byPeriodAndContact.get(Q)?.get(De)||[]).filter(Pe=>!(te==="call"&&Pe.type!=="call"||te==="linkedin"&&Pe.type!=="linkedin"||te==="email"&&Pe.type!=="email"));if(te==="call")switch(H){case"interested":return vt.some(Pe=>Pe.callStatus==="Interested");case"notInterested":return vt.some(Pe=>Pe.callStatus==="Not Interested");case"ring":return vt.some(Pe=>Pe.callStatus==="Ring");case"busy":return vt.some(Pe=>Pe.callStatus==="Busy");case"hangUp":return vt.some(Pe=>Pe.callStatus==="Hang Up");case"callBack":return vt.some(Pe=>Pe.callStatus==="Call Back");case"switchOff":return vt.some(Pe=>Pe.callStatus==="Switch Off");case"detailsShared":return vt.some(Pe=>Pe.callStatus==="Details Shared");case"future":return vt.some(Pe=>Pe.callStatus==="Future");case"invalid":return vt.some(Pe=>Pe.callStatus==="Invalid");case"demoBooked":return vt.some(Pe=>Pe.callStatus==="Demo Booked");case"dataAllocated":return ne.createdAt?(F==="day"?be(new Date(ne.createdAt)):oe(new Date(ne.createdAt)))===Q:!1;default:return!1}else if(te==="linkedin"){const Pe=vt.filter(Nt=>Nt.createdAt?(F==="day"?be(new Date(Nt.createdAt)):oe(new Date(Nt.createdAt)))===Q:!1);if(Pe.length===0)return!1;switch(H){case"dataResearch":return ne.createdAt?(F==="day"?be(new Date(ne.createdAt)):oe(new Date(ne.createdAt)))===Q:!1;case"connectionRequestSent":return Pe.some(Nt=>{const st=Nt.template?.trim()||"";return Nt.lnRequestSent==="Yes"||st==="introduction-message"});case"connectionAccepted":return Pe.some(Nt=>Nt.connected==="Yes");case"firstMessageSent":return Pe.some(Nt=>(Nt.template?.trim()||"")==="introduction-message");case"followupMessagesSent":return Pe.some(Nt=>(Nt.template?.trim()||"")==="follow-up-message");case"existingConnection":return Pe.some(Nt=>Nt.lnRequestSent==="Existing Connect");case"conversationsInProgress":return Pe.some(Nt=>Nt.status==="CIP");case"meetingProposed":return Pe.some(Nt=>Nt.status==="Meeting Proposed");case"meetingScheduled":return Pe.some(Nt=>Nt.status==="Meeting Scheduled");case"meetingCompleted":return Pe.some(Nt=>Nt.status==="Meeting Completed");default:return!1}}else if(te==="email")switch(H){case"emailsSent":return vt.length>0;case"noReply":return vt.some(Pe=>Pe.status==="No Reply");case"outOfOffice":return vt.some(Pe=>Pe.status==="Out of Office");case"wrongPerson":return vt.some(Pe=>Pe.status==="Wrong Person");case"bounce":return vt.some(Pe=>Pe.status==="Bounce");case"optOut":return vt.some(Pe=>Pe.status==="Opt Out");case"totalResponses":return vt.some(Pe=>Pe.status&&Pe.status!=="No Reply"&&Pe.status!=="Bounce"&&Pe.status!=="Opt Out");default:return!1}return!1})},[Ne,m,me,s,F,be,oe]);B.useEffect(()=>{ae.isOpen?(Z(!0),m.length>0?(xe(m),Z(!1),m.length<1e3&&Ht.get(`/projects/${l}/project-contacts?limit=10000`).then(H=>{H.data.success&&xe(H.data.data||[])}).catch(H=>{console.error("Error fetching contacts:",H)})):Ht.get(`/projects/${l}/project-contacts?limit=10000`).then(H=>{H.data.success&&xe(H.data.data||[])}).catch(H=>{console.error("Error fetching contacts:",H)}).finally(()=>{Z(!1)})):xe([])},[ae.isOpen,l,m]);const pe=B.useMemo(()=>{if(!ae.isOpen||!ae.metric||!ae.period||!ae.channel)return[];try{return W(ae.metric,ae.period,ae.channel)}catch(H){return console.error("Error filtering prospects:",H),[]}},[ae.isOpen,ae.metric,ae.period,ae.channel,W]),Me=B.useCallback((H,Q,te)=>{const de=se(te);!de||(L[Q]?.[H.key]||0)===0||H.isFormula||re({isOpen:!0,metric:H.key,period:Q,channel:de,section:te})},[L,se]),Se=B.useCallback(H=>{const Q=L[H];!Q||Object.values(Q).every(te=>!te||te===0)||re({isOpen:!0,metric:"allForPeriod",period:H,channel:"all",section:"All Channels"})},[L]),V=B.useCallback(()=>{if(Te.length===0||!L){alert("No data available to export");return}try{const H=Kf.utils.book_new(),Q=[],te=[`Monthly Report - ${a?.companyName||"Report"}`];for(let Xt=0;Xt<Te.length;Xt++)te.push("");Q.push(te);const de=[`${F==="day"?"Day":"Month"} View - Exported on ${new Date().toLocaleDateString()}`];for(let Xt=0;Xt<Te.length;Xt++)de.push("");Q.push(de),Q.push(Array(Te.length+1).fill(""));const ve=["Key Results",...Te];Q.push(ve);let ke=0;const ne=[];ne[ke]={cells:Array(te.length).fill({font:{bold:!0,sz:16,color:{rgb:"1E3A8A"}},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"left",vertical:"center"}}),merge:{s:{r:ke,c:0},e:{r:ke,c:Te.length}}},ke++,ne[ke]={cells:Array(de.length).fill({font:{sz:10,color:{rgb:"6B7280"}},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"left",vertical:"center"}}),merge:{s:{r:ke,c:0},e:{r:ke,c:Te.length}}},ke++,ke++,ne[ke]={cells:Array(ve.length).fill({font:{bold:!0,color:{rgb:"1F2937"},sz:11},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},ke++;const De=Object.values(ue).filter(Boolean).length,He=Object.keys(We);De>1?He.forEach((Xt,Rt)=>{Rt>0&&(Q.push(Array(Te.length+1).fill("")),ke++);const Ns=[Xt];for(let ps=0;ps<Te.length;ps++)Ns.push("");Q.push(Ns),ne[ke]={cells:Array(Ns.length).fill({font:{bold:!0,sz:14,color:{rgb:"1E3A8A"}},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"left",vertical:"center"}}),merge:{s:{r:ke,c:0},e:{r:ke,c:Te.length}}},ke++;const Js=["Key Results",...Te];Q.push(Js),ne[ke]={cells:Array(Js.length).fill({font:{bold:!0,color:{rgb:"1F2937"},sz:11},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},ke++,ye.forEach((ps,ds)=>{if(F==="day"&&ps.month){const Ie=[ps.month];for(let dt=0;dt<Te.length;dt++)Ie.push("");Q.push(Ie),ne[ke]={cells:Array(Ie.length).fill({font:{bold:!0,sz:12,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFF9C4"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}}),merge:{s:{r:ke,c:0},e:{r:ke,c:Te.length}}},ke++}if(ds===0||F==="day"&&ds>0&&ye[ds-1].monthKey!==ps.monthKey){const Ie=[Xt];for(let dt=0;dt<Te.length;dt++)Ie.push("");Q.push(Ie),ne[ke]={cells:Array(Ie.length).fill({font:{bold:!0,sz:11,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFE082"}},alignment:{horizontal:"left",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},ke++,We[Xt].forEach(dt=>{const Tt=[dt.label];Te.forEach(nn=>{let rr="";dt.isFormula?rr=`(${L[nn]?.freshCalls||0} + ${L[nn]?.followUps||0})`:dt.key==="responseRate"?rr=`${L[nn]?.[dt.key]||0}%`:rr=L[nn]?.[dt.key]||0,Tt.push(rr)}),Q.push(Tt);const ms=dt.highlight?dt.highlightDark?"C8E6C9":"E8F5E9":"FFFFFF";ne[ke]={cells:Tt.map((nn,rr)=>({font:{bold:dt.bold||rr===0,sz:10,color:{rgb:rr===0?"1F2937":"374151"}},fill:{fgColor:{rgb:ms}},alignment:{horizontal:rr===0?"left":"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}},numFmt:rr>0&&typeof nn=="number"?"0":void 0}))},ke++})}})}):ye.forEach((Xt,Rt)=>{if(F==="day"&&Xt.month){const Ns=[Xt.month];for(let Js=0;Js<Te.length;Js++)Ns.push("");Q.push(Ns),ne[ke]={cells:Array(Ns.length).fill({font:{bold:!0,sz:12,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFF9C4"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}}),merge:{s:{r:ke,c:0},e:{r:ke,c:Te.length}}},ke++}(Rt===0||F==="day"&&Rt>0&&ye[Rt-1].monthKey!==Xt.monthKey)&&Object.keys(We).forEach(Ns=>{const Js=[Ns];for(let ps=0;ps<Te.length;ps++)Js.push("");Q.push(Js),ne[ke]={cells:Array(Js.length).fill({font:{bold:!0,sz:11,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFE082"}},alignment:{horizontal:"left",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},ke++,We[Ns].forEach(ps=>{const ds=[ps.label];Te.forEach(dt=>{let Tt="";ps.isFormula?Tt=`(${L[dt]?.freshCalls||0} + ${L[dt]?.followUps||0})`:ps.key==="responseRate"?Tt=`${L[dt]?.[ps.key]||0}%`:Tt=L[dt]?.[ps.key]||0,ds.push(Tt)}),Q.push(ds);const Ie=ps.highlight?ps.highlightDark?"C8E6C9":"E8F5E9":"FFFFFF";ne[ke]={cells:ds.map((dt,Tt)=>({font:{bold:ps.bold||Tt===0,sz:10,color:{rgb:Tt===0?"1F2937":"374151"}},fill:{fgColor:{rgb:Ie}},alignment:{horizontal:Tt===0?"left":"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}},numFmt:Tt>0&&typeof dt=="number"?"0":void 0}))},ke++})})});const vt=Kf.utils.aoa_to_sheet(Q);Object.keys(vt).forEach(Xt=>{if(Xt.startsWith("!"))return;const Rt=Kf.utils.decode_cell(Xt),Ns=ne[Rt.r];if(Ns){Ns.merge&&Rt.c===0&&(vt["!merges"]||(vt["!merges"]=[]),vt["!merges"].push(Ns.merge));const Js=Ns.cells[Rt.c];Js&&(vt[Xt].s=Js)}});const Pe=[{wch:28}];Te.forEach(()=>{Pe.push({wch:14})}),vt["!cols"]=Pe,vt["!rows"]=[],ne.forEach((Xt,Rt)=>{Xt&&Xt.merge?vt["!rows"][Rt]={hpt:25}:Rt===0?vt["!rows"][Rt]={hpt:22}:vt["!rows"][Rt]={hpt:18}}),vt["!freeze"]={xSplit:1,ySplit:4,topLeftCell:"B5",activePane:"bottomRight",state:"frozen"},Kf.utils.book_append_sheet(H,vt,"Report");const Nt=F==="day"?"Day":"Month",st=`${a?.companyName||"Report"}_${Nt}_View_${new Date().toISOString().split("T")[0]}.xlsx`;Kf.writeFile(H,st)}catch(H){console.error("Error exporting to Excel:",H),alert("Failed to export report. Please try again.")}},[Te,L,ye,We,F,a]);return w?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-gray-200 border-t-indigo-600 mx-auto"}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"h-8 w-8 bg-indigo-600 rounded-full animate-pulse"})})]}),t.jsx("p",{className:"mt-6 text-lg font-semibold text-gray-700",children:"Loading Report Data"}),t.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Please wait while we fetch your analytics..."})]})}):P?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center p-6",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-8 max-w-md w-full text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error Loading Report"}),t.jsx("p",{className:"text-gray-600 mb-6",children:P}),t.jsxs("div",{className:"flex gap-3 justify-center",children:[t.jsx("button",{onClick:()=>n("/projects"),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Back to Projects"}),t.jsx("button",{onClick:Le,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium",children:"Retry"})]})]})}):a?t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-40 lg:top-0",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4 sm:py-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors duration-200 mb-4 group",children:[t.jsx("svg",{className:"w-4 h-4 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Monthly Report"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h2",{className:"text-xl font-semibold text-indigo-600",children:a.companyName}),a.website&&t.jsxs("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),a.website]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-xl p-1.5 border border-gray-200 shadow-inner",children:[t.jsx("button",{onClick:()=>O("day"),className:`px-5 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200 ${F==="day"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg shadow-indigo-200":"text-gray-700 hover:bg-white hover:text-gray-900"}`,children:"Day View"}),t.jsx("button",{onClick:()=>O("month"),className:`px-5 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200 ${F==="month"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg shadow-indigo-200":"text-gray-700 hover:bg-white hover:text-gray-900"}`,children:"Month View"})]}),t.jsxs("button",{onClick:V,disabled:Te.length===0||S,className:"px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 font-semibold text-sm flex items-center gap-2 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Excel"]})]})]})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8",children:[S&&t.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-center gap-3",children:[t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),t.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Calculating report metrics..."})]}),Te.length===0?t.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-12 text-center",children:[t.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Data Available"}),t.jsx("p",{className:"text-gray-500",children:"There is no data available for this period."})]}):(()=>{const H=Object.values(ue).filter(Boolean).length,Q=Object.keys(We);return H===1?t.jsx("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-blue-50",children:[t.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider border-r-2 border-gray-300 sticky left-0 bg-blue-50 z-20",children:"Key Results"}),Te.map(te=>t.jsx("th",{onClick:()=>Se(te),className:"px-3 sm:px-4 py-3 text-center text-xs font-bold text-gray-900 uppercase tracking-wider border-r border-gray-300 last:border-r-0 bg-blue-50 cursor-pointer hover:underline",children:te},te))]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ye.map((te,de)=>t.jsxs(Lo.Fragment,{children:[F==="day"&&te.month&&t.jsx("tr",{children:t.jsx("td",{colSpan:Te.length+1,className:"px-4 sm:px-6 py-2.5 bg-yellow-100 text-center font-bold text-sm text-gray-900 border-b-2 border-yellow-300",children:te.month})}),de===0||F==="day"&&de>0&&ye[de-1].monthKey!==te.monthKey?Object.keys(We).map(ve=>t.jsxs(Lo.Fragment,{children:[t.jsx("tr",{className:"bg-amber-50 border-y border-amber-200",children:t.jsx("td",{colSpan:Te.length+1,className:"px-4 sm:px-6 py-2.5 sticky left-0 bg-amber-50 z-20",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-1 h-5 bg-amber-500 rounded-full"}),t.jsx("span",{className:"text-xs font-bold text-gray-900",children:ve})]})})}),We[ve].map(ke=>t.jsxs("tr",{className:`${ke.highlight?ke.highlightDark?"bg-green-100":"bg-green-50":"bg-white hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-4 sm:px-6 py-3 whitespace-nowrap text-sm border-r-2 border-gray-200 sticky left-0 z-20 ${ke.highlight?ke.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${ke.bold?"font-bold text-gray-900":"font-medium text-gray-700"}`,children:ke.label}),Te.map(ne=>{const De=ke.isFormula?`(${L[ne]?.freshCalls||0} + ${L[ne]?.followUps||0})`:ke.key==="responseRate"?`${L[ne]?.[ke.key]||0}%`:L[ne]?.[ke.key]||0,He=!ke.isFormula&&De!==0&&De!=="0%";return t.jsx("td",{onClick:()=>He&&Me(ke,ne,ve),className:`px-3 sm:px-4 py-3 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${ke.highlight?ke.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${ke.bold?"font-bold text-gray-900":"font-medium text-gray-700"} ${He?"cursor-pointer hover:bg-blue-50 hover:underline":""}`,children:De},ne)})]},`${te.monthKey||de}-${ve}-${ke.key}`))]},`${te.monthKey||de}-${ve}`)):null]},te.monthKey||de))})]})})}):t.jsx("div",{className:"space-y-6",children:Q.map(te=>t.jsx("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-blue-50",children:[t.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider border-r-2 border-gray-300 sticky left-0 bg-blue-50 z-20",children:"Key Results"}),Te.map(de=>t.jsx("th",{onClick:()=>Se(de),className:"px-3 sm:px-4 py-3 text-center text-xs font-bold text-gray-900 uppercase tracking-wider border-r border-gray-300 last:border-r-0 bg-blue-50 cursor-pointer hover:underline",children:de},de))]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ye.map((de,ve)=>t.jsxs(Lo.Fragment,{children:[F==="day"&&de.month&&t.jsx("tr",{children:t.jsx("td",{colSpan:Te.length+1,className:"px-4 sm:px-6 py-2.5 bg-yellow-100 text-center font-bold text-sm text-gray-900 border-b-2 border-yellow-300",children:de.month})}),ve===0||F==="day"&&ve>0&&ye[ve-1].monthKey!==de.monthKey?t.jsxs(Lo.Fragment,{children:[t.jsx("tr",{className:"bg-amber-50 border-y border-amber-200",children:t.jsx("td",{colSpan:Te.length+1,className:"px-4 sm:px-6 py-2.5 sticky left-0 bg-amber-50 z-20",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-1 h-5 bg-amber-500 rounded-full"}),t.jsx("span",{className:"text-xs font-bold text-gray-900",children:te})]})})}),We[te].map(ke=>t.jsxs("tr",{className:`${ke.highlight?ke.highlightDark?"bg-green-100":"bg-green-50":"bg-white hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-4 sm:px-6 py-3 whitespace-nowrap text-sm border-r-2 border-gray-200 sticky left-0 z-20 ${ke.highlight?ke.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${ke.bold?"font-bold text-gray-900":"font-medium text-gray-700"}`,children:ke.label}),Te.map(ne=>{const De=ke.isFormula?`(${L[ne]?.freshCalls||0} + ${L[ne]?.followUps||0})`:ke.key==="responseRate"?`${L[ne]?.[ke.key]||0}%`:L[ne]?.[ke.key]||0,He=!ke.isFormula&&De!==0&&De!=="0%";return t.jsx("td",{onClick:()=>He&&Me(ke,ne,te),className:`px-3 sm:px-4 py-3 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${ke.highlight?ke.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${ke.bold?"font-bold text-gray-900":"font-medium text-gray-700"} ${He?"cursor-pointer hover:bg-blue-50 hover:underline":""}`,children:De},ne)})]},`${de.monthKey||ve}-${te}-${ke.key}`))]}):null]},de.monthKey||ve))})]})})},te))})})()]}),ae.isOpen&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:ae.metric?ae.metric==="allForPeriod"?`All Prospects - ${ae.section}`:`${_e.find(Q=>Q.key===ae.metric)?.label||ae.metric} - ${ae.section}`:""}),t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Period: ",ae.period]}),!we&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing ",W(ae.metric,ae.period,ae.channel).length," prospects"]})]}),t.jsx("button",{onClick:()=>re({isOpen:!1,metric:null,period:null,channel:null,section:null}),className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:we?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsx("p",{className:"text-sm font-medium",children:"Loading prospects..."})]}):pe.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm font-medium",children:"No prospects found for this metric"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"CONTACT"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"COMPANY"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"DATE"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"STATUS"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:pe.map(H=>{const Q=(H._id?.toString?H._id.toString():H._id)||"",te=me.byPeriodAndContact.get(ae.period)?.get(Q)||[],de=te.find(De=>{if(ae.channel==="call"&&De.type!=="call"||ae.channel==="linkedin"&&De.type!=="linkedin"||ae.channel==="email"&&De.type!=="email")return!1;if(ae.channel==="call"){const He={interested:"Interested",notInterested:"Not Interested",ring:"Ring",busy:"Busy",hangUp:"Hang Up",callBack:"Call Back",switchOff:"Switch Off",detailsShared:"Details Shared",future:"Future",invalid:"Invalid",demoBooked:"Demo Booked"};return De.callStatus===He[ae.metric]}return!0})||te[0],ve=de?de.callDate?new Date(de.callDate):de.emailDate?new Date(de.emailDate):new Date(de.createdAt):H.createdAt?new Date(H.createdAt):null,ke=ve?ve.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",ne=de?.callStatus||de?.status||H.stage||"New";return t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:H.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:H.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:ke}),t.jsx("td",{className:"px-4 py-3 text-sm",children:t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded-full border border-green-200",children:ne})})]},H._id||H.name)})})]})})})]})})]}):t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-8 text-center max-w-md",children:[t.jsx("p",{className:"text-gray-600 mb-4",children:"Project not found"}),t.jsx("button",{onClick:()=>n("/projects"),className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium",children:"Back to Projects"})]})})}function P7(){const l=Fr(),[n,a]=B.useState([]),[o,s]=B.useState(!0),[e,m]=B.useState(null),[v,w]=B.useState(""),[N,S]=B.useState(!1);B.useEffect(()=>{S(!0),D()},[v]);const D=async()=>{try{s(!0);const F={};v&&(F.search=v);const O=await Ht.get("/projects",{params:F});O.data.success&&a(O.data.data||[])}catch(F){console.error("Error fetching projects:",F),m("Failed to load projects")}finally{s(!1)}},L=F=>F?new Date(F).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",M=F=>{const O={active:{bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200",label:"Active",dot:"bg-emerald-500"},draft:{bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",label:"Draft",dot:"bg-amber-500"},completed:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-200",label:"Completed",dot:"bg-blue-500"},archived:{bg:"bg-slate-50",text:"text-slate-700",border:"border-slate-200",label:"Archived",dot:"bg-slate-500"}},P=O[F]||O.draft;return t.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-md border ${P.bg} ${P.text} ${P.border} transition-colors`,children:[t.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${P.dot}`}),P.label]})};return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[t.jsx("div",{className:`mb-10 transition-all duration-500 ${N?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-blue-600 to-indigo-600 rounded-full"}),t.jsx("h1",{className:"text-2xl font-semibold text-slate-900 tracking-tight",children:"Funnel Management"})]}),t.jsx("p",{className:"text-sm text-slate-500 ml-4",children:"Select a project to view detailed funnel metrics and analytics"})]})}),t.jsx("div",{className:`mb-8 transition-all duration-500 delay-75 ${N?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:t.jsxs("div",{className:"relative max-w-md",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"h-4 w-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",placeholder:"Search projects by name, company, or email...",value:v,onChange:F=>w(F.target.value),className:"block w-full pl-10 pr-10 py-2.5 border border-slate-200 rounded-md bg-white text-sm text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-slate-900 focus:border-slate-900 transition-all shadow-sm"}),v&&t.jsx("button",{onClick:()=>w(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 transition-colors",children:t.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e&&t.jsx("div",{className:"mb-6 rounded-lg bg-red-50 border border-red-200 p-4",children:t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("svg",{className:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("div",{className:"ml-3",children:t.jsx("p",{className:"text-sm font-medium text-red-800",children:e})})]})}),o?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[...Array(6)].map((F,O)=>t.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm p-6 animate-pulse",children:[t.jsxs("div",{className:"flex items-start justify-between mb-5",children:[t.jsxs("div",{className:"flex-1 space-y-2.5",children:[t.jsx("div",{className:"h-5 bg-slate-200 rounded w-3/4"}),t.jsx("div",{className:"h-3 bg-slate-200 rounded w-1/2"})]}),t.jsx("div",{className:"h-6 bg-slate-200 rounded-md w-16"})]}),t.jsxs("div",{className:"space-y-3 mb-5",children:[t.jsx("div",{className:"h-4 bg-slate-200 rounded"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded w-5/6"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded w-4/6"})]}),t.jsx("div",{className:"h-px bg-slate-200 mb-4"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded w-1/3"})]},O))}):n.length>0?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:n.map((F,O)=>t.jsx("div",{onClick:()=>l(`/projects/${F._id}`),className:`group relative bg-white rounded-lg border border-slate-200 shadow-sm hover:shadow hover:border-slate-300 cursor-pointer transition-all duration-150 flex flex-col ${N?"opacity-100":"opacity-0"}`,style:{animationDelay:`${O*30}ms`,minHeight:"240px"},children:t.jsxs("div",{className:"p-6 flex flex-col h-full",children:[t.jsxs("div",{className:"flex items-start justify-between mb-5 min-h-[56px]",children:[t.jsxs("div",{className:"flex-1 min-w-0 pr-3",children:[t.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1.5 truncate",children:F.companyName||"N/A"}),t.jsx("p",{className:"text-xs text-slate-500 min-h-[16px]",children:F.industry||""})]}),t.jsx("div",{className:"flex-shrink-0",children:M(F.status||"draft")})]}),t.jsxs("div",{className:"space-y-3 mb-5 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2.5 min-h-[20px]",children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0 text-slate-400",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:`truncate text-sm ${F.contactPerson?.fullName?"text-slate-600":"text-slate-400"}`,children:F.contactPerson?.fullName||"No contact name"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 min-h-[20px]",children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0 text-slate-400",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:`truncate text-sm ${F.contactPerson?.email?"text-slate-600":"text-slate-400"}`,children:F.contactPerson?.email||"No email"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 min-h-[20px]",children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0 text-slate-400",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-sm text-slate-600",children:L(F.createdAt)})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100",children:[t.jsx("span",{className:"text-xs font-medium text-slate-700 group-hover:text-blue-600 transition-colors",children:"View Funnel"}),t.jsx("svg",{className:"w-4 h-4 text-slate-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})},F._id))}):t.jsx("div",{className:`bg-white rounded-lg border border-slate-200 shadow-sm p-12 transition-all duration-500 ${N?"opacity-100":"opacity-0"}`,children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[t.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-lg flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),t.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-1",children:"No projects found"}),t.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Get started by creating your first project"}),t.jsxs("button",{onClick:()=>l("/projects/new"),className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-900 text-white text-sm font-medium rounded-lg hover:bg-slate-800 transition-colors",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Project"]})]})})]})})}function I7(){const{id:l}=ci(),n=Fr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({prospectData:0,connectionSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0});B.useEffect(()=>{l&&L()},[l]),B.useEffect(()=>{(s.length>0||m.length>0)&&M()},[s,m]);const L=async()=>{try{N(!0);const O=await Ht.get(`/projects/${l}`);O.data.success&&o(O.data.data);const P=await Ht.get(`/projects/${l}/project-contacts`);P.data.success&&e(P.data.data||[]);const G=await Ht.get(`/activities/project/${l}?limit=10000`);if(G.data.success){const re=(G.data.data||[]).filter(Ne=>Ne.type==="linkedin");v(re)}}catch(O){console.error("Error fetching data:",O)}finally{N(!1)}},M=()=>{const O={prospectData:s.length,connectionSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0},P={};m.forEach(ce=>{if(!ce.contactId)return;const ue=ce.contactId.toString();P[ue]||(P[ue]=[]),P[ue].push(ce)});const G=new Set,ae=new Set,re=new Set,Ne=new Set,xe=new Set,we=new Set,Z=new Set;m.forEach(ce=>{const ue=ce.contactId?.toString();ue&&((ce.lnRequestSent==="Yes"||ce.lnRequestSent===!0)&&G.add(ue),(ce.connected==="Yes"||ce.connected===!0)&&ae.add(ue),ce.status==="CIP"&&re.add(ue),ce.status==="Meeting Proposed"&&Ne.add(ue),ce.status==="Meeting Scheduled"&&xe.add(ue),ce.status==="Meeting Completed"&&we.add(ue),(ce.status==="Meeting Completed"||ce.status==="Interested")&&Z.add(ue))}),Object.keys(P).forEach(ce=>{P[ce].filter(be=>be.conversationNotes&&be.conversationNotes.trim()!=="").length>1&&O.followups++}),O.connectionSent=G.size,O.accepted=ae.size,O.cip=re.size,O.meetingProposed=Ne.size,O.scheduled=xe.size,O.completed=we.size,O.sql=Z.size,D(O)},F=[{key:"prospectData",label:"Prospect Data",description:"Total prospects from this project"},{key:"connectionSent",label:"Connection Sent",description:"Connection requests sent"},{key:"accepted",label:"Accepted",description:"Connections accepted"},{key:"followups",label:"Followups",description:"Contacts with multiple messages"},{key:"cip",label:"CIP",description:"Conversations in Progress"},{key:"meetingProposed",label:"Meeting Proposed",description:"Meetings proposed"},{key:"scheduled",label:"Scheduled",description:"Meetings scheduled"},{key:"completed",label:"Completed",description:"Meetings completed"},{key:"sql",label:"SQL",description:"Sales Qualified Leads"}];return w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading funnel data..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 lg:px-6 py-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200 mb-6",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-indigo-500 to-indigo-700 rounded-full"}),t.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["LinkedIn Funnel - ",a?.companyName||"Project"]})]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-white to-gray-50 border border-gray-200 rounded-lg shadow-lg p-4 backdrop-blur-sm",children:[t.jsxs("div",{className:"mb-3 text-center",children:[t.jsx("h2",{className:"text-base font-bold text-gray-800 mb-0.5",children:"Sales Funnel Performance"}),t.jsx("p",{className:"text-[10px] text-gray-600",children:"Conversion metrics and pipeline health"})]}),t.jsx("div",{className:"flex flex-col items-center space-y-0.5",children:F.map((O,P)=>{const G=S[O.key]||0,ae=S.prospectData||1,re=ae>0?G/ae*100:0,xe=[96,88,78,68,58,48,38,28,20][P]||15;let we="",Z="text-white",ce="",ue="",Le="";P===0?(we="from-blue-600 via-blue-500 to-indigo-500",ce="border-blue-400",ue="shadow-blue-500/30",Le="bg-blue-400/30"):P>=5?(we="from-indigo-600 via-indigo-500 to-purple-500",ce="border-indigo-400",ue="shadow-indigo-500/30",Le="bg-indigo-400/30"):(we="from-slate-600 via-slate-500 to-gray-500",ce="border-slate-400",ue="shadow-slate-500/30",Le="bg-slate-400/30");const be=["","","","","","","","",""];return t.jsxs("div",{className:"w-full flex flex-col items-center transition-all duration-700 ease-out",style:{animation:`fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) ${P*.08}s both`},children:[t.jsxs("div",{className:`relative bg-gradient-to-r ${we} ${ce} border rounded-md shadow-md ${ue} hover:shadow-lg transition-all duration-500 transform hover:scale-[1.01] hover:-translate-y-0.5 group overflow-hidden`,style:{width:`${xe}%`,minWidth:"150px",backdropFilter:"blur(10px)"},children:[t.jsxs("div",{className:"absolute inset-0 opacity-10",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent"}),t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1),transparent_50%)]"})]}),t.jsxs("div",{className:"relative px-3 py-1.5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:`${Le} backdrop-blur-sm rounded p-1 shadow-sm`,children:t.jsx("span",{className:"text-sm",children:be[P]})}),t.jsxs("div",{children:[t.jsx("span",{className:`${Z} text-[10px] font-bold uppercase tracking-wide block leading-tight`,children:O.label}),t.jsx("span",{className:`${Z} text-[9px] opacity-80 mt-0 block`,children:O.description})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:`${Z} text-lg font-extrabold mb-0 drop-shadow-lg`,children:G.toLocaleString()}),P>0&&ae>0&&t.jsxs("div",{className:`${Z} text-[9px] font-semibold bg-white/20 backdrop-blur-sm px-1.5 py-0.5 rounded-full border border-white/30`,children:[re.toFixed(1),"%"]})]})]}),P>0&&t.jsx("div",{className:"mt-1 h-0.5 bg-white/20 backdrop-blur-sm rounded-full overflow-hidden border border-white/20",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-white/80 to-white rounded-full transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min(re,100)}%`,animation:`progressFill 1.5s ease-out ${P*.1+.5}s both`}})})]}),t.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),P<F.length-1&&t.jsxs("div",{className:"relative my-0.5",children:[t.jsx("div",{className:"w-0.5 h-2 bg-gradient-to-b from-gray-400 via-gray-500 to-gray-400 rounded-full shadow-inner mx-auto"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-gray-500 rounded-full shadow-sm"})]})]},O.key)})})]}),t.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(30px) scale(0.95);
            }
            to {
              opacity: 1;
              transform: translateY(0) scale(1);
            }
          }
          
          @keyframes progressFill {
            from {
              width: 0%;
            }
          }
          
          .shadow-3xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
          }
        `}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 via-blue-500 to-indigo-500 rounded-xl p-4 shadow-xl hover:shadow-blue-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Total Prospects"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsx("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:S.prospectData.toLocaleString()}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Pipeline foundation"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-emerald-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Conversion Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.completed/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Meetings completed"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-indigo-600 via-indigo-500 to-purple-500 rounded-xl p-4 shadow-xl hover:shadow-indigo-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"SQL Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.sql/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Sales qualified leads"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]})]})]})})}function B7(){const{id:l}=ci(),n=Fr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({prospectData:0,callsAttempted:0,callsConnected:0,decisionMakerReached:0,interested:0,detailsShared:0,demoBooked:0,demoCompleted:0,sql:0,won:0});B.useEffect(()=>{l&&L()},[l]),B.useEffect(()=>{l&&(s.length>0||m.length>0)?M():l&&s.length===0&&m.length===0&&D({prospectData:0,callsAttempted:0,callsConnected:0,decisionMakerReached:0,interested:0,detailsShared:0,demoBooked:0,demoCompleted:0,sql:0,won:0})},[l,s,m]);const L=async()=>{try{N(!0);const O=await Ht.get(`/projects/${l}`);O.data.success&&o(O.data.data);const P=await Ht.get(`/projects/${l}/project-contacts`);P.data.success&&e(P.data.data||[]);const G=await Ht.get(`/activities/project/${l}?limit=10000`);if(G.data.success){const re=(G.data.data||[]).filter(Ne=>Ne.type==="call");v(re)}}catch(O){console.error("Error fetching data:",O)}finally{N(!1)}},M=()=>{console.log("Calculating funnel data...",{contactsCount:s.length,activitiesCount:m.length});const O={prospectData:s.length,callsAttempted:0,callsConnected:0,decisionMakerReached:0,interested:0,detailsShared:0,demoBooked:0,demoCompleted:0,sql:0,won:0};if(m.length===0){console.log("No activities found, setting default data"),D(O);return}const P=new Set,G=new Set,ae=new Set,re=new Set,Ne=new Set,xe=new Set,we=new Set,Z=new Set,ce=new Set;m.forEach(ue=>{const Le=ue.contactId?.toString();if(!Le)return;ue.callDate&&P.add(Le);const be=["Interested","Not Interested","Call Back","Future","Details Shared","Demo Booked","Demo Completed","Existing"];ue.callStatus&&be.includes(ue.callStatus)&&G.add(Le);const oe=["Interested","Details Shared","Demo Booked","Demo Completed"];ue.callStatus&&oe.includes(ue.callStatus)&&ae.add(Le),ue.callStatus==="Interested"&&re.add(Le),ue.callStatus==="Details Shared"&&Ne.add(Le),ue.callStatus==="Demo Booked"&&xe.add(Le),ue.callStatus==="Demo Completed"&&we.add(Le),(ue.callStatus==="Demo Completed"||ue.callStatus==="Interested"&&ue.conversationNotes&&ue.conversationNotes.length>50||ue.status==="SQL")&&Z.add(Le),ue.status==="WON"&&ce.add(Le)}),O.callsAttempted=P.size,O.callsConnected=G.size,O.decisionMakerReached=ae.size,O.interested=re.size,O.detailsShared=Ne.size,O.demoBooked=xe.size,O.demoCompleted=we.size,O.sql=Z.size,O.won=ce.size,console.log("Funnel data calculated:",O),console.log("Stage breakdown:",{callsAttempted:O.callsAttempted,callsConnected:O.callsConnected,decisionMakerReached:O.decisionMakerReached,interested:O.interested,detailsShared:O.detailsShared,demoBooked:O.demoBooked,demoCompleted:O.demoCompleted,sql:O.sql,won:O.won}),D(O)},F=[{key:"prospectData",label:"Prospect Data",description:"Total prospects from this project"},{key:"callsAttempted",label:"Calls Attempted",description:"Total calls made to prospects"},{key:"callsConnected",label:"Calls Connected",description:"Calls where contact answered"},{key:"decisionMakerReached",label:"Decision Maker Reached",description:"Reached decision maker"},{key:"interested",label:"Interested",description:"Prospects showing interest"},{key:"detailsShared",label:"Details Shared",description:"Product/service details shared"},{key:"demoBooked",label:"Demo Booked",description:"Demos scheduled"},{key:"demoCompleted",label:"Demo Completed",description:"Demos successfully completed"},{key:"sql",label:"SQL",description:"Sales Qualified Leads"},{key:"won",label:"WON",description:"Deals closed successfully"}];return B.useEffect(()=>{console.log("Funnel rows configured:",F.length,"stages"),console.log("Stage labels:",F.map(O=>O.label))},[]),w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading funnel data..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 lg:px-6 py-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200 mb-6",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-emerald-500 to-emerald-700 rounded-full"}),t.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["Cold Calling Funnel - ",a?.companyName||"Project"]})]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-white to-gray-50 border border-gray-200 rounded-lg shadow-lg p-4 backdrop-blur-sm",children:[t.jsxs("div",{className:"mb-3 text-center",children:[t.jsx("h2",{className:"text-base font-bold text-gray-800 mb-0.5",children:"Cold Calling Funnel Performance"}),t.jsx("p",{className:"text-[10px] text-gray-600",children:"Updated: 10-Stage Funnel  Conversion metrics and pipeline health"}),t.jsxs("div",{className:"mt-1 text-[9px] text-blue-600 font-semibold",children:["Stages: ",F.length," | Total Prospects: ",S.prospectData]}),S.prospectData===0&&t.jsx("p",{className:"text-xs text-amber-600 mt-2 font-medium",children:" No prospects found. Add contacts to see funnel data."})]}),t.jsx("div",{className:"flex flex-col items-center space-y-0.5",children:F.map((O,P)=>{const G=S[O.key]!==void 0?S[O.key]:0,ae=S.prospectData||1,re=ae>0?G/ae*100:0;P===0&&console.log(`Rendering stage ${P}: ${O.label} = ${G} (key: ${O.key})`);const xe=[96,88,80,72,64,56,48,40,32,24][P]||20;let we="",Z="text-white",ce="",ue="",Le="";P===0?(we="from-blue-600 via-blue-500 to-cyan-500",ce="border-blue-400",ue="shadow-blue-500/30",Le="bg-blue-400/30"):P===1||P===2?(we="from-purple-600 via-purple-500 to-indigo-500",ce="border-purple-400",ue="shadow-purple-500/30",Le="bg-purple-400/30"):P===3||P===4?(we="from-orange-600 via-orange-500 to-amber-500",ce="border-orange-400",ue="shadow-orange-500/30",Le="bg-orange-400/30"):P===5||P===6?(we="from-yellow-600 via-yellow-500 to-amber-500",ce="border-yellow-400",ue="shadow-yellow-500/30",Le="bg-yellow-400/30"):P===7||P===8?(we="from-emerald-600 via-emerald-500 to-teal-500",ce="border-emerald-400",ue="shadow-emerald-500/30",Le="bg-emerald-400/30"):(we="from-amber-600 via-amber-500 to-yellow-500",ce="border-amber-400",ue="shadow-amber-500/30",Le="bg-amber-400/30");const be=["","","","","","","","","",""];return t.jsxs("div",{className:"w-full flex flex-col items-center transition-all duration-700 ease-out",style:{animation:`fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) ${P*.08}s both`},children:[t.jsxs("div",{className:`relative bg-gradient-to-r ${we} ${ce} border rounded-md shadow-md ${ue} hover:shadow-lg transition-all duration-500 transform hover:scale-[1.01] hover:-translate-y-0.5 group overflow-hidden`,style:{width:`${xe}%`,minWidth:"150px",backdropFilter:"blur(10px)"},children:[t.jsxs("div",{className:"absolute inset-0 opacity-10",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent"}),t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1),transparent_50%)]"})]}),t.jsxs("div",{className:"relative px-3 py-1.5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:`${Le} backdrop-blur-sm rounded p-1 shadow-sm`,children:t.jsx("span",{className:"text-sm",children:be[P]||""})}),t.jsxs("div",{children:[t.jsx("span",{className:`${Z} text-[10px] font-bold uppercase tracking-wide block leading-tight`,children:O.label}),t.jsx("span",{className:`${Z} text-[9px] opacity-80 mt-0 block`,children:O.description})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:`${Z} text-lg font-extrabold mb-0 drop-shadow-lg`,children:G.toLocaleString()}),P>0&&ae>0&&t.jsxs("div",{className:`${Z} text-[9px] font-semibold bg-white/20 backdrop-blur-sm px-1.5 py-0.5 rounded-full border border-white/30`,children:[re.toFixed(1),"%"]})]})]}),P>0&&t.jsx("div",{className:"mt-1 h-0.5 bg-white/20 backdrop-blur-sm rounded-full overflow-hidden border border-white/20",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-white/80 to-white rounded-full transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min(re,100)}%`,animation:`progressFill 1.5s ease-out ${P*.1+.5}s both`}})})]}),t.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),P<F.length-1&&t.jsxs("div",{className:"relative my-0.5",children:[t.jsx("div",{className:"w-0.5 h-2 bg-gradient-to-b from-gray-400 via-gray-500 to-gray-400 rounded-full shadow-inner mx-auto"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-gray-500 rounded-full shadow-sm"})]})]},O.key)})},`funnel-${F.length}`)]}),t.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(30px) scale(0.95);
            }
            to {
              opacity: 1;
              transform: translateY(0) scale(1);
            }
          }
          
          @keyframes progressFill {
            from {
              width: 0%;
            }
          }
          
          .shadow-3xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
          }
        `}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 via-blue-500 to-cyan-500 rounded-xl p-4 shadow-xl hover:shadow-blue-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Total Prospects"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsx("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:S.prospectData.toLocaleString()}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Pipeline foundation"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-emerald-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Conversion Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.demoCompleted/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Demos completed"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 rounded-xl p-4 shadow-xl hover:shadow-teal-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"SQL Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.sql/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Sales qualified leads"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]})]})]})})}function z7(){const{id:l}=ci(),n=Fr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({prospectData:0,emailSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0});B.useEffect(()=>{l&&L()},[l]),B.useEffect(()=>{(s.length>0||m.length>0)&&M()},[s,m]);const L=async()=>{try{N(!0);const O=await Ht.get(`/projects/${l}`);O.data.success&&o(O.data.data);const P=await Ht.get(`/projects/${l}/project-contacts`);P.data.success&&e(P.data.data||[]);const G=await Ht.get(`/activities/project/${l}?limit=10000`);if(G.data.success){const re=(G.data.data||[]).filter(Ne=>Ne.type==="email");v(re)}}catch(O){console.error("Error fetching data:",O)}finally{N(!1)}},M=()=>{const O={prospectData:s.length,emailSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0},P={};m.forEach(ce=>{if(!ce.contactId)return;const ue=ce.contactId.toString();P[ue]||(P[ue]=[]),P[ue].push(ce)});const G=new Set,ae=new Set,re=new Set,Ne=new Set,xe=new Set,we=new Set,Z=new Set;m.forEach(ce=>{const ue=ce.contactId?.toString();ue&&(ce.emailDate&&G.add(ue),(ce.status==="Interested"||ce.status==="Meeting Proposed"||ce.status==="Meeting Scheduled")&&ae.add(ue),(ce.status==="Interested"||ce.status==="Out of Office")&&re.add(ue),ce.status==="Meeting Proposed"&&Ne.add(ue),(ce.status==="Meeting Scheduled"||ce.nextActionDate)&&xe.add(ue),ce.status==="Meeting Completed"&&we.add(ue),(ce.status==="Meeting Completed"||ce.status==="Interested"&&ce.conversationNotes&&ce.conversationNotes.length>50)&&Z.add(ue))}),Object.keys(P).forEach(ce=>{const ue=P[ce];(ue.filter(be=>be.conversationNotes&&be.conversationNotes.trim()!=="").length>1||ue.length>1)&&O.followups++}),O.emailSent=G.size,O.accepted=ae.size,O.cip=re.size,O.meetingProposed=Ne.size,O.scheduled=xe.size,O.completed=we.size,O.sql=Z.size,D(O)},F=[{key:"prospectData",label:"Prospect Data",description:"Total prospects from this project"},{key:"emailSent",label:"Email Sent",description:"Emails sent to prospects"},{key:"accepted",label:"Accepted",description:"Emails accepted/responded"},{key:"followups",label:"Followups",description:"Contacts with multiple emails"},{key:"cip",label:"CIP",description:"Conversations in Progress"},{key:"meetingProposed",label:"Meeting Proposed",description:"Meetings proposed"},{key:"scheduled",label:"Scheduled",description:"Meetings scheduled"},{key:"completed",label:"Completed",description:"Meetings completed"},{key:"sql",label:"SQL",description:"Sales Qualified Leads"}];return w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading funnel data..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 lg:px-6 py-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200 mb-6",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-blue-500 to-blue-700 rounded-full"}),t.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["Email Funnel - ",a?.companyName||"Project"]})]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-white to-gray-50 border border-gray-200 rounded-lg shadow-lg p-4 backdrop-blur-sm",children:[t.jsxs("div",{className:"mb-3 text-center",children:[t.jsx("h2",{className:"text-base font-bold text-gray-800 mb-0.5",children:"Sales Funnel Performance"}),t.jsx("p",{className:"text-[10px] text-gray-600",children:"Conversion metrics and pipeline health"})]}),t.jsx("div",{className:"flex flex-col items-center space-y-0.5",children:F.map((O,P)=>{const G=S[O.key]||0,ae=S.prospectData||1,re=ae>0?G/ae*100:0,xe=[96,88,78,68,58,48,38,28,20][P]||15;let we="",Z="text-white",ce="",ue="",Le="";P===0?(we="from-blue-600 via-blue-500 to-cyan-500",ce="border-blue-400",ue="shadow-blue-500/30",Le="bg-blue-400/30"):P>=5?(we="from-cyan-600 via-cyan-500 to-teal-500",ce="border-cyan-400",ue="shadow-cyan-500/30",Le="bg-cyan-400/30"):(we="from-slate-600 via-slate-500 to-gray-500",ce="border-slate-400",ue="shadow-slate-500/30",Le="bg-slate-400/30");const be=["","","","","","","","",""];return t.jsxs("div",{className:"w-full flex flex-col items-center transition-all duration-700 ease-out",style:{animation:`fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) ${P*.08}s both`},children:[t.jsxs("div",{className:`relative bg-gradient-to-r ${we} ${ce} border rounded-md shadow-md ${ue} hover:shadow-lg transition-all duration-500 transform hover:scale-[1.01] hover:-translate-y-0.5 group overflow-hidden`,style:{width:`${xe}%`,minWidth:"150px",backdropFilter:"blur(10px)"},children:[t.jsxs("div",{className:"absolute inset-0 opacity-10",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent"}),t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1),transparent_50%)]"})]}),t.jsxs("div",{className:"relative px-3 py-1.5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:`${Le} backdrop-blur-sm rounded p-1 shadow-sm`,children:t.jsx("span",{className:"text-sm",children:be[P]})}),t.jsxs("div",{children:[t.jsx("span",{className:`${Z} text-[10px] font-bold uppercase tracking-wide block leading-tight`,children:O.label}),t.jsx("span",{className:`${Z} text-[9px] opacity-80 mt-0 block`,children:O.description})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:`${Z} text-lg font-extrabold mb-0 drop-shadow-lg`,children:G.toLocaleString()}),P>0&&ae>0&&t.jsxs("div",{className:`${Z} text-[9px] font-semibold bg-white/20 backdrop-blur-sm px-1.5 py-0.5 rounded-full border border-white/30`,children:[re.toFixed(1),"%"]})]})]}),P>0&&t.jsx("div",{className:"mt-1 h-0.5 bg-white/20 backdrop-blur-sm rounded-full overflow-hidden border border-white/20",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-white/80 to-white rounded-full transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min(re,100)}%`,animation:`progressFill 1.5s ease-out ${P*.1+.5}s both`}})})]}),t.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),P<F.length-1&&t.jsxs("div",{className:"relative my-0.5",children:[t.jsx("div",{className:"w-0.5 h-2 bg-gradient-to-b from-gray-400 via-gray-500 to-gray-400 rounded-full shadow-inner mx-auto"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-gray-500 rounded-full shadow-sm"})]})]},O.key)})})]}),t.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(30px) scale(0.95);
            }
            to {
              opacity: 1;
              transform: translateY(0) scale(1);
            }
          }
          
          @keyframes progressFill {
            from {
              width: 0%;
            }
          }
          
          .shadow-3xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
          }
        `}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 via-blue-500 to-cyan-500 rounded-xl p-4 shadow-xl hover:shadow-blue-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Total Prospects"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsx("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:S.prospectData.toLocaleString()}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Pipeline foundation"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-emerald-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Conversion Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.completed/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Meetings completed"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-cyan-600 via-cyan-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-cyan-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"SQL Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.sql/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Sales qualified leads"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]})]})]})})}const Qr=({children:l})=>localStorage.getItem("token")?l:t.jsx(pp,{to:"/login",replace:!0}),U7=()=>localStorage.getItem("token")?t.jsx(pp,{to:"/dashboard",replace:!0}):t.jsx(pp,{to:"/login",replace:!0});function H7(){return t.jsx(cw,{children:t.jsxs(I4,{children:[t.jsx(yr,{path:"/",element:t.jsx(U7,{})}),t.jsx(yr,{path:"/login",element:t.jsx(X5,{})}),t.jsx(yr,{path:"/reset-password",element:t.jsx(J5,{})}),t.jsxs(yr,{element:t.jsx(vw,{}),children:[t.jsx(yr,{path:"/dashboard",element:t.jsx(Qr,{children:t.jsx(Uk,{})})}),t.jsx(yr,{path:"/master-dashboard",element:t.jsx(Qr,{children:t.jsx(u7,{})})}),t.jsx(yr,{path:"/employee-performance",element:t.jsx(Qr,{children:t.jsx(m7,{})})}),t.jsx(yr,{path:"/contacts",element:t.jsx(Qr,{children:t.jsx(Vk,{})})}),t.jsx(yr,{path:"/contacts/company/:companyName",element:t.jsx(Qr,{children:t.jsx(qk,{})})}),t.jsx(yr,{path:"/contacts/:id/activities",element:t.jsx(Qr,{children:t.jsx($k,{})})}),t.jsx(yr,{path:"/contacts/:id",element:t.jsx(Qr,{children:t.jsx(Wk,{})})}),t.jsx(yr,{path:"/contacts/new",element:t.jsx(Qr,{children:t.jsx(Gk,{})})}),t.jsx(yr,{path:"/import",element:t.jsx(Qr,{children:t.jsx(Yk,{})})}),t.jsx(yr,{path:"/projects",element:t.jsx(Qr,{children:t.jsx(Kk,{})})}),t.jsx(yr,{path:"/projects/dashboard",element:t.jsx(Qr,{children:t.jsx(r7,{})})}),t.jsx(yr,{path:"/prospects/dashboard",element:t.jsx(Qr,{children:t.jsx(o7,{})})}),t.jsx(yr,{path:"/projects/new",element:t.jsx(Qr,{children:t.jsx(Sb,{})})}),t.jsx(yr,{path:"/projects/:id/edit",element:t.jsx(Qr,{children:t.jsx(Sb,{})})}),t.jsx(yr,{path:"/projects/:id",element:t.jsx(Qr,{children:t.jsx(Zk,{})})}),t.jsx(yr,{path:"/projects/:id/funnel",element:t.jsx(Qr,{children:t.jsx(g7,{})})}),t.jsx(yr,{path:"/projects/:id/linkedin-funnel",element:t.jsx(Qr,{children:t.jsx(E7,{})})}),t.jsx(yr,{path:"/projects/:id/cold-calling-funnel",element:t.jsx(Qr,{children:t.jsx(D7,{})})}),t.jsx(yr,{path:"/projects/:id/email-funnel",element:t.jsx(Qr,{children:t.jsx(T7,{})})}),t.jsx(yr,{path:"/projects/:id/report",element:t.jsx(Qr,{children:t.jsx(O7,{})})}),t.jsx(yr,{path:"/funnel",element:t.jsx(Qr,{children:t.jsx(P7,{})})}),t.jsx(yr,{path:"/funnel/:id/linkedin",element:t.jsx(Qr,{children:t.jsx(I7,{})})}),t.jsx(yr,{path:"/funnel/:id/cold-calling",element:t.jsx(Qr,{children:t.jsx(B7,{})})}),t.jsx(yr,{path:"/funnel/:id/email",element:t.jsx(Qr,{children:t.jsx(z7,{})})})]})]})})}Iv.createRoot(document.getElementById("root")).render(t.jsx(Lo.StrictMode,{children:t.jsx(H7,{})}));
