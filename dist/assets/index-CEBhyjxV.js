(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const m of e.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function a(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerPolicy&&(e.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?e.credentials="include":s.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function o(s){if(s.ep)return;s.ep=!0;const e=a(s);fetch(s.href,e)}})();function Pb(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function Dv(l){if(Object.prototype.hasOwnProperty.call(l,"__esModule"))return l;var n=l.default;if(typeof n=="function"){var a=function o(){var s=!1;try{s=this instanceof o}catch{}return s?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};a.prototype=n.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(l).forEach(function(o){var s=Object.getOwnPropertyDescriptor(l,o);Object.defineProperty(a,o,s.get?s:{enumerable:!0,get:function(){return l[o]}})}),a}var a1={exports:{}},zf={};var Sx;function Tv(){if(Sx)return zf;Sx=1;var l=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(o,s,e){var m=null;if(e!==void 0&&(m=""+e),s.key!==void 0&&(m=""+s.key),"key"in s){e={};for(var v in s)v!=="key"&&(e[v]=s[v])}else e=s;return s=e.ref,{$$typeof:l,type:o,key:m,ref:s!==void 0?s:null,props:e}}return zf.Fragment=n,zf.jsx=a,zf.jsxs=a,zf}var Ax;function _v(){return Ax||(Ax=1,a1.exports=Tv()),a1.exports}var t=_v(),n1={exports:{}},As={};var Ex;function Fv(){if(Ex)return As;Ex=1;var l=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),e=Symbol.for("react.consumer"),m=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),N=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),L=Symbol.iterator;function M(V){return V===null||typeof V!="object"?null:(V=L&&V[L]||V["@@iterator"],typeof V=="function"?V:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,P={};function K(V,be,_e){this.props=V,this.context=be,this.refs=P,this.updater=_e||F}K.prototype.isReactComponent={},K.prototype.setState=function(V,be){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,be,"setState")},K.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function ne(){}ne.prototype=K.prototype;function se(V,be,_e){this.props=V,this.context=be,this.refs=P,this.updater=_e||F}var Ce=se.prototype=new ne;Ce.constructor=se,O(Ce,K.prototype),Ce.isPureReactComponent=!0;var ge=Array.isArray;function Ne(){}var J={H:null,A:null,T:null,S:null},de=Object.prototype.hasOwnProperty;function le(V,be,_e){var De=_e.ref;return{$$typeof:l,type:V,key:be,ref:De!==void 0?De:null,props:_e}}function ze(V,be){return le(V.type,be,V.props)}function me(V){return typeof V=="object"&&V!==null&&V.$$typeof===l}function oe(V){var be={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(_e){return be[_e]})}var ce=/\/+/g;function ye(V,be){return typeof V=="object"&&V!==null&&V.key!=null?oe(""+V.key):be.toString(36)}function ke(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(Ne,Ne):(V.status="pending",V.then(function(be){V.status==="pending"&&(V.status="fulfilled",V.value=be)},function(be){V.status==="pending"&&(V.status="rejected",V.reason=be)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function fe(V,be,_e,De,W){var H=typeof V;(H==="undefined"||H==="boolean")&&(V=null);var X=!1;if(V===null)X=!0;else switch(H){case"bigint":case"string":case"number":X=!0;break;case"object":switch(V.$$typeof){case l:case n:X=!0;break;case S:return X=V._init,fe(X(V._payload),be,_e,De,W)}}if(X)return W=W(V),X=De===""?"."+ye(V,0):De,ge(W)?(_e="",X!=null&&(_e=X.replace(ce,"$&/")+"/"),fe(W,be,_e,"",function(we){return we})):W!=null&&(me(W)&&(W=ze(W,_e+(W.key==null||V&&V.key===W.key?"":(""+W.key).replace(ce,"$&/")+"/")+X)),be.push(W)),1;X=0;var je=De===""?".":De+":";if(ge(V))for(var Q=0;Q<V.length;Q++)De=V[Q],H=je+ye(De,Q),X+=fe(De,be,_e,H,W);else if(Q=M(V),typeof Q=="function")for(V=Q.call(V),Q=0;!(De=V.next()).done;)De=De.value,H=je+ye(De,Q++),X+=fe(De,be,_e,H,W);else if(H==="object"){if(typeof V.then=="function")return fe(ke(V),be,_e,De,W);throw be=String(V),Error("Objects are not valid as a React child (found: "+(be==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":be)+"). If you meant to render a collection of children, use an array instead.")}return X}function Se(V,be,_e){if(V==null)return V;var De=[],W=0;return fe(V,De,"","",function(H){return be.call(_e,H,W++)}),De}function Ye(V){if(V._status===-1){var be=V._result;be=be(),be.then(function(_e){(V._status===0||V._status===-1)&&(V._status=1,V._result=_e)},function(_e){(V._status===0||V._status===-1)&&(V._status=2,V._result=_e)}),V._status===-1&&(V._status=0,V._result=be)}if(V._status===1)return V._result.default;throw V._result}var te=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var be=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(be))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},pe={map:Se,forEach:function(V,be,_e){Se(V,function(){be.apply(this,arguments)},_e)},count:function(V){var be=0;return Se(V,function(){be++}),be},toArray:function(V){return Se(V,function(be){return be})||[]},only:function(V){if(!me(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return As.Activity=D,As.Children=pe,As.Component=K,As.Fragment=a,As.Profiler=s,As.PureComponent=se,As.StrictMode=o,As.Suspense=w,As.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=J,As.__COMPILER_RUNTIME={__proto__:null,c:function(V){return J.H.useMemoCache(V)}},As.cache=function(V){return function(){return V.apply(null,arguments)}},As.cacheSignal=function(){return null},As.cloneElement=function(V,be,_e){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var De=O({},V.props),W=V.key;if(be!=null)for(H in be.key!==void 0&&(W=""+be.key),be)!de.call(be,H)||H==="key"||H==="__self"||H==="__source"||H==="ref"&&be.ref===void 0||(De[H]=be[H]);var H=arguments.length-2;if(H===1)De.children=_e;else if(1<H){for(var X=Array(H),je=0;je<H;je++)X[je]=arguments[je+2];De.children=X}return le(V.type,W,De)},As.createContext=function(V){return V={$$typeof:m,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:e,_context:V},V},As.createElement=function(V,be,_e){var De,W={},H=null;if(be!=null)for(De in be.key!==void 0&&(H=""+be.key),be)de.call(be,De)&&De!=="key"&&De!=="__self"&&De!=="__source"&&(W[De]=be[De]);var X=arguments.length-2;if(X===1)W.children=_e;else if(1<X){for(var je=Array(X),Q=0;Q<X;Q++)je[Q]=arguments[Q+2];W.children=je}if(V&&V.defaultProps)for(De in X=V.defaultProps,X)W[De]===void 0&&(W[De]=X[De]);return le(V,H,W)},As.createRef=function(){return{current:null}},As.forwardRef=function(V){return{$$typeof:v,render:V}},As.isValidElement=me,As.lazy=function(V){return{$$typeof:S,_payload:{_status:-1,_result:V},_init:Ye}},As.memo=function(V,be){return{$$typeof:N,type:V,compare:be===void 0?null:be}},As.startTransition=function(V){var be=J.T,_e={};J.T=_e;try{var De=V(),W=J.S;W!==null&&W(_e,De),typeof De=="object"&&De!==null&&typeof De.then=="function"&&De.then(Ne,te)}catch(H){te(H)}finally{be!==null&&_e.types!==null&&(be.types=_e.types),J.T=be}},As.unstable_useCacheRefresh=function(){return J.H.useCacheRefresh()},As.use=function(V){return J.H.use(V)},As.useActionState=function(V,be,_e){return J.H.useActionState(V,be,_e)},As.useCallback=function(V,be){return J.H.useCallback(V,be)},As.useContext=function(V){return J.H.useContext(V)},As.useDebugValue=function(){},As.useDeferredValue=function(V,be){return J.H.useDeferredValue(V,be)},As.useEffect=function(V,be){return J.H.useEffect(V,be)},As.useEffectEvent=function(V){return J.H.useEffectEvent(V)},As.useId=function(){return J.H.useId()},As.useImperativeHandle=function(V,be,_e){return J.H.useImperativeHandle(V,be,_e)},As.useInsertionEffect=function(V,be){return J.H.useInsertionEffect(V,be)},As.useLayoutEffect=function(V,be){return J.H.useLayoutEffect(V,be)},As.useMemo=function(V,be){return J.H.useMemo(V,be)},As.useOptimistic=function(V,be){return J.H.useOptimistic(V,be)},As.useReducer=function(V,be,_e){return J.H.useReducer(V,be,_e)},As.useRef=function(V){return J.H.useRef(V)},As.useState=function(V){return J.H.useState(V)},As.useSyncExternalStore=function(V,be,_e){return J.H.useSyncExternalStore(V,be,_e)},As.useTransition=function(){return J.H.useTransition()},As.version="19.2.3",As}var Dx;function ex(){return Dx||(Dx=1,n1.exports=Fv()),n1.exports}var B=ex();const Mo=Pb(B);var i1={exports:{}},Uf={},l1={exports:{}},o1={};var Tx;function Mv(){return Tx||(Tx=1,(function(l){function n(fe,Se){var Ye=fe.length;fe.push(Se);e:for(;0<Ye;){var te=Ye-1>>>1,pe=fe[te];if(0<s(pe,Se))fe[te]=Se,fe[Ye]=pe,Ye=te;else break e}}function a(fe){return fe.length===0?null:fe[0]}function o(fe){if(fe.length===0)return null;var Se=fe[0],Ye=fe.pop();if(Ye!==Se){fe[0]=Ye;e:for(var te=0,pe=fe.length,V=pe>>>1;te<V;){var be=2*(te+1)-1,_e=fe[be],De=be+1,W=fe[De];if(0>s(_e,Ye))De<pe&&0>s(W,_e)?(fe[te]=W,fe[De]=Ye,te=De):(fe[te]=_e,fe[be]=Ye,te=be);else if(De<pe&&0>s(W,Ye))fe[te]=W,fe[De]=Ye,te=De;else break e}}return Se}function s(fe,Se){var Ye=fe.sortIndex-Se.sortIndex;return Ye!==0?Ye:fe.id-Se.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var e=performance;l.unstable_now=function(){return e.now()}}else{var m=Date,v=m.now();l.unstable_now=function(){return m.now()-v}}var w=[],N=[],S=1,D=null,L=3,M=!1,F=!1,O=!1,P=!1,K=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,se=typeof setImmediate<"u"?setImmediate:null;function Ce(fe){for(var Se=a(N);Se!==null;){if(Se.callback===null)o(N);else if(Se.startTime<=fe)o(N),Se.sortIndex=Se.expirationTime,n(w,Se);else break;Se=a(N)}}function ge(fe){if(O=!1,Ce(fe),!F)if(a(w)!==null)F=!0,Ne||(Ne=!0,oe());else{var Se=a(N);Se!==null&&ke(ge,Se.startTime-fe)}}var Ne=!1,J=-1,de=5,le=-1;function ze(){return P?!0:!(l.unstable_now()-le<de)}function me(){if(P=!1,Ne){var fe=l.unstable_now();le=fe;var Se=!0;try{e:{F=!1,O&&(O=!1,ne(J),J=-1),M=!0;var Ye=L;try{t:{for(Ce(fe),D=a(w);D!==null&&!(D.expirationTime>fe&&ze());){var te=D.callback;if(typeof te=="function"){D.callback=null,L=D.priorityLevel;var pe=te(D.expirationTime<=fe);if(fe=l.unstable_now(),typeof pe=="function"){D.callback=pe,Ce(fe),Se=!0;break t}D===a(w)&&o(w),Ce(fe)}else o(w);D=a(w)}if(D!==null)Se=!0;else{var V=a(N);V!==null&&ke(ge,V.startTime-fe),Se=!1}}break e}finally{D=null,L=Ye,M=!1}Se=void 0}}finally{Se?oe():Ne=!1}}}var oe;if(typeof se=="function")oe=function(){se(me)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ye=ce.port2;ce.port1.onmessage=me,oe=function(){ye.postMessage(null)}}else oe=function(){K(me,0)};function ke(fe,Se){J=K(function(){fe(l.unstable_now())},Se)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(fe){fe.callback=null},l.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):de=0<fe?Math.floor(1e3/fe):5},l.unstable_getCurrentPriorityLevel=function(){return L},l.unstable_next=function(fe){switch(L){case 1:case 2:case 3:var Se=3;break;default:Se=L}var Ye=L;L=Se;try{return fe()}finally{L=Ye}},l.unstable_requestPaint=function(){P=!0},l.unstable_runWithPriority=function(fe,Se){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var Ye=L;L=fe;try{return Se()}finally{L=Ye}},l.unstable_scheduleCallback=function(fe,Se,Ye){var te=l.unstable_now();switch(typeof Ye=="object"&&Ye!==null?(Ye=Ye.delay,Ye=typeof Ye=="number"&&0<Ye?te+Ye:te):Ye=te,fe){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=Ye+pe,fe={id:S++,callback:Se,priorityLevel:fe,startTime:Ye,expirationTime:pe,sortIndex:-1},Ye>te?(fe.sortIndex=Ye,n(N,fe),a(w)===null&&fe===a(N)&&(O?(ne(J),J=-1):O=!0,ke(ge,Ye-te))):(fe.sortIndex=pe,n(w,fe),F||M||(F=!0,Ne||(Ne=!0,oe()))),fe},l.unstable_shouldYield=ze,l.unstable_wrapCallback=function(fe){var Se=L;return function(){var Ye=L;L=Se;try{return fe.apply(this,arguments)}finally{L=Ye}}}})(o1)),o1}var _x;function Lv(){return _x||(_x=1,l1.exports=Mv()),l1.exports}var c1={exports:{}},on={};var Fx;function Rv(){if(Fx)return on;Fx=1;var l=ex();function n(w){var N="https://react.dev/errors/"+w;if(1<arguments.length){N+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)N+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+w+"; visit "+N+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var o={d:{f:a,r:function(){throw Error(n(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},s=Symbol.for("react.portal");function e(w,N,S){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:D==null?null:""+D,children:w,containerInfo:N,implementation:S}}var m=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function v(w,N){if(w==="font")return"";if(typeof N=="string")return N==="use-credentials"?N:""}return on.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,on.createPortal=function(w,N){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N||N.nodeType!==1&&N.nodeType!==9&&N.nodeType!==11)throw Error(n(299));return e(w,N,null,S)},on.flushSync=function(w){var N=m.T,S=o.p;try{if(m.T=null,o.p=2,w)return w()}finally{m.T=N,o.p=S,o.d.f()}},on.preconnect=function(w,N){typeof w=="string"&&(N?(N=N.crossOrigin,N=typeof N=="string"?N==="use-credentials"?N:"":void 0):N=null,o.d.C(w,N))},on.prefetchDNS=function(w){typeof w=="string"&&o.d.D(w)},on.preinit=function(w,N){if(typeof w=="string"&&N&&typeof N.as=="string"){var S=N.as,D=v(S,N.crossOrigin),L=typeof N.integrity=="string"?N.integrity:void 0,M=typeof N.fetchPriority=="string"?N.fetchPriority:void 0;S==="style"?o.d.S(w,typeof N.precedence=="string"?N.precedence:void 0,{crossOrigin:D,integrity:L,fetchPriority:M}):S==="script"&&o.d.X(w,{crossOrigin:D,integrity:L,fetchPriority:M,nonce:typeof N.nonce=="string"?N.nonce:void 0})}},on.preinitModule=function(w,N){if(typeof w=="string")if(typeof N=="object"&&N!==null){if(N.as==null||N.as==="script"){var S=v(N.as,N.crossOrigin);o.d.M(w,{crossOrigin:S,integrity:typeof N.integrity=="string"?N.integrity:void 0,nonce:typeof N.nonce=="string"?N.nonce:void 0})}}else N==null&&o.d.M(w)},on.preload=function(w,N){if(typeof w=="string"&&typeof N=="object"&&N!==null&&typeof N.as=="string"){var S=N.as,D=v(S,N.crossOrigin);o.d.L(w,S,{crossOrigin:D,integrity:typeof N.integrity=="string"?N.integrity:void 0,nonce:typeof N.nonce=="string"?N.nonce:void 0,type:typeof N.type=="string"?N.type:void 0,fetchPriority:typeof N.fetchPriority=="string"?N.fetchPriority:void 0,referrerPolicy:typeof N.referrerPolicy=="string"?N.referrerPolicy:void 0,imageSrcSet:typeof N.imageSrcSet=="string"?N.imageSrcSet:void 0,imageSizes:typeof N.imageSizes=="string"?N.imageSizes:void 0,media:typeof N.media=="string"?N.media:void 0})}},on.preloadModule=function(w,N){if(typeof w=="string")if(N){var S=v(N.as,N.crossOrigin);o.d.m(w,{as:typeof N.as=="string"&&N.as!=="script"?N.as:void 0,crossOrigin:S,integrity:typeof N.integrity=="string"?N.integrity:void 0})}else o.d.m(w)},on.requestFormReset=function(w){o.d.r(w)},on.unstable_batchedUpdates=function(w,N){return w(N)},on.useFormState=function(w,N,S){return m.H.useFormState(w,N,S)},on.useFormStatus=function(){return m.H.useHostTransitionStatus()},on.version="19.2.3",on}var Mx;function Ov(){if(Mx)return c1.exports;Mx=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(n){console.error(n)}}return l(),c1.exports=Rv(),c1.exports}var Lx;function Pv(){if(Lx)return Uf;Lx=1;var l=Lv(),n=ex(),a=Ov();function o(i){var c="https://react.dev/errors/"+i;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function e(i){var c=i,f=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(f=c.return),i=c.return;while(i)}return c.tag===3?f:null}function m(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function v(i){if(i.tag===31){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function w(i){if(e(i)!==i)throw Error(o(188))}function N(i){var c=i.alternate;if(!c){if(c=e(i),c===null)throw Error(o(188));return c!==i?null:i}for(var f=i,p=c;;){var C=f.return;if(C===null)break;var A=C.alternate;if(A===null){if(p=C.return,p!==null){f=p;continue}break}if(C.child===A.child){for(A=C.child;A;){if(A===f)return w(C),i;if(A===p)return w(C),c;A=A.sibling}throw Error(o(188))}if(f.return!==p.return)f=C,p=A;else{for(var U=!1,re=C.child;re;){if(re===f){U=!0,f=C,p=A;break}if(re===p){U=!0,p=C,f=A;break}re=re.sibling}if(!U){for(re=A.child;re;){if(re===f){U=!0,f=A,p=C;break}if(re===p){U=!0,p=A,f=C;break}re=re.sibling}if(!U)throw Error(o(189))}}if(f.alternate!==p)throw Error(o(190))}if(f.tag!==3)throw Error(o(188));return f.stateNode.current===f?i:c}function S(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i;for(i=i.child;i!==null;){if(c=S(i),c!==null)return c;i=i.sibling}return null}var D=Object.assign,L=Symbol.for("react.element"),M=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),ne=Symbol.for("react.consumer"),se=Symbol.for("react.context"),Ce=Symbol.for("react.forward_ref"),ge=Symbol.for("react.suspense"),Ne=Symbol.for("react.suspense_list"),J=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),le=Symbol.for("react.activity"),ze=Symbol.for("react.memo_cache_sentinel"),me=Symbol.iterator;function oe(i){return i===null||typeof i!="object"?null:(i=me&&i[me]||i["@@iterator"],typeof i=="function"?i:null)}var ce=Symbol.for("react.client.reference");function ye(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===ce?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case O:return"Fragment";case K:return"Profiler";case P:return"StrictMode";case ge:return"Suspense";case Ne:return"SuspenseList";case le:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case F:return"Portal";case se:return i.displayName||"Context";case ne:return(i._context.displayName||"Context")+".Consumer";case Ce:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case J:return c=i.displayName||null,c!==null?c:ye(i.type)||"Memo";case de:c=i._payload,i=i._init;try{return ye(i(c))}catch{}}return null}var ke=Array.isArray,fe=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Se=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ye={pending:!1,data:null,method:null,action:null},te=[],pe=-1;function V(i){return{current:i}}function be(i){0>pe||(i.current=te[pe],te[pe]=null,pe--)}function _e(i,c){pe++,te[pe]=i.current,i.current=c}var De=V(null),W=V(null),H=V(null),X=V(null);function je(i,c){switch(_e(H,c),_e(W,i),_e(De,null),c.nodeType){case 9:case 11:i=(i=c.documentElement)&&(i=i.namespaceURI)?Rf(i):0;break;default:if(i=c.tagName,c=c.namespaceURI)c=Rf(c),i=ii(c,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}be(De),_e(De,i)}function Q(){be(De),be(W),be(H)}function we(i){i.memoizedState!==null&&_e(X,i);var c=De.current,f=ii(c,i.type);c!==f&&(_e(W,i),_e(De,f))}function Fe(i){W.current===i&&(be(De),be(W)),X.current===i&&(be(X),Vt._currentValue=Ye)}var ue,xe;function tt(i){if(ue===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);ue=c&&c[1]||"",xe=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ue+i+xe}var Qe=!1;function Ve(i,c){if(!i||Qe)return"";Qe=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(c){var gt=function(){throw Error()};if(Object.defineProperty(gt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(gt,[])}catch(ct){var et=ct}Reflect.construct(i,[],gt)}else{try{gt.call()}catch(ct){et=ct}i.call(gt.prototype)}}else{try{throw Error()}catch(ct){et=ct}(gt=i())&&typeof gt.catch=="function"&&gt.catch(function(){})}}catch(ct){if(ct&&et&&typeof ct.stack=="string")return[ct.stack,et.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=p.DetermineComponentFrameRoot(),U=A[0],re=A[1];if(U&&re){var ve=U.split(`
`),qe=re.split(`
`);for(C=p=0;p<ve.length&&!ve[p].includes("DetermineComponentFrameRoot");)p++;for(;C<qe.length&&!qe[C].includes("DetermineComponentFrameRoot");)C++;if(p===ve.length||C===qe.length)for(p=ve.length-1,C=qe.length-1;1<=p&&0<=C&&ve[p]!==qe[C];)C--;for(;1<=p&&0<=C;p--,C--)if(ve[p]!==qe[C]){if(p!==1||C!==1)do if(p--,C--,0>C||ve[p]!==qe[C]){var ft=`
`+ve[p].replace(" at new "," at ");return i.displayName&&ft.includes("<anonymous>")&&(ft=ft.replace("<anonymous>",i.displayName)),ft}while(1<=p&&0<=C);break}}}finally{Qe=!1,Error.prepareStackTrace=f}return(f=i?i.displayName||i.name:"")?tt(f):""}function xt(i,c){switch(i.tag){case 26:case 27:case 5:return tt(i.type);case 16:return tt("Lazy");case 13:return i.child!==c&&c!==null?tt("Suspense Fallback"):tt("Suspense");case 19:return tt("SuspenseList");case 0:case 15:return Ve(i.type,!1);case 11:return Ve(i.type.render,!1);case 1:return Ve(i.type,!0);case 31:return tt("Activity");default:return""}}function nt(i){try{var c="",f=null;do c+=xt(i,f),f=i,i=i.return;while(i);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var $t=Object.prototype.hasOwnProperty,Mt=l.unstable_scheduleCallback,Es=l.unstable_cancelCallback,qs=l.unstable_shouldYield,ms=l.unstable_requestPaint,ys=l.unstable_now,Re=l.unstable_getCurrentPriorityLevel,ht=l.unstable_ImmediatePriority,Ft=l.unstable_UserBlockingPriority,Is=l.unstable_NormalPriority,jr=l.unstable_LowPriority,$r=l.unstable_IdlePriority,Za=l.log,ul=l.unstable_setDisableYieldValue,ka=null,ma=null;function Ir(i){if(typeof Za=="function"&&ul(i),ma&&typeof ma.setStrictMode=="function")try{ma.setStrictMode(ka,i)}catch{}}var xr=Math.clz32?Math.clz32:nh,Io=Math.log,Hl=Math.LN2;function nh(i){return i>>>=0,i===0?32:31-(Io(i)/Hl|0)|0}var qc=256,Vl=262144,Ua=4194304;function Yn(i){var c=i&42;if(c!==0)return c;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function es(i,c,f){var p=i.pendingLanes;if(p===0)return 0;var C=0,A=i.suspendedLanes,U=i.pingedLanes;i=i.warmLanes;var re=p&134217727;return re!==0?(p=re&~A,p!==0?C=Yn(p):(U&=re,U!==0?C=Yn(U):f||(f=re&~i,f!==0&&(C=Yn(f))))):(re=p&~A,re!==0?C=Yn(re):U!==0?C=Yn(U):f||(f=p&~i,f!==0&&(C=Yn(f)))),C===0?0:c!==0&&c!==C&&(c&A)===0&&(A=C&-C,f=c&-c,A>=f||A===32&&(f&4194048)!==0)?c:C}function ui(i,c){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&c)===0}function Wl(i,c){switch(i){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function is(){var i=Ua;return Ua<<=1,(Ua&62914560)===0&&(Ua=4194304),i}function $l(i){for(var c=[],f=0;31>f;f++)c.push(i);return c}function Mi(i,c){i.pendingLanes|=c,c!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ql(i,c,f,p,C,A){var U=i.pendingLanes;i.pendingLanes=f,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=f,i.entangledLanes&=f,i.errorRecoveryDisabledLanes&=f,i.shellSuspendCounter=0;var re=i.entanglements,ve=i.expirationTimes,qe=i.hiddenUpdates;for(f=U&~f;0<f;){var ft=31-xr(f),gt=1<<ft;re[ft]=0,ve[ft]=-1;var et=qe[ft];if(et!==null)for(qe[ft]=null,ft=0;ft<et.length;ft++){var ct=et[ft];ct!==null&&(ct.lane&=-536870913)}f&=~gt}p!==0&&hi(i,p,0),A!==0&&C===0&&i.tag!==0&&(i.suspendedLanes|=A&~(U&~c))}function hi(i,c,f){i.pendingLanes|=c,i.suspendedLanes&=~c;var p=31-xr(c);i.entangledLanes|=c,i.entanglements[p]=i.entanglements[p]|1073741824|f&261930}function qr(i,c){var f=i.entangledLanes|=c;for(i=i.entanglements;f;){var p=31-xr(f),C=1<<p;C&c|i[p]&c&&(i[p]|=c),f&=~C}}function fi(i,c){var f=c&-c;return f=(f&42)!==0?1:Bo(f),(f&(i.suspendedLanes|c))!==0?0:f}function Bo(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Li(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function mi(){var i=Se.p;return i!==0?i:(i=window.event,i===void 0?32:Ae(i.type))}function Ri(i,c){var f=Se.p;try{return Se.p=i,c()}finally{Se.p=f}}var Nr=Math.random().toString(36).slice(2),Tr="__reactFiber$"+Nr,_s="__reactProps$"+Nr,Ha="__reactContainer$"+Nr,vs="__reactEvents$"+Nr,lr="__reactListeners$"+Nr,en="__reactHandles$"+Nr,o0="__reactResources$"+Nr,mn="__reactMarker$"+Nr;function zo(i){delete i[Tr],delete i[_s],delete i[vs],delete i[lr],delete i[en]}function gn(i){var c=i[Tr];if(c)return c;for(var f=i.parentNode;f;){if(c=f[Ha]||f[Tr]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(i=Ug(i);i!==null;){if(f=i[Tr])return f;i=Ug(i)}return c}i=f,f=i.parentNode}return null}function Ma(i){if(i=i[Tr]||i[Ha]){var c=i.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return i}return null}function ga(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i.stateNode;throw Error(o(33))}function Br(i){var c=i[o0];return c||(c=i[o0]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function kr(i){i[mn]=!0}var zr=new Set,La={};function gi(i,c){xs(i,c),xs(i+"Capture",c)}function xs(i,c){for(La[i]=c,i=0;i<c.length;i++)zr.add(c[i])}var Yc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tn={},hl={};function hr(i){return $t.call(hl,i)?!0:$t.call(tn,i)?!1:Yc.test(i)?hl[i]=!0:(tn[i]=!0,!1)}function _r(i,c,f){if(hr(c))if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":i.removeAttribute(c);return;case"boolean":var p=c.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(c);return}}i.setAttribute(c,""+f)}}function Fr(i,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttribute(c,""+f)}}function Gn(i,c,f,p){if(p===null)i.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(f);return}i.setAttributeNS(c,f,""+p)}}function Ca(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function fs(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Tn(i,c,f){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,c);if(!i.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var C=p.get,A=p.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return C.call(this)},set:function(U){f=""+U,A.call(this,U)}}),Object.defineProperty(i,c,{enumerable:p.enumerable}),{getValue:function(){return f},setValue:function(U){f=""+U},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function Uo(i){if(!i._valueTracker){var c=fs(i)?"checked":"value";i._valueTracker=Tn(i,c,""+i[c])}}function Gc(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var f=c.getValue(),p="";return i&&(p=fs(i)?i.checked?"true":"false":i.value),i=p,i!==f?(c.setValue(i),!0):!1}function sn(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Kc=/[\n"\\]/g;function ws(i){return i.replace(Kc,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Ra(i,c,f,p,C,A,U,re){i.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?i.type=U:i.removeAttribute("type"),c!=null?U==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+Ca(c)):i.value!==""+Ca(c)&&(i.value=""+Ca(c)):U!=="submit"&&U!=="reset"||i.removeAttribute("value"),c!=null?Ys(i,U,Ca(c)):f!=null?Ys(i,U,Ca(f)):p!=null&&i.removeAttribute("value"),C==null&&A!=null&&(i.defaultChecked=!!A),C!=null&&(i.checked=C&&typeof C!="function"&&typeof C!="symbol"),re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"?i.name=""+Ca(re):i.removeAttribute("name")}function Qc(i,c,f,p,C,A,U,re){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.type=A),c!=null||f!=null){if(!(A!=="submit"&&A!=="reset"||c!=null)){Uo(i);return}f=f!=null?""+Ca(f):"",c=c!=null?""+Ca(c):f,re||c===i.value||(i.value=c),i.defaultValue=c}p=p??C,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=re?i.checked:!!p,i.defaultChecked=!!p,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(i.name=U),Uo(i)}function Ys(i,c,f){c==="number"&&sn(i.ownerDocument)===i||i.defaultValue===""+f||(i.defaultValue=""+f)}function Va(i,c,f,p){if(i=i.options,c){c={};for(var C=0;C<f.length;C++)c["$"+f[C]]=!0;for(f=0;f<i.length;f++)C=c.hasOwnProperty("$"+i[f].value),i[f].selected!==C&&(i[f].selected=C),C&&p&&(i[f].defaultSelected=!0)}else{for(f=""+Ca(f),c=null,C=0;C<i.length;C++){if(i[C].value===f){i[C].selected=!0,p&&(i[C].defaultSelected=!0);return}c!==null||i[C].disabled||(c=i[C])}c!==null&&(c.selected=!0)}}function Yl(i,c,f){if(c!=null&&(c=""+Ca(c),c!==i.value&&(i.value=c),f==null)){i.defaultValue!==c&&(i.defaultValue=c);return}i.defaultValue=f!=null?""+Ca(f):""}function Oi(i,c,f,p){if(c==null){if(p!=null){if(f!=null)throw Error(o(92));if(ke(p)){if(1<p.length)throw Error(o(93));p=p[0]}f=p}f==null&&(f=""),c=f}f=Ca(c),i.defaultValue=f,p=i.textContent,p===f&&p!==""&&p!==null&&(i.value=p),Uo(i)}function pi(i,c){if(c){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=c;return}}i.textContent=c}var Xc=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Jc(i,c,f){var p=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?p?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="":p?i.setProperty(c,f):typeof f!="number"||f===0||Xc.has(c)?c==="float"?i.cssFloat=f:i[c]=(""+f).trim():i[c]=f+"px"}function or(i,c,f){if(c!=null&&typeof c!="object")throw Error(o(62));if(i=i.style,f!=null){for(var p in f)!f.hasOwnProperty(p)||c!=null&&c.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var C in c)p=c[C],c.hasOwnProperty(C)&&f[C]!==p&&Jc(i,C,p)}else for(var A in c)c.hasOwnProperty(A)&&Jc(i,A,c[A])}function Gl(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var c0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),d0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function fl(i){return d0.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function rn(){}var G=null;function Oe(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Xe=null,He=null;function st(i){var c=Ma(i);if(c&&(i=c.stateNode)){var f=i[_s]||null;e:switch(i=c.stateNode,c.type){case"input":if(Ra(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+ws(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var p=f[c];if(p!==i&&p.form===i.form){var C=p[_s]||null;if(!C)throw Error(o(90));Ra(p,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name)}}for(c=0;c<f.length;c++)p=f[c],p.form===i.form&&Gc(p)}break e;case"textarea":Yl(i,f.value,f.defaultValue);break e;case"select":c=f.value,c!=null&&Va(i,!!f.multiple,c,!1)}}}var Ue=!1;function lt(i,c,f){if(Ue)return i(c,f);Ue=!0;try{var p=i(c);return p}finally{if(Ue=!1,(Xe!==null||He!==null)&&(ju(),Xe&&(c=Xe,i=He,He=Xe=null,st(c),i)))for(c=0;c<i.length;c++)st(i[c])}}function Ke(i,c){var f=i.stateNode;if(f===null)return null;var p=f[_s]||null;if(p===null)return null;f=p[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(o(231,c,typeof f));return f}var Be=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nt=!1;if(Be)try{var Ct={};Object.defineProperty(Ct,"passive",{get:function(){Nt=!0}}),window.addEventListener("test",Ct,Ct),window.removeEventListener("test",Ct,Ct)}catch{Nt=!1}var Rt=null,Le=null,Gt=null;function js(){if(Gt)return Gt;var i,c=Le,f=c.length,p,C="value"in Rt?Rt.value:Rt.textContent,A=C.length;for(i=0;i<f&&c[i]===C[i];i++);var U=f-i;for(p=1;p<=U&&c[f-p]===C[A-p];p++);return Gt=C.slice(i,1<p?1-p:void 0)}function cr(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function hs(){return!0}function ta(){return!1}function tr(i){function c(f,p,C,A,U){this._reactName=f,this._targetInst=C,this.type=p,this.nativeEvent=A,this.target=U,this.currentTarget=null;for(var re in i)i.hasOwnProperty(re)&&(f=i[re],this[re]=f?f(A):A[re]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?hs:ta,this.isPropagationStopped=ta,this}return D(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=hs)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=hs)},persist:function(){},isPersistent:hs}),c}var sa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_n=tr(sa),Ho=D({},sa,{view:0,detail:0}),vm=tr(Ho),u0,h0,Vo,Zc=D({},Ho,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hh,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Vo&&(Vo&&i.type==="mousemove"?(u0=i.screenX-Vo.screenX,h0=i.screenY-Vo.screenY):h0=u0=0,Vo=i),u0)},movementY:function(i){return"movementY"in i?i.movementY:h0}}),ih=tr(Zc),wm=D({},Zc,{dataTransfer:0}),jm=tr(wm),f0=D({},Ho,{relatedTarget:0}),m0=tr(f0),Wo=D({},sa,{animationName:0,elapsedTime:0,pseudoElement:0}),lh=tr(Wo),oh=D({},sa,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),ch=tr(oh),dh=D({},sa,{data:0}),g0=tr(dh),p0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$o={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pi(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=$o[i])?!!c[i]:!1}function hh(){return Pi}var pa=D({},Ho,{key:function(i){if(i.key){var c=p0[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=cr(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?uh[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hh,charCode:function(i){return i.type==="keypress"?cr(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?cr(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Kl=tr(pa),zp=D({},Zc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qo=tr(zp),Up=D({},Ho,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hh}),Hp=tr(Up),Vp=D({},sa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wp=tr(Vp),Nm=D({},Zc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Sa=tr(Nm),Oa=D({},sa,{newState:0,oldState:0}),pt=tr(Oa),Ii=[9,13,27,32],Pa=Be&&"CompositionEvent"in window,wt=null;Be&&"documentMode"in document&&(wt=document.documentMode);var ed=Be&&"TextEvent"in window&&!wt,fh=Be&&(!Pa||wt&&8<wt&&11>=wt),Yo=" ",x0=!1;function b0(i,c){switch(i){case"keyup":return Ii.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ur(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ml=!1;function Ar(i,c){switch(i){case"compositionend":return Ur(c);case"keypress":return c.which!==32?null:(x0=!0,Yo);case"textInput":return i=c.data,i===Yo&&x0?null:i;default:return null}}function Hr(i,c){if(ml)return i==="compositionend"||!Pa&&b0(i,c)?(i=js(),Gt=Le=Rt=null,ml=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return fh&&c.locale!=="ko"?null:c.data;default:return null}}var bs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ia(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!bs[i.type]:c==="textarea"}function Cs(i,c,f,p){Xe?He?He.push(p):He=[p]:Xe=p,c=Wd(c,"onChange"),0<c.length&&(f=new _n("onChange","change",null,f,p),i.push({event:f,listeners:c}))}var Fs=null,td=null;function xi(i){Pg(i,0)}function Kn(i){var c=ga(i);if(Gc(c))return i}function mh(i,c){if(i==="change")return c}var Ql=!1;if(Be){var pn;if(Be){var xa="oninput"in document;if(!xa){var ca=document.createElement("div");ca.setAttribute("oninput","return;"),xa=typeof ca.oninput=="function"}pn=xa}else pn=!1;Ql=pn&&(!document.documentMode||9<document.documentMode)}function y0(){Fs&&(Fs.detachEvent("onpropertychange",km),td=Fs=null)}function km(i){if(i.propertyName==="value"&&Kn(td)){var c=[];Cs(c,td,i,Oe(i)),lt(xi,c)}}function $p(i,c,f){i==="focusin"?(y0(),Fs=c,td=f,Fs.attachEvent("onpropertychange",km)):i==="focusout"&&y0()}function Fn(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Kn(td)}function Xl(i,c){if(i==="click")return Kn(c)}function Jl(i,c){if(i==="input"||i==="change")return Kn(c)}function Zl(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var xn=typeof Object.is=="function"?Object.is:Zl;function Go(i,c){if(xn(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var f=Object.keys(i),p=Object.keys(c);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var C=f[p];if(!$t.call(c,C)||!xn(i[C],c[C]))return!1}return!0}function v0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function sd(i,c){var f=v0(i);i=0;for(var p;f;){if(f.nodeType===3){if(p=i+f.textContent.length,i<=c&&p>=c)return{node:f,offset:c-i};i=p}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=v0(f)}}function Cm(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?Cm(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function w0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var c=sn(i.document);c instanceof i.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)i=c.contentWindow;else break;c=sn(i.document)}return c}function rd(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}var gh=Be&&"documentMode"in document&&11>=document.documentMode,eo=null,j0=null,Qn=null,gl=!1;function Aa(i,c,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;gl||eo==null||eo!==sn(p)||(p=eo,"selectionStart"in p&&rd(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Qn&&Go(Qn,p)||(Qn=p,p=Wd(j0,"onSelect"),0<p.length&&(c=new _n("onSelect","select",null,c,f),i.push({event:c,listeners:p}),c.target=eo)))}function Mn(i,c){var f={};return f[i.toLowerCase()]=c.toLowerCase(),f["Webkit"+i]="webkit"+c,f["Moz"+i]="moz"+c,f}var Bi={animationend:Mn("Animation","AnimationEnd"),animationiteration:Mn("Animation","AnimationIteration"),animationstart:Mn("Animation","AnimationStart"),transitionrun:Mn("Transition","TransitionRun"),transitionstart:Mn("Transition","TransitionStart"),transitioncancel:Mn("Transition","TransitionCancel"),transitionend:Mn("Transition","TransitionEnd")},N0={},k0={};Be&&(k0=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function ra(i){if(N0[i])return N0[i];if(!Bi[i])return i;var c=Bi[i],f;for(f in c)if(c.hasOwnProperty(f)&&f in k0)return N0[i]=c[f];return i}var ph=ra("animationend"),xh=ra("animationiteration"),Sm=ra("animationstart"),bh=ra("transitionrun"),yh=ra("transitionstart"),Am=ra("transitioncancel"),Em=ra("transitionend"),Ko=new Map,Xn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Xn.push("scrollEnd");function Ln(i,c){Ko.set(i,c),gi(c,[i])}var Qo=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Wa=[],pl=0,C0=0;function ks(){for(var i=pl,c=C0=pl=0;c<i;){var f=Wa[c];Wa[c++]=null;var p=Wa[c];Wa[c++]=null;var C=Wa[c];Wa[c++]=null;var A=Wa[c];if(Wa[c++]=null,p!==null&&C!==null){var U=p.pending;U===null?C.next=C:(C.next=U.next,U.next=C),p.pending=C}A!==0&&rr(f,C,A)}}function xl(i,c,f,p){Wa[pl++]=i,Wa[pl++]=c,Wa[pl++]=f,Wa[pl++]=p,C0|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function to(i,c,f,p){return xl(i,c,f,p),S0(i)}function Rn(i,c){return xl(i,null,null,c),S0(i)}function rr(i,c,f){i.lanes|=f;var p=i.alternate;p!==null&&(p.lanes|=f);for(var C=!1,A=i.return;A!==null;)A.childLanes|=f,p=A.alternate,p!==null&&(p.childLanes|=f),A.tag===22&&(i=A.stateNode,i===null||i._visibility&1||(C=!0)),i=A,A=A.return;return i.tag===3?(A=i.stateNode,C&&c!==null&&(C=31-xr(f),i=A.hiddenUpdates,p=i[C],p===null?i[C]=[c]:p.push(c),c.lane=f|536870912),A):null}function S0(i){if(50<Od)throw Od=0,Pd=null,Error(o(185));for(var c=i.return;c!==null;)i=c,c=i.return;return i.tag===3?i.stateNode:null}var so={};function Dm(i,c,f,p){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mr(i,c,f,p){return new Dm(i,c,f,p)}function vh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function bi(i,c){var f=i.alternate;return f===null?(f=Mr(i.tag,c,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=c,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&65011712,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,c=i.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f.refCleanup=i.refCleanup,f}function A0(i,c){i.flags&=65011714;var f=i.alternate;return f===null?(i.childLanes=0,i.lanes=c,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=f.childLanes,i.lanes=f.lanes,i.child=f.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=f.memoizedProps,i.memoizedState=f.memoizedState,i.updateQueue=f.updateQueue,i.type=f.type,c=f.dependencies,i.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),i}function ad(i,c,f,p,C,A){var U=0;if(p=i,typeof i=="function")vh(i)&&(U=1);else if(typeof i=="string")U=zt(i,f,De.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case le:return i=Mr(31,f,c,C),i.elementType=le,i.lanes=A,i;case O:return bn(f.children,C,A,c);case P:U=8,C|=24;break;case K:return i=Mr(12,f,c,C|2),i.elementType=K,i.lanes=A,i;case ge:return i=Mr(13,f,c,C),i.elementType=ge,i.lanes=A,i;case Ne:return i=Mr(19,f,c,C),i.elementType=Ne,i.lanes=A,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case se:U=10;break e;case ne:U=9;break e;case Ce:U=11;break e;case J:U=14;break e;case de:U=16,p=null;break e}U=29,f=Error(o(130,i===null?"null":typeof i,"")),p=null}return c=Mr(U,f,c,C),c.elementType=i,c.type=p,c.lanes=A,c}function bn(i,c,f,p){return i=Mr(7,i,p,c),i.lanes=f,i}function E0(i,c,f){return i=Mr(6,i,null,c),i.lanes=f,i}function wh(i){var c=Mr(18,null,null,0);return c.stateNode=i,c}function D0(i,c,f){return c=Mr(4,i.children!==null?i.children:[],i.key,c),c.lanes=f,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}var Tm=new WeakMap;function yn(i,c){if(typeof i=="object"&&i!==null){var f=Tm.get(i);return f!==void 0?f:(c={value:i,source:c,stack:nt(c)},Tm.set(i,c),c)}return{value:i,source:c,stack:nt(c)}}var ro=[],bl=0,Xo=null,Jo=0,vn=[],wn=0,zi=null,yi=1,Jn="";function vi(i,c){ro[bl++]=Jo,ro[bl++]=Xo,Xo=i,Jo=c}function nd(i,c,f){vn[wn++]=yi,vn[wn++]=Jn,vn[wn++]=zi,zi=i;var p=yi;i=Jn;var C=32-xr(p)-1;p&=~(1<<C),f+=1;var A=32-xr(c)+C;if(30<A){var U=C-C%5;A=(p&(1<<U)-1).toString(32),p>>=U,C-=U,yi=1<<32-xr(c)+C|f<<C|p,Jn=A+i}else yi=1<<A|f<<C|p,Jn=i}function T0(i){i.return!==null&&(vi(i,1),nd(i,1,0))}function _0(i){for(;i===Xo;)Xo=ro[--bl],ro[bl]=null,Jo=ro[--bl],ro[bl]=null;for(;i===zi;)zi=vn[--wn],vn[wn]=null,Jn=vn[--wn],vn[wn]=null,yi=vn[--wn],vn[wn]=null}function jh(i,c){vn[wn++]=yi,vn[wn++]=Jn,vn[wn++]=zi,yi=c.id,Jn=c.overflow,zi=i}var ba=null,Cr=null,Hs=!1,$a=null,Js=!1,Ea=Error(o(519));function br(i){var c=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Hi(yn(c,i)),Ea}function jn(i){var c=i.stateNode,f=i.type,p=i.memoizedProps;switch(c[Tr]=i,c[_s]=p,f){case"dialog":ds("cancel",c),ds("close",c);break;case"iframe":case"object":case"embed":ds("load",c);break;case"video":case"audio":for(f=0;f<So.length;f++)ds(So[f],c);break;case"source":ds("error",c);break;case"img":case"image":case"link":ds("error",c),ds("load",c);break;case"details":ds("toggle",c);break;case"input":ds("invalid",c),Qc(c,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":ds("invalid",c);break;case"textarea":ds("invalid",c),Oi(c,p.value,p.defaultValue,p.children)}f=p.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||p.suppressHydrationWarning===!0||Tf(c.textContent,f)?(p.popover!=null&&(ds("beforetoggle",c),ds("toggle",c)),p.onScroll!=null&&ds("scroll",c),p.onScrollEnd!=null&&ds("scrollend",c),p.onClick!=null&&(c.onclick=rn),c=!0):c=!1,c||br(i,!0)}function Nh(i){for(ba=i.return;ba;)switch(ba.tag){case 5:case 31:case 13:Js=!1;return;case 27:case 3:Js=!0;return;default:ba=ba.return}}function ao(i){if(i!==ba)return!1;if(!Hs)return Nh(i),Hs=!0,!1;var c=i.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=i.type,f=!(f!=="form"&&f!=="button")||Ac(i.type,i.memoizedProps)),f=!f),f&&Cr&&br(i),Nh(i),c===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(o(317));Cr=Ws(i)}else if(c===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(o(317));Cr=Ws(i)}else c===27?(c=Cr,ll(i.type)?(i=Ll,Ll=null,Cr=i):Cr=c):Cr=ba?Dn(i.stateNode.nextSibling):null;return!0}function Zn(){Cr=ba=null,Hs=!1}function Ui(){var i=$a;return i!==null&&(nn===null?nn=i:nn.push.apply(nn,i),$a=null),i}function Hi(i){$a===null?$a=[i]:$a.push(i)}var Vi=V(null),yl=null,Wi=null;function ei(i,c,f){_e(Vi,c._currentValue),c._currentValue=f}function wi(i){i._currentValue=Vi.current,be(Vi)}function F0(i,c,f){for(;i!==null;){var p=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),i===f)break;i=i.return}}function M0(i,c,f,p){var C=i.child;for(C!==null&&(C.return=i);C!==null;){var A=C.dependencies;if(A!==null){var U=C.child;A=A.firstContext;e:for(;A!==null;){var re=A;A=C;for(var ve=0;ve<c.length;ve++)if(re.context===c[ve]){A.lanes|=f,re=A.alternate,re!==null&&(re.lanes|=f),F0(A.return,f,i),p||(U=null);break e}A=re.next}}else if(C.tag===18){if(U=C.return,U===null)throw Error(o(341));U.lanes|=f,A=U.alternate,A!==null&&(A.lanes|=f),F0(U,f,i),U=null}else U=C.child;if(U!==null)U.return=C;else for(U=C;U!==null;){if(U===i){U=null;break}if(C=U.sibling,C!==null){C.return=U.return,U=C;break}U=U.return}C=U}}function qa(i,c,f,p){i=null;for(var C=c,A=!1;C!==null;){if(!A){if((C.flags&524288)!==0)A=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var U=C.alternate;if(U===null)throw Error(o(387));if(U=U.memoizedProps,U!==null){var re=C.type;xn(C.pendingProps.value,U.value)||(i!==null?i.push(re):i=[re])}}else if(C===X.current){if(U=C.alternate,U===null)throw Error(o(387));U.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(i!==null?i.push(Vt):i=[Vt])}C=C.return}i!==null&&M0(c,i,f,p),c.flags|=262144}function ji(i){for(i=i.firstContext;i!==null;){if(!xn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function vl(i){yl=i,Wi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function aa(i){return kh(yl,i)}function id(i,c){return yl===null&&vl(i),kh(i,c)}function kh(i,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},Wi===null){if(i===null)throw Error(o(308));Wi=c,i.dependencies={lanes:0,firstContext:c},i.flags|=524288}else Wi=Wi.next=c;return f}var qp=typeof AbortController<"u"?AbortController:function(){var i=[],c=this.signal={aborted:!1,addEventListener:function(f,p){i.push(p)}};this.abort=function(){c.aborted=!0,i.forEach(function(f){return f()})}},_m=l.unstable_scheduleCallback,Ba=l.unstable_NormalPriority,na={$$typeof:se,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zo(){return{controller:new qp,data:new Map,refCount:0}}function no(i){i.refCount--,i.refCount===0&&_m(Ba,function(){i.controller.abort()})}var ld=null,L0=0,io=0,lo=null;function Fm(i,c){if(ld===null){var f=ld=[];L0=0,io=Bs(),lo={status:"pending",value:void 0,then:function(p){f.push(p)}}}return L0++,c.then(Ch,Ch),c}function Ch(){if(--L0===0&&ld!==null){lo!==null&&(lo.status="fulfilled");var i=ld;ld=null,io=0,lo=null;for(var c=0;c<i.length;c++)(0,i[c])()}}function Mm(i,c){var f=[],p={status:"pending",value:null,reason:null,then:function(C){f.push(C)}};return i.then(function(){p.status="fulfilled",p.value=c;for(var C=0;C<f.length;C++)(0,f[C])(c)},function(C){for(p.status="rejected",p.reason=C,C=0;C<f.length;C++)(0,f[C])(void 0)}),p}var Lm=fe.S;fe.S=function(i,c){vg=ys(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&Fm(i,c),Lm!==null&&Lm(i,c)};var wl=V(null);function R0(){var i=wl.current;return i!==null?i:yr.pooledCache}function od(i,c){c===null?_e(wl,wl.current):_e(wl,c.pool)}function Rm(){var i=R0();return i===null?null:{parent:na._currentValue,pool:i}}var ec=Error(o(460)),O0=Error(o(474)),P0=Error(o(542)),I0={then:function(){}};function Sh(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Ah(i,c,f){switch(f=i[f],f===void 0?i.push(c):f!==c&&(c.then(rn,rn),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Eh(i),i;default:if(typeof c.status=="string")c.then(rn,rn);else{if(i=yr,i!==null&&100<i.shellSuspendCounter)throw Error(o(482));i=c,i.status="pending",i.then(function(p){if(c.status==="pending"){var C=c;C.status="fulfilled",C.value=p}},function(p){if(c.status==="pending"){var C=c;C.status="rejected",C.reason=p}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Eh(i),i}throw oo=c,ec}}function Ni(i){try{var c=i._init;return c(i._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(oo=f,ec):f}}var oo=null;function B0(){if(oo===null)throw Error(o(459));var i=oo;return oo=null,i}function Eh(i){if(i===ec||i===P0)throw Error(o(483))}var $i=null,tc=0;function cd(i){var c=tc;return tc+=1,$i===null&&($i=[]),Ah($i,i,c)}function sc(i,c){c=c.props.ref,i.ref=c!==void 0?c:null}function dd(i,c){throw c.$$typeof===L?Error(o(525)):(i=Object.prototype.toString.call(c),Error(o(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i)))}function ud(i){function c($e,Pe){if(i){var rt=$e.deletions;rt===null?($e.deletions=[Pe],$e.flags|=16):rt.push(Pe)}}function f($e,Pe){if(!i)return null;for(;Pe!==null;)c($e,Pe),Pe=Pe.sibling;return null}function p($e){for(var Pe=new Map;$e!==null;)$e.key!==null?Pe.set($e.key,$e):Pe.set($e.index,$e),$e=$e.sibling;return Pe}function C($e,Pe){return $e=bi($e,Pe),$e.index=0,$e.sibling=null,$e}function A($e,Pe,rt){return $e.index=rt,i?(rt=$e.alternate,rt!==null?(rt=rt.index,rt<Pe?($e.flags|=67108866,Pe):rt):($e.flags|=67108866,Pe)):($e.flags|=1048576,Pe)}function U($e){return i&&$e.alternate===null&&($e.flags|=67108866),$e}function re($e,Pe,rt,vt){return Pe===null||Pe.tag!==6?(Pe=E0(rt,$e.mode,vt),Pe.return=$e,Pe):(Pe=C(Pe,rt),Pe.return=$e,Pe)}function ve($e,Pe,rt,vt){var us=rt.type;return us===O?ft($e,Pe,rt.props.children,vt,rt.key):Pe!==null&&(Pe.elementType===us||typeof us=="object"&&us!==null&&us.$$typeof===de&&Ni(us)===Pe.type)?(Pe=C(Pe,rt.props),sc(Pe,rt),Pe.return=$e,Pe):(Pe=ad(rt.type,rt.key,rt.props,null,$e.mode,vt),sc(Pe,rt),Pe.return=$e,Pe)}function qe($e,Pe,rt,vt){return Pe===null||Pe.tag!==4||Pe.stateNode.containerInfo!==rt.containerInfo||Pe.stateNode.implementation!==rt.implementation?(Pe=D0(rt,$e.mode,vt),Pe.return=$e,Pe):(Pe=C(Pe,rt.children||[]),Pe.return=$e,Pe)}function ft($e,Pe,rt,vt,us){return Pe===null||Pe.tag!==7?(Pe=bn(rt,$e.mode,vt,us),Pe.return=$e,Pe):(Pe=C(Pe,rt),Pe.return=$e,Pe)}function gt($e,Pe,rt){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number"||typeof Pe=="bigint")return Pe=E0(""+Pe,$e.mode,rt),Pe.return=$e,Pe;if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case M:return rt=ad(Pe.type,Pe.key,Pe.props,null,$e.mode,rt),sc(rt,Pe),rt.return=$e,rt;case F:return Pe=D0(Pe,$e.mode,rt),Pe.return=$e,Pe;case de:return Pe=Ni(Pe),gt($e,Pe,rt)}if(ke(Pe)||oe(Pe))return Pe=bn(Pe,$e.mode,rt,null),Pe.return=$e,Pe;if(typeof Pe.then=="function")return gt($e,cd(Pe),rt);if(Pe.$$typeof===se)return gt($e,id($e,Pe),rt);dd($e,Pe)}return null}function et($e,Pe,rt,vt){var us=Pe!==null?Pe.key:null;if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return us!==null?null:re($e,Pe,""+rt,vt);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case M:return rt.key===us?ve($e,Pe,rt,vt):null;case F:return rt.key===us?qe($e,Pe,rt,vt):null;case de:return rt=Ni(rt),et($e,Pe,rt,vt)}if(ke(rt)||oe(rt))return us!==null?null:ft($e,Pe,rt,vt,null);if(typeof rt.then=="function")return et($e,Pe,cd(rt),vt);if(rt.$$typeof===se)return et($e,Pe,id($e,rt),vt);dd($e,rt)}return null}function ct($e,Pe,rt,vt,us){if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return $e=$e.get(rt)||null,re(Pe,$e,""+vt,us);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case M:return $e=$e.get(vt.key===null?rt:vt.key)||null,ve(Pe,$e,vt,us);case F:return $e=$e.get(vt.key===null?rt:vt.key)||null,qe(Pe,$e,vt,us);case de:return vt=Ni(vt),ct($e,Pe,rt,vt,us)}if(ke(vt)||oe(vt))return $e=$e.get(rt)||null,ft(Pe,$e,vt,us,null);if(typeof vt.then=="function")return ct($e,Pe,rt,cd(vt),us);if(vt.$$typeof===se)return ct($e,Pe,rt,id(Pe,vt),us);dd(Pe,vt)}return null}function Zt($e,Pe,rt,vt){for(var us=null,nr=null,ls=Pe,Ps=Pe=0,Ks=null;ls!==null&&Ps<rt.length;Ps++){ls.index>Ps?(Ks=ls,ls=null):Ks=ls.sibling;var ir=et($e,ls,rt[Ps],vt);if(ir===null){ls===null&&(ls=Ks);break}i&&ls&&ir.alternate===null&&c($e,ls),Pe=A(ir,Pe,Ps),nr===null?us=ir:nr.sibling=ir,nr=ir,ls=Ks}if(Ps===rt.length)return f($e,ls),Hs&&vi($e,Ps),us;if(ls===null){for(;Ps<rt.length;Ps++)ls=gt($e,rt[Ps],vt),ls!==null&&(Pe=A(ls,Pe,Ps),nr===null?us=ls:nr.sibling=ls,nr=ls);return Hs&&vi($e,Ps),us}for(ls=p(ls);Ps<rt.length;Ps++)Ks=ct(ls,$e,Ps,rt[Ps],vt),Ks!==null&&(i&&Ks.alternate!==null&&ls.delete(Ks.key===null?Ps:Ks.key),Pe=A(Ks,Pe,Ps),nr===null?us=Ks:nr.sibling=Ks,nr=Ks);return i&&ls.forEach(function(Dc){return c($e,Dc)}),Hs&&vi($e,Ps),us}function ps($e,Pe,rt,vt){if(rt==null)throw Error(o(151));for(var us=null,nr=null,ls=Pe,Ps=Pe=0,Ks=null,ir=rt.next();ls!==null&&!ir.done;Ps++,ir=rt.next()){ls.index>Ps?(Ks=ls,ls=null):Ks=ls.sibling;var Dc=et($e,ls,ir.value,vt);if(Dc===null){ls===null&&(ls=Ks);break}i&&ls&&Dc.alternate===null&&c($e,ls),Pe=A(Dc,Pe,Ps),nr===null?us=Dc:nr.sibling=Dc,nr=Dc,ls=Ks}if(ir.done)return f($e,ls),Hs&&vi($e,Ps),us;if(ls===null){for(;!ir.done;Ps++,ir=rt.next())ir=gt($e,ir.value,vt),ir!==null&&(Pe=A(ir,Pe,Ps),nr===null?us=ir:nr.sibling=ir,nr=ir);return Hs&&vi($e,Ps),us}for(ls=p(ls);!ir.done;Ps++,ir=rt.next())ir=ct(ls,$e,Ps,ir.value,vt),ir!==null&&(i&&ir.alternate!==null&&ls.delete(ir.key===null?Ps:ir.key),Pe=A(ir,Pe,Ps),nr===null?us=ir:nr.sibling=ir,nr=ir);return i&&ls.forEach(function(Ev){return c($e,Ev)}),Hs&&vi($e,Ps),us}function Sr($e,Pe,rt,vt){if(typeof rt=="object"&&rt!==null&&rt.type===O&&rt.key===null&&(rt=rt.props.children),typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case M:e:{for(var us=rt.key;Pe!==null;){if(Pe.key===us){if(us=rt.type,us===O){if(Pe.tag===7){f($e,Pe.sibling),vt=C(Pe,rt.props.children),vt.return=$e,$e=vt;break e}}else if(Pe.elementType===us||typeof us=="object"&&us!==null&&us.$$typeof===de&&Ni(us)===Pe.type){f($e,Pe.sibling),vt=C(Pe,rt.props),sc(vt,rt),vt.return=$e,$e=vt;break e}f($e,Pe);break}else c($e,Pe);Pe=Pe.sibling}rt.type===O?(vt=bn(rt.props.children,$e.mode,vt,rt.key),vt.return=$e,$e=vt):(vt=ad(rt.type,rt.key,rt.props,null,$e.mode,vt),sc(vt,rt),vt.return=$e,$e=vt)}return U($e);case F:e:{for(us=rt.key;Pe!==null;){if(Pe.key===us)if(Pe.tag===4&&Pe.stateNode.containerInfo===rt.containerInfo&&Pe.stateNode.implementation===rt.implementation){f($e,Pe.sibling),vt=C(Pe,rt.children||[]),vt.return=$e,$e=vt;break e}else{f($e,Pe);break}else c($e,Pe);Pe=Pe.sibling}vt=D0(rt,$e.mode,vt),vt.return=$e,$e=vt}return U($e);case de:return rt=Ni(rt),Sr($e,Pe,rt,vt)}if(ke(rt))return Zt($e,Pe,rt,vt);if(oe(rt)){if(us=oe(rt),typeof us!="function")throw Error(o(150));return rt=us.call(rt),ps($e,Pe,rt,vt)}if(typeof rt.then=="function")return Sr($e,Pe,cd(rt),vt);if(rt.$$typeof===se)return Sr($e,Pe,id($e,rt),vt);dd($e,rt)}return typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint"?(rt=""+rt,Pe!==null&&Pe.tag===6?(f($e,Pe.sibling),vt=C(Pe,rt),vt.return=$e,$e=vt):(f($e,Pe),vt=E0(rt,$e.mode,vt),vt.return=$e,$e=vt),U($e)):f($e,Pe)}return function($e,Pe,rt,vt){try{tc=0;var us=Sr($e,Pe,rt,vt);return $i=null,us}catch(ls){if(ls===ec||ls===P0)throw ls;var nr=Mr(29,ls,null,$e.mode);return nr.lanes=vt,nr.return=$e,nr}}}var jl=ud(!0),Dh=ud(!1),ti=!1;function z0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rc(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Da(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function qi(i,c,f){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(sr&2)!==0){var C=p.pending;return C===null?c.next=c:(c.next=C.next,C.next=c),p.pending=c,c=S0(i),rr(i,null,f),c}return xl(i,p,c,f),S0(i)}function co(i,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var p=c.lanes;p&=i.pendingLanes,f|=p,c.lanes=f,qr(i,f)}}function U0(i,c){var f=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var C=null,A=null;if(f=f.firstBaseUpdate,f!==null){do{var U={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};A===null?C=A=U:A=A.next=U,f=f.next}while(f!==null);A===null?C=A=c:A=A.next=c}else C=A=c;f={baseState:p.baseState,firstBaseUpdate:C,lastBaseUpdate:A,shared:p.shared,callbacks:p.callbacks},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=c:i.next=c,f.lastBaseUpdate=c}var H0=!1;function ac(){if(H0){var i=lo;if(i!==null)throw i}}function uo(i,c,f,p){H0=!1;var C=i.updateQueue;ti=!1;var A=C.firstBaseUpdate,U=C.lastBaseUpdate,re=C.shared.pending;if(re!==null){C.shared.pending=null;var ve=re,qe=ve.next;ve.next=null,U===null?A=qe:U.next=qe,U=ve;var ft=i.alternate;ft!==null&&(ft=ft.updateQueue,re=ft.lastBaseUpdate,re!==U&&(re===null?ft.firstBaseUpdate=qe:re.next=qe,ft.lastBaseUpdate=ve))}if(A!==null){var gt=C.baseState;U=0,ft=qe=ve=null,re=A;do{var et=re.lane&-536870913,ct=et!==re.lane;if(ct?(Vs&et)===et:(p&et)===et){et!==0&&et===io&&(H0=!0),ft!==null&&(ft=ft.next={lane:0,tag:re.tag,payload:re.payload,callback:null,next:null});e:{var Zt=i,ps=re;et=c;var Sr=f;switch(ps.tag){case 1:if(Zt=ps.payload,typeof Zt=="function"){gt=Zt.call(Sr,gt,et);break e}gt=Zt;break e;case 3:Zt.flags=Zt.flags&-65537|128;case 0:if(Zt=ps.payload,et=typeof Zt=="function"?Zt.call(Sr,gt,et):Zt,et==null)break e;gt=D({},gt,et);break e;case 2:ti=!0}}et=re.callback,et!==null&&(i.flags|=64,ct&&(i.flags|=8192),ct=C.callbacks,ct===null?C.callbacks=[et]:ct.push(et))}else ct={lane:et,tag:re.tag,payload:re.payload,callback:re.callback,next:null},ft===null?(qe=ft=ct,ve=gt):ft=ft.next=ct,U|=et;if(re=re.next,re===null){if(re=C.shared.pending,re===null)break;ct=re,re=ct.next,ct.next=null,C.lastBaseUpdate=ct,C.shared.pending=null}}while(!0);ft===null&&(ve=gt),C.baseState=ve,C.firstBaseUpdate=qe,C.lastBaseUpdate=ft,A===null&&(C.shared.lanes=0),rl|=U,i.lanes=U,i.memoizedState=gt}}function Th(i,c){if(typeof i!="function")throw Error(o(191,i));i.call(c)}function V0(i,c){var f=i.callbacks;if(f!==null)for(i.callbacks=null,i=0;i<f.length;i++)Th(f[i],c)}var Yi=V(null),Gi=V(0);function _h(i,c){i=sl,_e(Gi,i),_e(Yi,c),sl=i|c.baseLanes}function W0(){_e(Gi,sl),_e(Yi,Yi.current)}function Fh(){sl=Gi.current,be(Yi),be(Gi)}var Nn=V(null),kn=null;function si(i){var c=i.alternate;_e(Yr,Yr.current&1),_e(Nn,i),kn===null&&(c===null||Yi.current!==null||c.memoizedState!==null)&&(kn=i)}function hd(i){_e(Yr,Yr.current),_e(Nn,i),kn===null&&(kn=i)}function $0(i){i.tag===22?(_e(Yr,Yr.current),_e(Nn,i),kn===null&&(kn=i)):Ki()}function Ki(){_e(Yr,Yr.current),_e(Nn,Nn.current)}function da(i){be(Nn),kn===i&&(kn=null),be(Yr)}var Yr=V(0);function nc(i){for(var c=i;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Hu(f)||Ec(f)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var On=0,Ss=null,Xs=null,Lr=null,fd=!1,ho=!1,Nl=!1,md=0,ic=0,fo=null,Om=0;function Gr(){throw Error(o(321))}function Mh(i,c){if(c===null)return!1;for(var f=0;f<c.length&&f<i.length;f++)if(!xn(i[f],c[f]))return!1;return!0}function q0(i,c,f,p,C,A){return On=A,Ss=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,fe.H=i===null||i.memoizedState===null?Zm:Xh,Nl=!1,A=f(p,C),Nl=!1,ho&&(A=Im(c,f,p,C)),Pm(i),A}function Pm(i){fe.H=Cd;var c=Xs!==null&&Xs.next!==null;if(On=0,Lr=Xs=Ss=null,fd=!1,ic=0,fo=null,c)throw Error(o(300));i===null||ia||(i=i.dependencies,i!==null&&ji(i)&&(ia=!0))}function Im(i,c,f,p){Ss=i;var C=0;do{if(ho&&(fo=null),ic=0,ho=!1,25<=C)throw Error(o(301));if(C+=1,Lr=Xs=null,i.updateQueue!=null){var A=i.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}fe.H=eg,A=c(f,p)}while(ho);return A}function Yp(){var i=fe.H,c=i.useState()[0];return c=typeof c.then=="function"?pd(c):c,i=i.useState()[0],(Xs!==null?Xs.memoizedState:null)!==i&&(Ss.flags|=1024),c}function Lh(){var i=md!==0;return md=0,i}function Rh(i,c,f){c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~f}function gd(i){if(fd){for(i=i.memoizedState;i!==null;){var c=i.queue;c!==null&&(c.pending=null),i=i.next}fd=!1}On=0,Lr=Xs=Ss=null,ho=!1,ic=md=0,fo=null}function Ya(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lr===null?Ss.memoizedState=Lr=i:Lr=Lr.next=i,Lr}function Xr(){if(Xs===null){var i=Ss.alternate;i=i!==null?i.memoizedState:null}else i=Xs.next;var c=Lr===null?Ss.memoizedState:Lr.next;if(c!==null)Lr=c,Xs=i;else{if(i===null)throw Ss.alternate===null?Error(o(467)):Error(o(310));Xs=i,i={memoizedState:Xs.memoizedState,baseState:Xs.baseState,baseQueue:Xs.baseQueue,queue:Xs.queue,next:null},Lr===null?Ss.memoizedState=Lr=i:Lr=Lr.next=i}return Lr}function Y0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pd(i){var c=ic;return ic+=1,fo===null&&(fo=[]),i=Ah(fo,i,c),c=Ss,(Lr===null?c.memoizedState:Lr.next)===null&&(c=c.alternate,fe.H=c===null||c.memoizedState===null?Zm:Xh),i}function xd(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return pd(i);if(i.$$typeof===se)return aa(i)}throw Error(o(438,String(i)))}function Oh(i){var c=null,f=Ss.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var p=Ss.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(c={data:p.data.map(function(C){return C.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=Y0(),Ss.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(i),p=0;p<i;p++)f[p]=ze;return c.index++,f}function Qi(i,c){return typeof c=="function"?c(i):c}function bd(i){var c=Xr();return ri(c,Xs,i)}function ri(i,c,f){var p=i.queue;if(p===null)throw Error(o(311));p.lastRenderedReducer=f;var C=i.baseQueue,A=p.pending;if(A!==null){if(C!==null){var U=C.next;C.next=A.next,A.next=U}c.baseQueue=C=A,p.pending=null}if(A=i.baseState,C===null)i.memoizedState=A;else{c=C.next;var re=U=null,ve=null,qe=c,ft=!1;do{var gt=qe.lane&-536870913;if(gt!==qe.lane?(Vs&gt)===gt:(On&gt)===gt){var et=qe.revertLane;if(et===0)ve!==null&&(ve=ve.next={lane:0,revertLane:0,gesture:null,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null}),gt===io&&(ft=!0);else if((On&et)===et){qe=qe.next,et===io&&(ft=!0);continue}else gt={lane:0,revertLane:qe.revertLane,gesture:null,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null},ve===null?(re=ve=gt,U=A):ve=ve.next=gt,Ss.lanes|=et,rl|=et;gt=qe.action,Nl&&f(A,gt),A=qe.hasEagerState?qe.eagerState:f(A,gt)}else et={lane:gt,revertLane:qe.revertLane,gesture:qe.gesture,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null},ve===null?(re=ve=et,U=A):ve=ve.next=et,Ss.lanes|=gt,rl|=gt;qe=qe.next}while(qe!==null&&qe!==c);if(ve===null?U=A:ve.next=re,!xn(A,i.memoizedState)&&(ia=!0,ft&&(f=lo,f!==null)))throw f;i.memoizedState=A,i.baseState=U,i.baseQueue=ve,p.lastRenderedState=A}return C===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function Ph(i){var c=Xr(),f=c.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=i;var p=f.dispatch,C=f.pending,A=c.memoizedState;if(C!==null){f.pending=null;var U=C=C.next;do A=i(A,U.action),U=U.next;while(U!==C);xn(A,c.memoizedState)||(ia=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),f.lastRenderedState=A}return[A,p]}function Bm(i,c,f){var p=Ss,C=Xr(),A=Hs;if(A){if(f===void 0)throw Error(o(407));f=f()}else f=c();var U=!xn((Xs||C).memoizedState,f);if(U&&(C.memoizedState=f,ia=!0),C=C.queue,wd(zm.bind(null,p,C,i),[i]),C.getSnapshot!==c||U||Lr!==null&&Lr.memoizedState.tag&1){if(p.flags|=2048,Jr(9,{destroy:void 0},Bh.bind(null,p,C,f,c),null),yr===null)throw Error(o(349));A||(On&127)!==0||Ih(p,c,f)}return f}function Ih(i,c,f){i.flags|=16384,i={getSnapshot:c,value:f},c=Ss.updateQueue,c===null?(c=Y0(),Ss.updateQueue=c,c.stores=[i]):(f=c.stores,f===null?c.stores=[i]:f.push(i))}function Bh(i,c,f,p){c.value=f,c.getSnapshot=p,G0(c)&&K0(i)}function zm(i,c,f){return f(function(){G0(c)&&K0(i)})}function G0(i){var c=i.getSnapshot;i=i.value;try{var f=c();return!xn(i,f)}catch{return!0}}function K0(i){var c=Rn(i,2);c!==null&&Xa(c,i,2)}function Q0(i){var c=Ya();if(typeof i=="function"){var f=i;if(i=f(),Nl){Ir(!0);try{f()}finally{Ir(!1)}}}return c.memoizedState=c.baseState=i,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:i},c}function zh(i,c,f,p){return i.baseState=f,ri(i,Xs,typeof p=="function"?p:Qi)}function Um(i,c,f,p,C){if(tu(i))throw Error(o(485));if(i=c.action,i!==null){var A={payload:C,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){A.listeners.push(U)}};fe.T!==null?f(!0):A.isTransition=!1,p(A),f=c.pending,f===null?(A.next=c.pending=A,mo(c,A)):(A.next=f.next,c.pending=f.next=A)}}function mo(i,c){var f=c.action,p=c.payload,C=i.state;if(c.isTransition){var A=fe.T,U={};fe.T=U;try{var re=f(C,p),ve=fe.S;ve!==null&&ve(U,re),Hm(i,c,re)}catch(qe){X0(i,c,qe)}finally{A!==null&&U.types!==null&&(A.types=U.types),fe.T=A}}else try{A=f(C,p),Hm(i,c,A)}catch(qe){X0(i,c,qe)}}function Hm(i,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(p){Vm(i,c,p)},function(p){return X0(i,c,p)}):Vm(i,c,f)}function Vm(i,c,f){c.status="fulfilled",c.value=f,Uh(c),i.state=f,c=i.pending,c!==null&&(f=c.next,f===c?i.pending=null:(f=f.next,c.next=f,mo(i,f)))}function X0(i,c,f){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do c.status="rejected",c.reason=f,Uh(c),c=c.next;while(c!==p)}i.action=null}function Uh(i){i=i.listeners;for(var c=0;c<i.length;c++)(0,i[c])()}function yd(i,c){return c}function lc(i,c){if(Hs){var f=yr.formState;if(f!==null){e:{var p=Ss;if(Hs){if(Cr){t:{for(var C=Cr,A=Js;C.nodeType!==8;){if(!A){C=null;break t}if(C=Dn(C.nextSibling),C===null){C=null;break t}}A=C.data,C=A==="F!"||A==="F"?C:null}if(C){Cr=Dn(C.nextSibling),p=C.data==="F!";break e}}br(p)}p=!1}p&&(c=f[0])}}return f=Ya(),f.memoizedState=f.baseState=c,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yd,lastRenderedState:c},f.queue=p,f=uc.bind(null,Ss,p),p.dispatch=f,p=Q0(!1),A=Qh.bind(null,Ss,!1,p.queue),p=Ya(),C={state:c,dispatch:null,action:i,pending:null},p.queue=C,f=Um.bind(null,Ss,C,A,f),C.dispatch=f,p.memoizedState=i,[c,f,!1]}function vd(i){var c=Xr();return Hh(c,Xs,i)}function Hh(i,c,f){if(c=ri(i,c,yd)[0],i=bd(Qi)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var p=pd(c)}catch(U){throw U===ec?P0:U}else p=c;c=Xr();var C=c.queue,A=C.dispatch;return f!==c.memoizedState&&(Ss.flags|=2048,Jr(9,{destroy:void 0},Gp.bind(null,C,f),null)),[p,A,i]}function Gp(i,c){i.action=c}function Wm(i){var c=Xr(),f=Xs;if(f!==null)return Hh(c,f,i);Xr(),c=c.memoizedState,f=Xr();var p=f.queue.dispatch;return f.memoizedState=i,[c,p,!1]}function Jr(i,c,f,p){return i={tag:i,create:f,deps:p,inst:c,next:null},c=Ss.updateQueue,c===null&&(c=Y0(),Ss.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=i.next=i:(p=f.next,f.next=i,i.next=p,c.lastEffect=i),i}function oc(){return Xr().memoizedState}function kl(i,c,f,p){var C=Ya();Ss.flags|=i,C.memoizedState=Jr(1|c,{destroy:void 0},f,p===void 0?null:p)}function go(i,c,f,p){var C=Xr();p=p===void 0?null:p;var A=C.memoizedState.inst;Xs!==null&&p!==null&&Mh(p,Xs.memoizedState.deps)?C.memoizedState=Jr(c,A,f,p):(Ss.flags|=i,C.memoizedState=Jr(1|c,A,f,p))}function J0(i,c){kl(8390656,8,i,c)}function wd(i,c){go(2048,8,i,c)}function Cl(i){Ss.flags|=4;var c=Ss.updateQueue;if(c===null)c=Y0(),Ss.updateQueue=c,c.events=[i];else{var f=c.events;f===null?c.events=[i]:f.push(i)}}function Vh(i){var c=Xr().memoizedState;return Cl({ref:c,nextImpl:i}),function(){if((sr&2)!==0)throw Error(o(440));return c.impl.apply(void 0,arguments)}}function cc(i,c){return go(4,2,i,c)}function po(i,c){return go(4,4,i,c)}function $m(i,c){if(typeof c=="function"){i=i();var f=c(i);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function jd(i,c,f){f=f!=null?f.concat([i]):null,go(4,4,$m.bind(null,c,i),f)}function dc(){}function Wh(i,c){var f=Xr();c=c===void 0?null:c;var p=f.memoizedState;return c!==null&&Mh(c,p[1])?p[0]:(f.memoizedState=[i,c],i)}function $h(i,c){var f=Xr();c=c===void 0?null:c;var p=f.memoizedState;if(c!==null&&Mh(c,p[1]))return p[0];if(p=i(),Nl){Ir(!0);try{i()}finally{Ir(!1)}}return f.memoizedState=[p,c],p}function Z0(i,c,f){return f===void 0||(On&1073741824)!==0&&(Vs&261930)===0?i.memoizedState=c:(i.memoizedState=f,i=wg(),Ss.lanes|=i,rl|=i,f)}function qh(i,c,f,p){return xn(f,c)?f:Yi.current!==null?(i=Z0(i,f,p),xn(i,c)||(ia=!0),i):(On&42)===0||(On&1073741824)!==0&&(Vs&261930)===0?(ia=!0,i.memoizedState=f):(i=wg(),Ss.lanes|=i,rl|=i,c)}function Yh(i,c,f,p,C){var A=Se.p;Se.p=A!==0&&8>A?A:8;var U=fe.T,re={};fe.T=re,Qh(i,!1,c,f);try{var ve=C(),qe=fe.S;if(qe!==null&&qe(re,ve),ve!==null&&typeof ve=="object"&&typeof ve.then=="function"){var ft=Mm(ve,p);kd(i,c,ft,Qa(i))}else kd(i,c,p,Qa(i))}catch(gt){kd(i,c,{then:function(){},status:"rejected",reason:gt},Qa())}finally{Se.p=A,U!==null&&re.types!==null&&(U.types=re.types),fe.T=U}}function Nd(){}function Gh(i,c,f,p){if(i.tag!==5)throw Error(o(476));var C=Kh(i).queue;Yh(i,C,c,Ye,f===null?Nd:function(){return qm(i),f(p)})}function Kh(i){var c=i.memoizedState;if(c!==null)return c;c={memoizedState:Ye,baseState:Ye,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:Ye},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:f},next:null},i.memoizedState=c,i=i.alternate,i!==null&&(i.memoizedState=c),c}function qm(i){var c=Kh(i);c.next===null&&(c=i.alternate.memoizedState),kd(i,c.next.queue,{},Qa())}function eu(){return aa(Vt)}function Ym(){return Xr().memoizedState}function Gm(){return Xr().memoizedState}function Km(i){for(var c=i.return;c!==null;){switch(c.tag){case 24:case 3:var f=Qa();i=Da(f);var p=qi(c,i,f);p!==null&&(Xa(p,c,f),co(p,c,f)),c={cache:Zo()},i.payload=c;return}c=c.return}}function Qm(i,c,f){var p=Qa();f={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},tu(i)?Xm(c,f):(f=to(i,c,f,p),f!==null&&(Xa(f,i,p),Jm(f,c,p)))}function uc(i,c,f){var p=Qa();kd(i,c,f,p)}function kd(i,c,f,p){var C={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(tu(i))Xm(c,C);else{var A=i.alternate;if(i.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var U=c.lastRenderedState,re=A(U,f);if(C.hasEagerState=!0,C.eagerState=re,xn(re,U))return xl(i,c,C,0),yr===null&&ks(),!1}catch{}if(f=to(i,c,C,p),f!==null)return Xa(f,i,p),Jm(f,c,p),!0}return!1}function Qh(i,c,f,p){if(p={lane:2,revertLane:Bs(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},tu(i)){if(c)throw Error(o(479))}else c=to(i,f,p,2),c!==null&&Xa(c,i,2)}function tu(i){var c=i.alternate;return i===Ss||c!==null&&c===Ss}function Xm(i,c){ho=fd=!0;var f=i.pending;f===null?c.next=c:(c.next=f.next,f.next=c),i.pending=c}function Jm(i,c,f){if((f&4194048)!==0){var p=c.lanes;p&=i.pendingLanes,f|=p,c.lanes=f,qr(i,f)}}var Cd={readContext:aa,use:xd,useCallback:Gr,useContext:Gr,useEffect:Gr,useImperativeHandle:Gr,useLayoutEffect:Gr,useInsertionEffect:Gr,useMemo:Gr,useReducer:Gr,useRef:Gr,useState:Gr,useDebugValue:Gr,useDeferredValue:Gr,useTransition:Gr,useSyncExternalStore:Gr,useId:Gr,useHostTransitionStatus:Gr,useFormState:Gr,useActionState:Gr,useOptimistic:Gr,useMemoCache:Gr,useCacheRefresh:Gr};Cd.useEffectEvent=Gr;var Zm={readContext:aa,use:xd,useCallback:function(i,c){return Ya().memoizedState=[i,c===void 0?null:c],i},useContext:aa,useEffect:J0,useImperativeHandle:function(i,c,f){f=f!=null?f.concat([i]):null,kl(4194308,4,$m.bind(null,c,i),f)},useLayoutEffect:function(i,c){return kl(4194308,4,i,c)},useInsertionEffect:function(i,c){kl(4,2,i,c)},useMemo:function(i,c){var f=Ya();c=c===void 0?null:c;var p=i();if(Nl){Ir(!0);try{i()}finally{Ir(!1)}}return f.memoizedState=[p,c],p},useReducer:function(i,c,f){var p=Ya();if(f!==void 0){var C=f(c);if(Nl){Ir(!0);try{f(c)}finally{Ir(!1)}}}else C=c;return p.memoizedState=p.baseState=C,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:C},p.queue=i,i=i.dispatch=Qm.bind(null,Ss,i),[p.memoizedState,i]},useRef:function(i){var c=Ya();return i={current:i},c.memoizedState=i},useState:function(i){i=Q0(i);var c=i.queue,f=uc.bind(null,Ss,c);return c.dispatch=f,[i.memoizedState,f]},useDebugValue:dc,useDeferredValue:function(i,c){var f=Ya();return Z0(f,i,c)},useTransition:function(){var i=Q0(!1);return i=Yh.bind(null,Ss,i.queue,!0,!1),Ya().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,c,f){var p=Ss,C=Ya();if(Hs){if(f===void 0)throw Error(o(407));f=f()}else{if(f=c(),yr===null)throw Error(o(349));(Vs&127)!==0||Ih(p,c,f)}C.memoizedState=f;var A={value:f,getSnapshot:c};return C.queue=A,J0(zm.bind(null,p,A,i),[i]),p.flags|=2048,Jr(9,{destroy:void 0},Bh.bind(null,p,A,f,c),null),f},useId:function(){var i=Ya(),c=yr.identifierPrefix;if(Hs){var f=Jn,p=yi;f=(p&~(1<<32-xr(p)-1)).toString(32)+f,c="_"+c+"R_"+f,f=md++,0<f&&(c+="H"+f.toString(32)),c+="_"}else f=Om++,c="_"+c+"r_"+f.toString(32)+"_";return i.memoizedState=c},useHostTransitionStatus:eu,useFormState:lc,useActionState:lc,useOptimistic:function(i){var c=Ya();c.memoizedState=c.baseState=i;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=Qh.bind(null,Ss,!0,f),f.dispatch=c,[i,c]},useMemoCache:Oh,useCacheRefresh:function(){return Ya().memoizedState=Km.bind(null,Ss)},useEffectEvent:function(i){var c=Ya(),f={impl:i};return c.memoizedState=f,function(){if((sr&2)!==0)throw Error(o(440));return f.impl.apply(void 0,arguments)}}},Xh={readContext:aa,use:xd,useCallback:Wh,useContext:aa,useEffect:wd,useImperativeHandle:jd,useInsertionEffect:cc,useLayoutEffect:po,useMemo:$h,useReducer:bd,useRef:oc,useState:function(){return bd(Qi)},useDebugValue:dc,useDeferredValue:function(i,c){var f=Xr();return qh(f,Xs.memoizedState,i,c)},useTransition:function(){var i=bd(Qi)[0],c=Xr().memoizedState;return[typeof i=="boolean"?i:pd(i),c]},useSyncExternalStore:Bm,useId:Ym,useHostTransitionStatus:eu,useFormState:vd,useActionState:vd,useOptimistic:function(i,c){var f=Xr();return zh(f,Xs,i,c)},useMemoCache:Oh,useCacheRefresh:Gm};Xh.useEffectEvent=Vh;var eg={readContext:aa,use:xd,useCallback:Wh,useContext:aa,useEffect:wd,useImperativeHandle:jd,useInsertionEffect:cc,useLayoutEffect:po,useMemo:$h,useReducer:Ph,useRef:oc,useState:function(){return Ph(Qi)},useDebugValue:dc,useDeferredValue:function(i,c){var f=Xr();return Xs===null?Z0(f,i,c):qh(f,Xs.memoizedState,i,c)},useTransition:function(){var i=Ph(Qi)[0],c=Xr().memoizedState;return[typeof i=="boolean"?i:pd(i),c]},useSyncExternalStore:Bm,useId:Ym,useHostTransitionStatus:eu,useFormState:Wm,useActionState:Wm,useOptimistic:function(i,c){var f=Xr();return Xs!==null?zh(f,Xs,i,c):(f.baseState=i,[i,f.queue.dispatch])},useMemoCache:Oh,useCacheRefresh:Gm};eg.useEffectEvent=Vh;function Jh(i,c,f,p){c=i.memoizedState,f=f(p,c),f=f==null?c:D({},c,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var Zh={enqueueSetState:function(i,c,f){i=i._reactInternals;var p=Qa(),C=Da(p);C.payload=c,f!=null&&(C.callback=f),c=qi(i,C,p),c!==null&&(Xa(c,i,p),co(c,i,p))},enqueueReplaceState:function(i,c,f){i=i._reactInternals;var p=Qa(),C=Da(p);C.tag=1,C.payload=c,f!=null&&(C.callback=f),c=qi(i,C,p),c!==null&&(Xa(c,i,p),co(c,i,p))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var f=Qa(),p=Da(f);p.tag=2,c!=null&&(p.callback=c),c=qi(i,p,f),c!==null&&(Xa(c,i,f),co(c,i,f))}};function tg(i,c,f,p,C,A,U){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,A,U):c.prototype&&c.prototype.isPureReactComponent?!Go(f,p)||!Go(C,A):!0}function sg(i,c,f,p){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,p),c.state!==i&&Zh.enqueueReplaceState(c,c.state,null)}function Sl(i,c){var f=c;if("ref"in c){f={};for(var p in c)p!=="ref"&&(f[p]=c[p])}if(i=i.defaultProps){f===c&&(f=D({},f));for(var C in i)f[C]===void 0&&(f[C]=i[C])}return f}function su(i){Qo(i)}function rg(i){console.error(i)}function ag(i){Qo(i)}function ru(i,c){try{var f=i.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(p){setTimeout(function(){throw p})}}function ef(i,c,f){try{var p=i.onCaughtError;p(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function Al(i,c,f){return f=Da(f),f.tag=3,f.payload={element:null},f.callback=function(){ru(i,c)},f}function tf(i){return i=Da(i),i.tag=3,i}function sf(i,c,f,p){var C=f.type.getDerivedStateFromError;if(typeof C=="function"){var A=p.value;i.payload=function(){return C(A)},i.callback=function(){ef(c,f,p)}}var U=f.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(i.callback=function(){ef(c,f,p),typeof C!="function"&&(_l===null?_l=new Set([this]):_l.add(this));var re=p.stack;this.componentDidCatch(p.value,{componentStack:re!==null?re:""})})}function ng(i,c,f,p,C){if(f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(c=f.alternate,c!==null&&qa(c,f,C,!0),f=Nn.current,f!==null){switch(f.tag){case 31:case 13:return kn===null?Nu():f.alternate===null&&Vr===0&&(Vr=3),f.flags&=-257,f.flags|=65536,f.lanes=C,p===I0?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([p]):c.add(p),Cu(i,p,C)),!1;case 22:return f.flags|=65536,p===I0?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([p])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([p]):f.add(p)),Cu(i,p,C)),!1}throw Error(o(435,f.tag))}return Cu(i,p,C),Nu(),!1}if(Hs)return c=Nn.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=C,p!==Ea&&(i=Error(o(422),{cause:p}),Hi(yn(i,f)))):(p!==Ea&&(c=Error(o(423),{cause:p}),Hi(yn(c,f))),i=i.current.alternate,i.flags|=65536,C&=-C,i.lanes|=C,p=yn(p,f),C=Al(i.stateNode,p,C),U0(i,C),Vr!==4&&(Vr=2)),!1;var A=Error(o(520),{cause:p});if(A=yn(A,f),Rd===null?Rd=[A]:Rd.push(A),Vr!==4&&(Vr=2),c===null)return!0;p=yn(p,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,i=C&-C,f.lanes|=i,i=Al(f.stateNode,p,i),U0(f,i),!1;case 1:if(c=f.type,A=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(_l===null||!_l.has(A))))return f.flags|=65536,C&=-C,f.lanes|=C,C=tf(C),sf(C,i,f,p),U0(f,C),!1}f=f.return}while(f!==null);return!1}var rf=Error(o(461)),ia=!1;function ya(i,c,f,p){c.child=i===null?Dh(c,null,f,p):jl(c,i.child,f,p)}function au(i,c,f,p,C){f=f.render;var A=c.ref;if("ref"in p){var U={};for(var re in p)re!=="ref"&&(U[re]=p[re])}else U=p;return vl(c),p=q0(i,c,f,U,A,C),re=Lh(),i!==null&&!ia?(Rh(i,c,C),Xi(i,c,C)):(Hs&&re&&T0(c),c.flags|=1,ya(i,c,p,C),c.child)}function af(i,c,f,p,C){if(i===null){var A=f.type;return typeof A=="function"&&!vh(A)&&A.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=A,xo(i,c,A,p,C)):(i=ad(f.type,null,p,c,c.mode,C),i.ref=c.ref,i.return=c,c.child=i)}if(A=i.child,!yo(i,C)){var U=A.memoizedProps;if(f=f.compare,f=f!==null?f:Go,f(U,p)&&i.ref===c.ref)return Xi(i,c,C)}return c.flags|=1,i=bi(A,p),i.ref=c.ref,i.return=c,c.child=i}function xo(i,c,f,p,C){if(i!==null){var A=i.memoizedProps;if(Go(A,p)&&i.ref===c.ref)if(ia=!1,c.pendingProps=p=A,yo(i,C))(i.flags&131072)!==0&&(ia=!0);else return c.lanes=i.lanes,Xi(i,c,C)}return iu(i,c,f,p,C)}function ig(i,c,f,p){var C=p.children,A=i!==null?i.memoizedState:null;if(i===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((c.flags&128)!==0){if(A=A!==null?A.baseLanes|f:f,i!==null){for(p=c.child=i.child,C=0;p!==null;)C=C|p.lanes|p.childLanes,p=p.sibling;p=C&~A}else p=0,c.child=null;return nu(i,c,A,f,p)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},i!==null&&od(c,A!==null?A.cachePool:null),A!==null?_h(c,A):W0(),$0(c);else return p=c.lanes=536870912,nu(i,c,A!==null?A.baseLanes|f:f,f,p)}else A!==null?(od(c,A.cachePool),_h(c,A),Ki(),c.memoizedState=null):(i!==null&&od(c,null),W0(),Ki());return ya(i,c,C,f),c.child}function bo(i,c){return i!==null&&i.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function nu(i,c,f,p,C){var A=R0();return A=A===null?null:{parent:na._currentValue,pool:A},c.memoizedState={baseLanes:f,cachePool:A},i!==null&&od(c,null),W0(),$0(c),i!==null&&qa(i,c,p,!0),c.childLanes=C,null}function Sd(i,c){return c=Ed({mode:c.mode,children:c.children},i.mode),c.ref=i.ref,i.child=c,c.return=i,c}function nf(i,c,f){return jl(c,i.child,null,f),i=Sd(c,c.pendingProps),i.flags|=2,da(c),c.memoizedState=null,i}function la(i,c,f){var p=c.pendingProps,C=(c.flags&128)!==0;if(c.flags&=-129,i===null){if(Hs){if(p.mode==="hidden")return i=Sd(c,p),c.lanes=536870912,bo(null,i);if(hd(c),(i=Cr)?(i=Uu(i,Js),i=i!==null&&i.data==="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:zi!==null?{id:yi,overflow:Jn}:null,retryLane:536870912,hydrationErrors:null},f=wh(i),f.return=c,c.child=f,ba=c,Cr=null)):i=null,i===null)throw br(c);return c.lanes=536870912,null}return Sd(c,p)}var A=i.memoizedState;if(A!==null){var U=A.dehydrated;if(hd(c),C)if(c.flags&256)c.flags&=-257,c=nf(i,c,f);else if(c.memoizedState!==null)c.child=i.child,c.flags|=128,c=null;else throw Error(o(558));else if(ia||qa(i,c,f,!1),C=(f&i.childLanes)!==0,ia||C){if(p=yr,p!==null&&(U=fi(p,f),U!==0&&U!==A.retryLane))throw A.retryLane=U,Rn(i,U),Xa(p,i,U),rf;Nu(),c=nf(i,c,f)}else i=A.treeContext,Cr=Dn(U.nextSibling),ba=c,Hs=!0,$a=null,Js=!1,i!==null&&jh(c,i),c=Sd(c,p),c.flags|=4096;return c}return i=bi(i.child,{mode:p.mode,children:p.children}),i.ref=c.ref,c.child=i,i.return=c,i}function ai(i,c){var f=c.ref;if(f===null)i!==null&&i.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(o(284));(i===null||i.ref!==f)&&(c.flags|=4194816)}}function iu(i,c,f,p,C){return vl(c),f=q0(i,c,f,p,void 0,C),p=Lh(),i!==null&&!ia?(Rh(i,c,C),Xi(i,c,C)):(Hs&&p&&T0(c),c.flags|=1,ya(i,c,f,C),c.child)}function lf(i,c,f,p,C,A){return vl(c),c.updateQueue=null,f=Im(c,p,f,C),Pm(i),p=Lh(),i!==null&&!ia?(Rh(i,c,A),Xi(i,c,A)):(Hs&&p&&T0(c),c.flags|=1,ya(i,c,f,A),c.child)}function of(i,c,f,p,C){if(vl(c),c.stateNode===null){var A=so,U=f.contextType;typeof U=="object"&&U!==null&&(A=aa(U)),A=new f(p,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=Zh,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=p,A.state=c.memoizedState,A.refs={},z0(c),U=f.contextType,A.context=typeof U=="object"&&U!==null?aa(U):so,A.state=c.memoizedState,U=f.getDerivedStateFromProps,typeof U=="function"&&(Jh(c,f,U,p),A.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(U=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),U!==A.state&&Zh.enqueueReplaceState(A,A.state,null),uo(c,p,A,C),ac(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),p=!0}else if(i===null){A=c.stateNode;var re=c.memoizedProps,ve=Sl(f,re);A.props=ve;var qe=A.context,ft=f.contextType;U=so,typeof ft=="object"&&ft!==null&&(U=aa(ft));var gt=f.getDerivedStateFromProps;ft=typeof gt=="function"||typeof A.getSnapshotBeforeUpdate=="function",re=c.pendingProps!==re,ft||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(re||qe!==U)&&sg(c,A,p,U),ti=!1;var et=c.memoizedState;A.state=et,uo(c,p,A,C),ac(),qe=c.memoizedState,re||et!==qe||ti?(typeof gt=="function"&&(Jh(c,f,gt,p),qe=c.memoizedState),(ve=ti||tg(c,f,ve,p,et,qe,U))?(ft||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=qe),A.props=p,A.state=qe,A.context=U,p=ve):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{A=c.stateNode,rc(i,c),U=c.memoizedProps,ft=Sl(f,U),A.props=ft,gt=c.pendingProps,et=A.context,qe=f.contextType,ve=so,typeof qe=="object"&&qe!==null&&(ve=aa(qe)),re=f.getDerivedStateFromProps,(qe=typeof re=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==gt||et!==ve)&&sg(c,A,p,ve),ti=!1,et=c.memoizedState,A.state=et,uo(c,p,A,C),ac();var ct=c.memoizedState;U!==gt||et!==ct||ti||i!==null&&i.dependencies!==null&&ji(i.dependencies)?(typeof re=="function"&&(Jh(c,f,re,p),ct=c.memoizedState),(ft=ti||tg(c,f,ft,p,et,ct,ve)||i!==null&&i.dependencies!==null&&ji(i.dependencies))?(qe||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(p,ct,ve),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(p,ct,ve)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||U===i.memoizedProps&&et===i.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===i.memoizedProps&&et===i.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=ct),A.props=p,A.state=ct,A.context=ve,p=ft):(typeof A.componentDidUpdate!="function"||U===i.memoizedProps&&et===i.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===i.memoizedProps&&et===i.memoizedState||(c.flags|=1024),p=!1)}return A=p,ai(i,c),p=(c.flags&128)!==0,A||p?(A=c.stateNode,f=p&&typeof f.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,i!==null&&p?(c.child=jl(c,i.child,null,C),c.child=jl(c,null,f,C)):ya(i,c,f,C),c.memoizedState=A.state,i=c.child):i=Xi(i,c,C),i}function lg(i,c,f,p){return Zn(),c.flags|=256,ya(i,c,f,p),c.child}var lu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ou(i){return{baseLanes:i,cachePool:Rm()}}function cf(i,c,f){return i=i!==null?i.childLanes&~f:0,c&&(i|=Sn),i}function hc(i,c,f){var p=c.pendingProps,C=!1,A=(c.flags&128)!==0,U;if((U=A)||(U=i!==null&&i.memoizedState===null?!1:(Yr.current&2)!==0),U&&(C=!0,c.flags&=-129),U=(c.flags&32)!==0,c.flags&=-33,i===null){if(Hs){if(C?si(c):Ki(),(i=Cr)?(i=Uu(i,Js),i=i!==null&&i.data!=="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:zi!==null?{id:yi,overflow:Jn}:null,retryLane:536870912,hydrationErrors:null},f=wh(i),f.return=c,c.child=f,ba=c,Cr=null)):i=null,i===null)throw br(c);return Ec(i)?c.lanes=32:c.lanes=536870912,null}var re=p.children;return p=p.fallback,C?(Ki(),C=c.mode,re=Ed({mode:"hidden",children:re},C),p=bn(p,C,f,null),re.return=c,p.return=c,re.sibling=p,c.child=re,p=c.child,p.memoizedState=ou(f),p.childLanes=cf(i,U,f),c.memoizedState=lu,bo(null,p)):(si(c),Ad(c,re))}var ve=i.memoizedState;if(ve!==null&&(re=ve.dehydrated,re!==null)){if(A)c.flags&256?(si(c),c.flags&=-257,c=df(i,c,f)):c.memoizedState!==null?(Ki(),c.child=i.child,c.flags|=128,c=null):(Ki(),re=p.fallback,C=c.mode,p=Ed({mode:"visible",children:p.children},C),re=bn(re,C,f,null),re.flags|=2,p.return=c,re.return=c,p.sibling=re,c.child=p,jl(c,i.child,null,f),p=c.child,p.memoizedState=ou(f),p.childLanes=cf(i,U,f),c.memoizedState=lu,c=bo(null,p));else if(si(c),Ec(re)){if(U=re.nextSibling&&re.nextSibling.dataset,U)var qe=U.dgst;U=qe,p=Error(o(419)),p.stack="",p.digest=U,Hi({value:p,source:null,stack:null}),c=df(i,c,f)}else if(ia||qa(i,c,f,!1),U=(f&i.childLanes)!==0,ia||U){if(U=yr,U!==null&&(p=fi(U,f),p!==0&&p!==ve.retryLane))throw ve.retryLane=p,Rn(i,p),Xa(U,i,p),rf;Hu(re)||Nu(),c=df(i,c,f)}else Hu(re)?(c.flags|=192,c.child=i.child,c=null):(i=ve.treeContext,Cr=Dn(re.nextSibling),ba=c,Hs=!0,$a=null,Js=!1,i!==null&&jh(c,i),c=Ad(c,p.children),c.flags|=4096);return c}return C?(Ki(),re=p.fallback,C=c.mode,ve=i.child,qe=ve.sibling,p=bi(ve,{mode:"hidden",children:p.children}),p.subtreeFlags=ve.subtreeFlags&65011712,qe!==null?re=bi(qe,re):(re=bn(re,C,f,null),re.flags|=2),re.return=c,p.return=c,p.sibling=re,c.child=p,bo(null,p),p=c.child,re=i.child.memoizedState,re===null?re=ou(f):(C=re.cachePool,C!==null?(ve=na._currentValue,C=C.parent!==ve?{parent:ve,pool:ve}:C):C=Rm(),re={baseLanes:re.baseLanes|f,cachePool:C}),p.memoizedState=re,p.childLanes=cf(i,U,f),c.memoizedState=lu,bo(i.child,p)):(si(c),f=i.child,i=f.sibling,f=bi(f,{mode:"visible",children:p.children}),f.return=c,f.sibling=null,i!==null&&(U=c.deletions,U===null?(c.deletions=[i],c.flags|=16):U.push(i)),c.child=f,c.memoizedState=null,f)}function Ad(i,c){return c=Ed({mode:"visible",children:c},i.mode),c.return=i,i.child=c}function Ed(i,c){return i=Mr(22,i,null,c),i.lanes=0,i}function df(i,c,f){return jl(c,i.child,null,f),i=Ad(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function uf(i,c,f){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c),F0(i.return,c,f)}function hf(i,c,f,p,C,A){var U=i.memoizedState;U===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:C,treeForkCount:A}:(U.isBackwards=c,U.rendering=null,U.renderingStartTime=0,U.last=p,U.tail=f,U.tailMode=C,U.treeForkCount=A)}function og(i,c,f){var p=c.pendingProps,C=p.revealOrder,A=p.tail;p=p.children;var U=Yr.current,re=(U&2)!==0;if(re?(U=U&1|2,c.flags|=128):U&=1,_e(Yr,U),ya(i,c,p,f),p=Hs?Jo:0,!re&&i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&uf(i,f,c);else if(i.tag===19)uf(i,f,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(C){case"forwards":for(f=c.child,C=null;f!==null;)i=f.alternate,i!==null&&nc(i)===null&&(C=f),f=f.sibling;f=C,f===null?(C=c.child,c.child=null):(C=f.sibling,f.sibling=null),hf(c,!1,C,f,A,p);break;case"backwards":case"unstable_legacy-backwards":for(f=null,C=c.child,c.child=null;C!==null;){if(i=C.alternate,i!==null&&nc(i)===null){c.child=C;break}i=C.sibling,C.sibling=f,f=C,C=i}hf(c,!0,f,null,A,p);break;case"together":hf(c,!1,null,null,void 0,p);break;default:c.memoizedState=null}return c.child}function Xi(i,c,f){if(i!==null&&(c.dependencies=i.dependencies),rl|=c.lanes,(f&c.childLanes)===0)if(i!==null){if(qa(i,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(i!==null&&c.child!==i.child)throw Error(o(153));if(c.child!==null){for(i=c.child,f=bi(i,i.pendingProps),c.child=f,f.return=c;i.sibling!==null;)i=i.sibling,f=f.sibling=bi(i,i.pendingProps),f.return=c;f.sibling=null}return c.child}function yo(i,c){return(i.lanes&c)!==0?!0:(i=i.dependencies,!!(i!==null&&ji(i)))}function Dd(i,c,f){switch(c.tag){case 3:je(c,c.stateNode.containerInfo),ei(c,na,i.memoizedState.cache),Zn();break;case 27:case 5:we(c);break;case 4:je(c,c.stateNode.containerInfo);break;case 10:ei(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,hd(c),null;break;case 13:var p=c.memoizedState;if(p!==null)return p.dehydrated!==null?(si(c),c.flags|=128,null):(f&c.child.childLanes)!==0?hc(i,c,f):(si(c),i=Xi(i,c,f),i!==null?i.sibling:null);si(c);break;case 19:var C=(i.flags&128)!==0;if(p=(f&c.childLanes)!==0,p||(qa(i,c,f,!1),p=(f&c.childLanes)!==0),C){if(p)return og(i,c,f);c.flags|=128}if(C=c.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),_e(Yr,Yr.current),p)break;return null;case 22:return c.lanes=0,ig(i,c,f,c.pendingProps);case 24:ei(c,na,i.memoizedState.cache)}return Xi(i,c,f)}function cg(i,c,f){if(i!==null)if(i.memoizedProps!==c.pendingProps)ia=!0;else{if(!yo(i,f)&&(c.flags&128)===0)return ia=!1,Dd(i,c,f);ia=(i.flags&131072)!==0}else ia=!1,Hs&&(c.flags&1048576)!==0&&nd(c,Jo,c.index);switch(c.lanes=0,c.tag){case 16:e:{var p=c.pendingProps;if(i=Ni(c.elementType),c.type=i,typeof i=="function")vh(i)?(p=Sl(i,p),c.tag=1,c=of(null,c,i,p,f)):(c.tag=0,c=iu(null,c,i,p,f));else{if(i!=null){var C=i.$$typeof;if(C===Ce){c.tag=11,c=au(null,c,i,p,f);break e}else if(C===J){c.tag=14,c=af(null,c,i,p,f);break e}}throw c=ye(i)||i,Error(o(306,c,""))}}return c;case 0:return iu(i,c,c.type,c.pendingProps,f);case 1:return p=c.type,C=Sl(p,c.pendingProps),of(i,c,p,C,f);case 3:e:{if(je(c,c.stateNode.containerInfo),i===null)throw Error(o(387));p=c.pendingProps;var A=c.memoizedState;C=A.element,rc(i,c),uo(c,p,null,f);var U=c.memoizedState;if(p=U.cache,ei(c,na,p),p!==A.cache&&M0(c,[na],f,!0),ac(),p=U.element,A.isDehydrated)if(A={element:p,isDehydrated:!1,cache:U.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=lg(i,c,p,f);break e}else if(p!==C){C=yn(Error(o(424)),c),Hi(C),c=lg(i,c,p,f);break e}else for(i=c.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,Cr=Dn(i.firstChild),ba=c,Hs=!0,$a=null,Js=!0,f=Dh(c,null,p,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Zn(),p===C){c=Xi(i,c,f);break e}ya(i,c,p,f)}c=c.child}return c;case 26:return ai(i,c),i===null?(f=Y(c.type,null,c.pendingProps,null))?c.memoizedState=f:Hs||(f=c.type,i=c.pendingProps,p=$d(H.current).createElement(f),p[Tr]=c,p[_s]=i,ja(p,f,i),kr(p),c.stateNode=p):c.memoizedState=Y(c.type,i.memoizedProps,c.pendingProps,i.memoizedState),null;case 27:return we(c),i===null&&Hs&&(p=c.stateNode=r(c.type,c.pendingProps,H.current),ba=c,Js=!0,C=Cr,ll(c.type)?(Ll=C,Cr=Dn(p.firstChild)):Cr=C),ya(i,c,c.pendingProps.children,f),ai(i,c),i===null&&(c.flags|=4194304),c.child;case 5:return i===null&&Hs&&((C=p=Cr)&&(p=zu(p,c.type,c.pendingProps,Js),p!==null?(c.stateNode=p,ba=c,Cr=Dn(p.firstChild),Js=!1,C=!0):C=!1),C||br(c)),we(c),C=c.type,A=c.pendingProps,U=i!==null?i.memoizedProps:null,p=A.children,Ac(C,A)?p=null:U!==null&&Ac(C,U)&&(c.flags|=32),c.memoizedState!==null&&(C=q0(i,c,Yp,null,null,f),Vt._currentValue=C),ai(i,c),ya(i,c,p,f),c.child;case 6:return i===null&&Hs&&((i=f=Cr)&&(f=If(f,c.pendingProps,Js),f!==null?(c.stateNode=f,ba=c,Cr=null,i=!0):i=!1),i||br(c)),null;case 13:return hc(i,c,f);case 4:return je(c,c.stateNode.containerInfo),p=c.pendingProps,i===null?c.child=jl(c,null,p,f):ya(i,c,p,f),c.child;case 11:return au(i,c,c.type,c.pendingProps,f);case 7:return ya(i,c,c.pendingProps,f),c.child;case 8:return ya(i,c,c.pendingProps.children,f),c.child;case 12:return ya(i,c,c.pendingProps.children,f),c.child;case 10:return p=c.pendingProps,ei(c,c.type,p.value),ya(i,c,p.children,f),c.child;case 9:return C=c.type._context,p=c.pendingProps.children,vl(c),C=aa(C),p=p(C),c.flags|=1,ya(i,c,p,f),c.child;case 14:return af(i,c,c.type,c.pendingProps,f);case 15:return xo(i,c,c.type,c.pendingProps,f);case 19:return og(i,c,f);case 31:return la(i,c,f);case 22:return ig(i,c,f,c.pendingProps);case 24:return vl(c),p=aa(na),i===null?(C=R0(),C===null&&(C=yr,A=Zo(),C.pooledCache=A,A.refCount++,A!==null&&(C.pooledCacheLanes|=f),C=A),c.memoizedState={parent:p,cache:C},z0(c),ei(c,na,C)):((i.lanes&f)!==0&&(rc(i,c),uo(c,null,null,f),ac()),C=i.memoizedState,A=c.memoizedState,C.parent!==p?(C={parent:p,cache:p},c.memoizedState=C,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=C),ei(c,na,p)):(p=A.cache,ei(c,na,p),p!==C.cache&&M0(c,[na],f,!0))),ya(i,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(o(156,c.tag))}function ki(i){i.flags|=4}function cu(i,c,f,p,C){if((c=(i.mode&32)!==0)&&(c=!1),c){if(i.flags|=16777216,(C&335544128)===C)if(i.stateNode.complete)i.flags|=8192;else if(kg())i.flags|=8192;else throw oo=I0,O0}else i.flags&=-16777217}function za(i,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Lt(c))if(kg())i.flags|=8192;else throw oo=I0,O0}function fc(i,c){c!==null&&(i.flags|=4),i.flags&16384&&(c=i.tag!==22?is():536870912,i.lanes|=c,wc|=c)}function Td(i,c){if(!Hs)switch(i.tailMode){case"hidden":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function fr(i){var c=i.alternate!==null&&i.alternate.child===i.child,f=0,p=0;if(c)for(var C=i.child;C!==null;)f|=C.lanes|C.childLanes,p|=C.subtreeFlags&65011712,p|=C.flags&65011712,C.return=i,C=C.sibling;else for(C=i.child;C!==null;)f|=C.lanes|C.childLanes,p|=C.subtreeFlags,p|=C.flags,C.return=i,C=C.sibling;return i.subtreeFlags|=p,i.childLanes=f,c}function Kp(i,c,f){var p=c.pendingProps;switch(_0(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fr(c),null;case 1:return fr(c),null;case 3:return f=c.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),wi(na),Q(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(ao(c)?ki(c):i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ui())),fr(c),null;case 26:var C=c.type,A=c.memoizedState;return i===null?(ki(c),A!==null?(fr(c),za(c,A)):(fr(c),cu(c,C,null,p,f))):A?A!==i.memoizedState?(ki(c),fr(c),za(c,A)):(fr(c),c.flags&=-16777217):(i=i.memoizedProps,i!==p&&ki(c),fr(c),cu(c,C,i,p,f)),null;case 27:if(Fe(c),f=H.current,C=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&ki(c);else{if(!p){if(c.stateNode===null)throw Error(o(166));return fr(c),null}i=De.current,ao(c)?jn(c):(i=r(C,p,f),c.stateNode=i,ki(c))}return fr(c),null;case 5:if(Fe(c),C=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&ki(c);else{if(!p){if(c.stateNode===null)throw Error(o(166));return fr(c),null}if(A=De.current,ao(c))jn(c);else{var U=$d(H.current);switch(A){case 1:A=U.createElementNS("http://www.w3.org/2000/svg",C);break;case 2:A=U.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;default:switch(C){case"svg":A=U.createElementNS("http://www.w3.org/2000/svg",C);break;case"math":A=U.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;case"script":A=U.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof p.is=="string"?U.createElement("select",{is:p.is}):U.createElement("select"),p.multiple?A.multiple=!0:p.size&&(A.size=p.size);break;default:A=typeof p.is=="string"?U.createElement(C,{is:p.is}):U.createElement(C)}}A[Tr]=c,A[_s]=p;e:for(U=c.child;U!==null;){if(U.tag===5||U.tag===6)A.appendChild(U.stateNode);else if(U.tag!==4&&U.tag!==27&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===c)break e;for(;U.sibling===null;){if(U.return===null||U.return===c)break e;U=U.return}U.sibling.return=U.return,U=U.sibling}c.stateNode=A;e:switch(ja(A,C,p),C){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&ki(c)}}return fr(c),cu(c,c.type,i===null?null:i.memoizedProps,c.pendingProps,f),null;case 6:if(i&&c.stateNode!=null)i.memoizedProps!==p&&ki(c);else{if(typeof p!="string"&&c.stateNode===null)throw Error(o(166));if(i=H.current,ao(c)){if(i=c.stateNode,f=c.memoizedProps,p=null,C=ba,C!==null)switch(C.tag){case 27:case 5:p=C.memoizedProps}i[Tr]=c,i=!!(i.nodeValue===f||p!==null&&p.suppressHydrationWarning===!0||Tf(i.nodeValue,f)),i||br(c,!0)}else i=$d(i).createTextNode(p),i[Tr]=c,c.stateNode=i}return fr(c),null;case 31:if(f=c.memoizedState,i===null||i.memoizedState!==null){if(p=ao(c),f!==null){if(i===null){if(!p)throw Error(o(318));if(i=c.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(o(557));i[Tr]=c}else Zn(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;fr(c),i=!1}else f=Ui(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=f),i=!0;if(!i)return c.flags&256?(da(c),c):(da(c),null);if((c.flags&128)!==0)throw Error(o(558))}return fr(c),null;case 13:if(p=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(C=ao(c),p!==null&&p.dehydrated!==null){if(i===null){if(!C)throw Error(o(318));if(C=c.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(o(317));C[Tr]=c}else Zn(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;fr(c),C=!1}else C=Ui(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=C),C=!0;if(!C)return c.flags&256?(da(c),c):(da(c),null)}return da(c),(c.flags&128)!==0?(c.lanes=f,c):(f=p!==null,i=i!==null&&i.memoizedState!==null,f&&(p=c.child,C=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(C=p.alternate.memoizedState.cachePool.pool),A=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(A=p.memoizedState.cachePool.pool),A!==C&&(p.flags|=2048)),f!==i&&f&&(c.child.flags|=8192),fc(c,c.updateQueue),fr(c),null);case 4:return Q(),i===null&&Ef(c.stateNode.containerInfo),fr(c),null;case 10:return wi(c.type),fr(c),null;case 19:if(be(Yr),p=c.memoizedState,p===null)return fr(c),null;if(C=(c.flags&128)!==0,A=p.rendering,A===null)if(C)Td(p,!1);else{if(Vr!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(A=nc(i),A!==null){for(c.flags|=128,Td(p,!1),i=A.updateQueue,c.updateQueue=i,fc(c,i),c.subtreeFlags=0,i=f,f=c.child;f!==null;)A0(f,i),f=f.sibling;return _e(Yr,Yr.current&1|2),Hs&&vi(c,p.treeForkCount),c.child}i=i.sibling}p.tail!==null&&ys()>bu&&(c.flags|=128,C=!0,Td(p,!1),c.lanes=4194304)}else{if(!C)if(i=nc(A),i!==null){if(c.flags|=128,C=!0,i=i.updateQueue,c.updateQueue=i,fc(c,i),Td(p,!0),p.tail===null&&p.tailMode==="hidden"&&!A.alternate&&!Hs)return fr(c),null}else 2*ys()-p.renderingStartTime>bu&&f!==536870912&&(c.flags|=128,C=!0,Td(p,!1),c.lanes=4194304);p.isBackwards?(A.sibling=c.child,c.child=A):(i=p.last,i!==null?i.sibling=A:c.child=A,p.last=A)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=ys(),i.sibling=null,f=Yr.current,_e(Yr,C?f&1|2:f&1),Hs&&vi(c,p.treeForkCount),i):(fr(c),null);case 22:case 23:return da(c),Fh(),p=c.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(c.flags|=8192):p&&(c.flags|=8192),p?(f&536870912)!==0&&(c.flags&128)===0&&(fr(c),c.subtreeFlags&6&&(c.flags|=8192)):fr(c),f=c.updateQueue,f!==null&&fc(c,f.retryQueue),f=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048),i!==null&&be(wl),null;case 24:return f=null,i!==null&&(f=i.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),wi(na),fr(c),null;case 25:return null;case 30:return null}throw Error(o(156,c.tag))}function du(i,c){switch(_0(c),c.tag){case 1:return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return wi(na),Q(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 26:case 27:case 5:return Fe(c),null;case 31:if(c.memoizedState!==null){if(da(c),c.alternate===null)throw Error(o(340));Zn()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 13:if(da(c),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(o(340));Zn()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return be(Yr),null;case 4:return Q(),null;case 10:return wi(c.type),null;case 22:case 23:return da(c),Fh(),i!==null&&be(wl),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 24:return wi(na),null;case 25:return null;default:return null}}function dg(i,c){switch(_0(c),c.tag){case 3:wi(na),Q();break;case 26:case 27:case 5:Fe(c);break;case 4:Q();break;case 31:c.memoizedState!==null&&da(c);break;case 13:da(c);break;case 19:be(Yr);break;case 10:wi(c.type);break;case 22:case 23:da(c),Fh(),i!==null&&be(wl);break;case 24:wi(na)}}function _d(i,c){try{var f=c.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var C=p.next;f=C;do{if((f.tag&i)===i){p=void 0;var A=f.create,U=f.inst;p=A(),U.destroy=p}f=f.next}while(f!==C)}}catch(re){ar(c,c.return,re)}}function El(i,c,f){try{var p=c.updateQueue,C=p!==null?p.lastEffect:null;if(C!==null){var A=C.next;p=A;do{if((p.tag&i)===i){var U=p.inst,re=U.destroy;if(re!==void 0){U.destroy=void 0,C=c;var ve=f,qe=re;try{qe()}catch(ft){ar(C,ve,ft)}}}p=p.next}while(p!==A)}}catch(ft){ar(c,c.return,ft)}}function ff(i){var c=i.updateQueue;if(c!==null){var f=i.stateNode;try{V0(c,f)}catch(p){ar(i,i.return,p)}}}function ug(i,c,f){f.props=Sl(i.type,i.memoizedProps),f.state=i.memoizedState;try{f.componentWillUnmount()}catch(p){ar(i,c,p)}}function mc(i,c){try{var f=i.ref;if(f!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof f=="function"?i.refCleanup=f(p):f.current=p}}catch(C){ar(i,c,C)}}function Pn(i,c){var f=i.ref,p=i.refCleanup;if(f!==null)if(typeof p=="function")try{p()}catch(C){ar(i,c,C)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(C){ar(i,c,C)}else f.current=null}function gc(i){var c=i.type,f=i.memoizedProps,p=i.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&p.focus();break e;case"img":f.src?p.src=f.src:f.srcSet&&(p.srcset=f.srcSet)}}catch(C){ar(i,i.return,C)}}function Dl(i,c,f){try{var p=i.stateNode;Ff(p,i.type,f,c),p[_s]=c}catch(C){ar(i,i.return,C)}}function pc(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&ll(i.type)||i.tag===4}function Fd(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||pc(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&ll(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function xc(i,c,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(i,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(i),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=rn));else if(p!==4&&(p===27&&ll(i.type)&&(f=i.stateNode,c=null),i=i.child,i!==null))for(xc(i,c,f),i=i.sibling;i!==null;)xc(i,c,f),i=i.sibling}function Ci(i,c,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?f.insertBefore(i,c):f.appendChild(i);else if(p!==4&&(p===27&&ll(i.type)&&(f=i.stateNode),i=i.child,i!==null))for(Ci(i,c,f),i=i.sibling;i!==null;)Ci(i,c,f),i=i.sibling}function Ji(i){var c=i.stateNode,f=i.memoizedProps;try{for(var p=i.type,C=c.attributes;C.length;)c.removeAttributeNode(C[0]);ja(c,p,f),c[Tr]=i,c[_s]=f}catch(A){ar(i,i.return,A)}}var Si=!1,oa=!1,mf=!1,hg=typeof WeakSet=="function"?WeakSet:Set,va=null;function Qp(i,c){if(i=i.containerInfo,Sc=$s,i=w0(i),rd(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var C=p.anchorOffset,A=p.focusNode;p=p.focusOffset;try{f.nodeType,A.nodeType}catch{f=null;break e}var U=0,re=-1,ve=-1,qe=0,ft=0,gt=i,et=null;t:for(;;){for(var ct;gt!==f||C!==0&&gt.nodeType!==3||(re=U+C),gt!==A||p!==0&&gt.nodeType!==3||(ve=U+p),gt.nodeType===3&&(U+=gt.nodeValue.length),(ct=gt.firstChild)!==null;)et=gt,gt=ct;for(;;){if(gt===i)break t;if(et===f&&++qe===C&&(re=U),et===A&&++ft===p&&(ve=U),(ct=gt.nextSibling)!==null)break;gt=et,et=gt.parentNode}gt=ct}f=re===-1||ve===-1?null:{start:re,end:ve}}else f=null}f=f||{start:0,end:0}}else f=null;for(Lu={focusedElem:i,selectionRange:f},$s=!1,va=c;va!==null;)if(c=va,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,va=i;else for(;va!==null;){switch(c=va,A=c.alternate,i=c.flags,c.tag){case 0:if((i&4)!==0&&(i=c.updateQueue,i=i!==null?i.events:null,i!==null))for(f=0;f<i.length;f++)C=i[f],C.ref.impl=C.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&A!==null){i=void 0,f=c,C=A.memoizedProps,A=A.memoizedState,p=f.stateNode;try{var Zt=Sl(f.type,C);i=p.getSnapshotBeforeUpdate(Zt,A),p.__reactInternalSnapshotBeforeUpdate=i}catch(ps){ar(f,f.return,ps)}}break;case 3:if((i&1024)!==0){if(i=c.stateNode.containerInfo,f=i.nodeType,f===9)Bu(i);else if(f===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Bu(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(o(163))}if(i=c.sibling,i!==null){i.return=c.return,va=i;break}va=c.return}}function fg(i,c,f){var p=f.flags;switch(f.tag){case 0:case 11:case 15:Ai(i,f),p&4&&_d(5,f);break;case 1:if(Ai(i,f),p&4)if(i=f.stateNode,c===null)try{i.componentDidMount()}catch(U){ar(f,f.return,U)}else{var C=Sl(f.type,c.memoizedProps);c=c.memoizedState;try{i.componentDidUpdate(C,c,i.__reactInternalSnapshotBeforeUpdate)}catch(U){ar(f,f.return,U)}}p&64&&ff(f),p&512&&mc(f,f.return);break;case 3:if(Ai(i,f),p&64&&(i=f.updateQueue,i!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{V0(i,c)}catch(U){ar(f,f.return,U)}}break;case 27:c===null&&p&4&&Ji(f);case 26:case 5:Ai(i,f),c===null&&p&4&&gc(f),p&512&&mc(f,f.return);break;case 12:Ai(i,f);break;case 31:Ai(i,f),p&4&&uu(i,f);break;case 13:Ai(i,f),p&4&&pg(i,f),p&64&&(i=f.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(f=Mg.bind(null,f),Bf(i,f))));break;case 22:if(p=f.memoizedState!==null||Si,!p){c=c!==null&&c.memoizedState!==null||oa,C=Si;var A=oa;Si=p,(oa=c)&&!A?el(i,f,(f.subtreeFlags&8772)!==0):Ai(i,f),Si=C,oa=A}break;case 30:break;default:Ai(i,f)}}function mg(i){var c=i.alternate;c!==null&&(i.alternate=null,mg(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&zo(c)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Er=null,an=!1;function Zi(i,c,f){for(f=f.child;f!==null;)gg(i,c,f),f=f.sibling}function gg(i,c,f){if(ma&&typeof ma.onCommitFiberUnmount=="function")try{ma.onCommitFiberUnmount(ka,f)}catch{}switch(f.tag){case 26:oa||Pn(f,c),Zi(i,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:oa||Pn(f,c);var p=Er,C=an;ll(f.type)&&(Er=f.stateNode,an=!1),Zi(i,c,f),d(f.stateNode),Er=p,an=C;break;case 5:oa||Pn(f,c);case 6:if(p=Er,C=an,Er=null,Zi(i,c,f),Er=p,an=C,Er!==null)if(an)try{(Er.nodeType===9?Er.body:Er.nodeName==="HTML"?Er.ownerDocument.body:Er).removeChild(f.stateNode)}catch(A){ar(f,c,A)}else try{Er.removeChild(f.stateNode)}catch(A){ar(f,c,A)}break;case 18:Er!==null&&(an?(i=Er,Iu(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,f.stateNode),as(i)):Iu(Er,f.stateNode));break;case 4:p=Er,C=an,Er=f.stateNode.containerInfo,an=!0,Zi(i,c,f),Er=p,an=C;break;case 0:case 11:case 14:case 15:El(2,f,c),oa||El(4,f,c),Zi(i,c,f);break;case 1:oa||(Pn(f,c),p=f.stateNode,typeof p.componentWillUnmount=="function"&&ug(f,c,p)),Zi(i,c,f);break;case 21:Zi(i,c,f);break;case 22:oa=(p=oa)||f.memoizedState!==null,Zi(i,c,f),oa=p;break;default:Zi(i,c,f)}}function uu(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{as(i)}catch(f){ar(c,c.return,f)}}}function pg(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{as(i)}catch(f){ar(c,c.return,f)}}function Xp(i){switch(i.tag){case 31:case 13:case 19:var c=i.stateNode;return c===null&&(c=i.stateNode=new hg),c;case 22:return i=i.stateNode,c=i._retryCache,c===null&&(c=i._retryCache=new hg),c;default:throw Error(o(435,i.tag))}}function hu(i,c){var f=Xp(i);c.forEach(function(p){if(!f.has(p)){f.add(p);var C=Lg.bind(null,i,p);p.then(C,C)}})}function Ga(i,c){var f=c.deletions;if(f!==null)for(var p=0;p<f.length;p++){var C=f[p],A=i,U=c,re=U;e:for(;re!==null;){switch(re.tag){case 27:if(ll(re.type)){Er=re.stateNode,an=!1;break e}break;case 5:Er=re.stateNode,an=!1;break e;case 3:case 4:Er=re.stateNode.containerInfo,an=!0;break e}re=re.return}if(Er===null)throw Error(o(160));gg(A,U,C),Er=null,an=!1,A=C.alternate,A!==null&&(A.return=null),C.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)gf(c,i),c=c.sibling}var In=null;function gf(i,c){var f=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Ga(c,i),Ka(i),p&4&&(El(3,i,i.return),_d(3,i),El(5,i,i.return));break;case 1:Ga(c,i),Ka(i),p&512&&(oa||f===null||Pn(f,f.return)),p&64&&Si&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(f=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=f===null?p:f.concat(p))));break;case 26:var C=In;if(Ga(c,i),Ka(i),p&512&&(oa||f===null||Pn(f,f.return)),p&4){var A=f!==null?f.memoizedState:null;if(p=i.memoizedState,f===null)if(p===null)if(i.stateNode===null){e:{p=i.type,f=i.memoizedProps,C=C.ownerDocument||C;t:switch(p){case"title":A=C.getElementsByTagName("title")[0],(!A||A[mn]||A[Tr]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=C.createElement(p),C.head.insertBefore(A,C.querySelector("head > title"))),ja(A,p,f),A[Tr]=i,kr(A),p=A;break e;case"link":var U=St("link","href",C).get(p+(f.href||""));if(U){for(var re=0;re<U.length;re++)if(A=U[re],A.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&A.getAttribute("rel")===(f.rel==null?null:f.rel)&&A.getAttribute("title")===(f.title==null?null:f.title)&&A.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){U.splice(re,1);break t}}A=C.createElement(p),ja(A,p,f),C.head.appendChild(A);break;case"meta":if(U=St("meta","content",C).get(p+(f.content||""))){for(re=0;re<U.length;re++)if(A=U[re],A.getAttribute("content")===(f.content==null?null:""+f.content)&&A.getAttribute("name")===(f.name==null?null:f.name)&&A.getAttribute("property")===(f.property==null?null:f.property)&&A.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&A.getAttribute("charset")===(f.charSet==null?null:f.charSet)){U.splice(re,1);break t}}A=C.createElement(p),ja(A,p,f),C.head.appendChild(A);break;default:throw Error(o(468,p))}A[Tr]=i,kr(A),p=A}i.stateNode=p}else Ht(C,i.type,i.stateNode);else i.stateNode=Ie(C,p,i.memoizedProps);else A!==p?(A===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):A.count--,p===null?Ht(C,i.type,i.stateNode):Ie(C,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Dl(i,i.memoizedProps,f.memoizedProps)}break;case 27:Ga(c,i),Ka(i),p&512&&(oa||f===null||Pn(f,f.return)),f!==null&&p&4&&Dl(i,i.memoizedProps,f.memoizedProps);break;case 5:if(Ga(c,i),Ka(i),p&512&&(oa||f===null||Pn(f,f.return)),i.flags&32){C=i.stateNode;try{pi(C,"")}catch(Zt){ar(i,i.return,Zt)}}p&4&&i.stateNode!=null&&(C=i.memoizedProps,Dl(i,C,f!==null?f.memoizedProps:C)),p&1024&&(mf=!0);break;case 6:if(Ga(c,i),Ka(i),p&4){if(i.stateNode===null)throw Error(o(162));p=i.memoizedProps,f=i.stateNode;try{f.nodeValue=p}catch(Zt){ar(i,i.return,Zt)}}break;case 3:if(it=null,C=In,In=g(c.containerInfo),Ga(c,i),In=C,Ka(i),p&4&&f!==null&&f.memoizedState.isDehydrated)try{as(c.containerInfo)}catch(Zt){ar(i,i.return,Zt)}mf&&(mf=!1,pf(i));break;case 4:p=In,In=g(i.stateNode.containerInfo),Ga(c,i),Ka(i),In=p;break;case 12:Ga(c,i),Ka(i);break;case 31:Ga(c,i),Ka(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,hu(i,p)));break;case 13:Ga(c,i),Ka(i),i.child.flags&8192&&i.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(xu=ys()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,hu(i,p)));break;case 22:C=i.memoizedState!==null;var ve=f!==null&&f.memoizedState!==null,qe=Si,ft=oa;if(Si=qe||C,oa=ft||ve,Ga(c,i),oa=ft,Si=qe,Ka(i),p&8192)e:for(c=i.stateNode,c._visibility=C?c._visibility&-2:c._visibility|1,C&&(f===null||ve||Si||oa||Tl(i)),f=null,c=i;;){if(c.tag===5||c.tag===26){if(f===null){ve=f=c;try{if(A=ve.stateNode,C)U=A.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{re=ve.stateNode;var gt=ve.memoizedProps.style,et=gt!=null&&gt.hasOwnProperty("display")?gt.display:null;re.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(Zt){ar(ve,ve.return,Zt)}}}else if(c.tag===6){if(f===null){ve=c;try{ve.stateNode.nodeValue=C?"":ve.memoizedProps}catch(Zt){ar(ve,ve.return,Zt)}}}else if(c.tag===18){if(f===null){ve=c;try{var ct=ve.stateNode;C?Pf(ct,!0):Pf(ve.stateNode,!1)}catch(Zt){ar(ve,ve.return,Zt)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===i)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break e;for(;c.sibling===null;){if(c.return===null||c.return===i)break e;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}p&4&&(p=i.updateQueue,p!==null&&(f=p.retryQueue,f!==null&&(p.retryQueue=null,hu(i,f))));break;case 19:Ga(c,i),Ka(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,hu(i,p)));break;case 30:break;case 21:break;default:Ga(c,i),Ka(i)}}function Ka(i){var c=i.flags;if(c&2){try{for(var f,p=i.return;p!==null;){if(pc(p)){f=p;break}p=p.return}if(f==null)throw Error(o(160));switch(f.tag){case 27:var C=f.stateNode,A=Fd(i);Ci(i,A,C);break;case 5:var U=f.stateNode;f.flags&32&&(pi(U,""),f.flags&=-33);var re=Fd(i);Ci(i,re,U);break;case 3:case 4:var ve=f.stateNode.containerInfo,qe=Fd(i);xc(i,qe,ve);break;default:throw Error(o(161))}}catch(ft){ar(i,i.return,ft)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function pf(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var c=i;pf(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),i=i.sibling}}function Ai(i,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)fg(i,c.alternate,c),c=c.sibling}function Tl(i){for(i=i.child;i!==null;){var c=i;switch(c.tag){case 0:case 11:case 14:case 15:El(4,c,c.return),Tl(c);break;case 1:Pn(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&ug(c,c.return,f),Tl(c);break;case 27:d(c.stateNode);case 26:case 5:Pn(c,c.return),Tl(c);break;case 22:c.memoizedState===null&&Tl(c);break;case 30:Tl(c);break;default:Tl(c)}i=i.sibling}}function el(i,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var p=c.alternate,C=i,A=c,U=A.flags;switch(A.tag){case 0:case 11:case 15:el(C,A,f),_d(4,A);break;case 1:if(el(C,A,f),p=A,C=p.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(qe){ar(p,p.return,qe)}if(p=A,C=p.updateQueue,C!==null){var re=p.stateNode;try{var ve=C.shared.hiddenCallbacks;if(ve!==null)for(C.shared.hiddenCallbacks=null,C=0;C<ve.length;C++)Th(ve[C],re)}catch(qe){ar(p,p.return,qe)}}f&&U&64&&ff(A),mc(A,A.return);break;case 27:Ji(A);case 26:case 5:el(C,A,f),f&&p===null&&U&4&&gc(A),mc(A,A.return);break;case 12:el(C,A,f);break;case 31:el(C,A,f),f&&U&4&&uu(C,A);break;case 13:el(C,A,f),f&&U&4&&pg(C,A);break;case 22:A.memoizedState===null&&el(C,A,f),mc(A,A.return);break;case 30:break;default:el(C,A,f)}c=c.sibling}}function xf(i,c){var f=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),i=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(i=c.memoizedState.cachePool.pool),i!==f&&(i!=null&&i.refCount++,f!=null&&no(f))}function fu(i,c){i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&no(i))}function ni(i,c,f,p){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Md(i,c,f,p),c=c.sibling}function Md(i,c,f,p){var C=c.flags;switch(c.tag){case 0:case 11:case 15:ni(i,c,f,p),C&2048&&_d(9,c);break;case 1:ni(i,c,f,p);break;case 3:ni(i,c,f,p),C&2048&&(i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&no(i)));break;case 12:if(C&2048){ni(i,c,f,p),i=c.stateNode;try{var A=c.memoizedProps,U=A.id,re=A.onPostCommit;typeof re=="function"&&re(U,c.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(ve){ar(c,c.return,ve)}}else ni(i,c,f,p);break;case 31:ni(i,c,f,p);break;case 13:ni(i,c,f,p);break;case 23:break;case 22:A=c.stateNode,U=c.alternate,c.memoizedState!==null?A._visibility&2?ni(i,c,f,p):yc(i,c):A._visibility&2?ni(i,c,f,p):(A._visibility|=2,bc(i,c,f,p,(c.subtreeFlags&10256)!==0||!1)),C&2048&&xf(U,c);break;case 24:ni(i,c,f,p),C&2048&&fu(c.alternate,c);break;default:ni(i,c,f,p)}}function bc(i,c,f,p,C){for(C=C&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var A=i,U=c,re=f,ve=p,qe=U.flags;switch(U.tag){case 0:case 11:case 15:bc(A,U,re,ve,C),_d(8,U);break;case 23:break;case 22:var ft=U.stateNode;U.memoizedState!==null?ft._visibility&2?bc(A,U,re,ve,C):yc(A,U):(ft._visibility|=2,bc(A,U,re,ve,C)),C&&qe&2048&&xf(U.alternate,U);break;case 24:bc(A,U,re,ve,C),C&&qe&2048&&fu(U.alternate,U);break;default:bc(A,U,re,ve,C)}c=c.sibling}}function yc(i,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=i,p=c,C=p.flags;switch(p.tag){case 22:yc(f,p),C&2048&&xf(p.alternate,p);break;case 24:yc(f,p),C&2048&&fu(p.alternate,p);break;default:yc(f,p)}c=c.sibling}}var Ei=8192;function vc(i,c,f){if(i.subtreeFlags&Ei)for(i=i.child;i!==null;)bf(i,c,f),i=i.sibling}function bf(i,c,f){switch(i.tag){case 26:vc(i,c,f),i.flags&Ei&&i.memoizedState!==null&&Ot(f,In,i.memoizedState,i.memoizedProps);break;case 5:vc(i,c,f);break;case 3:case 4:var p=In;In=g(i.stateNode.containerInfo),vc(i,c,f),In=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=Ei,Ei=16777216,vc(i,c,f),Ei=p):vc(i,c,f));break;default:vc(i,c,f)}}function xg(i){var c=i.alternate;if(c!==null&&(i=c.child,i!==null)){c.child=null;do c=i.sibling,i.sibling=null,i=c;while(i!==null)}}function Ld(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];va=p,yg(p,i)}xg(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)bg(i),i=i.sibling}function bg(i){switch(i.tag){case 0:case 11:case 15:Ld(i),i.flags&2048&&El(9,i,i.return);break;case 3:Ld(i);break;case 12:Ld(i);break;case 22:var c=i.stateNode;i.memoizedState!==null&&c._visibility&2&&(i.return===null||i.return.tag!==13)?(c._visibility&=-3,mu(i)):Ld(i);break;default:Ld(i)}}function mu(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];va=p,yg(p,i)}xg(i)}for(i=i.child;i!==null;){switch(c=i,c.tag){case 0:case 11:case 15:El(8,c,c.return),mu(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,mu(c));break;default:mu(c)}i=i.sibling}}function yg(i,c){for(;va!==null;){var f=va;switch(f.tag){case 0:case 11:case 15:El(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var p=f.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:no(f.memoizedState.cache)}if(p=f.child,p!==null)p.return=f,va=p;else e:for(f=i;va!==null;){p=va;var C=p.sibling,A=p.return;if(mg(p),p===f){va=null;break e}if(C!==null){C.return=A,va=C;break e}va=A}}}var Jp={getCacheForType:function(i){var c=aa(na),f=c.data.get(i);return f===void 0&&(f=i(),c.data.set(i,f)),f},cacheSignal:function(){return aa(na).controller.signal}},Zp=typeof WeakMap=="function"?WeakMap:Map,sr=0,yr=null,Rs=null,Vs=0,dr=0,Cn=null,tl=!1,vo=!1,gu=!1,sl=0,Vr=0,rl=0,wo=0,pu=0,Sn=0,wc=0,Rd=null,nn=null,yf=!1,xu=0,vg=0,bu=1/0,yu=null,_l=null,ua=0,Fl=null,jc=null,An=0,vu=0,wu=null,Bn=null,Od=0,Pd=null;function Qa(){return(sr&2)!==0&&Vs!==0?Vs&-Vs:fe.T!==null?Bs():mi()}function wg(){if(Sn===0)if((Vs&536870912)===0||Hs){var i=Vl;Vl<<=1,(Vl&3932160)===0&&(Vl=262144),Sn=i}else Sn=536870912;return i=Nn.current,i!==null&&(i.flags|=32),Sn}function Xa(i,c,f){(i===yr&&(dr===2||dr===9)||i.cancelPendingCommit!==null)&&(Ja(i,0),Ml(i,Vs,Sn,!1)),Mi(i,f),((sr&2)===0||i!==yr)&&(i===yr&&((sr&2)===0&&(wo|=f),Vr===4&&Ml(i,Vs,Sn,!1)),wa(i))}function jg(i,c,f){if((sr&6)!==0)throw Error(o(327));var p=!f&&(c&127)===0&&(c&i.expiredLanes)===0||ui(i,c),C=p?It(i,c):jo(i,c,!0),A=p;do{if(C===0){vo&&!p&&Ml(i,c,0,!1);break}else{if(f=i.current.alternate,A&&!e1(f)){C=jo(i,c,!1),A=!1;continue}if(C===2){if(A=c,i.errorRecoveryDisabledLanes&A)var U=0;else U=i.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){c=U;e:{var re=i;C=Rd;var ve=re.current.memoizedState.isDehydrated;if(ve&&(Ja(re,U).flags|=256),U=jo(re,U,!1),U!==2){if(gu&&!ve){re.errorRecoveryDisabledLanes|=A,wo|=A,C=4;break e}A=nn,nn=C,A!==null&&(nn===null?nn=A:nn.push.apply(nn,A))}C=U}if(A=!1,C!==2)continue}}if(C===1){Ja(i,0),Ml(i,c,0,!0);break}e:{switch(p=i,A=C,A){case 0:case 1:throw Error(o(345));case 4:if((c&4194048)!==c)break;case 6:Ml(p,c,Sn,!tl);break e;case 2:nn=null;break;case 3:case 5:break;default:throw Error(o(329))}if((c&62914560)===c&&(C=xu+300-ys(),10<C)){if(Ml(p,c,Sn,!tl),es(p,0,!0)!==0)break e;An=c,p.timeoutHandle=Ou(Ng.bind(null,p,f,nn,yu,yf,c,Sn,wo,wc,tl,A,"Throttled",-0,0),C);break e}Ng(p,f,nn,yu,yf,c,Sn,wo,wc,tl,A,null,-0,0)}}break}while(!0);wa(i)}function Ng(i,c,f,p,C,A,U,re,ve,qe,ft,gt,et,ct){if(i.timeoutHandle=-1,gt=c.subtreeFlags,gt&8192||(gt&16785408)===16785408){gt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:rn},bf(c,A,gt);var Zt=(A&62914560)===A?xu-ys():(A&4194048)===A?vg-ys():0;if(Zt=jt(gt,Zt),Zt!==null){An=A,i.cancelPendingCommit=Zt(Eg.bind(null,i,c,A,f,p,C,U,re,ve,ft,gt,null,et,ct)),Ml(i,A,U,!qe);return}}Eg(i,c,A,f,p,C,U,re,ve)}function e1(i){for(var c=i;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var p=0;p<f.length;p++){var C=f[p],A=C.getSnapshot;C=C.value;try{if(!xn(A(),C))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ml(i,c,f,p){c&=~pu,c&=~wo,i.suspendedLanes|=c,i.pingedLanes&=~c,p&&(i.warmLanes|=c),p=i.expirationTimes;for(var C=c;0<C;){var A=31-xr(C),U=1<<A;p[A]=-1,C&=~U}f!==0&&hi(i,f,c)}function ju(){return(sr&6)===0?(ko(0),!1):!0}function vf(){if(Rs!==null){if(dr===0)var i=Rs.return;else i=Rs,Wi=yl=null,gd(i),$i=null,tc=0,i=Rs;for(;i!==null;)dg(i.alternate,i),i=i.return;Rs=null}}function Ja(i,c){var f=i.timeoutHandle;f!==-1&&(i.timeoutHandle=-1,Bg(f)),f=i.cancelPendingCommit,f!==null&&(i.cancelPendingCommit=null,f()),An=0,vf(),yr=i,Rs=f=bi(i.current,null),Vs=c,dr=0,Cn=null,tl=!1,vo=ui(i,c),gu=!1,wc=Sn=pu=wo=rl=Vr=0,nn=Rd=null,yf=!1,(c&8)!==0&&(c|=c&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=c;0<p;){var C=31-xr(p),A=1<<C;c|=i[C],p&=~A}return sl=c,ks(),f}function Id(i,c){Ss=null,fe.H=Cd,c===ec||c===P0?(c=B0(),dr=3):c===O0?(c=B0(),dr=4):dr=c===rf?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Cn=c,Rs===null&&(Vr=1,ru(i,yn(c,i.current)))}function kg(){var i=Nn.current;return i===null?!0:(Vs&4194048)===Vs?kn===null:(Vs&62914560)===Vs||(Vs&536870912)!==0?i===kn:!1}function Nc(){var i=fe.H;return fe.H=Cd,i===null?Cd:i}function Bd(){var i=fe.A;return fe.A=Jp,i}function Nu(){Vr=4,tl||(Vs&4194048)!==Vs&&Nn.current!==null||(vo=!0),(rl&134217727)===0&&(wo&134217727)===0||yr===null||Ml(yr,Vs,Sn,!1)}function jo(i,c,f){var p=sr;sr|=2;var C=Nc(),A=Bd();(yr!==i||Vs!==c)&&(yu=null,Ja(i,c)),c=!1;var U=Vr;e:do try{if(dr!==0&&Rs!==null){var re=Rs,ve=Cn;switch(dr){case 8:vf(),U=6;break e;case 3:case 2:case 9:case 6:Nn.current===null&&(c=!0);var qe=dr;if(dr=0,Cn=null,kc(i,re,ve,qe),f&&vo){U=0;break e}break;default:qe=dr,dr=0,Cn=null,kc(i,re,ve,qe)}}wf(),U=Vr;break}catch(ft){Id(i,ft)}while(!0);return c&&i.shellSuspendCounter++,Wi=yl=null,sr=p,fe.H=C,fe.A=A,Rs===null&&(yr=null,Vs=0,ks()),U}function wf(){for(;Rs!==null;)Cg(Rs)}function It(i,c){var f=sr;sr|=2;var p=Nc(),C=Bd();yr!==i||Vs!==c?(yu=null,bu=ys()+500,Ja(i,c)):vo=ui(i,c);e:do try{if(dr!==0&&Rs!==null){c=Rs;var A=Cn;t:switch(dr){case 1:dr=0,Cn=null,kc(i,c,A,1);break;case 2:case 9:if(Sh(A)){dr=0,Cn=null,Sg(c);break}c=function(){dr!==2&&dr!==9||yr!==i||(dr=7),wa(i)},A.then(c,c);break e;case 3:dr=7;break e;case 4:dr=5;break e;case 7:Sh(A)?(dr=0,Cn=null,Sg(c)):(dr=0,Cn=null,kc(i,c,A,7));break;case 5:var U=null;switch(Rs.tag){case 26:U=Rs.memoizedState;case 5:case 27:var re=Rs;if(U?Lt(U):re.stateNode.complete){dr=0,Cn=null;var ve=re.sibling;if(ve!==null)Rs=ve;else{var qe=re.return;qe!==null?(Rs=qe,ku(qe)):Rs=null}break t}}dr=0,Cn=null,kc(i,c,A,5);break;case 6:dr=0,Cn=null,kc(i,c,A,6);break;case 8:vf(),Vr=6;break e;default:throw Error(o(462))}}zd();break}catch(ft){Id(i,ft)}while(!0);return Wi=yl=null,fe.H=p,fe.A=C,sr=f,Rs!==null?0:(yr=null,Vs=0,ks(),Vr)}function zd(){for(;Rs!==null&&!qs();)Cg(Rs)}function Cg(i){var c=cg(i.alternate,i,sl);i.memoizedProps=i.pendingProps,c===null?ku(i):Rs=c}function Sg(i){var c=i,f=c.alternate;switch(c.tag){case 15:case 0:c=lf(f,c,c.pendingProps,c.type,void 0,Vs);break;case 11:c=lf(f,c,c.pendingProps,c.type.render,c.ref,Vs);break;case 5:gd(c);default:dg(f,c),c=Rs=A0(c,sl),c=cg(f,c,sl)}i.memoizedProps=i.pendingProps,c===null?ku(i):Rs=c}function kc(i,c,f,p){Wi=yl=null,gd(c),$i=null,tc=0;var C=c.return;try{if(ng(i,C,c,f,Vs)){Vr=1,ru(i,yn(f,i.current)),Rs=null;return}}catch(A){if(C!==null)throw Rs=C,A;Vr=1,ru(i,yn(f,i.current)),Rs=null;return}c.flags&32768?(Hs||p===1?i=!0:vo||(Vs&536870912)!==0?i=!1:(tl=i=!0,(p===2||p===9||p===3||p===6)&&(p=Nn.current,p!==null&&p.tag===13&&(p.flags|=16384))),Ag(c,i)):ku(c)}function ku(i){var c=i;do{if((c.flags&32768)!==0){Ag(c,tl);return}i=c.return;var f=Kp(c.alternate,c,sl);if(f!==null){Rs=f;return}if(c=c.sibling,c!==null){Rs=c;return}Rs=c=i}while(c!==null);Vr===0&&(Vr=5)}function Ag(i,c){do{var f=du(i.alternate,i);if(f!==null){f.flags&=32767,Rs=f;return}if(f=i.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(i=i.sibling,i!==null)){Rs=i;return}Rs=i=f}while(i!==null);Vr=6,Rs=null}function Eg(i,c,f,p,C,A,U,re,ve){i.cancelPendingCommit=null;do Ud();while(ua!==0);if((sr&6)!==0)throw Error(o(327));if(c!==null){if(c===i.current)throw Error(o(177));if(A=c.lanes|c.childLanes,A|=C0,ql(i,f,A,U,re,ve),i===yr&&(Rs=yr=null,Vs=0),jc=c,Fl=i,An=f,vu=A,wu=C,Bn=p,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Rg(Is,function(){return Nf(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||p){p=fe.T,fe.T=null,C=Se.p,Se.p=2,U=sr,sr|=4;try{Qp(i,c,f)}finally{sr=U,Se.p=C,fe.T=p}}ua=1,Dg(),Tg(),_g()}}function Dg(){if(ua===1){ua=0;var i=Fl,c=jc,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=fe.T,fe.T=null;var p=Se.p;Se.p=2;var C=sr;sr|=4;try{gf(c,i);var A=Lu,U=w0(i.containerInfo),re=A.focusedElem,ve=A.selectionRange;if(U!==re&&re&&re.ownerDocument&&Cm(re.ownerDocument.documentElement,re)){if(ve!==null&&rd(re)){var qe=ve.start,ft=ve.end;if(ft===void 0&&(ft=qe),"selectionStart"in re)re.selectionStart=qe,re.selectionEnd=Math.min(ft,re.value.length);else{var gt=re.ownerDocument||document,et=gt&&gt.defaultView||window;if(et.getSelection){var ct=et.getSelection(),Zt=re.textContent.length,ps=Math.min(ve.start,Zt),Sr=ve.end===void 0?ps:Math.min(ve.end,Zt);!ct.extend&&ps>Sr&&(U=Sr,Sr=ps,ps=U);var $e=sd(re,ps),Pe=sd(re,Sr);if($e&&Pe&&(ct.rangeCount!==1||ct.anchorNode!==$e.node||ct.anchorOffset!==$e.offset||ct.focusNode!==Pe.node||ct.focusOffset!==Pe.offset)){var rt=gt.createRange();rt.setStart($e.node,$e.offset),ct.removeAllRanges(),ps>Sr?(ct.addRange(rt),ct.extend(Pe.node,Pe.offset)):(rt.setEnd(Pe.node,Pe.offset),ct.addRange(rt))}}}}for(gt=[],ct=re;ct=ct.parentNode;)ct.nodeType===1&&gt.push({element:ct,left:ct.scrollLeft,top:ct.scrollTop});for(typeof re.focus=="function"&&re.focus(),re=0;re<gt.length;re++){var vt=gt[re];vt.element.scrollLeft=vt.left,vt.element.scrollTop=vt.top}}$s=!!Sc,Lu=Sc=null}finally{sr=C,Se.p=p,fe.T=f}}i.current=c,ua=2}}function Tg(){if(ua===2){ua=0;var i=Fl,c=jc,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=fe.T,fe.T=null;var p=Se.p;Se.p=2;var C=sr;sr|=4;try{fg(i,c.alternate,c)}finally{sr=C,Se.p=p,fe.T=f}}ua=3}}function _g(){if(ua===4||ua===3){ua=0,ms();var i=Fl,c=jc,f=An,p=Bn;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?ua=5:(ua=0,jc=Fl=null,jf(i,i.pendingLanes));var C=i.pendingLanes;if(C===0&&(_l=null),Li(f),c=c.stateNode,ma&&typeof ma.onCommitFiberRoot=="function")try{ma.onCommitFiberRoot(ka,c,void 0,(c.current.flags&128)===128)}catch{}if(p!==null){c=fe.T,C=Se.p,Se.p=2,fe.T=null;try{for(var A=i.onRecoverableError,U=0;U<p.length;U++){var re=p[U];A(re.value,{componentStack:re.stack})}}finally{fe.T=c,Se.p=C}}(An&3)!==0&&Ud(),wa(i),C=i.pendingLanes,(f&261930)!==0&&(C&42)!==0?i===Pd?Od++:(Od=0,Pd=i):Od=0,ko(0)}}function jf(i,c){(i.pooledCacheLanes&=c)===0&&(c=i.pooledCache,c!=null&&(i.pooledCache=null,no(c)))}function Ud(){return Dg(),Tg(),_g(),Nf()}function Nf(){if(ua!==5)return!1;var i=Fl,c=vu;vu=0;var f=Li(An),p=fe.T,C=Se.p;try{Se.p=32>f?32:f,fe.T=null,f=wu,wu=null;var A=Fl,U=An;if(ua=0,jc=Fl=null,An=0,(sr&6)!==0)throw Error(o(331));var re=sr;if(sr|=4,bg(A.current),Md(A,A.current,U,f),sr=re,ko(0,!1),ma&&typeof ma.onPostCommitFiberRoot=="function")try{ma.onPostCommitFiberRoot(ka,A)}catch{}return!0}finally{Se.p=C,fe.T=p,jf(i,c)}}function kf(i,c,f){c=yn(f,c),c=Al(i.stateNode,c,2),i=qi(i,c,2),i!==null&&(Mi(i,2),wa(i))}function ar(i,c,f){if(i.tag===3)kf(i,i,f);else for(;c!==null;){if(c.tag===3){kf(c,i,f);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(_l===null||!_l.has(p))){i=yn(f,i),f=tf(2),p=qi(c,f,2),p!==null&&(sf(f,p,c,i),Mi(p,2),wa(p));break}}c=c.return}}function Cu(i,c,f){var p=i.pingCache;if(p===null){p=i.pingCache=new Zp;var C=new Set;p.set(c,C)}else C=p.get(c),C===void 0&&(C=new Set,p.set(c,C));C.has(f)||(gu=!0,C.add(f),i=Fg.bind(null,i,c,f),c.then(i,i))}function Fg(i,c,f){var p=i.pingCache;p!==null&&p.delete(c),i.pingedLanes|=i.suspendedLanes&f,i.warmLanes&=~f,yr===i&&(Vs&f)===f&&(Vr===4||Vr===3&&(Vs&62914560)===Vs&&300>ys()-xu?(sr&2)===0&&Ja(i,0):pu|=f,wc===Vs&&(wc=0)),wa(i)}function Cf(i,c){c===0&&(c=is()),i=Rn(i,c),i!==null&&(Mi(i,c),wa(i))}function Mg(i){var c=i.memoizedState,f=0;c!==null&&(f=c.retryLane),Cf(i,f)}function Lg(i,c){var f=0;switch(i.tag){case 31:case 13:var p=i.stateNode,C=i.memoizedState;C!==null&&(f=C.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(o(314))}p!==null&&p.delete(c),Cf(i,f)}function Rg(i,c){return Mt(i,c)}var Hd=null,No=null,Su=!1,Au=!1,Eu=!1,al=0;function wa(i){i!==No&&i.next===null&&(No===null?Hd=No=i:No=No.next=i),Au=!0,Su||(Su=!0,Rr())}function ko(i,c){if(!Eu&&Au){Eu=!0;do for(var f=!1,p=Hd;p!==null;){if(i!==0){var C=p.pendingLanes;if(C===0)var A=0;else{var U=p.suspendedLanes,re=p.pingedLanes;A=(1<<31-xr(42|i)+1)-1,A&=C&~(U&~re),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(f=!0,Gs(p,A))}else A=Vs,A=es(p,p===yr?A:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(A&3)===0||ui(p,A)||(f=!0,Gs(p,A));p=p.next}while(f);Eu=!1}}function Og(){nl()}function nl(){Au=Su=!1;var i=0;al!==0&&Ru()&&(i=al);for(var c=ys(),f=null,p=Hd;p!==null;){var C=p.next,A=Sf(p,c);A===0?(p.next=null,f===null?Hd=C:f.next=C,C===null&&(No=f)):(f=p,(i!==0||(A&3)!==0)&&(Au=!0)),p=C}ua!==0&&ua!==5||ko(i),al!==0&&(al=0)}function Sf(i,c){for(var f=i.suspendedLanes,p=i.pingedLanes,C=i.expirationTimes,A=i.pendingLanes&-62914561;0<A;){var U=31-xr(A),re=1<<U,ve=C[U];ve===-1?((re&f)===0||(re&p)!==0)&&(C[U]=Wl(re,c)):ve<=c&&(i.expiredLanes|=re),A&=~re}if(c=yr,f=Vs,f=es(i,i===c?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,f===0||i===c&&(dr===2||dr===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&Es(p),i.callbackNode=null,i.callbackPriority=0;if((f&3)===0||ui(i,f)){if(c=f&-f,c===i.callbackPriority)return c;switch(p!==null&&Es(p),Li(f)){case 2:case 8:f=Ft;break;case 32:f=Is;break;case 268435456:f=$r;break;default:f=Is}return p=Cc.bind(null,i),f=Mt(f,p),i.callbackPriority=c,i.callbackNode=f,c}return p!==null&&p!==null&&Es(p),i.callbackPriority=2,i.callbackNode=null,2}function Cc(i,c){if(ua!==0&&ua!==5)return i.callbackNode=null,i.callbackPriority=0,null;var f=i.callbackNode;if(Ud()&&i.callbackNode!==f)return null;var p=Vs;return p=es(i,i===yr?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(jg(i,p,c),Sf(i,ys()),i.callbackNode!=null&&i.callbackNode===f?Cc.bind(null,i):null)}function Gs(i,c){if(Ud())return null;jg(i,c,!0)}function Rr(){Pu(function(){(sr&6)!==0?Mt(ht,Og):nl()})}function Bs(){if(al===0){var i=io;i===0&&(i=qc,qc<<=1,(qc&261888)===0&&(qc=256)),al=i}return al}function Or(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:fl(""+i)}function Du(i,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,i.id&&f.setAttribute("form",i.id),c.parentNode.insertBefore(f,c),i=new FormData(i),f.parentNode.removeChild(f),i}function zn(i,c,f,p,C){if(c==="submit"&&f&&f.stateNode===C){var A=Or((C[_s]||null).action),U=p.submitter;U&&(c=(c=U[_s]||null)?Or(c.formAction):U.getAttribute("formAction"),c!==null&&(A=c,U=null));var re=new _n("action","action",null,p,C);i.push({event:re,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(al!==0){var ve=U?Du(C,U):new FormData(C);Gh(f,{pending:!0,data:ve,method:C.method,action:A},null,ve)}}else typeof A=="function"&&(re.preventDefault(),ve=U?Du(C,U):new FormData(C),Gh(f,{pending:!0,data:ve,method:C.method,action:A},A,ve))},currentTarget:C}]})}}for(var il=0;il<Xn.length;il++){var ln=Xn[il],Co=ln.toLowerCase(),t1=ln[0].toUpperCase()+ln.slice(1);Ln(Co,"on"+t1)}Ln(ph,"onAnimationEnd"),Ln(xh,"onAnimationIteration"),Ln(Sm,"onAnimationStart"),Ln("dblclick","onDoubleClick"),Ln("focusin","onFocus"),Ln("focusout","onBlur"),Ln(bh,"onTransitionRun"),Ln(yh,"onTransitionStart"),Ln(Am,"onTransitionCancel"),Ln(Em,"onTransitionEnd"),xs("onMouseEnter",["mouseout","mouseover"]),xs("onMouseLeave",["mouseout","mouseover"]),xs("onPointerEnter",["pointerout","pointerover"]),xs("onPointerLeave",["pointerout","pointerover"]),gi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),gi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),gi("onBeforeInput",["compositionend","keypress","textInput","paste"]),gi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),gi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),gi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var So="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Af=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(So));function Pg(i,c){c=(c&4)!==0;for(var f=0;f<i.length;f++){var p=i[f],C=p.event;p=p.listeners;e:{var A=void 0;if(c)for(var U=p.length-1;0<=U;U--){var re=p[U],ve=re.instance,qe=re.currentTarget;if(re=re.listener,ve!==A&&C.isPropagationStopped())break e;A=re,C.currentTarget=qe;try{A(C)}catch(ft){Qo(ft)}C.currentTarget=null,A=ve}else for(U=0;U<p.length;U++){if(re=p[U],ve=re.instance,qe=re.currentTarget,re=re.listener,ve!==A&&C.isPropagationStopped())break e;A=re,C.currentTarget=qe;try{A(C)}catch(ft){Qo(ft)}C.currentTarget=null,A=ve}}}}function ds(i,c){var f=c[vs];f===void 0&&(f=c[vs]=new Set);var p=i+"__bubble";f.has(p)||(Ig(c,i,2,!1),f.add(p))}function Tu(i,c,f){var p=0;c&&(p|=4),Ig(f,i,p,c)}var _u="_reactListening"+Math.random().toString(36).slice(2);function Ef(i){if(!i[_u]){i[_u]=!0,zr.forEach(function(f){f!=="selectionchange"&&(Af.has(f)||Tu(f,!1,i),Tu(f,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[_u]||(c[_u]=!0,Tu("selectionchange",!1,c))}}function Ig(i,c,f,p){switch(Ae(c)){case 2:var C=ha;break;case 8:C=Un;break;default:C=he}f=C.bind(null,c,f,i),C=void 0,!Nt||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(C=!0),p?C!==void 0?i.addEventListener(c,f,{capture:!0,passive:C}):i.addEventListener(c,f,!0):C!==void 0?i.addEventListener(c,f,{passive:C}):i.addEventListener(c,f,!1)}function Fu(i,c,f,p,C){var A=p;if((c&1)===0&&(c&2)===0&&p!==null)e:for(;;){if(p===null)return;var U=p.tag;if(U===3||U===4){var re=p.stateNode.containerInfo;if(re===C)break;if(U===4)for(U=p.return;U!==null;){var ve=U.tag;if((ve===3||ve===4)&&U.stateNode.containerInfo===C)return;U=U.return}for(;re!==null;){if(U=gn(re),U===null)return;if(ve=U.tag,ve===5||ve===6||ve===26||ve===27){p=A=U;continue e}re=re.parentNode}}p=p.return}lt(function(){var qe=A,ft=Oe(f),gt=[];e:{var et=Ko.get(i);if(et!==void 0){var ct=_n,Zt=i;switch(i){case"keypress":if(cr(f)===0)break e;case"keydown":case"keyup":ct=Kl;break;case"focusin":Zt="focus",ct=m0;break;case"focusout":Zt="blur",ct=m0;break;case"beforeblur":case"afterblur":ct=m0;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ct=ih;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ct=jm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ct=Hp;break;case ph:case xh:case Sm:ct=lh;break;case Em:ct=Wp;break;case"scroll":case"scrollend":ct=vm;break;case"wheel":ct=Sa;break;case"copy":case"cut":case"paste":ct=ch;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ct=qo;break;case"toggle":case"beforetoggle":ct=pt}var ps=(c&4)!==0,Sr=!ps&&(i==="scroll"||i==="scrollend"),$e=ps?et!==null?et+"Capture":null:et;ps=[];for(var Pe=qe,rt;Pe!==null;){var vt=Pe;if(rt=vt.stateNode,vt=vt.tag,vt!==5&&vt!==26&&vt!==27||rt===null||$e===null||(vt=Ke(Pe,$e),vt!=null&&ps.push(Vd(Pe,vt,rt))),Sr)break;Pe=Pe.return}0<ps.length&&(et=new ct(et,Zt,null,f,ft),gt.push({event:et,listeners:ps}))}}if((c&7)===0){e:{if(et=i==="mouseover"||i==="pointerover",ct=i==="mouseout"||i==="pointerout",et&&f!==G&&(Zt=f.relatedTarget||f.fromElement)&&(gn(Zt)||Zt[Ha]))break e;if((ct||et)&&(et=ft.window===ft?ft:(et=ft.ownerDocument)?et.defaultView||et.parentWindow:window,ct?(Zt=f.relatedTarget||f.toElement,ct=qe,Zt=Zt?gn(Zt):null,Zt!==null&&(Sr=e(Zt),ps=Zt.tag,Zt!==Sr||ps!==5&&ps!==27&&ps!==6)&&(Zt=null)):(ct=null,Zt=qe),ct!==Zt)){if(ps=ih,vt="onMouseLeave",$e="onMouseEnter",Pe="mouse",(i==="pointerout"||i==="pointerover")&&(ps=qo,vt="onPointerLeave",$e="onPointerEnter",Pe="pointer"),Sr=ct==null?et:ga(ct),rt=Zt==null?et:ga(Zt),et=new ps(vt,Pe+"leave",ct,f,ft),et.target=Sr,et.relatedTarget=rt,vt=null,gn(ft)===qe&&(ps=new ps($e,Pe+"enter",Zt,f,ft),ps.target=rt,ps.relatedTarget=Sr,vt=ps),Sr=vt,ct&&Zt)t:{for(ps=Df,$e=ct,Pe=Zt,rt=0,vt=$e;vt;vt=ps(vt))rt++;vt=0;for(var us=Pe;us;us=ps(us))vt++;for(;0<rt-vt;)$e=ps($e),rt--;for(;0<vt-rt;)Pe=ps(Pe),vt--;for(;rt--;){if($e===Pe||Pe!==null&&$e===Pe.alternate){ps=$e;break t}$e=ps($e),Pe=ps(Pe)}ps=null}else ps=null;ct!==null&&Mu(gt,et,ct,ps,!1),Zt!==null&&Sr!==null&&Mu(gt,Sr,Zt,ps,!0)}}e:{if(et=qe?ga(qe):window,ct=et.nodeName&&et.nodeName.toLowerCase(),ct==="select"||ct==="input"&&et.type==="file")var nr=mh;else if(Ia(et))if(Ql)nr=Jl;else{nr=Fn;var ls=$p}else ct=et.nodeName,!ct||ct.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?qe&&Gl(qe.elementType)&&(nr=mh):nr=Xl;if(nr&&(nr=nr(i,qe))){Cs(gt,nr,f,ft);break e}ls&&ls(i,et,qe),i==="focusout"&&qe&&et.type==="number"&&qe.memoizedProps.value!=null&&Ys(et,"number",et.value)}switch(ls=qe?ga(qe):window,i){case"focusin":(Ia(ls)||ls.contentEditable==="true")&&(eo=ls,j0=qe,Qn=null);break;case"focusout":Qn=j0=eo=null;break;case"mousedown":gl=!0;break;case"contextmenu":case"mouseup":case"dragend":gl=!1,Aa(gt,f,ft);break;case"selectionchange":if(gh)break;case"keydown":case"keyup":Aa(gt,f,ft)}var Ps;if(Pa)e:{switch(i){case"compositionstart":var Ks="onCompositionStart";break e;case"compositionend":Ks="onCompositionEnd";break e;case"compositionupdate":Ks="onCompositionUpdate";break e}Ks=void 0}else ml?b0(i,f)&&(Ks="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(Ks="onCompositionStart");Ks&&(fh&&f.locale!=="ko"&&(ml||Ks!=="onCompositionStart"?Ks==="onCompositionEnd"&&ml&&(Ps=js()):(Rt=ft,Le="value"in Rt?Rt.value:Rt.textContent,ml=!0)),ls=Wd(qe,Ks),0<ls.length&&(Ks=new g0(Ks,i,null,f,ft),gt.push({event:Ks,listeners:ls}),Ps?Ks.data=Ps:(Ps=Ur(f),Ps!==null&&(Ks.data=Ps)))),(Ps=ed?Ar(i,f):Hr(i,f))&&(Ks=Wd(qe,"onBeforeInput"),0<Ks.length&&(ls=new g0("onBeforeInput","beforeinput",null,f,ft),gt.push({event:ls,listeners:Ks}),ls.data=Ps)),zn(gt,i,qe,f,ft)}Pg(gt,c)})}function Vd(i,c,f){return{instance:i,listener:c,currentTarget:f}}function Wd(i,c){for(var f=c+"Capture",p=[];i!==null;){var C=i,A=C.stateNode;if(C=C.tag,C!==5&&C!==26&&C!==27||A===null||(C=Ke(i,f),C!=null&&p.unshift(Vd(i,C,A)),C=Ke(i,c),C!=null&&p.push(Vd(i,C,A))),i.tag===3)return p;i=i.return}return[]}function Df(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Mu(i,c,f,p,C){for(var A=c._reactName,U=[];f!==null&&f!==p;){var re=f,ve=re.alternate,qe=re.stateNode;if(re=re.tag,ve!==null&&ve===p)break;re!==5&&re!==26&&re!==27||qe===null||(ve=qe,C?(qe=Ke(f,A),qe!=null&&U.unshift(Vd(f,qe,ve))):C||(qe=Ke(f,A),qe!=null&&U.push(Vd(f,qe,ve)))),f=f.return}U.length!==0&&i.push({event:c,listeners:U})}var s1=/\r\n?/g,r1=/\u0000|\uFFFD/g;function En(i){return(typeof i=="string"?i:""+i).replace(s1,`
`).replace(r1,"")}function Tf(i,c){return c=En(c),En(i)===c}function mr(i,c,f,p,C,A){switch(f){case"children":typeof p=="string"?c==="body"||c==="textarea"&&p===""||pi(i,p):(typeof p=="number"||typeof p=="bigint")&&c!=="body"&&pi(i,""+p);break;case"className":Fr(i,"class",p);break;case"tabIndex":Fr(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Fr(i,f,p);break;case"style":or(i,p,A);break;case"data":if(c!=="object"){Fr(i,"data",p);break}case"src":case"href":if(p===""&&(c!=="a"||f!=="href")){i.removeAttribute(f);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=fl(""+p),i.setAttribute(f,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(f==="formAction"?(c!=="input"&&mr(i,c,"name",C.name,C,null),mr(i,c,"formEncType",C.formEncType,C,null),mr(i,c,"formMethod",C.formMethod,C,null),mr(i,c,"formTarget",C.formTarget,C,null)):(mr(i,c,"encType",C.encType,C,null),mr(i,c,"method",C.method,C,null),mr(i,c,"target",C.target,C,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=fl(""+p),i.setAttribute(f,p);break;case"onClick":p!=null&&(i.onclick=rn);break;case"onScroll":p!=null&&ds("scroll",i);break;case"onScrollEnd":p!=null&&ds("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(o(61));if(f=p.__html,f!=null){if(C.children!=null)throw Error(o(60));i.innerHTML=f}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}f=fl(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""+p):i.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""):i.removeAttribute(f);break;case"capture":case"download":p===!0?i.setAttribute(f,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,p):i.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(f,p):i.removeAttribute(f);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(f):i.setAttribute(f,p);break;case"popover":ds("beforetoggle",i),ds("toggle",i),_r(i,"popover",p);break;case"xlinkActuate":Gn(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Gn(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Gn(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Gn(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Gn(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Gn(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Gn(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Gn(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Gn(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":_r(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=c0.get(f)||f,_r(i,f,p))}}function _f(i,c,f,p,C,A){switch(f){case"style":or(i,p,A);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(o(61));if(f=p.__html,f!=null){if(C.children!=null)throw Error(o(60));i.innerHTML=f}}break;case"children":typeof p=="string"?pi(i,p):(typeof p=="number"||typeof p=="bigint")&&pi(i,""+p);break;case"onScroll":p!=null&&ds("scroll",i);break;case"onScrollEnd":p!=null&&ds("scrollend",i);break;case"onClick":p!=null&&(i.onclick=rn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!La.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(C=f.endsWith("Capture"),c=f.slice(2,C?f.length-7:void 0),A=i[_s]||null,A=A!=null?A[f]:null,typeof A=="function"&&i.removeEventListener(c,A,C),typeof p=="function")){typeof A!="function"&&A!==null&&(f in i?i[f]=null:i.hasAttribute(f)&&i.removeAttribute(f)),i.addEventListener(c,p,C);break e}f in i?i[f]=p:p===!0?i.setAttribute(f,""):_r(i,f,p)}}}function ja(i,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ds("error",i),ds("load",i);var p=!1,C=!1,A;for(A in f)if(f.hasOwnProperty(A)){var U=f[A];if(U!=null)switch(A){case"src":p=!0;break;case"srcSet":C=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,c));default:mr(i,c,A,U,f,null)}}C&&mr(i,c,"srcSet",f.srcSet,f,null),p&&mr(i,c,"src",f.src,f,null);return;case"input":ds("invalid",i);var re=A=U=C=null,ve=null,qe=null;for(p in f)if(f.hasOwnProperty(p)){var ft=f[p];if(ft!=null)switch(p){case"name":C=ft;break;case"type":U=ft;break;case"checked":ve=ft;break;case"defaultChecked":qe=ft;break;case"value":A=ft;break;case"defaultValue":re=ft;break;case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(o(137,c));break;default:mr(i,c,p,ft,f,null)}}Qc(i,A,re,ve,qe,U,C,!1);return;case"select":ds("invalid",i),p=U=A=null;for(C in f)if(f.hasOwnProperty(C)&&(re=f[C],re!=null))switch(C){case"value":A=re;break;case"defaultValue":U=re;break;case"multiple":p=re;default:mr(i,c,C,re,f,null)}c=A,f=U,i.multiple=!!p,c!=null?Va(i,!!p,c,!1):f!=null&&Va(i,!!p,f,!0);return;case"textarea":ds("invalid",i),A=C=p=null;for(U in f)if(f.hasOwnProperty(U)&&(re=f[U],re!=null))switch(U){case"value":p=re;break;case"defaultValue":C=re;break;case"children":A=re;break;case"dangerouslySetInnerHTML":if(re!=null)throw Error(o(91));break;default:mr(i,c,U,re,f,null)}Oi(i,p,C,A);return;case"option":for(ve in f)f.hasOwnProperty(ve)&&(p=f[ve],p!=null)&&(ve==="selected"?i.selected=p&&typeof p!="function"&&typeof p!="symbol":mr(i,c,ve,p,f,null));return;case"dialog":ds("beforetoggle",i),ds("toggle",i),ds("cancel",i),ds("close",i);break;case"iframe":case"object":ds("load",i);break;case"video":case"audio":for(p=0;p<So.length;p++)ds(So[p],i);break;case"image":ds("error",i),ds("load",i);break;case"details":ds("toggle",i);break;case"embed":case"source":case"link":ds("error",i),ds("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(qe in f)if(f.hasOwnProperty(qe)&&(p=f[qe],p!=null))switch(qe){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,c));default:mr(i,c,qe,p,f,null)}return;default:if(Gl(c)){for(ft in f)f.hasOwnProperty(ft)&&(p=f[ft],p!==void 0&&_f(i,c,ft,p,f,void 0));return}}for(re in f)f.hasOwnProperty(re)&&(p=f[re],p!=null&&mr(i,c,re,p,f,null))}function Ff(i,c,f,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var C=null,A=null,U=null,re=null,ve=null,qe=null,ft=null;for(ct in f){var gt=f[ct];if(f.hasOwnProperty(ct)&&gt!=null)switch(ct){case"checked":break;case"value":break;case"defaultValue":ve=gt;default:p.hasOwnProperty(ct)||mr(i,c,ct,null,p,gt)}}for(var et in p){var ct=p[et];if(gt=f[et],p.hasOwnProperty(et)&&(ct!=null||gt!=null))switch(et){case"type":A=ct;break;case"name":C=ct;break;case"checked":qe=ct;break;case"defaultChecked":ft=ct;break;case"value":U=ct;break;case"defaultValue":re=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(o(137,c));break;default:ct!==gt&&mr(i,c,et,ct,p,gt)}}Ra(i,U,re,ve,qe,ft,A,C);return;case"select":ct=U=re=et=null;for(A in f)if(ve=f[A],f.hasOwnProperty(A)&&ve!=null)switch(A){case"value":break;case"multiple":ct=ve;default:p.hasOwnProperty(A)||mr(i,c,A,null,p,ve)}for(C in p)if(A=p[C],ve=f[C],p.hasOwnProperty(C)&&(A!=null||ve!=null))switch(C){case"value":et=A;break;case"defaultValue":re=A;break;case"multiple":U=A;default:A!==ve&&mr(i,c,C,A,p,ve)}c=re,f=U,p=ct,et!=null?Va(i,!!f,et,!1):!!p!=!!f&&(c!=null?Va(i,!!f,c,!0):Va(i,!!f,f?[]:"",!1));return;case"textarea":ct=et=null;for(re in f)if(C=f[re],f.hasOwnProperty(re)&&C!=null&&!p.hasOwnProperty(re))switch(re){case"value":break;case"children":break;default:mr(i,c,re,null,p,C)}for(U in p)if(C=p[U],A=f[U],p.hasOwnProperty(U)&&(C!=null||A!=null))switch(U){case"value":et=C;break;case"defaultValue":ct=C;break;case"children":break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(o(91));break;default:C!==A&&mr(i,c,U,C,p,A)}Yl(i,et,ct);return;case"option":for(var Zt in f)et=f[Zt],f.hasOwnProperty(Zt)&&et!=null&&!p.hasOwnProperty(Zt)&&(Zt==="selected"?i.selected=!1:mr(i,c,Zt,null,p,et));for(ve in p)et=p[ve],ct=f[ve],p.hasOwnProperty(ve)&&et!==ct&&(et!=null||ct!=null)&&(ve==="selected"?i.selected=et&&typeof et!="function"&&typeof et!="symbol":mr(i,c,ve,et,p,ct));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ps in f)et=f[ps],f.hasOwnProperty(ps)&&et!=null&&!p.hasOwnProperty(ps)&&mr(i,c,ps,null,p,et);for(qe in p)if(et=p[qe],ct=f[qe],p.hasOwnProperty(qe)&&et!==ct&&(et!=null||ct!=null))switch(qe){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(o(137,c));break;default:mr(i,c,qe,et,p,ct)}return;default:if(Gl(c)){for(var Sr in f)et=f[Sr],f.hasOwnProperty(Sr)&&et!==void 0&&!p.hasOwnProperty(Sr)&&_f(i,c,Sr,void 0,p,et);for(ft in p)et=p[ft],ct=f[ft],!p.hasOwnProperty(ft)||et===ct||et===void 0&&ct===void 0||_f(i,c,ft,et,p,ct);return}}for(var $e in f)et=f[$e],f.hasOwnProperty($e)&&et!=null&&!p.hasOwnProperty($e)&&mr(i,c,$e,null,p,et);for(gt in p)et=p[gt],ct=f[gt],!p.hasOwnProperty(gt)||et===ct||et==null&&ct==null||mr(i,c,gt,et,p,ct)}function Mf(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Lf(){if(typeof performance.getEntriesByType=="function"){for(var i=0,c=0,f=performance.getEntriesByType("resource"),p=0;p<f.length;p++){var C=f[p],A=C.transferSize,U=C.initiatorType,re=C.duration;if(A&&re&&Mf(U)){for(U=0,re=C.responseEnd,p+=1;p<f.length;p++){var ve=f[p],qe=ve.startTime;if(qe>re)break;var ft=ve.transferSize,gt=ve.initiatorType;ft&&Mf(gt)&&(ve=ve.responseEnd,U+=ft*(ve<re?1:(re-qe)/(ve-qe)))}if(--p,c+=8*(A+U)/(C.duration/1e3),i++,10<i)break}}if(0<i)return c/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Sc=null,Lu=null;function $d(i){return i.nodeType===9?i:i.ownerDocument}function Rf(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ii(i,c){if(i===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&c==="foreignObject"?0:i}function Ac(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var qd=null;function Ru(){var i=window.event;return i&&i.type==="popstate"?i===qd?!1:(qd=i,!0):(qd=null,!1)}var Ou=typeof setTimeout=="function"?setTimeout:void 0,Bg=typeof clearTimeout=="function"?clearTimeout:void 0,Of=typeof Promise=="function"?Promise:void 0,Pu=typeof queueMicrotask=="function"?queueMicrotask:typeof Of<"u"?function(i){return Of.resolve(null).then(i).catch(zg)}:Ou;function zg(i){setTimeout(function(){throw i})}function ll(i){return i==="head"}function Iu(i,c){var f=c,p=0;do{var C=f.nextSibling;if(i.removeChild(f),C&&C.nodeType===8)if(f=C.data,f==="/$"||f==="/&"){if(p===0){i.removeChild(C),as(c);return}p--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")p++;else if(f==="html")d(i.ownerDocument.documentElement);else if(f==="head"){f=i.ownerDocument.head,d(f);for(var A=f.firstChild;A;){var U=A.nextSibling,re=A.nodeName;A[mn]||re==="SCRIPT"||re==="STYLE"||re==="LINK"&&A.rel.toLowerCase()==="stylesheet"||f.removeChild(A),A=U}}else f==="body"&&d(i.ownerDocument.body);f=C}while(f);as(c)}function Pf(i,c){var f=i;i=0;do{var p=f.nextSibling;if(f.nodeType===1?c?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(c?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),p&&p.nodeType===8)if(f=p.data,f==="/$"){if(i===0)break;i--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||i++;f=p}while(f)}function Bu(i){var c=i.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Bu(f),zo(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}i.removeChild(f)}}function zu(i,c,f,p){for(;i.nodeType===1;){var C=f;if(i.nodeName.toLowerCase()!==c.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[mn])switch(c){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(A=i.getAttribute("rel"),A==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(A!==C.rel||i.getAttribute("href")!==(C.href==null||C.href===""?null:C.href)||i.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin)||i.getAttribute("title")!==(C.title==null?null:C.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(A=i.getAttribute("src"),(A!==(C.src==null?null:C.src)||i.getAttribute("type")!==(C.type==null?null:C.type)||i.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin))&&A&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(c==="input"&&i.type==="hidden"){var A=C.name==null?null:""+C.name;if(C.type==="hidden"&&i.getAttribute("name")===A)return i}else return i;if(i=Dn(i.nextSibling),i===null)break}return null}function If(i,c,f){if(c==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!f||(i=Dn(i.nextSibling),i===null))return null;return i}function Uu(i,c){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=Dn(i.nextSibling),i===null))return null;return i}function Hu(i){return i.data==="$?"||i.data==="$~"}function Ec(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function Bf(i,c){var f=i.ownerDocument;if(i.data==="$~")i._reactRetry=c;else if(i.data!=="$?"||f.readyState!=="loading")c();else{var p=function(){c(),f.removeEventListener("DOMContentLoaded",p)};f.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function Dn(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return i}var Ll=null;function Ws(i){i=i.nextSibling;for(var c=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"||f==="/&"){if(c===0)return Dn(i.nextSibling);c--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||c++}i=i.nextSibling}return null}function Ug(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(c===0)return i;c--}else f!=="/$"&&f!=="/&"||c++}i=i.previousSibling}return null}function r(i,c,f){switch(c=$d(f),i){case"html":if(i=c.documentElement,!i)throw Error(o(452));return i;case"head":if(i=c.head,!i)throw Error(o(453));return i;case"body":if(i=c.body,!i)throw Error(o(454));return i;default:throw Error(o(451))}}function d(i){for(var c=i.attributes;c.length;)i.removeAttributeNode(c[0]);zo(i)}var u=new Map,h=new Set;function g(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var b=Se.d;Se.d={f:x,r:y,D:E,C:T,L:_,m:R,X:I,S:q,M:ee};function x(){var i=b.f(),c=ju();return i||c}function y(i){var c=Ma(i);c!==null&&c.tag===5&&c.type==="form"?qm(c):b.r(i)}var j=typeof document>"u"?null:document;function k(i,c,f){var p=j;if(p&&typeof c=="string"&&c){var C=ws(c);C='link[rel="'+i+'"][href="'+C+'"]',typeof f=="string"&&(C+='[crossorigin="'+f+'"]'),h.has(C)||(h.add(C),i={rel:i,crossOrigin:f,href:c},p.querySelector(C)===null&&(c=p.createElement("link"),ja(c,"link",i),kr(c),p.head.appendChild(c)))}}function E(i){b.D(i),k("dns-prefetch",i,null)}function T(i,c){b.C(i,c),k("preconnect",i,c)}function _(i,c,f){b.L(i,c,f);var p=j;if(p&&i&&c){var C='link[rel="preload"][as="'+ws(c)+'"]';c==="image"&&f&&f.imageSrcSet?(C+='[imagesrcset="'+ws(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(C+='[imagesizes="'+ws(f.imageSizes)+'"]')):C+='[href="'+ws(i)+'"]';var A=C;switch(c){case"style":A=z(i);break;case"script":A=Ee(i)}u.has(A)||(i=D({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:i,as:c},f),u.set(A,i),p.querySelector(C)!==null||c==="style"&&p.querySelector(Z(A))||c==="script"&&p.querySelector(We(A))||(c=p.createElement("link"),ja(c,"link",i),kr(c),p.head.appendChild(c)))}}function R(i,c){b.m(i,c);var f=j;if(f&&i){var p=c&&typeof c.as=="string"?c.as:"script",C='link[rel="modulepreload"][as="'+ws(p)+'"][href="'+ws(i)+'"]',A=C;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Ee(i)}if(!u.has(A)&&(i=D({rel:"modulepreload",href:i},c),u.set(A,i),f.querySelector(C)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(We(A)))return}p=f.createElement("link"),ja(p,"link",i),kr(p),f.head.appendChild(p)}}}function q(i,c,f){b.S(i,c,f);var p=j;if(p&&i){var C=Br(p).hoistableStyles,A=z(i);c=c||"default";var U=C.get(A);if(!U){var re={loading:0,preload:null};if(U=p.querySelector(Z(A)))re.loading=5;else{i=D({rel:"stylesheet",href:i,"data-precedence":c},f),(f=u.get(A))&&bt(i,f);var ve=U=p.createElement("link");kr(ve),ja(ve,"link",i),ve._p=new Promise(function(qe,ft){ve.onload=qe,ve.onerror=ft}),ve.addEventListener("load",function(){re.loading|=1}),ve.addEventListener("error",function(){re.loading|=2}),re.loading|=4,Je(U,c,p)}U={type:"stylesheet",instance:U,count:1,state:re},C.set(A,U)}}}function I(i,c){b.X(i,c);var f=j;if(f&&i){var p=Br(f).hoistableScripts,C=Ee(i),A=p.get(C);A||(A=f.querySelector(We(C)),A||(i=D({src:i,async:!0},c),(c=u.get(C))&&yt(i,c),A=f.createElement("script"),kr(A),ja(A,"link",i),f.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(C,A))}}function ee(i,c){b.M(i,c);var f=j;if(f&&i){var p=Br(f).hoistableScripts,C=Ee(i),A=p.get(C);A||(A=f.querySelector(We(C)),A||(i=D({src:i,async:!0,type:"module"},c),(c=u.get(C))&&yt(i,c),A=f.createElement("script"),kr(A),ja(A,"link",i),f.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(C,A))}}function Y(i,c,f,p){var C=(C=H.current)?g(C):null;if(!C)throw Error(o(446));switch(i){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=z(f.href),f=Br(C).hoistableStyles,p=f.get(c),p||(p={type:"style",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){i=z(f.href);var A=Br(C).hoistableStyles,U=A.get(i);if(U||(C=C.ownerDocument||C,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(i,U),(A=C.querySelector(Z(i)))&&!A._p&&(U.instance=A,U.state.loading=5),u.has(i)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},u.set(i,f),A||ie(C,i,f,U.state))),c&&p===null)throw Error(o(528,""));return U}if(c&&p!==null)throw Error(o(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Ee(f),f=Br(C).hoistableScripts,p=f.get(c),p||(p={type:"script",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,i))}}function z(i){return'href="'+ws(i)+'"'}function Z(i){return'link[rel="stylesheet"]['+i+"]"}function ae(i){return D({},i,{"data-precedence":i.precedence,precedence:null})}function ie(i,c,f,p){i.querySelector('link[rel="preload"][as="style"]['+c+"]")?p.loading=1:(c=i.createElement("link"),p.preload=c,c.addEventListener("load",function(){return p.loading|=1}),c.addEventListener("error",function(){return p.loading|=2}),ja(c,"link",f),kr(c),i.head.appendChild(c))}function Ee(i){return'[src="'+ws(i)+'"]'}function We(i){return"script[async]"+i}function Ie(i,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var p=i.querySelector('style[data-href~="'+ws(f.href)+'"]');if(p)return c.instance=p,kr(p),p;var C=D({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),kr(p),ja(p,"style",C),Je(p,f.precedence,i),c.instance=p;case"stylesheet":C=z(f.href);var A=i.querySelector(Z(C));if(A)return c.state.loading|=4,c.instance=A,kr(A),A;p=ae(f),(C=u.get(C))&&bt(p,C),A=(i.ownerDocument||i).createElement("link"),kr(A);var U=A;return U._p=new Promise(function(re,ve){U.onload=re,U.onerror=ve}),ja(A,"link",p),c.state.loading|=4,Je(A,f.precedence,i),c.instance=A;case"script":return A=Ee(f.src),(C=i.querySelector(We(A)))?(c.instance=C,kr(C),C):(p=f,(C=u.get(A))&&(p=D({},f),yt(p,C)),i=i.ownerDocument||i,C=i.createElement("script"),kr(C),ja(C,"link",p),i.head.appendChild(C),c.instance=C);case"void":return null;default:throw Error(o(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(p=c.instance,c.state.loading|=4,Je(p,f.precedence,i));return c.instance}function Je(i,c,f){for(var p=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),C=p.length?p[p.length-1]:null,A=C,U=0;U<p.length;U++){var re=p[U];if(re.dataset.precedence===c)A=re;else if(A!==C)break}A?A.parentNode.insertBefore(i,A.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(i,c.firstChild))}function bt(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.title==null&&(i.title=c.title)}function yt(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.integrity==null&&(i.integrity=c.integrity)}var it=null;function St(i,c,f){if(it===null){var p=new Map,C=it=new Map;C.set(f,p)}else C=it,p=C.get(f),p||(p=new Map,C.set(f,p));if(p.has(i))return p;for(p.set(i,null),f=f.getElementsByTagName(i),C=0;C<f.length;C++){var A=f[C];if(!(A[mn]||A[Tr]||i==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var U=A.getAttribute(c)||"";U=i+U;var re=p.get(U);re?re.push(A):p.set(U,[A])}}return p}function Ht(i,c,f){i=i.ownerDocument||i,i.head.insertBefore(f,c==="title"?i.querySelector("head > title"):null)}function zt(i,c,f){if(f===1||c.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(i=c.disabled,typeof c.precedence=="string"&&i==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Lt(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Ot(i,c,f,p){if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var C=z(p.href),A=c.querySelector(Z(C));if(A){c=A._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(i.count++,i=qt.bind(i),c.then(i,i)),f.state.loading|=4,f.instance=A,kr(A);return}A=c.ownerDocument||c,p=ae(p),(C=u.get(C))&&bt(p,C),A=A.createElement("link"),kr(A);var U=A;U._p=new Promise(function(re,ve){U.onload=re,U.onerror=ve}),ja(A,"link",p),f.instance=A}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(i.count++,f=qt.bind(i),c.addEventListener("load",f),c.addEventListener("error",f))}}var Tt=0;function jt(i,c){return i.stylesheets&&i.count===0&&ns(i,i.stylesheets),0<i.count||0<i.imgCount?function(f){var p=setTimeout(function(){if(i.stylesheets&&ns(i,i.stylesheets),i.unsuspend){var A=i.unsuspend;i.unsuspend=null,A()}},6e4+c);0<i.imgBytes&&Tt===0&&(Tt=62500*Lf());var C=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&ns(i,i.stylesheets),i.unsuspend)){var A=i.unsuspend;i.unsuspend=null,A()}},(i.imgBytes>Tt?50:800)+c);return i.unsuspend=f,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(C)}}:null}function qt(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ns(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Xt=null;function ns(i,c){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Xt=new Map,c.forEach(Ds,i),Xt=null,qt.call(i))}function Ds(i,c){if(!(c.state.loading&4)){var f=Xt.get(i);if(f)var p=f.get(null);else{f=new Map,Xt.set(i,f);for(var C=i.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<C.length;A++){var U=C[A];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(f.set(U.dataset.precedence,U),p=U)}p&&f.set(null,p)}C=c.instance,U=C.getAttribute("data-precedence"),A=f.get(U)||p,A===p&&f.set(null,C),f.set(U,C),this.count++,p=qt.bind(this),C.addEventListener("load",p),C.addEventListener("error",p),A?A.parentNode.insertBefore(C,A.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(C,i.firstChild)),c.state.loading|=4}}var Vt={$$typeof:se,Provider:null,Consumer:null,_currentValue:Ye,_currentValue2:Ye,_threadCount:0};function At(i,c,f,p,C,A,U,re,ve){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$l(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$l(0),this.hiddenUpdates=$l(null),this.identifierPrefix=p,this.onUncaughtError=C,this.onCaughtError=A,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ve,this.incompleteTransitions=new Map}function gs(i,c,f,p,C,A,U,re,ve,qe,ft,gt){return i=new At(i,c,f,U,ve,qe,ft,gt,re),c=1,A===!0&&(c|=24),A=Mr(3,null,null,c),i.current=A,A.stateNode=i,c=Zo(),c.refCount++,i.pooledCache=c,c.refCount++,A.memoizedState={element:p,isDehydrated:f,cache:c},z0(A),i}function Us(i){return i?(i=so,i):so}function Os(i,c,f,p,C,A){C=Us(C),p.context===null?p.context=C:p.pendingContext=C,p=Da(c),p.payload={element:f},A=A===void 0?null:A,A!==null&&(p.callback=A),f=qi(i,p,c),f!==null&&(Xa(f,i,c),co(f,i,c))}function Zs(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<c?f:c}}function Pr(i,c){Zs(i,c),(i=i.alternate)&&Zs(i,c)}function Me(i){if(i.tag===13||i.tag===31){var c=Rn(i,67108864);c!==null&&Xa(c,i,67108864),Pr(i,67108864)}}function er(i){if(i.tag===13||i.tag===31){var c=Qa();c=Bo(c);var f=Rn(i,c);f!==null&&Xa(f,i,c),Pr(i,c)}}var $s=!0;function ha(i,c,f,p){var C=fe.T;fe.T=null;var A=Se.p;try{Se.p=2,he(i,c,f,p)}finally{Se.p=A,fe.T=C}}function Un(i,c,f,p){var C=fe.T;fe.T=null;var A=Se.p;try{Se.p=8,he(i,c,f,p)}finally{Se.p=A,fe.T=C}}function he(i,c,f,p){if($s){var C=ot(p);if(C===null)Fu(i,c,p,Te,f),Bt(i,p);else if(ss(C,i,c,f,p))p.stopPropagation();else if(Bt(i,p),c&4&&-1<Yt.indexOf(i)){for(;C!==null;){var A=Ma(C);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var U=Yn(A.pendingLanes);if(U!==0){var re=A;for(re.pendingLanes|=2,re.entangledLanes|=2;U;){var ve=1<<31-xr(U);re.entanglements[1]|=ve,U&=~ve}wa(A),(sr&6)===0&&(bu=ys()+500,ko(0))}}break;case 31:case 13:re=Rn(A,2),re!==null&&Xa(re,A,2),ju(),Pr(A,2)}if(A=ot(p),A===null&&Fu(i,c,p,Te,f),A===C)break;C=A}C!==null&&p.stopPropagation()}else Fu(i,c,p,null,f)}}function ot(i){return i=Oe(i),at(i)}var Te=null;function at(i){if(Te=null,i=gn(i),i!==null){var c=e(i);if(c===null)i=null;else{var f=c.tag;if(f===13){if(i=m(c),i!==null)return i;i=null}else if(f===31){if(i=v(c),i!==null)return i;i=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null)}}return Te=i,null}function Ae(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Re()){case ht:return 2;case Ft:return 8;case Is:case jr:return 32;case $r:return 268435456;default:return 32}default:return 32}}var kt=!1,Ze=null,dt=null,Ge=null,mt=new Map,Et=new Map,Kt=[],Yt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Bt(i,c){switch(i){case"focusin":case"focusout":Ze=null;break;case"dragenter":case"dragleave":dt=null;break;case"mouseover":case"mouseout":Ge=null;break;case"pointerover":case"pointerout":mt.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Et.delete(c.pointerId)}}function Qt(i,c,f,p,C,A){return i===null||i.nativeEvent!==A?(i={blockedOn:c,domEventName:f,eventSystemFlags:p,nativeEvent:A,targetContainers:[C]},c!==null&&(c=Ma(c),c!==null&&Me(c)),i):(i.eventSystemFlags|=p,c=i.targetContainers,C!==null&&c.indexOf(C)===-1&&c.push(C),i)}function ss(i,c,f,p,C){switch(c){case"focusin":return Ze=Qt(Ze,i,c,f,p,C),!0;case"dragenter":return dt=Qt(dt,i,c,f,p,C),!0;case"mouseover":return Ge=Qt(Ge,i,c,f,p,C),!0;case"pointerover":var A=C.pointerId;return mt.set(A,Qt(mt.get(A)||null,i,c,f,p,C)),!0;case"gotpointercapture":return A=C.pointerId,Et.set(A,Qt(Et.get(A)||null,i,c,f,p,C)),!0}return!1}function ts(i){var c=gn(i.target);if(c!==null){var f=e(c);if(f!==null){if(c=f.tag,c===13){if(c=m(f),c!==null){i.blockedOn=c,Ri(i.priority,function(){er(f)});return}}else if(c===31){if(c=v(f),c!==null){i.blockedOn=c,Ri(i.priority,function(){er(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Pt(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var f=ot(i.nativeEvent);if(f===null){f=i.nativeEvent;var p=new f.constructor(f.type,f);G=p,f.target.dispatchEvent(p),G=null}else return c=Ma(f),c!==null&&Me(c),i.blockedOn=f,!1;c.shift()}return!0}function Dt(i,c,f){Pt(i)&&f.delete(c)}function rs(){kt=!1,Ze!==null&&Pt(Ze)&&(Ze=null),dt!==null&&Pt(dt)&&(dt=null),Ge!==null&&Pt(Ge)&&(Ge=null),mt.forEach(Dt),Et.forEach(Dt)}function Wt(i,c){i.blockedOn===c&&(i.blockedOn=null,kt||(kt=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,rs)))}var _t=null;function os(i){_t!==i&&(_t=i,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){_t===i&&(_t=null);for(var c=0;c<i.length;c+=3){var f=i[c],p=i[c+1],C=i[c+2];if(typeof p!="function"){if(at(p||f)===null)continue;break}var A=Ma(f);A!==null&&(i.splice(c,3),c-=3,Gh(A,{pending:!0,data:C,method:f.method,action:p},p,C))}}))}function as(i){function c(ve){return Wt(ve,i)}Ze!==null&&Wt(Ze,i),dt!==null&&Wt(dt,i),Ge!==null&&Wt(Ge,i),mt.forEach(c),Et.forEach(c);for(var f=0;f<Kt.length;f++){var p=Kt[f];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Kt.length&&(f=Kt[0],f.blockedOn===null);)ts(f),f.blockedOn===null&&Kt.shift();if(f=(i.ownerDocument||i).$$reactFormReplay,f!=null)for(p=0;p<f.length;p+=3){var C=f[p],A=f[p+1],U=C[_s]||null;if(typeof A=="function")U||os(f);else if(U){var re=null;if(A&&A.hasAttribute("formAction")){if(C=A,U=A[_s]||null)re=U.formAction;else if(at(C)!==null)continue}else re=U.action;typeof re=="function"?f[p+1]=re:(f.splice(p,3),p-=3),os(f)}}}function gr(){function i(A){A.canIntercept&&A.info==="react-transition"&&A.intercept({handler:function(){return new Promise(function(U){return C=U})},focusReset:"manual",scroll:"manual"})}function c(){C!==null&&(C(),C=null),p||setTimeout(f,20)}function f(){if(!p&&!navigation.transition){var A=navigation.currentEntry;A&&A.url!=null&&navigation.navigate(A.url,{state:A.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,C=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(f,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),C!==null&&(C(),C=null)}}}function cs(i){this._internalRoot=i}Ns.prototype.render=cs.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(o(409));var f=c.current,p=Qa();Os(f,p,i,c,null,null)},Ns.prototype.unmount=cs.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;Os(i.current,2,null,i,null,null),ju(),c[Ha]=null}};function Ns(i){this._internalRoot=i}Ns.prototype.unstable_scheduleHydration=function(i){if(i){var c=mi();i={blockedOn:null,target:i,priority:c};for(var f=0;f<Kt.length&&c!==0&&c<Kt[f].priority;f++);Kt.splice(f,0,i),f===0&&ts(i)}};var Jt=n.version;if(Jt!=="19.2.3")throw Error(o(527,Jt,"19.2.3"));Se.findDOMNode=function(i){var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(o(188)):(i=Object.keys(i).join(","),Error(o(268,i)));return i=N(c),i=i!==null?S(i):null,i=i===null?null:i.stateNode,i};var zs={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:fe,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ms=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ms.isDisabled&&Ms.supportsFiber)try{ka=Ms.inject(zs),ma=Ms}catch{}}return Uf.createRoot=function(i,c){if(!s(i))throw Error(o(299));var f=!1,p="",C=su,A=rg,U=ag;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(C=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError)),c=gs(i,1,!1,null,null,f,p,null,C,A,U,gr),i[Ha]=c.current,Ef(i),new cs(c)},Uf.hydrateRoot=function(i,c,f){if(!s(i))throw Error(o(299));var p=!1,C="",A=su,U=rg,re=ag,ve=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(C=f.identifierPrefix),f.onUncaughtError!==void 0&&(A=f.onUncaughtError),f.onCaughtError!==void 0&&(U=f.onCaughtError),f.onRecoverableError!==void 0&&(re=f.onRecoverableError),f.formState!==void 0&&(ve=f.formState)),c=gs(i,1,!0,c,f??null,p,C,ve,A,U,re,gr),c.context=Us(null),f=c.current,p=Qa(),p=Bo(p),C=Da(p),C.callback=null,qi(f,C,p),f=p,c.current.lanes=f,Mi(c,f),wa(c),i[Ha]=c.current,Ef(i),new Ns(c)},Uf.version="19.2.3",Uf}var Rx;function Iv(){if(Rx)return i1.exports;Rx=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(n){console.error(n)}}return l(),i1.exports=Pv(),i1.exports}var Bv=Iv();const zv=Pb(Bv);var Ox="popstate";function Uv(l={}){function n(o,s){let{pathname:e,search:m,hash:v}=o.location;return B1("",{pathname:e,search:m,hash:v},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(o,s){return typeof s=="string"?s:am(s)}return Vv(n,a,null,l)}function Qr(l,n){if(l===!1||l===null||typeof l>"u")throw new Error(n)}function oi(l,n){if(!l){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function Hv(){return Math.random().toString(36).substring(2,10)}function Px(l,n){return{usr:l.state,key:l.key,idx:n}}function B1(l,n,a=null,o){return{pathname:typeof l=="string"?l:l.pathname,search:"",hash:"",...typeof n=="string"?Zu(n):n,state:a,key:n&&n.key||o||Hv()}}function am({pathname:l="/",search:n="",hash:a=""}){return n&&n!=="?"&&(l+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(l+=a.charAt(0)==="#"?a:"#"+a),l}function Zu(l){let n={};if(l){let a=l.indexOf("#");a>=0&&(n.hash=l.substring(a),l=l.substring(0,a));let o=l.indexOf("?");o>=0&&(n.search=l.substring(o),l=l.substring(0,o)),l&&(n.pathname=l)}return n}function Vv(l,n,a,o={}){let{window:s=document.defaultView,v5Compat:e=!1}=o,m=s.history,v="POP",w=null,N=S();N==null&&(N=0,m.replaceState({...m.state,idx:N},""));function S(){return(m.state||{idx:null}).idx}function D(){v="POP";let P=S(),K=P==null?null:P-N;N=P,w&&w({action:v,location:O.location,delta:K})}function L(P,K){v="PUSH";let ne=B1(O.location,P,K);N=S()+1;let se=Px(ne,N),Ce=O.createHref(ne);try{m.pushState(se,"",Ce)}catch(ge){if(ge instanceof DOMException&&ge.name==="DataCloneError")throw ge;s.location.assign(Ce)}e&&w&&w({action:v,location:O.location,delta:1})}function M(P,K){v="REPLACE";let ne=B1(O.location,P,K);N=S();let se=Px(ne,N),Ce=O.createHref(ne);m.replaceState(se,"",Ce),e&&w&&w({action:v,location:O.location,delta:0})}function F(P){return Wv(P)}let O={get action(){return v},get location(){return l(s,m)},listen(P){if(w)throw new Error("A history only accepts one active listener");return s.addEventListener(Ox,D),w=P,()=>{s.removeEventListener(Ox,D),w=null}},createHref(P){return n(s,P)},createURL:F,encodeLocation(P){let K=F(P);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:L,replace:M,go(P){return m.go(P)}};return O}function Wv(l,n=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),Qr(a,"No window.location.(origin|href) available to create URL");let o=typeof l=="string"?l:am(l);return o=o.replace(/ $/,"%20"),!n&&o.startsWith("//")&&(o=a+o),new URL(o,a)}function Ib(l,n,a="/"){return $v(l,n,a,!1)}function $v(l,n,a,o){let s=typeof n=="string"?Zu(n):n,e=Oo(s.pathname||"/",a);if(e==null)return null;let m=Bb(l);qv(m);let v=null;for(let w=0;v==null&&w<m.length;++w){let N=r4(e);v=t4(m[w],N,o)}return v}function Bb(l,n=[],a=[],o="",s=!1){let e=(m,v,w=s,N)=>{let S={relativePath:N===void 0?m.path||"":N,caseSensitive:m.caseSensitive===!0,childrenIndex:v,route:m};if(S.relativePath.startsWith("/")){if(!S.relativePath.startsWith(o)&&w)return;Qr(S.relativePath.startsWith(o),`Absolute route path "${S.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),S.relativePath=S.relativePath.slice(o.length)}let D=Ro([o,S.relativePath]),L=a.concat(S);m.children&&m.children.length>0&&(Qr(m.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${D}".`),Bb(m.children,n,L,D,w)),!(m.path==null&&!m.index)&&n.push({path:D,score:Zv(D,m.index),routesMeta:L})};return l.forEach((m,v)=>{if(m.path===""||!m.path?.includes("?"))e(m,v);else for(let w of zb(m.path))e(m,v,!0,w)}),n}function zb(l){let n=l.split("/");if(n.length===0)return[];let[a,...o]=n,s=a.endsWith("?"),e=a.replace(/\?$/,"");if(o.length===0)return s?[e,""]:[e];let m=zb(o.join("/")),v=[];return v.push(...m.map(w=>w===""?e:[e,w].join("/"))),s&&v.push(...m),v.map(w=>l.startsWith("/")&&w===""?"/":w)}function qv(l){l.sort((n,a)=>n.score!==a.score?a.score-n.score:e4(n.routesMeta.map(o=>o.childrenIndex),a.routesMeta.map(o=>o.childrenIndex)))}var Yv=/^:[\w-]+$/,Gv=3,Kv=2,Qv=1,Xv=10,Jv=-2,Ix=l=>l==="*";function Zv(l,n){let a=l.split("/"),o=a.length;return a.some(Ix)&&(o+=Jv),n&&(o+=Kv),a.filter(s=>!Ix(s)).reduce((s,e)=>s+(Yv.test(e)?Gv:e===""?Qv:Xv),o)}function e4(l,n){return l.length===n.length&&l.slice(0,-1).every((o,s)=>o===n[s])?l[l.length-1]-n[n.length-1]:0}function t4(l,n,a=!1){let{routesMeta:o}=l,s={},e="/",m=[];for(let v=0;v<o.length;++v){let w=o[v],N=v===o.length-1,S=e==="/"?n:n.slice(e.length)||"/",D=pp({path:w.relativePath,caseSensitive:w.caseSensitive,end:N},S),L=w.route;if(!D&&N&&a&&!o[o.length-1].route.index&&(D=pp({path:w.relativePath,caseSensitive:w.caseSensitive,end:!1},S)),!D)return null;Object.assign(s,D.params),m.push({params:s,pathname:Ro([e,D.pathname]),pathnameBase:l4(Ro([e,D.pathnameBase])),route:L}),D.pathnameBase!=="/"&&(e=Ro([e,D.pathnameBase]))}return m}function pp(l,n){typeof l=="string"&&(l={path:l,caseSensitive:!1,end:!0});let[a,o]=s4(l.path,l.caseSensitive,l.end),s=n.match(a);if(!s)return null;let e=s[0],m=e.replace(/(.)\/+$/,"$1"),v=s.slice(1);return{params:o.reduce((N,{paramName:S,isOptional:D},L)=>{if(S==="*"){let F=v[L]||"";m=e.slice(0,e.length-F.length).replace(/(.)\/+$/,"$1")}const M=v[L];return D&&!M?N[S]=void 0:N[S]=(M||"").replace(/%2F/g,"/"),N},{}),pathname:e,pathnameBase:m,pattern:l}}function s4(l,n=!1,a=!0){oi(l==="*"||!l.endsWith("*")||l.endsWith("/*"),`Route path "${l}" will be treated as if it were "${l.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${l.replace(/\*$/,"/*")}".`);let o=[],s="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(m,v,w)=>(o.push({paramName:v,isOptional:w!=null}),w?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return l.endsWith("*")?(o.push({paramName:"*"}),s+=l==="*"||l==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":l!==""&&l!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,n?void 0:"i"),o]}function r4(l){try{return l.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return oi(!1,`The URL path "${l}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),l}}function Oo(l,n){if(n==="/")return l;if(!l.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,o=l.charAt(a);return o&&o!=="/"?null:l.slice(a)||"/"}var Ub=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,a4=l=>Ub.test(l);function n4(l,n="/"){let{pathname:a,search:o="",hash:s=""}=typeof l=="string"?Zu(l):l,e;if(a)if(a4(a))e=a;else{if(a.includes("//")){let m=a;a=a.replace(/\/\/+/g,"/"),oi(!1,`Pathnames cannot have embedded double slashes - normalizing ${m} -> ${a}`)}a.startsWith("/")?e=Bx(a.substring(1),"/"):e=Bx(a,n)}else e=n;return{pathname:e,search:o4(o),hash:c4(s)}}function Bx(l,n){let a=n.replace(/\/+$/,"").split("/");return l.split("/").forEach(s=>{s===".."?a.length>1&&a.pop():s!=="."&&a.push(s)}),a.length>1?a.join("/"):"/"}function d1(l,n,a,o){return`Cannot include a '${l}' character in a manually specified \`to.${n}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function i4(l){return l.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function tx(l){let n=i4(l);return n.map((a,o)=>o===n.length-1?a.pathname:a.pathnameBase)}function sx(l,n,a,o=!1){let s;typeof l=="string"?s=Zu(l):(s={...l},Qr(!s.pathname||!s.pathname.includes("?"),d1("?","pathname","search",s)),Qr(!s.pathname||!s.pathname.includes("#"),d1("#","pathname","hash",s)),Qr(!s.search||!s.search.includes("#"),d1("#","search","hash",s)));let e=l===""||s.pathname==="",m=e?"/":s.pathname,v;if(m==null)v=a;else{let D=n.length-1;if(!o&&m.startsWith("..")){let L=m.split("/");for(;L[0]==="..";)L.shift(),D-=1;s.pathname=L.join("/")}v=D>=0?n[D]:"/"}let w=n4(s,v),N=m&&m!=="/"&&m.endsWith("/"),S=(e||m===".")&&a.endsWith("/");return!w.pathname.endsWith("/")&&(N||S)&&(w.pathname+="/"),w}var Ro=l=>l.join("/").replace(/\/\/+/g,"/"),l4=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),o4=l=>!l||l==="?"?"":l.startsWith("?")?l:"?"+l,c4=l=>!l||l==="#"?"":l.startsWith("#")?l:"#"+l,d4=class{constructor(l,n,a,o=!1){this.status=l,this.statusText=n||"",this.internal=o,a instanceof Error?(this.data=a.toString(),this.error=a):this.data=a}};function u4(l){return l!=null&&typeof l.status=="number"&&typeof l.statusText=="string"&&typeof l.internal=="boolean"&&"data"in l}function h4(l){return l.map(n=>n.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Hb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Vb(l,n){let a=l;if(typeof a!="string"||!Ub.test(a))return{absoluteURL:void 0,isExternal:!1,to:a};let o=a,s=!1;if(Hb)try{let e=new URL(window.location.href),m=a.startsWith("//")?new URL(e.protocol+a):new URL(a),v=Oo(m.pathname,n);m.origin===e.origin&&v!=null?a=v+m.search+m.hash:s=!0}catch{oi(!1,`<Link to="${a}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:o,isExternal:s,to:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Wb=["POST","PUT","PATCH","DELETE"];new Set(Wb);var f4=["GET",...Wb];new Set(f4);var eh=B.createContext(null);eh.displayName="DataRouter";var Cp=B.createContext(null);Cp.displayName="DataRouterState";var m4=B.createContext(!1),$b=B.createContext({isTransitioning:!1});$b.displayName="ViewTransition";var g4=B.createContext(new Map);g4.displayName="Fetchers";var p4=B.createContext(null);p4.displayName="Await";var ci=B.createContext(null);ci.displayName="Navigation";var hm=B.createContext(null);hm.displayName="Location";var Fi=B.createContext({outlet:null,matches:[],isDataRoute:!1});Fi.displayName="Route";var rx=B.createContext(null);rx.displayName="RouteError";var qb="REACT_ROUTER_ERROR",x4="REDIRECT",b4="ROUTE_ERROR_RESPONSE";function y4(l){if(l.startsWith(`${qb}:${x4}:{`))try{let n=JSON.parse(l.slice(28));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.location=="string"&&typeof n.reloadDocument=="boolean"&&typeof n.replace=="boolean")return n}catch{}}function v4(l){if(l.startsWith(`${qb}:${b4}:{`))try{let n=JSON.parse(l.slice(40));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string")return new d4(n.status,n.statusText,n.data)}catch{}}function w4(l,{relative:n}={}){Qr(th(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:o}=B.useContext(ci),{hash:s,pathname:e,search:m}=fm(l,{relative:n}),v=e;return a!=="/"&&(v=e==="/"?a:Ro([a,e])),o.createHref({pathname:v,search:m,hash:s})}function th(){return B.useContext(hm)!=null}function Ul(){return Qr(th(),"useLocation() may be used only in the context of a <Router> component."),B.useContext(hm).location}var Yb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Gb(l){B.useContext(ci).static||B.useLayoutEffect(l)}function Dr(){let{isDataRoute:l}=B.useContext(Fi);return l?O4():j4()}function j4(){Qr(th(),"useNavigate() may be used only in the context of a <Router> component.");let l=B.useContext(eh),{basename:n,navigator:a}=B.useContext(ci),{matches:o}=B.useContext(Fi),{pathname:s}=Ul(),e=JSON.stringify(tx(o)),m=B.useRef(!1);return Gb(()=>{m.current=!0}),B.useCallback((w,N={})=>{if(oi(m.current,Yb),!m.current)return;if(typeof w=="number"){a.go(w);return}let S=sx(w,JSON.parse(e),s,N.relative==="path");l==null&&n!=="/"&&(S.pathname=S.pathname==="/"?n:Ro([n,S.pathname])),(N.replace?a.replace:a.push)(S,N.state,N)},[n,a,e,s,l])}var N4=B.createContext(null);function k4(l){let n=B.useContext(Fi).outlet;return B.useMemo(()=>n&&B.createElement(N4.Provider,{value:l},n),[n,l])}function di(){let{matches:l}=B.useContext(Fi),n=l[l.length-1];return n?n.params:{}}function fm(l,{relative:n}={}){let{matches:a}=B.useContext(Fi),{pathname:o}=Ul(),s=JSON.stringify(tx(a));return B.useMemo(()=>sx(l,JSON.parse(s),o,n==="path"),[l,s,o,n])}function C4(l,n){return Kb(l,n)}function Kb(l,n,a,o,s){Qr(th(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:e}=B.useContext(ci),{matches:m}=B.useContext(Fi),v=m[m.length-1],w=v?v.params:{},N=v?v.pathname:"/",S=v?v.pathnameBase:"/",D=v&&v.route;{let ne=D&&D.path||"";Xb(N,!D||ne.endsWith("*")||ne.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${N}" (under <Route path="${ne}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ne}"> to <Route path="${ne==="/"?"*":`${ne}/*`}">.`)}let L=Ul(),M;if(n){let ne=typeof n=="string"?Zu(n):n;Qr(S==="/"||ne.pathname?.startsWith(S),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${S}" but pathname "${ne.pathname}" was given in the \`location\` prop.`),M=ne}else M=L;let F=M.pathname||"/",O=F;if(S!=="/"){let ne=S.replace(/^\//,"").split("/");O="/"+F.replace(/^\//,"").split("/").slice(ne.length).join("/")}let P=Ib(l,{pathname:O});oi(D||P!=null,`No routes matched location "${M.pathname}${M.search}${M.hash}" `),oi(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${M.pathname}${M.search}${M.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=T4(P&&P.map(ne=>Object.assign({},ne,{params:Object.assign({},w,ne.params),pathname:Ro([S,e.encodeLocation?e.encodeLocation(ne.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ne.pathname]),pathnameBase:ne.pathnameBase==="/"?S:Ro([S,e.encodeLocation?e.encodeLocation(ne.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ne.pathnameBase])})),m,a,o,s);return n&&K?B.createElement(hm.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...M},navigationType:"POP"}},K):K}function S4(){let l=R4(),n=u4(l)?`${l.status} ${l.statusText}`:l instanceof Error?l.message:JSON.stringify(l),a=l instanceof Error?l.stack:null,o="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:o},e={padding:"2px 4px",backgroundColor:o},m=null;return console.error("Error handled by React Router default ErrorBoundary:",l),m=B.createElement(B.Fragment,null,B.createElement("p",null," Hey developer "),B.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",B.createElement("code",{style:e},"ErrorBoundary")," or"," ",B.createElement("code",{style:e},"errorElement")," prop on your route.")),B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},n),a?B.createElement("pre",{style:s},a):null,m)}var A4=B.createElement(S4,null),Qb=class extends B.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,n){return n.location!==l.location||n.revalidation!=="idle"&&l.revalidation==="idle"?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:l.error!==void 0?l.error:n.error,location:n.location,revalidation:l.revalidation||n.revalidation}}componentDidCatch(l,n){this.props.onError?this.props.onError(l,n):console.error("React Router caught the following error during render",l)}render(){let l=this.state.error;if(this.context&&typeof l=="object"&&l&&"digest"in l&&typeof l.digest=="string"){const a=v4(l.digest);a&&(l=a)}let n=l!==void 0?B.createElement(Fi.Provider,{value:this.props.routeContext},B.createElement(rx.Provider,{value:l,children:this.props.component})):this.props.children;return this.context?B.createElement(E4,{error:l},n):n}};Qb.contextType=m4;var u1=new WeakMap;function E4({children:l,error:n}){let{basename:a}=B.useContext(ci);if(typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){let o=y4(n.digest);if(o){let s=u1.get(n);if(s)throw s;let e=Vb(o.location,a);if(Hb&&!u1.get(n))if(e.isExternal||o.reloadDocument)window.location.href=e.absoluteURL||e.to;else{const m=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(e.to,{replace:o.replace}));throw u1.set(n,m),m}return B.createElement("meta",{httpEquiv:"refresh",content:`0;url=${e.absoluteURL||e.to}`})}}return l}function D4({routeContext:l,match:n,children:a}){let o=B.useContext(eh);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),B.createElement(Fi.Provider,{value:l},a)}function T4(l,n=[],a=null,o=null,s=null){if(l==null){if(!a)return null;if(a.errors)l=a.matches;else if(n.length===0&&!a.initialized&&a.matches.length>0)l=a.matches;else return null}let e=l,m=a?.errors;if(m!=null){let S=e.findIndex(D=>D.route.id&&m?.[D.route.id]!==void 0);Qr(S>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(m).join(",")}`),e=e.slice(0,Math.min(e.length,S+1))}let v=!1,w=-1;if(a)for(let S=0;S<e.length;S++){let D=e[S];if((D.route.HydrateFallback||D.route.hydrateFallbackElement)&&(w=S),D.route.id){let{loaderData:L,errors:M}=a,F=D.route.loader&&!L.hasOwnProperty(D.route.id)&&(!M||M[D.route.id]===void 0);if(D.route.lazy||F){v=!0,w>=0?e=e.slice(0,w+1):e=[e[0]];break}}}let N=a&&o?(S,D)=>{o(S,{location:a.location,params:a.matches?.[0]?.params??{},unstable_pattern:h4(a.matches),errorInfo:D})}:void 0;return e.reduceRight((S,D,L)=>{let M,F=!1,O=null,P=null;a&&(M=m&&D.route.id?m[D.route.id]:void 0,O=D.route.errorElement||A4,v&&(w<0&&L===0?(Xb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),F=!0,P=null):w===L&&(F=!0,P=D.route.hydrateFallbackElement||null)));let K=n.concat(e.slice(0,L+1)),ne=()=>{let se;return M?se=O:F?se=P:D.route.Component?se=B.createElement(D.route.Component,null):D.route.element?se=D.route.element:se=S,B.createElement(D4,{match:D,routeContext:{outlet:S,matches:K,isDataRoute:a!=null},children:se})};return a&&(D.route.ErrorBoundary||D.route.errorElement||L===0)?B.createElement(Qb,{location:a.location,revalidation:a.revalidation,component:O,error:M,children:ne(),routeContext:{outlet:null,matches:K,isDataRoute:!0},onError:N}):ne()},null)}function ax(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _4(l){let n=B.useContext(eh);return Qr(n,ax(l)),n}function F4(l){let n=B.useContext(Cp);return Qr(n,ax(l)),n}function M4(l){let n=B.useContext(Fi);return Qr(n,ax(l)),n}function nx(l){let n=M4(l),a=n.matches[n.matches.length-1];return Qr(a.route.id,`${l} can only be used on routes that contain a unique "id"`),a.route.id}function L4(){return nx("useRouteId")}function R4(){let l=B.useContext(rx),n=F4("useRouteError"),a=nx("useRouteError");return l!==void 0?l:n.errors?.[a]}function O4(){let{router:l}=_4("useNavigate"),n=nx("useNavigate"),a=B.useRef(!1);return Gb(()=>{a.current=!0}),B.useCallback(async(s,e={})=>{oi(a.current,Yb),a.current&&(typeof s=="number"?await l.navigate(s):await l.navigate(s,{fromRouteId:n,...e}))},[l,n])}var zx={};function Xb(l,n,a){!n&&!zx[l]&&(zx[l]=!0,oi(!1,a))}B.memo(P4);function P4({routes:l,future:n,state:a,onError:o}){return Kb(l,void 0,a,o,n)}function Jb({to:l,replace:n,state:a,relative:o}){Qr(th(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=B.useContext(ci);oi(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:e}=B.useContext(Fi),{pathname:m}=Ul(),v=Dr(),w=sx(l,tx(e),m,o==="path"),N=JSON.stringify(w);return B.useEffect(()=>{v(JSON.parse(N),{replace:n,state:a,relative:o})},[v,N,o,n,a]),null}function I4(l){return k4(l.context)}function vr(l){Qr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function B4({basename:l="/",children:n=null,location:a,navigationType:o="POP",navigator:s,static:e=!1,unstable_useTransitions:m}){Qr(!th(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let v=l.replace(/^\/*/,"/"),w=B.useMemo(()=>({basename:v,navigator:s,static:e,unstable_useTransitions:m,future:{}}),[v,s,e,m]);typeof a=="string"&&(a=Zu(a));let{pathname:N="/",search:S="",hash:D="",state:L=null,key:M="default"}=a,F=B.useMemo(()=>{let O=Oo(N,v);return O==null?null:{location:{pathname:O,search:S,hash:D,state:L,key:M},navigationType:o}},[v,N,S,D,L,M,o]);return oi(F!=null,`<Router basename="${v}"> is not able to match the URL "${N}${S}${D}" because it does not start with the basename, so the <Router> won't render anything.`),F==null?null:B.createElement(ci.Provider,{value:w},B.createElement(hm.Provider,{children:n,value:F}))}function z4({children:l,location:n}){return C4(z1(l),n)}function z1(l,n=[]){let a=[];return B.Children.forEach(l,(o,s)=>{if(!B.isValidElement(o))return;let e=[...n,s];if(o.type===B.Fragment){a.push.apply(a,z1(o.props.children,e));return}Qr(o.type===vr,`[${typeof o.type=="string"?o.type:o.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qr(!o.props.index||!o.props.children,"An index route cannot have child routes.");let m={id:o.props.id||e.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,middleware:o.props.middleware,loader:o.props.loader,action:o.props.action,hydrateFallbackElement:o.props.hydrateFallbackElement,HydrateFallback:o.props.HydrateFallback,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.hasErrorBoundary===!0||o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(m.children=z1(o.props.children,e)),a.push(m)}),a}var lp="get",op="application/x-www-form-urlencoded";function Sp(l){return typeof HTMLElement<"u"&&l instanceof HTMLElement}function U4(l){return Sp(l)&&l.tagName.toLowerCase()==="button"}function H4(l){return Sp(l)&&l.tagName.toLowerCase()==="form"}function V4(l){return Sp(l)&&l.tagName.toLowerCase()==="input"}function W4(l){return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}function $4(l,n){return l.button===0&&(!n||n==="_self")&&!W4(l)}function U1(l=""){return new URLSearchParams(typeof l=="string"||Array.isArray(l)||l instanceof URLSearchParams?l:Object.keys(l).reduce((n,a)=>{let o=l[a];return n.concat(Array.isArray(o)?o.map(s=>[a,s]):[[a,o]])},[]))}function q4(l,n){let a=U1(l);return n&&n.forEach((o,s)=>{a.has(s)||n.getAll(s).forEach(e=>{a.append(s,e)})}),a}var Hg=null;function Y4(){if(Hg===null)try{new FormData(document.createElement("form"),0),Hg=!1}catch{Hg=!0}return Hg}var G4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function h1(l){return l!=null&&!G4.has(l)?(oi(!1,`"${l}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${op}"`),null):l}function K4(l,n){let a,o,s,e,m;if(H4(l)){let v=l.getAttribute("action");o=v?Oo(v,n):null,a=l.getAttribute("method")||lp,s=h1(l.getAttribute("enctype"))||op,e=new FormData(l)}else if(U4(l)||V4(l)&&(l.type==="submit"||l.type==="image")){let v=l.form;if(v==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let w=l.getAttribute("formaction")||v.getAttribute("action");if(o=w?Oo(w,n):null,a=l.getAttribute("formmethod")||v.getAttribute("method")||lp,s=h1(l.getAttribute("formenctype"))||h1(v.getAttribute("enctype"))||op,e=new FormData(v,l),!Y4()){let{name:N,type:S,value:D}=l;if(S==="image"){let L=N?`${N}.`:"";e.append(`${L}x`,"0"),e.append(`${L}y`,"0")}else N&&e.append(N,D)}}else{if(Sp(l))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=lp,o=null,s=op,m=l}return e&&s==="text/plain"&&(m=e,e=void 0),{action:o,method:a.toLowerCase(),encType:s,formData:e,body:m}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ix(l,n){if(l===!1||l===null||typeof l>"u")throw new Error(n)}function Q4(l,n,a){let o=typeof l=="string"?new URL(l,typeof window>"u"?"server://singlefetch/":window.location.origin):l;return o.pathname==="/"?o.pathname=`_root.${a}`:n&&Oo(o.pathname,n)==="/"?o.pathname=`${n.replace(/\/$/,"")}/_root.${a}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${a}`,o}async function X4(l,n){if(l.id in n)return n[l.id];try{let a=await import(l.module);return n[l.id]=a,a}catch(a){return console.error(`Error loading route module \`${l.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function J4(l){return l==null?!1:l.href==null?l.rel==="preload"&&typeof l.imageSrcSet=="string"&&typeof l.imageSizes=="string":typeof l.rel=="string"&&typeof l.href=="string"}async function Z4(l,n,a){let o=await Promise.all(l.map(async s=>{let e=n.routes[s.route.id];if(e){let m=await X4(e,a);return m.links?m.links():[]}return[]}));return rw(o.flat(1).filter(J4).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Ux(l,n,a,o,s,e){let m=(w,N)=>a[N]?w.route.id!==a[N].route.id:!0,v=(w,N)=>a[N].pathname!==w.pathname||a[N].route.path?.endsWith("*")&&a[N].params["*"]!==w.params["*"];return e==="assets"?n.filter((w,N)=>m(w,N)||v(w,N)):e==="data"?n.filter((w,N)=>{let S=o.routes[w.route.id];if(!S||!S.hasLoader)return!1;if(m(w,N)||v(w,N))return!0;if(w.route.shouldRevalidate){let D=w.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:a[0]?.params||{},nextUrl:new URL(l,window.origin),nextParams:w.params,defaultShouldRevalidate:!0});if(typeof D=="boolean")return D}return!0}):[]}function ew(l,n,{includeHydrateFallback:a}={}){return tw(l.map(o=>{let s=n.routes[o.route.id];if(!s)return[];let e=[s.module];return s.clientActionModule&&(e=e.concat(s.clientActionModule)),s.clientLoaderModule&&(e=e.concat(s.clientLoaderModule)),a&&s.hydrateFallbackModule&&(e=e.concat(s.hydrateFallbackModule)),s.imports&&(e=e.concat(s.imports)),e}).flat(1))}function tw(l){return[...new Set(l)]}function sw(l){let n={},a=Object.keys(l).sort();for(let o of a)n[o]=l[o];return n}function rw(l,n){let a=new Set;return new Set(n),l.reduce((o,s)=>{let e=JSON.stringify(sw(s));return a.has(e)||(a.add(e),o.push({key:e,link:s})),o},[])}function Zb(){let l=B.useContext(eh);return ix(l,"You must render this element inside a <DataRouterContext.Provider> element"),l}function aw(){let l=B.useContext(Cp);return ix(l,"You must render this element inside a <DataRouterStateContext.Provider> element"),l}var lx=B.createContext(void 0);lx.displayName="FrameworkContext";function ey(){let l=B.useContext(lx);return ix(l,"You must render this element inside a <HydratedRouter> element"),l}function nw(l,n){let a=B.useContext(lx),[o,s]=B.useState(!1),[e,m]=B.useState(!1),{onFocus:v,onBlur:w,onMouseEnter:N,onMouseLeave:S,onTouchStart:D}=n,L=B.useRef(null);B.useEffect(()=>{if(l==="render"&&m(!0),l==="viewport"){let O=K=>{K.forEach(ne=>{m(ne.isIntersecting)})},P=new IntersectionObserver(O,{threshold:.5});return L.current&&P.observe(L.current),()=>{P.disconnect()}}},[l]),B.useEffect(()=>{if(o){let O=setTimeout(()=>{m(!0)},100);return()=>{clearTimeout(O)}}},[o]);let M=()=>{s(!0)},F=()=>{s(!1),m(!1)};return a?l!=="intent"?[e,L,{}]:[e,L,{onFocus:Hf(v,M),onBlur:Hf(w,F),onMouseEnter:Hf(N,M),onMouseLeave:Hf(S,F),onTouchStart:Hf(D,M)}]:[!1,L,{}]}function Hf(l,n){return a=>{l&&l(a),a.defaultPrevented||n(a)}}function iw({page:l,...n}){let{router:a}=Zb(),o=B.useMemo(()=>Ib(a.routes,l,a.basename),[a.routes,l,a.basename]);return o?B.createElement(ow,{page:l,matches:o,...n}):null}function lw(l){let{manifest:n,routeModules:a}=ey(),[o,s]=B.useState([]);return B.useEffect(()=>{let e=!1;return Z4(l,n,a).then(m=>{e||s(m)}),()=>{e=!0}},[l,n,a]),o}function ow({page:l,matches:n,...a}){let o=Ul(),{manifest:s,routeModules:e}=ey(),{basename:m}=Zb(),{loaderData:v,matches:w}=aw(),N=B.useMemo(()=>Ux(l,n,w,s,o,"data"),[l,n,w,s,o]),S=B.useMemo(()=>Ux(l,n,w,s,o,"assets"),[l,n,w,s,o]),D=B.useMemo(()=>{if(l===o.pathname+o.search+o.hash)return[];let F=new Set,O=!1;if(n.forEach(K=>{let ne=s.routes[K.route.id];!ne||!ne.hasLoader||(!N.some(se=>se.route.id===K.route.id)&&K.route.id in v&&e[K.route.id]?.shouldRevalidate||ne.hasClientLoader?O=!0:F.add(K.route.id))}),F.size===0)return[];let P=Q4(l,m,"data");return O&&F.size>0&&P.searchParams.set("_routes",n.filter(K=>F.has(K.route.id)).map(K=>K.route.id).join(",")),[P.pathname+P.search]},[m,v,o,s,N,n,l,e]),L=B.useMemo(()=>ew(S,s),[S,s]),M=lw(S);return B.createElement(B.Fragment,null,D.map(F=>B.createElement("link",{key:F,rel:"prefetch",as:"fetch",href:F,...a})),L.map(F=>B.createElement("link",{key:F,rel:"modulepreload",href:F,...a})),M.map(({key:F,link:O})=>B.createElement("link",{key:F,nonce:a.nonce,...O})))}function cw(...l){return n=>{l.forEach(a=>{typeof a=="function"?a(n):a!=null&&(a.current=n)})}}var dw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{dw&&(window.__reactRouterVersion="7.11.0")}catch{}function uw({basename:l,children:n,unstable_useTransitions:a,window:o}){let s=B.useRef();s.current==null&&(s.current=Uv({window:o,v5Compat:!0}));let e=s.current,[m,v]=B.useState({action:e.action,location:e.location}),w=B.useCallback(N=>{a===!1?v(N):B.startTransition(()=>v(N))},[a]);return B.useLayoutEffect(()=>e.listen(w),[e,w]),B.createElement(B4,{basename:l,children:n,location:m.location,navigationType:m.action,navigator:e,unstable_useTransitions:a})}var ty=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sy=B.forwardRef(function({onClick:n,discover:a="render",prefetch:o="none",relative:s,reloadDocument:e,replace:m,state:v,target:w,to:N,preventScrollReset:S,viewTransition:D,unstable_defaultShouldRevalidate:L,...M},F){let{basename:O,unstable_useTransitions:P}=B.useContext(ci),K=typeof N=="string"&&ty.test(N),ne=Vb(N,O);N=ne.to;let se=w4(N,{relative:s}),[Ce,ge,Ne]=nw(o,M),J=gw(N,{replace:m,state:v,target:w,preventScrollReset:S,relative:s,viewTransition:D,unstable_defaultShouldRevalidate:L,unstable_useTransitions:P});function de(ze){n&&n(ze),ze.defaultPrevented||J(ze)}let le=B.createElement("a",{...M,...Ne,href:ne.absoluteURL||se,onClick:ne.isExternal||e?n:de,ref:cw(F,ge),target:w,"data-discover":!K&&a==="render"?"true":void 0});return Ce&&!K?B.createElement(B.Fragment,null,le,B.createElement(iw,{page:se})):le});sy.displayName="Link";var hw=B.forwardRef(function({"aria-current":n="page",caseSensitive:a=!1,className:o="",end:s=!1,style:e,to:m,viewTransition:v,children:w,...N},S){let D=fm(m,{relative:N.relative}),L=Ul(),M=B.useContext(Cp),{navigator:F,basename:O}=B.useContext(ci),P=M!=null&&vw(D)&&v===!0,K=F.encodeLocation?F.encodeLocation(D).pathname:D.pathname,ne=L.pathname,se=M&&M.navigation&&M.navigation.location?M.navigation.location.pathname:null;a||(ne=ne.toLowerCase(),se=se?se.toLowerCase():null,K=K.toLowerCase()),se&&O&&(se=Oo(se,O)||se);const Ce=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let ge=ne===K||!s&&ne.startsWith(K)&&ne.charAt(Ce)==="/",Ne=se!=null&&(se===K||!s&&se.startsWith(K)&&se.charAt(K.length)==="/"),J={isActive:ge,isPending:Ne,isTransitioning:P},de=ge?n:void 0,le;typeof o=="function"?le=o(J):le=[o,ge?"active":null,Ne?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let ze=typeof e=="function"?e(J):e;return B.createElement(sy,{...N,"aria-current":de,className:le,ref:S,style:ze,to:m,viewTransition:v},typeof w=="function"?w(J):w)});hw.displayName="NavLink";var fw=B.forwardRef(({discover:l="render",fetcherKey:n,navigate:a,reloadDocument:o,replace:s,state:e,method:m=lp,action:v,onSubmit:w,relative:N,preventScrollReset:S,viewTransition:D,unstable_defaultShouldRevalidate:L,...M},F)=>{let{unstable_useTransitions:O}=B.useContext(ci),P=bw(),K=yw(v,{relative:N}),ne=m.toLowerCase()==="get"?"get":"post",se=typeof v=="string"&&ty.test(v),Ce=ge=>{if(w&&w(ge),ge.defaultPrevented)return;ge.preventDefault();let Ne=ge.nativeEvent.submitter,J=Ne?.getAttribute("formmethod")||m,de=()=>P(Ne||ge.currentTarget,{fetcherKey:n,method:J,navigate:a,replace:s,state:e,relative:N,preventScrollReset:S,viewTransition:D,unstable_defaultShouldRevalidate:L});O&&a!==!1?B.startTransition(()=>de()):de()};return B.createElement("form",{ref:F,method:ne,action:K,onSubmit:o?w:Ce,...M,"data-discover":!se&&l==="render"?"true":void 0})});fw.displayName="Form";function mw(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ry(l){let n=B.useContext(eh);return Qr(n,mw(l)),n}function gw(l,{target:n,replace:a,state:o,preventScrollReset:s,relative:e,viewTransition:m,unstable_defaultShouldRevalidate:v,unstable_useTransitions:w}={}){let N=Dr(),S=Ul(),D=fm(l,{relative:e});return B.useCallback(L=>{if($4(L,n)){L.preventDefault();let M=a!==void 0?a:am(S)===am(D),F=()=>N(l,{replace:M,state:o,preventScrollReset:s,relative:e,viewTransition:m,unstable_defaultShouldRevalidate:v});w?B.startTransition(()=>F()):F()}},[S,N,D,a,o,n,l,s,e,m,v,w])}function i0(l){oi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let n=B.useRef(U1(l)),a=B.useRef(!1),o=Ul(),s=B.useMemo(()=>q4(o.search,a.current?null:n.current),[o.search]),e=Dr(),m=B.useCallback((v,w)=>{const N=U1(typeof v=="function"?v(new URLSearchParams(s)):v);a.current=!0,e("?"+N,w)},[e,s]);return[s,m]}var pw=0,xw=()=>`__${String(++pw)}__`;function bw(){let{router:l}=ry("useSubmit"),{basename:n}=B.useContext(ci),a=L4(),o=l.fetch,s=l.navigate;return B.useCallback(async(e,m={})=>{let{action:v,method:w,encType:N,formData:S,body:D}=K4(e,n);if(m.navigate===!1){let L=m.fetcherKey||xw();await o(L,a,m.action||v,{unstable_defaultShouldRevalidate:m.unstable_defaultShouldRevalidate,preventScrollReset:m.preventScrollReset,formData:S,body:D,formMethod:m.method||w,formEncType:m.encType||N,flushSync:m.flushSync})}else await s(m.action||v,{unstable_defaultShouldRevalidate:m.unstable_defaultShouldRevalidate,preventScrollReset:m.preventScrollReset,formData:S,body:D,formMethod:m.method||w,formEncType:m.encType||N,replace:m.replace,state:m.state,fromRouteId:a,flushSync:m.flushSync,viewTransition:m.viewTransition})},[o,s,n,a])}function yw(l,{relative:n}={}){let{basename:a}=B.useContext(ci),o=B.useContext(Fi);Qr(o,"useFormAction must be used inside a RouteContext");let[s]=o.matches.slice(-1),e={...fm(l||".",{relative:n})},m=Ul();if(l==null){e.search=m.search;let v=new URLSearchParams(e.search),w=v.getAll("index");if(w.some(S=>S==="")){v.delete("index"),w.filter(D=>D).forEach(D=>v.append("index",D));let S=v.toString();e.search=S?`?${S}`:""}}return(!l||l===".")&&s.route.index&&(e.search=e.search?e.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(e.pathname=e.pathname==="/"?a:Ro([a,e.pathname])),am(e)}function vw(l,{relative:n}={}){let a=B.useContext($b);Qr(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=ry("useViewTransitionState"),s=fm(l,{relative:n});if(!a.isTransitioning)return!1;let e=Oo(a.currentLocation.pathname,o)||a.currentLocation.pathname,m=Oo(a.nextLocation.pathname,o)||a.nextLocation.pathname;return pp(s.pathname,m)!=null||pp(s.pathname,e)!=null}const f1=[{id:"analytical-dashboard",label:"Dashboard",path:"/projects/dashboard",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{id:"project-management",label:"Project Management",path:"/projects",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}];function ww({isOpen:l=!1,onClose:n}){const a=Ul(),o=Dr(),s=[{id:"dashboard",label:"Dashboard",path:"/dashboard",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})},{id:"contacts",label:"Contacts",path:"/contacts",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{id:"import",label:"Import",path:"/import",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}],e={label:"Master Dashboard",path:"/master-dashboard",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},m=F=>F==="/dashboard"||F==="/"?a.pathname==="/dashboard"||a.pathname==="/":F==="/master-dashboard"?a.pathname==="/master-dashboard":F==="/projects/dashboard"?a.pathname==="/projects/dashboard":F==="/projects"?a.pathname==="/projects"||a.pathname.startsWith("/projects/")&&a.pathname!=="/projects/dashboard"&&!a.pathname.startsWith("/projects/dashboard/"):a.pathname.startsWith(F),v=s.some(F=>m(F.path)),[w,N]=B.useState(v),S=f1.some(F=>m(F.path)),[D,L]=B.useState(S);B.useEffect(()=>{s.some(O=>m(O.path))&&N(!0)},[a.pathname]),B.useEffect(()=>{f1.some(O=>m(O.path))&&L(!0)},[a.pathname]);const M=F=>{o(F),n&&n()};return t.jsxs("div",{className:`
      w-64 bg-white border-r border-gray-200 h-screen flex flex-col fixed left-0 top-0 z-50
      transform transition-transform duration-300 ease-in-out
      lg:translate-x-0
      ${l?"translate-x-0":"-translate-x-full"}
    `,children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded flex items-center justify-center flex-shrink-0",children:t.jsx("div",{className:"w-5 h-5 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-2.5 h-2.5 bg-blue-600 rounded-full"})})}),t.jsx("span",{className:"text-base font-semibold text-gray-900",children:"Outbound SaaS"})]}),t.jsx("button",{onClick:n,className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-600 hover:bg-gray-100","aria-label":"Close menu",children:t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("nav",{className:"flex-1 px-4 py-4 overflow-y-auto",children:t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>N(!w),className:"w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),t.jsx("span",{className:"text-sm font-medium",children:"Databank"})]}),t.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${w?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),w&&t.jsx("div",{className:"ml-4 mt-1 space-y-1 border-l-2 border-gray-200 pl-2",children:s.map(F=>{const O=m(F.path);return t.jsxs("button",{onClick:()=>M(F.path==="/dashboard"?"/":F.path),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${O?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:O?"text-blue-600":"text-gray-500",children:F.icon}),t.jsx("span",{className:`text-sm font-medium ${O?"text-blue-600":"text-gray-700"}`,children:F.label})]},F.id)})})]}),t.jsxs("div",{className:"mt-2",children:[t.jsxs("button",{onClick:()=>L(!D),className:"w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),t.jsx("span",{className:"text-sm font-medium",children:"Projects"})]}),t.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${D?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),D&&t.jsx("div",{className:"ml-4 mt-1 space-y-1 border-l-2 border-gray-200 pl-2",children:f1.map(F=>{const O=m(F.path);return t.jsxs("button",{onClick:()=>M(F.path),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${O?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:O?"text-blue-600":"text-gray-500",children:F.icon}),t.jsx("span",{className:`text-sm font-medium ${O?"text-blue-600":"text-gray-700"}`,children:F.label})]},F.id)})})]}),t.jsx("div",{className:"mt-2",children:t.jsxs("button",{onClick:()=>M(e.path),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${m(e.path)?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:m(e.path)?"text-blue-600":"text-gray-500",children:e.icon}),t.jsx("span",{className:`text-sm font-medium ${m(e.path)?"text-blue-600":"text-gray-700"}`,children:e.label})]})}),t.jsx("div",{className:"mt-2",children:t.jsxs("button",{onClick:()=>M("/employee-performance"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${m("/employee-performance")?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:m("/employee-performance")?"text-blue-600":"text-gray-500",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),t.jsx("span",{className:`text-sm font-medium ${m("/employee-performance")?"text-blue-600":"text-gray-700"}`,children:"Employee Performance"})]})})]})}),t.jsxs("div",{className:"px-4 py-4 border-t border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-sm font-semibold text-blue-700",children:(()=>{const F=JSON.parse(localStorage.getItem("user")||"{}");return F.name?F.name.charAt(0).toUpperCase():"U"})()})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(()=>{const F=JSON.parse(localStorage.getItem("user")||"{}");return F.name||F.email||"User"})()}),t.jsx("p",{className:"text-xs text-gray-500 truncate",children:JSON.parse(localStorage.getItem("user")||"{}").email||""})]})]}),t.jsxs("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),o("/login")},className:"w-full flex items-center gap-2 px-3 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})]})}function jw(){const l=localStorage.getItem("token"),[n,a]=B.useState(!1);return l?t.jsxs("div",{className:"flex h-screen bg-gray-50",children:[n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>a(!1)}),t.jsx(ww,{isOpen:n,onClose:()=>a(!1)}),t.jsxs("main",{className:"flex-1 lg:ml-64 overflow-y-auto",children:[t.jsxs("div",{className:"lg:hidden sticky top-0 z-30 bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>a(!n),className:"p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500","aria-label":"Toggle menu",children:t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded flex items-center justify-center flex-shrink-0",children:t.jsx("div",{className:"w-5 h-5 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-2.5 h-2.5 bg-blue-600 rounded-full"})})}),t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Outbound SaaS"})]})]}),t.jsx(I4,{context:{setSidebarOpen:a}})]})]}):t.jsx(Jb,{to:"/login",replace:!0})}function ay(l,n){return function(){return l.apply(n,arguments)}}const{toString:Nw}=Object.prototype,{getPrototypeOf:ox}=Object,{iterator:Ap,toStringTag:ny}=Symbol,Ep=(l=>n=>{const a=Nw.call(n);return l[a]||(l[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),ol=l=>(l=l.toLowerCase(),n=>Ep(n)===l),Dp=l=>n=>typeof n===l,{isArray:sh}=Array,Ku=Dp("undefined");function mm(l){return l!==null&&!Ku(l)&&l.constructor!==null&&!Ku(l.constructor)&&$n(l.constructor.isBuffer)&&l.constructor.isBuffer(l)}const iy=ol("ArrayBuffer");function kw(l){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(l):n=l&&l.buffer&&iy(l.buffer),n}const Cw=Dp("string"),$n=Dp("function"),ly=Dp("number"),gm=l=>l!==null&&typeof l=="object",Sw=l=>l===!0||l===!1,cp=l=>{if(Ep(l)!=="object")return!1;const n=ox(l);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(ny in l)&&!(Ap in l)},Aw=l=>{if(!gm(l)||mm(l))return!1;try{return Object.keys(l).length===0&&Object.getPrototypeOf(l)===Object.prototype}catch{return!1}},Ew=ol("Date"),Dw=ol("File"),Tw=ol("Blob"),_w=ol("FileList"),Fw=l=>gm(l)&&$n(l.pipe),Mw=l=>{let n;return l&&(typeof FormData=="function"&&l instanceof FormData||$n(l.append)&&((n=Ep(l))==="formdata"||n==="object"&&$n(l.toString)&&l.toString()==="[object FormData]"))},Lw=ol("URLSearchParams"),[Rw,Ow,Pw,Iw]=["ReadableStream","Request","Response","Headers"].map(ol),Bw=l=>l.trim?l.trim():l.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function pm(l,n,{allOwnKeys:a=!1}={}){if(l===null||typeof l>"u")return;let o,s;if(typeof l!="object"&&(l=[l]),sh(l))for(o=0,s=l.length;o<s;o++)n.call(null,l[o],o,l);else{if(mm(l))return;const e=a?Object.getOwnPropertyNames(l):Object.keys(l),m=e.length;let v;for(o=0;o<m;o++)v=e[o],n.call(null,l[v],v,l)}}function oy(l,n){if(mm(l))return null;n=n.toLowerCase();const a=Object.keys(l);let o=a.length,s;for(;o-- >0;)if(s=a[o],n===s.toLowerCase())return s;return null}const Jd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,cy=l=>!Ku(l)&&l!==Jd;function H1(){const{caseless:l,skipUndefined:n}=cy(this)&&this||{},a={},o=(s,e)=>{const m=l&&oy(a,e)||e;cp(a[m])&&cp(s)?a[m]=H1(a[m],s):cp(s)?a[m]=H1({},s):sh(s)?a[m]=s.slice():(!n||!Ku(s))&&(a[m]=s)};for(let s=0,e=arguments.length;s<e;s++)arguments[s]&&pm(arguments[s],o);return a}const zw=(l,n,a,{allOwnKeys:o}={})=>(pm(n,(s,e)=>{a&&$n(s)?l[e]=ay(s,a):l[e]=s},{allOwnKeys:o}),l),Uw=l=>(l.charCodeAt(0)===65279&&(l=l.slice(1)),l),Hw=(l,n,a,o)=>{l.prototype=Object.create(n.prototype,o),l.prototype.constructor=l,Object.defineProperty(l,"super",{value:n.prototype}),a&&Object.assign(l.prototype,a)},Vw=(l,n,a,o)=>{let s,e,m;const v={};if(n=n||{},l==null)return n;do{for(s=Object.getOwnPropertyNames(l),e=s.length;e-- >0;)m=s[e],(!o||o(m,l,n))&&!v[m]&&(n[m]=l[m],v[m]=!0);l=a!==!1&&ox(l)}while(l&&(!a||a(l,n))&&l!==Object.prototype);return n},Ww=(l,n,a)=>{l=String(l),(a===void 0||a>l.length)&&(a=l.length),a-=n.length;const o=l.indexOf(n,a);return o!==-1&&o===a},$w=l=>{if(!l)return null;if(sh(l))return l;let n=l.length;if(!ly(n))return null;const a=new Array(n);for(;n-- >0;)a[n]=l[n];return a},qw=(l=>n=>l&&n instanceof l)(typeof Uint8Array<"u"&&ox(Uint8Array)),Yw=(l,n)=>{const o=(l&&l[Ap]).call(l);let s;for(;(s=o.next())&&!s.done;){const e=s.value;n.call(l,e[0],e[1])}},Gw=(l,n)=>{let a;const o=[];for(;(a=l.exec(n))!==null;)o.push(a);return o},Kw=ol("HTMLFormElement"),Qw=l=>l.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,o,s){return o.toUpperCase()+s}),Hx=(({hasOwnProperty:l})=>(n,a)=>l.call(n,a))(Object.prototype),Xw=ol("RegExp"),dy=(l,n)=>{const a=Object.getOwnPropertyDescriptors(l),o={};pm(a,(s,e)=>{let m;(m=n(s,e,l))!==!1&&(o[e]=m||s)}),Object.defineProperties(l,o)},Jw=l=>{dy(l,(n,a)=>{if($n(l)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const o=l[a];if($n(o)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},Zw=(l,n)=>{const a={},o=s=>{s.forEach(e=>{a[e]=!0})};return sh(l)?o(l):o(String(l).split(n)),a},e5=()=>{},t5=(l,n)=>l!=null&&Number.isFinite(l=+l)?l:n;function s5(l){return!!(l&&$n(l.append)&&l[ny]==="FormData"&&l[Ap])}const r5=l=>{const n=new Array(10),a=(o,s)=>{if(gm(o)){if(n.indexOf(o)>=0)return;if(mm(o))return o;if(!("toJSON"in o)){n[s]=o;const e=sh(o)?[]:{};return pm(o,(m,v)=>{const w=a(m,s+1);!Ku(w)&&(e[v]=w)}),n[s]=void 0,e}}return o};return a(l,0)},a5=ol("AsyncFunction"),n5=l=>l&&(gm(l)||$n(l))&&$n(l.then)&&$n(l.catch),uy=((l,n)=>l?setImmediate:n?((a,o)=>(Jd.addEventListener("message",({source:s,data:e})=>{s===Jd&&e===a&&o.length&&o.shift()()},!1),s=>{o.push(s),Jd.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",$n(Jd.postMessage)),i5=typeof queueMicrotask<"u"?queueMicrotask.bind(Jd):typeof process<"u"&&process.nextTick||uy,l5=l=>l!=null&&$n(l[Ap]),ut={isArray:sh,isArrayBuffer:iy,isBuffer:mm,isFormData:Mw,isArrayBufferView:kw,isString:Cw,isNumber:ly,isBoolean:Sw,isObject:gm,isPlainObject:cp,isEmptyObject:Aw,isReadableStream:Rw,isRequest:Ow,isResponse:Pw,isHeaders:Iw,isUndefined:Ku,isDate:Ew,isFile:Dw,isBlob:Tw,isRegExp:Xw,isFunction:$n,isStream:Fw,isURLSearchParams:Lw,isTypedArray:qw,isFileList:_w,forEach:pm,merge:H1,extend:zw,trim:Bw,stripBOM:Uw,inherits:Hw,toFlatObject:Vw,kindOf:Ep,kindOfTest:ol,endsWith:Ww,toArray:$w,forEachEntry:Yw,matchAll:Gw,isHTMLForm:Kw,hasOwnProperty:Hx,hasOwnProp:Hx,reduceDescriptors:dy,freezeMethods:Jw,toObjectSet:Zw,toCamelCase:Qw,noop:e5,toFiniteNumber:t5,findKey:oy,global:Jd,isContextDefined:cy,isSpecCompliantForm:s5,toJSONObject:r5,isAsyncFn:a5,isThenable:n5,setImmediate:uy,asap:i5,isIterable:l5};function Ls(l,n,a,o,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=l,this.name="AxiosError",n&&(this.code=n),a&&(this.config=a),o&&(this.request=o),s&&(this.response=s,this.status=s.status?s.status:null)}ut.inherits(Ls,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ut.toJSONObject(this.config),code:this.code,status:this.status}}});const hy=Ls.prototype,fy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(l=>{fy[l]={value:l}});Object.defineProperties(Ls,fy);Object.defineProperty(hy,"isAxiosError",{value:!0});Ls.from=(l,n,a,o,s,e)=>{const m=Object.create(hy);ut.toFlatObject(l,m,function(S){return S!==Error.prototype},N=>N!=="isAxiosError");const v=l&&l.message?l.message:"Error",w=n==null&&l?l.code:n;return Ls.call(m,v,w,a,o,s),l&&m.cause==null&&Object.defineProperty(m,"cause",{value:l,configurable:!0}),m.name=l&&l.name||"Error",e&&Object.assign(m,e),m};const o5=null;function V1(l){return ut.isPlainObject(l)||ut.isArray(l)}function my(l){return ut.endsWith(l,"[]")?l.slice(0,-2):l}function Vx(l,n,a){return l?l.concat(n).map(function(s,e){return s=my(s),!a&&e?"["+s+"]":s}).join(a?".":""):n}function c5(l){return ut.isArray(l)&&!l.some(V1)}const d5=ut.toFlatObject(ut,{},null,function(n){return/^is[A-Z]/.test(n)});function Tp(l,n,a){if(!ut.isObject(l))throw new TypeError("target must be an object");n=n||new FormData,a=ut.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(O,P){return!ut.isUndefined(P[O])});const o=a.metaTokens,s=a.visitor||S,e=a.dots,m=a.indexes,w=(a.Blob||typeof Blob<"u"&&Blob)&&ut.isSpecCompliantForm(n);if(!ut.isFunction(s))throw new TypeError("visitor must be a function");function N(F){if(F===null)return"";if(ut.isDate(F))return F.toISOString();if(ut.isBoolean(F))return F.toString();if(!w&&ut.isBlob(F))throw new Ls("Blob is not supported. Use a Buffer instead.");return ut.isArrayBuffer(F)||ut.isTypedArray(F)?w&&typeof Blob=="function"?new Blob([F]):Buffer.from(F):F}function S(F,O,P){let K=F;if(F&&!P&&typeof F=="object"){if(ut.endsWith(O,"{}"))O=o?O:O.slice(0,-2),F=JSON.stringify(F);else if(ut.isArray(F)&&c5(F)||(ut.isFileList(F)||ut.endsWith(O,"[]"))&&(K=ut.toArray(F)))return O=my(O),K.forEach(function(se,Ce){!(ut.isUndefined(se)||se===null)&&n.append(m===!0?Vx([O],Ce,e):m===null?O:O+"[]",N(se))}),!1}return V1(F)?!0:(n.append(Vx(P,O,e),N(F)),!1)}const D=[],L=Object.assign(d5,{defaultVisitor:S,convertValue:N,isVisitable:V1});function M(F,O){if(!ut.isUndefined(F)){if(D.indexOf(F)!==-1)throw Error("Circular reference detected in "+O.join("."));D.push(F),ut.forEach(F,function(K,ne){(!(ut.isUndefined(K)||K===null)&&s.call(n,K,ut.isString(ne)?ne.trim():ne,O,L))===!0&&M(K,O?O.concat(ne):[ne])}),D.pop()}}if(!ut.isObject(l))throw new TypeError("data must be an object");return M(l),n}function Wx(l){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(l).replace(/[!'()~]|%20|%00/g,function(o){return n[o]})}function cx(l,n){this._pairs=[],l&&Tp(l,this,n)}const gy=cx.prototype;gy.append=function(n,a){this._pairs.push([n,a])};gy.toString=function(n){const a=n?function(o){return n.call(this,o,Wx)}:Wx;return this._pairs.map(function(s){return a(s[0])+"="+a(s[1])},"").join("&")};function u5(l){return encodeURIComponent(l).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function py(l,n,a){if(!n)return l;const o=a&&a.encode||u5;ut.isFunction(a)&&(a={serialize:a});const s=a&&a.serialize;let e;if(s?e=s(n,a):e=ut.isURLSearchParams(n)?n.toString():new cx(n,a).toString(o),e){const m=l.indexOf("#");m!==-1&&(l=l.slice(0,m)),l+=(l.indexOf("?")===-1?"?":"&")+e}return l}class $x{constructor(){this.handlers=[]}use(n,a,o){return this.handlers.push({fulfilled:n,rejected:a,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){ut.forEach(this.handlers,function(o){o!==null&&n(o)})}}const xy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},h5=typeof URLSearchParams<"u"?URLSearchParams:cx,f5=typeof FormData<"u"?FormData:null,m5=typeof Blob<"u"?Blob:null,g5={isBrowser:!0,classes:{URLSearchParams:h5,FormData:f5,Blob:m5},protocols:["http","https","file","blob","url","data"]},dx=typeof window<"u"&&typeof document<"u",W1=typeof navigator=="object"&&navigator||void 0,p5=dx&&(!W1||["ReactNative","NativeScript","NS"].indexOf(W1.product)<0),x5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",b5=dx&&window.location.href||"http://localhost",y5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:dx,hasStandardBrowserEnv:p5,hasStandardBrowserWebWorkerEnv:x5,navigator:W1,origin:b5},Symbol.toStringTag,{value:"Module"})),dn={...y5,...g5};function v5(l,n){return Tp(l,new dn.classes.URLSearchParams,{visitor:function(a,o,s,e){return dn.isNode&&ut.isBuffer(a)?(this.append(o,a.toString("base64")),!1):e.defaultVisitor.apply(this,arguments)},...n})}function w5(l){return ut.matchAll(/\w+|\[(\w*)]/g,l).map(n=>n[0]==="[]"?"":n[1]||n[0])}function j5(l){const n={},a=Object.keys(l);let o;const s=a.length;let e;for(o=0;o<s;o++)e=a[o],n[e]=l[e];return n}function by(l){function n(a,o,s,e){let m=a[e++];if(m==="__proto__")return!0;const v=Number.isFinite(+m),w=e>=a.length;return m=!m&&ut.isArray(s)?s.length:m,w?(ut.hasOwnProp(s,m)?s[m]=[s[m],o]:s[m]=o,!v):((!s[m]||!ut.isObject(s[m]))&&(s[m]=[]),n(a,o,s[m],e)&&ut.isArray(s[m])&&(s[m]=j5(s[m])),!v)}if(ut.isFormData(l)&&ut.isFunction(l.entries)){const a={};return ut.forEachEntry(l,(o,s)=>{n(w5(o),s,a,0)}),a}return null}function N5(l,n,a){if(ut.isString(l))try{return(n||JSON.parse)(l),ut.trim(l)}catch(o){if(o.name!=="SyntaxError")throw o}return(a||JSON.stringify)(l)}const xm={transitional:xy,adapter:["xhr","http","fetch"],transformRequest:[function(n,a){const o=a.getContentType()||"",s=o.indexOf("application/json")>-1,e=ut.isObject(n);if(e&&ut.isHTMLForm(n)&&(n=new FormData(n)),ut.isFormData(n))return s?JSON.stringify(by(n)):n;if(ut.isArrayBuffer(n)||ut.isBuffer(n)||ut.isStream(n)||ut.isFile(n)||ut.isBlob(n)||ut.isReadableStream(n))return n;if(ut.isArrayBufferView(n))return n.buffer;if(ut.isURLSearchParams(n))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let v;if(e){if(o.indexOf("application/x-www-form-urlencoded")>-1)return v5(n,this.formSerializer).toString();if((v=ut.isFileList(n))||o.indexOf("multipart/form-data")>-1){const w=this.env&&this.env.FormData;return Tp(v?{"files[]":n}:n,w&&new w,this.formSerializer)}}return e||s?(a.setContentType("application/json",!1),N5(n)):n}],transformResponse:[function(n){const a=this.transitional||xm.transitional,o=a&&a.forcedJSONParsing,s=this.responseType==="json";if(ut.isResponse(n)||ut.isReadableStream(n))return n;if(n&&ut.isString(n)&&(o&&!this.responseType||s)){const m=!(a&&a.silentJSONParsing)&&s;try{return JSON.parse(n,this.parseReviver)}catch(v){if(m)throw v.name==="SyntaxError"?Ls.from(v,Ls.ERR_BAD_RESPONSE,this,null,this.response):v}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:dn.classes.FormData,Blob:dn.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ut.forEach(["delete","get","head","post","put","patch"],l=>{xm.headers[l]={}});const k5=ut.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),C5=l=>{const n={};let a,o,s;return l&&l.split(`
`).forEach(function(m){s=m.indexOf(":"),a=m.substring(0,s).trim().toLowerCase(),o=m.substring(s+1).trim(),!(!a||n[a]&&k5[a])&&(a==="set-cookie"?n[a]?n[a].push(o):n[a]=[o]:n[a]=n[a]?n[a]+", "+o:o)}),n},qx=Symbol("internals");function Vf(l){return l&&String(l).trim().toLowerCase()}function dp(l){return l===!1||l==null?l:ut.isArray(l)?l.map(dp):String(l)}function S5(l){const n=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=a.exec(l);)n[o[1]]=o[2];return n}const A5=l=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(l.trim());function m1(l,n,a,o,s){if(ut.isFunction(o))return o.call(this,n,a);if(s&&(n=a),!!ut.isString(n)){if(ut.isString(o))return n.indexOf(o)!==-1;if(ut.isRegExp(o))return o.test(n)}}function E5(l){return l.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,a,o)=>a.toUpperCase()+o)}function D5(l,n){const a=ut.toCamelCase(" "+n);["get","set","has"].forEach(o=>{Object.defineProperty(l,o+a,{value:function(s,e,m){return this[o].call(this,n,s,e,m)},configurable:!0})})}let qn=class{constructor(n){n&&this.set(n)}set(n,a,o){const s=this;function e(v,w,N){const S=Vf(w);if(!S)throw new Error("header name must be a non-empty string");const D=ut.findKey(s,S);(!D||s[D]===void 0||N===!0||N===void 0&&s[D]!==!1)&&(s[D||w]=dp(v))}const m=(v,w)=>ut.forEach(v,(N,S)=>e(N,S,w));if(ut.isPlainObject(n)||n instanceof this.constructor)m(n,a);else if(ut.isString(n)&&(n=n.trim())&&!A5(n))m(C5(n),a);else if(ut.isObject(n)&&ut.isIterable(n)){let v={},w,N;for(const S of n){if(!ut.isArray(S))throw TypeError("Object iterator must return a key-value pair");v[N=S[0]]=(w=v[N])?ut.isArray(w)?[...w,S[1]]:[w,S[1]]:S[1]}m(v,a)}else n!=null&&e(a,n,o);return this}get(n,a){if(n=Vf(n),n){const o=ut.findKey(this,n);if(o){const s=this[o];if(!a)return s;if(a===!0)return S5(s);if(ut.isFunction(a))return a.call(this,s,o);if(ut.isRegExp(a))return a.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,a){if(n=Vf(n),n){const o=ut.findKey(this,n);return!!(o&&this[o]!==void 0&&(!a||m1(this,this[o],o,a)))}return!1}delete(n,a){const o=this;let s=!1;function e(m){if(m=Vf(m),m){const v=ut.findKey(o,m);v&&(!a||m1(o,o[v],v,a))&&(delete o[v],s=!0)}}return ut.isArray(n)?n.forEach(e):e(n),s}clear(n){const a=Object.keys(this);let o=a.length,s=!1;for(;o--;){const e=a[o];(!n||m1(this,this[e],e,n,!0))&&(delete this[e],s=!0)}return s}normalize(n){const a=this,o={};return ut.forEach(this,(s,e)=>{const m=ut.findKey(o,e);if(m){a[m]=dp(s),delete a[e];return}const v=n?E5(e):String(e).trim();v!==e&&delete a[e],a[v]=dp(s),o[v]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const a=Object.create(null);return ut.forEach(this,(o,s)=>{o!=null&&o!==!1&&(a[s]=n&&ut.isArray(o)?o.join(", "):o)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,a])=>n+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...a){const o=new this(n);return a.forEach(s=>o.set(s)),o}static accessor(n){const o=(this[qx]=this[qx]={accessors:{}}).accessors,s=this.prototype;function e(m){const v=Vf(m);o[v]||(D5(s,m),o[v]=!0)}return ut.isArray(n)?n.forEach(e):e(n),this}};qn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ut.reduceDescriptors(qn.prototype,({value:l},n)=>{let a=n[0].toUpperCase()+n.slice(1);return{get:()=>l,set(o){this[a]=o}}});ut.freezeMethods(qn);function g1(l,n){const a=this||xm,o=n||a,s=qn.from(o.headers);let e=o.data;return ut.forEach(l,function(v){e=v.call(a,e,s.normalize(),n?n.status:void 0)}),s.normalize(),e}function yy(l){return!!(l&&l.__CANCEL__)}function rh(l,n,a){Ls.call(this,l??"canceled",Ls.ERR_CANCELED,n,a),this.name="CanceledError"}ut.inherits(rh,Ls,{__CANCEL__:!0});function vy(l,n,a){const o=a.config.validateStatus;!a.status||!o||o(a.status)?l(a):n(new Ls("Request failed with status code "+a.status,[Ls.ERR_BAD_REQUEST,Ls.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function T5(l){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(l);return n&&n[1]||""}function _5(l,n){l=l||10;const a=new Array(l),o=new Array(l);let s=0,e=0,m;return n=n!==void 0?n:1e3,function(w){const N=Date.now(),S=o[e];m||(m=N),a[s]=w,o[s]=N;let D=e,L=0;for(;D!==s;)L+=a[D++],D=D%l;if(s=(s+1)%l,s===e&&(e=(e+1)%l),N-m<n)return;const M=S&&N-S;return M?Math.round(L*1e3/M):void 0}}function F5(l,n){let a=0,o=1e3/n,s,e;const m=(N,S=Date.now())=>{a=S,s=null,e&&(clearTimeout(e),e=null),l(...N)};return[(...N)=>{const S=Date.now(),D=S-a;D>=o?m(N,S):(s=N,e||(e=setTimeout(()=>{e=null,m(s)},o-D)))},()=>s&&m(s)]}const xp=(l,n,a=3)=>{let o=0;const s=_5(50,250);return F5(e=>{const m=e.loaded,v=e.lengthComputable?e.total:void 0,w=m-o,N=s(w),S=m<=v;o=m;const D={loaded:m,total:v,progress:v?m/v:void 0,bytes:w,rate:N||void 0,estimated:N&&v&&S?(v-m)/N:void 0,event:e,lengthComputable:v!=null,[n?"download":"upload"]:!0};l(D)},a)},Yx=(l,n)=>{const a=l!=null;return[o=>n[0]({lengthComputable:a,total:l,loaded:o}),n[1]]},Gx=l=>(...n)=>ut.asap(()=>l(...n)),M5=dn.hasStandardBrowserEnv?((l,n)=>a=>(a=new URL(a,dn.origin),l.protocol===a.protocol&&l.host===a.host&&(n||l.port===a.port)))(new URL(dn.origin),dn.navigator&&/(msie|trident)/i.test(dn.navigator.userAgent)):()=>!0,L5=dn.hasStandardBrowserEnv?{write(l,n,a,o,s,e,m){if(typeof document>"u")return;const v=[`${l}=${encodeURIComponent(n)}`];ut.isNumber(a)&&v.push(`expires=${new Date(a).toUTCString()}`),ut.isString(o)&&v.push(`path=${o}`),ut.isString(s)&&v.push(`domain=${s}`),e===!0&&v.push("secure"),ut.isString(m)&&v.push(`SameSite=${m}`),document.cookie=v.join("; ")},read(l){if(typeof document>"u")return null;const n=document.cookie.match(new RegExp("(?:^|; )"+l+"=([^;]*)"));return n?decodeURIComponent(n[1]):null},remove(l){this.write(l,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function R5(l){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(l)}function O5(l,n){return n?l.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):l}function wy(l,n,a){let o=!R5(n);return l&&(o||a==!1)?O5(l,n):n}const Kx=l=>l instanceof qn?{...l}:l;function s0(l,n){n=n||{};const a={};function o(N,S,D,L){return ut.isPlainObject(N)&&ut.isPlainObject(S)?ut.merge.call({caseless:L},N,S):ut.isPlainObject(S)?ut.merge({},S):ut.isArray(S)?S.slice():S}function s(N,S,D,L){if(ut.isUndefined(S)){if(!ut.isUndefined(N))return o(void 0,N,D,L)}else return o(N,S,D,L)}function e(N,S){if(!ut.isUndefined(S))return o(void 0,S)}function m(N,S){if(ut.isUndefined(S)){if(!ut.isUndefined(N))return o(void 0,N)}else return o(void 0,S)}function v(N,S,D){if(D in n)return o(N,S);if(D in l)return o(void 0,N)}const w={url:e,method:e,data:e,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:v,headers:(N,S,D)=>s(Kx(N),Kx(S),D,!0)};return ut.forEach(Object.keys({...l,...n}),function(S){const D=w[S]||s,L=D(l[S],n[S],S);ut.isUndefined(L)&&D!==v||(a[S]=L)}),a}const jy=l=>{const n=s0({},l);let{data:a,withXSRFToken:o,xsrfHeaderName:s,xsrfCookieName:e,headers:m,auth:v}=n;if(n.headers=m=qn.from(m),n.url=py(wy(n.baseURL,n.url,n.allowAbsoluteUrls),l.params,l.paramsSerializer),v&&m.set("Authorization","Basic "+btoa((v.username||"")+":"+(v.password?unescape(encodeURIComponent(v.password)):""))),ut.isFormData(a)){if(dn.hasStandardBrowserEnv||dn.hasStandardBrowserWebWorkerEnv)m.setContentType(void 0);else if(ut.isFunction(a.getHeaders)){const w=a.getHeaders(),N=["content-type","content-length"];Object.entries(w).forEach(([S,D])=>{N.includes(S.toLowerCase())&&m.set(S,D)})}}if(dn.hasStandardBrowserEnv&&(o&&ut.isFunction(o)&&(o=o(n)),o||o!==!1&&M5(n.url))){const w=s&&e&&L5.read(e);w&&m.set(s,w)}return n},P5=typeof XMLHttpRequest<"u",I5=P5&&function(l){return new Promise(function(a,o){const s=jy(l);let e=s.data;const m=qn.from(s.headers).normalize();let{responseType:v,onUploadProgress:w,onDownloadProgress:N}=s,S,D,L,M,F;function O(){M&&M(),F&&F(),s.cancelToken&&s.cancelToken.unsubscribe(S),s.signal&&s.signal.removeEventListener("abort",S)}let P=new XMLHttpRequest;P.open(s.method.toUpperCase(),s.url,!0),P.timeout=s.timeout;function K(){if(!P)return;const se=qn.from("getAllResponseHeaders"in P&&P.getAllResponseHeaders()),ge={data:!v||v==="text"||v==="json"?P.responseText:P.response,status:P.status,statusText:P.statusText,headers:se,config:l,request:P};vy(function(J){a(J),O()},function(J){o(J),O()},ge),P=null}"onloadend"in P?P.onloadend=K:P.onreadystatechange=function(){!P||P.readyState!==4||P.status===0&&!(P.responseURL&&P.responseURL.indexOf("file:")===0)||setTimeout(K)},P.onabort=function(){P&&(o(new Ls("Request aborted",Ls.ECONNABORTED,l,P)),P=null)},P.onerror=function(Ce){const ge=Ce&&Ce.message?Ce.message:"Network Error",Ne=new Ls(ge,Ls.ERR_NETWORK,l,P);Ne.event=Ce||null,o(Ne),P=null},P.ontimeout=function(){let Ce=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const ge=s.transitional||xy;s.timeoutErrorMessage&&(Ce=s.timeoutErrorMessage),o(new Ls(Ce,ge.clarifyTimeoutError?Ls.ETIMEDOUT:Ls.ECONNABORTED,l,P)),P=null},e===void 0&&m.setContentType(null),"setRequestHeader"in P&&ut.forEach(m.toJSON(),function(Ce,ge){P.setRequestHeader(ge,Ce)}),ut.isUndefined(s.withCredentials)||(P.withCredentials=!!s.withCredentials),v&&v!=="json"&&(P.responseType=s.responseType),N&&([L,F]=xp(N,!0),P.addEventListener("progress",L)),w&&P.upload&&([D,M]=xp(w),P.upload.addEventListener("progress",D),P.upload.addEventListener("loadend",M)),(s.cancelToken||s.signal)&&(S=se=>{P&&(o(!se||se.type?new rh(null,l,P):se),P.abort(),P=null)},s.cancelToken&&s.cancelToken.subscribe(S),s.signal&&(s.signal.aborted?S():s.signal.addEventListener("abort",S)));const ne=T5(s.url);if(ne&&dn.protocols.indexOf(ne)===-1){o(new Ls("Unsupported protocol "+ne+":",Ls.ERR_BAD_REQUEST,l));return}P.send(e||null)})},B5=(l,n)=>{const{length:a}=l=l?l.filter(Boolean):[];if(n||a){let o=new AbortController,s;const e=function(N){if(!s){s=!0,v();const S=N instanceof Error?N:this.reason;o.abort(S instanceof Ls?S:new rh(S instanceof Error?S.message:S))}};let m=n&&setTimeout(()=>{m=null,e(new Ls(`timeout ${n} of ms exceeded`,Ls.ETIMEDOUT))},n);const v=()=>{l&&(m&&clearTimeout(m),m=null,l.forEach(N=>{N.unsubscribe?N.unsubscribe(e):N.removeEventListener("abort",e)}),l=null)};l.forEach(N=>N.addEventListener("abort",e));const{signal:w}=o;return w.unsubscribe=()=>ut.asap(v),w}},z5=function*(l,n){let a=l.byteLength;if(a<n){yield l;return}let o=0,s;for(;o<a;)s=o+n,yield l.slice(o,s),o=s},U5=async function*(l,n){for await(const a of H5(l))yield*z5(a,n)},H5=async function*(l){if(l[Symbol.asyncIterator]){yield*l;return}const n=l.getReader();try{for(;;){const{done:a,value:o}=await n.read();if(a)break;yield o}}finally{await n.cancel()}},Qx=(l,n,a,o)=>{const s=U5(l,n);let e=0,m,v=w=>{m||(m=!0,o&&o(w))};return new ReadableStream({async pull(w){try{const{done:N,value:S}=await s.next();if(N){v(),w.close();return}let D=S.byteLength;if(a){let L=e+=D;a(L)}w.enqueue(new Uint8Array(S))}catch(N){throw v(N),N}},cancel(w){return v(w),s.return()}},{highWaterMark:2})},Xx=64*1024,{isFunction:Vg}=ut,V5=(({Request:l,Response:n})=>({Request:l,Response:n}))(ut.global),{ReadableStream:Jx,TextEncoder:Zx}=ut.global,e2=(l,...n)=>{try{return!!l(...n)}catch{return!1}},W5=l=>{l=ut.merge.call({skipUndefined:!0},V5,l);const{fetch:n,Request:a,Response:o}=l,s=n?Vg(n):typeof fetch=="function",e=Vg(a),m=Vg(o);if(!s)return!1;const v=s&&Vg(Jx),w=s&&(typeof Zx=="function"?(F=>O=>F.encode(O))(new Zx):async F=>new Uint8Array(await new a(F).arrayBuffer())),N=e&&v&&e2(()=>{let F=!1;const O=new a(dn.origin,{body:new Jx,method:"POST",get duplex(){return F=!0,"half"}}).headers.has("Content-Type");return F&&!O}),S=m&&v&&e2(()=>ut.isReadableStream(new o("").body)),D={stream:S&&(F=>F.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(F=>{!D[F]&&(D[F]=(O,P)=>{let K=O&&O[F];if(K)return K.call(O);throw new Ls(`Response type '${F}' is not supported`,Ls.ERR_NOT_SUPPORT,P)})});const L=async F=>{if(F==null)return 0;if(ut.isBlob(F))return F.size;if(ut.isSpecCompliantForm(F))return(await new a(dn.origin,{method:"POST",body:F}).arrayBuffer()).byteLength;if(ut.isArrayBufferView(F)||ut.isArrayBuffer(F))return F.byteLength;if(ut.isURLSearchParams(F)&&(F=F+""),ut.isString(F))return(await w(F)).byteLength},M=async(F,O)=>{const P=ut.toFiniteNumber(F.getContentLength());return P??L(O)};return async F=>{let{url:O,method:P,data:K,signal:ne,cancelToken:se,timeout:Ce,onDownloadProgress:ge,onUploadProgress:Ne,responseType:J,headers:de,withCredentials:le="same-origin",fetchOptions:ze}=jy(F),me=n||fetch;J=J?(J+"").toLowerCase():"text";let oe=B5([ne,se&&se.toAbortSignal()],Ce),ce=null;const ye=oe&&oe.unsubscribe&&(()=>{oe.unsubscribe()});let ke;try{if(Ne&&N&&P!=="get"&&P!=="head"&&(ke=await M(de,K))!==0){let V=new a(O,{method:"POST",body:K,duplex:"half"}),be;if(ut.isFormData(K)&&(be=V.headers.get("content-type"))&&de.setContentType(be),V.body){const[_e,De]=Yx(ke,xp(Gx(Ne)));K=Qx(V.body,Xx,_e,De)}}ut.isString(le)||(le=le?"include":"omit");const fe=e&&"credentials"in a.prototype,Se={...ze,signal:oe,method:P.toUpperCase(),headers:de.normalize().toJSON(),body:K,duplex:"half",credentials:fe?le:void 0};ce=e&&new a(O,Se);let Ye=await(e?me(ce,ze):me(O,Se));const te=S&&(J==="stream"||J==="response");if(S&&(ge||te&&ye)){const V={};["status","statusText","headers"].forEach(W=>{V[W]=Ye[W]});const be=ut.toFiniteNumber(Ye.headers.get("content-length")),[_e,De]=ge&&Yx(be,xp(Gx(ge),!0))||[];Ye=new o(Qx(Ye.body,Xx,_e,()=>{De&&De(),ye&&ye()}),V)}J=J||"text";let pe=await D[ut.findKey(D,J)||"text"](Ye,F);return!te&&ye&&ye(),await new Promise((V,be)=>{vy(V,be,{data:pe,headers:qn.from(Ye.headers),status:Ye.status,statusText:Ye.statusText,config:F,request:ce})})}catch(fe){throw ye&&ye(),fe&&fe.name==="TypeError"&&/Load failed|fetch/i.test(fe.message)?Object.assign(new Ls("Network Error",Ls.ERR_NETWORK,F,ce),{cause:fe.cause||fe}):Ls.from(fe,fe&&fe.code,F,ce)}}},$5=new Map,Ny=l=>{let n=l&&l.env||{};const{fetch:a,Request:o,Response:s}=n,e=[o,s,a];let m=e.length,v=m,w,N,S=$5;for(;v--;)w=e[v],N=S.get(w),N===void 0&&S.set(w,N=v?new Map:W5(n)),S=N;return N};Ny();const ux={http:o5,xhr:I5,fetch:{get:Ny}};ut.forEach(ux,(l,n)=>{if(l){try{Object.defineProperty(l,"name",{value:n})}catch{}Object.defineProperty(l,"adapterName",{value:n})}});const t2=l=>`- ${l}`,q5=l=>ut.isFunction(l)||l===null||l===!1;function Y5(l,n){l=ut.isArray(l)?l:[l];const{length:a}=l;let o,s;const e={};for(let m=0;m<a;m++){o=l[m];let v;if(s=o,!q5(o)&&(s=ux[(v=String(o)).toLowerCase()],s===void 0))throw new Ls(`Unknown adapter '${v}'`);if(s&&(ut.isFunction(s)||(s=s.get(n))))break;e[v||"#"+m]=s}if(!s){const m=Object.entries(e).map(([w,N])=>`adapter ${w} `+(N===!1?"is not supported by the environment":"is not available in the build"));let v=a?m.length>1?`since :
`+m.map(t2).join(`
`):" "+t2(m[0]):"as no adapter specified";throw new Ls("There is no suitable adapter to dispatch the request "+v,"ERR_NOT_SUPPORT")}return s}const ky={getAdapter:Y5,adapters:ux};function p1(l){if(l.cancelToken&&l.cancelToken.throwIfRequested(),l.signal&&l.signal.aborted)throw new rh(null,l)}function s2(l){return p1(l),l.headers=qn.from(l.headers),l.data=g1.call(l,l.transformRequest),["post","put","patch"].indexOf(l.method)!==-1&&l.headers.setContentType("application/x-www-form-urlencoded",!1),ky.getAdapter(l.adapter||xm.adapter,l)(l).then(function(o){return p1(l),o.data=g1.call(l,l.transformResponse,o),o.headers=qn.from(o.headers),o},function(o){return yy(o)||(p1(l),o&&o.response&&(o.response.data=g1.call(l,l.transformResponse,o.response),o.response.headers=qn.from(o.response.headers))),Promise.reject(o)})}const Cy="1.13.2",_p={};["object","boolean","number","function","string","symbol"].forEach((l,n)=>{_p[l]=function(o){return typeof o===l||"a"+(n<1?"n ":" ")+l}});const r2={};_p.transitional=function(n,a,o){function s(e,m){return"[Axios v"+Cy+"] Transitional option '"+e+"'"+m+(o?". "+o:"")}return(e,m,v)=>{if(n===!1)throw new Ls(s(m," has been removed"+(a?" in "+a:"")),Ls.ERR_DEPRECATED);return a&&!r2[m]&&(r2[m]=!0,console.warn(s(m," has been deprecated since v"+a+" and will be removed in the near future"))),n?n(e,m,v):!0}};_p.spelling=function(n){return(a,o)=>(console.warn(`${o} is likely a misspelling of ${n}`),!0)};function G5(l,n,a){if(typeof l!="object")throw new Ls("options must be an object",Ls.ERR_BAD_OPTION_VALUE);const o=Object.keys(l);let s=o.length;for(;s-- >0;){const e=o[s],m=n[e];if(m){const v=l[e],w=v===void 0||m(v,e,l);if(w!==!0)throw new Ls("option "+e+" must be "+w,Ls.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new Ls("Unknown option "+e,Ls.ERR_BAD_OPTION)}}const up={assertOptions:G5,validators:_p},Rl=up.validators;let e0=class{constructor(n){this.defaults=n||{},this.interceptors={request:new $x,response:new $x}}async request(n,a){try{return await this._request(n,a)}catch(o){if(o instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const e=s.stack?s.stack.replace(/^.+\n/,""):"";try{o.stack?e&&!String(o.stack).endsWith(e.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+e):o.stack=e}catch{}}throw o}}_request(n,a){typeof n=="string"?(a=a||{},a.url=n):a=n||{},a=s0(this.defaults,a);const{transitional:o,paramsSerializer:s,headers:e}=a;o!==void 0&&up.assertOptions(o,{silentJSONParsing:Rl.transitional(Rl.boolean),forcedJSONParsing:Rl.transitional(Rl.boolean),clarifyTimeoutError:Rl.transitional(Rl.boolean)},!1),s!=null&&(ut.isFunction(s)?a.paramsSerializer={serialize:s}:up.assertOptions(s,{encode:Rl.function,serialize:Rl.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),up.assertOptions(a,{baseUrl:Rl.spelling("baseURL"),withXsrfToken:Rl.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let m=e&&ut.merge(e.common,e[a.method]);e&&ut.forEach(["delete","get","head","post","put","patch","common"],F=>{delete e[F]}),a.headers=qn.concat(m,e);const v=[];let w=!0;this.interceptors.request.forEach(function(O){typeof O.runWhen=="function"&&O.runWhen(a)===!1||(w=w&&O.synchronous,v.unshift(O.fulfilled,O.rejected))});const N=[];this.interceptors.response.forEach(function(O){N.push(O.fulfilled,O.rejected)});let S,D=0,L;if(!w){const F=[s2.bind(this),void 0];for(F.unshift(...v),F.push(...N),L=F.length,S=Promise.resolve(a);D<L;)S=S.then(F[D++],F[D++]);return S}L=v.length;let M=a;for(;D<L;){const F=v[D++],O=v[D++];try{M=F(M)}catch(P){O.call(this,P);break}}try{S=s2.call(this,M)}catch(F){return Promise.reject(F)}for(D=0,L=N.length;D<L;)S=S.then(N[D++],N[D++]);return S}getUri(n){n=s0(this.defaults,n);const a=wy(n.baseURL,n.url,n.allowAbsoluteUrls);return py(a,n.params,n.paramsSerializer)}};ut.forEach(["delete","get","head","options"],function(n){e0.prototype[n]=function(a,o){return this.request(s0(o||{},{method:n,url:a,data:(o||{}).data}))}});ut.forEach(["post","put","patch"],function(n){function a(o){return function(e,m,v){return this.request(s0(v||{},{method:n,headers:o?{"Content-Type":"multipart/form-data"}:{},url:e,data:m}))}}e0.prototype[n]=a(),e0.prototype[n+"Form"]=a(!0)});let K5=class Sy{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(e){a=e});const o=this;this.promise.then(s=>{if(!o._listeners)return;let e=o._listeners.length;for(;e-- >0;)o._listeners[e](s);o._listeners=null}),this.promise.then=s=>{let e;const m=new Promise(v=>{o.subscribe(v),e=v}).then(s);return m.cancel=function(){o.unsubscribe(e)},m},n(function(e,m,v){o.reason||(o.reason=new rh(e,m,v),a(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const a=this._listeners.indexOf(n);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const n=new AbortController,a=o=>{n.abort(o)};return this.subscribe(a),n.signal.unsubscribe=()=>this.unsubscribe(a),n.signal}static source(){let n;return{token:new Sy(function(s){n=s}),cancel:n}}};function Q5(l){return function(a){return l.apply(null,a)}}function X5(l){return ut.isObject(l)&&l.isAxiosError===!0}const $1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries($1).forEach(([l,n])=>{$1[n]=l});function Ay(l){const n=new e0(l),a=ay(e0.prototype.request,n);return ut.extend(a,e0.prototype,n,{allOwnKeys:!0}),ut.extend(a,n,null,{allOwnKeys:!0}),a.create=function(s){return Ay(s0(l,s))},a}const ea=Ay(xm);ea.Axios=e0;ea.CanceledError=rh;ea.CancelToken=K5;ea.isCancel=yy;ea.VERSION=Cy;ea.toFormData=Tp;ea.AxiosError=Ls;ea.Cancel=ea.CanceledError;ea.all=function(n){return Promise.all(n)};ea.spread=Q5;ea.isAxiosError=X5;ea.mergeConfig=s0;ea.AxiosHeaders=qn;ea.formToJSON=l=>by(ut.isHTMLForm(l)?new FormData(l):l);ea.getAdapter=ky.getAdapter;ea.HttpStatusCode=$1;ea.default=ea;const{Axios:$C,AxiosError:qC,CanceledError:YC,isCancel:GC,CancelToken:KC,VERSION:QC,all:XC,Cancel:JC,isAxiosError:ZC,spread:e7,toFormData:t7,AxiosHeaders:s7,HttpStatusCode:r7,formToJSON:a7,getAdapter:n7,mergeConfig:i7}=ea,J5=()=>{const n="http://localhost:5000/api".replace(/\/$/,"");return n.endsWith("/api")?n:`${n}/api`},Ut=ea.create({baseURL:J5()});Ut.interceptors.request.use(l=>{const n=localStorage.getItem("token");return n&&(l.headers.Authorization=`Bearer ${n}`),l});Ut.interceptors.response.use(l=>l,l=>(ea.isCancel&&ea.isCancel(l)||l.name==="CanceledError"||l.message==="canceled"||l.code==="ERR_CANCELED"||l.config&&l.config.signal&&l.config.signal.aborted||(l.response?(console.error("API Error Response:",l.response.status,l.response.statusText),console.error("Error Details:",JSON.stringify(l.response.data,null,2)),console.error("Request URL:",l.config?.baseURL+l.config?.url),console.error("Request Method:",l.config?.method?.toUpperCase())):l.request?(console.error("API Network Error - No response received"),console.error("Error Message:",l.message),console.error("Error Code:",l.code),console.error("Request URL:",l.config?.baseURL+l.config?.url)):console.error("API Request Setup Error:",l.message)),Promise.reject(l)));function a2(){const l=Dr();B.useEffect(()=>{localStorage.getItem("token")&&l("/dashboard",{replace:!0})},[l]);const[n,a]=B.useState(!0),[o,s]=B.useState({email:"",password:"",name:""}),[e,m]=B.useState(!1),[v,w]=B.useState(""),N=L=>{s({...o,[L.target.name]:L.target.value}),w("")},S=()=>{s({email:"",password:"",name:""}),w("")},D=async L=>{if(L.preventDefault(),w(""),!o.email.trim()){w("Email is required");return}if(!o.password.trim()){w("Password is required");return}if(o.password.length<6){w("Password must be at least 6 characters long");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email.trim())){w("Please enter a valid email address");return}m(!0);try{const F=n?"/auth/login":"/auth/register",O=n?{email:o.email.trim(),password:o.password}:{email:o.email.trim(),password:o.password,...o.name&&o.name.trim()&&{name:o.name.trim()}},P=await Ut.post(F,O);P.data.success&&(localStorage.setItem("token",P.data.data.token),localStorage.setItem("user",JSON.stringify(P.data.data.user)),l("/dashboard"))}catch(F){F.code==="ERR_NETWORK"||F.message==="Network Error"||!F.response?w("Cannot connect to server. Please make sure the backend server is running on http://localhost:5000"):w(F.response?.data?.error||F.message||(n?"Login failed. Please check your credentials.":"Registration failed. Please try again."))}finally{m(!1)}};return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4",children:t.jsxs("div",{className:"w-full max-w-md",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-2xl mb-4 shadow-lg",children:t.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full"})})}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Outbound SaaS"}),t.jsx("p",{className:"text-gray-600",children:n?"Welcome back":"Let's get you started"})]}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[t.jsxs("div",{className:"flex gap-2 mb-6 p-1 bg-gray-100 rounded-lg",children:[t.jsx("button",{type:"button",onClick:()=>{a(!0),S()},className:`flex-1 py-2 px-4 rounded-md text-sm font-semibold transition-all ${n?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Login"}),t.jsx("button",{type:"button",onClick:()=>{a(!1),S()},className:`flex-1 py-2 px-4 rounded-md text-sm font-semibold transition-all ${n?"text-gray-600 hover:text-gray-900":"bg-white text-blue-600 shadow-sm"}`,children:"Register"})]}),v&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:v}),t.jsxs("form",{onSubmit:D,className:"space-y-4",children:[!n&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),t.jsx("input",{type:"text",name:"name",value:o.name,onChange:N,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:"Your name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),t.jsx("input",{type:"email",name:"email",value:o.email,onChange:N,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:"your@email.com"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),n&&t.jsx("button",{type:"button",onClick:()=>l("/reset-password"),className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Forgot Password?"})]}),t.jsx("input",{type:"password",name:"password",value:o.password,onChange:N,required:!0,minLength:6,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:""}),!n&&t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters"})]}),t.jsx("button",{type:"submit",disabled:e,className:"w-full py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:e?t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n?"Logging in...":"Creating account..."]}):n?"Login":"Create Account"})]})]}),t.jsx("p",{className:"text-center text-sm text-gray-500 mt-6",children:n?t.jsxs(t.Fragment,{children:["Don't have an account?"," ",t.jsx("button",{onClick:()=>{a(!1),S()},className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Sign up"})]}):t.jsxs(t.Fragment,{children:["Already have an account?"," ",t.jsx("button",{onClick:()=>{a(!0),S()},className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Sign in"})]})})]})})}function Z5(){const l=Dr(),[n,a]=B.useState({email:"",newPassword:"",confirmPassword:""}),[o,s]=B.useState(!1),[e,m]=B.useState(""),[v,w]=B.useState(""),N=D=>{a({...n,[D.target.name]:D.target.value}),m(""),w("")},S=async D=>{if(D.preventDefault(),m(""),w(""),!n.email.trim()){m("Email is required");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email.trim())){m("Please enter a valid email address");return}if(!n.newPassword.trim()){m("New password is required");return}if(n.newPassword.length<6){m("Password must be at least 6 characters long");return}if(n.newPassword!==n.confirmPassword){m("Passwords do not match");return}s(!0);try{(await Ut.post("/auth/reset-password",{email:n.email.trim(),newPassword:n.newPassword})).data.success&&(w("Password reset successfully! Redirecting to login..."),setTimeout(()=>{l("/login")},2e3))}catch(M){M.code==="ERR_NETWORK"||M.message==="Network Error"||!M.response?m("Cannot connect to server. Please make sure the backend server is running."):m(M.response?.data?.error||M.message||"Failed to reset password")}finally{s(!1)}};return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4",children:t.jsxs("div",{className:"w-full max-w-md",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-2xl mb-4 shadow-lg",children:t.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full"})})}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reset Password"}),t.jsx("p",{className:"text-gray-600",children:"Enter your email and new password to reset"})]}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[e&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:e}),v&&t.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 text-green-700 rounded-lg text-sm",children:v}),t.jsxs("form",{onSubmit:S,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),t.jsx("input",{type:"password",name:"newPassword",value:n.newPassword,onChange:N,required:!0,minLength:6,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:""}),t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),t.jsx("input",{type:"password",name:"confirmPassword",value:n.confirmPassword,onChange:N,required:!0,minLength:6,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),t.jsx("input",{type:"email",name:"email",value:n.email,onChange:N,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:"your@email.com"})]}),t.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:o?t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Resetting..."]}):"Reset Password"})]})]}),t.jsxs("p",{className:"text-center text-sm text-gray-500 mt-6",children:["Remember your password?"," ",t.jsx("button",{onClick:()=>l("/login"),className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Sign in"})]})]})})}const e3="modulepreload",t3=function(l){return"/"+l},n2={},_a=function(n,a,o){let s=Promise.resolve();if(a&&a.length>0){let N=function(S){return Promise.all(S.map(D=>Promise.resolve(D).then(L=>({status:"fulfilled",value:L}),L=>({status:"rejected",reason:L}))))};var m=N;document.getElementsByTagName("link");const v=document.querySelector("meta[property=csp-nonce]"),w=v?.nonce||v?.getAttribute("nonce");s=N(a.map(S=>{if(S=t3(S),S in n2)return;n2[S]=!0;const D=S.endsWith(".css"),L=D?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${L}`))return;const M=document.createElement("link");if(M.rel=D?"stylesheet":e3,D||(M.as="script"),M.crossOrigin="",M.href=S,w&&M.setAttribute("nonce",w),document.head.appendChild(M),D)return new Promise((F,O)=>{M.addEventListener("load",F),M.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${S}`)))})}))}function e(v){const w=new Event("vite:preloadError",{cancelable:!0});if(w.payload=v,window.dispatchEvent(w),!w.defaultPrevented)throw v}return s.then(v=>{for(const w of v||[])w.status==="rejected"&&e(w.reason);return n().catch(e)})};function bm(l){return l+.5|0}const _c=(l,n,a)=>Math.max(Math.min(l,a),n);function Xf(l){return _c(bm(l*2.55),0,255)}function Lc(l){return _c(bm(l*255),0,255)}function Fo(l){return _c(bm(l/2.55)/100,0,1)}function i2(l){return _c(bm(l*100),0,100)}const Di={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},q1=[..."0123456789ABCDEF"],s3=l=>q1[l&15],r3=l=>q1[(l&240)>>4]+q1[l&15],Wg=l=>(l&240)>>4===(l&15),a3=l=>Wg(l.r)&&Wg(l.g)&&Wg(l.b)&&Wg(l.a);function n3(l){var n=l.length,a;return l[0]==="#"&&(n===4||n===5?a={r:255&Di[l[1]]*17,g:255&Di[l[2]]*17,b:255&Di[l[3]]*17,a:n===5?Di[l[4]]*17:255}:(n===7||n===9)&&(a={r:Di[l[1]]<<4|Di[l[2]],g:Di[l[3]]<<4|Di[l[4]],b:Di[l[5]]<<4|Di[l[6]],a:n===9?Di[l[7]]<<4|Di[l[8]]:255})),a}const i3=(l,n)=>l<255?n(l):"";function l3(l){var n=a3(l)?s3:r3;return l?"#"+n(l.r)+n(l.g)+n(l.b)+i3(l.a,n):void 0}const o3=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Ey(l,n,a){const o=n*Math.min(a,1-a),s=(e,m=(e+l/30)%12)=>a-o*Math.max(Math.min(m-3,9-m,1),-1);return[s(0),s(8),s(4)]}function c3(l,n,a){const o=(s,e=(s+l/60)%6)=>a-a*n*Math.max(Math.min(e,4-e,1),0);return[o(5),o(3),o(1)]}function d3(l,n,a){const o=Ey(l,1,.5);let s;for(n+a>1&&(s=1/(n+a),n*=s,a*=s),s=0;s<3;s++)o[s]*=1-n-a,o[s]+=n;return o}function u3(l,n,a,o,s){return l===s?(n-a)/o+(n<a?6:0):n===s?(a-l)/o+2:(l-n)/o+4}function hx(l){const a=l.r/255,o=l.g/255,s=l.b/255,e=Math.max(a,o,s),m=Math.min(a,o,s),v=(e+m)/2;let w,N,S;return e!==m&&(S=e-m,N=v>.5?S/(2-e-m):S/(e+m),w=u3(a,o,s,S,e),w=w*60+.5),[w|0,N||0,v]}function fx(l,n,a,o){return(Array.isArray(n)?l(n[0],n[1],n[2]):l(n,a,o)).map(Lc)}function mx(l,n,a){return fx(Ey,l,n,a)}function h3(l,n,a){return fx(d3,l,n,a)}function f3(l,n,a){return fx(c3,l,n,a)}function Dy(l){return(l%360+360)%360}function m3(l){const n=o3.exec(l);let a=255,o;if(!n)return;n[5]!==o&&(a=n[6]?Xf(+n[5]):Lc(+n[5]));const s=Dy(+n[2]),e=+n[3]/100,m=+n[4]/100;return n[1]==="hwb"?o=h3(s,e,m):n[1]==="hsv"?o=f3(s,e,m):o=mx(s,e,m),{r:o[0],g:o[1],b:o[2],a}}function g3(l,n){var a=hx(l);a[0]=Dy(a[0]+n),a=mx(a),l.r=a[0],l.g=a[1],l.b=a[2]}function p3(l){if(!l)return;const n=hx(l),a=n[0],o=i2(n[1]),s=i2(n[2]);return l.a<255?`hsla(${a}, ${o}%, ${s}%, ${Fo(l.a)})`:`hsl(${a}, ${o}%, ${s}%)`}const l2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},o2={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function x3(){const l={},n=Object.keys(o2),a=Object.keys(l2);let o,s,e,m,v;for(o=0;o<n.length;o++){for(m=v=n[o],s=0;s<a.length;s++)e=a[s],v=v.replace(e,l2[e]);e=parseInt(o2[m],16),l[v]=[e>>16&255,e>>8&255,e&255]}return l}let $g;function b3(l){$g||($g=x3(),$g.transparent=[0,0,0,0]);const n=$g[l.toLowerCase()];return n&&{r:n[0],g:n[1],b:n[2],a:n.length===4?n[3]:255}}const y3=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function v3(l){const n=y3.exec(l);let a=255,o,s,e;if(n){if(n[7]!==o){const m=+n[7];a=n[8]?Xf(m):_c(m*255,0,255)}return o=+n[1],s=+n[3],e=+n[5],o=255&(n[2]?Xf(o):_c(o,0,255)),s=255&(n[4]?Xf(s):_c(s,0,255)),e=255&(n[6]?Xf(e):_c(e,0,255)),{r:o,g:s,b:e,a}}}function w3(l){return l&&(l.a<255?`rgba(${l.r}, ${l.g}, ${l.b}, ${Fo(l.a)})`:`rgb(${l.r}, ${l.g}, ${l.b})`)}const x1=l=>l<=.0031308?l*12.92:Math.pow(l,1/2.4)*1.055-.055,Vu=l=>l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4);function j3(l,n,a){const o=Vu(Fo(l.r)),s=Vu(Fo(l.g)),e=Vu(Fo(l.b));return{r:Lc(x1(o+a*(Vu(Fo(n.r))-o))),g:Lc(x1(s+a*(Vu(Fo(n.g))-s))),b:Lc(x1(e+a*(Vu(Fo(n.b))-e))),a:l.a+a*(n.a-l.a)}}function qg(l,n,a){if(l){let o=hx(l);o[n]=Math.max(0,Math.min(o[n]+o[n]*a,n===0?360:1)),o=mx(o),l.r=o[0],l.g=o[1],l.b=o[2]}}function Ty(l,n){return l&&Object.assign(n||{},l)}function c2(l){var n={r:0,g:0,b:0,a:255};return Array.isArray(l)?l.length>=3&&(n={r:l[0],g:l[1],b:l[2],a:255},l.length>3&&(n.a=Lc(l[3]))):(n=Ty(l,{r:0,g:0,b:0,a:1}),n.a=Lc(n.a)),n}function N3(l){return l.charAt(0)==="r"?v3(l):m3(l)}class nm{constructor(n){if(n instanceof nm)return n;const a=typeof n;let o;a==="object"?o=c2(n):a==="string"&&(o=n3(n)||b3(n)||N3(n)),this._rgb=o,this._valid=!!o}get valid(){return this._valid}get rgb(){var n=Ty(this._rgb);return n&&(n.a=Fo(n.a)),n}set rgb(n){this._rgb=c2(n)}rgbString(){return this._valid?w3(this._rgb):void 0}hexString(){return this._valid?l3(this._rgb):void 0}hslString(){return this._valid?p3(this._rgb):void 0}mix(n,a){if(n){const o=this.rgb,s=n.rgb;let e;const m=a===e?.5:a,v=2*m-1,w=o.a-s.a,N=((v*w===-1?v:(v+w)/(1+v*w))+1)/2;e=1-N,o.r=255&N*o.r+e*s.r+.5,o.g=255&N*o.g+e*s.g+.5,o.b=255&N*o.b+e*s.b+.5,o.a=m*o.a+(1-m)*s.a,this.rgb=o}return this}interpolate(n,a){return n&&(this._rgb=j3(this._rgb,n._rgb,a)),this}clone(){return new nm(this.rgb)}alpha(n){return this._rgb.a=Lc(n),this}clearer(n){const a=this._rgb;return a.a*=1-n,this}greyscale(){const n=this._rgb,a=bm(n.r*.3+n.g*.59+n.b*.11);return n.r=n.g=n.b=a,this}opaquer(n){const a=this._rgb;return a.a*=1+n,this}negate(){const n=this._rgb;return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,this}lighten(n){return qg(this._rgb,2,n),this}darken(n){return qg(this._rgb,2,-n),this}saturate(n){return qg(this._rgb,1,n),this}desaturate(n){return qg(this._rgb,1,-n),this}rotate(n){return g3(this._rgb,n),this}}function Ao(){}const k3=(()=>{let l=0;return()=>l++})();function ur(l){return l==null}function Na(l){if(Array.isArray&&Array.isArray(l))return!0;const n=Object.prototype.toString.call(l);return n.slice(0,7)==="[object"&&n.slice(-6)==="Array]"}function Qs(l){return l!==null&&Object.prototype.toString.call(l)==="[object Object]"}function fn(l){return(typeof l=="number"||l instanceof Number)&&isFinite(+l)}function Ol(l,n){return fn(l)?l:n}function Ts(l,n){return typeof l>"u"?n:l}const C3=(l,n)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100:+l/n,_y=(l,n)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100*n:+l;function Wr(l,n,a){if(l&&typeof l.call=="function")return l.apply(a,n)}function wr(l,n,a,o){let s,e,m;if(Na(l))for(e=l.length,s=0;s<e;s++)n.call(a,l[s],s);else if(Qs(l))for(m=Object.keys(l),e=m.length,s=0;s<e;s++)n.call(a,l[m[s]],m[s])}function bp(l,n){let a,o,s,e;if(!l||!n||l.length!==n.length)return!1;for(a=0,o=l.length;a<o;++a)if(s=l[a],e=n[a],s.datasetIndex!==e.datasetIndex||s.index!==e.index)return!1;return!0}function yp(l){if(Na(l))return l.map(yp);if(Qs(l)){const n=Object.create(null),a=Object.keys(l),o=a.length;let s=0;for(;s<o;++s)n[a[s]]=yp(l[a[s]]);return n}return l}function Fy(l){return["__proto__","prototype","constructor"].indexOf(l)===-1}function S3(l,n,a,o){if(!Fy(l))return;const s=n[l],e=a[l];Qs(s)&&Qs(e)?im(s,e,o):n[l]=yp(e)}function im(l,n,a){const o=Na(n)?n:[n],s=o.length;if(!Qs(l))return l;a=a||{};const e=a.merger||S3;let m;for(let v=0;v<s;++v){if(m=o[v],!Qs(m))continue;const w=Object.keys(m);for(let N=0,S=w.length;N<S;++N)e(w[N],l,m,a)}return l}function em(l,n){return im(l,n,{merger:A3})}function A3(l,n,a){if(!Fy(l))return;const o=n[l],s=a[l];Qs(o)&&Qs(s)?em(o,s):Object.prototype.hasOwnProperty.call(n,l)||(n[l]=yp(s))}const d2={"":l=>l,x:l=>l.x,y:l=>l.y};function E3(l){const n=l.split("."),a=[];let o="";for(const s of n)o+=s,o.endsWith("\\")?o=o.slice(0,-1)+".":(a.push(o),o="");return a}function D3(l){const n=E3(l);return a=>{for(const o of n){if(o==="")break;a=a&&a[o]}return a}}function Rc(l,n){return(d2[n]||(d2[n]=D3(n)))(l)}function gx(l){return l.charAt(0).toUpperCase()+l.slice(1)}const lm=l=>typeof l<"u",Oc=l=>typeof l=="function",u2=(l,n)=>{if(l.size!==n.size)return!1;for(const a of l)if(!n.has(a))return!1;return!0};function T3(l){return l.type==="mouseup"||l.type==="click"||l.type==="contextmenu"}const pr=Math.PI,Zr=2*pr,_3=Zr+pr,vp=Number.POSITIVE_INFINITY,F3=pr/180,Ta=pr/2,Yd=pr/4,h2=pr*2/3,My=Math.log10,zl=Math.sign;function tm(l,n,a){return Math.abs(l-n)<a}function f2(l){const n=Math.round(l);l=tm(l,n,l/1e3)?n:l;const a=Math.pow(10,Math.floor(My(l))),o=l/a;return(o<=1?1:o<=2?2:o<=5?5:10)*a}function M3(l){const n=[],a=Math.sqrt(l);let o;for(o=1;o<a;o++)l%o===0&&(n.push(o),n.push(l/o));return a===(a|0)&&n.push(a),n.sort((s,e)=>s-e).pop(),n}function L3(l){return typeof l=="symbol"||typeof l=="object"&&l!==null&&!(Symbol.toPrimitive in l||"toString"in l||"valueOf"in l)}function Qu(l){return!L3(l)&&!isNaN(parseFloat(l))&&isFinite(l)}function R3(l,n){const a=Math.round(l);return a-n<=l&&a+n>=l}function O3(l,n,a){let o,s,e;for(o=0,s=l.length;o<s;o++)e=l[o][a],isNaN(e)||(n.min=Math.min(n.min,e),n.max=Math.max(n.max,e))}function Bl(l){return l*(pr/180)}function P3(l){return l*(180/pr)}function m2(l){if(!fn(l))return;let n=1,a=0;for(;Math.round(l*n)/n!==l;)n*=10,a++;return a}function Ly(l,n){const a=n.x-l.x,o=n.y-l.y,s=Math.sqrt(a*a+o*o);let e=Math.atan2(o,a);return e<-.5*pr&&(e+=Zr),{angle:e,distance:s}}function Y1(l,n){return Math.sqrt(Math.pow(n.x-l.x,2)+Math.pow(n.y-l.y,2))}function I3(l,n){return(l-n+_3)%Zr-pr}function li(l){return(l%Zr+Zr)%Zr}function om(l,n,a,o){const s=li(l),e=li(n),m=li(a),v=li(e-s),w=li(m-s),N=li(s-e),S=li(s-m);return s===e||s===m||o&&e===m||v>w&&N<S}function un(l,n,a){return Math.max(n,Math.min(a,l))}function B3(l){return un(l,-32768,32767)}function Lo(l,n,a,o=1e-6){return l>=Math.min(n,a)-o&&l<=Math.max(n,a)+o}function px(l,n,a){a=a||(m=>l[m]<n);let o=l.length-1,s=0,e;for(;o-s>1;)e=s+o>>1,a(e)?s=e:o=e;return{lo:s,hi:o}}const Zd=(l,n,a,o)=>px(l,a,o?s=>{const e=l[s][n];return e<a||e===a&&l[s+1][n]===a}:s=>l[s][n]<a),z3=(l,n,a)=>px(l,a,o=>l[o][n]>=a);function U3(l,n,a){let o=0,s=l.length;for(;o<s&&l[o]<n;)o++;for(;s>o&&l[s-1]>a;)s--;return o>0||s<l.length?l.slice(o,s):l}const Ry=["push","pop","shift","splice","unshift"];function H3(l,n){if(l._chartjs){l._chartjs.listeners.push(n);return}Object.defineProperty(l,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[n]}}),Ry.forEach(a=>{const o="_onData"+gx(a),s=l[a];Object.defineProperty(l,a,{configurable:!0,enumerable:!1,value(...e){const m=s.apply(this,e);return l._chartjs.listeners.forEach(v=>{typeof v[o]=="function"&&v[o](...e)}),m}})})}function g2(l,n){const a=l._chartjs;if(!a)return;const o=a.listeners,s=o.indexOf(n);s!==-1&&o.splice(s,1),!(o.length>0)&&(Ry.forEach(e=>{delete l[e]}),delete l._chartjs)}function Oy(l){const n=new Set(l);return n.size===l.length?l:Array.from(n)}const Py=(function(){return typeof window>"u"?function(l){return l()}:window.requestAnimationFrame})();function Iy(l,n){let a=[],o=!1;return function(...s){a=s,o||(o=!0,Py.call(window,()=>{o=!1,l.apply(n,a)}))}}function V3(l,n){let a;return function(...o){return n?(clearTimeout(a),a=setTimeout(l,n,o)):l.apply(this,o),n}}const xx=l=>l==="start"?"left":l==="end"?"right":"center",cn=(l,n,a)=>l==="start"?n:l==="end"?a:(n+a)/2,W3=(l,n,a,o)=>l===(o?"left":"right")?a:l==="center"?(n+a)/2:n;function By(l,n,a){const o=n.length;let s=0,e=o;if(l._sorted){const{iScale:m,vScale:v,_parsed:w}=l,N=l.dataset&&l.dataset.options?l.dataset.options.spanGaps:null,S=m.axis,{min:D,max:L,minDefined:M,maxDefined:F}=m.getUserBounds();if(M){if(s=Math.min(Zd(w,S,D).lo,a?o:Zd(n,S,m.getPixelForValue(D)).lo),N){const O=w.slice(0,s+1).reverse().findIndex(P=>!ur(P[v.axis]));s-=Math.max(0,O)}s=un(s,0,o-1)}if(F){let O=Math.max(Zd(w,m.axis,L,!0).hi+1,a?0:Zd(n,S,m.getPixelForValue(L),!0).hi+1);if(N){const P=w.slice(O-1).findIndex(K=>!ur(K[v.axis]));O+=Math.max(0,P)}e=un(O,s,o)-s}else e=o-s}return{start:s,count:e}}function zy(l){const{xScale:n,yScale:a,_scaleRanges:o}=l,s={xmin:n.min,xmax:n.max,ymin:a.min,ymax:a.max};if(!o)return l._scaleRanges=s,!0;const e=o.xmin!==n.min||o.xmax!==n.max||o.ymin!==a.min||o.ymax!==a.max;return Object.assign(o,s),e}const Yg=l=>l===0||l===1,p2=(l,n,a)=>-(Math.pow(2,10*(l-=1))*Math.sin((l-n)*Zr/a)),x2=(l,n,a)=>Math.pow(2,-10*l)*Math.sin((l-n)*Zr/a)+1,sm={linear:l=>l,easeInQuad:l=>l*l,easeOutQuad:l=>-l*(l-2),easeInOutQuad:l=>(l/=.5)<1?.5*l*l:-.5*(--l*(l-2)-1),easeInCubic:l=>l*l*l,easeOutCubic:l=>(l-=1)*l*l+1,easeInOutCubic:l=>(l/=.5)<1?.5*l*l*l:.5*((l-=2)*l*l+2),easeInQuart:l=>l*l*l*l,easeOutQuart:l=>-((l-=1)*l*l*l-1),easeInOutQuart:l=>(l/=.5)<1?.5*l*l*l*l:-.5*((l-=2)*l*l*l-2),easeInQuint:l=>l*l*l*l*l,easeOutQuint:l=>(l-=1)*l*l*l*l+1,easeInOutQuint:l=>(l/=.5)<1?.5*l*l*l*l*l:.5*((l-=2)*l*l*l*l+2),easeInSine:l=>-Math.cos(l*Ta)+1,easeOutSine:l=>Math.sin(l*Ta),easeInOutSine:l=>-.5*(Math.cos(pr*l)-1),easeInExpo:l=>l===0?0:Math.pow(2,10*(l-1)),easeOutExpo:l=>l===1?1:-Math.pow(2,-10*l)+1,easeInOutExpo:l=>Yg(l)?l:l<.5?.5*Math.pow(2,10*(l*2-1)):.5*(-Math.pow(2,-10*(l*2-1))+2),easeInCirc:l=>l>=1?l:-(Math.sqrt(1-l*l)-1),easeOutCirc:l=>Math.sqrt(1-(l-=1)*l),easeInOutCirc:l=>(l/=.5)<1?-.5*(Math.sqrt(1-l*l)-1):.5*(Math.sqrt(1-(l-=2)*l)+1),easeInElastic:l=>Yg(l)?l:p2(l,.075,.3),easeOutElastic:l=>Yg(l)?l:x2(l,.075,.3),easeInOutElastic(l){return Yg(l)?l:l<.5?.5*p2(l*2,.1125,.45):.5+.5*x2(l*2-1,.1125,.45)},easeInBack(l){return l*l*((1.70158+1)*l-1.70158)},easeOutBack(l){return(l-=1)*l*((1.70158+1)*l+1.70158)+1},easeInOutBack(l){let n=1.70158;return(l/=.5)<1?.5*(l*l*(((n*=1.525)+1)*l-n)):.5*((l-=2)*l*(((n*=1.525)+1)*l+n)+2)},easeInBounce:l=>1-sm.easeOutBounce(1-l),easeOutBounce(l){return l<1/2.75?7.5625*l*l:l<2/2.75?7.5625*(l-=1.5/2.75)*l+.75:l<2.5/2.75?7.5625*(l-=2.25/2.75)*l+.9375:7.5625*(l-=2.625/2.75)*l+.984375},easeInOutBounce:l=>l<.5?sm.easeInBounce(l*2)*.5:sm.easeOutBounce(l*2-1)*.5+.5};function bx(l){if(l&&typeof l=="object"){const n=l.toString();return n==="[object CanvasPattern]"||n==="[object CanvasGradient]"}return!1}function b2(l){return bx(l)?l:new nm(l)}function b1(l){return bx(l)?l:new nm(l).saturate(.5).darken(.1).hexString()}const $3=["x","y","borderWidth","radius","tension"],q3=["color","borderColor","backgroundColor"];function Y3(l){l.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),l.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:n=>n!=="onProgress"&&n!=="onComplete"&&n!=="fn"}),l.set("animations",{colors:{type:"color",properties:q3},numbers:{type:"number",properties:$3}}),l.describe("animations",{_fallback:"animation"}),l.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:n=>n|0}}}})}function G3(l){l.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const y2=new Map;function K3(l,n){n=n||{};const a=l+JSON.stringify(n);let o=y2.get(a);return o||(o=new Intl.NumberFormat(l,n),y2.set(a,o)),o}function Fp(l,n,a){return K3(n,a).format(l)}const Q3={values(l){return Na(l)?l:""+l},numeric(l,n,a){if(l===0)return"0";const o=this.chart.options.locale;let s,e=l;if(a.length>1){const N=Math.max(Math.abs(a[0].value),Math.abs(a[a.length-1].value));(N<1e-4||N>1e15)&&(s="scientific"),e=X3(l,a)}const m=My(Math.abs(e)),v=isNaN(m)?1:Math.max(Math.min(-1*Math.floor(m),20),0),w={notation:s,minimumFractionDigits:v,maximumFractionDigits:v};return Object.assign(w,this.options.ticks.format),Fp(l,o,w)}};function X3(l,n){let a=n.length>3?n[2].value-n[1].value:n[1].value-n[0].value;return Math.abs(a)>=1&&l!==Math.floor(l)&&(a=l-Math.floor(l)),a}var Uy={formatters:Q3};function J3(l){l.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(n,a)=>a.lineWidth,tickColor:(n,a)=>a.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Uy.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),l.route("scale.ticks","color","","color"),l.route("scale.grid","color","","borderColor"),l.route("scale.border","color","","borderColor"),l.route("scale.title","color","","color"),l.describe("scale",{_fallback:!1,_scriptable:n=>!n.startsWith("before")&&!n.startsWith("after")&&n!=="callback"&&n!=="parser",_indexable:n=>n!=="borderDash"&&n!=="tickBorderDash"&&n!=="dash"}),l.describe("scales",{_fallback:"scale"}),l.describe("scale.ticks",{_scriptable:n=>n!=="backdropPadding"&&n!=="callback",_indexable:n=>n!=="backdropPadding"})}const r0=Object.create(null),G1=Object.create(null);function rm(l,n){if(!n)return l;const a=n.split(".");for(let o=0,s=a.length;o<s;++o){const e=a[o];l=l[e]||(l[e]=Object.create(null))}return l}function y1(l,n,a){return typeof n=="string"?im(rm(l,n),a):im(rm(l,""),n)}class Z3{constructor(n,a){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,s)=>b1(s.backgroundColor),this.hoverBorderColor=(o,s)=>b1(s.borderColor),this.hoverColor=(o,s)=>b1(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(n),this.apply(a)}set(n,a){return y1(this,n,a)}get(n){return rm(this,n)}describe(n,a){return y1(G1,n,a)}override(n,a){return y1(r0,n,a)}route(n,a,o,s){const e=rm(this,n),m=rm(this,o),v="_"+a;Object.defineProperties(e,{[v]:{value:e[a],writable:!0},[a]:{enumerable:!0,get(){const w=this[v],N=m[s];return Qs(w)?Object.assign({},N,w):Ts(w,N)},set(w){this[v]=w}}})}apply(n){n.forEach(a=>a(this))}}var fa=new Z3({_scriptable:l=>!l.startsWith("on"),_indexable:l=>l!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Y3,G3,J3]);function ej(l){return!l||ur(l.size)||ur(l.family)?null:(l.style?l.style+" ":"")+(l.weight?l.weight+" ":"")+l.size+"px "+l.family}function v2(l,n,a,o,s){let e=n[s];return e||(e=n[s]=l.measureText(s).width,a.push(s)),e>o&&(o=e),o}function Gd(l,n,a){const o=l.currentDevicePixelRatio,s=a!==0?Math.max(a/2,.5):0;return Math.round((n-s)*o)/o+s}function w2(l,n){!n&&!l||(n=n||l.getContext("2d"),n.save(),n.resetTransform(),n.clearRect(0,0,l.width,l.height),n.restore())}function K1(l,n,a,o){Hy(l,n,a,o,null)}function Hy(l,n,a,o,s){let e,m,v,w,N,S,D,L;const M=n.pointStyle,F=n.rotation,O=n.radius;let P=(F||0)*F3;if(M&&typeof M=="object"&&(e=M.toString(),e==="[object HTMLImageElement]"||e==="[object HTMLCanvasElement]")){l.save(),l.translate(a,o),l.rotate(P),l.drawImage(M,-M.width/2,-M.height/2,M.width,M.height),l.restore();return}if(!(isNaN(O)||O<=0)){switch(l.beginPath(),M){default:s?l.ellipse(a,o,s/2,O,0,0,Zr):l.arc(a,o,O,0,Zr),l.closePath();break;case"triangle":S=s?s/2:O,l.moveTo(a+Math.sin(P)*S,o-Math.cos(P)*O),P+=h2,l.lineTo(a+Math.sin(P)*S,o-Math.cos(P)*O),P+=h2,l.lineTo(a+Math.sin(P)*S,o-Math.cos(P)*O),l.closePath();break;case"rectRounded":N=O*.516,w=O-N,m=Math.cos(P+Yd)*w,D=Math.cos(P+Yd)*(s?s/2-N:w),v=Math.sin(P+Yd)*w,L=Math.sin(P+Yd)*(s?s/2-N:w),l.arc(a-D,o-v,N,P-pr,P-Ta),l.arc(a+L,o-m,N,P-Ta,P),l.arc(a+D,o+v,N,P,P+Ta),l.arc(a-L,o+m,N,P+Ta,P+pr),l.closePath();break;case"rect":if(!F){w=Math.SQRT1_2*O,S=s?s/2:w,l.rect(a-S,o-w,2*S,2*w);break}P+=Yd;case"rectRot":D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+L,o-m),l.lineTo(a+D,o+v),l.lineTo(a-L,o+m),l.closePath();break;case"crossRot":P+=Yd;case"cross":D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+D,o+v),l.moveTo(a+L,o-m),l.lineTo(a-L,o+m);break;case"star":D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+D,o+v),l.moveTo(a+L,o-m),l.lineTo(a-L,o+m),P+=Yd,D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+D,o+v),l.moveTo(a+L,o-m),l.lineTo(a-L,o+m);break;case"line":m=s?s/2:Math.cos(P)*O,v=Math.sin(P)*O,l.moveTo(a-m,o-v),l.lineTo(a+m,o+v);break;case"dash":l.moveTo(a,o),l.lineTo(a+Math.cos(P)*(s?s/2:O),o+Math.sin(P)*O);break;case!1:l.closePath();break}l.fill(),n.borderWidth>0&&l.stroke()}}function cm(l,n,a){return a=a||.5,!n||l&&l.x>n.left-a&&l.x<n.right+a&&l.y>n.top-a&&l.y<n.bottom+a}function Mp(l,n){l.save(),l.beginPath(),l.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),l.clip()}function Lp(l){l.restore()}function tj(l,n,a,o,s){if(!n)return l.lineTo(a.x,a.y);if(s==="middle"){const e=(n.x+a.x)/2;l.lineTo(e,n.y),l.lineTo(e,a.y)}else s==="after"!=!!o?l.lineTo(n.x,a.y):l.lineTo(a.x,n.y);l.lineTo(a.x,a.y)}function sj(l,n,a,o){if(!n)return l.lineTo(a.x,a.y);l.bezierCurveTo(o?n.cp1x:n.cp2x,o?n.cp1y:n.cp2y,o?a.cp2x:a.cp1x,o?a.cp2y:a.cp1y,a.x,a.y)}function rj(l,n){n.translation&&l.translate(n.translation[0],n.translation[1]),ur(n.rotation)||l.rotate(n.rotation),n.color&&(l.fillStyle=n.color),n.textAlign&&(l.textAlign=n.textAlign),n.textBaseline&&(l.textBaseline=n.textBaseline)}function aj(l,n,a,o,s){if(s.strikethrough||s.underline){const e=l.measureText(o),m=n-e.actualBoundingBoxLeft,v=n+e.actualBoundingBoxRight,w=a-e.actualBoundingBoxAscent,N=a+e.actualBoundingBoxDescent,S=s.strikethrough?(w+N)/2:N;l.strokeStyle=l.fillStyle,l.beginPath(),l.lineWidth=s.decorationWidth||2,l.moveTo(m,S),l.lineTo(v,S),l.stroke()}}function nj(l,n){const a=l.fillStyle;l.fillStyle=n.color,l.fillRect(n.left,n.top,n.width,n.height),l.fillStyle=a}function dm(l,n,a,o,s,e={}){const m=Na(n)?n:[n],v=e.strokeWidth>0&&e.strokeColor!=="";let w,N;for(l.save(),l.font=s.string,rj(l,e),w=0;w<m.length;++w)N=m[w],e.backdrop&&nj(l,e.backdrop),v&&(e.strokeColor&&(l.strokeStyle=e.strokeColor),ur(e.strokeWidth)||(l.lineWidth=e.strokeWidth),l.strokeText(N,a,o,e.maxWidth)),l.fillText(N,a,o,e.maxWidth),aj(l,a,o,N,e),o+=Number(s.lineHeight);l.restore()}function wp(l,n){const{x:a,y:o,w:s,h:e,radius:m}=n;l.arc(a+m.topLeft,o+m.topLeft,m.topLeft,1.5*pr,pr,!0),l.lineTo(a,o+e-m.bottomLeft),l.arc(a+m.bottomLeft,o+e-m.bottomLeft,m.bottomLeft,pr,Ta,!0),l.lineTo(a+s-m.bottomRight,o+e),l.arc(a+s-m.bottomRight,o+e-m.bottomRight,m.bottomRight,Ta,0,!0),l.lineTo(a+s,o+m.topRight),l.arc(a+s-m.topRight,o+m.topRight,m.topRight,0,-Ta,!0),l.lineTo(a+m.topLeft,o)}const ij=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,lj=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function oj(l,n){const a=(""+l).match(ij);if(!a||a[1]==="normal")return n*1.2;switch(l=+a[2],a[3]){case"px":return l;case"%":l/=100;break}return n*l}const cj=l=>+l||0;function yx(l,n){const a={},o=Qs(n),s=o?Object.keys(n):n,e=Qs(l)?o?m=>Ts(l[m],l[n[m]]):m=>l[m]:()=>l;for(const m of s)a[m]=cj(e(m));return a}function Vy(l){return yx(l,{top:"y",right:"x",bottom:"y",left:"x"})}function Yu(l){return yx(l,["topLeft","topRight","bottomLeft","bottomRight"])}function _i(l){const n=Vy(l);return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function hn(l,n){l=l||{},n=n||fa.font;let a=Ts(l.size,n.size);typeof a=="string"&&(a=parseInt(a,10));let o=Ts(l.style,n.style);o&&!(""+o).match(lj)&&(console.warn('Invalid font style specified: "'+o+'"'),o=void 0);const s={family:Ts(l.family,n.family),lineHeight:oj(Ts(l.lineHeight,n.lineHeight),a),size:a,style:o,weight:Ts(l.weight,n.weight),string:""};return s.string=ej(s),s}function Gg(l,n,a,o){let s,e,m;for(s=0,e=l.length;s<e;++s)if(m=l[s],m!==void 0&&m!==void 0)return m}function dj(l,n,a){const{min:o,max:s}=l,e=_y(n,(s-o)/2),m=(v,w)=>a&&v===0?0:v+w;return{min:m(o,-Math.abs(e)),max:m(s,e)}}function l0(l,n){return Object.assign(Object.create(l),n)}function vx(l,n=[""],a,o,s=()=>l[0]){const e=a||l;typeof o>"u"&&(o=Yy("_fallback",l));const m={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:l,_rootScopes:e,_fallback:o,_getTarget:s,override:v=>vx([v,...l],n,e,o)};return new Proxy(m,{deleteProperty(v,w){return delete v[w],delete v._keys,delete l[0][w],!0},get(v,w){return $y(v,w,()=>bj(w,n,l,v))},getOwnPropertyDescriptor(v,w){return Reflect.getOwnPropertyDescriptor(v._scopes[0],w)},getPrototypeOf(){return Reflect.getPrototypeOf(l[0])},has(v,w){return N2(v).includes(w)},ownKeys(v){return N2(v)},set(v,w,N){const S=v._storage||(v._storage=s());return v[w]=S[w]=N,delete v._keys,!0}})}function Xu(l,n,a,o){const s={_cacheable:!1,_proxy:l,_context:n,_subProxy:a,_stack:new Set,_descriptors:Wy(l,o),setContext:e=>Xu(l,e,a,o),override:e=>Xu(l.override(e),n,a,o)};return new Proxy(s,{deleteProperty(e,m){return delete e[m],delete l[m],!0},get(e,m,v){return $y(e,m,()=>hj(e,m,v))},getOwnPropertyDescriptor(e,m){return e._descriptors.allKeys?Reflect.has(l,m)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(l,m)},getPrototypeOf(){return Reflect.getPrototypeOf(l)},has(e,m){return Reflect.has(l,m)},ownKeys(){return Reflect.ownKeys(l)},set(e,m,v){return l[m]=v,delete e[m],!0}})}function Wy(l,n={scriptable:!0,indexable:!0}){const{_scriptable:a=n.scriptable,_indexable:o=n.indexable,_allKeys:s=n.allKeys}=l;return{allKeys:s,scriptable:a,indexable:o,isScriptable:Oc(a)?a:()=>a,isIndexable:Oc(o)?o:()=>o}}const uj=(l,n)=>l?l+gx(n):n,wx=(l,n)=>Qs(n)&&l!=="adapters"&&(Object.getPrototypeOf(n)===null||n.constructor===Object);function $y(l,n,a){if(Object.prototype.hasOwnProperty.call(l,n)||n==="constructor")return l[n];const o=a();return l[n]=o,o}function hj(l,n,a){const{_proxy:o,_context:s,_subProxy:e,_descriptors:m}=l;let v=o[n];return Oc(v)&&m.isScriptable(n)&&(v=fj(n,v,l,a)),Na(v)&&v.length&&(v=mj(n,v,l,m.isIndexable)),wx(n,v)&&(v=Xu(v,s,e&&e[n],m)),v}function fj(l,n,a,o){const{_proxy:s,_context:e,_subProxy:m,_stack:v}=a;if(v.has(l))throw new Error("Recursion detected: "+Array.from(v).join("->")+"->"+l);v.add(l);let w=n(e,m||o);return v.delete(l),wx(l,w)&&(w=jx(s._scopes,s,l,w)),w}function mj(l,n,a,o){const{_proxy:s,_context:e,_subProxy:m,_descriptors:v}=a;if(typeof e.index<"u"&&o(l))return n[e.index%n.length];if(Qs(n[0])){const w=n,N=s._scopes.filter(S=>S!==w);n=[];for(const S of w){const D=jx(N,s,l,S);n.push(Xu(D,e,m&&m[l],v))}}return n}function qy(l,n,a){return Oc(l)?l(n,a):l}const gj=(l,n)=>l===!0?n:typeof l=="string"?Rc(n,l):void 0;function pj(l,n,a,o,s){for(const e of n){const m=gj(a,e);if(m){l.add(m);const v=qy(m._fallback,a,s);if(typeof v<"u"&&v!==a&&v!==o)return v}else if(m===!1&&typeof o<"u"&&a!==o)return null}return!1}function jx(l,n,a,o){const s=n._rootScopes,e=qy(n._fallback,a,o),m=[...l,...s],v=new Set;v.add(o);let w=j2(v,m,a,e||a,o);return w===null||typeof e<"u"&&e!==a&&(w=j2(v,m,e,w,o),w===null)?!1:vx(Array.from(v),[""],s,e,()=>xj(n,a,o))}function j2(l,n,a,o,s){for(;a;)a=pj(l,n,a,o,s);return a}function xj(l,n,a){const o=l._getTarget();n in o||(o[n]={});const s=o[n];return Na(s)&&Qs(a)?a:s||{}}function bj(l,n,a,o){let s;for(const e of n)if(s=Yy(uj(e,l),a),typeof s<"u")return wx(l,s)?jx(a,o,l,s):s}function Yy(l,n){for(const a of n){if(!a)continue;const o=a[l];if(typeof o<"u")return o}}function N2(l){let n=l._keys;return n||(n=l._keys=yj(l._scopes)),n}function yj(l){const n=new Set;for(const a of l)for(const o of Object.keys(a).filter(s=>!s.startsWith("_")))n.add(o);return Array.from(n)}function Gy(l,n,a,o){const{iScale:s}=l,{key:e="r"}=this._parsing,m=new Array(o);let v,w,N,S;for(v=0,w=o;v<w;++v)N=v+a,S=n[N],m[v]={r:s.parse(Rc(S,e),N)};return m}const vj=Number.EPSILON||1e-14,Ju=(l,n)=>n<l.length&&!l[n].skip&&l[n],Ky=l=>l==="x"?"y":"x";function wj(l,n,a,o){const s=l.skip?n:l,e=n,m=a.skip?n:a,v=Y1(e,s),w=Y1(m,e);let N=v/(v+w),S=w/(v+w);N=isNaN(N)?0:N,S=isNaN(S)?0:S;const D=o*N,L=o*S;return{previous:{x:e.x-D*(m.x-s.x),y:e.y-D*(m.y-s.y)},next:{x:e.x+L*(m.x-s.x),y:e.y+L*(m.y-s.y)}}}function jj(l,n,a){const o=l.length;let s,e,m,v,w,N=Ju(l,0);for(let S=0;S<o-1;++S)if(w=N,N=Ju(l,S+1),!(!w||!N)){if(tm(n[S],0,vj)){a[S]=a[S+1]=0;continue}s=a[S]/n[S],e=a[S+1]/n[S],v=Math.pow(s,2)+Math.pow(e,2),!(v<=9)&&(m=3/Math.sqrt(v),a[S]=s*m*n[S],a[S+1]=e*m*n[S])}}function Nj(l,n,a="x"){const o=Ky(a),s=l.length;let e,m,v,w=Ju(l,0);for(let N=0;N<s;++N){if(m=v,v=w,w=Ju(l,N+1),!v)continue;const S=v[a],D=v[o];m&&(e=(S-m[a])/3,v[`cp1${a}`]=S-e,v[`cp1${o}`]=D-e*n[N]),w&&(e=(w[a]-S)/3,v[`cp2${a}`]=S+e,v[`cp2${o}`]=D+e*n[N])}}function kj(l,n="x"){const a=Ky(n),o=l.length,s=Array(o).fill(0),e=Array(o);let m,v,w,N=Ju(l,0);for(m=0;m<o;++m)if(v=w,w=N,N=Ju(l,m+1),!!w){if(N){const S=N[n]-w[n];s[m]=S!==0?(N[a]-w[a])/S:0}e[m]=v?N?zl(s[m-1])!==zl(s[m])?0:(s[m-1]+s[m])/2:s[m-1]:s[m]}jj(l,s,e),Nj(l,e,n)}function Kg(l,n,a){return Math.max(Math.min(l,a),n)}function Cj(l,n){let a,o,s,e,m,v=cm(l[0],n);for(a=0,o=l.length;a<o;++a)m=e,e=v,v=a<o-1&&cm(l[a+1],n),e&&(s=l[a],m&&(s.cp1x=Kg(s.cp1x,n.left,n.right),s.cp1y=Kg(s.cp1y,n.top,n.bottom)),v&&(s.cp2x=Kg(s.cp2x,n.left,n.right),s.cp2y=Kg(s.cp2y,n.top,n.bottom)))}function Sj(l,n,a,o,s){let e,m,v,w;if(n.spanGaps&&(l=l.filter(N=>!N.skip)),n.cubicInterpolationMode==="monotone")kj(l,s);else{let N=o?l[l.length-1]:l[0];for(e=0,m=l.length;e<m;++e)v=l[e],w=wj(N,v,l[Math.min(e+1,m-(o?0:1))%m],n.tension),v.cp1x=w.previous.x,v.cp1y=w.previous.y,v.cp2x=w.next.x,v.cp2y=w.next.y,N=v}n.capBezierPoints&&Cj(l,a)}function Nx(){return typeof window<"u"&&typeof document<"u"}function kx(l){let n=l.parentNode;return n&&n.toString()==="[object ShadowRoot]"&&(n=n.host),n}function jp(l,n,a){let o;return typeof l=="string"?(o=parseInt(l,10),l.indexOf("%")!==-1&&(o=o/100*n.parentNode[a])):o=l,o}const Rp=l=>l.ownerDocument.defaultView.getComputedStyle(l,null);function Aj(l,n){return Rp(l).getPropertyValue(n)}const Ej=["top","right","bottom","left"];function t0(l,n,a){const o={};a=a?"-"+a:"";for(let s=0;s<4;s++){const e=Ej[s];o[e]=parseFloat(l[n+"-"+e+a])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const Dj=(l,n,a)=>(l>0||n>0)&&(!a||!a.shadowRoot);function Tj(l,n){const a=l.touches,o=a&&a.length?a[0]:l,{offsetX:s,offsetY:e}=o;let m=!1,v,w;if(Dj(s,e,l.target))v=s,w=e;else{const N=n.getBoundingClientRect();v=o.clientX-N.left,w=o.clientY-N.top,m=!0}return{x:v,y:w,box:m}}function Qd(l,n){if("native"in l)return l;const{canvas:a,currentDevicePixelRatio:o}=n,s=Rp(a),e=s.boxSizing==="border-box",m=t0(s,"padding"),v=t0(s,"border","width"),{x:w,y:N,box:S}=Tj(l,a),D=m.left+(S&&v.left),L=m.top+(S&&v.top);let{width:M,height:F}=n;return e&&(M-=m.width+v.width,F-=m.height+v.height),{x:Math.round((w-D)/M*a.width/o),y:Math.round((N-L)/F*a.height/o)}}function _j(l,n,a){let o,s;if(n===void 0||a===void 0){const e=l&&kx(l);if(!e)n=l.clientWidth,a=l.clientHeight;else{const m=e.getBoundingClientRect(),v=Rp(e),w=t0(v,"border","width"),N=t0(v,"padding");n=m.width-N.width-w.width,a=m.height-N.height-w.height,o=jp(v.maxWidth,e,"clientWidth"),s=jp(v.maxHeight,e,"clientHeight")}}return{width:n,height:a,maxWidth:o||vp,maxHeight:s||vp}}const Fc=l=>Math.round(l*10)/10;function Fj(l,n,a,o){const s=Rp(l),e=t0(s,"margin"),m=jp(s.maxWidth,l,"clientWidth")||vp,v=jp(s.maxHeight,l,"clientHeight")||vp,w=_j(l,n,a);let{width:N,height:S}=w;if(s.boxSizing==="content-box"){const L=t0(s,"border","width"),M=t0(s,"padding");N-=M.width+L.width,S-=M.height+L.height}return N=Math.max(0,N-e.width),S=Math.max(0,o?N/o:S-e.height),N=Fc(Math.min(N,m,w.maxWidth)),S=Fc(Math.min(S,v,w.maxHeight)),N&&!S&&(S=Fc(N/2)),(n!==void 0||a!==void 0)&&o&&w.height&&S>w.height&&(S=w.height,N=Fc(Math.floor(S*o))),{width:N,height:S}}function k2(l,n,a){const o=n||1,s=Fc(l.height*o),e=Fc(l.width*o);l.height=Fc(l.height),l.width=Fc(l.width);const m=l.canvas;return m.style&&(a||!m.style.height&&!m.style.width)&&(m.style.height=`${l.height}px`,m.style.width=`${l.width}px`),l.currentDevicePixelRatio!==o||m.height!==s||m.width!==e?(l.currentDevicePixelRatio=o,m.height=s,m.width=e,l.ctx.setTransform(o,0,0,o,0,0),!0):!1}const Mj=(function(){let l=!1;try{const n={get passive(){return l=!0,!1}};Nx()&&(window.addEventListener("test",null,n),window.removeEventListener("test",null,n))}catch{}return l})();function C2(l,n){const a=Aj(l,n),o=a&&a.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:void 0}function Xd(l,n,a,o){return{x:l.x+a*(n.x-l.x),y:l.y+a*(n.y-l.y)}}function Lj(l,n,a,o){return{x:l.x+a*(n.x-l.x),y:o==="middle"?a<.5?l.y:n.y:o==="after"?a<1?l.y:n.y:a>0?n.y:l.y}}function Rj(l,n,a,o){const s={x:l.cp2x,y:l.cp2y},e={x:n.cp1x,y:n.cp1y},m=Xd(l,s,a),v=Xd(s,e,a),w=Xd(e,n,a),N=Xd(m,v,a),S=Xd(v,w,a);return Xd(N,S,a)}const Oj=function(l,n){return{x(a){return l+l+n-a},setWidth(a){n=a},textAlign(a){return a==="center"?a:a==="right"?"left":"right"},xPlus(a,o){return a-o},leftForLtr(a,o){return a-o}}},Pj=function(){return{x(l){return l},setWidth(l){},textAlign(l){return l},xPlus(l,n){return l+n},leftForLtr(l,n){return l}}};function Gu(l,n,a){return l?Oj(n,a):Pj()}function Qy(l,n){let a,o;(n==="ltr"||n==="rtl")&&(a=l.canvas.style,o=[a.getPropertyValue("direction"),a.getPropertyPriority("direction")],a.setProperty("direction",n,"important"),l.prevTextDirection=o)}function Xy(l,n){n!==void 0&&(delete l.prevTextDirection,l.canvas.style.setProperty("direction",n[0],n[1]))}function Jy(l){return l==="angle"?{between:om,compare:I3,normalize:li}:{between:Lo,compare:(n,a)=>n-a,normalize:n=>n}}function S2({start:l,end:n,count:a,loop:o,style:s}){return{start:l%a,end:n%a,loop:o&&(n-l+1)%a===0,style:s}}function Ij(l,n,a){const{property:o,start:s,end:e}=a,{between:m,normalize:v}=Jy(o),w=n.length;let{start:N,end:S,loop:D}=l,L,M;if(D){for(N+=w,S+=w,L=0,M=w;L<M&&m(v(n[N%w][o]),s,e);++L)N--,S--;N%=w,S%=w}return S<N&&(S+=w),{start:N,end:S,loop:D,style:l.style}}function Zy(l,n,a){if(!a)return[l];const{property:o,start:s,end:e}=a,m=n.length,{compare:v,between:w,normalize:N}=Jy(o),{start:S,end:D,loop:L,style:M}=Ij(l,n,a),F=[];let O=!1,P=null,K,ne,se;const Ce=()=>w(s,se,K)&&v(s,se)!==0,ge=()=>v(e,K)===0||w(e,se,K),Ne=()=>O||Ce(),J=()=>!O||ge();for(let de=S,le=S;de<=D;++de)ne=n[de%m],!ne.skip&&(K=N(ne[o]),K!==se&&(O=w(K,s,e),P===null&&Ne()&&(P=v(K,s)===0?de:le),P!==null&&J()&&(F.push(S2({start:P,end:de,loop:L,count:m,style:M})),P=null),le=de,se=K));return P!==null&&F.push(S2({start:P,end:D,loop:L,count:m,style:M})),F}function ev(l,n){const a=[],o=l.segments;for(let s=0;s<o.length;s++){const e=Zy(o[s],l.points,n);e.length&&a.push(...e)}return a}function Bj(l,n,a,o){let s=0,e=n-1;if(a&&!o)for(;s<n&&!l[s].skip;)s++;for(;s<n&&l[s].skip;)s++;for(s%=n,a&&(e+=s);e>s&&l[e%n].skip;)e--;return e%=n,{start:s,end:e}}function zj(l,n,a,o){const s=l.length,e=[];let m=n,v=l[n],w;for(w=n+1;w<=a;++w){const N=l[w%s];N.skip||N.stop?v.skip||(o=!1,e.push({start:n%s,end:(w-1)%s,loop:o}),n=m=N.stop?w:null):(m=w,v.skip&&(n=w)),v=N}return m!==null&&e.push({start:n%s,end:m%s,loop:o}),e}function Uj(l,n){const a=l.points,o=l.options.spanGaps,s=a.length;if(!s)return[];const e=!!l._loop,{start:m,end:v}=Bj(a,s,e,o);if(o===!0)return A2(l,[{start:m,end:v,loop:e}],a,n);const w=v<m?v+s:v,N=!!l._fullLoop&&m===0&&v===s-1;return A2(l,zj(a,m,w,N),a,n)}function A2(l,n,a,o){return!o||!o.setContext||!a?n:Hj(l,n,a,o)}function Hj(l,n,a,o){const s=l._chart.getContext(),e=E2(l.options),{_datasetIndex:m,options:{spanGaps:v}}=l,w=a.length,N=[];let S=e,D=n[0].start,L=D;function M(F,O,P,K){const ne=v?-1:1;if(F!==O){for(F+=w;a[F%w].skip;)F-=ne;for(;a[O%w].skip;)O+=ne;F%w!==O%w&&(N.push({start:F%w,end:O%w,loop:P,style:K}),S=K,D=O%w)}}for(const F of n){D=v?D:F.start;let O=a[D%w],P;for(L=D+1;L<=F.end;L++){const K=a[L%w];P=E2(o.setContext(l0(s,{type:"segment",p0:O,p1:K,p0DataIndex:(L-1)%w,p1DataIndex:L%w,datasetIndex:m}))),Vj(P,S)&&M(D,L-1,F.loop,S),O=K,S=P}D<L-1&&M(D,L-1,F.loop,S)}return N}function E2(l){return{backgroundColor:l.backgroundColor,borderCapStyle:l.borderCapStyle,borderDash:l.borderDash,borderDashOffset:l.borderDashOffset,borderJoinStyle:l.borderJoinStyle,borderWidth:l.borderWidth,borderColor:l.borderColor}}function Vj(l,n){if(!n)return!1;const a=[],o=function(s,e){return bx(e)?(a.includes(e)||a.push(e),a.indexOf(e)):e};return JSON.stringify(l,o)!==JSON.stringify(n,o)}function Qg(l,n,a){return l.options.clip?l[a]:n[a]}function Wj(l,n){const{xScale:a,yScale:o}=l;return a&&o?{left:Qg(a,n,"left"),right:Qg(a,n,"right"),top:Qg(o,n,"top"),bottom:Qg(o,n,"bottom")}:n}function tv(l,n){const a=n._clip;if(a.disabled)return!1;const o=Wj(n,l.chartArea);return{left:a.left===!1?0:o.left-(a.left===!0?0:a.left),right:a.right===!1?l.width:o.right+(a.right===!0?0:a.right),top:a.top===!1?0:o.top-(a.top===!0?0:a.top),bottom:a.bottom===!1?l.height:o.bottom+(a.bottom===!0?0:a.bottom)}}class $j{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(n,a,o,s){const e=a.listeners[s],m=a.duration;e.forEach(v=>v({chart:n,initial:a.initial,numSteps:m,currentStep:Math.min(o-a.start,m)}))}_refresh(){this._request||(this._running=!0,this._request=Py.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(n=Date.now()){let a=0;this._charts.forEach((o,s)=>{if(!o.running||!o.items.length)return;const e=o.items;let m=e.length-1,v=!1,w;for(;m>=0;--m)w=e[m],w._active?(w._total>o.duration&&(o.duration=w._total),w.tick(n),v=!0):(e[m]=e[e.length-1],e.pop());v&&(s.draw(),this._notify(s,o,n,"progress")),e.length||(o.running=!1,this._notify(s,o,n,"complete"),o.initial=!1),a+=e.length}),this._lastDate=n,a===0&&(this._running=!1)}_getAnims(n){const a=this._charts;let o=a.get(n);return o||(o={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},a.set(n,o)),o}listen(n,a,o){this._getAnims(n).listeners[a].push(o)}add(n,a){!a||!a.length||this._getAnims(n).items.push(...a)}has(n){return this._getAnims(n).items.length>0}start(n){const a=this._charts.get(n);a&&(a.running=!0,a.start=Date.now(),a.duration=a.items.reduce((o,s)=>Math.max(o,s._duration),0),this._refresh())}running(n){if(!this._running)return!1;const a=this._charts.get(n);return!(!a||!a.running||!a.items.length)}stop(n){const a=this._charts.get(n);if(!a||!a.items.length)return;const o=a.items;let s=o.length-1;for(;s>=0;--s)o[s].cancel();a.items=[],this._notify(n,a,Date.now(),"complete")}remove(n){return this._charts.delete(n)}}var To=new $j;const D2="transparent",qj={boolean(l,n,a){return a>.5?n:l},color(l,n,a){const o=b2(l||D2),s=o.valid&&b2(n||D2);return s&&s.valid?s.mix(o,a).hexString():n},number(l,n,a){return l+(n-l)*a}};class Yj{constructor(n,a,o,s){const e=a[o];s=Gg([n.to,s,e,n.from]);const m=Gg([n.from,e,s]);this._active=!0,this._fn=n.fn||qj[n.type||typeof m],this._easing=sm[n.easing]||sm.linear,this._start=Math.floor(Date.now()+(n.delay||0)),this._duration=this._total=Math.floor(n.duration),this._loop=!!n.loop,this._target=a,this._prop=o,this._from=m,this._to=s,this._promises=void 0}active(){return this._active}update(n,a,o){if(this._active){this._notify(!1);const s=this._target[this._prop],e=o-this._start,m=this._duration-e;this._start=o,this._duration=Math.floor(Math.max(m,n.duration)),this._total+=e,this._loop=!!n.loop,this._to=Gg([n.to,a,s,n.from]),this._from=Gg([n.from,s,a])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(n){const a=n-this._start,o=this._duration,s=this._prop,e=this._from,m=this._loop,v=this._to;let w;if(this._active=e!==v&&(m||a<o),!this._active){this._target[s]=v,this._notify(!0);return}if(a<0){this._target[s]=e;return}w=a/o%2,w=m&&w>1?2-w:w,w=this._easing(Math.min(1,Math.max(0,w))),this._target[s]=this._fn(e,v,w)}wait(){const n=this._promises||(this._promises=[]);return new Promise((a,o)=>{n.push({res:a,rej:o})})}_notify(n){const a=n?"res":"rej",o=this._promises||[];for(let s=0;s<o.length;s++)o[s][a]()}}class sv{constructor(n,a){this._chart=n,this._properties=new Map,this.configure(a)}configure(n){if(!Qs(n))return;const a=Object.keys(fa.animation),o=this._properties;Object.getOwnPropertyNames(n).forEach(s=>{const e=n[s];if(!Qs(e))return;const m={};for(const v of a)m[v]=e[v];(Na(e.properties)&&e.properties||[s]).forEach(v=>{(v===s||!o.has(v))&&o.set(v,m)})})}_animateOptions(n,a){const o=a.options,s=Kj(n,o);if(!s)return[];const e=this._createAnimations(s,o);return o.$shared&&Gj(n.options.$animations,o).then(()=>{n.options=o},()=>{}),e}_createAnimations(n,a){const o=this._properties,s=[],e=n.$animations||(n.$animations={}),m=Object.keys(a),v=Date.now();let w;for(w=m.length-1;w>=0;--w){const N=m[w];if(N.charAt(0)==="$")continue;if(N==="options"){s.push(...this._animateOptions(n,a));continue}const S=a[N];let D=e[N];const L=o.get(N);if(D)if(L&&D.active()){D.update(L,S,v);continue}else D.cancel();if(!L||!L.duration){n[N]=S;continue}e[N]=D=new Yj(L,n,N,S),s.push(D)}return s}update(n,a){if(this._properties.size===0){Object.assign(n,a);return}const o=this._createAnimations(n,a);if(o.length)return To.add(this._chart,o),!0}}function Gj(l,n){const a=[],o=Object.keys(n);for(let s=0;s<o.length;s++){const e=l[o[s]];e&&e.active()&&a.push(e.wait())}return Promise.all(a)}function Kj(l,n){if(!n)return;let a=l.options;if(!a){l.options=n;return}return a.$shared&&(l.options=a=Object.assign({},a,{$shared:!1,$animations:{}})),a}function T2(l,n){const a=l&&l.options||{},o=a.reverse,s=a.min===void 0?n:0,e=a.max===void 0?n:0;return{start:o?e:s,end:o?s:e}}function Qj(l,n,a){if(a===!1)return!1;const o=T2(l,a),s=T2(n,a);return{top:s.end,right:o.end,bottom:s.start,left:o.start}}function Xj(l){let n,a,o,s;return Qs(l)?(n=l.top,a=l.right,o=l.bottom,s=l.left):n=a=o=s=l,{top:n,right:a,bottom:o,left:s,disabled:l===!1}}function rv(l,n){const a=[],o=l._getSortedDatasetMetas(n);let s,e;for(s=0,e=o.length;s<e;++s)a.push(o[s].index);return a}function _2(l,n,a,o={}){const s=l.keys,e=o.mode==="single";let m,v,w,N;if(n===null)return;let S=!1;for(m=0,v=s.length;m<v;++m){if(w=+s[m],w===a){if(S=!0,o.all)continue;break}N=l.values[w],fn(N)&&(e||n===0||zl(n)===zl(N))&&(n+=N)}return!S&&!o.all?0:n}function Jj(l,n){const{iScale:a,vScale:o}=n,s=a.axis==="x"?"x":"y",e=o.axis==="x"?"x":"y",m=Object.keys(l),v=new Array(m.length);let w,N,S;for(w=0,N=m.length;w<N;++w)S=m[w],v[w]={[s]:S,[e]:l[S]};return v}function v1(l,n){const a=l&&l.options.stacked;return a||a===void 0&&n.stack!==void 0}function Zj(l,n,a){return`${l.id}.${n.id}.${a.stack||a.type}`}function e6(l){const{min:n,max:a,minDefined:o,maxDefined:s}=l.getUserBounds();return{min:o?n:Number.NEGATIVE_INFINITY,max:s?a:Number.POSITIVE_INFINITY}}function t6(l,n,a){const o=l[n]||(l[n]={});return o[a]||(o[a]={})}function F2(l,n,a,o){for(const s of n.getMatchingVisibleMetas(o).reverse()){const e=l[s.index];if(a&&e>0||!a&&e<0)return s.index}return null}function M2(l,n){const{chart:a,_cachedMeta:o}=l,s=a._stacks||(a._stacks={}),{iScale:e,vScale:m,index:v}=o,w=e.axis,N=m.axis,S=Zj(e,m,o),D=n.length;let L;for(let M=0;M<D;++M){const F=n[M],{[w]:O,[N]:P}=F,K=F._stacks||(F._stacks={});L=K[N]=t6(s,S,O),L[v]=P,L._top=F2(L,m,!0,o.type),L._bottom=F2(L,m,!1,o.type);const ne=L._visualValues||(L._visualValues={});ne[v]=P}}function w1(l,n){const a=l.scales;return Object.keys(a).filter(o=>a[o].axis===n).shift()}function s6(l,n){return l0(l,{active:!1,dataset:void 0,datasetIndex:n,index:n,mode:"default",type:"dataset"})}function r6(l,n,a){return l0(l,{active:!1,dataIndex:n,parsed:void 0,raw:void 0,element:a,index:n,mode:"default",type:"data"})}function Wf(l,n){const a=l.controller.index,o=l.vScale&&l.vScale.axis;if(o){n=n||l._parsed;for(const s of n){const e=s._stacks;if(!e||e[o]===void 0||e[o][a]===void 0)return;delete e[o][a],e[o]._visualValues!==void 0&&e[o]._visualValues[a]!==void 0&&delete e[o]._visualValues[a]}}}const j1=l=>l==="reset"||l==="none",L2=(l,n)=>n?l:Object.assign({},l),a6=(l,n,a)=>l&&!n.hidden&&n._stacked&&{keys:rv(a,!0),values:null};class Pc{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(n,a){this.chart=n,this._ctx=n.ctx,this.index=a,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const n=this._cachedMeta;this.configure(),this.linkScales(),n._stacked=v1(n.vScale,n),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(n){this.index!==n&&Wf(this._cachedMeta),this.index=n}linkScales(){const n=this.chart,a=this._cachedMeta,o=this.getDataset(),s=(D,L,M,F)=>D==="x"?L:D==="r"?F:M,e=a.xAxisID=Ts(o.xAxisID,w1(n,"x")),m=a.yAxisID=Ts(o.yAxisID,w1(n,"y")),v=a.rAxisID=Ts(o.rAxisID,w1(n,"r")),w=a.indexAxis,N=a.iAxisID=s(w,e,m,v),S=a.vAxisID=s(w,m,e,v);a.xScale=this.getScaleForId(e),a.yScale=this.getScaleForId(m),a.rScale=this.getScaleForId(v),a.iScale=this.getScaleForId(N),a.vScale=this.getScaleForId(S)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(n){return this.chart.scales[n]}_getOtherScale(n){const a=this._cachedMeta;return n===a.iScale?a.vScale:a.iScale}reset(){this._update("reset")}_destroy(){const n=this._cachedMeta;this._data&&g2(this._data,this),n._stacked&&Wf(n)}_dataCheck(){const n=this.getDataset(),a=n.data||(n.data=[]),o=this._data;if(Qs(a)){const s=this._cachedMeta;this._data=Jj(a,s)}else if(o!==a){if(o){g2(o,this);const s=this._cachedMeta;Wf(s),s._parsed=[]}a&&Object.isExtensible(a)&&H3(a,this),this._syncList=[],this._data=a}}addElements(){const n=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(n.dataset=new this.datasetElementType)}buildOrUpdateElements(n){const a=this._cachedMeta,o=this.getDataset();let s=!1;this._dataCheck();const e=a._stacked;a._stacked=v1(a.vScale,a),a.stack!==o.stack&&(s=!0,Wf(a),a.stack=o.stack),this._resyncElements(n),(s||e!==a._stacked)&&(M2(this,a._parsed),a._stacked=v1(a.vScale,a))}configure(){const n=this.chart.config,a=n.datasetScopeKeys(this._type),o=n.getOptionScopes(this.getDataset(),a,!0);this.options=n.createResolver(o,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(n,a){const{_cachedMeta:o,_data:s}=this,{iScale:e,_stacked:m}=o,v=e.axis;let w=n===0&&a===s.length?!0:o._sorted,N=n>0&&o._parsed[n-1],S,D,L;if(this._parsing===!1)o._parsed=s,o._sorted=!0,L=s;else{Na(s[n])?L=this.parseArrayData(o,s,n,a):Qs(s[n])?L=this.parseObjectData(o,s,n,a):L=this.parsePrimitiveData(o,s,n,a);const M=()=>D[v]===null||N&&D[v]<N[v];for(S=0;S<a;++S)o._parsed[S+n]=D=L[S],w&&(M()&&(w=!1),N=D);o._sorted=w}m&&M2(this,L)}parsePrimitiveData(n,a,o,s){const{iScale:e,vScale:m}=n,v=e.axis,w=m.axis,N=e.getLabels(),S=e===m,D=new Array(s);let L,M,F;for(L=0,M=s;L<M;++L)F=L+o,D[L]={[v]:S||e.parse(N[F],F),[w]:m.parse(a[F],F)};return D}parseArrayData(n,a,o,s){const{xScale:e,yScale:m}=n,v=new Array(s);let w,N,S,D;for(w=0,N=s;w<N;++w)S=w+o,D=a[S],v[w]={x:e.parse(D[0],S),y:m.parse(D[1],S)};return v}parseObjectData(n,a,o,s){const{xScale:e,yScale:m}=n,{xAxisKey:v="x",yAxisKey:w="y"}=this._parsing,N=new Array(s);let S,D,L,M;for(S=0,D=s;S<D;++S)L=S+o,M=a[L],N[S]={x:e.parse(Rc(M,v),L),y:m.parse(Rc(M,w),L)};return N}getParsed(n){return this._cachedMeta._parsed[n]}getDataElement(n){return this._cachedMeta.data[n]}applyStack(n,a,o){const s=this.chart,e=this._cachedMeta,m=a[n.axis],v={keys:rv(s,!0),values:a._stacks[n.axis]._visualValues};return _2(v,m,e.index,{mode:o})}updateRangeFromParsed(n,a,o,s){const e=o[a.axis];let m=e===null?NaN:e;const v=s&&o._stacks[a.axis];s&&v&&(s.values=v,m=_2(s,e,this._cachedMeta.index)),n.min=Math.min(n.min,m),n.max=Math.max(n.max,m)}getMinMax(n,a){const o=this._cachedMeta,s=o._parsed,e=o._sorted&&n===o.iScale,m=s.length,v=this._getOtherScale(n),w=a6(a,o,this.chart),N={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:S,max:D}=e6(v);let L,M;function F(){M=s[L];const O=M[v.axis];return!fn(M[n.axis])||S>O||D<O}for(L=0;L<m&&!(!F()&&(this.updateRangeFromParsed(N,n,M,w),e));++L);if(e){for(L=m-1;L>=0;--L)if(!F()){this.updateRangeFromParsed(N,n,M,w);break}}return N}getAllParsedValues(n){const a=this._cachedMeta._parsed,o=[];let s,e,m;for(s=0,e=a.length;s<e;++s)m=a[s][n.axis],fn(m)&&o.push(m);return o}getMaxOverflow(){return!1}getLabelAndValue(n){const a=this._cachedMeta,o=a.iScale,s=a.vScale,e=this.getParsed(n);return{label:o?""+o.getLabelForValue(e[o.axis]):"",value:s?""+s.getLabelForValue(e[s.axis]):""}}_update(n){const a=this._cachedMeta;this.update(n||"default"),a._clip=Xj(Ts(this.options.clip,Qj(a.xScale,a.yScale,this.getMaxOverflow())))}update(n){}draw(){const n=this._ctx,a=this.chart,o=this._cachedMeta,s=o.data||[],e=a.chartArea,m=[],v=this._drawStart||0,w=this._drawCount||s.length-v,N=this.options.drawActiveElementsOnTop;let S;for(o.dataset&&o.dataset.draw(n,e,v,w),S=v;S<v+w;++S){const D=s[S];D.hidden||(D.active&&N?m.push(D):D.draw(n,e))}for(S=0;S<m.length;++S)m[S].draw(n,e)}getStyle(n,a){const o=a?"active":"default";return n===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(o):this.resolveDataElementOptions(n||0,o)}getContext(n,a,o){const s=this.getDataset();let e;if(n>=0&&n<this._cachedMeta.data.length){const m=this._cachedMeta.data[n];e=m.$context||(m.$context=r6(this.getContext(),n,m)),e.parsed=this.getParsed(n),e.raw=s.data[n],e.index=e.dataIndex=n}else e=this.$context||(this.$context=s6(this.chart.getContext(),this.index)),e.dataset=s,e.index=e.datasetIndex=this.index;return e.active=!!a,e.mode=o,e}resolveDatasetElementOptions(n){return this._resolveElementOptions(this.datasetElementType.id,n)}resolveDataElementOptions(n,a){return this._resolveElementOptions(this.dataElementType.id,a,n)}_resolveElementOptions(n,a="default",o){const s=a==="active",e=this._cachedDataOpts,m=n+"-"+a,v=e[m],w=this.enableOptionSharing&&lm(o);if(v)return L2(v,w);const N=this.chart.config,S=N.datasetElementScopeKeys(this._type,n),D=s?[`${n}Hover`,"hover",n,""]:[n,""],L=N.getOptionScopes(this.getDataset(),S),M=Object.keys(fa.elements[n]),F=()=>this.getContext(o,s,a),O=N.resolveNamedOptions(L,M,F,D);return O.$shared&&(O.$shared=w,e[m]=Object.freeze(L2(O,w))),O}_resolveAnimations(n,a,o){const s=this.chart,e=this._cachedDataOpts,m=`animation-${a}`,v=e[m];if(v)return v;let w;if(s.options.animation!==!1){const S=this.chart.config,D=S.datasetAnimationScopeKeys(this._type,a),L=S.getOptionScopes(this.getDataset(),D);w=S.createResolver(L,this.getContext(n,o,a))}const N=new sv(s,w&&w.animations);return w&&w._cacheable&&(e[m]=Object.freeze(N)),N}getSharedOptions(n){if(n.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},n))}includeOptions(n,a){return!a||j1(n)||this.chart._animationsDisabled}_getSharedOptions(n,a){const o=this.resolveDataElementOptions(n,a),s=this._sharedOptions,e=this.getSharedOptions(o),m=this.includeOptions(a,e)||e!==s;return this.updateSharedOptions(e,a,o),{sharedOptions:e,includeOptions:m}}updateElement(n,a,o,s){j1(s)?Object.assign(n,o):this._resolveAnimations(a,s).update(n,o)}updateSharedOptions(n,a,o){n&&!j1(a)&&this._resolveAnimations(void 0,a).update(n,o)}_setStyle(n,a,o,s){n.active=s;const e=this.getStyle(a,s);this._resolveAnimations(a,o,s).update(n,{options:!s&&this.getSharedOptions(e)||e})}removeHoverStyle(n,a,o){this._setStyle(n,o,"active",!1)}setHoverStyle(n,a,o){this._setStyle(n,o,"active",!0)}_removeDatasetHoverStyle(){const n=this._cachedMeta.dataset;n&&this._setStyle(n,void 0,"active",!1)}_setDatasetHoverStyle(){const n=this._cachedMeta.dataset;n&&this._setStyle(n,void 0,"active",!0)}_resyncElements(n){const a=this._data,o=this._cachedMeta.data;for(const[v,w,N]of this._syncList)this[v](w,N);this._syncList=[];const s=o.length,e=a.length,m=Math.min(e,s);m&&this.parse(0,m),e>s?this._insertElements(s,e-s,n):e<s&&this._removeElements(e,s-e)}_insertElements(n,a,o=!0){const s=this._cachedMeta,e=s.data,m=n+a;let v;const w=N=>{for(N.length+=a,v=N.length-1;v>=m;v--)N[v]=N[v-a]};for(w(e),v=n;v<m;++v)e[v]=new this.dataElementType;this._parsing&&w(s._parsed),this.parse(n,a),o&&this.updateElements(e,n,a,"reset")}updateElements(n,a,o,s){}_removeElements(n,a){const o=this._cachedMeta;if(this._parsing){const s=o._parsed.splice(n,a);o._stacked&&Wf(o,s)}o.data.splice(n,a)}_sync(n){if(this._parsing)this._syncList.push(n);else{const[a,o,s]=n;this[a](o,s)}this.chart._dataChanges.push([this.index,...n])}_onDataPush(){const n=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-n,n])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(n,a){a&&this._sync(["_removeElements",n,a]);const o=arguments.length-2;o&&this._sync(["_insertElements",n,o])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function n6(l,n){if(!l._cache.$bar){const a=l.getMatchingVisibleMetas(n);let o=[];for(let s=0,e=a.length;s<e;s++)o=o.concat(a[s].controller.getAllParsedValues(l));l._cache.$bar=Oy(o.sort((s,e)=>s-e))}return l._cache.$bar}function i6(l){const n=l.iScale,a=n6(n,l.type);let o=n._length,s,e,m,v;const w=()=>{m===32767||m===-32768||(lm(v)&&(o=Math.min(o,Math.abs(m-v)||o)),v=m)};for(s=0,e=a.length;s<e;++s)m=n.getPixelForValue(a[s]),w();for(v=void 0,s=0,e=n.ticks.length;s<e;++s)m=n.getPixelForTick(s),w();return o}function l6(l,n,a,o){const s=a.barThickness;let e,m;return ur(s)?(e=n.min*a.categoryPercentage,m=a.barPercentage):(e=s*o,m=1),{chunk:e/o,ratio:m,start:n.pixels[l]-e/2}}function o6(l,n,a,o){const s=n.pixels,e=s[l];let m=l>0?s[l-1]:null,v=l<s.length-1?s[l+1]:null;const w=a.categoryPercentage;m===null&&(m=e-(v===null?n.end-n.start:v-e)),v===null&&(v=e+e-m);const N=e-(e-Math.min(m,v))/2*w;return{chunk:Math.abs(v-m)/2*w/o,ratio:a.barPercentage,start:N}}function c6(l,n,a,o){const s=a.parse(l[0],o),e=a.parse(l[1],o),m=Math.min(s,e),v=Math.max(s,e);let w=m,N=v;Math.abs(m)>Math.abs(v)&&(w=v,N=m),n[a.axis]=N,n._custom={barStart:w,barEnd:N,start:s,end:e,min:m,max:v}}function av(l,n,a,o){return Na(l)?c6(l,n,a,o):n[a.axis]=a.parse(l,o),n}function R2(l,n,a,o){const s=l.iScale,e=l.vScale,m=s.getLabels(),v=s===e,w=[];let N,S,D,L;for(N=a,S=a+o;N<S;++N)L=n[N],D={},D[s.axis]=v||s.parse(m[N],N),w.push(av(L,D,e,N));return w}function N1(l){return l&&l.barStart!==void 0&&l.barEnd!==void 0}function d6(l,n,a){return l!==0?zl(l):(n.isHorizontal()?1:-1)*(n.min>=a?1:-1)}function u6(l){let n,a,o,s,e;return l.horizontal?(n=l.base>l.x,a="left",o="right"):(n=l.base<l.y,a="bottom",o="top"),n?(s="end",e="start"):(s="start",e="end"),{start:a,end:o,reverse:n,top:s,bottom:e}}function h6(l,n,a,o){let s=n.borderSkipped;const e={};if(!s){l.borderSkipped=e;return}if(s===!0){l.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:m,end:v,reverse:w,top:N,bottom:S}=u6(l);s==="middle"&&a&&(l.enableBorderRadius=!0,(a._top||0)===o?s=N:(a._bottom||0)===o?s=S:(e[O2(S,m,v,w)]=!0,s=N)),e[O2(s,m,v,w)]=!0,l.borderSkipped=e}function O2(l,n,a,o){return o?(l=f6(l,n,a),l=P2(l,a,n)):l=P2(l,n,a),l}function f6(l,n,a){return l===n?a:l===a?n:l}function P2(l,n,a){return l==="start"?n:l==="end"?a:l}function m6(l,{inflateAmount:n},a){l.inflateAmount=n==="auto"?a===1?.33:0:n}class g6 extends Pc{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(n,a,o,s){return R2(n,a,o,s)}parseArrayData(n,a,o,s){return R2(n,a,o,s)}parseObjectData(n,a,o,s){const{iScale:e,vScale:m}=n,{xAxisKey:v="x",yAxisKey:w="y"}=this._parsing,N=e.axis==="x"?v:w,S=m.axis==="x"?v:w,D=[];let L,M,F,O;for(L=o,M=o+s;L<M;++L)O=a[L],F={},F[e.axis]=e.parse(Rc(O,N),L),D.push(av(Rc(O,S),F,m,L));return D}updateRangeFromParsed(n,a,o,s){super.updateRangeFromParsed(n,a,o,s);const e=o._custom;e&&a===this._cachedMeta.vScale&&(n.min=Math.min(n.min,e.min),n.max=Math.max(n.max,e.max))}getMaxOverflow(){return 0}getLabelAndValue(n){const a=this._cachedMeta,{iScale:o,vScale:s}=a,e=this.getParsed(n),m=e._custom,v=N1(m)?"["+m.start+", "+m.end+"]":""+s.getLabelForValue(e[s.axis]);return{label:""+o.getLabelForValue(e[o.axis]),value:v}}initialize(){this.enableOptionSharing=!0,super.initialize();const n=this._cachedMeta;n.stack=this.getDataset().stack}update(n){const a=this._cachedMeta;this.updateElements(a.data,0,a.data.length,n)}updateElements(n,a,o,s){const e=s==="reset",{index:m,_cachedMeta:{vScale:v}}=this,w=v.getBasePixel(),N=v.isHorizontal(),S=this._getRuler(),{sharedOptions:D,includeOptions:L}=this._getSharedOptions(a,s);for(let M=a;M<a+o;M++){const F=this.getParsed(M),O=e||ur(F[v.axis])?{base:w,head:w}:this._calculateBarValuePixels(M),P=this._calculateBarIndexPixels(M,S),K=(F._stacks||{})[v.axis],ne={horizontal:N,base:O.base,enableBorderRadius:!K||N1(F._custom)||m===K._top||m===K._bottom,x:N?O.head:P.center,y:N?P.center:O.head,height:N?P.size:Math.abs(O.size),width:N?Math.abs(O.size):P.size};L&&(ne.options=D||this.resolveDataElementOptions(M,n[M].active?"active":s));const se=ne.options||n[M].options;h6(ne,se,K,m),m6(ne,se,S.ratio),this.updateElement(n[M],M,ne,s)}}_getStacks(n,a){const{iScale:o}=this._cachedMeta,s=o.getMatchingVisibleMetas(this._type).filter(S=>S.controller.options.grouped),e=o.options.stacked,m=[],v=this._cachedMeta.controller.getParsed(a),w=v&&v[o.axis],N=S=>{const D=S._parsed.find(M=>M[o.axis]===w),L=D&&D[S.vScale.axis];if(ur(L)||isNaN(L))return!0};for(const S of s)if(!(a!==void 0&&N(S))&&((e===!1||m.indexOf(S.stack)===-1||e===void 0&&S.stack===void 0)&&m.push(S.stack),S.index===n))break;return m.length||m.push(void 0),m}_getStackCount(n){return this._getStacks(void 0,n).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const n=this.chart.scales,a=this.chart.options.indexAxis;return Object.keys(n).filter(o=>n[o].axis===a).shift()}_getAxis(){const n={},a=this.getFirstScaleIdForIndexAxis();for(const o of this.chart.data.datasets)n[Ts(this.chart.options.indexAxis==="x"?o.xAxisID:o.yAxisID,a)]=!0;return Object.keys(n)}_getStackIndex(n,a,o){const s=this._getStacks(n,o),e=a!==void 0?s.indexOf(a):-1;return e===-1?s.length-1:e}_getRuler(){const n=this.options,a=this._cachedMeta,o=a.iScale,s=[];let e,m;for(e=0,m=a.data.length;e<m;++e)s.push(o.getPixelForValue(this.getParsed(e)[o.axis],e));const v=n.barThickness;return{min:v||i6(a),pixels:s,start:o._startPixel,end:o._endPixel,stackCount:this._getStackCount(),scale:o,grouped:n.grouped,ratio:v?1:n.categoryPercentage*n.barPercentage}}_calculateBarValuePixels(n){const{_cachedMeta:{vScale:a,_stacked:o,index:s},options:{base:e,minBarLength:m}}=this,v=e||0,w=this.getParsed(n),N=w._custom,S=N1(N);let D=w[a.axis],L=0,M=o?this.applyStack(a,w,o):D,F,O;M!==D&&(L=M-D,M=D),S&&(D=N.barStart,M=N.barEnd-N.barStart,D!==0&&zl(D)!==zl(N.barEnd)&&(L=0),L+=D);const P=!ur(e)&&!S?e:L;let K=a.getPixelForValue(P);if(this.chart.getDataVisibility(n)?F=a.getPixelForValue(L+M):F=K,O=F-K,Math.abs(O)<m){O=d6(O,a,v)*m,D===v&&(K-=O/2);const ne=a.getPixelForDecimal(0),se=a.getPixelForDecimal(1),Ce=Math.min(ne,se),ge=Math.max(ne,se);K=Math.max(Math.min(K,ge),Ce),F=K+O,o&&!S&&(w._stacks[a.axis]._visualValues[s]=a.getValueForPixel(F)-a.getValueForPixel(K))}if(K===a.getPixelForValue(v)){const ne=zl(O)*a.getLineWidthForValue(v)/2;K+=ne,O-=ne}return{size:O,base:K,head:F,center:F+O/2}}_calculateBarIndexPixels(n,a){const o=a.scale,s=this.options,e=s.skipNull,m=Ts(s.maxBarThickness,1/0);let v,w;const N=this._getAxisCount();if(a.grouped){const S=e?this._getStackCount(n):a.stackCount,D=s.barThickness==="flex"?o6(n,a,s,S*N):l6(n,a,s,S*N),L=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,M=this._getAxis().indexOf(Ts(L,this.getFirstScaleIdForIndexAxis())),F=this._getStackIndex(this.index,this._cachedMeta.stack,e?n:void 0)+M;v=D.start+D.chunk*F+D.chunk/2,w=Math.min(m,D.chunk*D.ratio)}else v=o.getPixelForValue(this.getParsed(n)[o.axis],n),w=Math.min(m,a.min*a.ratio);return{base:v-w/2,head:v+w/2,center:v,size:w}}draw(){const n=this._cachedMeta,a=n.vScale,o=n.data,s=o.length;let e=0;for(;e<s;++e)this.getParsed(e)[a.axis]!==null&&!o[e].hidden&&o[e].draw(this._ctx)}}class p6 extends Pc{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(n,a,o,s){const e=super.parsePrimitiveData(n,a,o,s);for(let m=0;m<e.length;m++)e[m]._custom=this.resolveDataElementOptions(m+o).radius;return e}parseArrayData(n,a,o,s){const e=super.parseArrayData(n,a,o,s);for(let m=0;m<e.length;m++){const v=a[o+m];e[m]._custom=Ts(v[2],this.resolveDataElementOptions(m+o).radius)}return e}parseObjectData(n,a,o,s){const e=super.parseObjectData(n,a,o,s);for(let m=0;m<e.length;m++){const v=a[o+m];e[m]._custom=Ts(v&&v.r&&+v.r,this.resolveDataElementOptions(m+o).radius)}return e}getMaxOverflow(){const n=this._cachedMeta.data;let a=0;for(let o=n.length-1;o>=0;--o)a=Math.max(a,n[o].size(this.resolveDataElementOptions(o))/2);return a>0&&a}getLabelAndValue(n){const a=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:e}=a,m=this.getParsed(n),v=s.getLabelForValue(m.x),w=e.getLabelForValue(m.y),N=m._custom;return{label:o[n]||"",value:"("+v+", "+w+(N?", "+N:"")+")"}}update(n){const a=this._cachedMeta.data;this.updateElements(a,0,a.length,n)}updateElements(n,a,o,s){const e=s==="reset",{iScale:m,vScale:v}=this._cachedMeta,{sharedOptions:w,includeOptions:N}=this._getSharedOptions(a,s),S=m.axis,D=v.axis;for(let L=a;L<a+o;L++){const M=n[L],F=!e&&this.getParsed(L),O={},P=O[S]=e?m.getPixelForDecimal(.5):m.getPixelForValue(F[S]),K=O[D]=e?v.getBasePixel():v.getPixelForValue(F[D]);O.skip=isNaN(P)||isNaN(K),N&&(O.options=w||this.resolveDataElementOptions(L,M.active?"active":s),e&&(O.options.radius=0)),this.updateElement(M,L,O,s)}}resolveDataElementOptions(n,a){const o=this.getParsed(n);let s=super.resolveDataElementOptions(n,a);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const e=s.radius;return a!=="active"&&(s.radius=0),s.radius+=Ts(o&&o._custom,e),s}}function x6(l,n,a){let o=1,s=1,e=0,m=0;if(n<Zr){const v=l,w=v+n,N=Math.cos(v),S=Math.sin(v),D=Math.cos(w),L=Math.sin(w),M=(se,Ce,ge)=>om(se,v,w,!0)?1:Math.max(Ce,Ce*a,ge,ge*a),F=(se,Ce,ge)=>om(se,v,w,!0)?-1:Math.min(Ce,Ce*a,ge,ge*a),O=M(0,N,D),P=M(Ta,S,L),K=F(pr,N,D),ne=F(pr+Ta,S,L);o=(O-K)/2,s=(P-ne)/2,e=-(O+K)/2,m=-(P+ne)/2}return{ratioX:o,ratioY:s,offsetX:e,offsetY:m}}class nv extends Pc{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:n=>n!=="spacing",_indexable:n=>n!=="spacing"&&!n.startsWith("borderDash")&&!n.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const a=n.data,{labels:{pointStyle:o,textAlign:s,color:e,useBorderRadius:m,borderRadius:v}}=n.legend.options;return a.labels.length&&a.datasets.length?a.labels.map((w,N)=>{const D=n.getDatasetMeta(0).controller.getStyle(N);return{text:w,fillStyle:D.backgroundColor,fontColor:e,hidden:!n.getDataVisibility(N),lineDash:D.borderDash,lineDashOffset:D.borderDashOffset,lineJoin:D.borderJoinStyle,lineWidth:D.borderWidth,strokeStyle:D.borderColor,textAlign:s,pointStyle:o,borderRadius:m&&(v||D.borderRadius),index:N}}):[]}},onClick(n,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}}};constructor(n,a){super(n,a),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(n,a){const o=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=o;else{let e=w=>+o[w];if(Qs(o[n])){const{key:w="value"}=this._parsing;e=N=>+Rc(o[N],w)}let m,v;for(m=n,v=n+a;m<v;++m)s._parsed[m]=e(m)}}_getRotation(){return Bl(this.options.rotation-90)}_getCircumference(){return Bl(this.options.circumference)}_getRotationExtents(){let n=Zr,a=-Zr;for(let o=0;o<this.chart.data.datasets.length;++o)if(this.chart.isDatasetVisible(o)&&this.chart.getDatasetMeta(o).type===this._type){const s=this.chart.getDatasetMeta(o).controller,e=s._getRotation(),m=s._getCircumference();n=Math.min(n,e),a=Math.max(a,e+m)}return{rotation:n,circumference:a-n}}update(n){const a=this.chart,{chartArea:o}=a,s=this._cachedMeta,e=s.data,m=this.getMaxBorderWidth()+this.getMaxOffset(e)+this.options.spacing,v=Math.max((Math.min(o.width,o.height)-m)/2,0),w=Math.min(C3(this.options.cutout,v),1),N=this._getRingWeight(this.index),{circumference:S,rotation:D}=this._getRotationExtents(),{ratioX:L,ratioY:M,offsetX:F,offsetY:O}=x6(D,S,w),P=(o.width-m)/L,K=(o.height-m)/M,ne=Math.max(Math.min(P,K)/2,0),se=_y(this.options.radius,ne),Ce=Math.max(se*w,0),ge=(se-Ce)/this._getVisibleDatasetWeightTotal();this.offsetX=F*se,this.offsetY=O*se,s.total=this.calculateTotal(),this.outerRadius=se-ge*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-ge*N,0),this.updateElements(e,0,e.length,n)}_circumference(n,a){const o=this.options,s=this._cachedMeta,e=this._getCircumference();return a&&o.animation.animateRotate||!this.chart.getDataVisibility(n)||s._parsed[n]===null||s.data[n].hidden?0:this.calculateCircumference(s._parsed[n]*e/Zr)}updateElements(n,a,o,s){const e=s==="reset",m=this.chart,v=m.chartArea,N=m.options.animation,S=(v.left+v.right)/2,D=(v.top+v.bottom)/2,L=e&&N.animateScale,M=L?0:this.innerRadius,F=L?0:this.outerRadius,{sharedOptions:O,includeOptions:P}=this._getSharedOptions(a,s);let K=this._getRotation(),ne;for(ne=0;ne<a;++ne)K+=this._circumference(ne,e);for(ne=a;ne<a+o;++ne){const se=this._circumference(ne,e),Ce=n[ne],ge={x:S+this.offsetX,y:D+this.offsetY,startAngle:K,endAngle:K+se,circumference:se,outerRadius:F,innerRadius:M};P&&(ge.options=O||this.resolveDataElementOptions(ne,Ce.active?"active":s)),K+=se,this.updateElement(Ce,ne,ge,s)}}calculateTotal(){const n=this._cachedMeta,a=n.data;let o=0,s;for(s=0;s<a.length;s++){const e=n._parsed[s];e!==null&&!isNaN(e)&&this.chart.getDataVisibility(s)&&!a[s].hidden&&(o+=Math.abs(e))}return o}calculateCircumference(n){const a=this._cachedMeta.total;return a>0&&!isNaN(n)?Zr*(Math.abs(n)/a):0}getLabelAndValue(n){const a=this._cachedMeta,o=this.chart,s=o.data.labels||[],e=Fp(a._parsed[n],o.options.locale);return{label:s[n]||"",value:e}}getMaxBorderWidth(n){let a=0;const o=this.chart;let s,e,m,v,w;if(!n){for(s=0,e=o.data.datasets.length;s<e;++s)if(o.isDatasetVisible(s)){m=o.getDatasetMeta(s),n=m.data,v=m.controller;break}}if(!n)return 0;for(s=0,e=n.length;s<e;++s)w=v.resolveDataElementOptions(s),w.borderAlign!=="inner"&&(a=Math.max(a,w.borderWidth||0,w.hoverBorderWidth||0));return a}getMaxOffset(n){let a=0;for(let o=0,s=n.length;o<s;++o){const e=this.resolveDataElementOptions(o);a=Math.max(a,e.offset||0,e.hoverOffset||0)}return a}_getRingWeightOffset(n){let a=0;for(let o=0;o<n;++o)this.chart.isDatasetVisible(o)&&(a+=this._getRingWeight(o));return a}_getRingWeight(n){return Math.max(Ts(this.chart.data.datasets[n].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class b6 extends Pc{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(n){const a=this._cachedMeta,{dataset:o,data:s=[],_dataset:e}=a,m=this.chart._animationsDisabled;let{start:v,count:w}=By(a,s,m);this._drawStart=v,this._drawCount=w,zy(a)&&(v=0,w=s.length),o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!e._decimated,o.points=s;const N=this.resolveDatasetElementOptions(n);this.options.showLine||(N.borderWidth=0),N.segment=this.options.segment,this.updateElement(o,void 0,{animated:!m,options:N},n),this.updateElements(s,v,w,n)}updateElements(n,a,o,s){const e=s==="reset",{iScale:m,vScale:v,_stacked:w,_dataset:N}=this._cachedMeta,{sharedOptions:S,includeOptions:D}=this._getSharedOptions(a,s),L=m.axis,M=v.axis,{spanGaps:F,segment:O}=this.options,P=Qu(F)?F:Number.POSITIVE_INFINITY,K=this.chart._animationsDisabled||e||s==="none",ne=a+o,se=n.length;let Ce=a>0&&this.getParsed(a-1);for(let ge=0;ge<se;++ge){const Ne=n[ge],J=K?Ne:{};if(ge<a||ge>=ne){J.skip=!0;continue}const de=this.getParsed(ge),le=ur(de[M]),ze=J[L]=m.getPixelForValue(de[L],ge),me=J[M]=e||le?v.getBasePixel():v.getPixelForValue(w?this.applyStack(v,de,w):de[M],ge);J.skip=isNaN(ze)||isNaN(me)||le,J.stop=ge>0&&Math.abs(de[L]-Ce[L])>P,O&&(J.parsed=de,J.raw=N.data[ge]),D&&(J.options=S||this.resolveDataElementOptions(ge,Ne.active?"active":s)),K||this.updateElement(Ne,ge,J,s),Ce=de}}getMaxOverflow(){const n=this._cachedMeta,a=n.dataset,o=a.options&&a.options.borderWidth||0,s=n.data||[];if(!s.length)return o;const e=s[0].size(this.resolveDataElementOptions(0)),m=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(o,e,m)/2}draw(){const n=this._cachedMeta;n.dataset.updateControlPoints(this.chart.chartArea,n.iScale.axis),super.draw()}}class y6 extends Pc{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const a=n.data;if(a.labels.length&&a.datasets.length){const{labels:{pointStyle:o,color:s}}=n.legend.options;return a.labels.map((e,m)=>{const w=n.getDatasetMeta(0).controller.getStyle(m);return{text:e,fillStyle:w.backgroundColor,strokeStyle:w.borderColor,fontColor:s,lineWidth:w.borderWidth,pointStyle:o,hidden:!n.getDataVisibility(m),index:m}})}return[]}},onClick(n,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(n,a){super(n,a),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(n){const a=this._cachedMeta,o=this.chart,s=o.data.labels||[],e=Fp(a._parsed[n].r,o.options.locale);return{label:s[n]||"",value:e}}parseObjectData(n,a,o,s){return Gy.bind(this)(n,a,o,s)}update(n){const a=this._cachedMeta.data;this._updateRadius(),this.updateElements(a,0,a.length,n)}getMinMax(){const n=this._cachedMeta,a={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return n.data.forEach((o,s)=>{const e=this.getParsed(s).r;!isNaN(e)&&this.chart.getDataVisibility(s)&&(e<a.min&&(a.min=e),e>a.max&&(a.max=e))}),a}_updateRadius(){const n=this.chart,a=n.chartArea,o=n.options,s=Math.min(a.right-a.left,a.bottom-a.top),e=Math.max(s/2,0),m=Math.max(o.cutoutPercentage?e/100*o.cutoutPercentage:1,0),v=(e-m)/n.getVisibleDatasetCount();this.outerRadius=e-v*this.index,this.innerRadius=this.outerRadius-v}updateElements(n,a,o,s){const e=s==="reset",m=this.chart,w=m.options.animation,N=this._cachedMeta.rScale,S=N.xCenter,D=N.yCenter,L=N.getIndexAngle(0)-.5*pr;let M=L,F;const O=360/this.countVisibleElements();for(F=0;F<a;++F)M+=this._computeAngle(F,s,O);for(F=a;F<a+o;F++){const P=n[F];let K=M,ne=M+this._computeAngle(F,s,O),se=m.getDataVisibility(F)?N.getDistanceFromCenterForValue(this.getParsed(F).r):0;M=ne,e&&(w.animateScale&&(se=0),w.animateRotate&&(K=ne=L));const Ce={x:S,y:D,innerRadius:0,outerRadius:se,startAngle:K,endAngle:ne,options:this.resolveDataElementOptions(F,P.active?"active":s)};this.updateElement(P,F,Ce,s)}}countVisibleElements(){const n=this._cachedMeta;let a=0;return n.data.forEach((o,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&a++}),a}_computeAngle(n,a,o){return this.chart.getDataVisibility(n)?Bl(this.resolveDataElementOptions(n,a).angle||o):0}}class v6 extends nv{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class w6 extends Pc{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(n){const a=this._cachedMeta.vScale,o=this.getParsed(n);return{label:a.getLabels()[n],value:""+a.getLabelForValue(o[a.axis])}}parseObjectData(n,a,o,s){return Gy.bind(this)(n,a,o,s)}update(n){const a=this._cachedMeta,o=a.dataset,s=a.data||[],e=a.iScale.getLabels();if(o.points=s,n!=="resize"){const m=this.resolveDatasetElementOptions(n);this.options.showLine||(m.borderWidth=0);const v={_loop:!0,_fullLoop:e.length===s.length,options:m};this.updateElement(o,void 0,v,n)}this.updateElements(s,0,s.length,n)}updateElements(n,a,o,s){const e=this._cachedMeta.rScale,m=s==="reset";for(let v=a;v<a+o;v++){const w=n[v],N=this.resolveDataElementOptions(v,w.active?"active":s),S=e.getPointPositionForValue(v,this.getParsed(v).r),D=m?e.xCenter:S.x,L=m?e.yCenter:S.y,M={x:D,y:L,angle:S.angle,skip:isNaN(D)||isNaN(L),options:N};this.updateElement(w,v,M,s)}}}class j6 extends Pc{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(n){const a=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:e}=a,m=this.getParsed(n),v=s.getLabelForValue(m.x),w=e.getLabelForValue(m.y);return{label:o[n]||"",value:"("+v+", "+w+")"}}update(n){const a=this._cachedMeta,{data:o=[]}=a,s=this.chart._animationsDisabled;let{start:e,count:m}=By(a,o,s);if(this._drawStart=e,this._drawCount=m,zy(a)&&(e=0,m=o.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:v,_dataset:w}=a;v._chart=this.chart,v._datasetIndex=this.index,v._decimated=!!w._decimated,v.points=o;const N=this.resolveDatasetElementOptions(n);N.segment=this.options.segment,this.updateElement(v,void 0,{animated:!s,options:N},n)}else this.datasetElementType&&(delete a.dataset,this.datasetElementType=!1);this.updateElements(o,e,m,n)}addElements(){const{showLine:n}=this.options;!this.datasetElementType&&n&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(n,a,o,s){const e=s==="reset",{iScale:m,vScale:v,_stacked:w,_dataset:N}=this._cachedMeta,S=this.resolveDataElementOptions(a,s),D=this.getSharedOptions(S),L=this.includeOptions(s,D),M=m.axis,F=v.axis,{spanGaps:O,segment:P}=this.options,K=Qu(O)?O:Number.POSITIVE_INFINITY,ne=this.chart._animationsDisabled||e||s==="none";let se=a>0&&this.getParsed(a-1);for(let Ce=a;Ce<a+o;++Ce){const ge=n[Ce],Ne=this.getParsed(Ce),J=ne?ge:{},de=ur(Ne[F]),le=J[M]=m.getPixelForValue(Ne[M],Ce),ze=J[F]=e||de?v.getBasePixel():v.getPixelForValue(w?this.applyStack(v,Ne,w):Ne[F],Ce);J.skip=isNaN(le)||isNaN(ze)||de,J.stop=Ce>0&&Math.abs(Ne[M]-se[M])>K,P&&(J.parsed=Ne,J.raw=N.data[Ce]),L&&(J.options=D||this.resolveDataElementOptions(Ce,ge.active?"active":s)),ne||this.updateElement(ge,Ce,J,s),se=Ne}this.updateSharedOptions(D,s,S)}getMaxOverflow(){const n=this._cachedMeta,a=n.data||[];if(!this.options.showLine){let v=0;for(let w=a.length-1;w>=0;--w)v=Math.max(v,a[w].size(this.resolveDataElementOptions(w))/2);return v>0&&v}const o=n.dataset,s=o.options&&o.options.borderWidth||0;if(!a.length)return s;const e=a[0].size(this.resolveDataElementOptions(0)),m=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(s,e,m)/2}}function Kd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Cx{static override(n){Object.assign(Cx.prototype,n)}options;constructor(n){this.options=n||{}}init(){}formats(){return Kd()}parse(){return Kd()}format(){return Kd()}add(){return Kd()}diff(){return Kd()}startOf(){return Kd()}endOf(){return Kd()}}var N6={_date:Cx};function k6(l,n,a,o){const{controller:s,data:e,_sorted:m}=l,v=s._cachedMeta.iScale,w=l.dataset&&l.dataset.options?l.dataset.options.spanGaps:null;if(v&&n===v.axis&&n!=="r"&&m&&e.length){const N=v._reversePixels?z3:Zd;if(o){if(s._sharedOptions){const S=e[0],D=typeof S.getRange=="function"&&S.getRange(n);if(D){const L=N(e,n,a-D),M=N(e,n,a+D);return{lo:L.lo,hi:M.hi}}}}else{const S=N(e,n,a);if(w){const{vScale:D}=s._cachedMeta,{_parsed:L}=l,M=L.slice(0,S.lo+1).reverse().findIndex(O=>!ur(O[D.axis]));S.lo-=Math.max(0,M);const F=L.slice(S.hi).findIndex(O=>!ur(O[D.axis]));S.hi+=Math.max(0,F)}return S}}return{lo:0,hi:e.length-1}}function Op(l,n,a,o,s){const e=l.getSortedVisibleDatasetMetas(),m=a[n];for(let v=0,w=e.length;v<w;++v){const{index:N,data:S}=e[v],{lo:D,hi:L}=k6(e[v],n,m,s);for(let M=D;M<=L;++M){const F=S[M];F.skip||o(F,N,M)}}}function C6(l){const n=l.indexOf("x")!==-1,a=l.indexOf("y")!==-1;return function(o,s){const e=n?Math.abs(o.x-s.x):0,m=a?Math.abs(o.y-s.y):0;return Math.sqrt(Math.pow(e,2)+Math.pow(m,2))}}function k1(l,n,a,o,s){const e=[];return!s&&!l.isPointInArea(n)||Op(l,a,n,function(v,w,N){!s&&!cm(v,l.chartArea,0)||v.inRange(n.x,n.y,o)&&e.push({element:v,datasetIndex:w,index:N})},!0),e}function S6(l,n,a,o){let s=[];function e(m,v,w){const{startAngle:N,endAngle:S}=m.getProps(["startAngle","endAngle"],o),{angle:D}=Ly(m,{x:n.x,y:n.y});om(D,N,S)&&s.push({element:m,datasetIndex:v,index:w})}return Op(l,a,n,e),s}function A6(l,n,a,o,s,e){let m=[];const v=C6(a);let w=Number.POSITIVE_INFINITY;function N(S,D,L){const M=S.inRange(n.x,n.y,s);if(o&&!M)return;const F=S.getCenterPoint(s);if(!(!!e||l.isPointInArea(F))&&!M)return;const P=v(n,F);P<w?(m=[{element:S,datasetIndex:D,index:L}],w=P):P===w&&m.push({element:S,datasetIndex:D,index:L})}return Op(l,a,n,N),m}function C1(l,n,a,o,s,e){return!e&&!l.isPointInArea(n)?[]:a==="r"&&!o?S6(l,n,a,s):A6(l,n,a,o,s,e)}function I2(l,n,a,o,s){const e=[],m=a==="x"?"inXRange":"inYRange";let v=!1;return Op(l,a,n,(w,N,S)=>{w[m]&&w[m](n[a],s)&&(e.push({element:w,datasetIndex:N,index:S}),v=v||w.inRange(n.x,n.y,s))}),o&&!v?[]:e}var E6={modes:{index(l,n,a,o){const s=Qd(n,l),e=a.axis||"x",m=a.includeInvisible||!1,v=a.intersect?k1(l,s,e,o,m):C1(l,s,e,!1,o,m),w=[];return v.length?(l.getSortedVisibleDatasetMetas().forEach(N=>{const S=v[0].index,D=N.data[S];D&&!D.skip&&w.push({element:D,datasetIndex:N.index,index:S})}),w):[]},dataset(l,n,a,o){const s=Qd(n,l),e=a.axis||"xy",m=a.includeInvisible||!1;let v=a.intersect?k1(l,s,e,o,m):C1(l,s,e,!1,o,m);if(v.length>0){const w=v[0].datasetIndex,N=l.getDatasetMeta(w).data;v=[];for(let S=0;S<N.length;++S)v.push({element:N[S],datasetIndex:w,index:S})}return v},point(l,n,a,o){const s=Qd(n,l),e=a.axis||"xy",m=a.includeInvisible||!1;return k1(l,s,e,o,m)},nearest(l,n,a,o){const s=Qd(n,l),e=a.axis||"xy",m=a.includeInvisible||!1;return C1(l,s,e,a.intersect,o,m)},x(l,n,a,o){const s=Qd(n,l);return I2(l,s,"x",a.intersect,o)},y(l,n,a,o){const s=Qd(n,l);return I2(l,s,"y",a.intersect,o)}}};const iv=["left","top","right","bottom"];function $f(l,n){return l.filter(a=>a.pos===n)}function B2(l,n){return l.filter(a=>iv.indexOf(a.pos)===-1&&a.box.axis===n)}function qf(l,n){return l.sort((a,o)=>{const s=n?o:a,e=n?a:o;return s.weight===e.weight?s.index-e.index:s.weight-e.weight})}function D6(l){const n=[];let a,o,s,e,m,v;for(a=0,o=(l||[]).length;a<o;++a)s=l[a],{position:e,options:{stack:m,stackWeight:v=1}}=s,n.push({index:a,box:s,pos:e,horizontal:s.isHorizontal(),weight:s.weight,stack:m&&e+m,stackWeight:v});return n}function T6(l){const n={};for(const a of l){const{stack:o,pos:s,stackWeight:e}=a;if(!o||!iv.includes(s))continue;const m=n[o]||(n[o]={count:0,placed:0,weight:0,size:0});m.count++,m.weight+=e}return n}function _6(l,n){const a=T6(l),{vBoxMaxWidth:o,hBoxMaxHeight:s}=n;let e,m,v;for(e=0,m=l.length;e<m;++e){v=l[e];const{fullSize:w}=v.box,N=a[v.stack],S=N&&v.stackWeight/N.weight;v.horizontal?(v.width=S?S*o:w&&n.availableWidth,v.height=s):(v.width=o,v.height=S?S*s:w&&n.availableHeight)}return a}function F6(l){const n=D6(l),a=qf(n.filter(N=>N.box.fullSize),!0),o=qf($f(n,"left"),!0),s=qf($f(n,"right")),e=qf($f(n,"top"),!0),m=qf($f(n,"bottom")),v=B2(n,"x"),w=B2(n,"y");return{fullSize:a,leftAndTop:o.concat(e),rightAndBottom:s.concat(w).concat(m).concat(v),chartArea:$f(n,"chartArea"),vertical:o.concat(s).concat(w),horizontal:e.concat(m).concat(v)}}function z2(l,n,a,o){return Math.max(l[a],n[a])+Math.max(l[o],n[o])}function lv(l,n){l.top=Math.max(l.top,n.top),l.left=Math.max(l.left,n.left),l.bottom=Math.max(l.bottom,n.bottom),l.right=Math.max(l.right,n.right)}function M6(l,n,a,o){const{pos:s,box:e}=a,m=l.maxPadding;if(!Qs(s)){a.size&&(l[s]-=a.size);const D=o[a.stack]||{size:0,count:1};D.size=Math.max(D.size,a.horizontal?e.height:e.width),a.size=D.size/D.count,l[s]+=a.size}e.getPadding&&lv(m,e.getPadding());const v=Math.max(0,n.outerWidth-z2(m,l,"left","right")),w=Math.max(0,n.outerHeight-z2(m,l,"top","bottom")),N=v!==l.w,S=w!==l.h;return l.w=v,l.h=w,a.horizontal?{same:N,other:S}:{same:S,other:N}}function L6(l){const n=l.maxPadding;function a(o){const s=Math.max(n[o]-l[o],0);return l[o]+=s,s}l.y+=a("top"),l.x+=a("left"),a("right"),a("bottom")}function R6(l,n){const a=n.maxPadding;function o(s){const e={left:0,top:0,right:0,bottom:0};return s.forEach(m=>{e[m]=Math.max(n[m],a[m])}),e}return o(l?["left","right"]:["top","bottom"])}function Jf(l,n,a,o){const s=[];let e,m,v,w,N,S;for(e=0,m=l.length,N=0;e<m;++e){v=l[e],w=v.box,w.update(v.width||n.w,v.height||n.h,R6(v.horizontal,n));const{same:D,other:L}=M6(n,a,v,o);N|=D&&s.length,S=S||L,w.fullSize||s.push(v)}return N&&Jf(s,n,a,o)||S}function Xg(l,n,a,o,s){l.top=a,l.left=n,l.right=n+o,l.bottom=a+s,l.width=o,l.height=s}function U2(l,n,a,o){const s=a.padding;let{x:e,y:m}=n;for(const v of l){const w=v.box,N=o[v.stack]||{placed:0,weight:1},S=v.stackWeight/N.weight||1;if(v.horizontal){const D=n.w*S,L=N.size||w.height;lm(N.start)&&(m=N.start),w.fullSize?Xg(w,s.left,m,a.outerWidth-s.right-s.left,L):Xg(w,n.left+N.placed,m,D,L),N.start=m,N.placed+=D,m=w.bottom}else{const D=n.h*S,L=N.size||w.width;lm(N.start)&&(e=N.start),w.fullSize?Xg(w,e,s.top,L,a.outerHeight-s.bottom-s.top):Xg(w,e,n.top+N.placed,L,D),N.start=e,N.placed+=D,e=w.right}}n.x=e,n.y=m}var Ti={addBox(l,n){l.boxes||(l.boxes=[]),n.fullSize=n.fullSize||!1,n.position=n.position||"top",n.weight=n.weight||0,n._layers=n._layers||function(){return[{z:0,draw(a){n.draw(a)}}]},l.boxes.push(n)},removeBox(l,n){const a=l.boxes?l.boxes.indexOf(n):-1;a!==-1&&l.boxes.splice(a,1)},configure(l,n,a){n.fullSize=a.fullSize,n.position=a.position,n.weight=a.weight},update(l,n,a,o){if(!l)return;const s=_i(l.options.layout.padding),e=Math.max(n-s.width,0),m=Math.max(a-s.height,0),v=F6(l.boxes),w=v.vertical,N=v.horizontal;wr(l.boxes,O=>{typeof O.beforeLayout=="function"&&O.beforeLayout()});const S=w.reduce((O,P)=>P.box.options&&P.box.options.display===!1?O:O+1,0)||1,D=Object.freeze({outerWidth:n,outerHeight:a,padding:s,availableWidth:e,availableHeight:m,vBoxMaxWidth:e/2/S,hBoxMaxHeight:m/2}),L=Object.assign({},s);lv(L,_i(o));const M=Object.assign({maxPadding:L,w:e,h:m,x:s.left,y:s.top},s),F=_6(w.concat(N),D);Jf(v.fullSize,M,D,F),Jf(w,M,D,F),Jf(N,M,D,F)&&Jf(w,M,D,F),L6(M),U2(v.leftAndTop,M,D,F),M.x+=M.w,M.y+=M.h,U2(v.rightAndBottom,M,D,F),l.chartArea={left:M.left,top:M.top,right:M.left+M.w,bottom:M.top+M.h,height:M.h,width:M.w},wr(v.chartArea,O=>{const P=O.box;Object.assign(P,l.chartArea),P.update(M.w,M.h,{left:0,top:0,right:0,bottom:0})})}};class ov{acquireContext(n,a){}releaseContext(n){return!1}addEventListener(n,a,o){}removeEventListener(n,a,o){}getDevicePixelRatio(){return 1}getMaximumSize(n,a,o,s){return a=Math.max(0,a||n.width),o=o||n.height,{width:a,height:Math.max(0,s?Math.floor(a/s):o)}}isAttached(n){return!0}updateConfig(n){}}class O6 extends ov{acquireContext(n){return n&&n.getContext&&n.getContext("2d")||null}updateConfig(n){n.options.animation=!1}}const hp="$chartjs",P6={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},H2=l=>l===null||l==="";function I6(l,n){const a=l.style,o=l.getAttribute("height"),s=l.getAttribute("width");if(l[hp]={initial:{height:o,width:s,style:{display:a.display,height:a.height,width:a.width}}},a.display=a.display||"block",a.boxSizing=a.boxSizing||"border-box",H2(s)){const e=C2(l,"width");e!==void 0&&(l.width=e)}if(H2(o))if(l.style.height==="")l.height=l.width/(n||2);else{const e=C2(l,"height");e!==void 0&&(l.height=e)}return l}const cv=Mj?{passive:!0}:!1;function B6(l,n,a){l&&l.addEventListener(n,a,cv)}function z6(l,n,a){l&&l.canvas&&l.canvas.removeEventListener(n,a,cv)}function U6(l,n){const a=P6[l.type]||l.type,{x:o,y:s}=Qd(l,n);return{type:a,chart:n,native:l,x:o!==void 0?o:null,y:s!==void 0?s:null}}function Np(l,n){for(const a of l)if(a===n||a.contains(n))return!0}function H6(l,n,a){const o=l.canvas,s=new MutationObserver(e=>{let m=!1;for(const v of e)m=m||Np(v.addedNodes,o),m=m&&!Np(v.removedNodes,o);m&&a()});return s.observe(document,{childList:!0,subtree:!0}),s}function V6(l,n,a){const o=l.canvas,s=new MutationObserver(e=>{let m=!1;for(const v of e)m=m||Np(v.removedNodes,o),m=m&&!Np(v.addedNodes,o);m&&a()});return s.observe(document,{childList:!0,subtree:!0}),s}const um=new Map;let V2=0;function dv(){const l=window.devicePixelRatio;l!==V2&&(V2=l,um.forEach((n,a)=>{a.currentDevicePixelRatio!==l&&n()}))}function W6(l,n){um.size||window.addEventListener("resize",dv),um.set(l,n)}function $6(l){um.delete(l),um.size||window.removeEventListener("resize",dv)}function q6(l,n,a){const o=l.canvas,s=o&&kx(o);if(!s)return;const e=Iy((v,w)=>{const N=s.clientWidth;a(v,w),N<s.clientWidth&&a()},window),m=new ResizeObserver(v=>{const w=v[0],N=w.contentRect.width,S=w.contentRect.height;N===0&&S===0||e(N,S)});return m.observe(s),W6(l,e),m}function S1(l,n,a){a&&a.disconnect(),n==="resize"&&$6(l)}function Y6(l,n,a){const o=l.canvas,s=Iy(e=>{l.ctx!==null&&a(U6(e,l))},l);return B6(o,n,s),s}class G6 extends ov{acquireContext(n,a){const o=n&&n.getContext&&n.getContext("2d");return o&&o.canvas===n?(I6(n,a),o):null}releaseContext(n){const a=n.canvas;if(!a[hp])return!1;const o=a[hp].initial;["height","width"].forEach(e=>{const m=o[e];ur(m)?a.removeAttribute(e):a.setAttribute(e,m)});const s=o.style||{};return Object.keys(s).forEach(e=>{a.style[e]=s[e]}),a.width=a.width,delete a[hp],!0}addEventListener(n,a,o){this.removeEventListener(n,a);const s=n.$proxies||(n.$proxies={}),m={attach:H6,detach:V6,resize:q6}[a]||Y6;s[a]=m(n,a,o)}removeEventListener(n,a){const o=n.$proxies||(n.$proxies={}),s=o[a];if(!s)return;({attach:S1,detach:S1,resize:S1}[a]||z6)(n,a,s),o[a]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(n,a,o,s){return Fj(n,a,o,s)}isAttached(n){const a=n&&kx(n);return!!(a&&a.isConnected)}}function K6(l){return!Nx()||typeof OffscreenCanvas<"u"&&l instanceof OffscreenCanvas?O6:G6}class Po{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(n){const{x:a,y:o}=this.getProps(["x","y"],n);return{x:a,y:o}}hasValue(){return Qu(this.x)&&Qu(this.y)}getProps(n,a){const o=this.$animations;if(!a||!o)return this;const s={};return n.forEach(e=>{s[e]=o[e]&&o[e].active()?o[e]._to:this[e]}),s}}function Q6(l,n){const a=l.options.ticks,o=X6(l),s=Math.min(a.maxTicksLimit||o,o),e=a.major.enabled?Z6(n):[],m=e.length,v=e[0],w=e[m-1],N=[];if(m>s)return eN(n,N,e,m/s),N;const S=J6(e,n,s);if(m>0){let D,L;const M=m>1?Math.round((w-v)/(m-1)):null;for(Jg(n,N,S,ur(M)?0:v-M,v),D=0,L=m-1;D<L;D++)Jg(n,N,S,e[D],e[D+1]);return Jg(n,N,S,w,ur(M)?n.length:w+M),N}return Jg(n,N,S),N}function X6(l){const n=l.options.offset,a=l._tickSize(),o=l._length/a+(n?0:1),s=l._maxLength/a;return Math.floor(Math.min(o,s))}function J6(l,n,a){const o=tN(l),s=n.length/a;if(!o)return Math.max(s,1);const e=M3(o);for(let m=0,v=e.length-1;m<v;m++){const w=e[m];if(w>s)return w}return Math.max(s,1)}function Z6(l){const n=[];let a,o;for(a=0,o=l.length;a<o;a++)l[a].major&&n.push(a);return n}function eN(l,n,a,o){let s=0,e=a[0],m;for(o=Math.ceil(o),m=0;m<l.length;m++)m===e&&(n.push(l[m]),s++,e=a[s*o])}function Jg(l,n,a,o,s){const e=Ts(o,0),m=Math.min(Ts(s,l.length),l.length);let v=0,w,N,S;for(a=Math.ceil(a),s&&(w=s-o,a=w/Math.floor(w/a)),S=e;S<0;)v++,S=Math.round(e+v*a);for(N=Math.max(e,0);N<m;N++)N===S&&(n.push(l[N]),v++,S=Math.round(e+v*a))}function tN(l){const n=l.length;let a,o;if(n<2)return!1;for(o=l[0],a=1;a<n;++a)if(l[a]-l[a-1]!==o)return!1;return o}const sN=l=>l==="left"?"right":l==="right"?"left":l,W2=(l,n,a)=>n==="top"||n==="left"?l[n]+a:l[n]-a,$2=(l,n)=>Math.min(n||l,l);function q2(l,n){const a=[],o=l.length/n,s=l.length;let e=0;for(;e<s;e+=o)a.push(l[Math.floor(e)]);return a}function rN(l,n,a){const o=l.ticks.length,s=Math.min(n,o-1),e=l._startPixel,m=l._endPixel,v=1e-6;let w=l.getPixelForTick(s),N;if(!(a&&(o===1?N=Math.max(w-e,m-w):n===0?N=(l.getPixelForTick(1)-w)/2:N=(w-l.getPixelForTick(s-1))/2,w+=s<n?N:-N,w<e-v||w>m+v)))return w}function aN(l,n){wr(l,a=>{const o=a.gc,s=o.length/2;let e;if(s>n){for(e=0;e<s;++e)delete a.data[o[e]];o.splice(0,s)}})}function Yf(l){return l.drawTicks?l.tickLength:0}function Y2(l,n){if(!l.display)return 0;const a=hn(l.font,n),o=_i(l.padding);return(Na(l.text)?l.text.length:1)*a.lineHeight+o.height}function nN(l,n){return l0(l,{scale:n,type:"scale"})}function iN(l,n,a){return l0(l,{tick:a,index:n,type:"tick"})}function lN(l,n,a){let o=xx(l);return(a&&n!=="right"||!a&&n==="right")&&(o=sN(o)),o}function oN(l,n,a,o){const{top:s,left:e,bottom:m,right:v,chart:w}=l,{chartArea:N,scales:S}=w;let D=0,L,M,F;const O=m-s,P=v-e;if(l.isHorizontal()){if(M=cn(o,e,v),Qs(a)){const K=Object.keys(a)[0],ne=a[K];F=S[K].getPixelForValue(ne)+O-n}else a==="center"?F=(N.bottom+N.top)/2+O-n:F=W2(l,a,n);L=v-e}else{if(Qs(a)){const K=Object.keys(a)[0],ne=a[K];M=S[K].getPixelForValue(ne)-P+n}else a==="center"?M=(N.left+N.right)/2-P+n:M=W2(l,a,n);F=cn(o,m,s),D=a==="left"?-Ta:Ta}return{titleX:M,titleY:F,maxWidth:L,rotation:D}}class ah extends Po{constructor(n){super(),this.id=n.id,this.type=n.type,this.options=void 0,this.ctx=n.ctx,this.chart=n.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(n){this.options=n.setContext(this.getContext()),this.axis=n.axis,this._userMin=this.parse(n.min),this._userMax=this.parse(n.max),this._suggestedMin=this.parse(n.suggestedMin),this._suggestedMax=this.parse(n.suggestedMax)}parse(n,a){return n}getUserBounds(){let{_userMin:n,_userMax:a,_suggestedMin:o,_suggestedMax:s}=this;return n=Ol(n,Number.POSITIVE_INFINITY),a=Ol(a,Number.NEGATIVE_INFINITY),o=Ol(o,Number.POSITIVE_INFINITY),s=Ol(s,Number.NEGATIVE_INFINITY),{min:Ol(n,o),max:Ol(a,s),minDefined:fn(n),maxDefined:fn(a)}}getMinMax(n){let{min:a,max:o,minDefined:s,maxDefined:e}=this.getUserBounds(),m;if(s&&e)return{min:a,max:o};const v=this.getMatchingVisibleMetas();for(let w=0,N=v.length;w<N;++w)m=v[w].controller.getMinMax(this,n),s||(a=Math.min(a,m.min)),e||(o=Math.max(o,m.max));return a=e&&a>o?o:a,o=s&&a>o?a:o,{min:Ol(a,Ol(o,a)),max:Ol(o,Ol(a,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const n=this.chart.data;return this.options.labels||(this.isHorizontal()?n.xLabels:n.yLabels)||n.labels||[]}getLabelItems(n=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(n))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Wr(this.options.beforeUpdate,[this])}update(n,a,o){const{beginAtZero:s,grace:e,ticks:m}=this.options,v=m.sampleSize;this.beforeUpdate(),this.maxWidth=n,this.maxHeight=a,this._margins=o=Object.assign({left:0,right:0,top:0,bottom:0},o),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+o.left+o.right:this.height+o.top+o.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=dj(this,e,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const w=v<this.ticks.length;this._convertTicksToLabels(w?q2(this.ticks,v):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),m.display&&(m.autoSkip||m.source==="auto")&&(this.ticks=Q6(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),w&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let n=this.options.reverse,a,o;this.isHorizontal()?(a=this.left,o=this.right):(a=this.top,o=this.bottom,n=!n),this._startPixel=a,this._endPixel=o,this._reversePixels=n,this._length=o-a,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Wr(this.options.afterUpdate,[this])}beforeSetDimensions(){Wr(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Wr(this.options.afterSetDimensions,[this])}_callHooks(n){this.chart.notifyPlugins(n,this.getContext()),Wr(this.options[n],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Wr(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(n){const a=this.options.ticks;let o,s,e;for(o=0,s=n.length;o<s;o++)e=n[o],e.label=Wr(a.callback,[e.value,o,n],this)}afterTickToLabelConversion(){Wr(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Wr(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const n=this.options,a=n.ticks,o=$2(this.ticks.length,n.ticks.maxTicksLimit),s=a.minRotation||0,e=a.maxRotation;let m=s,v,w,N;if(!this._isVisible()||!a.display||s>=e||o<=1||!this.isHorizontal()){this.labelRotation=s;return}const S=this._getLabelSizes(),D=S.widest.width,L=S.highest.height,M=un(this.chart.width-D,0,this.maxWidth);v=n.offset?this.maxWidth/o:M/(o-1),D+6>v&&(v=M/(o-(n.offset?.5:1)),w=this.maxHeight-Yf(n.grid)-a.padding-Y2(n.title,this.chart.options.font),N=Math.sqrt(D*D+L*L),m=P3(Math.min(Math.asin(un((S.highest.height+6)/v,-1,1)),Math.asin(un(w/N,-1,1))-Math.asin(un(L/N,-1,1)))),m=Math.max(s,Math.min(e,m))),this.labelRotation=m}afterCalculateLabelRotation(){Wr(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Wr(this.options.beforeFit,[this])}fit(){const n={width:0,height:0},{chart:a,options:{ticks:o,title:s,grid:e}}=this,m=this._isVisible(),v=this.isHorizontal();if(m){const w=Y2(s,a.options.font);if(v?(n.width=this.maxWidth,n.height=Yf(e)+w):(n.height=this.maxHeight,n.width=Yf(e)+w),o.display&&this.ticks.length){const{first:N,last:S,widest:D,highest:L}=this._getLabelSizes(),M=o.padding*2,F=Bl(this.labelRotation),O=Math.cos(F),P=Math.sin(F);if(v){const K=o.mirror?0:P*D.width+O*L.height;n.height=Math.min(this.maxHeight,n.height+K+M)}else{const K=o.mirror?0:O*D.width+P*L.height;n.width=Math.min(this.maxWidth,n.width+K+M)}this._calculatePadding(N,S,P,O)}}this._handleMargins(),v?(this.width=this._length=a.width-this._margins.left-this._margins.right,this.height=n.height):(this.width=n.width,this.height=this._length=a.height-this._margins.top-this._margins.bottom)}_calculatePadding(n,a,o,s){const{ticks:{align:e,padding:m},position:v}=this.options,w=this.labelRotation!==0,N=v!=="top"&&this.axis==="x";if(this.isHorizontal()){const S=this.getPixelForTick(0)-this.left,D=this.right-this.getPixelForTick(this.ticks.length-1);let L=0,M=0;w?N?(L=s*n.width,M=o*a.height):(L=o*n.height,M=s*a.width):e==="start"?M=a.width:e==="end"?L=n.width:e!=="inner"&&(L=n.width/2,M=a.width/2),this.paddingLeft=Math.max((L-S+m)*this.width/(this.width-S),0),this.paddingRight=Math.max((M-D+m)*this.width/(this.width-D),0)}else{let S=a.height/2,D=n.height/2;e==="start"?(S=0,D=n.height):e==="end"&&(S=a.height,D=0),this.paddingTop=S+m,this.paddingBottom=D+m}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Wr(this.options.afterFit,[this])}isHorizontal(){const{axis:n,position:a}=this.options;return a==="top"||a==="bottom"||n==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(n){this.beforeTickToLabelConversion(),this.generateTickLabels(n);let a,o;for(a=0,o=n.length;a<o;a++)ur(n[a].label)&&(n.splice(a,1),o--,a--);this.afterTickToLabelConversion()}_getLabelSizes(){let n=this._labelSizes;if(!n){const a=this.options.ticks.sampleSize;let o=this.ticks;a<o.length&&(o=q2(o,a)),this._labelSizes=n=this._computeLabelSizes(o,o.length,this.options.ticks.maxTicksLimit)}return n}_computeLabelSizes(n,a,o){const{ctx:s,_longestTextCache:e}=this,m=[],v=[],w=Math.floor(a/$2(a,o));let N=0,S=0,D,L,M,F,O,P,K,ne,se,Ce,ge;for(D=0;D<a;D+=w){if(F=n[D].label,O=this._resolveTickFontOptions(D),s.font=P=O.string,K=e[P]=e[P]||{data:{},gc:[]},ne=O.lineHeight,se=Ce=0,!ur(F)&&!Na(F))se=v2(s,K.data,K.gc,se,F),Ce=ne;else if(Na(F))for(L=0,M=F.length;L<M;++L)ge=F[L],!ur(ge)&&!Na(ge)&&(se=v2(s,K.data,K.gc,se,ge),Ce+=ne);m.push(se),v.push(Ce),N=Math.max(se,N),S=Math.max(Ce,S)}aN(e,a);const Ne=m.indexOf(N),J=v.indexOf(S),de=le=>({width:m[le]||0,height:v[le]||0});return{first:de(0),last:de(a-1),widest:de(Ne),highest:de(J),widths:m,heights:v}}getLabelForValue(n){return n}getPixelForValue(n,a){return NaN}getValueForPixel(n){}getPixelForTick(n){const a=this.ticks;return n<0||n>a.length-1?null:this.getPixelForValue(a[n].value)}getPixelForDecimal(n){this._reversePixels&&(n=1-n);const a=this._startPixel+n*this._length;return B3(this._alignToPixels?Gd(this.chart,a,0):a)}getDecimalForPixel(n){const a=(n-this._startPixel)/this._length;return this._reversePixels?1-a:a}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:n,max:a}=this;return n<0&&a<0?a:n>0&&a>0?n:0}getContext(n){const a=this.ticks||[];if(n>=0&&n<a.length){const o=a[n];return o.$context||(o.$context=iN(this.getContext(),n,o))}return this.$context||(this.$context=nN(this.chart.getContext(),this))}_tickSize(){const n=this.options.ticks,a=Bl(this.labelRotation),o=Math.abs(Math.cos(a)),s=Math.abs(Math.sin(a)),e=this._getLabelSizes(),m=n.autoSkipPadding||0,v=e?e.widest.width+m:0,w=e?e.highest.height+m:0;return this.isHorizontal()?w*o>v*s?v/o:w/s:w*s<v*o?w/o:v/s}_isVisible(){const n=this.options.display;return n!=="auto"?!!n:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(n){const a=this.axis,o=this.chart,s=this.options,{grid:e,position:m,border:v}=s,w=e.offset,N=this.isHorizontal(),D=this.ticks.length+(w?1:0),L=Yf(e),M=[],F=v.setContext(this.getContext()),O=F.display?F.width:0,P=O/2,K=function(fe){return Gd(o,fe,O)};let ne,se,Ce,ge,Ne,J,de,le,ze,me,oe,ce;if(m==="top")ne=K(this.bottom),J=this.bottom-L,le=ne-P,me=K(n.top)+P,ce=n.bottom;else if(m==="bottom")ne=K(this.top),me=n.top,ce=K(n.bottom)-P,J=ne+P,le=this.top+L;else if(m==="left")ne=K(this.right),Ne=this.right-L,de=ne-P,ze=K(n.left)+P,oe=n.right;else if(m==="right")ne=K(this.left),ze=n.left,oe=K(n.right)-P,Ne=ne+P,de=this.left+L;else if(a==="x"){if(m==="center")ne=K((n.top+n.bottom)/2+.5);else if(Qs(m)){const fe=Object.keys(m)[0],Se=m[fe];ne=K(this.chart.scales[fe].getPixelForValue(Se))}me=n.top,ce=n.bottom,J=ne+P,le=J+L}else if(a==="y"){if(m==="center")ne=K((n.left+n.right)/2);else if(Qs(m)){const fe=Object.keys(m)[0],Se=m[fe];ne=K(this.chart.scales[fe].getPixelForValue(Se))}Ne=ne-P,de=Ne-L,ze=n.left,oe=n.right}const ye=Ts(s.ticks.maxTicksLimit,D),ke=Math.max(1,Math.ceil(D/ye));for(se=0;se<D;se+=ke){const fe=this.getContext(se),Se=e.setContext(fe),Ye=v.setContext(fe),te=Se.lineWidth,pe=Se.color,V=Ye.dash||[],be=Ye.dashOffset,_e=Se.tickWidth,De=Se.tickColor,W=Se.tickBorderDash||[],H=Se.tickBorderDashOffset;Ce=rN(this,se,w),Ce!==void 0&&(ge=Gd(o,Ce,te),N?Ne=de=ze=oe=ge:J=le=me=ce=ge,M.push({tx1:Ne,ty1:J,tx2:de,ty2:le,x1:ze,y1:me,x2:oe,y2:ce,width:te,color:pe,borderDash:V,borderDashOffset:be,tickWidth:_e,tickColor:De,tickBorderDash:W,tickBorderDashOffset:H}))}return this._ticksLength=D,this._borderValue=ne,M}_computeLabelItems(n){const a=this.axis,o=this.options,{position:s,ticks:e}=o,m=this.isHorizontal(),v=this.ticks,{align:w,crossAlign:N,padding:S,mirror:D}=e,L=Yf(o.grid),M=L+S,F=D?-S:M,O=-Bl(this.labelRotation),P=[];let K,ne,se,Ce,ge,Ne,J,de,le,ze,me,oe,ce="middle";if(s==="top")Ne=this.bottom-F,J=this._getXAxisLabelAlignment();else if(s==="bottom")Ne=this.top+F,J=this._getXAxisLabelAlignment();else if(s==="left"){const ke=this._getYAxisLabelAlignment(L);J=ke.textAlign,ge=ke.x}else if(s==="right"){const ke=this._getYAxisLabelAlignment(L);J=ke.textAlign,ge=ke.x}else if(a==="x"){if(s==="center")Ne=(n.top+n.bottom)/2+M;else if(Qs(s)){const ke=Object.keys(s)[0],fe=s[ke];Ne=this.chart.scales[ke].getPixelForValue(fe)+M}J=this._getXAxisLabelAlignment()}else if(a==="y"){if(s==="center")ge=(n.left+n.right)/2-M;else if(Qs(s)){const ke=Object.keys(s)[0],fe=s[ke];ge=this.chart.scales[ke].getPixelForValue(fe)}J=this._getYAxisLabelAlignment(L).textAlign}a==="y"&&(w==="start"?ce="top":w==="end"&&(ce="bottom"));const ye=this._getLabelSizes();for(K=0,ne=v.length;K<ne;++K){se=v[K],Ce=se.label;const ke=e.setContext(this.getContext(K));de=this.getPixelForTick(K)+e.labelOffset,le=this._resolveTickFontOptions(K),ze=le.lineHeight,me=Na(Ce)?Ce.length:1;const fe=me/2,Se=ke.color,Ye=ke.textStrokeColor,te=ke.textStrokeWidth;let pe=J;m?(ge=de,J==="inner"&&(K===ne-1?pe=this.options.reverse?"left":"right":K===0?pe=this.options.reverse?"right":"left":pe="center"),s==="top"?N==="near"||O!==0?oe=-me*ze+ze/2:N==="center"?oe=-ye.highest.height/2-fe*ze+ze:oe=-ye.highest.height+ze/2:N==="near"||O!==0?oe=ze/2:N==="center"?oe=ye.highest.height/2-fe*ze:oe=ye.highest.height-me*ze,D&&(oe*=-1),O!==0&&!ke.showLabelBackdrop&&(ge+=ze/2*Math.sin(O))):(Ne=de,oe=(1-me)*ze/2);let V;if(ke.showLabelBackdrop){const be=_i(ke.backdropPadding),_e=ye.heights[K],De=ye.widths[K];let W=oe-be.top,H=0-be.left;switch(ce){case"middle":W-=_e/2;break;case"bottom":W-=_e;break}switch(J){case"center":H-=De/2;break;case"right":H-=De;break;case"inner":K===ne-1?H-=De:K>0&&(H-=De/2);break}V={left:H,top:W,width:De+be.width,height:_e+be.height,color:ke.backdropColor}}P.push({label:Ce,font:le,textOffset:oe,options:{rotation:O,color:Se,strokeColor:Ye,strokeWidth:te,textAlign:pe,textBaseline:ce,translation:[ge,Ne],backdrop:V}})}return P}_getXAxisLabelAlignment(){const{position:n,ticks:a}=this.options;if(-Bl(this.labelRotation))return n==="top"?"left":"right";let s="center";return a.align==="start"?s="left":a.align==="end"?s="right":a.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(n){const{position:a,ticks:{crossAlign:o,mirror:s,padding:e}}=this.options,m=this._getLabelSizes(),v=n+e,w=m.widest.width;let N,S;return a==="left"?s?(S=this.right+e,o==="near"?N="left":o==="center"?(N="center",S+=w/2):(N="right",S+=w)):(S=this.right-v,o==="near"?N="right":o==="center"?(N="center",S-=w/2):(N="left",S=this.left)):a==="right"?s?(S=this.left+e,o==="near"?N="right":o==="center"?(N="center",S-=w/2):(N="left",S-=w)):(S=this.left+v,o==="near"?N="left":o==="center"?(N="center",S+=w/2):(N="right",S=this.right)):N="right",{textAlign:N,x:S}}_computeLabelArea(){if(this.options.ticks.mirror)return;const n=this.chart,a=this.options.position;if(a==="left"||a==="right")return{top:0,left:this.left,bottom:n.height,right:this.right};if(a==="top"||a==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:n.width}}drawBackground(){const{ctx:n,options:{backgroundColor:a},left:o,top:s,width:e,height:m}=this;a&&(n.save(),n.fillStyle=a,n.fillRect(o,s,e,m),n.restore())}getLineWidthForValue(n){const a=this.options.grid;if(!this._isVisible()||!a.display)return 0;const s=this.ticks.findIndex(e=>e.value===n);return s>=0?a.setContext(this.getContext(s)).lineWidth:0}drawGrid(n){const a=this.options.grid,o=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(n));let e,m;const v=(w,N,S)=>{!S.width||!S.color||(o.save(),o.lineWidth=S.width,o.strokeStyle=S.color,o.setLineDash(S.borderDash||[]),o.lineDashOffset=S.borderDashOffset,o.beginPath(),o.moveTo(w.x,w.y),o.lineTo(N.x,N.y),o.stroke(),o.restore())};if(a.display)for(e=0,m=s.length;e<m;++e){const w=s[e];a.drawOnChartArea&&v({x:w.x1,y:w.y1},{x:w.x2,y:w.y2},w),a.drawTicks&&v({x:w.tx1,y:w.ty1},{x:w.tx2,y:w.ty2},{color:w.tickColor,width:w.tickWidth,borderDash:w.tickBorderDash,borderDashOffset:w.tickBorderDashOffset})}}drawBorder(){const{chart:n,ctx:a,options:{border:o,grid:s}}=this,e=o.setContext(this.getContext()),m=o.display?e.width:0;if(!m)return;const v=s.setContext(this.getContext(0)).lineWidth,w=this._borderValue;let N,S,D,L;this.isHorizontal()?(N=Gd(n,this.left,m)-m/2,S=Gd(n,this.right,v)+v/2,D=L=w):(D=Gd(n,this.top,m)-m/2,L=Gd(n,this.bottom,v)+v/2,N=S=w),a.save(),a.lineWidth=e.width,a.strokeStyle=e.color,a.beginPath(),a.moveTo(N,D),a.lineTo(S,L),a.stroke(),a.restore()}drawLabels(n){if(!this.options.ticks.display)return;const o=this.ctx,s=this._computeLabelArea();s&&Mp(o,s);const e=this.getLabelItems(n);for(const m of e){const v=m.options,w=m.font,N=m.label,S=m.textOffset;dm(o,N,0,S,w,v)}s&&Lp(o)}drawTitle(){const{ctx:n,options:{position:a,title:o,reverse:s}}=this;if(!o.display)return;const e=hn(o.font),m=_i(o.padding),v=o.align;let w=e.lineHeight/2;a==="bottom"||a==="center"||Qs(a)?(w+=m.bottom,Na(o.text)&&(w+=e.lineHeight*(o.text.length-1))):w+=m.top;const{titleX:N,titleY:S,maxWidth:D,rotation:L}=oN(this,w,a,v);dm(n,o.text,0,0,e,{color:o.color,maxWidth:D,rotation:L,textAlign:lN(v,a,s),textBaseline:"middle",translation:[N,S]})}draw(n){this._isVisible()&&(this.drawBackground(),this.drawGrid(n),this.drawBorder(),this.drawTitle(),this.drawLabels(n))}_layers(){const n=this.options,a=n.ticks&&n.ticks.z||0,o=Ts(n.grid&&n.grid.z,-1),s=Ts(n.border&&n.border.z,0);return!this._isVisible()||this.draw!==ah.prototype.draw?[{z:a,draw:e=>{this.draw(e)}}]:[{z:o,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:a,draw:e=>{this.drawLabels(e)}}]}getMatchingVisibleMetas(n){const a=this.chart.getSortedVisibleDatasetMetas(),o=this.axis+"AxisID",s=[];let e,m;for(e=0,m=a.length;e<m;++e){const v=a[e];v[o]===this.id&&(!n||v.type===n)&&s.push(v)}return s}_resolveTickFontOptions(n){const a=this.options.ticks.setContext(this.getContext(n));return hn(a.font)}_maxDigits(){const n=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/n}}class Zg{constructor(n,a,o){this.type=n,this.scope=a,this.override=o,this.items=Object.create(null)}isForType(n){return Object.prototype.isPrototypeOf.call(this.type.prototype,n.prototype)}register(n){const a=Object.getPrototypeOf(n);let o;uN(a)&&(o=this.register(a));const s=this.items,e=n.id,m=this.scope+"."+e;if(!e)throw new Error("class does not have id: "+n);return e in s||(s[e]=n,cN(n,m,o),this.override&&fa.override(n.id,n.overrides)),m}get(n){return this.items[n]}unregister(n){const a=this.items,o=n.id,s=this.scope;o in a&&delete a[o],s&&o in fa[s]&&(delete fa[s][o],this.override&&delete r0[o])}}function cN(l,n,a){const o=im(Object.create(null),[a?fa.get(a):{},fa.get(n),l.defaults]);fa.set(n,o),l.defaultRoutes&&dN(n,l.defaultRoutes),l.descriptors&&fa.describe(n,l.descriptors)}function dN(l,n){Object.keys(n).forEach(a=>{const o=a.split("."),s=o.pop(),e=[l].concat(o).join("."),m=n[a].split("."),v=m.pop(),w=m.join(".");fa.route(e,s,w,v)})}function uN(l){return"id"in l&&"defaults"in l}class hN{constructor(){this.controllers=new Zg(Pc,"datasets",!0),this.elements=new Zg(Po,"elements"),this.plugins=new Zg(Object,"plugins"),this.scales=new Zg(ah,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...n){this._each("register",n)}remove(...n){this._each("unregister",n)}addControllers(...n){this._each("register",n,this.controllers)}addElements(...n){this._each("register",n,this.elements)}addPlugins(...n){this._each("register",n,this.plugins)}addScales(...n){this._each("register",n,this.scales)}getController(n){return this._get(n,this.controllers,"controller")}getElement(n){return this._get(n,this.elements,"element")}getPlugin(n){return this._get(n,this.plugins,"plugin")}getScale(n){return this._get(n,this.scales,"scale")}removeControllers(...n){this._each("unregister",n,this.controllers)}removeElements(...n){this._each("unregister",n,this.elements)}removePlugins(...n){this._each("unregister",n,this.plugins)}removeScales(...n){this._each("unregister",n,this.scales)}_each(n,a,o){[...a].forEach(s=>{const e=o||this._getRegistryForType(s);o||e.isForType(s)||e===this.plugins&&s.id?this._exec(n,e,s):wr(s,m=>{const v=o||this._getRegistryForType(m);this._exec(n,v,m)})})}_exec(n,a,o){const s=gx(n);Wr(o["before"+s],[],o),a[n](o),Wr(o["after"+s],[],o)}_getRegistryForType(n){for(let a=0;a<this._typedRegistries.length;a++){const o=this._typedRegistries[a];if(o.isForType(n))return o}return this.plugins}_get(n,a,o){const s=a.get(n);if(s===void 0)throw new Error('"'+n+'" is not a registered '+o+".");return s}}var Il=new hN;class fN{constructor(){this._init=void 0}notify(n,a,o,s){if(a==="beforeInit"&&(this._init=this._createDescriptors(n,!0),this._notify(this._init,n,"install")),this._init===void 0)return;const e=s?this._descriptors(n).filter(s):this._descriptors(n),m=this._notify(e,n,a,o);return a==="afterDestroy"&&(this._notify(e,n,"stop"),this._notify(this._init,n,"uninstall"),this._init=void 0),m}_notify(n,a,o,s){s=s||{};for(const e of n){const m=e.plugin,v=m[o],w=[a,s,e.options];if(Wr(v,w,m)===!1&&s.cancelable)return!1}return!0}invalidate(){ur(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(n){if(this._cache)return this._cache;const a=this._cache=this._createDescriptors(n);return this._notifyStateChanges(n),a}_createDescriptors(n,a){const o=n&&n.config,s=Ts(o.options&&o.options.plugins,{}),e=mN(o);return s===!1&&!a?[]:pN(n,e,s,a)}_notifyStateChanges(n){const a=this._oldCache||[],o=this._cache,s=(e,m)=>e.filter(v=>!m.some(w=>v.plugin.id===w.plugin.id));this._notify(s(a,o),n,"stop"),this._notify(s(o,a),n,"start")}}function mN(l){const n={},a=[],o=Object.keys(Il.plugins.items);for(let e=0;e<o.length;e++)a.push(Il.getPlugin(o[e]));const s=l.plugins||[];for(let e=0;e<s.length;e++){const m=s[e];a.indexOf(m)===-1&&(a.push(m),n[m.id]=!0)}return{plugins:a,localIds:n}}function gN(l,n){return!n&&l===!1?null:l===!0?{}:l}function pN(l,{plugins:n,localIds:a},o,s){const e=[],m=l.getContext();for(const v of n){const w=v.id,N=gN(o[w],s);N!==null&&e.push({plugin:v,options:xN(l.config,{plugin:v,local:a[w]},N,m)})}return e}function xN(l,{plugin:n,local:a},o,s){const e=l.pluginScopeKeys(n),m=l.getOptionScopes(o,e);return a&&n.defaults&&m.push(n.defaults),l.createResolver(m,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Q1(l,n){const a=fa.datasets[l]||{};return((n.datasets||{})[l]||{}).indexAxis||n.indexAxis||a.indexAxis||"x"}function bN(l,n){let a=l;return l==="_index_"?a=n:l==="_value_"&&(a=n==="x"?"y":"x"),a}function yN(l,n){return l===n?"_index_":"_value_"}function G2(l){if(l==="x"||l==="y"||l==="r")return l}function vN(l){if(l==="top"||l==="bottom")return"x";if(l==="left"||l==="right")return"y"}function X1(l,...n){if(G2(l))return l;for(const a of n){const o=a.axis||vN(a.position)||l.length>1&&G2(l[0].toLowerCase());if(o)return o}throw new Error(`Cannot determine type of '${l}' axis. Please provide 'axis' or 'position' option.`)}function K2(l,n,a){if(a[n+"AxisID"]===l)return{axis:n}}function wN(l,n){if(n.data&&n.data.datasets){const a=n.data.datasets.filter(o=>o.xAxisID===l||o.yAxisID===l);if(a.length)return K2(l,"x",a[0])||K2(l,"y",a[0])}return{}}function jN(l,n){const a=r0[l.type]||{scales:{}},o=n.scales||{},s=Q1(l.type,n),e=Object.create(null);return Object.keys(o).forEach(m=>{const v=o[m];if(!Qs(v))return console.error(`Invalid scale configuration for scale: ${m}`);if(v._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${m}`);const w=X1(m,v,wN(m,l),fa.scales[v.type]),N=yN(w,s),S=a.scales||{};e[m]=em(Object.create(null),[{axis:w},v,S[w],S[N]])}),l.data.datasets.forEach(m=>{const v=m.type||l.type,w=m.indexAxis||Q1(v,n),S=(r0[v]||{}).scales||{};Object.keys(S).forEach(D=>{const L=bN(D,w),M=m[L+"AxisID"]||L;e[M]=e[M]||Object.create(null),em(e[M],[{axis:L},o[M],S[D]])})}),Object.keys(e).forEach(m=>{const v=e[m];em(v,[fa.scales[v.type],fa.scale])}),e}function uv(l){const n=l.options||(l.options={});n.plugins=Ts(n.plugins,{}),n.scales=jN(l,n)}function hv(l){return l=l||{},l.datasets=l.datasets||[],l.labels=l.labels||[],l}function NN(l){return l=l||{},l.data=hv(l.data),uv(l),l}const Q2=new Map,fv=new Set;function ep(l,n){let a=Q2.get(l);return a||(a=n(),Q2.set(l,a),fv.add(a)),a}const Gf=(l,n,a)=>{const o=Rc(n,a);o!==void 0&&l.add(o)};class kN{constructor(n){this._config=NN(n),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(n){this._config.type=n}get data(){return this._config.data}set data(n){this._config.data=hv(n)}get options(){return this._config.options}set options(n){this._config.options=n}get plugins(){return this._config.plugins}update(){const n=this._config;this.clearCache(),uv(n)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(n){return ep(n,()=>[[`datasets.${n}`,""]])}datasetAnimationScopeKeys(n,a){return ep(`${n}.transition.${a}`,()=>[[`datasets.${n}.transitions.${a}`,`transitions.${a}`],[`datasets.${n}`,""]])}datasetElementScopeKeys(n,a){return ep(`${n}-${a}`,()=>[[`datasets.${n}.elements.${a}`,`datasets.${n}`,`elements.${a}`,""]])}pluginScopeKeys(n){const a=n.id,o=this.type;return ep(`${o}-plugin-${a}`,()=>[[`plugins.${a}`,...n.additionalOptionScopes||[]]])}_cachedScopes(n,a){const o=this._scopeCache;let s=o.get(n);return(!s||a)&&(s=new Map,o.set(n,s)),s}getOptionScopes(n,a,o){const{options:s,type:e}=this,m=this._cachedScopes(n,o),v=m.get(a);if(v)return v;const w=new Set;a.forEach(S=>{n&&(w.add(n),S.forEach(D=>Gf(w,n,D))),S.forEach(D=>Gf(w,s,D)),S.forEach(D=>Gf(w,r0[e]||{},D)),S.forEach(D=>Gf(w,fa,D)),S.forEach(D=>Gf(w,G1,D))});const N=Array.from(w);return N.length===0&&N.push(Object.create(null)),fv.has(a)&&m.set(a,N),N}chartOptionScopes(){const{options:n,type:a}=this;return[n,r0[a]||{},fa.datasets[a]||{},{type:a},fa,G1]}resolveNamedOptions(n,a,o,s=[""]){const e={$shared:!0},{resolver:m,subPrefixes:v}=X2(this._resolverCache,n,s);let w=m;if(SN(m,a)){e.$shared=!1,o=Oc(o)?o():o;const N=this.createResolver(n,o,v);w=Xu(m,o,N)}for(const N of a)e[N]=w[N];return e}createResolver(n,a,o=[""],s){const{resolver:e}=X2(this._resolverCache,n,o);return Qs(a)?Xu(e,a,void 0,s):e}}function X2(l,n,a){let o=l.get(n);o||(o=new Map,l.set(n,o));const s=a.join();let e=o.get(s);return e||(e={resolver:vx(n,a),subPrefixes:a.filter(v=>!v.toLowerCase().includes("hover"))},o.set(s,e)),e}const CN=l=>Qs(l)&&Object.getOwnPropertyNames(l).some(n=>Oc(l[n]));function SN(l,n){const{isScriptable:a,isIndexable:o}=Wy(l);for(const s of n){const e=a(s),m=o(s),v=(m||e)&&l[s];if(e&&(Oc(v)||CN(v))||m&&Na(v))return!0}return!1}var AN="4.5.1";const EN=["top","bottom","left","right","chartArea"];function J2(l,n){return l==="top"||l==="bottom"||EN.indexOf(l)===-1&&n==="x"}function Z2(l,n){return function(a,o){return a[l]===o[l]?a[n]-o[n]:a[l]-o[l]}}function eb(l){const n=l.chart,a=n.options.animation;n.notifyPlugins("afterRender"),Wr(a&&a.onComplete,[l],n)}function DN(l){const n=l.chart,a=n.options.animation;Wr(a&&a.onProgress,[l],n)}function mv(l){return Nx()&&typeof l=="string"?l=document.getElementById(l):l&&l.length&&(l=l[0]),l&&l.canvas&&(l=l.canvas),l}const fp={},tb=l=>{const n=mv(l);return Object.values(fp).filter(a=>a.canvas===n).pop()};function TN(l,n,a){const o=Object.keys(l);for(const s of o){const e=+s;if(e>=n){const m=l[s];delete l[s],(a>0||e>n)&&(l[e+a]=m)}}}function _N(l,n,a,o){return!a||l.type==="mouseout"?null:o?n:l}let cl=class{static defaults=fa;static instances=fp;static overrides=r0;static registry=Il;static version=AN;static getChart=tb;static register(...n){Il.add(...n),sb()}static unregister(...n){Il.remove(...n),sb()}constructor(n,a){const o=this.config=new kN(a),s=mv(n),e=tb(s);if(e)throw new Error("Canvas is already in use. Chart with ID '"+e.id+"' must be destroyed before the canvas with ID '"+e.canvas.id+"' can be reused.");const m=o.createResolver(o.chartOptionScopes(),this.getContext());this.platform=new(o.platform||K6(s)),this.platform.updateConfig(o);const v=this.platform.acquireContext(s,m.aspectRatio),w=v&&v.canvas,N=w&&w.height,S=w&&w.width;if(this.id=k3(),this.ctx=v,this.canvas=w,this.width=S,this.height=N,this._options=m,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new fN,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=V3(D=>this.update(D),m.resizeDelay||0),this._dataChanges=[],fp[this.id]=this,!v||!w){console.error("Failed to create chart: can't acquire context from the given item");return}To.listen(this,"complete",eb),To.listen(this,"progress",DN),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:n,maintainAspectRatio:a},width:o,height:s,_aspectRatio:e}=this;return ur(n)?a&&e?e:s?o/s:null:n}get data(){return this.config.data}set data(n){this.config.data=n}get options(){return this._options}set options(n){this.config.options=n}get registry(){return Il}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():k2(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return w2(this.canvas,this.ctx),this}stop(){return To.stop(this),this}resize(n,a){To.running(this)?this._resizeBeforeDraw={width:n,height:a}:this._resize(n,a)}_resize(n,a){const o=this.options,s=this.canvas,e=o.maintainAspectRatio&&this.aspectRatio,m=this.platform.getMaximumSize(s,n,a,e),v=o.devicePixelRatio||this.platform.getDevicePixelRatio(),w=this.width?"resize":"attach";this.width=m.width,this.height=m.height,this._aspectRatio=this.aspectRatio,k2(this,v,!0)&&(this.notifyPlugins("resize",{size:m}),Wr(o.onResize,[this,m],this),this.attached&&this._doResize(w)&&this.render())}ensureScalesHaveIDs(){const a=this.options.scales||{};wr(a,(o,s)=>{o.id=s})}buildOrUpdateScales(){const n=this.options,a=n.scales,o=this.scales,s=Object.keys(o).reduce((m,v)=>(m[v]=!1,m),{});let e=[];a&&(e=e.concat(Object.keys(a).map(m=>{const v=a[m],w=X1(m,v),N=w==="r",S=w==="x";return{options:v,dposition:N?"chartArea":S?"bottom":"left",dtype:N?"radialLinear":S?"category":"linear"}}))),wr(e,m=>{const v=m.options,w=v.id,N=X1(w,v),S=Ts(v.type,m.dtype);(v.position===void 0||J2(v.position,N)!==J2(m.dposition))&&(v.position=m.dposition),s[w]=!0;let D=null;if(w in o&&o[w].type===S)D=o[w];else{const L=Il.getScale(S);D=new L({id:w,type:S,ctx:this.ctx,chart:this}),o[D.id]=D}D.init(v,n)}),wr(s,(m,v)=>{m||delete o[v]}),wr(o,m=>{Ti.configure(this,m,m.options),Ti.addBox(this,m)})}_updateMetasets(){const n=this._metasets,a=this.data.datasets.length,o=n.length;if(n.sort((s,e)=>s.index-e.index),o>a){for(let s=a;s<o;++s)this._destroyDatasetMeta(s);n.splice(a,o-a)}this._sortedMetasets=n.slice(0).sort(Z2("order","index"))}_removeUnreferencedMetasets(){const{_metasets:n,data:{datasets:a}}=this;n.length>a.length&&delete this._stacks,n.forEach((o,s)=>{a.filter(e=>e===o._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const n=[],a=this.data.datasets;let o,s;for(this._removeUnreferencedMetasets(),o=0,s=a.length;o<s;o++){const e=a[o];let m=this.getDatasetMeta(o);const v=e.type||this.config.type;if(m.type&&m.type!==v&&(this._destroyDatasetMeta(o),m=this.getDatasetMeta(o)),m.type=v,m.indexAxis=e.indexAxis||Q1(v,this.options),m.order=e.order||0,m.index=o,m.label=""+e.label,m.visible=this.isDatasetVisible(o),m.controller)m.controller.updateIndex(o),m.controller.linkScales();else{const w=Il.getController(v),{datasetElementType:N,dataElementType:S}=fa.datasets[v];Object.assign(w,{dataElementType:Il.getElement(S),datasetElementType:N&&Il.getElement(N)}),m.controller=new w(this,o),n.push(m.controller)}}return this._updateMetasets(),n}_resetElements(){wr(this.data.datasets,(n,a)=>{this.getDatasetMeta(a).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(n){const a=this.config;a.update();const o=this._options=a.createResolver(a.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!o.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:n,cancelable:!0})===!1)return;const e=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let m=0;for(let N=0,S=this.data.datasets.length;N<S;N++){const{controller:D}=this.getDatasetMeta(N),L=!s&&e.indexOf(D)===-1;D.buildOrUpdateElements(L),m=Math.max(+D.getMaxOverflow(),m)}m=this._minPadding=o.layout.autoPadding?m:0,this._updateLayout(m),s||wr(e,N=>{N.reset()}),this._updateDatasets(n),this.notifyPlugins("afterUpdate",{mode:n}),this._layers.sort(Z2("z","_idx"));const{_active:v,_lastEvent:w}=this;w?this._eventHandler(w,!0):v.length&&this._updateHoverStyles(v,v,!0),this.render()}_updateScales(){wr(this.scales,n=>{Ti.removeBox(this,n)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const n=this.options,a=new Set(Object.keys(this._listeners)),o=new Set(n.events);(!u2(a,o)||!!this._responsiveListeners!==n.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:n}=this,a=this._getUniformDataChanges()||[];for(const{method:o,start:s,count:e}of a){const m=o==="_removeElements"?-e:e;TN(n,s,m)}}_getUniformDataChanges(){const n=this._dataChanges;if(!n||!n.length)return;this._dataChanges=[];const a=this.data.datasets.length,o=e=>new Set(n.filter(m=>m[0]===e).map((m,v)=>v+","+m.splice(1).join(","))),s=o(0);for(let e=1;e<a;e++)if(!u2(s,o(e)))return;return Array.from(s).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(n){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ti.update(this,this.width,this.height,n);const a=this.chartArea,o=a.width<=0||a.height<=0;this._layers=[],wr(this.boxes,s=>{o&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,e)=>{s._idx=e}),this.notifyPlugins("afterLayout")}_updateDatasets(n){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:n,cancelable:!0})!==!1){for(let a=0,o=this.data.datasets.length;a<o;++a)this.getDatasetMeta(a).controller.configure();for(let a=0,o=this.data.datasets.length;a<o;++a)this._updateDataset(a,Oc(n)?n({datasetIndex:a}):n);this.notifyPlugins("afterDatasetsUpdate",{mode:n})}}_updateDataset(n,a){const o=this.getDatasetMeta(n),s={meta:o,index:n,mode:a,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(o.controller._update(a),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(To.has(this)?this.attached&&!To.running(this)&&To.start(this):(this.draw(),eb({chart:this})))}draw(){let n;if(this._resizeBeforeDraw){const{width:o,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(o,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const a=this._layers;for(n=0;n<a.length&&a[n].z<=0;++n)a[n].draw(this.chartArea);for(this._drawDatasets();n<a.length;++n)a[n].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(n){const a=this._sortedMetasets,o=[];let s,e;for(s=0,e=a.length;s<e;++s){const m=a[s];(!n||m.visible)&&o.push(m)}return o}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const n=this.getSortedVisibleDatasetMetas();for(let a=n.length-1;a>=0;--a)this._drawDataset(n[a]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(n){const a=this.ctx,o={meta:n,index:n.index,cancelable:!0},s=tv(this,n);this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(s&&Mp(a,s),n.controller.draw(),s&&Lp(a),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(n){return cm(n,this.chartArea,this._minPadding)}getElementsAtEventForMode(n,a,o,s){const e=E6.modes[a];return typeof e=="function"?e(this,n,o,s):[]}getDatasetMeta(n){const a=this.data.datasets[n],o=this._metasets;let s=o.filter(e=>e&&e._dataset===a).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:a&&a.order||0,index:n,_dataset:a,_parsed:[],_sorted:!1},o.push(s)),s}getContext(){return this.$context||(this.$context=l0(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(n){const a=this.data.datasets[n];if(!a)return!1;const o=this.getDatasetMeta(n);return typeof o.hidden=="boolean"?!o.hidden:!a.hidden}setDatasetVisibility(n,a){const o=this.getDatasetMeta(n);o.hidden=!a}toggleDataVisibility(n){this._hiddenIndices[n]=!this._hiddenIndices[n]}getDataVisibility(n){return!this._hiddenIndices[n]}_updateVisibility(n,a,o){const s=o?"show":"hide",e=this.getDatasetMeta(n),m=e.controller._resolveAnimations(void 0,s);lm(a)?(e.data[a].hidden=!o,this.update()):(this.setDatasetVisibility(n,o),m.update(e,{visible:o}),this.update(v=>v.datasetIndex===n?s:void 0))}hide(n,a){this._updateVisibility(n,a,!1)}show(n,a){this._updateVisibility(n,a,!0)}_destroyDatasetMeta(n){const a=this._metasets[n];a&&a.controller&&a.controller._destroy(),delete this._metasets[n]}_stop(){let n,a;for(this.stop(),To.remove(this),n=0,a=this.data.datasets.length;n<a;++n)this._destroyDatasetMeta(n)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:n,ctx:a}=this;this._stop(),this.config.clearCache(),n&&(this.unbindEvents(),w2(n,a),this.platform.releaseContext(a),this.canvas=null,this.ctx=null),delete fp[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...n){return this.canvas.toDataURL(...n)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const n=this._listeners,a=this.platform,o=(e,m)=>{a.addEventListener(this,e,m),n[e]=m},s=(e,m,v)=>{e.offsetX=m,e.offsetY=v,this._eventHandler(e)};wr(this.options.events,e=>o(e,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const n=this._responsiveListeners,a=this.platform,o=(w,N)=>{a.addEventListener(this,w,N),n[w]=N},s=(w,N)=>{n[w]&&(a.removeEventListener(this,w,N),delete n[w])},e=(w,N)=>{this.canvas&&this.resize(w,N)};let m;const v=()=>{s("attach",v),this.attached=!0,this.resize(),o("resize",e),o("detach",m)};m=()=>{this.attached=!1,s("resize",e),this._stop(),this._resize(0,0),o("attach",v)},a.isAttached(this.canvas)?v():m()}unbindEvents(){wr(this._listeners,(n,a)=>{this.platform.removeEventListener(this,a,n)}),this._listeners={},wr(this._responsiveListeners,(n,a)=>{this.platform.removeEventListener(this,a,n)}),this._responsiveListeners=void 0}updateHoverStyle(n,a,o){const s=o?"set":"remove";let e,m,v,w;for(a==="dataset"&&(e=this.getDatasetMeta(n[0].datasetIndex),e.controller["_"+s+"DatasetHoverStyle"]()),v=0,w=n.length;v<w;++v){m=n[v];const N=m&&this.getDatasetMeta(m.datasetIndex).controller;N&&N[s+"HoverStyle"](m.element,m.datasetIndex,m.index)}}getActiveElements(){return this._active||[]}setActiveElements(n){const a=this._active||[],o=n.map(({datasetIndex:e,index:m})=>{const v=this.getDatasetMeta(e);if(!v)throw new Error("No dataset found at index "+e);return{datasetIndex:e,element:v.data[m],index:m}});!bp(o,a)&&(this._active=o,this._lastEvent=null,this._updateHoverStyles(o,a))}notifyPlugins(n,a,o){return this._plugins.notify(this,n,a,o)}isPluginEnabled(n){return this._plugins._cache.filter(a=>a.plugin.id===n).length===1}_updateHoverStyles(n,a,o){const s=this.options.hover,e=(w,N)=>w.filter(S=>!N.some(D=>S.datasetIndex===D.datasetIndex&&S.index===D.index)),m=e(a,n),v=o?n:e(n,a);m.length&&this.updateHoverStyle(m,s.mode,!1),v.length&&s.mode&&this.updateHoverStyle(v,s.mode,!0)}_eventHandler(n,a){const o={event:n,replay:a,cancelable:!0,inChartArea:this.isPointInArea(n)},s=m=>(m.options.events||this.options.events).includes(n.native.type);if(this.notifyPlugins("beforeEvent",o,s)===!1)return;const e=this._handleEvent(n,a,o.inChartArea);return o.cancelable=!1,this.notifyPlugins("afterEvent",o,s),(e||o.changed)&&this.render(),this}_handleEvent(n,a,o){const{_active:s=[],options:e}=this,m=a,v=this._getActiveElements(n,s,o,m),w=T3(n),N=_N(n,this._lastEvent,o,w);o&&(this._lastEvent=null,Wr(e.onHover,[n,v,this],this),w&&Wr(e.onClick,[n,v,this],this));const S=!bp(v,s);return(S||a)&&(this._active=v,this._updateHoverStyles(v,s,a)),this._lastEvent=N,S}_getActiveElements(n,a,o,s){if(n.type==="mouseout")return[];if(!o)return a;const e=this.options.hover;return this.getElementsAtEventForMode(n,e.mode,e,s)}};function sb(){return wr(cl.instances,l=>l._plugins.invalidate())}function FN(l,n,a){const{startAngle:o,x:s,y:e,outerRadius:m,innerRadius:v,options:w}=n,{borderWidth:N,borderJoinStyle:S}=w,D=Math.min(N/m,li(o-a));if(l.beginPath(),l.arc(s,e,m-N/2,o+D/2,a-D/2),v>0){const L=Math.min(N/v,li(o-a));l.arc(s,e,v+N/2,a-L/2,o+L/2,!0)}else{const L=Math.min(N/2,m*li(o-a));if(S==="round")l.arc(s,e,L,a-pr/2,o+pr/2,!0);else if(S==="bevel"){const M=2*L*L,F=-M*Math.cos(a+pr/2)+s,O=-M*Math.sin(a+pr/2)+e,P=M*Math.cos(o+pr/2)+s,K=M*Math.sin(o+pr/2)+e;l.lineTo(F,O),l.lineTo(P,K)}}l.closePath(),l.moveTo(0,0),l.rect(0,0,l.canvas.width,l.canvas.height),l.clip("evenodd")}function MN(l,n,a){const{startAngle:o,pixelMargin:s,x:e,y:m,outerRadius:v,innerRadius:w}=n;let N=s/v;l.beginPath(),l.arc(e,m,v,o-N,a+N),w>s?(N=s/w,l.arc(e,m,w,a+N,o-N,!0)):l.arc(e,m,s,a+Ta,o-Ta),l.closePath(),l.clip()}function LN(l){return yx(l,["outerStart","outerEnd","innerStart","innerEnd"])}function RN(l,n,a,o){const s=LN(l.options.borderRadius),e=(a-n)/2,m=Math.min(e,o*n/2),v=w=>{const N=(a-Math.min(e,w))*o/2;return un(w,0,Math.min(e,N))};return{outerStart:v(s.outerStart),outerEnd:v(s.outerEnd),innerStart:un(s.innerStart,0,m),innerEnd:un(s.innerEnd,0,m)}}function Wu(l,n,a,o){return{x:a+l*Math.cos(n),y:o+l*Math.sin(n)}}function kp(l,n,a,o,s,e){const{x:m,y:v,startAngle:w,pixelMargin:N,innerRadius:S}=n,D=Math.max(n.outerRadius+o+a-N,0),L=S>0?S+o+a+N:0;let M=0;const F=s-w;if(o){const ke=S>0?S-o:0,fe=D>0?D-o:0,Se=(ke+fe)/2,Ye=Se!==0?F*Se/(Se+o):F;M=(F-Ye)/2}const O=Math.max(.001,F*D-a/pr)/D,P=(F-O)/2,K=w+P+M,ne=s-P-M,{outerStart:se,outerEnd:Ce,innerStart:ge,innerEnd:Ne}=RN(n,L,D,ne-K),J=D-se,de=D-Ce,le=K+se/J,ze=ne-Ce/de,me=L+ge,oe=L+Ne,ce=K+ge/me,ye=ne-Ne/oe;if(l.beginPath(),e){const ke=(le+ze)/2;if(l.arc(m,v,D,le,ke),l.arc(m,v,D,ke,ze),Ce>0){const te=Wu(de,ze,m,v);l.arc(te.x,te.y,Ce,ze,ne+Ta)}const fe=Wu(oe,ne,m,v);if(l.lineTo(fe.x,fe.y),Ne>0){const te=Wu(oe,ye,m,v);l.arc(te.x,te.y,Ne,ne+Ta,ye+Math.PI)}const Se=(ne-Ne/L+(K+ge/L))/2;if(l.arc(m,v,L,ne-Ne/L,Se,!0),l.arc(m,v,L,Se,K+ge/L,!0),ge>0){const te=Wu(me,ce,m,v);l.arc(te.x,te.y,ge,ce+Math.PI,K-Ta)}const Ye=Wu(J,K,m,v);if(l.lineTo(Ye.x,Ye.y),se>0){const te=Wu(J,le,m,v);l.arc(te.x,te.y,se,K-Ta,le)}}else{l.moveTo(m,v);const ke=Math.cos(le)*D+m,fe=Math.sin(le)*D+v;l.lineTo(ke,fe);const Se=Math.cos(ze)*D+m,Ye=Math.sin(ze)*D+v;l.lineTo(Se,Ye)}l.closePath()}function ON(l,n,a,o,s){const{fullCircles:e,startAngle:m,circumference:v}=n;let w=n.endAngle;if(e){kp(l,n,a,o,w,s);for(let N=0;N<e;++N)l.fill();isNaN(v)||(w=m+(v%Zr||Zr))}return kp(l,n,a,o,w,s),l.fill(),w}function PN(l,n,a,o,s){const{fullCircles:e,startAngle:m,circumference:v,options:w}=n,{borderWidth:N,borderJoinStyle:S,borderDash:D,borderDashOffset:L,borderRadius:M}=w,F=w.borderAlign==="inner";if(!N)return;l.setLineDash(D||[]),l.lineDashOffset=L,F?(l.lineWidth=N*2,l.lineJoin=S||"round"):(l.lineWidth=N,l.lineJoin=S||"bevel");let O=n.endAngle;if(e){kp(l,n,a,o,O,s);for(let P=0;P<e;++P)l.stroke();isNaN(v)||(O=m+(v%Zr||Zr))}F&&MN(l,n,O),w.selfJoin&&O-m>=pr&&M===0&&S!=="miter"&&FN(l,n,O),e||(kp(l,n,a,o,O,s),l.stroke())}class ym extends Po{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:n=>n!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(n){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,a,o){const s=this.getProps(["x","y"],o),{angle:e,distance:m}=Ly(s,{x:n,y:a}),{startAngle:v,endAngle:w,innerRadius:N,outerRadius:S,circumference:D}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],o),L=(this.options.spacing+this.options.borderWidth)/2,M=Ts(D,w-v),F=om(e,v,w)&&v!==w,O=M>=Zr||F,P=Lo(m,N+L,S+L);return O&&P}getCenterPoint(n){const{x:a,y:o,startAngle:s,endAngle:e,innerRadius:m,outerRadius:v}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:w,spacing:N}=this.options,S=(s+e)/2,D=(m+v+N+w)/2;return{x:a+Math.cos(S)*D,y:o+Math.sin(S)*D}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:a,circumference:o}=this,s=(a.offset||0)/4,e=(a.spacing||0)/2,m=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=o>Zr?Math.floor(o/Zr):0,o===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const v=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(v)*s,Math.sin(v)*s);const w=1-Math.sin(Math.min(pr,o||0)),N=s*w;n.fillStyle=a.backgroundColor,n.strokeStyle=a.borderColor,ON(n,this,N,e,m),PN(n,this,N,e,m),n.restore()}}function gv(l,n,a=n){l.lineCap=Ts(a.borderCapStyle,n.borderCapStyle),l.setLineDash(Ts(a.borderDash,n.borderDash)),l.lineDashOffset=Ts(a.borderDashOffset,n.borderDashOffset),l.lineJoin=Ts(a.borderJoinStyle,n.borderJoinStyle),l.lineWidth=Ts(a.borderWidth,n.borderWidth),l.strokeStyle=Ts(a.borderColor,n.borderColor)}function IN(l,n,a){l.lineTo(a.x,a.y)}function BN(l){return l.stepped?tj:l.tension||l.cubicInterpolationMode==="monotone"?sj:IN}function pv(l,n,a={}){const o=l.length,{start:s=0,end:e=o-1}=a,{start:m,end:v}=n,w=Math.max(s,m),N=Math.min(e,v),S=s<m&&e<m||s>v&&e>v;return{count:o,start:w,loop:n.loop,ilen:N<w&&!S?o+N-w:N-w}}function zN(l,n,a,o){const{points:s,options:e}=n,{count:m,start:v,loop:w,ilen:N}=pv(s,a,o),S=BN(e);let{move:D=!0,reverse:L}=o||{},M,F,O;for(M=0;M<=N;++M)F=s[(v+(L?N-M:M))%m],!F.skip&&(D?(l.moveTo(F.x,F.y),D=!1):S(l,O,F,L,e.stepped),O=F);return w&&(F=s[(v+(L?N:0))%m],S(l,O,F,L,e.stepped)),!!w}function UN(l,n,a,o){const s=n.points,{count:e,start:m,ilen:v}=pv(s,a,o),{move:w=!0,reverse:N}=o||{};let S=0,D=0,L,M,F,O,P,K;const ne=Ce=>(m+(N?v-Ce:Ce))%e,se=()=>{O!==P&&(l.lineTo(S,P),l.lineTo(S,O),l.lineTo(S,K))};for(w&&(M=s[ne(0)],l.moveTo(M.x,M.y)),L=0;L<=v;++L){if(M=s[ne(L)],M.skip)continue;const Ce=M.x,ge=M.y,Ne=Ce|0;Ne===F?(ge<O?O=ge:ge>P&&(P=ge),S=(D*S+Ce)/++D):(se(),l.lineTo(Ce,ge),F=Ne,D=0,O=P=ge),K=ge}se()}function J1(l){const n=l.options,a=n.borderDash&&n.borderDash.length;return!l._decimated&&!l._loop&&!n.tension&&n.cubicInterpolationMode!=="monotone"&&!n.stepped&&!a?UN:zN}function HN(l){return l.stepped?Lj:l.tension||l.cubicInterpolationMode==="monotone"?Rj:Xd}function VN(l,n,a,o){let s=n._path;s||(s=n._path=new Path2D,n.path(s,a,o)&&s.closePath()),gv(l,n.options),l.stroke(s)}function WN(l,n,a,o){const{segments:s,options:e}=n,m=J1(n);for(const v of s)gv(l,e,v.style),l.beginPath(),m(l,n,v,{start:a,end:a+o-1})&&l.closePath(),l.stroke()}const $N=typeof Path2D=="function";function qN(l,n,a,o){$N&&!n.options.segment?VN(l,n,a,o):WN(l,n,a,o)}class dl extends Po{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:n=>n!=="borderDash"&&n!=="fill"};constructor(n){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,n&&Object.assign(this,n)}updateControlPoints(n,a){const o=this.options;if((o.tension||o.cubicInterpolationMode==="monotone")&&!o.stepped&&!this._pointsUpdated){const s=o.spanGaps?this._loop:this._fullLoop;Sj(this._points,o,n,s,a),this._pointsUpdated=!0}}set points(n){this._points=n,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Uj(this,this.options.segment))}first(){const n=this.segments,a=this.points;return n.length&&a[n[0].start]}last(){const n=this.segments,a=this.points,o=n.length;return o&&a[n[o-1].end]}interpolate(n,a){const o=this.options,s=n[a],e=this.points,m=ev(this,{property:a,start:s,end:s});if(!m.length)return;const v=[],w=HN(o);let N,S;for(N=0,S=m.length;N<S;++N){const{start:D,end:L}=m[N],M=e[D],F=e[L];if(M===F){v.push(M);continue}const O=Math.abs((s-M[a])/(F[a]-M[a])),P=w(M,F,O,o.stepped);P[a]=n[a],v.push(P)}return v.length===1?v[0]:v}pathSegment(n,a,o){return J1(this)(n,this,a,o)}path(n,a,o){const s=this.segments,e=J1(this);let m=this._loop;a=a||0,o=o||this.points.length-a;for(const v of s)m&=e(n,this,v,{start:a,end:a+o-1});return!!m}draw(n,a,o,s){const e=this.options||{};(this.points||[]).length&&e.borderWidth&&(n.save(),qN(n,this,o,s),n.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function rb(l,n,a,o){const s=l.options,{[a]:e}=l.getProps([a],o);return Math.abs(n-e)<s.radius+s.hitRadius}class Ic extends Po{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(n){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,a,o){const s=this.options,{x:e,y:m}=this.getProps(["x","y"],o);return Math.pow(n-e,2)+Math.pow(a-m,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(n,a){return rb(this,n,"x",a)}inYRange(n,a){return rb(this,n,"y",a)}getCenterPoint(n){const{x:a,y:o}=this.getProps(["x","y"],n);return{x:a,y:o}}size(n){n=n||this.options||{};let a=n.radius||0;a=Math.max(a,a&&n.hoverRadius||0);const o=a&&n.borderWidth||0;return(a+o)*2}draw(n,a){const o=this.options;this.skip||o.radius<.1||!cm(this,a,this.size(o)/2)||(n.strokeStyle=o.borderColor,n.lineWidth=o.borderWidth,n.fillStyle=o.backgroundColor,K1(n,o,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}function xv(l,n){const{x:a,y:o,base:s,width:e,height:m}=l.getProps(["x","y","base","width","height"],n);let v,w,N,S,D;return l.horizontal?(D=m/2,v=Math.min(a,s),w=Math.max(a,s),N=o-D,S=o+D):(D=e/2,v=a-D,w=a+D,N=Math.min(o,s),S=Math.max(o,s)),{left:v,top:N,right:w,bottom:S}}function Mc(l,n,a,o){return l?0:un(n,a,o)}function YN(l,n,a){const o=l.options.borderWidth,s=l.borderSkipped,e=Vy(o);return{t:Mc(s.top,e.top,0,a),r:Mc(s.right,e.right,0,n),b:Mc(s.bottom,e.bottom,0,a),l:Mc(s.left,e.left,0,n)}}function GN(l,n,a){const{enableBorderRadius:o}=l.getProps(["enableBorderRadius"]),s=l.options.borderRadius,e=Yu(s),m=Math.min(n,a),v=l.borderSkipped,w=o||Qs(s);return{topLeft:Mc(!w||v.top||v.left,e.topLeft,0,m),topRight:Mc(!w||v.top||v.right,e.topRight,0,m),bottomLeft:Mc(!w||v.bottom||v.left,e.bottomLeft,0,m),bottomRight:Mc(!w||v.bottom||v.right,e.bottomRight,0,m)}}function KN(l){const n=xv(l),a=n.right-n.left,o=n.bottom-n.top,s=YN(l,a/2,o/2),e=GN(l,a/2,o/2);return{outer:{x:n.left,y:n.top,w:a,h:o,radius:e},inner:{x:n.left+s.l,y:n.top+s.t,w:a-s.l-s.r,h:o-s.t-s.b,radius:{topLeft:Math.max(0,e.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,e.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,e.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,e.bottomRight-Math.max(s.b,s.r))}}}}function A1(l,n,a,o){const s=n===null,e=a===null,v=l&&!(s&&e)&&xv(l,o);return v&&(s||Lo(n,v.left,v.right))&&(e||Lo(a,v.top,v.bottom))}function QN(l){return l.topLeft||l.topRight||l.bottomLeft||l.bottomRight}function XN(l,n){l.rect(n.x,n.y,n.w,n.h)}function E1(l,n,a={}){const o=l.x!==a.x?-n:0,s=l.y!==a.y?-n:0,e=(l.x+l.w!==a.x+a.w?n:0)-o,m=(l.y+l.h!==a.y+a.h?n:0)-s;return{x:l.x+o,y:l.y+s,w:l.w+e,h:l.h+m,radius:l.radius}}class Bc extends Po{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(n){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,n&&Object.assign(this,n)}draw(n){const{inflateAmount:a,options:{borderColor:o,backgroundColor:s}}=this,{inner:e,outer:m}=KN(this),v=QN(m.radius)?wp:XN;n.save(),(m.w!==e.w||m.h!==e.h)&&(n.beginPath(),v(n,E1(m,a,e)),n.clip(),v(n,E1(e,-a,m)),n.fillStyle=o,n.fill("evenodd")),n.beginPath(),v(n,E1(e,a)),n.fillStyle=s,n.fill(),n.restore()}inRange(n,a,o){return A1(this,n,a,o)}inXRange(n,a){return A1(this,n,null,a)}inYRange(n,a){return A1(this,null,n,a)}getCenterPoint(n){const{x:a,y:o,base:s,horizontal:e}=this.getProps(["x","y","base","horizontal"],n);return{x:e?(a+s)/2:a,y:e?o:(o+s)/2}}getRange(n){return n==="x"?this.width/2:this.height/2}}function JN(l,n,a){const o=l.segments,s=l.points,e=n.points,m=[];for(const v of o){let{start:w,end:N}=v;N=Pp(w,N,s);const S=Z1(a,s[w],s[N],v.loop);if(!n.segments){m.push({source:v,target:S,start:s[w],end:s[N]});continue}const D=ev(n,S);for(const L of D){const M=Z1(a,e[L.start],e[L.end],L.loop),F=Zy(v,s,M);for(const O of F)m.push({source:O,target:L,start:{[a]:ab(S,M,"start",Math.max)},end:{[a]:ab(S,M,"end",Math.min)}})}}return m}function Z1(l,n,a,o){if(o)return;let s=n[l],e=a[l];return l==="angle"&&(s=li(s),e=li(e)),{property:l,start:s,end:e}}function ZN(l,n){const{x:a=null,y:o=null}=l||{},s=n.points,e=[];return n.segments.forEach(({start:m,end:v})=>{v=Pp(m,v,s);const w=s[m],N=s[v];o!==null?(e.push({x:w.x,y:o}),e.push({x:N.x,y:o})):a!==null&&(e.push({x:a,y:w.y}),e.push({x:a,y:N.y}))}),e}function Pp(l,n,a){for(;n>l;n--){const o=a[n];if(!isNaN(o.x)&&!isNaN(o.y))break}return n}function ab(l,n,a,o){return l&&n?o(l[a],n[a]):l?l[a]:n?n[a]:0}function bv(l,n){let a=[],o=!1;return Na(l)?(o=!0,a=l):a=ZN(l,n),a.length?new dl({points:a,options:{tension:0},_loop:o,_fullLoop:o}):null}function nb(l){return l&&l.fill!==!1}function ek(l,n,a){let s=l[n].fill;const e=[n];let m;if(!a)return s;for(;s!==!1&&e.indexOf(s)===-1;){if(!fn(s))return s;if(m=l[s],!m)return!1;if(m.visible)return s;e.push(s),s=m.fill}return!1}function tk(l,n,a){const o=nk(l);if(Qs(o))return isNaN(o.value)?!1:o;let s=parseFloat(o);return fn(s)&&Math.floor(s)===s?sk(o[0],n,s,a):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}function sk(l,n,a,o){return(l==="-"||l==="+")&&(a=n+a),a===n||a<0||a>=o?!1:a}function rk(l,n){let a=null;return l==="start"?a=n.bottom:l==="end"?a=n.top:Qs(l)?a=n.getPixelForValue(l.value):n.getBasePixel&&(a=n.getBasePixel()),a}function ak(l,n,a){let o;return l==="start"?o=a:l==="end"?o=n.options.reverse?n.min:n.max:Qs(l)?o=l.value:o=n.getBaseValue(),o}function nk(l){const n=l.options,a=n.fill;let o=Ts(a&&a.target,a);return o===void 0&&(o=!!n.backgroundColor),o===!1||o===null?!1:o===!0?"origin":o}function ik(l){const{scale:n,index:a,line:o}=l,s=[],e=o.segments,m=o.points,v=lk(n,a);v.push(bv({x:null,y:n.bottom},o));for(let w=0;w<e.length;w++){const N=e[w];for(let S=N.start;S<=N.end;S++)ok(s,m[S],v)}return new dl({points:s,options:{}})}function lk(l,n){const a=[],o=l.getMatchingVisibleMetas("line");for(let s=0;s<o.length;s++){const e=o[s];if(e.index===n)break;e.hidden||a.unshift(e.dataset)}return a}function ok(l,n,a){const o=[];for(let s=0;s<a.length;s++){const e=a[s],{first:m,last:v,point:w}=ck(e,n,"x");if(!(!w||m&&v)){if(m)o.unshift(w);else if(l.push(w),!v)break}}l.push(...o)}function ck(l,n,a){const o=l.interpolate(n,a);if(!o)return{};const s=o[a],e=l.segments,m=l.points;let v=!1,w=!1;for(let N=0;N<e.length;N++){const S=e[N],D=m[S.start][a],L=m[S.end][a];if(Lo(s,D,L)){v=s===D,w=s===L;break}}return{first:v,last:w,point:o}}class yv{constructor(n){this.x=n.x,this.y=n.y,this.radius=n.radius}pathSegment(n,a,o){const{x:s,y:e,radius:m}=this;return a=a||{start:0,end:Zr},n.arc(s,e,m,a.end,a.start,!0),!o.bounds}interpolate(n){const{x:a,y:o,radius:s}=this,e=n.angle;return{x:a+Math.cos(e)*s,y:o+Math.sin(e)*s,angle:e}}}function dk(l){const{chart:n,fill:a,line:o}=l;if(fn(a))return uk(n,a);if(a==="stack")return ik(l);if(a==="shape")return!0;const s=hk(l);return s instanceof yv?s:bv(s,o)}function uk(l,n){const a=l.getDatasetMeta(n);return a&&l.isDatasetVisible(n)?a.dataset:null}function hk(l){return(l.scale||{}).getPointPositionForValue?mk(l):fk(l)}function fk(l){const{scale:n={},fill:a}=l,o=rk(a,n);if(fn(o)){const s=n.isHorizontal();return{x:s?o:null,y:s?null:o}}return null}function mk(l){const{scale:n,fill:a}=l,o=n.options,s=n.getLabels().length,e=o.reverse?n.max:n.min,m=ak(a,n,e),v=[];if(o.grid.circular){const w=n.getPointPositionForValue(0,e);return new yv({x:w.x,y:w.y,radius:n.getDistanceFromCenterForValue(m)})}for(let w=0;w<s;++w)v.push(n.getPointPositionForValue(w,m));return v}function D1(l,n,a){const o=dk(n),{chart:s,index:e,line:m,scale:v,axis:w}=n,N=m.options,S=N.fill,D=N.backgroundColor,{above:L=D,below:M=D}=S||{},F=s.getDatasetMeta(e),O=tv(s,F);o&&m.points.length&&(Mp(l,a),gk(l,{line:m,target:o,above:L,below:M,area:a,scale:v,axis:w,clip:O}),Lp(l))}function gk(l,n){const{line:a,target:o,above:s,below:e,area:m,scale:v,clip:w}=n,N=a._loop?"angle":n.axis;l.save();let S=e;e!==s&&(N==="x"?(ib(l,o,m.top),T1(l,{line:a,target:o,color:s,scale:v,property:N,clip:w}),l.restore(),l.save(),ib(l,o,m.bottom)):N==="y"&&(lb(l,o,m.left),T1(l,{line:a,target:o,color:e,scale:v,property:N,clip:w}),l.restore(),l.save(),lb(l,o,m.right),S=s)),T1(l,{line:a,target:o,color:S,scale:v,property:N,clip:w}),l.restore()}function ib(l,n,a){const{segments:o,points:s}=n;let e=!0,m=!1;l.beginPath();for(const v of o){const{start:w,end:N}=v,S=s[w],D=s[Pp(w,N,s)];e?(l.moveTo(S.x,S.y),e=!1):(l.lineTo(S.x,a),l.lineTo(S.x,S.y)),m=!!n.pathSegment(l,v,{move:m}),m?l.closePath():l.lineTo(D.x,a)}l.lineTo(n.first().x,a),l.closePath(),l.clip()}function lb(l,n,a){const{segments:o,points:s}=n;let e=!0,m=!1;l.beginPath();for(const v of o){const{start:w,end:N}=v,S=s[w],D=s[Pp(w,N,s)];e?(l.moveTo(S.x,S.y),e=!1):(l.lineTo(a,S.y),l.lineTo(S.x,S.y)),m=!!n.pathSegment(l,v,{move:m}),m?l.closePath():l.lineTo(a,D.y)}l.lineTo(a,n.first().y),l.closePath(),l.clip()}function T1(l,n){const{line:a,target:o,property:s,color:e,scale:m,clip:v}=n,w=JN(a,o,s);for(const{source:N,target:S,start:D,end:L}of w){const{style:{backgroundColor:M=e}={}}=N,F=o!==!0;l.save(),l.fillStyle=M,pk(l,m,v,F&&Z1(s,D,L)),l.beginPath();const O=!!a.pathSegment(l,N);let P;if(F){O?l.closePath():ob(l,o,L,s);const K=!!o.pathSegment(l,S,{move:O,reverse:!0});P=O&&K,P||ob(l,o,D,s)}l.closePath(),l.fill(P?"evenodd":"nonzero"),l.restore()}}function pk(l,n,a,o){const s=n.chart.chartArea,{property:e,start:m,end:v}=o||{};if(e==="x"||e==="y"){let w,N,S,D;e==="x"?(w=m,N=s.top,S=v,D=s.bottom):(w=s.left,N=m,S=s.right,D=v),l.beginPath(),a&&(w=Math.max(w,a.left),S=Math.min(S,a.right),N=Math.max(N,a.top),D=Math.min(D,a.bottom)),l.rect(w,N,S-w,D-N),l.clip()}}function ob(l,n,a,o){const s=n.interpolate(a,o);s&&l.lineTo(s.x,s.y)}var Ip={id:"filler",afterDatasetsUpdate(l,n,a){const o=(l.data.datasets||[]).length,s=[];let e,m,v,w;for(m=0;m<o;++m)e=l.getDatasetMeta(m),v=e.dataset,w=null,v&&v.options&&v instanceof dl&&(w={visible:l.isDatasetVisible(m),index:m,fill:tk(v,m,o),chart:l,axis:e.controller.options.indexAxis,scale:e.vScale,line:v}),e.$filler=w,s.push(w);for(m=0;m<o;++m)w=s[m],!(!w||w.fill===!1)&&(w.fill=ek(s,m,a.propagate))},beforeDraw(l,n,a){const o=a.drawTime==="beforeDraw",s=l.getSortedVisibleDatasetMetas(),e=l.chartArea;for(let m=s.length-1;m>=0;--m){const v=s[m].$filler;v&&(v.line.updateControlPoints(e,v.axis),o&&v.fill&&D1(l.ctx,v,e))}},beforeDatasetsDraw(l,n,a){if(a.drawTime!=="beforeDatasetsDraw")return;const o=l.getSortedVisibleDatasetMetas();for(let s=o.length-1;s>=0;--s){const e=o[s].$filler;nb(e)&&D1(l.ctx,e,l.chartArea)}},beforeDatasetDraw(l,n,a){const o=n.meta.$filler;!nb(o)||a.drawTime!=="beforeDatasetDraw"||D1(l.ctx,o,l.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const cb=(l,n)=>{let{boxHeight:a=n,boxWidth:o=n}=l;return l.usePointStyle&&(a=Math.min(a,n),o=l.pointStyleWidth||Math.min(o,n)),{boxWidth:o,boxHeight:a,itemHeight:Math.max(n,a)}},xk=(l,n)=>l!==null&&n!==null&&l.datasetIndex===n.datasetIndex&&l.index===n.index;class db extends Po{constructor(n){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,a,o){this.maxWidth=n,this.maxHeight=a,this._margins=o,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const n=this.options.labels||{};let a=Wr(n.generateLabels,[this.chart],this)||[];n.filter&&(a=a.filter(o=>n.filter(o,this.chart.data))),n.sort&&(a=a.sort((o,s)=>n.sort(o,s,this.chart.data))),this.options.reverse&&a.reverse(),this.legendItems=a}fit(){const{options:n,ctx:a}=this;if(!n.display){this.width=this.height=0;return}const o=n.labels,s=hn(o.font),e=s.size,m=this._computeTitleHeight(),{boxWidth:v,itemHeight:w}=cb(o,e);let N,S;a.font=s.string,this.isHorizontal()?(N=this.maxWidth,S=this._fitRows(m,e,v,w)+10):(S=this.maxHeight,N=this._fitCols(m,s,v,w)+10),this.width=Math.min(N,n.maxWidth||this.maxWidth),this.height=Math.min(S,n.maxHeight||this.maxHeight)}_fitRows(n,a,o,s){const{ctx:e,maxWidth:m,options:{labels:{padding:v}}}=this,w=this.legendHitBoxes=[],N=this.lineWidths=[0],S=s+v;let D=n;e.textAlign="left",e.textBaseline="middle";let L=-1,M=-S;return this.legendItems.forEach((F,O)=>{const P=o+a/2+e.measureText(F.text).width;(O===0||N[N.length-1]+P+2*v>m)&&(D+=S,N[N.length-(O>0?0:1)]=0,M+=S,L++),w[O]={left:0,top:M,row:L,width:P,height:s},N[N.length-1]+=P+v}),D}_fitCols(n,a,o,s){const{ctx:e,maxHeight:m,options:{labels:{padding:v}}}=this,w=this.legendHitBoxes=[],N=this.columnSizes=[],S=m-n;let D=v,L=0,M=0,F=0,O=0;return this.legendItems.forEach((P,K)=>{const{itemWidth:ne,itemHeight:se}=bk(o,a,e,P,s);K>0&&M+se+2*v>S&&(D+=L+v,N.push({width:L,height:M}),F+=L+v,O++,L=M=0),w[K]={left:F,top:M,col:O,width:ne,height:se},L=Math.max(L,ne),M+=se+v}),D+=L,N.push({width:L,height:M}),D}adjustHitBoxes(){if(!this.options.display)return;const n=this._computeTitleHeight(),{legendHitBoxes:a,options:{align:o,labels:{padding:s},rtl:e}}=this,m=Gu(e,this.left,this.width);if(this.isHorizontal()){let v=0,w=cn(o,this.left+s,this.right-this.lineWidths[v]);for(const N of a)v!==N.row&&(v=N.row,w=cn(o,this.left+s,this.right-this.lineWidths[v])),N.top+=this.top+n+s,N.left=m.leftForLtr(m.x(w),N.width),w+=N.width+s}else{let v=0,w=cn(o,this.top+n+s,this.bottom-this.columnSizes[v].height);for(const N of a)N.col!==v&&(v=N.col,w=cn(o,this.top+n+s,this.bottom-this.columnSizes[v].height)),N.top=w,N.left+=this.left+s,N.left=m.leftForLtr(m.x(N.left),N.width),w+=N.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const n=this.ctx;Mp(n,this),this._draw(),Lp(n)}}_draw(){const{options:n,columnSizes:a,lineWidths:o,ctx:s}=this,{align:e,labels:m}=n,v=fa.color,w=Gu(n.rtl,this.left,this.width),N=hn(m.font),{padding:S}=m,D=N.size,L=D/2;let M;this.drawTitle(),s.textAlign=w.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=N.string;const{boxWidth:F,boxHeight:O,itemHeight:P}=cb(m,D),K=function(Ne,J,de){if(isNaN(F)||F<=0||isNaN(O)||O<0)return;s.save();const le=Ts(de.lineWidth,1);if(s.fillStyle=Ts(de.fillStyle,v),s.lineCap=Ts(de.lineCap,"butt"),s.lineDashOffset=Ts(de.lineDashOffset,0),s.lineJoin=Ts(de.lineJoin,"miter"),s.lineWidth=le,s.strokeStyle=Ts(de.strokeStyle,v),s.setLineDash(Ts(de.lineDash,[])),m.usePointStyle){const ze={radius:O*Math.SQRT2/2,pointStyle:de.pointStyle,rotation:de.rotation,borderWidth:le},me=w.xPlus(Ne,F/2),oe=J+L;Hy(s,ze,me,oe,m.pointStyleWidth&&F)}else{const ze=J+Math.max((D-O)/2,0),me=w.leftForLtr(Ne,F),oe=Yu(de.borderRadius);s.beginPath(),Object.values(oe).some(ce=>ce!==0)?wp(s,{x:me,y:ze,w:F,h:O,radius:oe}):s.rect(me,ze,F,O),s.fill(),le!==0&&s.stroke()}s.restore()},ne=function(Ne,J,de){dm(s,de.text,Ne,J+P/2,N,{strikethrough:de.hidden,textAlign:w.textAlign(de.textAlign)})},se=this.isHorizontal(),Ce=this._computeTitleHeight();se?M={x:cn(e,this.left+S,this.right-o[0]),y:this.top+S+Ce,line:0}:M={x:this.left+S,y:cn(e,this.top+Ce+S,this.bottom-a[0].height),line:0},Qy(this.ctx,n.textDirection);const ge=P+S;this.legendItems.forEach((Ne,J)=>{s.strokeStyle=Ne.fontColor,s.fillStyle=Ne.fontColor;const de=s.measureText(Ne.text).width,le=w.textAlign(Ne.textAlign||(Ne.textAlign=m.textAlign)),ze=F+L+de;let me=M.x,oe=M.y;w.setWidth(this.width),se?J>0&&me+ze+S>this.right&&(oe=M.y+=ge,M.line++,me=M.x=cn(e,this.left+S,this.right-o[M.line])):J>0&&oe+ge>this.bottom&&(me=M.x=me+a[M.line].width+S,M.line++,oe=M.y=cn(e,this.top+Ce+S,this.bottom-a[M.line].height));const ce=w.x(me);if(K(ce,oe,Ne),me=W3(le,me+F+L,se?me+ze:this.right,n.rtl),ne(w.x(me),oe,Ne),se)M.x+=ze+S;else if(typeof Ne.text!="string"){const ye=N.lineHeight;M.y+=vv(Ne,ye)+S}else M.y+=ge}),Xy(this.ctx,n.textDirection)}drawTitle(){const n=this.options,a=n.title,o=hn(a.font),s=_i(a.padding);if(!a.display)return;const e=Gu(n.rtl,this.left,this.width),m=this.ctx,v=a.position,w=o.size/2,N=s.top+w;let S,D=this.left,L=this.width;if(this.isHorizontal())L=Math.max(...this.lineWidths),S=this.top+N,D=cn(n.align,D,this.right-L);else{const F=this.columnSizes.reduce((O,P)=>Math.max(O,P.height),0);S=N+cn(n.align,this.top,this.bottom-F-n.labels.padding-this._computeTitleHeight())}const M=cn(v,D,D+L);m.textAlign=e.textAlign(xx(v)),m.textBaseline="middle",m.strokeStyle=a.color,m.fillStyle=a.color,m.font=o.string,dm(m,a.text,M,S,o)}_computeTitleHeight(){const n=this.options.title,a=hn(n.font),o=_i(n.padding);return n.display?a.lineHeight+o.height:0}_getLegendItemAt(n,a){let o,s,e;if(Lo(n,this.left,this.right)&&Lo(a,this.top,this.bottom)){for(e=this.legendHitBoxes,o=0;o<e.length;++o)if(s=e[o],Lo(n,s.left,s.left+s.width)&&Lo(a,s.top,s.top+s.height))return this.legendItems[o]}return null}handleEvent(n){const a=this.options;if(!wk(n.type,a))return;const o=this._getLegendItemAt(n.x,n.y);if(n.type==="mousemove"||n.type==="mouseout"){const s=this._hoveredItem,e=xk(s,o);s&&!e&&Wr(a.onLeave,[n,s,this],this),this._hoveredItem=o,o&&!e&&Wr(a.onHover,[n,o,this],this)}else o&&Wr(a.onClick,[n,o,this],this)}}function bk(l,n,a,o,s){const e=yk(o,l,n,a),m=vk(s,o,n.lineHeight);return{itemWidth:e,itemHeight:m}}function yk(l,n,a,o){let s=l.text;return s&&typeof s!="string"&&(s=s.reduce((e,m)=>e.length>m.length?e:m)),n+a.size/2+o.measureText(s).width}function vk(l,n,a){let o=l;return typeof n.text!="string"&&(o=vv(n,a)),o}function vv(l,n){const a=l.text?l.text.length:0;return n*a}function wk(l,n){return!!((l==="mousemove"||l==="mouseout")&&(n.onHover||n.onLeave)||n.onClick&&(l==="click"||l==="mouseup"))}var zc={id:"legend",_element:db,start(l,n,a){const o=l.legend=new db({ctx:l.ctx,options:a,chart:l});Ti.configure(l,o,a),Ti.addBox(l,o)},stop(l){Ti.removeBox(l,l.legend),delete l.legend},beforeUpdate(l,n,a){const o=l.legend;Ti.configure(l,o,a),o.options=a},afterUpdate(l){const n=l.legend;n.buildLabels(),n.adjustHitBoxes()},afterEvent(l,n){n.replay||l.legend.handleEvent(n.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(l,n,a){const o=n.datasetIndex,s=a.chart;s.isDatasetVisible(o)?(s.hide(o),n.hidden=!0):(s.show(o),n.hidden=!1)},onHover:null,onLeave:null,labels:{color:l=>l.chart.options.color,boxWidth:40,padding:10,generateLabels(l){const n=l.data.datasets,{labels:{usePointStyle:a,pointStyle:o,textAlign:s,color:e,useBorderRadius:m,borderRadius:v}}=l.legend.options;return l._getSortedDatasetMetas().map(w=>{const N=w.controller.getStyle(a?0:void 0),S=_i(N.borderWidth);return{text:n[w.index].label,fillStyle:N.backgroundColor,fontColor:e,hidden:!w.visible,lineCap:N.borderCapStyle,lineDash:N.borderDash,lineDashOffset:N.borderDashOffset,lineJoin:N.borderJoinStyle,lineWidth:(S.width+S.height)/4,strokeStyle:N.borderColor,pointStyle:o||N.pointStyle,rotation:N.rotation,textAlign:s||N.textAlign,borderRadius:m&&(v||N.borderRadius),datasetIndex:w.index}},this)}},title:{color:l=>l.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:l=>!l.startsWith("on"),labels:{_scriptable:l=>!["generateLabels","filter","sort"].includes(l)}}};class wv extends Po{constructor(n){super(),this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,a){const o=this.options;if(this.left=0,this.top=0,!o.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=n,this.height=this.bottom=a;const s=Na(o.text)?o.text.length:1;this._padding=_i(o.padding);const e=s*hn(o.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=e:this.width=e}isHorizontal(){const n=this.options.position;return n==="top"||n==="bottom"}_drawArgs(n){const{top:a,left:o,bottom:s,right:e,options:m}=this,v=m.align;let w=0,N,S,D;return this.isHorizontal()?(S=cn(v,o,e),D=a+n,N=e-o):(m.position==="left"?(S=o+n,D=cn(v,s,a),w=pr*-.5):(S=e-n,D=cn(v,a,s),w=pr*.5),N=s-a),{titleX:S,titleY:D,maxWidth:N,rotation:w}}draw(){const n=this.ctx,a=this.options;if(!a.display)return;const o=hn(a.font),e=o.lineHeight/2+this._padding.top,{titleX:m,titleY:v,maxWidth:w,rotation:N}=this._drawArgs(e);dm(n,a.text,0,0,o,{color:a.color,maxWidth:w,rotation:N,textAlign:xx(a.align),textBaseline:"middle",translation:[m,v]})}}function jk(l,n){const a=new wv({ctx:l.ctx,options:n,chart:l});Ti.configure(l,a,n),Ti.addBox(l,a),l.titleBlock=a}var Uc={id:"title",_element:wv,start(l,n,a){jk(l,a)},stop(l){const n=l.titleBlock;Ti.removeBox(l,n),delete l.titleBlock},beforeUpdate(l,n,a){const o=l.titleBlock;Ti.configure(l,o,a),o.options=a},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Zf={average(l){if(!l.length)return!1;let n,a,o=new Set,s=0,e=0;for(n=0,a=l.length;n<a;++n){const v=l[n].element;if(v&&v.hasValue()){const w=v.tooltipPosition();o.add(w.x),s+=w.y,++e}}return e===0||o.size===0?!1:{x:[...o].reduce((v,w)=>v+w)/o.size,y:s/e}},nearest(l,n){if(!l.length)return!1;let a=n.x,o=n.y,s=Number.POSITIVE_INFINITY,e,m,v;for(e=0,m=l.length;e<m;++e){const w=l[e].element;if(w&&w.hasValue()){const N=w.getCenterPoint(),S=Y1(n,N);S<s&&(s=S,v=w)}}if(v){const w=v.tooltipPosition();a=w.x,o=w.y}return{x:a,y:o}}};function Pl(l,n){return n&&(Na(n)?Array.prototype.push.apply(l,n):l.push(n)),l}function _o(l){return(typeof l=="string"||l instanceof String)&&l.indexOf(`
`)>-1?l.split(`
`):l}function Nk(l,n){const{element:a,datasetIndex:o,index:s}=n,e=l.getDatasetMeta(o).controller,{label:m,value:v}=e.getLabelAndValue(s);return{chart:l,label:m,parsed:e.getParsed(s),raw:l.data.datasets[o].data[s],formattedValue:v,dataset:e.getDataset(),dataIndex:s,datasetIndex:o,element:a}}function ub(l,n){const a=l.chart.ctx,{body:o,footer:s,title:e}=l,{boxWidth:m,boxHeight:v}=n,w=hn(n.bodyFont),N=hn(n.titleFont),S=hn(n.footerFont),D=e.length,L=s.length,M=o.length,F=_i(n.padding);let O=F.height,P=0,K=o.reduce((Ce,ge)=>Ce+ge.before.length+ge.lines.length+ge.after.length,0);if(K+=l.beforeBody.length+l.afterBody.length,D&&(O+=D*N.lineHeight+(D-1)*n.titleSpacing+n.titleMarginBottom),K){const Ce=n.displayColors?Math.max(v,w.lineHeight):w.lineHeight;O+=M*Ce+(K-M)*w.lineHeight+(K-1)*n.bodySpacing}L&&(O+=n.footerMarginTop+L*S.lineHeight+(L-1)*n.footerSpacing);let ne=0;const se=function(Ce){P=Math.max(P,a.measureText(Ce).width+ne)};return a.save(),a.font=N.string,wr(l.title,se),a.font=w.string,wr(l.beforeBody.concat(l.afterBody),se),ne=n.displayColors?m+2+n.boxPadding:0,wr(o,Ce=>{wr(Ce.before,se),wr(Ce.lines,se),wr(Ce.after,se)}),ne=0,a.font=S.string,wr(l.footer,se),a.restore(),P+=F.width,{width:P,height:O}}function kk(l,n){const{y:a,height:o}=n;return a<o/2?"top":a>l.height-o/2?"bottom":"center"}function Ck(l,n,a,o){const{x:s,width:e}=o,m=a.caretSize+a.caretPadding;if(l==="left"&&s+e+m>n.width||l==="right"&&s-e-m<0)return!0}function Sk(l,n,a,o){const{x:s,width:e}=a,{width:m,chartArea:{left:v,right:w}}=l;let N="center";return o==="center"?N=s<=(v+w)/2?"left":"right":s<=e/2?N="left":s>=m-e/2&&(N="right"),Ck(N,l,n,a)&&(N="center"),N}function hb(l,n,a){const o=a.yAlign||n.yAlign||kk(l,a);return{xAlign:a.xAlign||n.xAlign||Sk(l,n,a,o),yAlign:o}}function Ak(l,n){let{x:a,width:o}=l;return n==="right"?a-=o:n==="center"&&(a-=o/2),a}function Ek(l,n,a){let{y:o,height:s}=l;return n==="top"?o+=a:n==="bottom"?o-=s+a:o-=s/2,o}function fb(l,n,a,o){const{caretSize:s,caretPadding:e,cornerRadius:m}=l,{xAlign:v,yAlign:w}=a,N=s+e,{topLeft:S,topRight:D,bottomLeft:L,bottomRight:M}=Yu(m);let F=Ak(n,v);const O=Ek(n,w,N);return w==="center"?v==="left"?F+=N:v==="right"&&(F-=N):v==="left"?F-=Math.max(S,L)+s:v==="right"&&(F+=Math.max(D,M)+s),{x:un(F,0,o.width-n.width),y:un(O,0,o.height-n.height)}}function tp(l,n,a){const o=_i(a.padding);return n==="center"?l.x+l.width/2:n==="right"?l.x+l.width-o.right:l.x+o.left}function mb(l){return Pl([],_o(l))}function Dk(l,n,a){return l0(l,{tooltip:n,tooltipItems:a,type:"tooltip"})}function gb(l,n){const a=n&&n.dataset&&n.dataset.tooltip&&n.dataset.tooltip.callbacks;return a?l.override(a):l}const jv={beforeTitle:Ao,title(l){if(l.length>0){const n=l[0],a=n.chart.data.labels,o=a?a.length:0;if(this&&this.options&&this.options.mode==="dataset")return n.dataset.label||"";if(n.label)return n.label;if(o>0&&n.dataIndex<o)return a[n.dataIndex]}return""},afterTitle:Ao,beforeBody:Ao,beforeLabel:Ao,label(l){if(this&&this.options&&this.options.mode==="dataset")return l.label+": "+l.formattedValue||l.formattedValue;let n=l.dataset.label||"";n&&(n+=": ");const a=l.formattedValue;return ur(a)||(n+=a),n},labelColor(l){const a=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{borderColor:a.borderColor,backgroundColor:a.backgroundColor,borderWidth:a.borderWidth,borderDash:a.borderDash,borderDashOffset:a.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(l){const a=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{pointStyle:a.pointStyle,rotation:a.rotation}},afterLabel:Ao,afterBody:Ao,beforeFooter:Ao,footer:Ao,afterFooter:Ao};function Hn(l,n,a,o){const s=l[n].call(a,o);return typeof s>"u"?jv[n].call(a,o):s}class pb extends Po{static positioners=Zf;constructor(n){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=n.chart,this.options=n.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(n){this.options=n,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const n=this._cachedAnimations;if(n)return n;const a=this.chart,o=this.options.setContext(this.getContext()),s=o.enabled&&a.options.animation&&o.animations,e=new sv(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(e)),e}getContext(){return this.$context||(this.$context=Dk(this.chart.getContext(),this,this._tooltipItems))}getTitle(n,a){const{callbacks:o}=a,s=Hn(o,"beforeTitle",this,n),e=Hn(o,"title",this,n),m=Hn(o,"afterTitle",this,n);let v=[];return v=Pl(v,_o(s)),v=Pl(v,_o(e)),v=Pl(v,_o(m)),v}getBeforeBody(n,a){return mb(Hn(a.callbacks,"beforeBody",this,n))}getBody(n,a){const{callbacks:o}=a,s=[];return wr(n,e=>{const m={before:[],lines:[],after:[]},v=gb(o,e);Pl(m.before,_o(Hn(v,"beforeLabel",this,e))),Pl(m.lines,Hn(v,"label",this,e)),Pl(m.after,_o(Hn(v,"afterLabel",this,e))),s.push(m)}),s}getAfterBody(n,a){return mb(Hn(a.callbacks,"afterBody",this,n))}getFooter(n,a){const{callbacks:o}=a,s=Hn(o,"beforeFooter",this,n),e=Hn(o,"footer",this,n),m=Hn(o,"afterFooter",this,n);let v=[];return v=Pl(v,_o(s)),v=Pl(v,_o(e)),v=Pl(v,_o(m)),v}_createItems(n){const a=this._active,o=this.chart.data,s=[],e=[],m=[];let v=[],w,N;for(w=0,N=a.length;w<N;++w)v.push(Nk(this.chart,a[w]));return n.filter&&(v=v.filter((S,D,L)=>n.filter(S,D,L,o))),n.itemSort&&(v=v.sort((S,D)=>n.itemSort(S,D,o))),wr(v,S=>{const D=gb(n.callbacks,S);s.push(Hn(D,"labelColor",this,S)),e.push(Hn(D,"labelPointStyle",this,S)),m.push(Hn(D,"labelTextColor",this,S))}),this.labelColors=s,this.labelPointStyles=e,this.labelTextColors=m,this.dataPoints=v,v}update(n,a){const o=this.options.setContext(this.getContext()),s=this._active;let e,m=[];if(!s.length)this.opacity!==0&&(e={opacity:0});else{const v=Zf[o.position].call(this,s,this._eventPosition);m=this._createItems(o),this.title=this.getTitle(m,o),this.beforeBody=this.getBeforeBody(m,o),this.body=this.getBody(m,o),this.afterBody=this.getAfterBody(m,o),this.footer=this.getFooter(m,o);const w=this._size=ub(this,o),N=Object.assign({},v,w),S=hb(this.chart,o,N),D=fb(o,N,S,this.chart);this.xAlign=S.xAlign,this.yAlign=S.yAlign,e={opacity:1,x:D.x,y:D.y,width:w.width,height:w.height,caretX:v.x,caretY:v.y}}this._tooltipItems=m,this.$context=void 0,e&&this._resolveAnimations().update(this,e),n&&o.external&&o.external.call(this,{chart:this.chart,tooltip:this,replay:a})}drawCaret(n,a,o,s){const e=this.getCaretPosition(n,o,s);a.lineTo(e.x1,e.y1),a.lineTo(e.x2,e.y2),a.lineTo(e.x3,e.y3)}getCaretPosition(n,a,o){const{xAlign:s,yAlign:e}=this,{caretSize:m,cornerRadius:v}=o,{topLeft:w,topRight:N,bottomLeft:S,bottomRight:D}=Yu(v),{x:L,y:M}=n,{width:F,height:O}=a;let P,K,ne,se,Ce,ge;return e==="center"?(Ce=M+O/2,s==="left"?(P=L,K=P-m,se=Ce+m,ge=Ce-m):(P=L+F,K=P+m,se=Ce-m,ge=Ce+m),ne=P):(s==="left"?K=L+Math.max(w,S)+m:s==="right"?K=L+F-Math.max(N,D)-m:K=this.caretX,e==="top"?(se=M,Ce=se-m,P=K-m,ne=K+m):(se=M+O,Ce=se+m,P=K+m,ne=K-m),ge=se),{x1:P,x2:K,x3:ne,y1:se,y2:Ce,y3:ge}}drawTitle(n,a,o){const s=this.title,e=s.length;let m,v,w;if(e){const N=Gu(o.rtl,this.x,this.width);for(n.x=tp(this,o.titleAlign,o),a.textAlign=N.textAlign(o.titleAlign),a.textBaseline="middle",m=hn(o.titleFont),v=o.titleSpacing,a.fillStyle=o.titleColor,a.font=m.string,w=0;w<e;++w)a.fillText(s[w],N.x(n.x),n.y+m.lineHeight/2),n.y+=m.lineHeight+v,w+1===e&&(n.y+=o.titleMarginBottom-v)}}_drawColorBox(n,a,o,s,e){const m=this.labelColors[o],v=this.labelPointStyles[o],{boxHeight:w,boxWidth:N}=e,S=hn(e.bodyFont),D=tp(this,"left",e),L=s.x(D),M=w<S.lineHeight?(S.lineHeight-w)/2:0,F=a.y+M;if(e.usePointStyle){const O={radius:Math.min(N,w)/2,pointStyle:v.pointStyle,rotation:v.rotation,borderWidth:1},P=s.leftForLtr(L,N)+N/2,K=F+w/2;n.strokeStyle=e.multiKeyBackground,n.fillStyle=e.multiKeyBackground,K1(n,O,P,K),n.strokeStyle=m.borderColor,n.fillStyle=m.backgroundColor,K1(n,O,P,K)}else{n.lineWidth=Qs(m.borderWidth)?Math.max(...Object.values(m.borderWidth)):m.borderWidth||1,n.strokeStyle=m.borderColor,n.setLineDash(m.borderDash||[]),n.lineDashOffset=m.borderDashOffset||0;const O=s.leftForLtr(L,N),P=s.leftForLtr(s.xPlus(L,1),N-2),K=Yu(m.borderRadius);Object.values(K).some(ne=>ne!==0)?(n.beginPath(),n.fillStyle=e.multiKeyBackground,wp(n,{x:O,y:F,w:N,h:w,radius:K}),n.fill(),n.stroke(),n.fillStyle=m.backgroundColor,n.beginPath(),wp(n,{x:P,y:F+1,w:N-2,h:w-2,radius:K}),n.fill()):(n.fillStyle=e.multiKeyBackground,n.fillRect(O,F,N,w),n.strokeRect(O,F,N,w),n.fillStyle=m.backgroundColor,n.fillRect(P,F+1,N-2,w-2))}n.fillStyle=this.labelTextColors[o]}drawBody(n,a,o){const{body:s}=this,{bodySpacing:e,bodyAlign:m,displayColors:v,boxHeight:w,boxWidth:N,boxPadding:S}=o,D=hn(o.bodyFont);let L=D.lineHeight,M=0;const F=Gu(o.rtl,this.x,this.width),O=function(de){a.fillText(de,F.x(n.x+M),n.y+L/2),n.y+=L+e},P=F.textAlign(m);let K,ne,se,Ce,ge,Ne,J;for(a.textAlign=m,a.textBaseline="middle",a.font=D.string,n.x=tp(this,P,o),a.fillStyle=o.bodyColor,wr(this.beforeBody,O),M=v&&P!=="right"?m==="center"?N/2+S:N+2+S:0,Ce=0,Ne=s.length;Ce<Ne;++Ce){for(K=s[Ce],ne=this.labelTextColors[Ce],a.fillStyle=ne,wr(K.before,O),se=K.lines,v&&se.length&&(this._drawColorBox(a,n,Ce,F,o),L=Math.max(D.lineHeight,w)),ge=0,J=se.length;ge<J;++ge)O(se[ge]),L=D.lineHeight;wr(K.after,O)}M=0,L=D.lineHeight,wr(this.afterBody,O),n.y-=e}drawFooter(n,a,o){const s=this.footer,e=s.length;let m,v;if(e){const w=Gu(o.rtl,this.x,this.width);for(n.x=tp(this,o.footerAlign,o),n.y+=o.footerMarginTop,a.textAlign=w.textAlign(o.footerAlign),a.textBaseline="middle",m=hn(o.footerFont),a.fillStyle=o.footerColor,a.font=m.string,v=0;v<e;++v)a.fillText(s[v],w.x(n.x),n.y+m.lineHeight/2),n.y+=m.lineHeight+o.footerSpacing}}drawBackground(n,a,o,s){const{xAlign:e,yAlign:m}=this,{x:v,y:w}=n,{width:N,height:S}=o,{topLeft:D,topRight:L,bottomLeft:M,bottomRight:F}=Yu(s.cornerRadius);a.fillStyle=s.backgroundColor,a.strokeStyle=s.borderColor,a.lineWidth=s.borderWidth,a.beginPath(),a.moveTo(v+D,w),m==="top"&&this.drawCaret(n,a,o,s),a.lineTo(v+N-L,w),a.quadraticCurveTo(v+N,w,v+N,w+L),m==="center"&&e==="right"&&this.drawCaret(n,a,o,s),a.lineTo(v+N,w+S-F),a.quadraticCurveTo(v+N,w+S,v+N-F,w+S),m==="bottom"&&this.drawCaret(n,a,o,s),a.lineTo(v+M,w+S),a.quadraticCurveTo(v,w+S,v,w+S-M),m==="center"&&e==="left"&&this.drawCaret(n,a,o,s),a.lineTo(v,w+D),a.quadraticCurveTo(v,w,v+D,w),a.closePath(),a.fill(),s.borderWidth>0&&a.stroke()}_updateAnimationTarget(n){const a=this.chart,o=this.$animations,s=o&&o.x,e=o&&o.y;if(s||e){const m=Zf[n.position].call(this,this._active,this._eventPosition);if(!m)return;const v=this._size=ub(this,n),w=Object.assign({},m,this._size),N=hb(a,n,w),S=fb(n,w,N,a);(s._to!==S.x||e._to!==S.y)&&(this.xAlign=N.xAlign,this.yAlign=N.yAlign,this.width=v.width,this.height=v.height,this.caretX=m.x,this.caretY=m.y,this._resolveAnimations().update(this,S))}}_willRender(){return!!this.opacity}draw(n){const a=this.options.setContext(this.getContext());let o=this.opacity;if(!o)return;this._updateAnimationTarget(a);const s={width:this.width,height:this.height},e={x:this.x,y:this.y};o=Math.abs(o)<.001?0:o;const m=_i(a.padding),v=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;a.enabled&&v&&(n.save(),n.globalAlpha=o,this.drawBackground(e,n,s,a),Qy(n,a.textDirection),e.y+=m.top,this.drawTitle(e,n,a),this.drawBody(e,n,a),this.drawFooter(e,n,a),Xy(n,a.textDirection),n.restore())}getActiveElements(){return this._active||[]}setActiveElements(n,a){const o=this._active,s=n.map(({datasetIndex:v,index:w})=>{const N=this.chart.getDatasetMeta(v);if(!N)throw new Error("Cannot find a dataset at index "+v);return{datasetIndex:v,element:N.data[w],index:w}}),e=!bp(o,s),m=this._positionChanged(s,a);(e||m)&&(this._active=s,this._eventPosition=a,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(n,a,o=!0){if(a&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,e=this._active||[],m=this._getActiveElements(n,e,a,o),v=this._positionChanged(m,n),w=a||!bp(m,e)||v;return w&&(this._active=m,(s.enabled||s.external)&&(this._eventPosition={x:n.x,y:n.y},this.update(!0,a))),w}_getActiveElements(n,a,o,s){const e=this.options;if(n.type==="mouseout")return[];if(!s)return a.filter(v=>this.chart.data.datasets[v.datasetIndex]&&this.chart.getDatasetMeta(v.datasetIndex).controller.getParsed(v.index)!==void 0);const m=this.chart.getElementsAtEventForMode(n,e.mode,e,o);return e.reverse&&m.reverse(),m}_positionChanged(n,a){const{caretX:o,caretY:s,options:e}=this,m=Zf[e.position].call(this,n,a);return m!==!1&&(o!==m.x||s!==m.y)}}var Hc={id:"tooltip",_element:pb,positioners:Zf,afterInit(l,n,a){a&&(l.tooltip=new pb({chart:l,options:a}))},beforeUpdate(l,n,a){l.tooltip&&l.tooltip.initialize(a)},reset(l,n,a){l.tooltip&&l.tooltip.initialize(a)},afterDraw(l){const n=l.tooltip;if(n&&n._willRender()){const a={tooltip:n};if(l.notifyPlugins("beforeTooltipDraw",{...a,cancelable:!0})===!1)return;n.draw(l.ctx),l.notifyPlugins("afterTooltipDraw",a)}},afterEvent(l,n){if(l.tooltip){const a=n.replay;l.tooltip.handleEvent(n.event,a,n.inChartArea)&&(n.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(l,n)=>n.bodyFont.size,boxWidth:(l,n)=>n.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:jv},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:l=>l!=="filter"&&l!=="itemSort"&&l!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Tk=(l,n,a,o)=>(typeof n=="string"?(a=l.push(n)-1,o.unshift({index:a,label:n})):isNaN(n)&&(a=null),a);function _k(l,n,a,o){const s=l.indexOf(n);if(s===-1)return Tk(l,n,a,o);const e=l.lastIndexOf(n);return s!==e?a:s}const Fk=(l,n)=>l===null?null:un(Math.round(l),0,n);function xb(l){const n=this.getLabels();return l>=0&&l<n.length?n[l]:l}class Vc extends ah{static id="category";static defaults={ticks:{callback:xb}};constructor(n){super(n),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(n){const a=this._addedLabels;if(a.length){const o=this.getLabels();for(const{index:s,label:e}of a)o[s]===e&&o.splice(s,1);this._addedLabels=[]}super.init(n)}parse(n,a){if(ur(n))return null;const o=this.getLabels();return a=isFinite(a)&&o[a]===n?a:_k(o,n,Ts(a,n),this._addedLabels),Fk(a,o.length-1)}determineDataLimits(){const{minDefined:n,maxDefined:a}=this.getUserBounds();let{min:o,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(n||(o=0),a||(s=this.getLabels().length-1)),this.min=o,this.max=s}buildTicks(){const n=this.min,a=this.max,o=this.options.offset,s=[];let e=this.getLabels();e=n===0&&a===e.length-1?e:e.slice(n,a+1),this._valueRange=Math.max(e.length-(o?0:1),1),this._startValue=this.min-(o?.5:0);for(let m=n;m<=a;m++)s.push({value:m});return s}getLabelForValue(n){return xb.call(this,n)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(n){return typeof n!="number"&&(n=this.parse(n)),n===null?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getPixelForTick(n){const a=this.ticks;return n<0||n>a.length-1?null:this.getPixelForValue(a[n].value)}getValueForPixel(n){return Math.round(this._startValue+this.getDecimalForPixel(n)*this._valueRange)}getBasePixel(){return this.bottom}}function Mk(l,n){const a=[],{bounds:s,step:e,min:m,max:v,precision:w,count:N,maxTicks:S,maxDigits:D,includeBounds:L}=l,M=e||1,F=S-1,{min:O,max:P}=n,K=!ur(m),ne=!ur(v),se=!ur(N),Ce=(P-O)/(D+1);let ge=f2((P-O)/F/M)*M,Ne,J,de,le;if(ge<1e-14&&!K&&!ne)return[{value:O},{value:P}];le=Math.ceil(P/ge)-Math.floor(O/ge),le>F&&(ge=f2(le*ge/F/M)*M),ur(w)||(Ne=Math.pow(10,w),ge=Math.ceil(ge*Ne)/Ne),s==="ticks"?(J=Math.floor(O/ge)*ge,de=Math.ceil(P/ge)*ge):(J=O,de=P),K&&ne&&e&&R3((v-m)/e,ge/1e3)?(le=Math.round(Math.min((v-m)/ge,S)),ge=(v-m)/le,J=m,de=v):se?(J=K?m:J,de=ne?v:de,le=N-1,ge=(de-J)/le):(le=(de-J)/ge,tm(le,Math.round(le),ge/1e3)?le=Math.round(le):le=Math.ceil(le));const ze=Math.max(m2(ge),m2(J));Ne=Math.pow(10,ur(w)?ze:w),J=Math.round(J*Ne)/Ne,de=Math.round(de*Ne)/Ne;let me=0;for(K&&(L&&J!==m?(a.push({value:m}),J<m&&me++,tm(Math.round((J+me*ge)*Ne)/Ne,m,bb(m,Ce,l))&&me++):J<m&&me++);me<le;++me){const oe=Math.round((J+me*ge)*Ne)/Ne;if(ne&&oe>v)break;a.push({value:oe})}return ne&&L&&de!==v?a.length&&tm(a[a.length-1].value,v,bb(v,Ce,l))?a[a.length-1].value=v:a.push({value:v}):(!ne||de===v)&&a.push({value:de}),a}function bb(l,n,{horizontal:a,minRotation:o}){const s=Bl(o),e=(a?Math.sin(s):Math.cos(s))||.001,m=.75*n*(""+l).length;return Math.min(n/e,m)}class Lk extends ah{constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(n,a){return ur(n)||(typeof n=="number"||n instanceof Number)&&!isFinite(+n)?null:+n}handleTickRangeOptions(){const{beginAtZero:n}=this.options,{minDefined:a,maxDefined:o}=this.getUserBounds();let{min:s,max:e}=this;const m=w=>s=a?s:w,v=w=>e=o?e:w;if(n){const w=zl(s),N=zl(e);w<0&&N<0?v(0):w>0&&N>0&&m(0)}if(s===e){let w=e===0?1:Math.abs(e*.05);v(e+w),n||m(s-w)}this.min=s,this.max=e}getTickLimit(){const n=this.options.ticks;let{maxTicksLimit:a,stepSize:o}=n,s;return o?(s=Math.ceil(this.max/o)-Math.floor(this.min/o)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${o} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),a=a||11),a&&(s=Math.min(a,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const n=this.options,a=n.ticks;let o=this.getTickLimit();o=Math.max(2,o);const s={maxTicks:o,bounds:n.bounds,min:n.min,max:n.max,precision:a.precision,step:a.stepSize,count:a.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:a.minRotation||0,includeBounds:a.includeBounds!==!1},e=this._range||this,m=Mk(s,e);return n.bounds==="ticks"&&O3(m,this,"value"),n.reverse?(m.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),m}configure(){const n=this.ticks;let a=this.min,o=this.max;if(super.configure(),this.options.offset&&n.length){const s=(o-a)/Math.max(n.length-1,1)/2;a-=s,o+=s}this._startValue=a,this._endValue=o,this._valueRange=o-a}getLabelForValue(n){return Fp(n,this.chart.options.locale,this.options.ticks.format)}}class Wc extends Lk{static id="linear";static defaults={ticks:{callback:Uy.formatters.numeric}};determineDataLimits(){const{min:n,max:a}=this.getMinMax(!0);this.min=fn(n)?n:0,this.max=fn(a)?a:1,this.handleTickRangeOptions()}computeTickLimit(){const n=this.isHorizontal(),a=n?this.width:this.height,o=Bl(this.options.ticks.minRotation),s=(n?Math.sin(o):Math.cos(o))||.001,e=this._resolveTickFontOptions(0);return Math.ceil(a/Math.min(40,e.lineHeight/s))}getPixelForValue(n){return n===null?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getValueForPixel(n){return this._startValue+this.getDecimalForPixel(n)*this._valueRange}}const Bp={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Wn=Object.keys(Bp);function yb(l,n){return l-n}function vb(l,n){if(ur(n))return null;const a=l._adapter,{parser:o,round:s,isoWeekday:e}=l._parseOpts;let m=n;return typeof o=="function"&&(m=o(m)),fn(m)||(m=typeof o=="string"?a.parse(m,o):a.parse(m)),m===null?null:(s&&(m=s==="week"&&(Qu(e)||e===!0)?a.startOf(m,"isoWeek",e):a.startOf(m,s)),+m)}function wb(l,n,a,o){const s=Wn.length;for(let e=Wn.indexOf(l);e<s-1;++e){const m=Bp[Wn[e]],v=m.steps?m.steps:Number.MAX_SAFE_INTEGER;if(m.common&&Math.ceil((a-n)/(v*m.size))<=o)return Wn[e]}return Wn[s-1]}function Rk(l,n,a,o,s){for(let e=Wn.length-1;e>=Wn.indexOf(a);e--){const m=Wn[e];if(Bp[m].common&&l._adapter.diff(s,o,m)>=n-1)return m}return Wn[a?Wn.indexOf(a):0]}function Ok(l){for(let n=Wn.indexOf(l)+1,a=Wn.length;n<a;++n)if(Bp[Wn[n]].common)return Wn[n]}function jb(l,n,a){if(!a)l[n]=!0;else if(a.length){const{lo:o,hi:s}=px(a,n),e=a[o]>=n?a[o]:a[s];l[e]=!0}}function Pk(l,n,a,o){const s=l._adapter,e=+s.startOf(n[0].value,o),m=n[n.length-1].value;let v,w;for(v=e;v<=m;v=+s.add(v,1,o))w=a[v],w>=0&&(n[w].major=!0);return n}function Nb(l,n,a){const o=[],s={},e=n.length;let m,v;for(m=0;m<e;++m)v=n[m],s[v]=m,o.push({value:v,major:!1});return e===0||!a?o:Pk(l,o,s,a)}class kb extends ah{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(n){super(n),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(n,a={}){const o=n.time||(n.time={}),s=this._adapter=new N6._date(n.adapters.date);s.init(a),em(o.displayFormats,s.formats()),this._parseOpts={parser:o.parser,round:o.round,isoWeekday:o.isoWeekday},super.init(n),this._normalized=a.normalized}parse(n,a){return n===void 0?null:vb(this,n)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const n=this.options,a=this._adapter,o=n.time.unit||"day";let{min:s,max:e,minDefined:m,maxDefined:v}=this.getUserBounds();function w(N){!m&&!isNaN(N.min)&&(s=Math.min(s,N.min)),!v&&!isNaN(N.max)&&(e=Math.max(e,N.max))}(!m||!v)&&(w(this._getLabelBounds()),(n.bounds!=="ticks"||n.ticks.source!=="labels")&&w(this.getMinMax(!1))),s=fn(s)&&!isNaN(s)?s:+a.startOf(Date.now(),o),e=fn(e)&&!isNaN(e)?e:+a.endOf(Date.now(),o)+1,this.min=Math.min(s,e-1),this.max=Math.max(s+1,e)}_getLabelBounds(){const n=this.getLabelTimestamps();let a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return n.length&&(a=n[0],o=n[n.length-1]),{min:a,max:o}}buildTicks(){const n=this.options,a=n.time,o=n.ticks,s=o.source==="labels"?this.getLabelTimestamps():this._generate();n.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const e=this.min,m=this.max,v=U3(s,e,m);return this._unit=a.unit||(o.autoSkip?wb(a.minUnit,this.min,this.max,this._getLabelCapacity(e)):Rk(this,v.length,a.minUnit,this.min,this.max)),this._majorUnit=!o.major.enabled||this._unit==="year"?void 0:Ok(this._unit),this.initOffsets(s),n.reverse&&v.reverse(),Nb(this,v,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(n=>+n.value))}initOffsets(n=[]){let a=0,o=0,s,e;this.options.offset&&n.length&&(s=this.getDecimalForValue(n[0]),n.length===1?a=1-s:a=(this.getDecimalForValue(n[1])-s)/2,e=this.getDecimalForValue(n[n.length-1]),n.length===1?o=e:o=(e-this.getDecimalForValue(n[n.length-2]))/2);const m=n.length<3?.5:.25;a=un(a,0,m),o=un(o,0,m),this._offsets={start:a,end:o,factor:1/(a+1+o)}}_generate(){const n=this._adapter,a=this.min,o=this.max,s=this.options,e=s.time,m=e.unit||wb(e.minUnit,a,o,this._getLabelCapacity(a)),v=Ts(s.ticks.stepSize,1),w=m==="week"?e.isoWeekday:!1,N=Qu(w)||w===!0,S={};let D=a,L,M;if(N&&(D=+n.startOf(D,"isoWeek",w)),D=+n.startOf(D,N?"day":m),n.diff(o,a,m)>1e5*v)throw new Error(a+" and "+o+" are too far apart with stepSize of "+v+" "+m);const F=s.ticks.source==="data"&&this.getDataTimestamps();for(L=D,M=0;L<o;L=+n.add(L,v,m),M++)jb(S,L,F);return(L===o||s.bounds==="ticks"||M===1)&&jb(S,L,F),Object.keys(S).sort(yb).map(O=>+O)}getLabelForValue(n){const a=this._adapter,o=this.options.time;return o.tooltipFormat?a.format(n,o.tooltipFormat):a.format(n,o.displayFormats.datetime)}format(n,a){const s=this.options.time.displayFormats,e=this._unit,m=a||s[e];return this._adapter.format(n,m)}_tickFormatFunction(n,a,o,s){const e=this.options,m=e.ticks.callback;if(m)return Wr(m,[n,a,o],this);const v=e.time.displayFormats,w=this._unit,N=this._majorUnit,S=w&&v[w],D=N&&v[N],L=o[a],M=N&&D&&L&&L.major;return this._adapter.format(n,s||(M?D:S))}generateTickLabels(n){let a,o,s;for(a=0,o=n.length;a<o;++a)s=n[a],s.label=this._tickFormatFunction(s.value,a,n)}getDecimalForValue(n){return n===null?NaN:(n-this.min)/(this.max-this.min)}getPixelForValue(n){const a=this._offsets,o=this.getDecimalForValue(n);return this.getPixelForDecimal((a.start+o)*a.factor)}getValueForPixel(n){const a=this._offsets,o=this.getDecimalForPixel(n)/a.factor-a.end;return this.min+o*(this.max-this.min)}_getLabelSize(n){const a=this.options.ticks,o=this.ctx.measureText(n).width,s=Bl(this.isHorizontal()?a.maxRotation:a.minRotation),e=Math.cos(s),m=Math.sin(s),v=this._resolveTickFontOptions(0).size;return{w:o*e+v*m,h:o*m+v*e}}_getLabelCapacity(n){const a=this.options.time,o=a.displayFormats,s=o[a.unit]||o.millisecond,e=this._tickFormatFunction(n,0,Nb(this,[n],this._majorUnit),s),m=this._getLabelSize(e),v=Math.floor(this.isHorizontal()?this.width/m.w:this.height/m.h)-1;return v>0?v:1}getDataTimestamps(){let n=this._cache.data||[],a,o;if(n.length)return n;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(a=0,o=s.length;a<o;++a)n=n.concat(s[a].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const n=this._cache.labels||[];let a,o;if(n.length)return n;const s=this.getLabels();for(a=0,o=s.length;a<o;++a)n.push(vb(this,s[a]));return this._cache.labels=this._normalized?n:this.normalize(n)}normalize(n){return Oy(n.sort(yb))}}function sp(l,n,a){let o=0,s=l.length-1,e,m,v,w;a?(n>=l[o].pos&&n<=l[s].pos&&({lo:o,hi:s}=Zd(l,"pos",n)),{pos:e,time:v}=l[o],{pos:m,time:w}=l[s]):(n>=l[o].time&&n<=l[s].time&&({lo:o,hi:s}=Zd(l,"time",n)),{time:e,pos:v}=l[o],{time:m,pos:w}=l[s]);const N=m-e;return N?v+(w-v)*(n-e)/N:v}class o7 extends kb{static id="timeseries";static defaults=kb.defaults;constructor(n){super(n),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const n=this._getTimestampsForTable(),a=this._table=this.buildLookupTable(n);this._minPos=sp(a,this.min),this._tableRange=sp(a,this.max)-this._minPos,super.initOffsets(n)}buildLookupTable(n){const{min:a,max:o}=this,s=[],e=[];let m,v,w,N,S;for(m=0,v=n.length;m<v;++m)N=n[m],N>=a&&N<=o&&s.push(N);if(s.length<2)return[{time:a,pos:0},{time:o,pos:1}];for(m=0,v=s.length;m<v;++m)S=s[m+1],w=s[m-1],N=s[m],Math.round((S+w)/2)!==N&&e.push({time:N,pos:m/(v-1)});return e}_generate(){const n=this.min,a=this.max;let o=super.getDataTimestamps();return(!o.includes(n)||!o.length)&&o.splice(0,0,n),(!o.includes(a)||o.length===1)&&o.push(a),o.sort((s,e)=>s-e)}_getTimestampsForTable(){let n=this._cache.all||[];if(n.length)return n;const a=this.getDataTimestamps(),o=this.getLabelTimestamps();return a.length&&o.length?n=this.normalize(a.concat(o)):n=a.length?a:o,n=this._cache.all=n,n}getDecimalForValue(n){return(sp(this._table,n)-this._minPos)/this._tableRange}getValueForPixel(n){const a=this._offsets,o=this.getDecimalForPixel(n)/a.factor-a.end;return sp(this._table,o*this._tableRange+this._minPos,!0)}}const Ik=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),[]).then(l=>({default:l.Line}))),_1=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Bar}))),Bk=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Doughnut}))),zk=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Pie})));cl.register(Vc,Wc,Ic,dl,Bc,ym,Uc,Hc,zc);let F1=null,Cb=0;const Uk=60*1e3;function Hk(){const[l,n]=B.useState(null),[a,o]=B.useState(!0),[s,e]=B.useState("overview");Dr(),B.useEffect(()=>{let D=!0;const L=new AbortController,M=async(F=!0)=>{try{const O=Date.now();if(F&&F1&&O-Cb<Uk){D&&(n(F1),o(!1));return}o(!0);const P=await Ut.get("/dashboard/stats",{signal:L.signal,timeout:3e4,headers:{"Cache-Control":"max-age=300"}}),K=P.data?.data||P.data;D&&(n(K),F1=K,Cb=Date.now())}catch(O){!(O.name==="CanceledError"||O.message==="canceled"||O.code==="ERR_CANCELED"||O.config&&O.config.signal&&O.config.signal.aborted)&&D&&(console.error("Error fetching dashboard stats:",O),O.code==="ECONNABORTED"&&console.error("Request timeout - dashboard data is taking too long to load"))}finally{D&&o(!1)}};return M(!0),M(!1),()=>{D=!1,L.signal.aborted||L.abort()}},[]);const m=[{id:"overview",label:"Overview",icon:"grid"},{id:"industry",label:"Industry",icon:"building"},{id:"geography",label:"Geography",icon:"globe"},{id:"designation",label:"Designation & Persona",icon:"briefcase"},{id:"data-quality",label:"Data Quality",icon:"shield"},{id:"ownership",label:"Ownership & Team",icon:"users"}],v=B.useMemo(()=>{if(!l)return{overallScore:0,completeness:0,deduplication:100,freshness:0};const D=l.totalContacts||0,L=D>0?Math.round(((l.emailValidity?.valid||0)/D*.3+(l.outreachReady?.value||0)/D*.3+(l.enrichmentCoverage?.value||0)/D*.2+(1-(l.duplicateRecords?.value||0)/D)*.2)*100):0,M=D>0?Math.round((l.outreachReady?.value||0)/D*100):0,F=D>0?Math.round((1-(l.duplicateRecords?.value||0)/D)*100):100,O=l.enrichmentCoverage?.percent?Math.round(l.enrichmentCoverage.percent):0;return{overallScore:L,completeness:M,deduplication:F,freshness:O}},[l?.totalContacts,l?.emailValidity?.valid,l?.outreachReady?.value,l?.enrichmentCoverage?.value,l?.duplicateRecords?.value,l?.enrichmentCoverage?.percent]),w=B.useMemo(()=>{if(!l?.topIndustries||l.topIndustries.length===0)return null;const D=l.topIndustries.slice(0,5),L=D.reduce((K,ne)=>K+(ne.count||0),0),M=l.topIndustries.reduce((K,ne)=>K+(ne.count||0),0),F=M-L,O=D.map(K=>({label:K.name,value:K.count||0,percentage:M>0?Math.round((K.count||0)/M*100):0}));F>0&&O.push({label:"Others",value:F,percentage:Math.round(F/M*100)});const P=["rgb(59, 130, 246)","rgb(34, 197, 94)","rgb(249, 115, 22)","rgb(239, 68, 68)","rgb(168, 85, 247)","rgb(156, 163, 175)"];return{labels:O.map(K=>`${K.label}: ${K.percentage}%`),data:O.map(K=>K.value),colors:P.slice(0,O.length)}},[l?.topIndustries]),N=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2 mb-2"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]});if(a)return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-4 animate-pulse"}),t.jsx("div",{className:"h-10 bg-gray-200 rounded w-full animate-pulse"})]})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((D,L)=>t.jsx(N,{},L))})})]});if(!l)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"text-center",children:t.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data"})})});const S=B.memo(({title:D,value:L,trend:M,trendDirection:F,icon:O,subtitle:P,percent:K})=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:D}),t.jsx("div",{className:"flex items-baseline gap-2",children:t.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:[typeof L=="number"?L.toLocaleString():L,K&&t.jsxs("span",{className:"text-lg text-gray-500 ml-1",children:["(",K,"%)"]})]})}),P&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:P})]}),t.jsxs("div",{className:"text-gray-400",children:[O==="people"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),O==="building"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),O==="plus"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),O==="check"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),O==="sparkle"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),O==="clock"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),O==="envelope"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),O==="exclamation"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),O==="ban"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})}),O==="duplicate"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})]})]}),M&&t.jsxs("div",{className:`flex items-center gap-1 text-sm ${F==="up"?"text-green-600":"text-red-600"}`,children:[t.jsx("svg",{className:`w-4 h-4 ${F==="down"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),t.jsx("span",{children:M})]})]}));return B.memo(({type:D,title:L,description:M,action:F,actionLabel:O})=>{const P={success:{bg:"bg-green-50",border:"border-green-200",icon:"text-green-600",text:"text-green-800"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:"text-yellow-600",text:"text-yellow-800"},error:{bg:"bg-red-50",border:"border-red-200",icon:"text-red-600",text:"text-red-800"}},K=P[D]||P.success;return t.jsx("div",{className:`${K.bg} border ${K.border} rounded-lg p-6`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsxs("div",{className:`${K.icon} flex-shrink-0`,children:[D==="success"&&t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),D==="warning"&&t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),D==="error"&&t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:`font-semibold ${K.text} mb-2`,children:L}),t.jsx("p",{className:`text-sm ${K.text} mb-4`,children:M}),F&&t.jsxs("button",{onClick:F,className:"text-blue-600 hover:text-blue-800 font-medium text-sm flex items-center gap-1",children:[O,t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})})}),t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Monitor your contact and account data performance"})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:m.map(D=>t.jsxs("button",{onClick:()=>e(D.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${s===D.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[D.icon==="grid"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),D.icon==="building"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),D.icon==="globe"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 002 2h2.945M15 6.055V5a2 2 0 012-2h3.055M21 12.055V19a2 2 0 01-2 2h-3.055M9 3.055V5a2 2 0 012-2h2.945M9 20.945V19a2 2 0 012-2h2.945M21 3.055V5a2 2 0 00-2 2h-3.055M9 20.945V19a2 2 0 00-2-2H3.055"})}),D.icon==="briefcase"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),D.icon==="shield"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),D.icon==="users"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),D.label]},D.id))})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsx(S,{title:"Total Contacts",value:l.totalContacts?.value||0,trend:l.totalContacts?.trend,trendDirection:l.totalContacts?.trendDirection,icon:"people"}),t.jsx(S,{title:"Total Accounts",value:l.totalAccounts?.value||0,trend:l.totalAccounts?.trend,trendDirection:l.totalAccounts?.trendDirection,icon:"building"}),t.jsx(S,{title:"New Contacts",value:l.newContacts?.value||0,trend:l.newContacts?.trend,trendDirection:l.newContacts?.trendDirection,icon:"plus",subtitle:"This month"}),t.jsx(S,{title:"Outreach Ready",value:l.outreachReady?.value||0,percent:l.outreachReady?.percent,trend:l.outreachReady?.trend,trendDirection:l.outreachReady?.trendDirection,icon:"check"}),t.jsx(S,{title:"Enrichment Coverage",value:l.enrichmentCoverage?.percent||0,subtitle:`${l.enrichmentCoverage?.value||0} contacts enriched`,trend:l.enrichmentCoverage?.trend,trendDirection:l.enrichmentCoverage?.trendDirection,icon:"sparkle"}),t.jsx(S,{title:"Stale Enrichment",value:l.staleEnrichment?.value||0,subtitle:">90 days old",trend:l.staleEnrichment?.trend,trendDirection:l.staleEnrichment?.trendDirection,icon:"clock"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(S,{title:"Email Validity",value:l.emailValidity?.percent||0,subtitle:`${l.emailValidity?.valid||0} valid`,trend:l.emailValidity?.trend,trendDirection:l.emailValidity?.trendDirection,icon:"envelope"}),t.jsx(S,{title:"Missing Titles",value:l.missingTitles?.value||0,percent:l.missingTitles?.percent,trend:l.missingTitles?.trend,trendDirection:l.missingTitles?.trendDirection,icon:"exclamation"}),t.jsx(S,{title:"DNC Contacts",value:l.dncContacts?.value||0,percent:l.dncContacts?.percent,trend:l.dncContacts?.trend,trendDirection:l.dncContacts?.trendDirection,icon:"ban"}),t.jsx(S,{title:"Duplicate Records",value:l.duplicateRecords?.value||0,trend:l.duplicateRecords?.trend,trendDirection:l.duplicateRecords?.trendDirection,icon:"duplicate"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact & Account Growth"}),l.monthlyGrowth&&Array.isArray(l.monthlyGrowth)&&l.monthlyGrowth.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Ik,{data:{labels:l.monthlyGrowth.map(D=>D.month||""),datasets:[{label:"Contacts",data:l.monthlyGrowth.map(D=>D.contacts||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!1},{label:"Accounts",data:l.monthlyGrowth.map(D=>D.accounts||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,ticks:{precision:0}}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No growth data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Enrichment Status Distribution"}),l.enrichmentStatus?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Bk,{data:{labels:["Fully Enriched","Partially Enriched","Not Enriched"],datasets:[{data:[l.enrichmentStatus.fullyEnriched?.count||0,l.enrichmentStatus.partiallyEnriched?.count||0,l.enrichmentStatus.notEnriched?.count||0],backgroundColor:["rgb(34, 197, 94)","rgb(249, 115, 22)","rgb(239, 68, 68)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No enrichment data available"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Outreach Readiness Funnel"}),t.jsx("div",{className:"space-y-4",children:l.outreachFunnel&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Total Contacts"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.totalContacts?.toLocaleString()||0," (100%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-gray-400 h-2 rounded-full",style:{width:"100%"}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Has Email"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.hasEmail?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.hasEmail/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.hasEmail/l.outreachFunnel.totalContacts*100:0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Valid Email"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.validEmail?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.validEmail/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.validEmail/l.outreachFunnel.totalContacts*100:0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Has Title"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.hasTitle?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.hasTitle/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.hasTitle/l.outreachFunnel.totalContacts*100:0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Ready for Outreach"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.readyForOutreach?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.readyForOutreach/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.readyForOutreach/l.outreachFunnel.totalContacts*100:0}%`}})})]})]})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Segments"}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Industries"}),t.jsx("div",{className:"space-y-2",children:l.topIndustries&&l.topIndustries.length>0?l.topIndustries.map((D,L)=>t.jsxs("div",{className:"flex items-center justify-between py-1",children:[t.jsx("span",{className:"text-sm text-gray-600",children:D.name}),t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:D.count.toLocaleString()})]},L)):t.jsx("p",{className:"text-xs text-gray-500",children:"No industry data available"})})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top States"}),t.jsx("div",{className:"space-y-2",children:l.topStates&&l.topStates.length>0?l.topStates.map((D,L)=>t.jsxs("div",{className:"flex items-center justify-between py-1",children:[t.jsx("span",{className:"text-sm text-gray-600",children:D.name}),t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:D.count.toLocaleString()})]},L)):t.jsx("p",{className:"text-xs text-gray-500",children:"No geography data available"})})]})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Data Health Score"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:v.overallScore}),t.jsx("p",{className:"text-sm text-gray-600",children:"Overall Score"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:v.completeness}),t.jsx("p",{className:"text-sm text-gray-600",children:"Completeness"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:v.deduplication}),t.jsx("p",{className:"text-sm text-gray-600",children:"Deduplication"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:v.freshness}),t.jsx("p",{className:"text-sm text-gray-600",children:"Freshness"})]})]})]})]}),s==="industry"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Industry Distribution"}),l.topIndustries&&l.topIndustries.length>0?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(_1,{data:{labels:l.topIndustries.map(D=>D.name),datasets:[{label:"Contacts",data:l.topIndustries.map(D=>D.count||0),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0,ticks:{precision:0},grid:{color:"rgba(0, 0, 0, 0.05)",lineWidth:1}},y:{ticks:{maxRotation:45,minRotation:45},grid:{display:!1}}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No industry data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top 5 Industries by Contact Volume"}),w?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(zk,{data:{labels:w.labels,datasets:[{data:w.data,backgroundColor:w.colors,borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{usePointStyle:!0,padding:15,font:{size:12},generateLabels:function(D){const L=D.data;return L.labels.length&&L.datasets.length?L.labels.map((M,F)=>{L.datasets[0].data[F];const O=L.datasets[0].backgroundColor[F];return{text:M,fillStyle:O,hidden:!1,index:F}}):[]}}},tooltip:{callbacks:{label:function(D){const L=D.label||"",M=D.parsed||0;return`${L} - ${M.toLocaleString()} contacts`}}}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No industry data available"})})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Industry Insights"}),l.industryInsights?t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Fastest Growing"}),t.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:l.industryInsights.fastestGrowing?.industry||"N/A"}),t.jsx("p",{className:"text-sm font-semibold text-green-600",children:l.industryInsights.fastestGrowing?`+${l.industryInsights.fastestGrowing.growth.toFixed(0)}% this quarter`:"No data"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Highest Enrichment"}),t.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:l.industryInsights.highestEnrichment?.industry||"N/A"}),t.jsx("p",{className:"text-sm font-semibold text-green-600",children:l.industryInsights.highestEnrichment?`${l.industryInsights.highestEnrichment.enrichment.toFixed(0)}% enriched`:"No data"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Needs Attention"}),t.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:l.industryInsights.needsAttention?.industry||"N/A"}),t.jsx("p",{className:"text-sm font-semibold text-orange-600",children:l.industryInsights.needsAttention?`${l.industryInsights.needsAttention.enrichment.toFixed(0)}% enriched`:"No data"})]})]}):t.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No industry insights available"})]})]}),s==="geography"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Geographic Distribution"}),l.topStates&&l.topStates.length>0?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(_1,{data:{labels:l.topStates.map(D=>D.name),datasets:[{label:"Contacts",data:l.topStates.map(D=>D.count||0),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0,ticks:{precision:0,stepSize:750,font:{size:11},color:"#6B7280"},grid:{color:"rgba(0, 0, 0, 0.08)",lineWidth:1,borderDash:[5,5],drawBorder:!1}},y:{ticks:{font:{size:12},color:"#374151"},grid:{display:!1}}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No geographic data available"})})]})}),s==="data-quality"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Quality Metrics"}),l.dataQualityMetrics?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(_1,{data:{labels:["Email Valid","Phone Valid","Complete Profile","LinkedIn Connected","Recent Activity"],datasets:[{label:"Count",data:[l.dataQualityMetrics.emailValid||0,l.dataQualityMetrics.phoneValid||0,l.dataQualityMetrics.completeProfile||0,l.dataQualityMetrics.linkedinConnected||0,l.dataQualityMetrics.recentActivity||0],backgroundColor:"rgba(59, 130, 246, 0.8)"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No data quality metrics available"})})]})})]})]})}function Vk({category:l,searchParam:n,onApplyFilters:a,onClearFilters:o}){const[s]=i0(),[e,m]=B.useState(!1),v=B.useRef(null),w=s.get("filterKeywords")||"",N=s.get("filterCity")||"",S=s.get("filterState")||"",D=s.get("filterCountry")||"",L=s.get("filterHasLinkedIn")||"",M=s.get("filterHasEmail")||"",F=s.get("filterHasPhone")||"",[O,P]=B.useState({keywords:"",city:"",state:"",country:"",hasLinkedIn:"",hasEmail:"",hasPhone:""});B.useEffect(()=>{P({keywords:w,city:N,state:S,country:D,hasLinkedIn:L,hasEmail:M,hasPhone:F})},[w,N,S,D,L,M,F]),B.useEffect(()=>{const Ne=J=>{v.current&&!v.current.contains(J.target)&&m(!1)};return e&&document.addEventListener("mousedown",Ne),()=>{document.removeEventListener("mousedown",Ne)}},[e]);const K=(Ne,J)=>{const de=typeof J=="string"?J.trim():J;P(le=>({...le,[Ne]:de}))},ne=()=>!!(w||N||S||D||L||M||F),se=()=>{const Ne={keywords:O.keywords?.trim()||"",city:O.city?.trim()||"",state:O.state?.trim()||"",country:O.country?.trim()||"",hasLinkedIn:O.hasLinkedIn||"",hasEmail:O.hasEmail||"",hasPhone:O.hasPhone||""};a(Ne),m(!1)},Ce=()=>{P({keywords:"",city:"",state:"",country:"",hasLinkedIn:"",hasEmail:"",hasPhone:""}),o(),m(!1)},ge=()=>[w,N,S,D,L,M,F].filter(Ne=>Ne!==""&&Ne!==null&&Ne!==void 0).length;return t.jsxs("div",{className:"relative",ref:v,children:[t.jsxs("button",{onClick:()=>m(!e),className:`inline-flex items-center justify-center gap-2 px-5 py-3 rounded-lg transition-all duration-200 font-semibold text-sm shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 ${ne()?"bg-blue-50 border-2 border-blue-500 text-blue-700 hover:bg-blue-100":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400 active:bg-gray-100"}`,title:"Filter contacts",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Filter"}),ne()&&t.jsx("span",{className:"ml-1 px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full font-semibold",children:ge()})]}),e&&t.jsx("div",{className:"absolute right-0 mt-2 w-96 bg-white border border-gray-200 rounded-lg shadow-xl z-50 animate-fade-in-down",children:t.jsxs("div",{className:"p-5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),t.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Keyword",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(searches in keywords field)"})]}),t.jsx("input",{type:"text",value:O.keywords,onChange:Ne=>K("keywords",Ne.target.value),placeholder:"Enter keyword...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:Ne=>{Ne.key==="Enter"&&(Ne.preventDefault(),se())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["City",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(case-insensitive)"})]}),t.jsx("input",{type:"text",value:O.city,onChange:Ne=>K("city",Ne.target.value),placeholder:"Enter city name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:Ne=>{Ne.key==="Enter"&&(Ne.preventDefault(),se())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["State",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(case-insensitive)"})]}),t.jsx("input",{type:"text",value:O.state,onChange:Ne=>K("state",Ne.target.value),placeholder:"Enter state name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:Ne=>{Ne.key==="Enter"&&(Ne.preventDefault(),se())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Country",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(case-insensitive)"})]}),t.jsx("input",{type:"text",value:O.country,onChange:Ne=>K("country",Ne.target.value),placeholder:"Enter country name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:Ne=>{Ne.key==="Enter"&&(Ne.preventDefault(),se())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Has Email",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(valid email format)"})]}),t.jsxs("select",{value:O.hasEmail,onChange:Ne=>K("hasEmail",Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"All Contacts"}),t.jsx("option",{value:"yes",children:"Has Valid Email"}),t.jsx("option",{value:"no",children:"No Valid Email"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Has LinkedIn",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(person or company)"})]}),t.jsxs("select",{value:O.hasLinkedIn,onChange:Ne=>K("hasLinkedIn",Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"All Contacts"}),t.jsx("option",{value:"yes",children:"Has LinkedIn URL"}),t.jsx("option",{value:"no",children:"No LinkedIn URL"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Has Phone",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(phone number available)"})]}),t.jsxs("select",{value:O.hasPhone,onChange:Ne=>K("hasPhone",Ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"All Contacts"}),t.jsx("option",{value:"yes",children:"Has Phone Number"}),t.jsx("option",{value:"no",children:"No Phone Number"})]})]})]}),t.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t border-gray-200",children:[t.jsx("button",{onClick:Ce,disabled:!ne(),className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${ne()?"text-gray-700 bg-gray-100 hover:bg-gray-200 cursor-pointer":"text-gray-400 bg-gray-50 cursor-not-allowed"}`,children:"Clear All"}),t.jsx("button",{onClick:se,className:"flex-1 px-4 py-2 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 active:bg-blue-800 rounded-lg transition-colors shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Apply Filters"})]}),ne()&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Active filters:"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[w&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Keyword: ",w]}),N&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["City: ",N]}),S&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["State: ",S]}),D&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Country: ",D]}),M&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Email: ",M==="yes"?"Yes":"No"]}),L&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["LinkedIn: ",L==="yes"?"Yes":"No"]}),F&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Phone: ",F==="yes"?"Yes":"No"]})]})]})]})})]})}function Wk(){const[l,n]=B.useState([]),[a,o]=B.useState(!0),[s,e]=B.useState(null),[m,v]=i0(),[w,N]=B.useState([]),[S,D]=B.useState("name"),[L,M]=B.useState("asc"),[F,O]=B.useState({page:1,limit:50,total:0,totalPages:0}),[P,K]=B.useState(""),[ne,se]=B.useState(new Set),[Ce,ge]=B.useState("details"),[Ne,J]=B.useState(new Set),[de,le]=B.useState([]),[ze,me]=B.useState(!1),oe=Dr(),ce=m.get("category")||"All",ye=parseInt(m.get("page")||"1",10),ke=m.get("search")||"",fe=m.get("filterKeywords")||"",Se=m.get("filterCity")||"",Ye=m.get("filterState")||"",te=m.get("filterCountry")||"",pe=m.get("filterHasLinkedIn")||"",V=m.get("filterHasEmail")||"",be=m.get("filterHasPhone")||"",[_e,De]=B.useState(["All"]),W=async()=>{try{const ht=(await Ut.get("/categories")).data?.data||[];De(["All",...ht])}catch(Re){console.error("Error fetching categories:",Re),De(["All","IND-IT & Service","Accounting & Book keeping","Web Design & Development","Enterprise Software","Finance Services - IND","E-commerce","CRM","Middle East","International","USA Chicago","IT Company - USA","IT Company - Chicago","Weam.ai Mumbai Data","ERP Software","ERP NEXT- Manufacturing-Automotive Components & Spares","Salon & Spa - Chicago","SPA & SALON AHMEDABAD","kology"])}};B.useEffect(()=>{W()},[]),B.useEffect(()=>{const Re=()=>{document.hidden||W()};return document.addEventListener("visibilitychange",Re),()=>{document.removeEventListener("visibilitychange",Re)}},[]),B.useEffect(()=>{O(Re=>({...Re,page:ye}))},[ye]),B.useEffect(()=>{K(ke)},[ke]),B.useEffect(()=>{Ce==="company"&&H()},[Ce,ce,ke,fe,Se,Ye,te,pe,V,be]),B.useEffect(()=>{X()},[ce,ye,ke,fe,Se,Ye,te,pe,V,be]);const H=async()=>{try{me(!0);const Re={};ce&&ce!=="All"&&(Re.category=ce),ke&&ke.trim()&&(Re.search=ke.trim()),fe&&(Re.filterKeywords=fe),Se&&(Re.filterCity=Se),Ye&&(Re.filterState=Ye),te&&(Re.filterCountry=te),pe&&(Re.filterHasLinkedIn=pe),V&&(Re.filterHasEmail=V),be&&(Re.filterHasPhone=be);const Ft=(await Ut.get("/contacts/companies",{params:Re}))?.data?.data||[];le(Ft)}catch(Re){console.error("Error fetching companies:",Re),le([])}finally{me(!1)}},X=async()=>{try{o(!0);const Re={page:ye,limit:50};ce&&ce!=="All"&&(Re.category=ce),ke&&ke.trim()&&(Re.search=ke.trim()),fe&&(Re.filterKeywords=fe),Se&&(Re.filterCity=Se),Ye&&(Re.filterState=Ye),te&&(Re.filterCountry=te),pe&&(Re.filterHasLinkedIn=pe),V&&(Re.filterHasEmail=V),be&&(Re.filterHasPhone=be);const ht=await Ut.get("/contacts",{params:Re}),Ft=ht?.data?.data||ht?.data||[];n(Array.isArray(Ft)?Ft:[]),ht?.data&&O({page:ht.data.page||ye,limit:ht.data.limit||50,total:ht.data.total||0,totalPages:ht.data.totalPages||0}),e(null)}catch(Re){e("Failed to fetch contacts. Please try again."),console.error("=== Error fetching contacts ==="),console.error("Error details:",Re),console.error("Error response:",Re?.response?.data),console.error("Error status:",Re?.response?.status),console.error("==============================")}finally{o(!1)}},je=Re=>{const ht=ce!=="All"?`?category=${encodeURIComponent(ce)}`:"";oe(`/contacts/${Re}${ht}`)},Q=Re=>{Re.target.checked?N(l.map(ht=>ht._id)):N([])},we=Re=>{N(ht=>ht.includes(Re)?ht.filter(Ft=>Ft!==Re):[...ht,Re])},Fe=async()=>{if(w.length===0)return;const Re=w.length===1?"Are you sure you want to delete this contact?":`Are you sure you want to delete ${w.length} contacts?`;if(window.confirm(Re))try{o(!0);const ht=w.map(Ft=>Ut.delete(`/contacts/${Ft}`));await Promise.all(ht),N([]),await X()}catch(ht){console.error("Error deleting contacts:",ht),alert(ht.response?.data?.error||"Failed to delete contacts")}finally{o(!1)}},ue=Re=>{S===Re?M(L==="asc"?"desc":"asc"):(D(Re),M("asc"))},xe=(Re,ht)=>{ht.stopPropagation(),Re.email&&(window.location.href=`mailto:${Re.email}`)},tt=Re=>{Re.preventDefault();const ht=P.trim(),Ft={page:"1"};ce!=="All"&&(Ft.category=ce),ht&&(Ft.search=ht),fe&&(Ft.filterKeywords=fe),Se&&(Ft.filterCity=Se),Ye&&(Ft.filterState=Ye),te&&(Ft.filterCountry=te),pe&&(Ft.filterHasLinkedIn=pe),V&&(Ft.filterHasEmail=V),be&&(Ft.filterHasPhone=be),v(Ft,{replace:!0})},Qe=()=>{K("");const Re={page:"1"};ce!=="All"&&(Re.category=ce),fe&&(Re.filterKeywords=fe),Se&&(Re.filterCity=Se),Ye&&(Re.filterState=Ye),te&&(Re.filterCountry=te),pe&&(Re.filterHasLinkedIn=pe),V&&(Re.filterHasEmail=V),be&&(Re.filterHasPhone=be),v(Re,{replace:!0})},Ve=Re=>{const ht={page:"1"};ce!=="All"&&(ht.category=ce),ke&&ke.trim()&&(ht.search=ke.trim()),Re.keywords&&Re.keywords.trim()&&(ht.filterKeywords=Re.keywords.trim()),Re.city&&Re.city.trim()&&(ht.filterCity=Re.city.trim()),Re.state&&Re.state.trim()&&(ht.filterState=Re.state.trim()),Re.country&&Re.country.trim()&&(ht.filterCountry=Re.country.trim()),Re.hasLinkedIn&&Re.hasLinkedIn!==""&&(ht.filterHasLinkedIn=Re.hasLinkedIn),Re.hasEmail&&Re.hasEmail!==""&&(ht.filterHasEmail=Re.hasEmail),Re.hasPhone&&Re.hasPhone!==""&&(ht.filterHasPhone=Re.hasPhone),v(ht,{replace:!0})},xt=()=>!!(fe||Se||Ye||te||pe||V||be),nt=()=>{const Re={page:"1"};ce!=="All"&&(Re.category=ce),ke&&(Re.search=ke),v(Re,{replace:!0})},$t=[...l].sort((Re,ht)=>{let Ft=Re[S]||"",Is=ht[S]||"";return typeof Ft=="string"&&(Ft=Ft.toLowerCase(),Is=Is.toLowerCase()),L==="asc"?Ft>Is?1:Ft<Is?-1:0:Ft<Is?1:Ft>Is?-1:0}),Mt=Re=>{if(!Re)return"?";const ht=Re.trim().split(/\s+/);return ht.length>=2?(ht[0][0]+ht[1][0]).toUpperCase():Re.substring(0,2).toUpperCase()},Es=Re=>{se(ht=>{const Ft=new Set(ht);return Ft.has(Re)?Ft.delete(Re):Ft.add(Re),Ft})},qs=Re=>{if(!Re.keywords)return"-";const ht=Re.keywords.split(",").map(Is=>Is.trim()).filter(Is=>Is),Ft=ne.has(Re._id);return ht.length<=3||Ft?ht.join(", "):ht.slice(0,3).join(", ")+"..."},ms=Re=>{J(ht=>{const Ft=new Set(ht);return Ft.has(Re)?Ft.delete(Re):Ft.add(Re),Ft})},ys=Re=>{const ht=ce!=="All"?`?category=${encodeURIComponent(ce)}`:"",Ft=encodeURIComponent(Re);oe(`/contacts/company/${Ft}${ht}`)};return a?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse"}),t.jsx("div",{className:"relative animate-spin rounded-full h-14 w-14 border-2 border-gray-200 border-t-gray-900 mx-auto"})]}),t.jsx("p",{className:"tracking-wide text-sm uppercase text-gray-500 font-medium",children:"Loading contacts..."})]})}):t.jsx("div",{className:"min-h-screen bg-white py-4 sm:py-8",children:t.jsxs("div",{className:"max-w-full mx-auto px-3 sm:px-4 lg:px-8",children:[t.jsxs("div",{className:"mb-8 animate-fade-in-down",children:[t.jsx("div",{className:"mb-6",children:t.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 tracking-tight",children:"Contacts"}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1 self-start sm:self-auto",children:[t.jsx("button",{onClick:()=>ge("details"),className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-all duration-200 ${Ce==="details"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"View individual contacts",children:"Details"}),t.jsx("button",{onClick:()=>ge("company"),className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-all duration-200 ${Ce==="company"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"View companies grouped by name",children:"Company"})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-gray-50 text-gray-700 border border-gray-200 shadow-sm",children:[F.total.toLocaleString()," ",F.total===1?"contact":"contacts"]}),F.totalPages>1&&t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200 shadow-sm",children:["Page ",ye," of ",F.totalPages]}),t.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t.jsx("span",{className:"text-xs sm:text-sm text-gray-500 font-medium hidden sm:inline",children:"Category:"}),t.jsx("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200 shadow-sm truncate max-w-[150px] sm:max-w-none",children:ce})]}),Ce==="company"&&de.length>0&&t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-emerald-50 text-emerald-700 border border-emerald-200 shadow-sm",children:[de.length," ",de.length===1?"company":"companies"]}),xt()&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 sm:px-3 py-1 sm:py-1.5 rounded-lg text-xs font-semibold bg-yellow-50 text-yellow-700 border border-yellow-200 shadow-sm",children:[t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Filters Active"}),t.jsx("span",{className:"sm:hidden",children:"Filters"})]})]})]})})}),t.jsx("div",{className:"bg-gray-50 rounded-xl p-3 sm:p-5 border border-gray-200 shadow-sm mb-4 sm:mb-6",children:t.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 sm:gap-4 items-stretch lg:items-end",children:[t.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-2 sm:gap-3 w-full",children:[t.jsxs("form",{onSubmit:tt,className:"flex-1 flex gap-2",children:[t.jsxs("div",{className:"relative flex-1 group",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:t.jsx("svg",{className:"w-5 h-5 text-gray-400 group-focus-within:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",value:P,onChange:Re=>K(Re.target.value),onKeyDown:Re=>{Re.key==="Enter"&&tt(Re)},placeholder:"Search by name, email, company, title...",className:"pl-11 pr-11 py-3 w-full border border-gray-300 rounded-lg text-sm text-gray-900 placeholder-gray-400 bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"}),P&&t.jsx("button",{type:"button",onClick:Qe,className:"absolute inset-y-0 right-0 flex items-center pr-4 text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-all duration-200 font-semibold text-sm whitespace-nowrap shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Search"})]}),t.jsxs("div",{className:"relative group w-full sm:w-64",children:[t.jsx("select",{value:ce,onChange:Re=>{const ht=Re.target.value,Ft={page:"1"};ht!=="All"&&(Ft.category=ht),ke&&(Ft.search=ke),fe&&(Ft.filterKeywords=fe),Se&&(Ft.filterCity=Se),Ye&&(Ft.filterState=Ye),te&&(Ft.filterCountry=te),pe&&(Ft.filterHasLinkedIn=pe),V&&(Ft.filterHasEmail=V),be&&(Ft.filterHasPhone=be),v(Ft,{replace:!0})},className:"appearance-none bg-white border border-gray-300 rounded-lg px-3 sm:px-4 py-2 sm:py-3 pr-8 sm:pr-10 w-full text-xs sm:text-sm font-medium text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer shadow-sm hover:border-gray-400 hover:shadow-md",children:_e.map(Re=>t.jsx("option",{value:Re,children:Re},Re))}),t.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 sm:pr-3 pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-500 group-hover:text-gray-700 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),t.jsx(Vk,{category:ce,searchParam:ke,onApplyFilters:Ve,onClearFilters:nt})]}),t.jsxs("div",{className:"flex gap-2 sm:gap-3 w-full sm:w-auto flex-wrap sm:flex-nowrap",children:[w.length>0&&t.jsxs("button",{onClick:Fe,disabled:a,className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 active:bg-red-800 transition-all duration-200 font-semibold text-sm shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transform hover:scale-105 active:scale-100 flex-1 sm:flex-none disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),t.jsxs("span",{className:"hidden sm:inline",children:["Remove ",w.length>1?`(${w.length})`:""]}),t.jsx("span",{className:"sm:hidden",children:"Remove"})]}),t.jsxs("button",{onClick:()=>oe("/import"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 hover:border-gray-400 active:bg-gray-100 transition-all duration-200 font-semibold text-sm shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 flex-1 sm:flex-none",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),t.jsx("span",{className:"hidden sm:inline",children:"Import"})]}),t.jsxs("button",{onClick:()=>oe("/contacts/new"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 active:bg-gray-950 transition-all duration-200 font-semibold text-sm shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transform hover:scale-105 active:scale-100 flex-1 sm:flex-none",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),t.jsx("span",{className:"hidden sm:inline",children:"Add Contact"}),t.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]})})]}),s&&t.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 text-red-700 px-5 py-4 rounded-lg shadow-md animate-shake",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),t.jsx("span",{className:"font-medium",children:s})]})}),l.length===0?t.jsxs("div",{className:"text-center py-16 bg-white rounded-lg shadow-sm border border-gray-200 animate-fade-in",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gray-100 mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No contacts found"}),t.jsx("p",{className:"text-gray-600 mb-2",children:ce==="All"?"No contacts found in the database.":t.jsxs(t.Fragment,{children:["No contacts found for category: ",t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200",children:ce})]})}),t.jsx("p",{className:"text-sm text-gray-500 mb-8",children:ce==="All"?"Try using the search or filters to find contacts, or import contacts to get started.":"Switch to a different category using the dropdown above, or import/add contacts for this category."}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx("button",{onClick:()=>oe("/import"),className:"inline-flex items-center px-5 py-3 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-900 bg-white hover:bg-gray-50 transition-all duration-200 hover:shadow-md",children:"Import CSV/Excel"}),t.jsx("button",{onClick:()=>oe("/contacts/new"),className:"inline-flex items-center px-5 py-3 border border-transparent shadow-md text-sm font-medium rounded-lg text-white bg-gray-900 hover:bg-gray-800 transition-all duration-200 hover:shadow-lg transform hover:scale-105",children:"Add Contact"})]})]}):Ce==="company"?t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden animate-fade-in",children:ze?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading companies..."})]})}):de.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gray-100 mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No companies found"}),t.jsx("p",{className:"text-gray-600 mb-2",children:xt()?"No companies match the current filters. Try adjusting your search or filter criteria.":ce==="All"?"No companies found in the database.":t.jsxs(t.Fragment,{children:["No companies found for category: ",t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200",children:ce})]})}),t.jsx("p",{className:"text-sm text-gray-500 mb-8",children:xt()?"Clear filters or try a different search term.":"Try using the search or filters to find companies, or import contacts to get started."}),xt()&&t.jsx("button",{onClick:nt,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:"Clear All Filters"})]}):t.jsx("div",{className:"overflow-y-auto",style:{maxHeight:"calc(100vh - 300px)",overscrollBehavior:"contain"},children:t.jsx("div",{className:"divide-y divide-gray-200",children:de.map(Re=>{const ht=Re.name,Ft=Ne.has(ht);return t.jsxs("div",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("div",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4 flex-1 cursor-pointer",onClick:()=>ys(ht),children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-lg font-bold text-blue-700",children:Mt(ht)})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ht}),t.jsxs("p",{className:"text-sm text-gray-500",children:[Re.count," ",Re.count===1?"person":"people"]})]})]}),t.jsx("button",{onClick:Is=>{Is.stopPropagation(),ms(ht)},className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:`w-5 h-5 transition-transform ${Ft?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),Ft&&t.jsx("div",{className:"bg-gray-50 border-t border-gray-200",children:t.jsxs("div",{className:"px-6 py-4 text-center",children:[t.jsxs("p",{className:"text-gray-600 mb-4",children:["Click on the company name above to view all ",Re.count," ",Re.count===1?"contact":"contacts"]}),t.jsx("button",{onClick:()=>ys(ht),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"View All Contacts"})]})})]},ht)})})})}):t.jsxs("div",{className:"bg-white border border-gray-200 overflow-hidden animate-fade-in",children:[t.jsxs("div",{className:"overflow-x-auto overflow-y-auto",style:{maxHeight:"calc(100vh - 300px)",overscrollBehavior:"contain",scrollBehavior:"auto"},children:[t.jsx("div",{className:"hidden md:block",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"w-12 px-4 py-3 whitespace-nowrap",children:t.jsx("input",{type:"checkbox",checked:w.length===l.length&&l.length>0,onChange:Q,className:"h-4 w-4 text-gray-900 focus:ring-gray-900 border-gray-300 rounded cursor-pointer"})}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors whitespace-nowrap",style:{minWidth:"150px"},onClick:()=>ue("name"),children:t.jsxs("div",{className:"flex items-center gap-2",children:["NAME",t.jsx("svg",{className:`w-4 h-4 flex-shrink-0 ${S==="name"?"text-gray-900":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"140px"},children:"JOB TITLE"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"180px"},children:"COMPANY"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"130px"},children:"CONTACT NUMBER"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"180px"},children:"EMAIL"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"110px"},children:"LINKEDIN"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"140px"},children:"INDUSTRY"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",style:{minWidth:"180px"},children:"KEYWORDS"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:$t.map(Re=>t.jsxs("tr",{onClick:()=>je(Re._id),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",onClick:ht=>ht.stopPropagation(),children:t.jsx("input",{type:"checkbox",checked:w.includes(Re._id),onChange:()=>we(Re._id),className:"h-4 w-4 text-gray-900 focus:ring-gray-900 border-gray-300 rounded cursor-pointer"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm font-medium text-gray-900 underline hover:text-gray-700",children:Re.name||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Re.title||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-gray-200 flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-xs font-semibold text-gray-700",children:Mt(Re.company)})}),t.jsx("div",{className:"text-sm text-gray-900",children:Re.company||"-"})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Re.firstPhone?t.jsx("a",{href:`tel:${Re.firstPhone}`,onClick:ht=>ht.stopPropagation(),className:"hover:text-gray-700 hover:underline",children:Re.firstPhone}):"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Re.email?t.jsx("a",{href:`mailto:${Re.email}`,onClick:ht=>{ht.stopPropagation(),xe(Re,ht)},className:"hover:text-gray-700 hover:underline",children:Re.email}):"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Re.personLinkedinUrl||Re.companyLinkedinUrl?t.jsxs("a",{href:Re.personLinkedinUrl||Re.companyLinkedinUrl,onClick:ht=>ht.stopPropagation(),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium bg-blue-50 text-blue-700 hover:bg-blue-100 border border-blue-200 transition-colors whitespace-nowrap",children:[t.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("span",{children:"LinkedIn"})]}):t.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Re.industry||"-"})}),t.jsx("td",{className:"px-6 py-4",children:Re.keywords?t.jsx("div",{className:"text-sm text-gray-900 cursor-pointer hover:text-blue-600 transition-colors",onClick:ht=>{ht.stopPropagation(),Re.keywords.split(",").map(Is=>Is.trim()).filter(Is=>Is).length>3&&Es(Re._id)},title:Re.keywords,children:qs(Re)}):t.jsx("div",{className:"text-sm text-gray-400",children:"-"})})]},Re._id))})]})}),t.jsx("div",{className:"md:hidden space-y-3 p-3",children:$t.map(Re=>t.jsxs("div",{onClick:()=>je(Re._id),className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[t.jsx("div",{className:"flex items-start justify-between mb-3",children:t.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t.jsx("input",{type:"checkbox",checked:w.includes(Re._id),onChange:ht=>{ht.stopPropagation(),we(Re._id)},className:"h-4 w-4 text-gray-900 focus:ring-gray-900 border-gray-300 rounded cursor-pointer flex-shrink-0 mt-1"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:Re.name||"-"}),t.jsx("p",{className:"text-xs text-gray-500 truncate",children:Re.title||"-"})]})]})}),t.jsxs("div",{className:"space-y-2 text-xs",children:[Re.company&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),t.jsx("span",{className:"text-gray-700 truncate",children:Re.company})]}),Re.email&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("a",{href:`mailto:${Re.email}`,onClick:ht=>ht.stopPropagation(),className:"text-blue-600 hover:underline truncate",children:Re.email})]}),Re.firstPhone&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("a",{href:`tel:${Re.firstPhone}`,onClick:ht=>ht.stopPropagation(),className:"text-blue-600 hover:underline",children:Re.firstPhone})]}),(Re.personLinkedinUrl||Re.companyLinkedinUrl)&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("a",{href:Re.personLinkedinUrl||Re.companyLinkedinUrl,onClick:ht=>ht.stopPropagation(),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-xs",children:"LinkedIn Profile"})]}),Re.industry&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-gray-400 text-xs",children:"Industry:"}),t.jsx("span",{className:"text-gray-700",children:Re.industry})]}),Re.keywords&&t.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[t.jsx("span",{className:"text-gray-400 text-xs",children:"Keywords: "}),t.jsx("span",{className:"text-gray-700 text-xs",children:qs(Re)})]})]})]},Re._id))})]}),F.totalPages>1&&t.jsxs("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-t border-gray-200 bg-gray-50 flex flex-col sm:flex-row items-center justify-between gap-3",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("span",{className:"text-xs sm:text-sm text-gray-700",children:["Showing ",(ye-1)*F.limit+1," to ",Math.min(ye*F.limit,F.total)," of ",F.total.toLocaleString()," contacts"]})}),t.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t.jsxs("button",{onClick:()=>{if(ye>1){const ht={page:(ye-1).toString()};ce!=="All"&&(ht.category=ce),ke&&(ht.search=ke),v(ht,{replace:!0})}},disabled:ye===1,className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[t.jsx("span",{className:"hidden sm:inline",children:"Previous"}),t.jsx("span",{className:"sm:hidden",children:"Prev"})]}),t.jsx("div",{className:"flex items-center gap-0.5 sm:gap-1",children:Array.from({length:Math.min(5,F.totalPages)},(Re,ht)=>{let Ft;return F.totalPages<=5||ye<=3?Ft=ht+1:ye>=F.totalPages-2?Ft=F.totalPages-4+ht:Ft=ye-2+ht,t.jsx("button",{onClick:()=>{const Is={page:Ft.toString()};ce!=="All"&&(Is.category=ce),ke&&(Is.search=ke),v(Is,{replace:!0})},className:`px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium rounded transition-colors ${ye===Ft?"bg-gray-900 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:Ft},Ft)})}),t.jsx("button",{onClick:()=>{if(ye<F.totalPages){const ht={page:(ye+1).toString()};ce!=="All"&&(ht.category=ce),ke&&(ht.search=ke),v(ht,{replace:!0})}},disabled:ye>=F.totalPages,className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]})]})]})})}function $k(){const{id:l}=di(),n=Dr(),[a]=i0(),o=a.get("category"),s=a.get("returnTo"),[e,m]=B.useState(null),[v,w]=B.useState(!0),[N,S]=B.useState(!1),[D,L]=B.useState(null),[M,F]=B.useState(!1),[O,P]=B.useState(!1),[K,ne]=B.useState("about"),se=B.useRef(!1);B.useEffect(()=>{Ce()},[l]);const Ce=async()=>{try{w(!0);const me=await Ut.get(`/contacts/${l}`);m(me.data?.data||me.data),L(null)}catch(me){L("Failed to fetch contact details."),console.error("Error fetching contact:",me)}finally{w(!1)}},ge=async(me=!1)=>{if(!(!e||!(me&&e.companyLinkedinUrl?e.companyLinkedinUrl:e.personLinkedinUrl||e.companyLinkedinUrl)))try{S(!0);const ce=me?`/linkedin/fetch/${l}?type=company`:`/linkedin/fetch/${l}`,ye=await Ut.get(ce),ke=ye.data?.data?.contact||ye.data?.contact;ke&&m(ke)}catch(ce){console.error("Error fetching LinkedIn data:",ce)}finally{S(!1)}};B.useEffect(()=>{e&&(e.personLinkedinUrl||e.companyLinkedinUrl)&&!se.current&&(se.current=!0,ge())},[e]);const Ne=me=>{if(!me)return"?";const oe=me.trim().split(/\s+/);return oe.length>=2?(oe[0][0]+oe[oe.length-1][0]).toUpperCase():me.substring(0,2).toUpperCase()},J=me=>{if(!me)return"?";const oe=me.trim().split(/\s+/);return oe.length>=2?(oe[0][0]+oe[1][0]).toUpperCase():me.substring(0,2).toUpperCase()},de=()=>{if(!e?.company)return;const me=o||e.category||"",oe=me?`?category=${encodeURIComponent(me)}`:"";n(`/contacts/company/${encodeURIComponent(e.company)}${oe}`)};if(v)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[t.jsxs("div",{className:"relative inline-block",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse opacity-30"}),t.jsx("div",{className:"relative animate-spin rounded-full h-16 w-16 border-4 border-gray-200 border-t-blue-600"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wider",children:"Loading Contact"}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Please wait..."})]})]})});if(!e)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[t.jsx("div",{className:"w-20 h-20 mx-auto bg-red-100 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-10 h-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contact Not Found"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"The contact you're looking for doesn't exist or has been removed."}),t.jsxs("button",{onClick:()=>{if(s)n(s);else{const me=o?`?category=${encodeURIComponent(o)}`:"";n(`/contacts${me}`)}},className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),s?"Back":"Back to Contacts"]})]})]})});e.linkedinData;const le=[e.city,e.state,e.country].filter(Boolean).join(", ")||"Not specified",ze=e.title&&e.company?`${e.title} at ${e.company}`:e.title||e.company||"";return t.jsxs("div",{className:"min-h-screen bg-white",children:[t.jsx("div",{className:"bg-white border-b border-gray-200",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:[t.jsx("nav",{className:"mb-4 sm:mb-6 animate-fade-in-down",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-gray-600 overflow-x-auto",children:[t.jsxs("button",{onClick:()=>{if(s)n(s);else{const me=o||e?.category||"",oe=me?`?category=${encodeURIComponent(me)}`:"";n(`/contacts${oe}`)}},className:"hover:text-gray-900 transition-colors duration-200 flex items-center gap-1 whitespace-nowrap",children:[t.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),t.jsx("span",{className:"hidden sm:inline",children:s?"Back":"Contacts"}),t.jsx("span",{className:"sm:hidden",children:"Back"})]}),t.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),t.jsx("span",{className:"text-gray-900 font-medium truncate",children:e.name})]})}),t.jsx("div",{className:"bg-white rounded-lg sm:rounded-xl border border-gray-200 shadow-sm p-4 sm:p-6 animate-fade-in-up",children:t.jsxs("div",{className:"flex flex-col items-center sm:items-start sm:flex-row gap-4 sm:gap-6",children:[t.jsx("div",{className:"relative flex-shrink-0",children:t.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-xl sm:text-2xl font-bold text-white shadow-lg ring-2 sm:ring-4 ring-blue-50",children:Ne(e.name)})}),t.jsxs("div",{className:"flex-1 min-w-0 w-full sm:w-auto text-center sm:text-left",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-center sm:items-start gap-2 sm:gap-3 mb-2",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 break-words",children:e.name}),e.category&&t.jsx("span",{className:"px-2 sm:px-3 py-1 bg-blue-50 text-blue-700 text-xs font-semibold rounded-full border border-blue-200 whitespace-nowrap",children:e.category})]}),ze&&t.jsx("p",{className:"text-gray-600 text-base sm:text-lg mb-2 sm:mb-3 font-medium break-words",children:ze}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-center sm:items-center gap-3 sm:gap-6 text-gray-600 text-xs sm:text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),t.jsx("span",{className:"break-words",children:le})]}),e.industry&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),t.jsx("span",{className:"break-words",children:e.industry})]})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto",children:[(e.personLinkedinUrl||e.companyLinkedinUrl)&&t.jsxs("a",{href:e.personLinkedinUrl||e.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center gap-2 px-4 sm:px-5 py-2 sm:py-2.5 bg-blue-600 text-white font-semibold text-sm rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md w-full sm:w-auto",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("span",{className:"hidden sm:inline",children:"LinkedIn Profile"}),t.jsx("span",{className:"sm:hidden",children:"LinkedIn"})]}),e.email&&t.jsxs("a",{href:`mailto:${e.email}`,className:"inline-flex items-center justify-center gap-2 px-4 sm:px-5 py-2 sm:py-2.5 bg-white text-gray-700 font-semibold text-sm rounded-lg hover:bg-gray-50 transition-all duration-200 border border-gray-300 shadow-sm hover:shadow-md w-full sm:w-auto",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Send Email"}),t.jsx("span",{className:"sm:hidden",children:"Email"})]})]})]})})]})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8 bg-white",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden animate-fade-in-up hover:shadow-md transition-shadow duration-300",children:[t.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 bg-white border-b border-gray-200 flex items-center justify-between cursor-pointer hover:bg-gray-50 transition-colors duration-200",onClick:()=>F(!M),children:[t.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Contact Information"}),t.jsx("span",{className:"sm:hidden",children:"Contact Info"})]}),t.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0",children:t.jsx("svg",{className:`w-5 h-5 transition-transform duration-300 ${M?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!M&&t.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-6 space-y-4 sm:space-y-5 animate-fade-in bg-white",children:[e.email&&t.jsxs("div",{className:"group",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Email"}),t.jsxs("a",{href:`mailto:${e.email}`,className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-50 rounded-lg hover:bg-blue-50 transition-all duration-200 border border-transparent hover:border-blue-200",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 flex-1 truncate min-w-0",children:e.email}),t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 group-hover:text-blue-600 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),e.firstPhone&&t.jsxs("div",{className:"group",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Phone"}),t.jsxs("a",{href:`tel:${e.firstPhone}`,className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 border border-transparent hover:border-gray-200",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 flex-1 break-all",children:e.firstPhone}),t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 group-hover:text-gray-600 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),e.companyPhone&&e.companyPhone!==e.firstPhone&&t.jsxs("div",{className:"group",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Company Phone"}),t.jsxs("a",{href:`tel:${e.companyPhone}`,className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 border border-transparent hover:border-gray-200",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 flex-1 break-all",children:e.companyPhone}),t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 group-hover:text-gray-600 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden animate-fade-in-up hover:shadow-md transition-shadow duration-300",children:[t.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 bg-white border-b border-gray-200 flex items-center justify-between",children:[t.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),t.jsx("span",{className:"hidden sm:inline",children:"Company Insights"}),t.jsx("span",{className:"sm:hidden",children:"Company"})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("button",{className:"p-1.5 sm:p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-200 flex-shrink-0",onClick:()=>P(!O),children:t.jsx("svg",{className:`w-5 h-5 transition-transform duration-300 ${O?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})})]}),!O&&t.jsxs("div",{className:"animate-fade-in",children:[t.jsx("div",{className:"px-4 sm:px-6 pt-3 sm:pt-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex gap-4 sm:gap-6 overflow-x-auto scrollbar-hide",children:[t.jsxs("button",{onClick:()=>ne("about"),className:`pb-2 sm:pb-3 px-1 text-xs sm:text-sm font-semibold transition-all duration-200 whitespace-nowrap relative flex-shrink-0 ${K==="about"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["About",K==="about"&&t.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-full animate-slide-in"})]}),t.jsxs("button",{onClick:()=>ne("employees"),className:`pb-2 sm:pb-3 px-1 text-xs sm:text-sm font-semibold transition-all duration-200 whitespace-nowrap relative flex-shrink-0 ${K==="employees"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["Employees ",e.employees&&t.jsxs("span",{className:"text-gray-400",children:["(",e.employees,")"]}),K==="employees"&&t.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-full animate-slide-in"})]})]})}),t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:e.company&&t.jsxs("div",{className:"mb-4 sm:mb-6",children:[t.jsxs("button",{type:"button",onClick:de,className:"w-full flex items-center gap-3 sm:gap-4 mb-4 sm:mb-6 p-3 sm:p-4 bg-gray-50 rounded-lg border border-gray-200 text-left hover:bg-blue-50 hover:border-blue-200 transition-colors duration-200",children:[t.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-base sm:text-lg shadow-sm flex-shrink-0",children:J(e.company)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-1 break-words",children:e.company}),t.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"View company profile & insights"})]}),t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),K==="about"&&t.jsxs("div",{className:"space-y-4 sm:space-y-6 animate-fade-in",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.industry&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Industry"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:e.industry})]}),e.category&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Category"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:e.category})]}),t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Location"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:[e.companyCity,e.companyState,e.companyCountry].filter(Boolean).join(", ")||[e.city,e.state,e.country].filter(Boolean).join(", ")||"Not specified"})]}),e.website&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Website"}),t.jsxs("a",{href:e.website.startsWith("http")?e.website:`https://${e.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs sm:text-sm font-medium text-blue-600 hover:text-blue-700 hover:underline inline-flex items-center gap-1 break-all",children:[e.website,t.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]}),e.companyAddress&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Address"}),t.jsx("p",{className:"text-xs sm:text-sm text-gray-700 break-words",children:e.companyAddress})]}),e.keywords&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 sm:mb-3 block",children:"Keywords"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:e.keywords.split(",").map((me,oe)=>t.jsx("span",{className:"px-2 sm:px-3 py-1 sm:py-1.5 bg-gray-50 text-gray-700 text-xs sm:text-sm font-medium rounded-lg border border-gray-200 hover:bg-gray-100 transition-all duration-200 cursor-default",children:me.trim()},oe))})]})]}),K==="employees"&&t.jsx("div",{className:"animate-fade-in",children:e.employees?t.jsx("div",{className:"p-4 sm:p-6 bg-white rounded-lg border border-gray-200",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:t.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Number of Employees"}),t.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:e.employees})]})}):t.jsxs("div",{className:"text-center py-8 sm:py-12 bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:t.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("p",{className:"text-gray-500 text-xs sm:text-sm",children:"No employees data available"})]})})]})})]})]})})]})})]})}function Nv({isOpen:l,onClose:n,type:a,contactName:o,companyName:s,projectId:e,contactId:m,phoneNumber:v,email:w,linkedInProfileUrl:N,activityId:S,editMode:D=!1,lastActivity:L=null}){const[M,F]=B.useState({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),[O,P]=B.useState({}),[K,ne]=B.useState(!1),[se,Ce]=B.useState(!1),[ge,Ne]=B.useState({phone:!1,email:!1,linkedin:!1}),[J,de]=B.useState({phone:null,email:null,linkedin:null}),[le,ze]=B.useState(!1),[me,oe]=B.useState([]),[ce,ye]=B.useState(""),[ke,fe]=B.useState(!1),Se=B.useRef(!1);B.useEffect(()=>{const Q=localStorage.getItem("linkedInAccounts");if(Q)try{oe(JSON.parse(Q))}catch(we){console.error("Error parsing LinkedIn accounts:",we),oe([])}else oe([])},[]);const Ye=()=>{if(ce.trim()&&!me.includes(ce.trim())){const Q=[...me,ce.trim()];oe(Q),localStorage.setItem("linkedInAccounts",JSON.stringify(Q)),F(we=>({...we,linkedInAccountName:ce.trim()})),ye(""),fe(!1)}},te=async()=>{try{const Q=await Ut.get(`/activities/${S}`);if(Q.data.success){const we=Q.data.data;F({template:we.template||"",outcome:we.outcome||"",conversationNotes:we.conversationNotes||"",nextAction:we.nextAction||"",nextActionDate:we.nextActionDate?new Date(we.nextActionDate).toISOString().split("T")[0]:"",phoneNumber:we.phoneNumber||v||"",email:we.email||w||"",linkedInUrl:we.linkedInUrl||N||"",status:we.status||"",linkedInAccountName:we.linkedInAccountName||"",lnRequestSent:we.lnRequestSent||"",connected:we.connected||"",callNumber:we.callNumber||"",callStatus:we.callStatus||"",callDate:we.callDate?new Date(we.callDate).toISOString().split("T")[0]:"",emailDate:we.emailDate?new Date(we.emailDate).toISOString().split("T")[0]:we.createdAt?new Date(we.createdAt).toISOString().split("T")[0]:"",linkedinDate:we.linkedinDate?new Date(we.linkedinDate).toISOString().split("T")[0]:we.createdAt?new Date(we.createdAt).toISOString().split("T")[0]:""}),de({phone:we.phoneNumber||v||null,email:we.email||w||null,linkedin:we.linkedInUrl||N||null})}}catch(Q){console.error("Error fetching activity data:",Q),P({submit:"Couldn't load the activity details. Try refreshing."})}},pe=async()=>{if(!m||!a)return null;try{const Q=await Ut.get(`/activities/contact/${m}`);if(Q.data.success&&Q.data.data){const Fe=Q.data.data.filter(ue=>ue.type===a);if(Fe.length>0)return Fe.sort((ue,xe)=>new Date(xe.createdAt)-new Date(ue.createdAt)),Fe[0]}}catch(Q){console.error("Error fetching last activity by type:",Q)}return null};if(B.useEffect(()=>{if(l&&!Se.current){setTimeout(()=>Ce(!0),10);const Q=new Date().toISOString().split("T")[0];if(Se.current=!0,D&&S)te();else if(L){const we=L;F({template:we.template||"",outcome:we.outcome||"",conversationNotes:we.conversationNotes||"",nextAction:we.nextAction||"",nextActionDate:we.nextActionDate?new Date(we.nextActionDate).toISOString().split("T")[0]:"",phoneNumber:we.phoneNumber||v||"",email:we.email||w||"",linkedInUrl:we.linkedInUrl||N||"",status:we.status||"",linkedInAccountName:we.linkedInAccountName||"",lnRequestSent:we.lnRequestSent||"",connected:we.connected||"",callNumber:we.callNumber||"",callStatus:we.callStatus||"",callDate:we.callDate?new Date(we.callDate).toISOString().split("T")[0]:we.type==="call"?Q:"",emailDate:we.emailDate?new Date(we.emailDate).toISOString().split("T")[0]:we.type==="email"?Q:"",linkedinDate:we.linkedinDate?new Date(we.linkedinDate).toISOString().split("T")[0]:we.type==="linkedin"?Q:""}),de({phone:we.phoneNumber||v||null,email:we.email||w||null,linkedin:we.linkedInUrl||N||null}),we.type!==a&&pe().then(Fe=>{Fe&&F(ue=>{const xe={...ue};return a==="call"&&Fe.callDate?xe.callDate=new Date(Fe.callDate).toISOString().split("T")[0]:a==="email"&&Fe.emailDate?xe.emailDate=new Date(Fe.emailDate).toISOString().split("T")[0]:a==="linkedin"&&Fe.linkedinDate&&(xe.linkedinDate=new Date(Fe.linkedinDate).toISOString().split("T")[0]),xe})})}else F(we=>({...we,phoneNumber:v||"",email:w||"",linkedInUrl:N||"",callDate:a==="call"?Q:"",emailDate:a==="email"?Q:"",linkedinDate:a==="linkedin"?Q:""})),de({phone:v||null,email:w||null,linkedin:N||null}),pe().then(we=>{we&&F(Fe=>{const ue={...Fe};return a==="call"&&we.callDate?ue.callDate=new Date(we.callDate).toISOString().split("T")[0]:a==="email"&&we.emailDate?ue.emailDate=new Date(we.emailDate).toISOString().split("T")[0]:a==="linkedin"&&we.linkedinDate&&(ue.linkedinDate=new Date(we.linkedinDate).toISOString().split("T")[0]),ue})})}else l||(Ce(!1),Se.current=!1)},[l,D,S,a,v,w,N,m||null,L?._id]),!l)return null;const V=()=>{const Q="w-5 h-5";switch(a){case"call":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${Q} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${Q} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${Q} text-white`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},be=()=>{if(D)switch(a){case"call":return"Edit Call Activity";case"email":return"Edit Email Activity";case"linkedin":return"Edit LinkedIn Activity";default:return"Edit Activity"}switch(a){case"call":return"Log Call Activity";case"email":return"Log Email Activity";case"linkedin":return"Log LinkedIn Activity";default:return"Log Activity"}},_e=()=>{switch(a){case"call":return"from-green-50 to-emerald-50";case"email":return"from-blue-50 to-cyan-50";case"linkedin":return"from-blue-50 to-indigo-50";default:return"from-gray-50 to-gray-100"}},De=(Q,we)=>{F(Fe=>({...Fe,[Q]:we})),O[Q]&&P(Fe=>({...Fe,[Q]:""}))},W=()=>{const Q={};if(M.nextAction&&!M.nextActionDate&&(Q.nextActionDate="Next action date is required when next action is specified"),M.nextActionDate){const we=new Date(M.nextActionDate),Fe=new Date,ue=new Date(Fe);ue.setDate(ue.getDate()+7),we>ue&&(Q.nextActionDate="Next action must be scheduled within 7 days")}return P(Q),Object.keys(Q).length===0},H=async Q=>{if(Q.preventDefault(),!!W()){ne(!0);try{const we=M.conversationNotes.trim()||"";let Fe;const ue=M.callDate&&M.callDate.trim()?M.callDate.trim():null,xe=M.emailDate&&M.emailDate.trim()?M.emailDate.trim():null,tt=M.linkedinDate&&M.linkedinDate.trim()?M.linkedinDate.trim():null;if(D&&S?Fe=await Ut.put(`/activities/${S}`,{template:M.template,conversationNotes:we,nextAction:M.nextAction,nextActionDate:M.nextActionDate,phoneNumber:M.phoneNumber||v||null,email:M.email||w||null,linkedInUrl:M.linkedInUrl||N||null,status:M.status||null,linkedInAccountName:M.linkedInAccountName||null,lnRequestSent:M.lnRequestSent||null,connected:M.connected||null,callNumber:M.callNumber||null,callStatus:M.callStatus||null,callDate:ue,emailDate:xe,linkedinDate:tt}):Fe=await Ut.post("/activities",{projectId:e,contactId:m||null,type:a,template:M.template,outcome:null,conversationNotes:we,nextAction:M.nextAction,nextActionDate:M.nextActionDate,phoneNumber:M.phoneNumber||v||null,email:M.email||w||null,linkedInUrl:M.linkedInUrl||N||null,status:M.status||null,linkedInAccountName:M.linkedInAccountName||null,lnRequestSent:M.lnRequestSent||null,connected:M.connected||null,callNumber:M.callNumber||null,callStatus:M.callStatus||null,callDate:ue,emailDate:xe,linkedinDate:tt}),Fe.data.success&&M.status&&m&&e)try{await Ut.put(`/projects/${e}/project-contacts/${m}`,{stage:M.status})}catch(Qe){console.error("Error updating contact status:",Qe)}Fe.data.success?(F({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:v||"",email:w||"",linkedInUrl:N||"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),n(!0)):P({submit:Fe.data.error||"Couldn't save that activity. Give it another try."})}catch(we){console.error("Error saving activity:",we);const Fe=we.response?.data?.error||we.message||"Something went wrong saving the activity. Try again.";P({submit:Fe})}finally{ne(!1)}}},X=()=>{F({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),P({}),de({phone:null,email:null,linkedin:null}),Ne({phone:!1,email:!1,linkedin:!1}),ze(!1),n()},je=async(Q,we,Fe)=>{if(m){Ne(ue=>({...ue,[Q]:!0}));try{const ue={[Fe]:we||""};await Ut.put(`/contacts/${m}`,ue),de(xe=>({...xe,[Q]:we||null})),Q==="phone"?F(xe=>({...xe,phoneNumber:we||""})):Q==="email"?F(xe=>({...xe,email:we||""})):Q==="linkedin"&&F(xe=>({...xe,linkedInUrl:we||""}))}catch(ue){console.error(`Error saving ${Q}:`,ue),P({submit:`Couldn't save ${Q}. Give it another shot.`})}finally{Ne(ue=>({...ue,[Q]:!1}))}}};return t.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${se?"opacity-100":"opacity-0"}`,onClick:X,children:t.jsxs("div",{className:`bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col transform transition-all duration-300 ${se?"scale-100 translate-y-0":"scale-95 translate-y-4"}`,onClick:Q=>Q.stopPropagation(),children:[t.jsx("div",{className:`bg-gradient-to-r ${_e()} border-b border-gray-200 p-4 flex-shrink-0`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[le&&t.jsx("button",{onClick:()=>ze(!1),className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-600 hover:text-gray-900 hover:bg-white/50 transition-all duration-200 group",title:"Back to form",children:t.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("div",{className:"animate-pulse-once",children:V()}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-0.5",children:le&&a==="linkedin"?"LinkedIn Message Variations":le&&a==="email"?"Email Variations":be()}),!le&&t.jsxs("p",{className:"text-xs text-gray-600 font-medium",children:[o," - ",s]})]})]}),t.jsx("button",{onClick:X,className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-400 hover:text-gray-600 hover:bg-white/50 transition-all duration-200 group",children:t.jsx("svg",{className:"w-5 h-5 group-hover:rotate-90 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),le&&a==="linkedin"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Existing"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm usually in touch with teams managing residential projects and leasing, so I was just curious how you manage bookings, rentals, and property maintenance across your units."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I mostly connect with people working in residential and leasing rolesit keeps me close to how things really move on a day-to-day basis."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"The world today feels like one connected marketplace, and being part of the real estate ecosystem, I enjoy connecting with people who are building and managing things on the ground. Looking forward to connecting and exchanging perspectives."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I've noticed that no two property teams manage bookings, rentals, and maintenance the same way. I'm always interested in hearing how others handle it in practice."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Always open to exchanging thoughts and learning how things are shaping up on your side. Would be great to stay connected."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We work closely with property teams to simplify how day-to-day operations are managed  from rentals and billing to maintenance  so things feel more connected and easier to handle."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Everyday operational conversations around properties quietly offer the most value in understanding how things really work."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Enjoy grounded conversations around real work and real challenges. Happy to stay connected and exchange insights whenever it makes sense."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We believe real value often comes from reducing small operational frictions and giving teams better visibility into what's happening across their properties."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm always interested in seeing how teams optimize their workflowsdo you have any strategies that make managing bookings and maintenance simpler?"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I value thoughtful conversations with people close to the work. Whenever it feels right, I'd enjoy exchanging insights as things evolve on your side."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"No worries if you didn't catch my earlier message. Just checking if you're up for a chat about possible ways we can team up and grow together."})]})]})]})})})}):le&&a==="email"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300 w-[15%]",children:"Email"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 4"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I work closely with people involved in residential projects and leasing, and I enjoy staying connected with those who are close to the day-to-day side of property work."}),t.jsx("p",{children:"At Terabits, we focus on making everyday property operations a little easier by keeping rentals, billing, and maintenance in one place."}),t.jsx("p",{children:"Happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working close to residential projects and leasing. I've found those conversations tend to be the most honest and practical."}),t.jsx("p",{children:"I'm part of the Terabits team, where we focus on making everyday property operations easier to manage."}),t.jsx("p",{children:"Nice to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"font-semibold",children:"Subject: Exchanging notes on leasing & residential work"}),t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working on residential projects and leasing. I've found these conversations to be the most practical."}),t.jsx("p",{children:'When it comes to daily management, where do you usually find the most friction or "extra work" in your current process?'})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I tend to reach out to people in residential leasing because the conversations are usually more practical."}),t.jsx("p",{children:`I'm curiouswhen it comes to your daily management, where do things usually get stuck or feel like a "headache" for your team?`}),t.jsx("p",{children:"Nice to connect,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just wanted to follow up on my last note."}),t.jsx("p",{children:"We usually speak with property teams who want a bit more clarity in their daily workflows without changing how they already operate."}),t.jsx("p",{children:"Always good to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just sharing a short follow-up."}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing without adding extra complexity to daily work."}),t.jsx("p",{children:"Happy to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing."}),t.jsx("p",{children:"This is where Terabits usually steps inwe focus on making those everyday operations feel less like a chore so you can focus on the bigger picture."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"That's usually where we come in. At Terabits, we focus on making those messy partslike rentals, maintenance, and billingfeel a lot more manageable."}),t.jsx("p",{children:"We try to keep the tech simple so it actually helps the team instead of adding more work to their day."}),t.jsx("p",{children:"Happy to stay in touch,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing we often notice is that small improvements in visibility can make day-to-day property work feel much more manageable."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that even small clarity in systems can make a big difference in day-to-day property operations."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that small clarity in systems makes a big difference."}),t.jsx("p",{children:"Specifically, we help by automating the repetitive stufflike tracking maintenance requests or streamlining billing workflowswithout adding extra complexity to your day-to-day work."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I've noticed is that just adding a bit of clarity to maintenance tracking or billing can save a lot of hours."}),t.jsx("p",{children:"We mostly help by automating those repetitive tasks so they just happen in the background. It's a small change that usually makes the day-to-day much smoother."}),t.jsx("p",{children:"Thought I'd share that."})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here for now."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Wishing you a great week ahead."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Take care."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here as I don't want to crowd your inbox."}),t.jsx("p",{children:"If you ever want to swap notes on how to make property workflows easier, I'm always happy to chat."}),t.jsx("p",{children:"Wishing you the best,"})]})})]})]})]})})})}):t.jsx("form",{onSubmit:H,className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsxs("div",{className:"space-y-4",children:[a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Phone Number ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("input",{type:"tel",value:M.phoneNumber,onChange:Q=>De("phoneNumber",Q.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:J.phone||v?"":"Add phone number (e.g., +1 234-567-8900)"})]}),m&&t.jsx("button",{type:"button",onClick:()=>je("phone",M.phoneNumber,"firstPhone"),disabled:ge.phone,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database",children:ge.phone?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),(J.phone||v)&&t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),J.phone?`Saved in database: ${J.phone}`:`Fetched from database: ${v}`]})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Address ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("input",{type:"email",value:M.email,onChange:Q=>De("email",Q.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:J.email||w?"":"Add email address (e.g., contact@example.com)"})]}),m&&t.jsx("button",{type:"button",onClick:()=>je("email",M.email,"email"),disabled:ge.email,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database",children:ge.email?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),(J.email||w)&&t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),J.email?`Saved in database: ${J.email}`:`Fetched from database: ${w}`]})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:M.emailDate,onChange:Q=>De("emailDate",Q.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:"Select email date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the email was sent"]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Profile URL ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("input",{type:"url",value:M.linkedInUrl,onChange:Q=>De("linkedInUrl",Q.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:J.linkedin||N?"":"Add LinkedIn profile URL (e.g., https://linkedin.com/in/username)"})]}),m&&t.jsx("button",{type:"button",onClick:()=>je("linkedin",M.linkedInUrl,"personLinkedinUrl"),disabled:ge.linkedin,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database",children:ge.linkedin?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),(J.linkedin||N)&&t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),J.linkedin?t.jsxs(t.Fragment,{children:["Saved in database: ",t.jsx("a",{href:J.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:J.linkedin})]}):t.jsxs(t.Fragment,{children:["Fetched from database: ",t.jsx("a",{href:N,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:N})]})]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:M.linkedinDate,onChange:Q=>De("linkedinDate",Q.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:"Select LinkedIn date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the LinkedIn activity occurred"]})]}),a!=="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700",children:"Select Template (Optional)"}),(a==="linkedin"||a==="email")&&t.jsxs("button",{type:"button",onClick:()=>ze(!0),className:"px-3 py-1.5 text-xs font-semibold text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-all duration-200 flex items-center gap-1.5",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a==="email"?"View Email Variations":"View Message Variations"]})]}),t.jsxs("select",{value:M.template,onChange:Q=>De("template",Q.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"no-template",children:"No Template"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"introduction-email",children:"Introduction Email"}),t.jsx("option",{value:"follow-up-email",children:"Follow-up Email"}),t.jsx("option",{value:"value-proposition-email",children:"Value Proposition Email"})]}):a==="linkedin"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"connection-request-message",children:"Connection Request Message"}),t.jsx("option",{value:"introduction-message",children:"Introduction Message"}),t.jsx("option",{value:"follow-up-message",children:"Follow-up Message"})]}):null]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Use a pre-defined template for consistency"]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Account Used ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsxs("select",{value:M.linkedInAccountName,onChange:Q=>De("linkedInAccountName",Q.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select LinkedIn account"}),me.map((Q,we)=>t.jsx("option",{value:Q,children:Q},we))]})]}),t.jsx("button",{type:"button",onClick:()=>fe(!ke),className:"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors whitespace-nowrap",children:ke?"Cancel":"+ Add"})]}),ke&&t.jsxs("div",{className:"mt-3 flex gap-2",children:[t.jsx("input",{type:"text",value:ce,onChange:Q=>ye(Q.target.value),onKeyPress:Q=>{Q.key==="Enter"&&(Q.preventDefault(),Ye())},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter new LinkedIn account name"}),t.jsx("button",{type:"button",onClick:Ye,disabled:!ce.trim()||me.includes(ce.trim()),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Add"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select or add a LinkedIn account that sent the connection request"]})]}),a==="linkedin"&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Ln Request Sent ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.lnRequestSent,onChange:Q=>De("lnRequestSent",Q.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"}),t.jsx("option",{value:"Existing Connect",children:"Existing Connect"}),t.jsx("option",{value:"Inactive Profile",children:"Inactive Profile"}),t.jsx("option",{value:"Irrelevant Profile",children:"Irrelevant Profile"}),t.jsx("option",{value:"Open to Work",children:"Open to Work"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status of the LinkedIn connection request"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Connected ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.connected,onChange:Q=>De("connected",Q.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Whether the connection was established"]})]})]}),(a==="email"||a==="linkedin")&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.status,onChange:Q=>De("status",Q.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 ${O.status?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select status"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Out of Office",children:"Out of Office"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Wrong Person",children:"Wrong Person"}),t.jsx("option",{value:"Bounce",children:"Bounce"}),t.jsx("option",{value:"Opt-Out",children:"Opt-Out"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"})]}):t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"CIP",children:"CIP"}),t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"In-Person Meeting",children:"In-Person Meeting"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"}),t.jsx("option",{value:"SQL",children:"SQL"}),t.jsx("option",{value:"Tech Discussion",children:"Tech Discussion"}),t.jsx("option",{value:"WON",children:"WON"}),t.jsx("option",{value:"Lost",children:"Lost"}),t.jsx("option",{value:"Low Potential - Open",children:"Low Potential - Open"}),t.jsx("option",{value:"Potential Future",children:"Potential Future"})]})]}),O.status&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),O.status]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a==="email"?"Update the contact status based on this email interaction":"Update the contact status based on this interaction"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Call ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsx("div",{children:t.jsxs("select",{value:M.callNumber,onChange:Q=>De("callNumber",Q.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select call number"}),t.jsx("option",{value:"1st call",children:"1st call"}),t.jsx("option",{value:"2nd call",children:"2nd call"}),t.jsx("option",{value:"3rd call",children:"3rd call"}),t.jsx("option",{value:"4th call",children:"4th call"}),t.jsx("option",{value:"5th call",children:"5th call"}),t.jsx("option",{value:"6th call",children:"6th call"}),t.jsx("option",{value:"7th call",children:"7th call"}),t.jsx("option",{value:"8th call",children:"8th call"}),t.jsx("option",{value:"9th call",children:"9th call"}),t.jsx("option",{value:"10th call",children:"10th call"})]})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:M.callDate,onChange:Q=>De("callDate",Q.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:"Select call date"})]})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select which call attempt this is and the date when the call was made"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.callStatus,onChange:Q=>De("callStatus",Q.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select status"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Ring",children:"Ring"}),t.jsx("option",{value:"Busy",children:"Busy"}),t.jsx("option",{value:"Call Back",children:"Call Back"}),t.jsx("option",{value:"Hang Up",children:"Hang Up"}),t.jsx("option",{value:"Switch Off",children:"Switch Off"}),t.jsx("option",{value:"Future",children:"Future"}),t.jsx("option",{value:"Details Shared",children:"Details Shared"}),t.jsx("option",{value:"Demo Booked",children:"Demo Booked"}),t.jsx("option",{value:"Invalid",children:"Invalid"}),t.jsx("option",{value:"Existing",children:"Existing"}),t.jsx("option",{value:"Demo Completed",children:"Demo Completed"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the status of this call"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Conversation Notes ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(optional, but helpful)"})]}),t.jsx("textarea",{value:M.conversationNotes,onChange:Q=>De("conversationNotes",Q.target.value),rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 resize-y font-sans hover:border-gray-400",placeholder:"Document key points, objections, interests, and next steps discussed... (Optional)"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.nextAction,onChange:Q=>De("nextAction",Q.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 ${O.nextAction?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"follow-up-call",children:"Follow-up Call"}),t.jsx("option",{value:"send-proposal",children:"Send Proposal"}),t.jsx("option",{value:"schedule-meeting",children:"Schedule Meeting"}),t.jsx("option",{value:"send-email",children:"Send Email"}),t.jsx("option",{value:"connect-linkedin",children:"Connect on LinkedIn"})]}),O.nextAction&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),O.nextAction]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"What should happen next?"})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action Date ",t.jsx("span",{className:M.nextAction?"text-red-500":"text-gray-400 text-xs font-normal",children:M.nextAction?"*":"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",value:M.nextActionDate,onChange:Q=>De("nextActionDate",Q.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 ${O.nextActionDate?"border-red-300 bg-red-50":"border-gray-300"}`}),t.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]}),O.nextActionDate&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),O.nextActionDate]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"When should this happen?"})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-4 shadow-sm hover:shadow-md transition-all duration-200",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-lg flex items-center justify-center flex-shrink-0 animate-pulse",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-xs font-bold text-blue-900 mb-2",children:"Quality Check Requirements:"}),t.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),t.jsx("span",{children:"Add notes to keep track of what happened during this interaction"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),t.jsx("span",{children:"Next action must be scheduled within 7 days"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),t.jsx("span",{children:"Next Action and Next Action Date are optional"})]})]})]})]})}),O.submit&&t.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-3 animate-shake",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-medium text-red-700",children:O.submit})]})}),t.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-200",children:[t.jsx("button",{type:"button",onClick:X,className:"px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 shadow-sm hover:shadow-md",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:K,className:"px-4 py-2 text-xs font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:hover:scale-100",children:K?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Activity"]})})]})]})})]})})}const Kf=l=>l.type==="call"&&l.callDate?new Date(l.callDate):l.type==="email"&&l.emailDate?new Date(l.emailDate):l.type==="linkedin"&&l.linkedinDate?new Date(l.linkedinDate):new Date(l.createdAt);function qk(){const{id:l}=di(),n=Dr(),[a]=i0(),o=a.get("projectId"),s=a.get("returnTo")||"/projects",[e,m]=B.useState(null),[v,w]=B.useState([]),[N,S]=B.useState(!0),[D,L]=B.useState(null),[M,F]=B.useState("all"),[O,P]=B.useState(!1),[K,ne]=B.useState({name:"",email:"",firstPhone:"",personLinkedinUrl:"",company:""}),[se,Ce]=B.useState(!1),[ge,Ne]=B.useState({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,activityId:null,editMode:!1});B.useEffect(()=>{l&&(J(),oe())},[l]);const J=async()=>{try{const W=await Ut.get(`/contacts/${l}`),H=W.data?.data||W.data;m(H),ne({name:H?.name||"",email:H?.email||"",firstPhone:H?.firstPhone||"",personLinkedinUrl:H?.personLinkedinUrl||H?.companyLinkedinUrl||"",company:H?.company||""})}catch(W){console.error("Error fetching contact:",W),L("Couldn't load the contact details. Try refreshing the page.")}},de=()=>{P(!0)},le=()=>{P(!1),e&&ne({name:e.name||"",email:e.email||"",firstPhone:e.firstPhone||"",personLinkedinUrl:e.personLinkedinUrl||e.companyLinkedinUrl||"",company:e.company||""})},ze=async()=>{if(l){Ce(!0);try{const W={name:K.name.trim(),email:K.email.trim(),firstPhone:K.firstPhone.trim(),personLinkedinUrl:K.personLinkedinUrl.trim(),company:K.company.trim()},H=await Ut.put(`/contacts/${l}`,W);H.data.success&&(m(H.data.data),P(!1),oe())}catch(W){console.error("Error updating contact:",W),alert(W.response?.data?.error||"Couldn't save those changes. Give it another try.")}finally{Ce(!1)}}},me=(W,H)=>{ne(X=>({...X,[W]:H}))},oe=async()=>{try{S(!0);const W=await Ut.get(`/activities/contact/${l}`);W.data.success&&w(W.data.data||[]),L(null)}catch(W){console.error("Error fetching activities:",W),L("Having trouble loading the activity history. Refresh the page and try again.")}finally{S(!1)}},ce=(W,H=null)=>{e&&Ne({isOpen:!0,type:H?H.type:W,contactName:e.name||"N/A",companyName:e.company||"",projectId:H?H.projectId?._id||H.projectId:o||null,contactId:l,phoneNumber:e.firstPhone||null,email:e.email||null,linkedInProfileUrl:e.personLinkedinUrl||e.companyLinkedinUrl||null,activityId:H?H._id:null,editMode:!!H})},ye=(W=!1)=>{Ne({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,activityId:null,editMode:!1}),W&&s?setTimeout(()=>{n(s)},100):oe()},ke=W=>{if(!W)return"?";const H=W.trim().split(/\s+/);return H.length>=2?(H[0][0]+H[H.length-1][0]).toUpperCase():W.substring(0,2).toUpperCase()},fe=W=>{if(!W)return"N/A";const H=W instanceof Date?W:new Date(W);return isNaN(H.getTime())?"N/A":H.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},Se=W=>{if(!W)return"N/A";const H=W instanceof Date?W:new Date(W);return isNaN(H.getTime())?"N/A":H.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},Ye=W=>{switch(W){case"call":return t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-md",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-md",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center shadow-md",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},te=W=>{switch(W){case"call":return"Call";case"email":return"Email";case"linkedin":return"LinkedIn";default:return"Activity"}},pe=v.filter(W=>M==="all"?!0:W.type===M).sort((W,H)=>Kf(H)-Kf(W)),V=v.filter(W=>W.type==="call"),be=v.filter(W=>W.type==="email"),_e=v.filter(W=>W.type==="linkedin"),De=W=>{const X={"connected-had-conversation":{bg:"bg-green-100",text:"text-green-800",label:"Connected"},"left-voicemail":{bg:"bg-blue-100",text:"text-blue-800",label:"Voicemail"},"no-answer":{bg:"bg-gray-100",text:"text-gray-800",label:"No Answer"},"email-sent-successfully":{bg:"bg-green-100",text:"text-green-800",label:"Sent"},"received-reply":{bg:"bg-purple-100",text:"text-purple-800",label:"Reply Received"},"connection-request-sent":{bg:"bg-blue-100",text:"text-blue-800",label:"Request Sent"},"message-sent":{bg:"bg-green-100",text:"text-green-800",label:"Message Sent"}}[W]||{bg:"bg-gray-100",text:"text-gray-800",label:W};return t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${X.bg} ${X.text}`,children:X.label})};return N?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse"}),t.jsx("div",{className:"relative animate-spin rounded-full h-14 w-14 border-2 border-gray-200 border-t-gray-900 mx-auto"})]}),t.jsx("p",{className:"tracking-wide text-sm uppercase text-gray-500 font-medium",children:"Loading activity history..."})]})}):D&&!e?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[t.jsx("div",{className:"w-20 h-20 mx-auto bg-red-100 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-10 h-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Contact"}),t.jsx("p",{className:"text-gray-600 mb-6",children:D}),t.jsxs("button",{onClick:()=>n(s),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})]})]})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8",children:[t.jsx("nav",{className:"mb-6 animate-fade-in-down",children:t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[t.jsxs("button",{onClick:()=>n(s),className:"hover:text-gray-900 transition-colors duration-200 flex items-center gap-1.5 font-medium",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),t.jsx("span",{children:"Back"})]}),t.jsx("svg",{className:"w-4 h-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),t.jsx("span",{className:"text-gray-700 font-semibold",children:"Activity History"})]})}),t.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-2xl border border-gray-200 shadow-lg p-6 lg:p-8 animate-fade-in-up",children:t.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:items-start gap-6 lg:gap-8",children:[t.jsxs("div",{className:"relative flex-shrink-0",children:[t.jsx("div",{className:"w-20 h-20 lg:w-24 lg:h-24 bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center text-2xl lg:text-3xl font-bold text-white shadow-xl ring-4 ring-blue-50 transform hover:scale-105 transition-transform duration-200",children:e?ke(e.name):"?"}),t.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-4 border-white shadow-md"})]}),t.jsx("div",{className:"flex-1 min-w-0 w-full lg:w-auto text-center lg:text-left",children:O?t.jsxs("div",{className:"space-y-4 w-full max-w-2xl",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),t.jsx("input",{type:"text",value:K.name,onChange:W=>me("name",W.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Contact name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),t.jsx("input",{type:"text",value:K.company,onChange:W=>me("company",W.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Company name"})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),t.jsx("input",{type:"email",value:K.email,onChange:W=>me("email",W.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"email@example.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),t.jsx("input",{type:"tel",value:K.firstPhone,onChange:W=>me("firstPhone",W.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+1234567890"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LinkedIn URL"}),t.jsx("input",{type:"url",value:K.personLinkedinUrl,onChange:W=>me("personLinkedinUrl",W.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://linkedin.com/in/..."})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:ze,disabled:se,className:"px-6 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:se?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})}),t.jsx("button",{onClick:le,disabled:se,className:"px-6 py-2 bg-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-300 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-2 tracking-tight",children:e?.name||"Contact"}),e?.company&&t.jsx("p",{className:"text-gray-600 text-lg lg:text-xl font-medium",children:e.company})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-center sm:items-center justify-center lg:justify-start gap-4 text-gray-600 text-sm",children:[e?.email&&t.jsxs("a",{href:`mailto:${e.email}`,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-50 hover:bg-blue-50 rounded-lg transition-colors duration-200 border border-gray-200 hover:border-blue-200 group",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{className:"font-medium",children:e.email})]}),e?.firstPhone&&t.jsxs("a",{href:`tel:${e.firstPhone}`,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-50 hover:bg-green-50 rounded-lg transition-colors duration-200 border border-gray-200 hover:border-green-200 group",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-green-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{className:"font-medium",children:e.firstPhone})]}),e?.personLinkedinUrl&&t.jsxs("a",{href:e.personLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-1.5 bg-gray-50 hover:bg-blue-50 rounded-lg transition-colors duration-200 border border-gray-200 hover:border-blue-200 group",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("span",{className:"font-medium",children:"LinkedIn"})]})]})]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full lg:w-auto",children:[!O&&t.jsxs("button",{onClick:de,className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white font-semibold text-sm rounded-xl hover:from-gray-700 hover:to-gray-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),t.jsx("span",{children:"Edit Contact"})]}),!O&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>ce("call"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white font-semibold text-sm rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{children:"Log Call"})]}),t.jsxs("button",{onClick:()=>ce("email"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold text-sm rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{children:"Log Email"})]}),t.jsxs("button",{onClick:()=>ce("linkedin"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-700 to-indigo-700 text-white font-semibold text-sm rounded-xl hover:from-blue-800 hover:to-indigo-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("span",{children:"Log LinkedIn"})]})]})]})]})})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-10",children:[D&&t.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 text-red-700 px-5 py-4 rounded-xl shadow-md animate-shake",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),t.jsx("span",{className:"font-medium",children:D})]})}),v.length>0&&t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-8",children:[t.jsx("div",{onClick:()=>F("all"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="all"?"from-blue-500 to-blue-600 border-blue-400 text-white":"from-white to-blue-50 border-blue-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="all"?"text-blue-100":"text-gray-600"}`,children:"Total Activities"}),t.jsx("p",{className:`text-3xl font-bold ${M==="all"?"text-white":"text-gray-900"}`,children:v.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="all"?"text-blue-100":"text-gray-500"}`,children:"All interactions"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="all"?"bg-white bg-opacity-20":"bg-gradient-to-br from-blue-500 to-blue-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})]})}),t.jsx("div",{onClick:()=>F("call"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="call"?"from-green-500 to-green-600 border-green-400 text-white":"from-white to-green-50 border-green-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="call"?"text-green-100":"text-gray-600"}`,children:"Calls"}),t.jsx("p",{className:`text-3xl font-bold ${M==="call"?"text-white":"text-gray-900"}`,children:V.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="call"?"text-green-100":"text-gray-500"}`,children:"Phone interactions"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="call"?"bg-white bg-opacity-20":"bg-gradient-to-br from-green-500 to-green-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]})}),t.jsx("div",{onClick:()=>F("email"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="email"?"from-blue-500 to-blue-600 border-blue-400 text-white":"from-white to-blue-50 border-blue-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="email"?"text-blue-100":"text-gray-600"}`,children:"Emails"}),t.jsx("p",{className:`text-3xl font-bold ${M==="email"?"text-white":"text-gray-900"}`,children:be.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="email"?"text-blue-100":"text-gray-500"}`,children:"Email outreach"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="email"?"bg-white bg-opacity-20":"bg-gradient-to-br from-blue-500 to-blue-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]})}),t.jsx("div",{onClick:()=>F("linkedin"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="linkedin"?"from-indigo-500 to-indigo-600 border-indigo-400 text-white":"from-white to-indigo-50 border-indigo-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="linkedin"?"text-indigo-100":"text-gray-600"}`,children:"LinkedIn"}),t.jsx("p",{className:`text-3xl font-bold ${M==="linkedin"?"text-white":"text-gray-900"}`,children:_e.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="linkedin"?"text-indigo-100":"text-gray-500"}`,children:"LinkedIn activities"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="linkedin"?"bg-white bg-opacity-20":"bg-gradient-to-br from-indigo-500 to-indigo-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})})]})}),(()=>{const W=v.filter(we=>we.type==="linkedin"&&we.status),H=W.length>0?W.sort((we,Fe)=>Kf(Fe)-Kf(we))[0].status:null;if(!H)return null;const X=we=>{switch(we){case"CIP":return"from-white to-blue-50 border-blue-200";case"No Reply":return"from-white to-gray-50 border-gray-200";case"Not Interested":return"from-white to-red-50 border-red-200";case"Meeting Proposed":return"from-white to-yellow-50 border-yellow-200";case"Meeting Scheduled":return"from-white to-cyan-50 border-cyan-200";case"In-Person Meeting":return"from-white to-indigo-50 border-indigo-200";case"Meeting Completed":return"from-white to-green-50 border-green-200";case"SQL":return"from-white to-emerald-50 border-emerald-200";case"Tech Discussion":return"from-white to-purple-50 border-purple-200";case"WON":return"from-white to-green-100 border-green-400 border-2";case"Lost":return"from-white to-red-100 border-red-400 border-2";case"Low Potential - Open":return"from-white to-orange-50 border-orange-200";case"Potential Future":return"from-white to-teal-50 border-teal-200";default:return"from-white to-gray-50 border-gray-200"}},je=we=>{switch(we){case"CIP":return"text-blue-800";case"No Reply":return"text-gray-800";case"Not Interested":return"text-red-800";case"Meeting Proposed":return"text-yellow-800";case"Meeting Scheduled":return"text-cyan-800";case"In-Person Meeting":return"text-indigo-800";case"Meeting Completed":return"text-green-800";case"SQL":return"text-emerald-800";case"Tech Discussion":return"text-purple-800";case"WON":return"text-green-900";case"Lost":return"text-red-900";case"Low Potential - Open":return"text-orange-800";case"Potential Future":return"text-teal-800";default:return"text-gray-800"}},Q=we=>{switch(we){case"CIP":return"bg-blue-100 border-blue-200";case"No Reply":return"bg-gray-100 border-gray-200";case"Not Interested":return"bg-red-100 border-red-200";case"Meeting Proposed":return"bg-yellow-100 border-yellow-200";case"Meeting Scheduled":return"bg-cyan-100 border-cyan-200";case"In-Person Meeting":return"bg-indigo-100 border-indigo-200";case"Meeting Completed":return"bg-green-100 border-green-200";case"SQL":return"bg-emerald-100 border-emerald-200";case"Tech Discussion":return"bg-purple-100 border-purple-200";case"WON":return"bg-green-200 border-green-400 border-2";case"Lost":return"bg-red-200 border-red-400 border-2";case"Low Potential - Open":return"bg-orange-100 border-orange-200";case"Potential Future":return"bg-teal-100 border-teal-200";default:return"bg-gray-100 border-gray-200"}};return t.jsx("div",{className:`bg-gradient-to-br ${X(H)} rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-shadow duration-200`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-semibold uppercase tracking-wide mb-1",children:"Current Status"}),t.jsx("p",{className:`text-2xl font-bold ${je(H)} mb-1`,children:H}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Latest LinkedIn activity"})]}),t.jsx("div",{className:`w-14 h-14 ${Q(H)} rounded-xl flex items-center justify-center shadow-lg`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})})]})})})()]}),v.length>0&&t.jsx("div",{className:"mb-6 bg-white rounded-2xl border border-gray-200 shadow-lg p-2",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs("button",{onClick:()=>F("all"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="all"?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"All (",v.length,")"]}),t.jsxs("button",{onClick:()=>F("call"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="call"?"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Calls (",V.length,")"]}),t.jsxs("button",{onClick:()=>F("email"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="email"?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Emails (",be.length,")"]}),t.jsxs("button",{onClick:()=>F("linkedin"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="linkedin"?"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),"LinkedIn (",_e.length,")"]})]})}),v.length===0?t.jsxs("div",{className:"text-center py-20 bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-lg border border-gray-200 animate-fade-in",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-2xl bg-gradient-to-br from-gray-100 to-gray-200 mb-6 shadow-inner",children:t.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),t.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No activities yet"}),t.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto text-lg",children:"Start logging activities to track your interactions with this contact and build a comprehensive engagement history."}),t.jsx("div",{className:"flex justify-center gap-3",children:t.jsxs("button",{onClick:()=>ce("call"),className:"inline-flex items-center gap-2 px-6 py-3.5 bg-gradient-to-r from-green-600 to-green-700 text-white font-semibold rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-100",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Log First Activity"]})})]}):t.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-lg overflow-hidden",children:[t.jsx("div",{className:"px-6 lg:px-8 py-5 bg-gradient-to-r from-gray-50 to-white border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Activity Timeline"}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Complete interaction history with ",e?.name]})]}),t.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-3 py-1.5 bg-blue-50 rounded-lg border border-blue-100",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("span",{className:"text-xs font-semibold text-blue-700",children:[v.length," ",v.length===1?"activity":"activities"]})]})]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:pe.length===0?t.jsxs("div",{className:"text-center py-16",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gray-100 mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:["No ",M==="all"?"":M," activities found"]}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Try selecting a different filter or log a new activity."}),t.jsxs("button",{onClick:()=>{ce({call:"call",email:"email",linkedin:"linkedin"}[M]||"call")},className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Log ",M==="all"?"Activity":M.charAt(0).toUpperCase()+M.slice(1)]})]}):pe.map((W,H)=>t.jsx("div",{className:"p-6 lg:p-8 hover:bg-gradient-to-r hover:from-gray-50 hover:to-white transition-all duration-200 group",children:t.jsxs("div",{className:"flex gap-5 lg:gap-6",children:[t.jsxs("div",{className:"flex-shrink-0 relative",children:[Ye(W.type),H<v.length-1&&t.jsx("div",{className:"absolute top-12 left-1/2 transform -translate-x-1/2 w-0.5 h-full bg-gradient-to-b from-gray-200 to-transparent"})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"flex items-start justify-between gap-4 mb-3",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:te(W.type)}),De(W.outcome),W.status&&(W.type==="linkedin"||W.type==="email")&&t.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${W.status==="CIP"?"bg-blue-100 text-blue-800":W.status==="No Reply"?"bg-gray-100 text-gray-800":W.status==="Not Interested"?"bg-red-100 text-red-800":W.status==="Meeting Proposed"?"bg-yellow-100 text-yellow-800":W.status==="Meeting Scheduled"?"bg-cyan-100 text-cyan-800":W.status==="In-Person Meeting"?"bg-indigo-100 text-indigo-800":W.status==="Meeting Completed"?"bg-green-100 text-green-800":W.status==="SQL"?"bg-emerald-100 text-emerald-800":W.status==="Tech Discussion"?"bg-purple-100 text-purple-800":W.status==="WON"?"bg-green-200 text-green-900 border-2 border-green-400":W.status==="Lost"?"bg-red-200 text-red-900 border-2 border-red-400":W.status==="Low Potential - Open"?"bg-orange-100 text-orange-800":W.status==="Potential Future"?"bg-teal-100 text-teal-800":W.status==="Interested"?"bg-green-100 text-green-800":W.status==="Wrong Person"?"bg-orange-100 text-orange-800":W.status==="Bounce"?"bg-red-100 text-red-800":W.status==="Opt-Out"?"bg-gray-100 text-gray-800":W.status==="Out of Office"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:W.status})]}),t.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("span",{className:"font-medium",children:Se(Kf(W))})]}),W.projectId?.companyName&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-gray-300",children:""}),t.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 rounded-md text-xs font-medium",children:W.projectId.companyName})]})]})]})}),W.type==="call"&&(W.callNumber||W.callDate||W.callStatus)&&t.jsx("div",{className:"mb-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm",children:t.jsxs("div",{className:"flex flex-wrap gap-4",children:[W.callNumber&&t.jsxs("div",{className:"flex-1 min-w-[120px]",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Call"})]}),t.jsx("p",{className:"text-sm font-medium text-green-800",children:W.callNumber})]}),W.callDate&&t.jsxs("div",{className:"flex-1 min-w-[120px]",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Call Date"})]}),t.jsx("p",{className:"text-sm font-medium text-green-800",children:new Date(W.callDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),W.callStatus&&t.jsxs("div",{className:"flex-1 min-w-[120px]",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Status"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${W.callStatus==="Interested"?"bg-green-100 text-green-800":W.callStatus==="Not Interested"?"bg-red-100 text-red-800":W.callStatus==="Ring"?"bg-gray-100 text-gray-800":W.callStatus==="Busy"?"bg-blue-100 text-blue-800":W.callStatus==="Call Back"?"bg-purple-100 text-purple-800":W.callStatus==="Hang Up"?"bg-pink-100 text-pink-800":W.callStatus==="Switch Off"?"bg-amber-100 text-amber-800":W.callStatus==="Future"?"bg-indigo-100 text-indigo-800":W.callStatus==="Details Shared"?"bg-yellow-100 text-yellow-800":W.callStatus==="Demo Booked"?"bg-cyan-100 text-cyan-800":W.callStatus==="Invalid"?"bg-gray-100 text-gray-800":W.callStatus==="Existing"?"bg-orange-100 text-orange-800":(W.callStatus==="Demo Completed","bg-gray-100 text-gray-800")}`,children:W.callStatus})]})]})}),W.type==="linkedin"&&W.linkedInAccountName&&t.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wide",children:"LinkedIn Account Used"})]}),t.jsx("p",{className:"text-sm font-medium text-blue-800",children:W.linkedInAccountName})]}),W.type==="email"&&W.status&&t.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wide",children:"Status"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${W.status==="No Reply"?"bg-gray-100 text-gray-800":W.status==="Not Interested"?"bg-red-100 text-red-800":W.status==="Meeting Proposed"?"bg-yellow-100 text-yellow-800":W.status==="Meeting Scheduled"?"bg-cyan-100 text-cyan-800":W.status==="Meeting Completed"||W.status==="Interested"?"bg-green-100 text-green-800":W.status==="Wrong Person"?"bg-orange-100 text-orange-800":W.status==="Bounce"?"bg-red-100 text-red-800":W.status==="Opt-Out"?"bg-gray-100 text-gray-800":W.status==="Out of Office"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:W.status})]}),W.type==="linkedin"&&(W.lnRequestSent||W.connected)&&t.jsxs("div",{className:"mb-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[W.lnRequestSent&&t.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-semibold text-purple-900 uppercase tracking-wide",children:"Ln Request Sent"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${W.lnRequestSent==="Yes"?"bg-green-100 text-green-800":W.lnRequestSent==="No"?"bg-red-100 text-red-800":W.lnRequestSent==="Existing Connect"?"bg-blue-100 text-blue-800":W.lnRequestSent==="Inactive Profile"?"bg-gray-100 text-gray-800":W.lnRequestSent==="Irrelevant Profile"?"bg-orange-100 text-orange-800":W.lnRequestSent==="Open to Work"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:W.lnRequestSent})]}),W.connected&&t.jsxs("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Connected"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${W.connected==="Yes"?"bg-green-100 text-green-800":W.connected==="No"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:W.connected})]})]}),W.conversationNotes&&(()=>{const je=W.conversationNotes.replace(/\[Contact:.*?\|.*?Email:.*?\|.*?Phone:.*?\|.*?LinkedIn:.*?\]/g,"").trim().replace(/\[Contact:.*?\]/g,"").trim();return je?t.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-xl border border-gray-100",children:t.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap leading-relaxed",children:je})}):null})(),W.nextAction&&t.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm",children:[t.jsx("div",{className:"flex-shrink-0 mt-0.5",children:t.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-semibold text-blue-900 mb-1",children:["Next Action: ",t.jsx("span",{className:"font-bold",children:W.nextAction})]}),W.nextActionDate&&t.jsxs("p",{className:"text-xs text-blue-700 font-medium",children:["Scheduled for ",fe(W.nextActionDate)]})]})]}),t.jsx("div",{className:"mt-4 flex justify-end",children:t.jsxs("button",{onClick:()=>ce(null,W),className:`inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg hover:bg-opacity-90 transition-all duration-200 ${W.type==="call"?"text-green-700 bg-green-50 border border-green-200 hover:bg-green-100 hover:border-green-300":W.type==="email"?"text-blue-700 bg-blue-50 border border-blue-200 hover:bg-blue-100 hover:border-blue-300":"text-indigo-700 bg-indigo-50 border border-indigo-200 hover:bg-indigo-100 hover:border-indigo-300"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]})})]})]})},W._id||H))})]})]}),t.jsx(Nv,{isOpen:ge.isOpen,onClose:ye,type:ge.type,contactName:ge.contactName,companyName:ge.companyName,projectId:ge.projectId,contactId:ge.contactId,phoneNumber:ge.phoneNumber,email:ge.email,linkedInProfileUrl:ge.linkedInProfileUrl,activityId:ge.activityId,editMode:ge.editMode})]})}function Yk(){const{companyName:l}=di(),n=Dr(),[a]=i0(),o=a.get("category")||"IND-IT & Service",[s,e]=B.useState([]),[m,v]=B.useState(!0),[w,N]=B.useState(null),[S,D]=B.useState(null),[L,M]=B.useState(!1),[F,O]=B.useState(null),P=decodeURIComponent(l);B.useEffect(()=>{K()},[P,o]);const K=async()=>{try{v(!0);const de={category:o,page:1,limit:1e3},le=await Ut.get("/contacts",{params:de}),ze=le?.data?.data||le?.data||[],me=Array.isArray(ze)?ze.filter(oe=>(oe.company||"No Company")===P):[];e(me),N(null)}catch(de){N("Failed to fetch company contacts. Please try again."),console.error("Error fetching contacts:",de)}finally{v(!1)}},ne=de=>{if(!de)return"?";const le=de.trim().split(/\s+/);return le.length>=2?(le[0][0]+le[1][0]).toUpperCase():de.substring(0,2).toUpperCase()},se=de=>de?(de=de.replace(/^#{1,6}\s+/gm,""),de=de.replace(/\*\*([^*]+)\*\*/g,"$1"),de=de.replace(/__([^_]+)__/g,"$1"),de=de.replace(/\*([^*]+)\*/g,"$1"),de=de.replace(/_([^_]+)_/g,"$1"),de=de.replace(/^[\s]*[-*+]\s+/gm," "),de=de.replace(/^\d+\.\s+/gm,""),de=de.replace(/\n{3,}/g,`

`),de=de.trim(),de):"",Ce=de=>{const le=`?category=${encodeURIComponent(o)}`;n(`/contacts/${de}${le}`)},ge=()=>{const de=`?category=${encodeURIComponent(o)}`;n(`/contacts${de}`)},Ne=async()=>{if(!J?.website){O("Website URL is required for analysis");return}try{M(!0),O(null);const de=await Ut.post("/company-analysis/analyze",{companyName:P,website:J.website});de.data.success?D(de.data.data):O(de.data.error||"Failed to analyze company")}catch(de){console.error("Error analyzing company:",de),console.error("Error response:",de?.response),console.error("Error status:",de?.response?.status),console.error("Error data:",de?.response?.data);let le="Failed to analyze company website. Please try again.";de?.response?.status===429?le=de?.response?.data?.error||"OpenAI API quota exceeded. Please check your OpenAI account billing and add credits.":de?.response?.status===500?le=de?.response?.data?.error||"Server error. Please check if OpenAI API key is configured.":de?.response?.status===401?le=de?.response?.data?.error||"OpenAI API key is invalid. Please check your configuration.":de?.response?.status===400?le=de?.response?.data?.error||"Invalid request. Please check the company website URL.":de?.code==="ECONNREFUSED"||de?.message?.includes("Network Error")?le="Cannot connect to server. Please make sure the backend is running.":de?.response?.data?.error&&(le=de.response.data.error),O(le)}finally{M(!1)}};if(m)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse"}),t.jsx("div",{className:"relative animate-spin rounded-full h-14 w-14 border-2 border-gray-200 border-t-gray-900 mx-auto"})]}),t.jsx("p",{className:"tracking-wide text-sm uppercase text-gray-500 font-medium",children:"Loading company details..."})]})});if(w)return t.jsx("div",{className:"min-h-screen bg-white py-8",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 text-red-700 px-5 py-4 rounded-lg shadow-md",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),t.jsx("span",{className:"font-medium",children:w})]})})})});const J=s.length>0?s[0]:null;return t.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsxs("button",{onClick:ge,className:"mb-6 flex items-center gap-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Contacts"]}),J?.website&&t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-white text-slate-900 shadow-lg border border-slate-100",children:[t.jsx("div",{className:"absolute inset-0 opacity-60 bg-[radial-gradient(circle_at_20%_20%,_#e0f2ff,_transparent_30%),_radial-gradient(circle_at_85%_15%,_#ede9fe,_transparent_28%)]"}),t.jsxs("div",{className:"relative p-6 lg:p-8 flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm uppercase tracking-wide font-semibold text-blue-700",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Groq AI Insight"]}),t.jsx("h2",{className:"text-3xl font-bold text-slate-900",children:P}),t.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-slate-700",children:[J.website&&t.jsxs("a",{href:J.website.startsWith("http")?J.website:`https://${J.website}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-50 border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition",children:[t.jsxs("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4a8 8 0 100 16 8 8 0 000-16z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2 12h20M12 2c2.5 2.5 4 6 4 10s-1.5 7.5-4 10c-2.5-2.5-4-6-4-10s1.5-7.5 4-10z"})]}),J.website]}),J.companyLinkedinUrl&&t.jsxs("a",{href:J.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-50 border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"LinkedIn"]}),J.email&&t.jsxs("a",{href:`mailto:${J.email}`,className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-50 border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),J.email]})]})]}),t.jsx("div",{className:"flex-shrink-0",children:t.jsx("button",{onClick:Ne,disabled:L,className:"group inline-flex items-center gap-2 px-5 py-3 bg-blue-600 text-white text-sm font-semibold rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-60 disabled:hover:translate-y-0",children:L?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Summarizing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4 text-white group-hover:translate-x-0.5 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Summarize"]})})})]})]}),F&&t.jsx("div",{className:"mt-3 bg-red-50 border border-red-100 text-red-700 px-4 py-3 rounded-xl shadow-sm animate-fade-in",children:t.jsx("p",{className:"text-sm",children:F})}),S&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mt-6 animate-fade-in space-y-6",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-blue-50/30 rounded-2xl border border-slate-200 shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-100/20 rounded-full -mr-16 -mt-16 blur-2xl"}),t.jsxs("div",{className:"relative p-6 h-full flex flex-col",children:[t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("span",{className:"text-xl font-bold text-white",children:"1"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-xs uppercase tracking-wider text-blue-600 font-bold mb-1",children:"Company Overview"}),t.jsx("p",{className:"text-base text-gray-900 font-semibold",children:"Position & Story"})]})]}),t.jsx("div",{className:"flex-1 text-sm text-gray-700 leading-relaxed whitespace-pre-line overflow-y-auto",children:se(S.analysis.companyOverview||S.fullText.split("1)")[1]?.split("2)")[0]?.trim()||"Analysis not available")}),t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Strategic positioning"})]})})]})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-emerald-50/30 rounded-2xl border border-slate-200 shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-100/20 rounded-full -mr-16 -mt-16 blur-2xl"}),t.jsxs("div",{className:"relative p-6 h-full flex flex-col",children:[t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("span",{className:"text-xl font-bold text-white",children:"2"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-xs uppercase tracking-wider text-emerald-600 font-bold mb-1",children:"Core Offering"}),t.jsx("p",{className:"text-base text-gray-900 font-semibold",children:"Products & Value"})]})]}),t.jsx("div",{className:"flex-1 text-sm text-gray-700 leading-relaxed whitespace-pre-line overflow-y-auto",children:se(S.analysis.coreOffering||S.fullText.split("2)")[1]?.split("3)")[0]?.trim()||"Analysis not available")}),t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Value proposition"})]})})]})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-purple-50/30 rounded-2xl border border-slate-200 shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-100/20 rounded-full -mr-16 -mt-16 blur-2xl"}),t.jsxs("div",{className:"relative p-6 h-full flex flex-col",children:[t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("span",{className:"text-xl font-bold text-white",children:"3"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-xs uppercase tracking-wider text-purple-600 font-bold mb-1",children:"Business Considerations"}),t.jsx("p",{className:"text-base text-gray-900 font-semibold",children:"Risks & Opportunities"})]})]}),t.jsx("div",{className:"flex-1 text-sm text-gray-700 leading-relaxed whitespace-pre-line overflow-y-auto",children:se(S.analysis.businessConsiderations||S.fullText.split("3)")[1]?.trim()||"Analysis not available")}),t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),t.jsx("span",{children:"Strategic insights"})]})})]})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-2 mt-4",children:[S.generatedAt&&t.jsxs("div",{className:"text-xs text-gray-500",children:["Generated on ",new Date(S.generatedAt).toLocaleString()]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:Ne,disabled:L,className:"text-sm text-blue-600 hover:text-blue-800 font-semibold",children:"Re-run"}),t.jsx("button",{onClick:()=>{D(null),O(null)},className:"text-sm text-gray-600 hover:text-gray-900",children:"Clear"})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 sticky top-4",children:[t.jsxs("div",{className:"flex flex-col items-center mb-6",children:[t.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-lg flex items-center justify-center mb-4",children:t.jsx("span",{className:"text-3xl font-bold text-blue-700",children:ne(P)})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center mb-2",children:P}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),t.jsxs("span",{children:[s.length," ",s.length===1?"person":"people"]})]})]}),t.jsxs("div",{className:"space-y-4 border-t border-gray-200 pt-6",children:[J?.industry&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Industry"}),t.jsx("p",{className:"text-sm text-gray-900",children:J.industry})]}),(J?.companyAddress||J?.companyCity||J?.companyState||J?.companyCountry)&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Address"}),t.jsx("p",{className:"text-sm text-gray-900",children:[J.companyAddress,J.companyCity,J.companyState,J.companyCountry].filter(Boolean).join(", ")||"Not available"})]}),J?.companyPhone&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Phone"}),t.jsx("a",{href:`tel:${J.companyPhone}`,className:"text-sm text-blue-600 hover:text-blue-700 hover:underline",children:J.companyPhone})]}),J?.website&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Website"}),t.jsx("a",{href:J.website.startsWith("http")?J.website:`https://${J.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 hover:underline",children:J.website})]}),J?.companyLinkedinUrl&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"LinkedIn"}),t.jsxs("a",{href:J.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 hover:underline",children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"View Company LinkedIn"]})]})]})]})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:["People at ",P]}),s.length===0?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"No contacts found for this company."})}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(de=>t.jsxs("div",{onClick:()=>Ce(de._id),className:"bg-gray-50 rounded-lg p-4 border border-gray-200 hover:border-blue-300 hover:shadow-md transition-all cursor-pointer",children:[t.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[t.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-sm font-semibold text-blue-700",children:de.name?de.name.substring(0,2).toUpperCase():"?"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-1 truncate",children:de.name||"Unknown"}),de.title&&t.jsx("p",{className:"text-xs text-gray-600 mb-2 truncate",children:de.title})]})]}),t.jsxs("div",{className:"space-y-2",children:[de.email&&t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("a",{href:`mailto:${de.email}`,onClick:le=>le.stopPropagation(),className:"hover:text-blue-600 hover:underline truncate",children:de.email})]}),de.firstPhone&&t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("a",{href:`tel:${de.firstPhone}`,onClick:le=>le.stopPropagation(),className:"hover:text-blue-600 hover:underline",children:de.firstPhone})]}),(de.personLinkedinUrl||de.companyLinkedinUrl)&&t.jsx("div",{className:"flex items-center gap-2 text-xs",children:t.jsxs("a",{href:de.personLinkedinUrl||de.companyLinkedinUrl,onClick:le=>le.stopPropagation(),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 hover:bg-blue-100 rounded text-xs",children:[t.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"LinkedIn"]})})]})]},de._id))})]})})]})]})})}function Gk(){const[l,n]=B.useState(null),[a,o]=B.useState(!1),[s,e]=B.useState(""),[m,v]=B.useState(""),[w,N]=B.useState(null),[S,D]=B.useState(""),[L,M]=B.useState([]),[F,O]=B.useState(!0),[P,K]=B.useState(!1),[ne,se]=B.useState(""),[Ce,ge]=B.useState(!1);B.useEffect(()=>{Ne()},[]);const Ne=async()=>{try{O(!0);const me=(await Ut.get("/categories")).data?.data||[];M(me),me.length>0&&!S&&D(me[0])}catch(ze){console.error("Error fetching categories:",ze);const me=["IND-IT & Service","Accounting & Book keeping","Web Design & Development","Enterprise Software","Finance Services - IND","E-commerce","CRM","Middle East","International","USA Chicago","IT Company - USA","IT Company - Chicago","Weam.ai Mumbai Data","ERP Software","ERP NEXT- Manufacturing-Automotive Components & Spares","Salon & Spa - Chicago","SPA & SALON AHMEDABAD","kology"];M(me),S||D(me[0])}finally{O(!1)}},J=async()=>{if(!ne.trim()){v("Please enter a category name");return}try{ge(!0),v(""),(await Ut.post("/categories",{name:ne.trim()})).data.success&&(await Ne(),D(ne.trim()),se(""),K(!1),e("Category added successfully!"),setTimeout(()=>e(""),3e3))}catch(ze){v(ze.response?.data?.error||"Failed to add category")}finally{ge(!1)}},de=ze=>{n(ze.target.files?.[0]||null),e(""),v(""),N(null)},le=async()=>{if(!l){v("Please select a CSV or Excel file.");return}const ze=new FormData;ze.append("file",l),ze.append("category",S);try{o(!0),v(""),e(""),N(null);const me=await Ut.post("/import/upload",ze,{headers:{"Content-Type":"multipart/form-data"}});N(me.data.data),e("Import completed successfully")}catch(me){const oe=me?.response?.data?.error||"Upload failed. Please try again.";v(oe)}finally{o(!1)}};return t.jsx("div",{className:"min-h-screen bg-gray-50 py-10",children:t.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Import Contacts"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Upload a CSV or Excel file with the following columns: Name (required), Company (required), Email (required), Person Linkedin Url (required), Title, First Phone, # Employees, Category, Industry, Keywords, Website, Company Linkedin Url, Facebook Url, Twitter Url, City, State, Country, Company Address, Company City, Company State, Company Country, Company Phone, SEO Description, Technologies, Annual Revenue."}),t.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select category to assign"}),t.jsxs("button",{type:"button",onClick:()=>{K(!P),v(""),e("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),P?"Cancel":"Add New"]})]}),P?t.jsx("div",{className:"space-y-2",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:ne,onChange:ze=>se(ze.target.value),placeholder:"Enter new category name",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyDown:ze=>{ze.key==="Enter"&&J()}}),t.jsx("button",{type:"button",onClick:J,disabled:Ce||!ne.trim(),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",children:Ce?"Adding...":"Add"})]})}):t.jsx("select",{value:S,onChange:ze=>D(ze.target.value),disabled:F,className:"border border-gray-300 rounded-lg px-3 py-2 w-full text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:F?t.jsx("option",{children:"Loading categories..."}):L.length===0?t.jsx("option",{children:"No categories available"}):L.map(ze=>t.jsx("option",{value:ze,children:ze},ze))})]}),t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select file (CSV, XLSX, or XLS)"}),t.jsx("input",{type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:de,className:"block w-full text-sm text-gray-700 border border-gray-300 rounded-lg p-2 mb-4"}),t.jsx("button",{onClick:le,disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed",children:a?"Uploading...":"Upload & Import"}),s&&t.jsx("div",{className:"mt-4 p-3 bg-green-50 text-green-700 border border-green-200 rounded",children:s}),m&&t.jsx("div",{className:"mt-4 p-3 bg-red-50 text-red-700 border border-red-200 rounded",children:m}),w&&t.jsxs("div",{className:"mt-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-gray-700",children:"Total Rows:"}),t.jsx("span",{className:"ml-2 text-gray-900",children:w.totalRows})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-gray-700",children:"Valid Contacts:"}),t.jsx("span",{className:"ml-2 text-gray-900",children:w.validContacts})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-green-700",children:"Inserted:"}),t.jsx("span",{className:"ml-2 text-green-900 font-semibold",children:w.inserted})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-orange-700",children:"Skipped (Duplicates):"}),t.jsx("span",{className:"ml-2 text-orange-900 font-semibold",children:w.skipped||0})]})]}),w.columnMapping&&t.jsx("div",{className:"mt-4 space-y-3",children:t.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[t.jsx("div",{className:"text-sm font-semibold text-blue-800 mb-3",children:"Column Mapping Information"}),w.columnMapping.detected&&w.columnMapping.detected.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"text-xs font-semibold text-blue-700 mb-1",children:["Detected Columns (",w.columnMapping.detected.length,"):"]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:w.columnMapping.detected.map((ze,me)=>t.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:ze},me))})]}),w.columnMapping.mapped&&w.columnMapping.mapped.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"text-xs font-semibold text-green-700 mb-1",children:["Successfully Mapped (",w.columnMapping.mapped.length,"):"]}),t.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:w.columnMapping.mapped.map((ze,me)=>t.jsxs("div",{className:"text-xs text-gray-700",children:[t.jsx("span",{className:"font-medium",children:ze.original}),t.jsx("span",{className:"mx-2",children:""}),t.jsx("span",{className:"text-green-700",children:ze.mapped})]},me))})]}),w.columnMapping.unmapped&&w.columnMapping.unmapped.length>0&&t.jsxs("div",{children:[t.jsxs("div",{className:"text-xs font-semibold text-orange-700 mb-1",children:["Unmapped Columns (",w.columnMapping.unmapped.length,"):"]}),t.jsx("div",{className:"text-xs text-orange-600 mb-1",children:"These columns were not recognized and will be ignored."}),t.jsx("div",{className:"flex flex-wrap gap-2",children:w.columnMapping.unmapped.map((ze,me)=>t.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:ze},me))})]})]})}),w.errors&&w.errors.length>0&&t.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsxs("div",{className:"text-sm font-semibold text-yellow-800 mb-2",children:["Warnings & Errors (",w.errors.length,"):"]}),t.jsx("ul",{className:"list-disc list-inside text-sm text-yellow-700 space-y-1 max-h-60 overflow-y-auto",children:w.errors.map((ze,me)=>t.jsx("li",{children:ze},me))})]})]})]})]})})}const Sb={name:"",title:"",company:"",email:"",firstPhone:"",employees:"",category:"IND-IT & Service",industry:"",keywords:"",personLinkedinUrl:"",website:"",companyLinkedinUrl:"",facebookUrl:"",twitterUrl:"",city:"",state:"",country:"",companyAddress:"",companyCity:"",companyState:"",companyCountry:"",companyPhone:"",seoDescription:"",technologies:"",annualRevenue:""};function Kk(){const[l,n]=B.useState(Sb),[a,o]=B.useState(!1),[s,e]=B.useState(""),m=Dr(),v=N=>{const{name:S,value:D}=N.target;n(L=>({...L,[S]:D}))},w=async N=>{if(N.preventDefault(),!l.name.trim()){e("Name is required.");return}try{o(!0),e(""),await Ut.post("/contacts",l),m("/contacts")}catch(S){let D=S?.response?.data?.error||"Failed to save contact.";(S?.response?.status===409||S?.response?.data?.duplicate)&&(D=`Duplicate contact detected: ${D}`),e(D)}finally{o(!1)}};return t.jsx("div",{className:"min-h-screen bg-gray-50 py-10",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Add Contact"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Enter the contact details and save to MongoDB."})]}),t.jsx("button",{onClick:()=>m("/contacts"),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Back to Contacts"})]}),s&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded",children:s}),t.jsxs("form",{onSubmit:w,className:"bg-white shadow rounded-lg p-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[[["name","Name",!0],["title","Title"],["company","Company"],["email","Email",!1,"email"],["firstPhone","First Phone"],["employees","# Employees"],["category","Category"],["industry","Industry"],["keywords","Keywords"],["personLinkedinUrl","Person Linkedin Url"],["website","Website"],["companyLinkedinUrl","Company Linkedin Url"],["facebookUrl","Facebook Url"],["twitterUrl","Twitter Url"],["city","City"],["state","State"],["country","Country"],["companyAddress","Company Address"],["companyCity","Company City"],["companyState","Company State"],["companyCountry","Company Country"],["companyPhone","Company Phone"],["seoDescription","SEO Description"],["technologies","Technologies"],["annualRevenue","Annual Revenue"]].map(([N,S,D,L="text"])=>t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1",children:[S,D?" *":""]}),t.jsx("input",{type:L,name:N,value:l[N],onChange:v,required:D,className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]},N)),t.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3 mt-2",children:[t.jsx("button",{type:"button",onClick:()=>n(Sb),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Reset"}),t.jsx("button",{type:"submit",disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400",children:a?"Saving...":"Save Contact"})]})]})]})})}function Qk(){const l=Dr(),[n,a]=B.useState(""),[o,s]=B.useState([]),[e,m]=B.useState(!0),[v,w]=B.useState(null),[N,S]=B.useState({total:0,totalProspects:0,totalActivities:0,activeProjects:0,meetingRate:0,sqlCount:0,avgActivitiesPerProspect:0}),[D,L]=B.useState(null),[M,F]=B.useState(""),[O,P]=B.useState(""),[K,ne]=B.useState(""),[se,Ce]=B.useState({isOpen:!1,project:null});B.useEffect(()=>{ge(),Ne()},[n,M,O,K]);const ge=async()=>{try{m(!0);const oe={};n&&(oe.search=n),O&&(oe.status=O);const ce=await Ut.get("/projects",{params:oe});if(ce.data.success){const ye=ce.data.data,ke=Array.isArray(ye)?ye:[];let fe=[...ke];K==="active"?fe=fe.filter(te=>te.status==="active"):K==="draft"?fe=fe.filter(te=>te.status==="draft"):K==="completed"&&(fe=fe.filter(te=>te.status==="completed")),s(fe);const Se=ke.reduce((te,pe)=>te+(pe.totalProspects||0),0),Ye=ke.filter(te=>te.status==="active").length;S({total:ke.length,totalProspects:Se,totalActivities:0,activeProjects:Ye,meetingRate:0,sqlCount:0,avgActivitiesPerProspect:0})}}catch(oe){console.error("Error fetching projects:",oe),w("Couldn't load your projects right now. Give it another try in a moment.")}finally{m(!1)}},Ne=async()=>{try{const oe=await Ut.get("/projects/analytics");if(oe.data.success){const ce=oe.data.data;L(ce),S(ye=>({...ye,totalProspects:ce.overview.totalProspects||ye.totalProspects,totalActivities:ce.overview.totalActivities||0,activeProjects:ce.overview.activeProjects||ye.activeProjects,meetingRate:ce.pipeline?.conversion?.meetingRate||0,sqlCount:ce.pipeline?.conversion?.sql||0,avgActivitiesPerProspect:ce.overview.totalProspects>0?parseFloat((ce.overview.totalActivities/ce.overview.totalProspects).toFixed(1)):0}))}}catch(oe){console.error("Error fetching analytics:",oe)}},J=()=>{l("/projects/new")},de=oe=>{l(`/projects/${oe}/edit`)},le=async(oe,ce,ye)=>{oe.stopPropagation();const ke=ye==="active",fe=ke?"draft":"active";try{(await Ut.patch(`/projects/${ce}/status`,{isActive:!ke})).data.success&&s(Ye=>Ye.map(te=>te._id===ce?{...te,status:fe}:te))}catch(Se){console.error("Error toggling project status:",Se),alert("Something went wrong updating the project. Try again in a moment.")}},ze=oe=>oe?new Date(oe).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",me=oe=>{if(!oe)return 0;const{interested:ce=0,cip:ye=0,detailsShared:ke=0,demoBooked:fe=0,demoCompleted:Se=0,meetingProposed:Ye=0,meetingScheduled:te=0,meetingCompleted:pe=0,sql:V=0,won:be=0}=oe;return ce+ye+ke+fe+Se+Ye+te+pe+V+be};return t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Project Management"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Manage your outbound campaigns and track what's working"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{onClick:()=>l("/projects/dashboard"),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-colors font-medium text-sm shadow-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Analytics Dashboard"]}),t.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Project"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Portfolio Size"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.total}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Projects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Prospects"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.totalProspects.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Prospects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full shadow-xs",children:"Activities"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.totalActivities.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Activities"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Projects"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.activeProjects}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Active Projects"})]})]}),t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 mb-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",placeholder:"Search by name, company, email...",value:n,onChange:oe=>a(oe.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),t.jsx("div",{className:"w-64",children:t.jsxs("select",{value:"",onChange:oe=>{oe.target.value&&l(`/projects/${oe.target.value}`)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:[t.jsx("option",{value:"",children:"Select a project..."}),o.map(oe=>t.jsxs("option",{value:oe._id,children:[oe.companyName," - ",oe.contactPerson?.fullName||"N/A"]},oe._id))]})})]})}),v&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:v}),e?t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-12",children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):o.length>0?t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-fixed",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"16%"},children:"Company"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"11%"},children:"Created Date"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"11%"},children:"Assigned To"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"16%"},children:"Contact Person"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"10%"},children:"Total Prospects"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"10%"},children:"Leads Generated"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"10%"},children:"Active"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"14%"},children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(oe=>t.jsxs("tr",{onClick:()=>l(`/projects/${oe._id}`),className:"hover:bg-gray-50 transition-colors cursor-pointer",children:[t.jsxs("td",{className:"px-3 py-4",children:[t.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate",children:oe.companyName||"N/A"}),oe.industry&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:oe.industry})]}),t.jsx("td",{className:"px-3 py-4",children:t.jsx("div",{className:"text-sm text-gray-900",children:ze(oe.createdAt)})}),t.jsx("td",{className:"px-3 py-4 text-sm text-gray-900 truncate",children:oe.assignedTo||"-"}),t.jsxs("td",{className:"px-3 py-4",children:[t.jsx("div",{className:"text-sm text-gray-900 truncate",children:oe.contactPerson?.fullName||"N/A"}),oe.contactPerson?.email&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:oe.contactPerson.email})]}),t.jsx("td",{className:"px-3 py-4",children:t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:oe.totalProspects||0})}),t.jsx("td",{className:"px-3 py-4",children:t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:oe.leadsByStatus?me(oe.leadsByStatus):oe.leadsGenerated||0})}),t.jsx("td",{className:"px-3 py-4",onClick:ce=>ce.stopPropagation(),children:t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:oe.status==="active",onChange:ce=>le(ce,oe._id,oe.status),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})}),t.jsx("td",{className:"px-3 py-4",onClick:ce=>ce.stopPropagation(),children:t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsxs("button",{onClick:ce=>{ce.stopPropagation(),Ce({isOpen:!0,project:oe})},className:"inline-flex items-center gap-1 px-2 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 hover:border-blue-300 transition-colors",title:"View Project Details",children:[t.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]}),t.jsxs("button",{onClick:ce=>{ce.stopPropagation(),de(oe._id)},className:"inline-flex items-center gap-1 px-2 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-colors",title:"Edit Project",children:[t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]})]})})]},oe._id))})]})})}):t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-12",children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No projects yet"}),t.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Create your first project to get started"}),t.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Project"]})]})}),se.isOpen&&se.project&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between z-10",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Project Details"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:se.project.companyName})]}),t.jsx("button",{onClick:()=>Ce({isOpen:!1,project:null}),className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Company Details"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Name"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.companyName||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Website"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.website?t.jsx("a",{href:se.project.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:se.project.website}):"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"City"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.city||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Country"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.country||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Industry"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.industry||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Size"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.companySize||"N/A"})]}),se.project.companyDescription&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Description"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1 whitespace-pre-wrap",children:se.project.companyDescription})]})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Contact Person"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Full Name"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.contactPerson?.fullName||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Designation"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.contactPerson?.designation||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Email"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.contactPerson?.email?t.jsx("a",{href:`mailto:${se.project.contactPerson.email}`,className:"text-blue-600 hover:underline",children:se.project.contactPerson.email}):"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Phone Number"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.contactPerson?.phoneNumber?t.jsx("a",{href:`tel:${se.project.contactPerson.phoneNumber}`,className:"text-blue-600 hover:underline",children:se.project.contactPerson.phoneNumber}):"N/A"})]}),se.project.contactPerson?.linkedInProfileUrl&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"LinkedIn Profile"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.jsx("a",{href:se.project.contactPerson.linkedInProfileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:se.project.contactPerson.linkedInProfileUrl})})]})]})]}),se.project.campaignDetails&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),"Campaign Details"]}),t.jsxs("div",{className:"space-y-4",children:[se.project.campaignDetails.servicesOffered&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Services Offered"}),t.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[se.project.campaignDetails.servicesOffered.leadGeneration&&t.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:"Lead Generation"}),se.project.campaignDetails.servicesOffered.marketResearch&&t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:"Market Research"}),se.project.campaignDetails.servicesOffered.appointmentSetting&&t.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full",children:"Appointment Setting"}),se.project.campaignDetails.servicesOffered.dataEnrichment&&t.jsx("span",{className:"px-3 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded-full",children:"Data Enrichment"}),!se.project.campaignDetails.servicesOffered.leadGeneration&&!se.project.campaignDetails.servicesOffered.marketResearch&&!se.project.campaignDetails.servicesOffered.appointmentSetting&&!se.project.campaignDetails.servicesOffered.dataEnrichment&&t.jsx("span",{className:"text-sm text-gray-500",children:"None selected"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[se.project.campaignDetails.leadQuotaCommitted>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Lead Quota Committed"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.campaignDetails.leadQuotaCommitted})]}),se.project.campaignDetails.startDate&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Start Date"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:ze(se.project.campaignDetails.startDate)})]}),se.project.campaignDetails.endDate&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"End Date"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:ze(se.project.campaignDetails.endDate)})]})]}),se.project.campaignDetails.expectationsFromUs&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Expectations From Us"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1 whitespace-pre-wrap",children:se.project.campaignDetails.expectationsFromUs})]})]})]}),se.project.channels&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})}),"Channels"]}),t.jsxs("div",{className:"flex flex-wrap gap-3",children:[se.project.channels.linkedInOutreach&&t.jsxs("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 text-sm font-medium rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),"LinkedIn Outreach"]}),se.project.channels.coldEmail&&t.jsxs("span",{className:"px-4 py-2 bg-purple-100 text-purple-800 text-sm font-medium rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Cold Email"]}),se.project.channels.coldCalling&&t.jsxs("span",{className:"px-4 py-2 bg-green-100 text-green-800 text-sm font-medium rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Cold Calling"]}),!se.project.channels.linkedInOutreach&&!se.project.channels.coldEmail&&!se.project.channels.coldCalling&&t.jsx("span",{className:"text-sm text-gray-500",children:"No channels selected"})]})]}),se.project.icpDefinition&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"ICP Definition"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[se.project.icpDefinition.targetIndustries&&se.project.icpDefinition.targetIndustries.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Target Industries"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(se.project.icpDefinition.targetIndustries)?se.project.icpDefinition.targetIndustries.join(", "):se.project.icpDefinition.targetIndustries})]}),se.project.icpDefinition.targetJobTitles&&se.project.icpDefinition.targetJobTitles.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Target Job Titles"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(se.project.icpDefinition.targetJobTitles)?se.project.icpDefinition.targetJobTitles.join(", "):se.project.icpDefinition.targetJobTitles})]}),(se.project.icpDefinition.companySizeMin>0||se.project.icpDefinition.companySizeMax<1e3)&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Size Range"}),t.jsxs("p",{className:"text-sm text-gray-900 mt-1",children:[se.project.icpDefinition.companySizeMin," - ",se.project.icpDefinition.companySizeMax," employees"]})]}),se.project.icpDefinition.geographies&&se.project.icpDefinition.geographies.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Geographies"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(se.project.icpDefinition.geographies)?se.project.icpDefinition.geographies.join(", "):se.project.icpDefinition.geographies})]}),se.project.icpDefinition.keywords&&se.project.icpDefinition.keywords.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Keywords"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(se.project.icpDefinition.keywords)?se.project.icpDefinition.keywords.join(", "):se.project.icpDefinition.keywords})]}),se.project.icpDefinition.exclusionCriteria&&se.project.icpDefinition.exclusionCriteria.length>0&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Exclusion Criteria"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(se.project.icpDefinition.exclusionCriteria)?se.project.icpDefinition.exclusionCriteria.join(", "):se.project.icpDefinition.exclusionCriteria})]})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),"Team Allocation"]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Assigned To"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:se.project.assignedTo||"N/A"})]})]})]}),t.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4 flex items-center justify-end gap-3",children:[t.jsx("button",{onClick:()=>Ce({isOpen:!1,project:null}),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"}),t.jsx("button",{onClick:()=>{Ce({isOpen:!1,project:null}),de(se.project._id)},className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Edit Project"})]})]})})]})}const rp=[{id:1,label:"Company Details"},{id:2,label:"Contact Person"},{id:3,label:"Campaign Details"},{id:4,label:"Channels"},{id:5,label:"ICP Definition"},{id:6,label:"Team Allocation"}];function Ab(){const l=Dr(),{id:n}=di(),a=!!n,[o,s]=B.useState(1),[e,m]=B.useState(!1),[v,w]=B.useState(a),[N,S]=B.useState(null),[D,L]=B.useState({companyName:"",website:"",city:"",country:"",industry:"",companySize:"",companyDescription:"",contactPerson:{fullName:"",designation:"",email:"",phoneNumber:"",linkedInProfileUrl:""},campaignDetails:{servicesOffered:{leadGeneration:!1,marketResearch:!1,appointmentSetting:!1,dataEnrichment:!1},expectationsFromUs:"",leadQuotaCommitted:0,startDate:"",endDate:""},channels:{linkedInOutreach:!1,coldEmail:!1,coldCalling:!1},icpDefinition:{targetIndustries:"",targetJobTitles:"",companySizeMin:0,companySizeMax:1e3,geographies:"",keywords:"",exclusionCriteria:""},assignedTo:"",teamMembers:[]}),M=(J,de)=>{if(J.includes(".")){const[le,ze]=J.split(".");L(me=>({...me,[le]:{...me[le],[ze]:de}}))}else L(le=>({...le,[J]:de}))},F=(J,de,le)=>{L(ze=>({...ze,[J]:{...ze[J],[de]:le}}))},O=(J,de)=>{L(le=>({...le,campaignDetails:{...le.campaignDetails,servicesOffered:{...le.campaignDetails.servicesOffered,[J]:de}}}))};B.useEffect(()=>{(async()=>{if(a)try{w(!0);const de=await Ut.get(`/projects/${n}`);if(de.data.success){const le=de.data.data,ze=oe=>oe?new Date(oe).toISOString().split("T")[0]:"",me=oe=>Array.isArray(oe)?oe.join(", "):"";L({companyName:le.companyName||"",website:le.website||"",city:le.city||"",country:le.country||"",industry:le.industry||"",companySize:le.companySize||"",companyDescription:le.companyDescription||"",contactPerson:{fullName:le.contactPerson?.fullName||"",designation:le.contactPerson?.designation||"",email:le.contactPerson?.email||"",phoneNumber:le.contactPerson?.phoneNumber||"",linkedInProfileUrl:le.contactPerson?.linkedInProfileUrl||""},campaignDetails:{servicesOffered:{leadGeneration:le.campaignDetails?.servicesOffered?.leadGeneration||!1,marketResearch:le.campaignDetails?.servicesOffered?.marketResearch||!1,appointmentSetting:le.campaignDetails?.servicesOffered?.appointmentSetting||!1,dataEnrichment:le.campaignDetails?.servicesOffered?.dataEnrichment||!1},expectationsFromUs:le.campaignDetails?.expectationsFromUs||"",leadQuotaCommitted:le.campaignDetails?.leadQuotaCommitted||0,startDate:ze(le.campaignDetails?.startDate),endDate:ze(le.campaignDetails?.endDate)},channels:{linkedInOutreach:le.channels?.linkedInOutreach||!1,coldEmail:le.channels?.coldEmail||!1,coldCalling:le.channels?.coldCalling||!1},icpDefinition:{targetIndustries:me(le.icpDefinition?.targetIndustries),targetJobTitles:me(le.icpDefinition?.targetJobTitles),companySizeMin:le.icpDefinition?.companySizeMin||0,companySizeMax:le.icpDefinition?.companySizeMax||1e3,geographies:me(le.icpDefinition?.geographies),keywords:me(le.icpDefinition?.keywords),exclusionCriteria:me(le.icpDefinition?.exclusionCriteria)},assignedTo:le.assignedTo||"",teamMembers:Array.isArray(le.teamMembers)&&le.teamMembers.length>0?le.teamMembers:[]})}}catch(de){console.error("Error fetching project:",de),S(de.response?.data?.error||"Couldn't load the project details. Try refreshing the page.")}finally{w(!1)}})()},[n,a]);const P=J=>{switch(J){case 1:return D.companyName.trim()?!0:(S("Company Name is required"),!1);case 2:return D.contactPerson.fullName.trim()?!0:(S("Full Name is required"),!1);default:return!0}},K=()=>{P(o)&&(S(null),o<rp.length&&s(o+1))},ne=()=>{o>1&&(s(o-1),S(null))},se=J=>{J!==o&&(J>o&&!P(o)||(S(null),s(J)))},Ce=()=>{window.confirm("Are you sure you want to cancel? All unsaved data will be lost.")&&l("/projects")},ge=async()=>{if(P(o)){m(!0),S(null);try{const J=ze=>!ze||typeof ze!="string"?[]:ze.split(",").map(me=>me.trim()).filter(Boolean),de={...D,icpDefinition:{...D.icpDefinition,targetIndustries:J(D.icpDefinition.targetIndustries),targetJobTitles:J(D.icpDefinition.targetJobTitles),geographies:J(D.icpDefinition.geographies),keywords:J(D.icpDefinition.keywords),exclusionCriteria:J(D.icpDefinition.exclusionCriteria),companySizeMin:Number(D.icpDefinition.companySizeMin)||0,companySizeMax:Number(D.icpDefinition.companySizeMax)||0},campaignDetails:{...D.campaignDetails,leadQuotaCommitted:Number(D.campaignDetails.leadQuotaCommitted)||0},teamMembers:Array.isArray(D.teamMembers)?D.teamMembers.map(ze=>(ze||"").trim()).filter(Boolean):[]};let le;a?le=await Ut.put(`/projects/${n}`,de):le=await Ut.post("/projects",de),le.data.success?l("/projects"):S(le.data.error||`Couldn't ${a?"update":"create"} the project. Something went wrong.`)}catch(J){console.error(`Error ${a?"updating":"creating"} project:`,J),S(J.response?.data?.error||J.message||`Something went wrong trying to ${a?"update":"create"} the project. Try again.`)}finally{m(!1)}}},Ne=()=>{switch(o){case 1:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Company Details"}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Company Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:D.companyName,onChange:J=>M("companyName",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter company name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),t.jsx("input",{type:"url",value:D.website,onChange:J=>M("website",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),t.jsx("input",{type:"text",value:D.city,onChange:J=>M("city",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter city"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),t.jsx("input",{type:"text",value:D.country,onChange:J=>M("country",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter country"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Industry"}),t.jsx("input",{type:"text",value:D.industry,onChange:J=>M("industry",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter industry"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Size"}),t.jsxs("select",{value:D.companySize,onChange:J=>M("companySize",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"",children:"Select size"}),t.jsx("option",{value:"1-10",children:"1-10"}),t.jsx("option",{value:"11-50",children:"11-50"}),t.jsx("option",{value:"51-200",children:"51-200"}),t.jsx("option",{value:"201-500",children:"201-500"}),t.jsx("option",{value:"501-1000",children:"501-1000"}),t.jsx("option",{value:"1000+",children:"1000+"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Description"}),t.jsx("textarea",{value:D.companyDescription,onChange:J=>M("companyDescription",J.target.value),rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y",placeholder:"Enter company description"})]})]});case 2:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Contact Person"}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Full Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:D.contactPerson.fullName,onChange:J=>F("contactPerson","fullName",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter full name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Designation"}),t.jsx("input",{type:"text",value:D.contactPerson.designation,onChange:J=>F("contactPerson","designation",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter designation"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),t.jsx("input",{type:"email",value:D.contactPerson.email,onChange:J=>F("contactPerson","email",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@example.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),t.jsx("input",{type:"tel",value:D.contactPerson.phoneNumber,onChange:J=>F("contactPerson","phoneNumber",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+1 234 567 8900"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"LinkedIn Profile URL"}),t.jsx("input",{type:"url",value:D.contactPerson.linkedInProfileUrl,onChange:J=>F("contactPerson","linkedInProfileUrl",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://linkedin.com/in/username"})]})]});case 3:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Campaign Details"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Services Offered"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.leadGeneration,onChange:J=>O("leadGeneration",J.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Lead Generation"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.marketResearch,onChange:J=>O("marketResearch",J.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Market Research"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.appointmentSetting,onChange:J=>O("appointmentSetting",J.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Appointment Setting"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.dataEnrichment,onChange:J=>O("dataEnrichment",J.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Data Enrichment"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expectations from Us"}),t.jsx("textarea",{value:D.campaignDetails.expectationsFromUs,onChange:J=>F("campaignDetails","expectationsFromUs",J.target.value),rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y",placeholder:"Enter expectations"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lead Quota Committed"}),t.jsx("input",{type:"number",value:D.campaignDetails.leadQuotaCommitted,onChange:J=>F("campaignDetails","leadQuotaCommitted",parseInt(J.target.value)||0),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0",min:"0"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",value:D.campaignDetails.startDate,onChange:J=>F("campaignDetails","startDate",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",value:D.campaignDetails.endDate,onChange:J=>F("campaignDetails","endDate",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]})]})]});case 4:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Channels"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Channel Selection"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.channels.linkedInOutreach,onChange:J=>F("channels","linkedInOutreach",J.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"LinkedIn Outreach"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.channels.coldEmail,onChange:J=>F("channels","coldEmail",J.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Cold Email"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.channels.coldCalling,onChange:J=>F("channels","coldCalling",J.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Cold Calling"})]})]})]})]});case 5:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"ICP Definition"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Industries (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.targetIndustries,onChange:J=>F("icpDefinition","targetIndustries",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Technology, Healthcare, Finance"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Job Titles (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.targetJobTitles,onChange:J=>F("icpDefinition","targetJobTitles",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., CEO, CTO, VP Sales"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Size Min"}),t.jsx("input",{type:"number",value:D.icpDefinition.companySizeMin,onChange:J=>F("icpDefinition","companySizeMin",parseInt(J.target.value)||0),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Size Max"}),t.jsx("input",{type:"number",value:D.icpDefinition.companySizeMax,onChange:J=>F("icpDefinition","companySizeMax",parseInt(J.target.value)||1e3),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"1000",min:"0"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Geographies (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.geographies,onChange:J=>F("icpDefinition","geographies",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., USA, UK, Canada"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Keywords (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.keywords,onChange:J=>F("icpDefinition","keywords",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., SaaS, Cloud, AI"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exclusion Criteria (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.exclusionCriteria,onChange:J=>F("icpDefinition","exclusionCriteria",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Government, Non-profit"})]})]});case 6:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Team Allocation"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assigned To"}),t.jsx("input",{type:"text",value:D.assignedTo,onChange:J=>M("assignedTo",J.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter assigned person name"}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Enter the name of the person assigned to manage this project"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Team Members"}),t.jsx("button",{type:"button",onClick:()=>{const J=[...D.teamMembers,""];M("teamMembers",J)},className:"px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:"+ Add Member"})]}),t.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Add team member email addresses to grant them access to this project"}),D.teamMembers.length===0?t.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"No team members added yet"}),t.jsx("button",{type:"button",onClick:()=>M("teamMembers",[""]),className:"mt-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Add first team member"})]}):t.jsx("div",{className:"space-y-3",children:D.teamMembers.map((J,de)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"email",value:J,onChange:le=>{const ze=[...D.teamMembers];ze[de]=le.target.value.trim(),M("teamMembers",ze)},className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"team.member@example.com"}),t.jsx("button",{type:"button",onClick:()=>{const le=D.teamMembers.filter((ze,me)=>me!==de);M("teamMembers",le)},className:"px-3 py-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove team member",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},de))})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsxs("p",{className:"text-sm text-blue-800",children:[t.jsx("strong",{children:"Note:"})," Team members will be able to access this project, view all activities, create/edit entries, and their activities will appear in Team Performance."]})})]});default:return null}};return v?t.jsx("div",{className:"p-6 max-w-4xl mx-auto",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):t.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:a?"Edit Project":"Create New Project"}),t.jsx("div",{className:"mb-8",children:t.jsx("div",{className:"flex items-center justify-between",children:rp.map((J,de)=>{const le=J.id<o,ze=J.id===o,me=J.id>o;return t.jsxs("div",{className:"flex items-center flex-1",children:[t.jsxs("button",{type:"button",onClick:()=>se(J.id),className:"flex flex-col items-center flex-1 focus:outline-none",children:[t.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-all ${le||ze?"bg-blue-600 text-white":"bg-gray-200 text-gray-500"}`,children:le?t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):J.id}),t.jsx("span",{className:`mt-2 text-xs font-medium ${ze?"text-blue-600":me?"text-gray-400":"text-gray-600"}`,children:J.label})]}),de<rp.length-1&&t.jsx("div",{className:`flex-1 h-0.5 mx-2 ${le?"bg-blue-600":"bg-gray-200"}`})]},J.id)})})}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-8 mb-6",children:[N&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:N}),Ne()]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:Ce,className:"text-gray-600 hover:text-gray-900 font-medium",children:"Cancel"}),t.jsxs("div",{className:"flex items-center gap-3",children:[o>1&&t.jsxs("button",{onClick:ne,className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-gray-700 font-medium",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]}),o<rp.length?t.jsxs("button",{onClick:K,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:["Next",t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}):t.jsx("button",{onClick:ge,disabled:e,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:e?a?"Updating...":"Creating...":a?"Update Project":"Create Project & Map ICP"})]})]})]})}function Xk({isOpen:l,onClose:n,projectId:a,onImportSuccess:o}){const[s,e]=B.useState(null),[m,v]=B.useState(""),[w,N]=B.useState("New"),[S,D]=B.useState(!1),[L,M]=B.useState(!1),[F,O]=B.useState(""),[P,K]=B.useState(""),ne=B.useRef(null),se=["New","Contacted","Qualified","Proposal","Negotiation"],Ce=me=>{if(me){const oe=me.name.toLowerCase(),ce=[".csv",".xlsx",".xls"],ye=["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/excel","application/x-excel","application/x-msexcel"],ke=ce.some(Se=>oe.endsWith(Se)),fe=ye.includes(me.type);if(!ke&&!fe){O("Please upload a CSV, XLSX, or XLS file only");return}e(me),O("")}},ge=me=>{me.preventDefault(),D(!0)},Ne=me=>{me.preventDefault(),D(!1)},J=me=>{me.preventDefault(),D(!1);const oe=me.dataTransfer.files[0];Ce(oe)},de=me=>{const oe=me.target.files[0];Ce(oe)},le=async()=>{if(!s){O("Please select a file (CSV, XLSX, or XLS)");return}if(!a){O("Project ID is missing");return}M(!0),O(""),K("");try{const me=new FormData;me.append("file",s),me.append("projectId",a),m&&me.append("assignTo",m),me.append("defaultStage",w);const oe=await Ut.post("/projects/bulk-import",me,{headers:{"Content-Type":"multipart/form-data"}});oe.data.success&&(K(`Successfully imported ${oe.data.data.imported} prospects. ${oe.data.data.skipped>0?`${oe.data.data.skipped} duplicates skipped.`:""}`),setTimeout(()=>{o?.(),ze()},2e3))}catch(me){console.error("Import error:",me),O(me.response?.data?.error||"Couldn't import those prospects. Double-check your file format and give it another shot.")}finally{M(!1)}},ze=()=>{e(null),v(""),N("New"),O(""),K(""),D(!1),ne.current&&(ne.current.value=""),n()};return l?t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 animate-fade-in",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto animate-fade-in",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Bulk Import Prospects"}),t.jsx("button",{onClick:ze,className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Upload a CSV, XLSX, or XLS file with the following columns:"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[t.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 list-disc list-inside",children:[t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Name"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Email"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Person Linkedin Url"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Title"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"First Phone"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Employees"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Category"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Industry"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Keywords"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Website"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Linkedin Url"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Facebook Url"})," (optional)"]})]}),t.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 list-disc list-inside",children:[t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Twitter Url"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"City"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"State"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Country"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Address"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company City"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company State"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Country"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Phone"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"SEO Description"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Technologies"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Annual Revenue"})," (optional)"]})]})]})]})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Upload File"}),t.jsxs("div",{onDragOver:ge,onDragLeave:Ne,onDrop:J,onClick:()=>ne.current?.click(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${S?"border-blue-500 bg-blue-50":s?"border-green-500 bg-green-50":"border-gray-300 bg-gray-50 hover:border-gray-400"}`,children:[t.jsx("input",{ref:ne,type:"file",accept:".csv,.xlsx,.xls,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/csv",onChange:de,className:"hidden"}),t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Click to upload or drag and drop"}),t.jsx("p",{className:"text-xs text-gray-500",children:"CSV, XLSX, or XLS files only (max 10MB)"})]}),s&&t.jsx("p",{className:"text-sm text-green-600 font-medium mt-2",children:s.name})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Assign To"}),t.jsx("input",{type:"text",value:m,onChange:me=>v(me.target.value),placeholder:"Enter person name or leave empty for auto-assign",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm bg-white"}),t.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Enter team member name or leave empty to let system auto-assign"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Default Stage"}),t.jsx("select",{value:w,onChange:me=>N(me.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm bg-white",children:se.map(me=>t.jsx("option",{value:me,children:me},me))}),t.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Initial pipeline stage for imported prospects"})]}),t.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("svg",{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"text-sm font-semibold text-yellow-900 mb-2",children:"Quick heads up"}),t.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"We'll skip any duplicate emails automatically"}),t.jsx("li",{children:"Invalid email formats get flagged so you can fix them"}),t.jsx("li",{children:"Large files might take a minute or two to process"})]})]})]})}),F&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-red-700",children:F})}),P&&t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-green-700",children:P})})]}),t.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200",children:[t.jsx("button",{onClick:ze,disabled:L,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{onClick:le,disabled:L||!s,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:L?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import Prospects"]})})]})]})}):null}function Jk({isOpen:l,onClose:n,type:a,selectedContacts:o,projectId:s,contacts:e}){const[m,v]=B.useState({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),[w,N]=B.useState({}),[S,D]=B.useState(!1),[L,M]=B.useState(!1),[F,O]=B.useState({current:0,total:0,success:0,failed:0}),[P,K]=B.useState({phone:!1,email:!1,linkedin:!1}),[ne,se]=B.useState(!1),[Ce,ge]=B.useState([]),[Ne,J]=B.useState(""),[de,le]=B.useState(!1);B.useEffect(()=>{const W=localStorage.getItem("linkedInAccounts");if(W)try{ge(JSON.parse(W))}catch(H){console.error("Error parsing LinkedIn accounts:",H),ge([])}else ge([])},[]),B.useEffect(()=>{if(l){setTimeout(()=>M(!0),10),O({current:0,total:o.size,success:0,failed:0});const W=new Date().toISOString().split("T")[0];v(H=>({...H,callDate:a==="call"?W:"",emailDate:a==="email"?W:"",linkedinDate:a==="linkedin"?W:""}))}else M(!1),v({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),N({}),se(!1),le(!1),J("")},[l,o.size]);const ze=()=>{if(Ne.trim()&&!Ce.includes(Ne.trim())){const W=[...Ce,Ne.trim()];ge(W),localStorage.setItem("linkedInAccounts",JSON.stringify(W)),v(H=>({...H,linkedInAccountName:Ne.trim()})),J(""),le(!1)}};if(!l)return null;const me=()=>{const W="w-5 h-5";switch(a){case"call":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${W} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${W} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${W} text-white`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},oe=()=>{switch(a){case"call":return"Bulk Log Call Activity";case"email":return"Bulk Log Email Activity";case"linkedin":return"Bulk Log LinkedIn Activity";default:return"Bulk Log Activity"}},ce=()=>{switch(a){case"call":return"from-green-50 to-emerald-50";case"email":return"from-blue-50 to-cyan-50";case"linkedin":return"from-blue-50 to-indigo-50";default:return"from-gray-50 to-gray-100"}},ye=(W,H)=>{v(X=>({...X,[W]:H})),w[W]&&N(X=>({...X,[W]:""}))},ke=()=>{const W={};if(m.nextAction&&!m.nextActionDate&&(W.nextActionDate="Next action date is required when next action is specified"),m.nextActionDate){const H=new Date(m.nextActionDate),X=new Date,je=new Date(X);je.setDate(je.getDate()+7),H>je&&(W.nextActionDate="Next action must be scheduled within 7 days")}return N(W),Object.keys(W).length===0},fe=async W=>{if(W.preventDefault(),!ke())return;D(!0);const H=Array.from(o),X=e.filter(we=>H.includes((we._id||we.name).toString()));O({current:0,total:X.length,success:0,failed:0});let je=0,Q=0;try{for(let we=0;we<X.length;we++){const Fe=X[we];let ue=null;Fe._id&&(ue=Fe._id.toString?Fe._id.toString():Fe._id,typeof ue=="string"&&ue.length!==24&&(ue=null)),O(xe=>({...xe,current:we+1}));try{const xe=m.email||Fe.email,tt=m.phoneNumber||Fe.firstPhone,Qe=m.linkedInUrl||Fe.personLinkedinUrl||Fe.companyLinkedinUrl,Ve=m.conversationNotes.trim()||"",xt={projectId:s,type:a,template:m.template,outcome:null,conversationNotes:Ve,nextAction:m.nextAction,nextActionDate:m.nextActionDate,phoneNumber:tt||null,email:xe||null,linkedInUrl:Qe||null,status:m.status||null,linkedInAccountName:m.linkedInAccountName||null,lnRequestSent:m.lnRequestSent||null,connected:m.connected||null,callNumber:m.callNumber||null,callStatus:m.callStatus||null,callDate:m.callDate||null,emailDate:m.emailDate||null,linkedinDate:m.linkedinDate||null};if(ue&&(xt.contactId=ue),(await Ut.post("/activities",xt)).data.success&&m.status&&ue&&s)try{await Ut.put(`/projects/${s}/project-contacts/${ue}`,{stage:m.status})}catch($t){console.error("Error updating contact status:",$t)}je++,O($t=>({...$t,success:je}))}catch(xe){console.error(`Error saving activity for ${Fe.name}:`,xe),Q++,O(tt=>({...tt,failed:Q}))}}v({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),setTimeout(()=>{n()},1e3)}catch(we){console.error("Error in bulk activity logging:",we),N({submit:"Some activities didn't save properly. Check what went wrong and try again."})}finally{D(!1)}},Se=()=>{S||(v({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),N({}),K({phone:!1,email:!1,linkedin:!1}),n())},Ye=async(W,H,X)=>{const je=Array.from(o),Q=e.filter(ue=>{const xe=ue._id?.toString();return je.includes((ue._id||ue.name).toString())&&xe&&typeof xe=="string"&&xe.length===24});if(Q.length===0){N({submit:"No valid contacts selected to save."});return}K(ue=>({...ue,[W]:!0}));let we=0,Fe=0;try{for(const ue of Q)try{const xe=ue._id.toString();await Ut.put(`/contacts/${xe}`,{[X]:H||""}),we++}catch(xe){console.error(`Error saving ${W} for ${ue.name}:`,xe),Fe++}we>0&&(N({}),W==="phone"?v(ue=>({...ue,phoneNumber:H||""})):W==="email"?v(ue=>({...ue,email:H||""})):W==="linkedin"&&v(ue=>({...ue,linkedInUrl:H||""}))),Fe>0&&N({submit:`Saved ${W} for ${we} contact(s), but ${Fe} failed.`})}catch(ue){console.error(`Error saving ${W}:`,ue),N({submit:`Couldn't save ${W}. Try again in a moment.`})}finally{K(ue=>({...ue,[W]:!1}))}},te=e.filter(W=>o.has((W._id||W.name).toString())),pe=te.some(W=>W.firstPhone),V=te.some(W=>W.email),be=te.some(W=>W.personLinkedinUrl||W.companyLinkedinUrl),_e=()=>te.map(W=>W.personLinkedinUrl||W.companyLinkedinUrl).filter(W=>W&&W.trim()!==""),De=()=>{const W=_e();if(W.length>0){const H=W.join(`
`);navigator.clipboard.writeText(H).then(()=>{const X=document.getElementById("copy-linkedin-urls-btn");if(X){const je=X.textContent;X.textContent="Copied!",X.classList.add("bg-green-600"),setTimeout(()=>{X.textContent=je,X.classList.remove("bg-green-600")},2e3)}}).catch(X=>{console.error("Failed to copy URLs:",X)})}};return t.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${L?"opacity-100":"opacity-0"}`,onClick:Se,children:t.jsxs("div",{className:`bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col transform transition-all duration-300 ${L?"scale-100 translate-y-0":"scale-95 translate-y-4"}`,onClick:W=>W.stopPropagation(),children:[t.jsx("div",{className:`bg-gradient-to-r ${ce()} border-b border-gray-200 p-4 flex-shrink-0`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[ne&&t.jsx("button",{onClick:()=>se(!1),className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-600 hover:text-gray-900 hover:bg-white/50 transition-all duration-200 group",title:"Back to form",children:t.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("div",{className:"animate-pulse-once",children:me()}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-0.5",children:ne&&a==="linkedin"?"LinkedIn Message Variations":ne&&a==="email"?"Email Variations":oe()}),!ne&&t.jsxs("p",{className:"text-xs text-gray-600 font-medium",children:[te.length," ",te.length===1?"contact":"contacts"," selected"]})]})]}),t.jsx("button",{onClick:Se,disabled:S,className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-400 hover:text-gray-600 hover:bg-white/50 transition-all duration-200 group disabled:opacity-50",children:t.jsx("svg",{className:"w-5 h-5 group-hover:rotate-90 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),S&&t.jsxs("div",{className:"px-4 py-3 bg-blue-50 border-b border-blue-100",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("span",{className:"text-sm font-semibold text-blue-900",children:["Processing ",F.current," of ",F.total," contacts..."]}),t.jsxs("span",{className:"text-sm font-semibold text-blue-700",children:[F.success," success, ",F.failed," failed"]})]}),t.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${F.current/F.total*100}%`}})})]}),t.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200 max-h-32 overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("p",{className:"text-xs font-semibold text-gray-700",children:a==="linkedin"?"Selected LinkedIn URLs:":"Selected Contacts:"}),a==="linkedin"&&_e().length>0&&t.jsxs("button",{id:"copy-linkedin-urls-btn",type:"button",onClick:De,className:"px-2 py-1 text-xs font-semibold text-blue-600 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition-colors flex items-center gap-1",title:"Copy all LinkedIn URLs",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy All URLs"]})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:a==="linkedin"?t.jsxs(t.Fragment,{children:[te.slice(0,10).map(W=>{const H=W.personLinkedinUrl||W.companyLinkedinUrl;return H?t.jsx("span",{className:"px-2 py-1 bg-white text-xs font-medium text-blue-700 rounded-md border border-blue-200 hover:bg-blue-50 transition-colors break-all",title:H,children:H.length>50?`${H.substring(0,50)}...`:H},W._id||W.name):null}),te.length>10&&t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-xs font-semibold text-blue-700 rounded-md",children:["+",te.length-10," more"]})]}):t.jsxs(t.Fragment,{children:[te.slice(0,10).map(W=>t.jsx("span",{className:"px-2 py-1 bg-white text-xs font-medium text-gray-700 rounded-md border border-gray-200",children:W.name||"N/A"},W._id||W.name)),te.length>10&&t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-xs font-semibold text-blue-700 rounded-md",children:["+",te.length-10," more"]})]})})]}),ne&&a==="linkedin"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Existing"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm usually in touch with teams managing residential projects and leasing, so I was just curious how you manage bookings, rentals, and property maintenance across your units."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I mostly connect with people working in residential and leasing rolesit keeps me close to how things really move on a day-to-day basis."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"The world today feels like one connected marketplace, and being part of the real estate ecosystem, I enjoy connecting with people who are building and managing things on the ground. Looking forward to connecting and exchanging perspectives."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I've noticed that no two property teams manage bookings, rentals, and maintenance the same way. I'm always interested in hearing how others handle it in practice."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Always open to exchanging thoughts and learning how things are shaping up on your side. Would be great to stay connected."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We work closely with property teams to simplify how day-to-day operations are managed  from rentals and billing to maintenance  so things feel more connected and easier to handle."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Everyday operational conversations around properties quietly offer the most value in understanding how things really work."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Enjoy grounded conversations around real work and real challenges. Happy to stay connected and exchange insights whenever it makes sense."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We believe real value often comes from reducing small operational frictions and giving teams better visibility into what's happening across their properties."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm always interested in seeing how teams optimize their workflowsdo you have any strategies that make managing bookings and maintenance simpler?"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I value thoughtful conversations with people close to the work. Whenever it feels right, I'd enjoy exchanging insights as things evolve on your side."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"No worries if you didn't catch my earlier message. Just checking if you're up for a chat about possible ways we can team up and grow together."})]})]})]})})})}):ne&&a==="email"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300 w-[15%]",children:"Email"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 4"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I work closely with people involved in residential projects and leasing, and I enjoy staying connected with those who are close to the day-to-day side of property work."}),t.jsx("p",{children:"At Terabits, we focus on making everyday property operations a little easier by keeping rentals, billing, and maintenance in one place."}),t.jsx("p",{children:"Happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working close to residential projects and leasing. I've found those conversations tend to be the most honest and practical."}),t.jsx("p",{children:"I'm part of the Terabits team, where we focus on making everyday property operations easier to manage."}),t.jsx("p",{children:"Nice to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"font-semibold",children:"Subject: Exchanging notes on leasing & residential work"}),t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working on residential projects and leasing. I've found these conversations to be the most practical."}),t.jsx("p",{children:'When it comes to daily management, where do you usually find the most friction or "extra work" in your current process?'})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I tend to reach out to people in residential leasing because the conversations are usually more practical."}),t.jsx("p",{children:`I'm curiouswhen it comes to your daily management, where do things usually get stuck or feel like a "headache" for your team?`}),t.jsx("p",{children:"Nice to connect,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just wanted to follow up on my last note."}),t.jsx("p",{children:"We usually speak with property teams who want a bit more clarity in their daily workflows without changing how they already operate."}),t.jsx("p",{children:"Always good to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just sharing a short follow-up."}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing without adding extra complexity to daily work."}),t.jsx("p",{children:"Happy to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing."}),t.jsx("p",{children:"This is where Terabits usually steps inwe focus on making those everyday operations feel less like a chore so you can focus on the bigger picture."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"That's usually where we come in. At Terabits, we focus on making those messy partslike rentals, maintenance, and billingfeel a lot more manageable."}),t.jsx("p",{children:"We try to keep the tech simple so it actually helps the team instead of adding more work to their day."}),t.jsx("p",{children:"Happy to stay in touch,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing we often notice is that small improvements in visibility can make day-to-day property work feel much more manageable."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that even small clarity in systems can make a big difference in day-to-day property operations."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that small clarity in systems makes a big difference."}),t.jsx("p",{children:"Specifically, we help by automating the repetitive stufflike tracking maintenance requests or streamlining billing workflowswithout adding extra complexity to your day-to-day work."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I've noticed is that just adding a bit of clarity to maintenance tracking or billing can save a lot of hours."}),t.jsx("p",{children:"We mostly help by automating those repetitive tasks so they just happen in the background. It's a small change that usually makes the day-to-day much smoother."}),t.jsx("p",{children:"Thought I'd share that."})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here for now."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Wishing you a great week ahead."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Take care."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here as I don't want to crowd your inbox."}),t.jsx("p",{children:"If you ever want to swap notes on how to make property workflows easier, I'm always happy to chat."}),t.jsx("p",{children:"Wishing you the best,"})]})})]})]})]})})})}):t.jsx("form",{onSubmit:fe,className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsxs("div",{className:"space-y-4",children:[a!=="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700",children:"Select Template (Optional)"}),(a==="linkedin"||a==="email")&&t.jsxs("button",{type:"button",onClick:()=>se(!0),disabled:S,className:"px-3 py-1.5 text-xs font-semibold text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-all duration-200 flex items-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a==="email"?"View Email Variations":"View Message Variations"]})]}),t.jsxs("select",{value:m.template,onChange:W=>ye("template",W.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"no-template",children:"No Template"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"introduction-email",children:"Introduction Email"}),t.jsx("option",{value:"follow-up-email",children:"Follow-up Email"}),t.jsx("option",{value:"value-proposition-email",children:"Value Proposition Email"})]}):a==="linkedin"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"connection-request-message",children:"Connection Request Message"}),t.jsx("option",{value:"introduction-message",children:"Introduction Message"}),t.jsx("option",{value:"follow-up-message",children:"Follow-up Message"})]}):null]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Account Used ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsxs("select",{value:m.linkedInAccountName,onChange:W=>ye("linkedInAccountName",W.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select LinkedIn account"}),Ce.map((W,H)=>t.jsx("option",{value:W,children:W},H))]})]}),t.jsx("button",{type:"button",onClick:()=>le(!de),disabled:S,className:"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",children:de?"Cancel":"+ Add"})]}),de&&t.jsxs("div",{className:"mt-3 flex gap-2",children:[t.jsx("input",{type:"text",value:Ne,onChange:W=>J(W.target.value),onKeyPress:W=>{W.key==="Enter"&&(W.preventDefault(),ze())},disabled:S,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Enter new LinkedIn account name"}),t.jsx("button",{type:"button",onClick:ze,disabled:!Ne.trim()||Ce.includes(Ne.trim())||S,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Add"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select or add a LinkedIn account that sent the connection request"]})]}),a==="linkedin"&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Ln Request Sent ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.lnRequestSent,onChange:W=>ye("lnRequestSent",W.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"}),t.jsx("option",{value:"Existing Connect",children:"Existing Connect"}),t.jsx("option",{value:"Inactive Profile",children:"Inactive Profile"}),t.jsx("option",{value:"Irrelevant Profile",children:"Irrelevant Profile"}),t.jsx("option",{value:"Open to Work",children:"Open to Work"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status of the LinkedIn connection request"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Connected ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.connected,onChange:W=>ye("connected",W.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Whether the connection was established"]})]})]}),(a==="email"||a==="linkedin")&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.status,onChange:W=>ye("status",W.target.value),disabled:S,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed ${w.status?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select status"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Out of Office",children:"Out of Office"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Wrong Person",children:"Wrong Person"}),t.jsx("option",{value:"Bounce",children:"Bounce"}),t.jsx("option",{value:"Opt-Out",children:"Opt-Out"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"})]}):t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"CIP",children:"CIP"}),t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"In-Person Meeting",children:"In-Person Meeting"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"}),t.jsx("option",{value:"SQL",children:"SQL"}),t.jsx("option",{value:"Tech Discussion",children:"Tech Discussion"}),t.jsx("option",{value:"WON",children:"WON"}),t.jsx("option",{value:"Lost",children:"Lost"}),t.jsx("option",{value:"Low Potential - Open",children:"Low Potential - Open"}),t.jsx("option",{value:"Potential Future",children:"Potential Future"})]})]}),w.status&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.status]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a==="email"?"Update the contact status based on this email interaction":"Update the contact status based on this interaction"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Call ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsx("div",{children:t.jsxs("select",{value:m.callNumber,onChange:W=>ye("callNumber",W.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select call number"}),t.jsx("option",{value:"1st call",children:"1st call"}),t.jsx("option",{value:"2nd call",children:"2nd call"}),t.jsx("option",{value:"3rd call",children:"3rd call"}),t.jsx("option",{value:"4th call",children:"4th call"}),t.jsx("option",{value:"5th call",children:"5th call"}),t.jsx("option",{value:"6th call",children:"6th call"}),t.jsx("option",{value:"7th call",children:"7th call"}),t.jsx("option",{value:"8th call",children:"8th call"}),t.jsx("option",{value:"9th call",children:"9th call"}),t.jsx("option",{value:"10th call",children:"10th call"})]})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:m.callDate,onChange:W=>ye("callDate",W.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Select call date"})]})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select which call attempt this is and the date when the call was made"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.callStatus,onChange:W=>ye("callStatus",W.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select status"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Ring",children:"Ring"}),t.jsx("option",{value:"Busy",children:"Busy"}),t.jsx("option",{value:"Call Back",children:"Call Back"}),t.jsx("option",{value:"Hang Up",children:"Hang Up"}),t.jsx("option",{value:"Switch Off",children:"Switch Off"}),t.jsx("option",{value:"Future",children:"Future"}),t.jsx("option",{value:"Details Shared",children:"Details Shared"}),t.jsx("option",{value:"Demo Booked",children:"Demo Booked"}),t.jsx("option",{value:"Invalid",children:"Invalid"}),t.jsx("option",{value:"Existing",children:"Existing"}),t.jsx("option",{value:"Demo Completed",children:"Demo Completed"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the status of this call"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Phone Number ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("input",{type:"tel",value:m.phoneNumber,onChange:W=>ye("phoneNumber",W.target.value),disabled:S||P.phone,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Add phone number (e.g., +1 234-567-8900)"})]}),t.jsx("button",{type:"button",onClick:()=>Ye("phone",m.phoneNumber,"firstPhone"),disabled:S||P.phone,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database for all selected contacts",children:P.phone?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:pe?"Some selected contacts have phone numbers in database. Enter a value to override or leave empty to use existing data.":"This will be applied to all selected contacts. Click Save to store in database for all contacts with valid IDs."})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Address ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("input",{type:"email",value:m.email,onChange:W=>ye("email",W.target.value),disabled:S||P.email,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Add email address (e.g., contact@example.com)"})]}),t.jsx("button",{type:"button",onClick:()=>Ye("email",m.email,"email"),disabled:S||P.email,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database for all selected contacts",children:P.email?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:V?"Some selected contacts have emails in database. Enter a value to override or leave empty to use existing data.":"This will be applied to all selected contacts. Click Save to store in database for all contacts with valid IDs."})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:m.emailDate,onChange:W=>ye("emailDate",W.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Select email date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the email was sent"]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Profile URL ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("input",{type:"url",value:m.linkedInUrl,onChange:W=>ye("linkedInUrl",W.target.value),disabled:S||P.linkedin,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Add LinkedIn profile URL (e.g., https://linkedin.com/in/username)"})]}),t.jsx("button",{type:"button",onClick:()=>Ye("linkedin",m.linkedInUrl,"personLinkedinUrl"),disabled:S||P.linkedin,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database for all selected contacts",children:P.linkedin?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:be?`Using LinkedIn URLs from ${_e().length} selected contact(s). Enter a value to override or leave empty to use existing URLs.`:"This will be applied to all selected contacts. Click Save to store in database for all contacts with valid IDs."}),a==="linkedin"&&_e().length>0&&t.jsxs("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded-md",children:[t.jsxs("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:["LinkedIn URLs from selected contacts (",_e().length,"):"]}),t.jsxs("div",{className:"max-h-20 overflow-y-auto space-y-1",children:[_e().slice(0,5).map((W,H)=>t.jsx("p",{className:"text-xs text-blue-700 break-all font-mono",children:W},H)),_e().length>5&&t.jsxs("p",{className:"text-xs text-blue-600 font-semibold",children:["+",_e().length-5," more URLs"]})]})]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:m.linkedinDate,onChange:W=>ye("linkedinDate",W.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Select LinkedIn date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the LinkedIn activity occurred"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Conversation Notes ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(optional, but helpful)"})]}),t.jsx("textarea",{value:m.conversationNotes,onChange:W=>ye("conversationNotes",W.target.value),disabled:S,rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 resize-y font-sans hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Jot down what happened, any concerns they raised, or what to follow up on. This applies to all selected contacts..."})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.nextAction,onChange:W=>ye("nextAction",W.target.value),disabled:S,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed ${w.nextAction?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"follow-up-call",children:"Follow-up Call"}),t.jsx("option",{value:"send-proposal",children:"Send Proposal"}),t.jsx("option",{value:"schedule-meeting",children:"Schedule Meeting"}),t.jsx("option",{value:"send-email",children:"Send Email"}),t.jsx("option",{value:"connect-linkedin",children:"Connect on LinkedIn"})]}),w.nextAction&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.nextAction]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action Date ",t.jsx("span",{className:m.nextAction?"text-red-500":"text-gray-400 text-xs font-normal",children:m.nextAction?"*":"(Optional)"})]}),t.jsx("div",{className:"relative",children:t.jsx("input",{type:"date",value:m.nextActionDate,onChange:W=>ye("nextActionDate",W.target.value),disabled:S,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed ${w.nextActionDate?"border-red-300 bg-red-50":"border-gray-300"}`})}),w.nextActionDate&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.nextActionDate]})]})]}),w.submit&&t.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-3 animate-shake",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-medium text-red-700",children:w.submit})]})}),t.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-200",children:[t.jsx("button",{type:"button",onClick:Se,disabled:S,className:"px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:S,className:"px-4 py-2 text-xs font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:hover:scale-100",children:S?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Log Activity for ",te.length," ",te.length===1?"Contact":"Contacts"]})})]})]})})]})})}const Vn=l=>l.type==="call"&&l.callDate?new Date(l.callDate):l.type==="email"&&l.emailDate?new Date(l.emailDate):l.type==="linkedin"&&l.linkedinDate?new Date(l.linkedinDate):new Date(l.createdAt),Tc=l=>{const n=new Date(l);return n.setHours(0,0,0,0),n},ap=(...l)=>{},Zk=l=>{if(!l._id)return null;try{const n=l._id.toString?l._id.toString():String(l._id);if(n.length>=8){const a=parseInt(n.substring(0,8),16)*1e3;return new Date(a)}}catch(n){console.error("Error extracting import date from contact ID:",n)}return l.createdAt?new Date(l.createdAt):null},Eo={};function eC(){const{id:l}=di(),n=Dr(),[a,o]=i0(),[s,e]=B.useState(null),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState(null),[L,M]=B.useState(a.get("search")||""),[F,O]=B.useState(""),P=B.useRef(null),K=B.useRef(!1),ne=B.useRef(!1),[se,Ce]=B.useState(a.get("quickFilter")||""),[ge,Ne]=B.useState(a.get("filterStatus")||""),[J,de]=B.useState(a.get("filterActionDate")||""),[le,ze]=B.useState(a.get("filterActionDateFrom")||""),[me,oe]=B.useState(a.get("filterActionDateTo")||""),[ce,ye]=B.useState(a.get("filterLastInteraction")||""),[ke,fe]=B.useState(a.get("filterLastInteractionFrom")||""),[Se,Ye]=B.useState(a.get("filterLastInteractionTo")||""),[te,pe]=B.useState(a.get("filterImportDate")||""),[V,be]=B.useState(a.get("filterImportDateFrom")||""),[_e,De]=B.useState(a.get("filterImportDateTo")||""),[W,H]=B.useState(a.get("filterNoActivity")==="true"),[X,je]=B.useState(a.get("filterMatchType")||""),[Q,we]=B.useState(null),[Fe,ue]=B.useState("linkedin"),[xe,tt]=B.useState({isOpen:!1,filter:null}),Qe=B.useCallback(G=>{tt({isOpen:!0,filter:G}),we(G);const Oe=new URLSearchParams(a);Oe.set("kpiChannel",G.channel),Oe.set("kpiMetric",G.metric),Oe.set("kpiOpen","1"),o(Oe,{replace:!0})},[a,o]),Ve=B.useCallback(()=>{tt({isOpen:!1,filter:null}),we(null);const G=new URLSearchParams(a);G.delete("kpiChannel"),G.delete("kpiMetric"),G.delete("kpiOpen"),o(G,{replace:!0})},[a,o]),[xt,nt]=B.useState(null),[$t,Mt]=B.useState(new Set),[Es,qs]=B.useState({}),[ms,ys]=B.useState({}),[Re,ht]=B.useState({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,lastActivity:null}),[Ft,Is]=B.useState(!1),[jr,$r]=B.useState([]),[Za,ul]=B.useState(new Set),[ka,ma]=B.useState(!1),[Ir,xr]=B.useState({isOpen:!1,type:null}),[Io,Hl]=B.useState({}),[nh,qc]=B.useState({}),[Vl,Ua]=B.useState(!1),[Yn,es]=B.useState(!1),[ui,Wl]=B.useState(new Set),[is,$l]=B.useState(null),[Mi,ql]=B.useState(!1),[hi,qr]=B.useState(null),[fi,Bo]=B.useState("asc"),[Li,mi]=B.useState(!1),Ri=B.useRef(null),Nr=B.useMemo(()=>{if(!s?.channels)return["call","email","linkedin"];const G=[];return s.channels.coldCalling&&G.push("call"),s.channels.coldEmail&&G.push("email"),s.channels.linkedInOutreach&&G.push("linkedin"),G.length>0?G:["call","email","linkedin"]},[s?.channels]),Tr=B.useMemo(()=>{if(!jr||jr.length===0)return{linkedin:{today:0,tomorrow:0,missed:0},email:{today:0,tomorrow:0,missed:0}};const G=Tc(new Date),Oe=new Date(G);Oe.setDate(Oe.getDate()+1);const Xe=new Date(Oe);Xe.setDate(Xe.getDate()+1);const He={linkedin:new Map,email:new Map};jr.forEach(Ue=>{if(!Ue.nextActionDate||!Ue.contactId)return;const lt=Ue.contactId.toString?Ue.contactId.toString():Ue.contactId,Ke=Tc(Ue.nextActionDate);if(Ue.type==="linkedin"){const Be=He.linkedin,Nt=Be.get(lt);(!Nt||Ke<Nt)&&Be.set(lt,Ke)}else if(Ue.type==="email"){const Be=He.email,Nt=Be.get(lt);(!Nt||Ke<Nt)&&Be.set(lt,Ke)}});const st=Ue=>{let lt=0,Ke=0,Be=0;return Ue.forEach(Nt=>{Nt>=G&&Nt<Oe?lt+=1:Nt>=Oe&&Nt<Xe?Ke+=1:Nt<G&&(Be+=1)}),{today:lt,tomorrow:Ke,missed:Be}};return{linkedin:st(He.linkedin),email:st(He.email)}},[jr]);B.useEffect(()=>{Nr.length>0&&!Nr.includes(Fe)&&ue(Nr[0])},[Nr,Fe]),B.useEffect(()=>{const G=Oe=>{Ri.current&&!Ri.current.contains(Oe.target)&&mi(!1)};return Li&&document.addEventListener("mousedown",G),()=>{document.removeEventListener("mousedown",G)}},[Li]),B.useEffect(()=>{const G=a.get("search")||"";G&&O(G)},[]),B.useEffect(()=>(P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{O(L)},300),()=>{P.current&&clearTimeout(P.current)}),[L]),B.useEffect(()=>{if(l){a.get("returnTo")||a.get("page")||a.get("kpiChannel")||a.get("kpiMetric")||a.get("kpiOpen")==="1"||(M(""),Ce(""),Ne(""),de(""),ze(""),oe(""),ye(""),fe(""),Ye(""),pe(""),be(""),De(""),H(!1),je(""),we(null),tt({isOpen:!1,filter:null}),o(new URLSearchParams,{replace:!0}));const Oe=Eo[l];Oe&&(Oe.project&&e(Oe.project),Oe.kpiMetrics&&$l(Oe.kpiMetrics),Oe.contacts&&v(Oe.contacts),Oe.allProjectActivities&&$r(Oe.allProjectActivities),N(!1)),_s().then(()=>{const Xe=a.get("page"),He=Xe?parseInt(Xe,10):1;He!==vs&&lr(He),Promise.all([hr().catch(st=>{console.error("Error fetching activities:",st)}),ga(He).catch(st=>{console.error("Error fetching imported contacts:",st)}),Ha().catch(st=>{console.error("Error fetching KPI metrics:",st)})])})}},[l]),B.useEffect(()=>{if(!l)return;const G=a.get("kpiChannel"),Oe=a.get("kpiMetric"),Xe=a.get("kpiOpen")==="1";if(G&&Oe){const He={channel:G,metric:Oe};we(He),tt(Xe?{isOpen:!0,filter:He}:st=>st.isOpen?{isOpen:!1,filter:null}:st)}else we(null),tt({isOpen:!1,filter:null})},[l,a]),B.useEffect(()=>{if(!l)return;if(!K.current){K.current=!0;return}lr(1);const G=new URLSearchParams(a);G.delete("page"),o(G,{replace:!0}),ga(1)},[F,l]),B.useEffect(()=>{if(!l)return;const G=a.get("page"),Oe=G?parseInt(G,10):1;if(Oe!==vs&&Oe>=1){const Xe=setTimeout(()=>{Oe!==vs&&(lr(Oe),Ma||ga(Oe))},50);return()=>clearTimeout(Xe)}},[a.get("page"),l,a,Ma]),B.useEffect(()=>{if(!l)return;if(!ne.current){ne.current=!0;return}lr(1);const G=new URLSearchParams(a);G.delete("page"),o(G,{replace:!0}),ga(1)},[se,ge,J,le,me,ce,ke,Se,te,V,_e,W,X,Q,l]);const _s=async()=>{try{N(!0);const G=await Ut.get(`/projects/${l}`);if(G.data.success){const Oe=G.data.data;e(Oe),Eo[l]={...Eo[l]||{},project:Oe}}}catch(G){console.error("Error fetching project:",G),D("Having trouble loading the project. Refresh the page and try again.")}finally{N(!1)}},Ha=async()=>{try{ql(!0);const G=await Ut.get(`/projects/${l}/kpi-metrics`);if(G.data.success){const Oe=G.data.data;$l(Oe),Eo[l]={...Eo[l]||{},kpiMetrics:Oe}}}catch(G){console.error("Error fetching KPI metrics:",G)}finally{ql(!1)}},[vs,lr]=B.useState(()=>{const G=a.get("page");return G?parseInt(G,10):1}),[en,o0]=B.useState(0),[mn,zo]=B.useState(1),gn=50,Ma=!!(F||se||ge||J||le||me||ce||ke||Se||te||V||_e||W||X||Q),ga=async(G=1)=>{try{N(!0);const Oe=Ma?1e4:gn,Xe=Ma?1:G,He=F?`&search=${encodeURIComponent(F)}`:"",st=await Ut.get(`/projects/${l}/project-contacts?page=${Xe}&limit=${Oe}${He}`);if(st.data.success){const Ue=st.data.data||[],lt=st.data.pagination||{};o0(lt.total||Ue.length),zo(lt.totalPages||1),lr(G);const Ke=new Map;Ue.forEach(Nt=>{const Ct=Nt._id?.toString?Nt._id.toString():String(Nt._id);if(!Ct)return;const Rt=Ke.get(Ct);if(!Rt)Ke.set(Ct,Nt);else{const Le=Rt.projectContactId!==null&&Rt.projectContactId!==void 0;Nt.projectContactId!==null&&Nt.projectContactId!==void 0&&!Le&&Ke.set(Ct,Nt)}});let Be=Array.from(Ke.values());ui.size>0&&(Be=Be.filter(Nt=>{if(!Nt._id)return!0;const Ct=Nt._id.toString?Nt._id.toString():String(Nt._id);return!ui.has(Ct)})),v(Be),G===1&&!F&&(Eo[l]={...Eo[l]||{},contacts:Be})}}catch(Oe){console.error("Error fetching imported contacts:",Oe)}finally{N(!1)}},Br=B.useCallback(G=>{if(G<1||G===vs)return;const Oe=new URLSearchParams(a);G===1?Oe.delete("page"):Oe.set("page",G.toString()),o(Oe,{replace:!0}),lr(G),Ma||ga(G)},[vs,Ma,a,o]),kr=async()=>{try{const G=await Ut.get(`/projects/${l}/similar-contacts`);if(G.data.success){let Oe=G.data.data||[];if(ui.size>0){const Xe=Oe.length;Oe=Oe.filter(He=>{if(!He._id)return!0;const st=He._id.toString?He._id.toString():String(He._id);return!ui.has(st)}),Xe!==Oe.length&&ap(`Filtered out ${Xe-Oe.length} previously deleted contact(s) from similar contacts`)}return v(Oe),G.data.matchStats&&nt(G.data.matchStats),G.data.hasICP===!1?(ma(!1),ka&&alert(G.data.message||"No ICP defined for this project. Please add an ICP definition to get suggestions."),!1):!0}}catch(G){return console.error("Error fetching similar contacts:",G),!1}},zr=s?.icpDefinition?.companySizeMin!==void 0&&s?.icpDefinition?.companySizeMax!==void 0&&!(s.icpDefinition.companySizeMin===0&&s.icpDefinition.companySizeMax===1e3),La=s?.icpDefinition?.targetIndustries&&Array.isArray(s.icpDefinition.targetIndustries)&&s.icpDefinition.targetIndustries.length>0,gi=s?.icpDefinition?.targetJobTitles&&Array.isArray(s.icpDefinition.targetJobTitles)&&s.icpDefinition.targetJobTitles.length>0,xs=s?.icpDefinition?.geographies&&Array.isArray(s.icpDefinition.geographies)&&s.icpDefinition.geographies.length>0,Yc=s?.icpDefinition?.keywords&&Array.isArray(s.icpDefinition.keywords)&&s.icpDefinition.keywords.length>0,tn=La||gi||xs||Yc||zr;B.useEffect(()=>{const G=new URLSearchParams;L&&G.set("search",L),se&&G.set("quickFilter",se),ge&&G.set("filterStatus",ge),J&&G.set("filterActionDate",J),le&&G.set("filterActionDateFrom",le),me&&G.set("filterActionDateTo",me),ce&&G.set("filterLastInteraction",ce),ke&&G.set("filterLastInteractionFrom",ke),Se&&G.set("filterLastInteractionTo",Se),te&&G.set("filterImportDate",te),V&&G.set("filterImportDateFrom",V),_e&&G.set("filterImportDateTo",_e),W&&G.set("filterNoActivity","true"),X&&G.set("filterMatchType",X),o(G,{replace:!0})},[L,se,ge,J,le,me,ce,ke,Se,te,V,_e,W,X,o]),B.useEffect(()=>{ka&&!tn&&(ma(!1),ga().catch(G=>{console.error("Error fetching imported contacts:",G)}))},[tn,ka]);const hl=async()=>{if(!tn){alert("No ICP (Ideal Customer Profile) is defined for this project. Please add an ICP definition in project settings to get suggestions.");return}const G=!ka;ma(G),G?(!await kr()||!tn)&&(ma(!1),tn||alert("No ICP (Ideal Customer Profile) is defined for this project. Please add an ICP definition in project settings to get suggestions.")):await ga()},hr=async()=>{try{const G=await Ut.get(`/activities/project/${l}?limit=5000`);if(G.data.success){const Oe=G.data.data||[];$r(Oe),Eo[l]={...Eo[l]||{},allProjectActivities:Oe},Ha()}}catch(G){console.error("Error fetching project activities:",G)}},_r=B.useMemo(()=>{const G={byContactId:new Map,lastActivityByContactId:new Map,nextActionByContactId:new Map,latestActivityStatusByContactId:new Map},Oe=new Date;return jr.forEach(Xe=>{if(Xe.contactId){const He=Xe.contactId.toString();G.byContactId.has(He)||G.byContactId.set(He,[]),G.byContactId.get(He).push(Xe);const st=G.lastActivityByContactId.get(He),Ue=Vn(Xe);if(!st)G.lastActivityByContactId.set(He,Xe);else{const Ke=Vn(st);Ue>Ke&&G.lastActivityByContactId.set(He,Xe)}if(Xe.nextActionDate){const Ke=Tc(Xe.nextActionDate),Be=Tc(Oe),Nt=G.nextActionByContactId.get(He),Ct=Nt?Tc(Nt.nextActionDate):null,Rt=Ct!=null&&Ct<Be;Ke>=Be?(!Nt||Rt||Ct>Ke)&&G.nextActionByContactId.set(He,Xe):Nt?Rt&&Ke>Ct&&G.nextActionByContactId.set(He,Xe):G.nextActionByContactId.set(He,Xe)}let lt=null;if(Xe.type==="call"&&Xe.callStatus&&Xe.callStatus.trim()!==""?lt=Xe.callStatus:Xe.status&&Xe.status.trim()!==""&&(lt=Xe.status),lt){const Ke=G.latestActivityStatusByContactId.get(He),Be=Vn(Xe);if(!Ke)G.latestActivityStatusByContactId.set(He,{status:lt,createdAt:Be,activityDate:Be});else{const Nt=Ke.activityDate?new Date(Ke.activityDate):new Date(Ke.createdAt);Be>Nt&&G.latestActivityStatusByContactId.set(He,{status:lt,createdAt:Be,activityDate:Be})}}}}),G},[jr]),Fr=B.useCallback(async(G,Oe,Xe)=>{if(ms[G])return;const He=G?.toString?G.toString():G;if(He)try{ys(lt=>({...lt,[G]:!0}));const Ue=(_r.byContactId.get(He)||[]).filter(lt=>lt.projectId&&lt.projectId.toString()===l);if(Ue.length>0){qs(lt=>({...lt,[G]:Ue.sort((Ke,Be)=>new Date(Be.createdAt)-new Date(Ke.createdAt))})),ys(lt=>({...lt,[G]:!1}));return}try{const lt=await Ut.get(`/activities/contact/${He}?projectId=${l}`);if(lt.data.success){const Ke=lt.data.data||[];qs(Be=>({...Be,[G]:Ke.sort((Nt,Ct)=>new Date(Ct.createdAt)-new Date(Nt.createdAt))}))}}catch(lt){console.warn(`API call failed for contact ${He}, using cached activities:`,lt.message);const Ke=jr.filter(Be=>{if((Be.projectId?.toString?Be.projectId.toString():Be.projectId)!==l)return!1;if(Be.contactId&&(Be.contactId.toString?Be.contactId.toString():Be.contactId)===He)return!0;if(Oe||Xe){const Ct=Oe?.toLowerCase()||"",Rt=Xe?.toLowerCase()||"",Le=Be.conversationNotes?.toLowerCase()||"";return Le.includes(Ct)||Le.includes(Rt)}return!1});qs(Be=>({...Be,[G]:Ke.sort((Nt,Ct)=>new Date(Ct.createdAt)-new Date(Nt.createdAt))}))}}catch(st){console.error("Error fetching activities:",st)}finally{ys(st=>({...st,[G]:!1}))}},[ms,_r,jr]),Gn=B.useCallback(async(G,Oe,Xe)=>{$t.has(G)?B.startTransition(()=>{Mt(st=>{const Ue=new Set(st);return Ue.delete(G),Ue})}):(B.startTransition(()=>{Mt(st=>new Set(st).add(G))}),Fr(G,Oe,Xe).catch(st=>{console.error("Error fetching activities:",st)}))},[$t,Fr]),Ca=(G,Oe)=>{const Xe=Oe._id?Oe._id.toString?Oe._id.toString():String(Oe._id):null;let He=null,st=G;Xe&&(He=_r.lastActivityByContactId.get(Xe)||null,He&&He.type&&(st=He.type)),ht({isOpen:!0,type:st,contactName:Oe.name||"N/A",companyName:Oe.company||"",projectId:l,contactId:Xe||null,phoneNumber:Oe.firstPhone||null,email:Oe.email||null,linkedInProfileUrl:Oe.personLinkedinUrl||Oe.companyLinkedinUrl||null,lastActivity:He||null})},fs=async(G=!1)=>{ht({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,lastActivity:null}),await hr(),await new Promise(Oe=>setTimeout(Oe,100)),ka?await kr():await ga(),$t.forEach(Oe=>{const Xe=m.find(He=>(He._id||He.name)===Oe);Xe&&Fr(Oe,Xe.email,Xe.name)})},Tn=async()=>{xr({isOpen:!1,type:null}),ul(new Set),await hr(),await new Promise(G=>setTimeout(G,100)),ka?await kr():await ga(),$t.forEach(G=>{const Oe=m.find(Xe=>(Xe._id||Xe.name)===G);Oe&&Fr(G,Oe.email,Oe.name)})},Uo=G=>G?G.split(" ").map(Oe=>Oe[0]).join("").toUpperCase().slice(0,2):"?",Gc=G=>{const Xe={Ring:{bg:"bg-yellow-100",text:"text-yellow-800"},Busy:{bg:"bg-orange-100",text:"text-orange-800"},"Call Back":{bg:"bg-amber-100",text:"text-amber-800"},"Hang Up":{bg:"bg-red-100",text:"text-red-800"},"Switch Off":{bg:"bg-gray-100",text:"text-gray-800"},Invalid:{bg:"bg-red-100",text:"text-red-800"},Future:{bg:"bg-blue-100",text:"text-blue-800"},Existing:{bg:"bg-indigo-100",text:"text-indigo-800"},Interested:{bg:"bg-green-100",text:"text-green-800"},"Not Interested":{bg:"bg-red-100",text:"text-red-800"},"Details Shared":{bg:"bg-cyan-100",text:"text-cyan-800"},"Demo Booked":{bg:"bg-purple-100",text:"text-purple-800"},"Demo Completed":{bg:"bg-emerald-100",text:"text-emerald-800"},CIP:{bg:"bg-blue-100",text:"text-blue-800"},"No Reply":{bg:"bg-gray-100",text:"text-gray-800"},"Out of Office":{bg:"bg-gray-100",text:"text-gray-800"},"Meeting Proposed":{bg:"bg-yellow-100",text:"text-yellow-800"},"Meeting Scheduled":{bg:"bg-cyan-100",text:"text-cyan-800"},"In-Person Meeting":{bg:"bg-indigo-100",text:"text-indigo-800"},"Meeting Completed":{bg:"bg-green-100",text:"text-green-800"},SQL:{bg:"bg-emerald-100",text:"text-emerald-800"},"Tech Discussion":{bg:"bg-purple-100",text:"text-purple-800"},WON:{bg:"bg-green-200",text:"text-green-900",border:"border-2 border-green-400"},Lost:{bg:"bg-red-200",text:"text-red-900",border:"border-2 border-red-400"},"Low Potential - Open":{bg:"bg-orange-100",text:"text-orange-800"},"Potential Future":{bg:"bg-teal-100",text:"text-teal-800"},"Wrong Person":{bg:"bg-red-100",text:"text-red-800"},Bounce:{bg:"bg-red-100",text:"text-red-800"},"Opt-Out":{bg:"bg-red-100",text:"text-red-800"},New:{bg:"bg-blue-100",text:"text-blue-800"},Contacted:{bg:"bg-purple-100",text:"text-purple-800"},Qualified:{bg:"bg-green-100",text:"text-green-800"},Proposal:{bg:"bg-yellow-100",text:"text-yellow-800"},Negotiation:{bg:"bg-orange-100",text:"text-orange-800"}}[G]||{bg:"bg-gray-100",text:"text-gray-800"};return t.jsx("span",{className:`inline-flex items-center justify-center px-2.5 py-1 text-xs font-medium rounded-full whitespace-nowrap ${Xe.bg} ${Xe.text} ${Xe.border||""}`,children:G})},sn=G=>{if(!G)return"N/A";const Oe=G instanceof Date?G:new Date(G);return isNaN(Oe.getTime())?"N/A":Oe.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},Kc=G=>{if(!G)return"N/A";const Oe=G instanceof Date?G:new Date(G);return isNaN(Oe.getTime())?"N/A":Oe.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},ws=({contact:G,activities:Oe})=>{const Xe=()=>{const Ke=Oe.filter(Le=>Le.type==="call").length,Be=Oe.filter(Le=>Le.type==="email").length,Nt=Oe.filter(Le=>Le.type==="linkedin").length,Ct=Oe.length,Rt=Math.min(100,Math.max(0,Ct*10+(Ct>0?30:0)));return{totalInteractions:Ct,callsMade:Ke,emailsSent:Be,linkedInMessages:Nt,engagementScore:Rt}},He=Ke=>{switch(Ke){case"call":return t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},st=Ke=>{switch(Ke){case"call":return"Call";case"email":return"Email";case"linkedin":return"LinkedIn";default:return"Activity"}},Ue=Ke=>({"connected-had-conversation":"Connected","left-voicemail":"Left Voicemail","no-answer":"No Answer","wrong-number":"Wrong Number","not-interested":"Not Interested","email-sent-successfully":"Sent","email-bounced":"Bounced","received-reply":"Received Reply","out-of-office-response":"Out of Office","connection-request-sent":"Connection Request Sent","message-sent":"Message Sent","connection-accepted":"Connection Accepted"})[Ke]||Ke,lt=Xe();return t.jsxs("div",{className:"py-4 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),t.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Activity Summary"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-600",children:"Calls Made"}),t.jsx("span",{className:"text-xs font-semibold text-gray-900",children:lt.callsMade})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-600",children:"Emails Sent"}),t.jsx("span",{className:"text-xs font-semibold text-gray-900",children:lt.emailsSent})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-600",children:"LinkedIn Messages"}),t.jsx("span",{className:"text-xs font-semibold text-gray-900",children:lt.linkedInMessages})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Engagement Score"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:lt.engagementScore}),t.jsx("div",{className:"text-xs text-gray-500",children:"out of 100"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Interaction Timeline"}),t.jsxs("button",{onClick:()=>Ca("call",G),className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Log Activity"]})]}),Oe.length===0?t.jsx("div",{className:"text-center py-8 text-gray-500 text-sm transition-opacity duration-300",children:'No activities logged yet. Click "Log Activity" to get started.'}):t.jsx("div",{className:"space-y-4 animate-fade-in",children:Oe.sort((Ke,Be)=>Vn(Be)-Vn(Ke)).map((Ke,Be)=>t.jsxs("div",{className:"flex items-start gap-4 pb-4 border-b border-gray-100 last:border-0 transition-all duration-300 hover:bg-gray-50 rounded-lg px-2 -mx-2 py-1",style:{animationDelay:`${Be*50}ms`},children:[t.jsx("div",{className:"flex-shrink-0 mt-1",children:He(Ke.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"mb-2",children:t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:st(Ke.type)})}),Ke.conversationNotes&&(()=>{const Ct=Ke.conversationNotes.replace(/\[Contact:.*?\|.*?Email:.*?\|.*?Phone:.*?\|.*?LinkedIn:.*?\]/g,"").trim().replace(/\[Contact:.*?\]/g,"").trim();return Ct?t.jsx("p",{className:"text-sm text-gray-700 mb-2 whitespace-pre-wrap leading-relaxed",children:Ct}):null})(),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("span",{className:`px-2 py-0.5 rounded font-medium ${Ke.type==="call"?"bg-blue-100 text-blue-700":Ke.type==="email"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:Ue(Ke.outcome)}),t.jsxs("span",{children:["by ",s?.assignedTo||"User"]})]})]}),t.jsx("div",{className:"flex-shrink-0 text-xs text-gray-500 text-right whitespace-nowrap",children:Kc(Vn(Ke))})]},Ke._id))})]})]})},Ra=B.useMemo(()=>m.filter(G=>{if(ge){const Oe=(G._id?.toString?G._id.toString():G._id)||"";if(((Oe?_r.latestActivityStatusByContactId.get(Oe):null)?.status||null||G.stage||"New")!==ge)return!1}if(J||le||me){G._id||G.name;const Oe=G._id?.toString?G._id.toString():G._id,Xe=Oe?_r.nextActionByContactId.get(Oe):null;if(J==="custom"&&(le||me)){if(!Xe||!Xe.nextActionDate)return!1;const He=new Date(Xe.nextActionDate);if(He.setHours(0,0,0,0),le){const st=new Date(le);if(st.setHours(0,0,0,0),He<st)return!1}if(me){const st=new Date(me);if(st.setHours(23,59,59,999),He>st)return!1}}else if(J&&J!=="custom"){if(!Xe||!Xe.nextActionDate)return!1;const He=new Date(Xe.nextActionDate);He.setHours(0,0,0,0);const st=new Date,Ue=new Date(st.getFullYear(),st.getMonth(),st.getDate()),lt=new Date(Ue);switch(lt.setDate(lt.getDate()+1),J){case"today":if(He<Ue||He>=lt)return!1;break;case"this-week":const Ke=Ue.getDay(),Be=Ke===0?6:Ke-1,Nt=new Date(Ue);Nt.setDate(Ue.getDate()-Be),Nt.setHours(0,0,0,0);const Ct=new Date(Nt);if(Ct.setDate(Nt.getDate()+7),He<Nt||He>=Ct)return!1;break;case"this-month":const Rt=new Date(st.getFullYear(),st.getMonth(),1),Le=new Date(st.getFullYear(),st.getMonth()+1,1);if(He<Rt||He>=Le)return!1;break}}}if(ce||ke||Se){const Oe=(G._id?.toString?G._id.toString():G._id)||"",Xe=Oe?_r.lastActivityByContactId.get(Oe):null;if(ce==="custom"&&(ke||Se)){if(!Xe)return!1;const He=Vn(Xe);if(He.setHours(0,0,0,0),ke){const st=new Date(ke);if(st.setHours(0,0,0,0),He<st)return!1}if(Se){const st=new Date(Se);if(st.setHours(23,59,59,999),He>st)return!1}}else if(ce&&ce!=="custom"){if(!Xe)return!1;const He=Vn(Xe);He.setHours(0,0,0,0);const st=new Date,Ue=new Date(st.getFullYear(),st.getMonth(),st.getDate()),lt=new Date(Ue);switch(lt.setDate(lt.getDate()+1),ce){case"today":if(He<Ue||He>=lt)return!1;break;case"this-week":const Ke=Ue.getDay(),Be=Ke===0?6:Ke-1,Nt=new Date(Ue);Nt.setDate(Ue.getDate()-Be),Nt.setHours(0,0,0,0);const Ct=new Date(Nt);if(Ct.setDate(Nt.getDate()+7),He<Nt||He>=Ct)return!1;break;case"this-month":const Rt=new Date(st.getFullYear(),st.getMonth(),1),Le=new Date(st.getFullYear(),st.getMonth()+1,1);if(He<Rt||He>=Le)return!1;break}}}if(te||V||_e){const Oe=Zk(G);if(!Oe)return!1;if(te==="custom"&&(V||_e)){const Xe=new Date(Oe);if(Xe.setHours(0,0,0,0),V){const He=new Date(V);if(He.setHours(0,0,0,0),Xe<He)return!1}if(_e){const He=new Date(_e);if(He.setHours(23,59,59,999),Xe>He)return!1}}else if(te&&te!=="custom"){const Xe=new Date(Oe);Xe.setHours(0,0,0,0);const He=new Date,st=new Date(He.getFullYear(),He.getMonth(),He.getDate()),Ue=new Date(st);Ue.setDate(Ue.getDate()-1);const lt=new Date(st);switch(lt.setDate(lt.getDate()+1),te){case"today":if(Xe<st||Xe>=lt)return!1;break;case"yesterday":if(Xe<Ue||Xe>=st)return!1;break}}}if(W){const Oe=(G._id?.toString?G._id.toString():G._id)||"";if((Oe?_r.lastActivityByContactId.get(Oe):null)||jr.some(st=>{if(!st.contactId)return!1;if((st.contactId.toString?st.contactId.toString():st.contactId)===Oe)return!0;if(!Oe){const lt=G.email?.toLowerCase()||"",Ke=G.name?.toLowerCase()||"",Be=st.conversationNotes?.toLowerCase()||"",Nt=st.email?.toLowerCase()||"";return lt&&(Be.includes(lt)||Nt===lt)||Ke&&Be.includes(Ke)}return!1}))return!1}if(Q){const Oe=(G._id?.toString?G._id.toString():G._id)||"",Xe=jr.filter(st=>{if((st.projectId?.toString?st.projectId.toString():st.projectId)!==l)return!1;if(Oe&&st.contactId&&(st.contactId.toString?st.contactId.toString():st.contactId)===Oe)return!0;if(!Oe||!st.contactId){const lt=st.conversationNotes?.toLowerCase()||"",Ke=G.name?.toLowerCase()||"",Be=G.email?.toLowerCase()||"";return lt.includes(Ke)||lt.includes(Be)}return!1});let He=!1;if(Q.channel==="linkedin"){const st=Xe.filter(Ue=>Ue.type==="linkedin");Q.metric==="connectionSent"?He=st.some(Ue=>Ue.lnRequestSent===!0||Ue.lnRequestSent==="Yes"):Q.metric==="accepted"?He=st.some(Ue=>Ue.connected===!0||Ue.connected==="Yes"):Q.metric==="followUps"?He=st.length>1:Q.metric==="cip"?He=st.some(Ue=>Ue.status&&(Ue.status==="CIP"||Ue.status==="Conversations in Progress")):Q.metric==="meetingProposed"?He=st.some(Ue=>Ue.status==="Meeting Proposed"):Q.metric==="scheduled"?He=st.some(Ue=>Ue.status==="Meeting Scheduled"):Q.metric==="completed"?He=st.some(Ue=>Ue.status==="Meeting Completed"):Q.metric==="sql"?He=G.stage==="SQL":Q.metric==="win"?He=G.stage==="WON":Q.metric==="connectionRequestsSent"?He=st.some(Ue=>Ue.lnRequestSent===!0||Ue.lnRequestSent==="Yes"):Q.metric==="connectionAcceptanceRate"?He=st.some(Ue=>Ue.connected===!0||Ue.connected==="Yes"):Q.metric==="messagesSent"?He=st.some(Ue=>Ue.status&&Ue.status!==""):Q.metric==="messageReplyRate"?He=st.some(Ue=>Ue.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Ue.status)):Q.metric==="meetingsBooked"&&(He=st.some(Ue=>Ue.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Ue.status)))}else if(Q.channel==="call"){const st=Xe.filter(Ue=>Ue.type==="call");Q.metric==="allProspects"?He=!0:Q.metric==="callsAttempted"||Q.metric==="totalCalls"?He=st.length>0:Q.metric==="callsConnected"?He=st.some(Ue=>Ue.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Ue.callStatus)):Q.metric==="decisionMakerReached"?He=st.some(Ue=>Ue.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up","Not Interested"].includes(Ue.callStatus)):Q.metric==="interested"?He=st.some(Ue=>Ue.callStatus==="Interested"):Q.metric==="notInterested"?He=st.some(Ue=>Ue.callStatus==="Not Interested"):Q.metric==="detailsShared"?He=st.some(Ue=>Ue.callStatus==="Details Shared"):Q.metric==="demoBooked"?He=st.some(Ue=>Ue.callStatus==="Demo Booked"):Q.metric==="demoCompleted"?He=st.some(Ue=>Ue.callStatus==="Demo Completed"):Q.metric==="sql"?He=G.stage==="SQL":Q.metric==="won"?He=G.stage==="WON":Q.metric==="callsMade"?He=st.length>0:Q.metric==="callAnswerRate"?He=st.some(Ue=>Ue.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Ue.callStatus)):Q.metric==="callInterestedRate"?He=st.some(Ue=>Ue.callStatus&&["Interested","Details Shared","Demo Booked","Demo Completed"].includes(Ue.callStatus)):Q.metric==="meetingsBooked"&&(He=st.some(Ue=>Ue.callStatus&&["Demo Booked","Demo Completed"].includes(Ue.callStatus)))}else if(Q.channel==="email"){const st=Xe.filter(Ue=>Ue.type==="email");Q.metric==="emailsSent"?He=st.length>0:Q.metric==="accepted"?He=st.some(Ue=>Ue.status&&Ue.status!=="Bounce"&&Ue.status!=="Opt-Out"&&Ue.status!=="No Reply"):Q.metric==="followups"?He=st.length>1:Q.metric==="cip"?He=st.some(Ue=>Ue.status&&(Ue.status==="CIP"||Ue.status==="Conversations in Progress")):Q.metric==="meetingProposed"?He=st.some(Ue=>Ue.status==="Meeting Proposed"):Q.metric==="scheduled"?He=st.some(Ue=>Ue.status==="Meeting Scheduled"):Q.metric==="completed"?He=st.some(Ue=>Ue.status==="Meeting Completed"):Q.metric==="sql"?He=G.stage==="SQL":Q.metric==="emailBounce"?He=st.some(Ue=>Ue.status==="Bounce"):Q.metric==="emailOpenRate"?He=st.some(Ue=>Ue.status&&Ue.status!=="Bounce"&&Ue.status!=="Opt-Out"&&Ue.status!=="No Reply"):Q.metric==="emailReplyRate"?He=st.some(Ue=>Ue.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Ue.status)):Q.metric==="meetingsBooked"&&(He=st.some(Ue=>Ue.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Ue.status)))}if(!He)return!1}if(se==="due-today"){const Oe=new Date;Oe.setHours(0,0,0,0);const Xe=new Date(Oe);Xe.setDate(Xe.getDate()+1);const He=(G._id?.toString?G._id.toString():G._id)||"";if(!(He?_r.byContactId.get(He)||[]:[]).some(lt=>{if(!lt.nextActionDate)return!1;const Ke=new Date(lt.nextActionDate);return Ke.setHours(0,0,0,0),Ke>=Oe&&Ke<Xe}))return!1}else if(se==="new-prospects"){const Oe=(G._id?.toString?G._id.toString():G._id)||"";if(((Oe?_r.latestActivityStatusByContactId.get(Oe):null)?.status||null||G.stage||"New")!=="New")return!1}return!0}).sort((G,Oe)=>{if(hi==="name"){const Xe=(G.name||"").toLowerCase(),He=(Oe.name||"").toLowerCase();return fi==="asc"?Xe.localeCompare(He):He.localeCompare(Xe)}return 0}),[m,F,se,ge,J,le,me,ce,ke,Se,te,V,_e,W,X,Q,jr,s,_r,l,hi,fi]),{paginatedFilteredContacts:Qc,filteredTotal:Ys,filteredTotalPages:Va}=B.useMemo(()=>{const G=Ra.length,Oe=Math.max(1,Math.ceil(G/gn));if(Ma){const Xe=(vs-1)*gn;return{paginatedFilteredContacts:Ra.slice(Xe,Xe+gn),filteredTotal:G,filteredTotalPages:Oe}}return{paginatedFilteredContacts:Ra,filteredTotal:en,filteredTotalPages:mn}},[Ra,Ma,vs,en,mn]),[Yl,Oi]=B.useState([]),[pi,Xc]=B.useState(!1),Jc=B.useCallback(async()=>{try{Xc(!0),Oi([]);const G=await Ut.get(`/projects/${l}/project-contacts?page=1&limit=10000`);if(G.data.success){const Oe=G.data.data||[],He=(G.data.pagination||{}).total||Oe.length;let st=[...Oe];if(Oe.length<He&&He>1e4){const Ke=Math.ceil(He/1e4),Be=[];for(let Nt=2;Nt<=Ke;Nt++)try{const Ct=await Ut.get(`/projects/${l}/project-contacts?page=${Nt}&limit=10000`);Ct.data.success&&Be.push(...Ct.data.data||[])}catch(Ct){console.error(`Error fetching page ${Nt} for KPI:`,Ct)}st=[...Oe,...Be]}const Ue=new Map;st.forEach(Ke=>{const Be=Ke._id?.toString?Ke._id.toString():String(Ke._id);if(!Be)return;const Nt=Ue.get(Be);if(!Nt)Ue.set(Be,Ke);else{const Ct=Nt.projectContactId!==null&&Nt.projectContactId!==void 0;Ke.projectContactId!==null&&Ke.projectContactId!==void 0&&!Ct&&Ue.set(Be,Ke)}});const lt=Array.from(Ue.values());Oi(lt)}}catch(G){console.error("Error fetching all contacts for KPI:",G),Oi([])}finally{Xc(!1)}},[l]),or=B.useCallback(G=>G?(Yl.length>0?Yl:m).filter(Xe=>{const He=(Xe._id?.toString?Xe._id.toString():Xe._id)||"",Ue=(He?_r.byContactId.get(He)||[]:[]).filter(Ke=>(Ke.projectId?.toString?Ke.projectId.toString():Ke.projectId)===l);if(Ue.length===0&&(!He||He==="")){const Ke=jr.filter(Le=>{if((Le.projectId?.toString?Le.projectId.toString():Le.projectId)!==l)return!1;const js=Le.conversationNotes?.toLowerCase()||"",cr=Xe.name?.toLowerCase()||"",hs=Xe.email?.toLowerCase()||"";return js.includes(cr)||js.includes(hs)});if(Ke.length===0)return!1;const Be=Ke.filter(Le=>Le.type==="linkedin"),Nt=Ke.filter(Le=>Le.type==="call"),Ct=Ke.filter(Le=>Le.type==="email");let Rt=!1;if(G.channel==="linkedin")G.metric==="connectionSent"?Rt=Be.some(Le=>Le.lnRequestSent===!0||Le.lnRequestSent==="Yes"):G.metric==="accepted"?Rt=Be.some(Le=>Le.connected===!0||Le.connected==="Yes"):G.metric==="followUps"?Rt=Be.length>1:G.metric==="cip"?Rt=Be.some(Le=>Le.status&&(Le.status==="CIP"||Le.status==="Conversations in Progress")):G.metric==="meetingProposed"?Rt=Be.some(Le=>Le.status==="Meeting Proposed"):G.metric==="scheduled"?Rt=Be.some(Le=>Le.status==="Meeting Scheduled"):G.metric==="completed"?Rt=Be.some(Le=>Le.status==="Meeting Completed"):G.metric==="sql"?Rt=Xe.stage==="SQL":G.metric==="win"?Rt=Xe.stage==="WON":G.metric==="connectionRequestsSent"?Rt=Be.some(Le=>Le.lnRequestSent===!0||Le.lnRequestSent==="Yes"):G.metric==="connectionAcceptanceRate"?Rt=Be.some(Le=>Le.connected===!0||Le.connected==="Yes"):G.metric==="messagesSent"?Rt=Be.some(Le=>Le.status&&Le.status!==""):G.metric==="messageReplyRate"?Rt=Be.some(Le=>Le.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Le.status)):G.metric==="meetingsBooked"&&(Rt=Be.some(Le=>Le.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Le.status)));else if(G.channel==="call"){if(G.metric==="allProspects")Rt=!0;else if(G.metric==="callsAttempted")Rt=Nt.length>0;else if(G.metric==="callsConnected")Rt=Nt.some(Le=>Le.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Le.callStatus));else if(G.metric==="decisionMakerReached")Rt=Nt.some(Le=>Le.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up","Not Interested"].includes(Le.callStatus));else if(G.metric==="interested")Rt=Nt.some(Le=>Le.callStatus==="Interested");else if(G.metric==="notInterested")Rt=Nt.some(Le=>Le.callStatus==="Not Interested");else if(G.metric==="detailsShared")Rt=Nt.some(Le=>Le.callStatus==="Details Shared");else if(G.metric==="demoBooked")Rt=Nt.some(Le=>Le.callStatus==="Demo Booked");else if(G.metric==="demoCompleted")Rt=Nt.some(Le=>Le.callStatus==="Demo Completed");else if(G.metric==="sql")Rt=Xe.stage==="SQL";else if(G.metric==="won")Rt=Xe.stage==="WON";else if(G.metric==="followups"||G.metric==="todayFollowups"||G.metric==="tomorrowFollowups"||G.metric==="missedFollowups"){const Le=new Date,Gt=new Date(Le);Gt.setHours(0,0,0,0);const js=new Date(Gt);js.setDate(js.getDate()+1);const cr=new Date(js);cr.setDate(cr.getDate()+1),Rt=Nt.some(hs=>{if(!hs.nextActionDate)return!1;const ta=new Date(hs.nextActionDate);return ta.setHours(0,0,0,0),G.metric==="followups"?!0:G.metric==="todayFollowups"?ta>=Gt&&ta<js:G.metric==="tomorrowFollowups"?ta>=js&&ta<cr:G.metric==="missedFollowups"?ta<Gt:!1})}}else G.channel==="email"&&(G.metric==="followups"?Rt=Ct.some(Le=>Le.nextActionDate!=null):G.metric==="emailsSent"?Rt=Ct.length>0:G.metric==="accepted"?Rt=Ct.some(Le=>Le.status&&Le.status!=="Bounce"&&Le.status!=="Opt-Out"&&Le.status!=="No Reply"):G.metric==="cip"?Rt=Ct.some(Le=>Le.status&&(Le.status==="CIP"||Le.status==="Conversations in Progress")):G.metric==="meetingProposed"?Rt=Ct.some(Le=>Le.status==="Meeting Proposed"):G.metric==="scheduled"?Rt=Ct.some(Le=>Le.status==="Meeting Scheduled"):G.metric==="completed"?Rt=Ct.some(Le=>Le.status==="Meeting Completed"):G.metric==="sql"?Rt=Xe.stage==="SQL":G.metric==="emailBounce"?Rt=Ct.some(Le=>Le.status==="Bounce"):G.metric==="emailOpenRate"?Rt=Ct.some(Le=>Le.status&&Le.status!=="Bounce"&&Le.status!=="Opt-Out"&&Le.status!=="No Reply"):G.metric==="emailReplyRate"?Rt=Ct.some(Le=>Le.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Le.status)):G.metric==="meetingsBooked"&&(Rt=Ct.some(Le=>Le.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Le.status))));return Rt}let lt=!1;if(G.channel==="linkedin"){const Ke=Ue.filter(Be=>Be.type==="linkedin");if(G.metric==="connectionSent")lt=Ke.some(Be=>Be.lnRequestSent===!0||Be.lnRequestSent==="Yes");else if(G.metric==="accepted")lt=Ke.some(Be=>Be.connected===!0||Be.connected==="Yes");else if(G.metric==="followUps")lt=Ke.length>1;else if(G.metric==="cip")lt=Ke.some(Be=>Be.status&&(Be.status==="CIP"||Be.status==="Conversations in Progress"));else if(G.metric==="meetingProposed")lt=Ke.some(Be=>Be.status==="Meeting Proposed");else if(G.metric==="scheduled")lt=Ke.some(Be=>Be.status==="Meeting Scheduled");else if(G.metric==="completed")lt=Ke.some(Be=>Be.status==="Meeting Completed");else if(G.metric==="sql")lt=Xe.stage==="SQL";else if(G.metric==="win")lt=Xe.stage==="WON";else if(G.metric==="followups"||G.metric==="todayFollowups"||G.metric==="tomorrowFollowups"||G.metric==="missedFollowups"){const Be=new Date,Nt=new Date(Be);Nt.setHours(0,0,0,0);const Ct=new Date(Nt);Ct.setDate(Ct.getDate()+1);const Rt=new Date(Ct);Rt.setDate(Rt.getDate()+1),lt=Ke.some(Le=>{if(!Le.nextActionDate)return!1;const Gt=new Date(Le.nextActionDate);return Gt.setHours(0,0,0,0),G.metric==="followups"?!0:G.metric==="todayFollowups"?Gt>=Nt&&Gt<Ct:G.metric==="tomorrowFollowups"?Gt>=Ct&&Gt<Rt:G.metric==="missedFollowups"?Gt<Nt:!1})}else G.metric==="connectionRequestsSent"?lt=Ke.some(Be=>Be.lnRequestSent===!0||Be.lnRequestSent==="Yes"):G.metric==="connectionAcceptanceRate"?lt=Ke.some(Be=>Be.connected===!0||Be.connected==="Yes"):G.metric==="messagesSent"?lt=Ke.some(Be=>Be.status&&Be.status!==""):G.metric==="messageReplyRate"?lt=Ke.some(Be=>Be.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Be.status)):G.metric==="meetingsBooked"&&(lt=Ke.some(Be=>Be.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Be.status)))}else if(G.channel==="call"){const Ke=Ue.filter(Be=>Be.type==="call");if(G.metric==="allProspects")lt=!0;else if(G.metric==="callsAttempted")lt=Ke.length>0;else if(G.metric==="totalCalls")lt=Ke.length>0;else if(G.metric==="callsConnected")lt=Ke.some(Be=>Be.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Be.callStatus));else if(G.metric==="decisionMakerReached")lt=Ke.some(Be=>Be.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up","Not Interested"].includes(Be.callStatus));else if(G.metric==="interested")lt=Ke.some(Be=>Be.callStatus==="Interested");else if(G.metric==="notInterested")lt=Ke.some(Be=>Be.callStatus==="Not Interested");else if(G.metric==="detailsShared")lt=Ke.some(Be=>Be.callStatus==="Details Shared");else if(G.metric==="demoBooked")lt=Ke.some(Be=>Be.callStatus==="Demo Booked");else if(G.metric==="demoCompleted")lt=Ke.some(Be=>Be.callStatus==="Demo Completed");else if(G.metric==="sql")lt=Xe.stage==="SQL";else if(G.metric==="won")lt=Xe.stage==="WON";else if(G.metric==="followups"||G.metric==="todayFollowups"||G.metric==="tomorrowFollowups"||G.metric==="missedFollowups"){const Be=new Date,Nt=new Date(Be);Nt.setHours(0,0,0,0);const Ct=new Date(Nt);Ct.setDate(Ct.getDate()+1);const Rt=new Date(Ct);Rt.setDate(Rt.getDate()+1),lt=Ke.some(Le=>{if(!Le.nextActionDate)return!1;const Gt=new Date(Le.nextActionDate);return Gt.setHours(0,0,0,0),G.metric==="followups"?!0:G.metric==="todayFollowups"?Gt>=Nt&&Gt<Ct:G.metric==="tomorrowFollowups"?Gt>=Ct&&Gt<Rt:G.metric==="missedFollowups"?Gt<Nt:!1})}else G.metric==="callsMade"?lt=Ke.length>0:G.metric==="callAnswerRate"?lt=Ke.some(Be=>Be.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Be.callStatus)):G.metric==="callInterestedRate"?lt=Ke.some(Be=>Be.callStatus&&["Interested","Details Shared","Demo Booked","Demo Completed"].includes(Be.callStatus)):G.metric==="meetingsBooked"&&(lt=Ke.some(Be=>Be.callStatus&&["Demo Booked","Demo Completed"].includes(Be.callStatus)))}else if(G.channel==="email"){const Ke=Ue.filter(Be=>Be.type==="email");if(G.metric==="followups"||G.metric==="todayFollowups"||G.metric==="tomorrowFollowups"||G.metric==="missedFollowups"){const Be=new Date,Nt=new Date(Be);Nt.setHours(0,0,0,0);const Ct=new Date(Nt);Ct.setDate(Ct.getDate()+1);const Rt=new Date(Ct);Rt.setDate(Rt.getDate()+1),lt=Ke.some(Le=>{if(!Le.nextActionDate)return!1;const Gt=new Date(Le.nextActionDate);return Gt.setHours(0,0,0,0),G.metric==="followups"?!0:G.metric==="todayFollowups"?Gt>=Nt&&Gt<Ct:G.metric==="tomorrowFollowups"?Gt>=Ct&&Gt<Rt:G.metric==="missedFollowups"?Gt<Nt:!1})}else G.metric==="emailsSent"?lt=Ke.length>0:G.metric==="accepted"?lt=Ke.some(Be=>Be.status&&Be.status!=="Bounce"&&Be.status!=="Opt-Out"&&Be.status!=="No Reply"):G.metric==="cip"?lt=Ke.some(Be=>Be.status&&(Be.status==="CIP"||Be.status==="Conversations in Progress")):G.metric==="meetingProposed"?lt=Ke.some(Be=>Be.status==="Meeting Proposed"):G.metric==="scheduled"?lt=Ke.some(Be=>Be.status==="Meeting Scheduled"):G.metric==="completed"?lt=Ke.some(Be=>Be.status==="Meeting Completed"):G.metric==="sql"?lt=Xe.stage==="SQL":G.metric==="emailBounce"?lt=Ke.some(Be=>Be.status==="Bounce"):G.metric==="emailOpenRate"?lt=Ke.some(Be=>Be.status&&Be.status!=="Bounce"&&Be.status!=="Opt-Out"&&Be.status!=="No Reply"):G.metric==="emailReplyRate"?lt=Ke.some(Be=>Be.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Be.status)):G.metric==="meetingsBooked"&&(lt=Ke.some(Be=>Be.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Be.status)))}return lt}):[],[Yl,m,_r,jr,l]);B.useEffect(()=>{xe.isOpen&&xe.filter?hr().then(()=>{Jc()}):xe.isOpen||Oi([])},[xe.isOpen,xe.filter,Jc]);const Gl=B.useMemo(()=>Ra.length===0?!1:Ra.every(G=>Za.has((G._id||G.name).toString())),[Ra,Za]),c0=B.useCallback(G=>{const Oe=G.target.checked;B.startTransition(()=>{ul(Xe=>{const He=new Set(Xe);return Ra.forEach(st=>{const Ue=(st._id||st.name).toString();Oe?He.add(Ue):He.delete(Ue)}),He})})},[Ra]),d0=B.useCallback((G,Oe)=>{B.startTransition(()=>{ul(Xe=>{const He=new Set(Xe);return Oe?He.add(G.toString()):He.delete(G.toString()),He})})},[]),fl=B.useCallback(()=>{B.startTransition(()=>{ul(new Set)})},[]),rn=async()=>{if(Za.size!==0){es(!0);try{const G=Array.from(Za),Oe=await Ut.delete(`/projects/${l}/project-contacts`,{data:{contactIds:G}});if(Oe.data.success){const Xe=Oe.data.data?.deletedCount||0;if(Xe===0){alert("No prospects were removed. They may have already been deleted."),es(!1);return}ul(new Set),Ua(!1);const He=new Set;G.forEach(Ue=>{const lt=String(Ue);He.add(lt),Ue&&typeof Ue=="object"&&Ue.toString&&He.add(Ue.toString())});const st=new Set(He);Wl(Ue=>{const lt=new Set(Ue);return He.forEach(Ke=>lt.add(Ke)),lt}),v(Ue=>{const lt=Ue.filter(Ke=>{if(!Ke._id)return!0;const Be=Ke._id.toString?Ke._id.toString():String(Ke._id),Nt=Ke._id;return!(He.has(Be)||Nt&&He.has(String(Nt)))});return ap(`Removed ${Ue.length-lt.length} contact(s) from UI`),lt}),Mt(Ue=>{const lt=new Set(Ue);return He.forEach(Ke=>{lt.delete(Ke)}),lt}),qs(Ue=>{const lt={...Ue};return He.forEach(Ke=>{delete lt[Ke]}),lt}),$r(Ue=>Ue.filter(lt=>{if(!lt.contactId)return!0;const Ke=lt.contactId.toString?lt.contactId.toString():String(lt.contactId);return!He.has(Ke)})),setTimeout(async()=>{try{ka?await kr():await ga(),v(Ue=>{const lt=Ue.filter(Ke=>{if(!Ke._id)return!0;const Be=Ke._id.toString?Ke._id.toString():String(Ke._id);return!st.has(Be)});return Ue.length!==lt.length&&ap(`Removed ${Ue.length-lt.length} contact(s) that reappeared after refresh`),lt}),await hr()}catch(Ue){console.error("Background refresh after deletion:",Ue)}},1e3),ap(`Successfully removed ${Xe} prospect(s)`)}}catch(G){console.error("Error removing prospects:",G),alert(G.response?.data?.error||"Couldn't remove those prospects. Try again in a moment.")}finally{es(!1)}}};return B.useMemo(()=>{const G=new Date;G.setHours(0,0,0,0);const Oe=new Date(G);Oe.setDate(Oe.getDate()+7);let Xe=0,He=0;return m.forEach(st=>{const Ue=st._id?.toString?st._id.toString():st._id,lt=Ue?_r.byContactId.get(Ue)||[]:[];lt.some(Nt=>Nt.nextActionDate?new Date(Nt.nextActionDate)<G:!1)&&Xe++,lt.some(Nt=>{if(!Nt.nextActionDate)return!1;const Ct=new Date(Nt.nextActionDate);return Ct>=G&&Ct<Oe})&&He++}),{total:m.length,active:m.filter(st=>{const Ue=st.stage||"New";return Ue==="Qualified"||Ue==="Proposal"||Ue==="Negotiation"}).length,overdue:Xe,thisWeek:He}},[m,_r]),w?t.jsx("div",{className:"p-6 flex items-center justify-center min-h-screen",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):S||!s?t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:S||"Project not found"})}):t.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[t.jsxs("div",{className:"flex items-start justify-between mb-6",children:[t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("button",{onClick:()=>n("/projects"),className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors mt-1",title:"Back to Projects",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[s&&t.jsx("h1",{className:"text-3xl font-bold text-indigo-600 mb-1",children:s.companyName}),t.jsx("p",{className:"text-lg font-semibold text-gray-700",children:"Prospect Management"})]})]}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap justify-end",children:[t.jsxs("button",{onClick:()=>n(`/prospects/dashboard?projectId=${l}`),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-colors font-medium text-sm shadow-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Prospect Analytics"]}),t.jsxs("button",{onClick:()=>n(`/projects/${l}/report`),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-lg hover:from-blue-700 hover:to-cyan-700 transition-colors font-medium text-sm shadow-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Report"]}),t.jsxs("button",{onClick:hl,disabled:!tn,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors font-medium text-sm ${tn?ka?"bg-blue-600 text-white hover:bg-blue-700":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50":"bg-gray-100 border border-gray-300 text-gray-400 cursor-not-allowed"}`,title:tn?"Show prospect suggestions based on ICP":"No ICP defined. Add an ICP definition to get suggestions.",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Prospect Suggestion",!tn&&t.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})]}),t.jsxs("button",{onClick:()=>Is(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Bulk Import"]})]})]}),is&&t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"mb-3 overflow-x-auto -mx-1 px-1 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:[t.jsx("style",{children:`
              .scrollbar-thin::-webkit-scrollbar {
                height: 6px;
              }
              .scrollbar-thin::-webkit-scrollbar-track {
                background: transparent;
              }
              .scrollbar-thin::-webkit-scrollbar-thumb {
                background-color: #cbd5e1;
                border-radius: 3px;
              }
              .scrollbar-thin::-webkit-scrollbar-thumb:hover {
                background-color: #94a3b8;
              }
            `}),t.jsxs("div",{className:"flex gap-2 min-w-max pb-2",children:[Nr.includes("linkedin")&&t.jsxs("div",{onClick:()=>ue("linkedin"),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-medium text-xs whitespace-nowrap transition-all cursor-pointer min-w-[150px] justify-center ${Fe==="linkedin"?"bg-blue-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("span",{children:"LinkedIn Pipeline"})]}),Nr.includes("call")&&t.jsxs("div",{onClick:()=>ue("call"),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-medium text-xs whitespace-nowrap transition-all cursor-pointer min-w-[150px] justify-center ${Fe==="call"?"bg-green-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{children:"Cold Calling Pipeline"})]}),Nr.includes("email")&&t.jsxs("div",{onClick:()=>ue("email"),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-medium text-xs whitespace-nowrap transition-all cursor-pointer min-w-[150px] justify-center ${Fe==="email"?"bg-blue-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{children:"Email Pipeline"})]})]})]}),Nr.includes("linkedin")&&Fe==="linkedin"&&is&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-9 gap-2",children:[t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"connectionSent"}),className:`bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="linkedin"&&Q?.metric==="connectionSent"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"Sent"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.linkedin?.connectionSent||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Connection Sent"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"accepted"}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="linkedin"&&Q?.metric==="accepted"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Accepted"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.linkedin?.accepted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Accepted"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"followUps"}),className:`bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="linkedin"&&Q?.metric==="followUps"?"border-purple-400 ring-2 ring-purple-200":"border-purple-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full",children:"Follow"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.linkedin?.followUps||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Follow-ups"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"cip"}),className:`bg-gradient-to-br from-cyan-50 to-blue-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="linkedin"&&Q?.metric==="cip"?"border-cyan-400 ring-2 ring-cyan-200":"border-cyan-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full",children:"CIP"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.linkedin?.cip||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"CIP"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"meetingProposed"}),className:`bg-gradient-to-br from-yellow-50 to-amber-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="linkedin"&&Q?.metric==="meetingProposed"?"border-yellow-400 ring-2 ring-yellow-200":"border-yellow-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-yellow-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-yellow-700 bg-white/70 border border-yellow-100 px-2 py-1 rounded-full",children:"Proposed"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.linkedin?.meetingProposed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Meeting Proposed"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"scheduled"}),className:`bg-gradient-to-br from-orange-50 to-red-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="linkedin"&&Q?.metric==="scheduled"?"border-orange-400 ring-2 ring-orange-200":"border-orange-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-orange-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-orange-700 bg-white/70 border border-orange-100 px-2 py-1 rounded-full",children:"Scheduled"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.linkedin?.scheduled||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Scheduled"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"completed"}),className:`bg-gradient-to-br from-teal-50 to-green-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="linkedin"&&Q?.metric==="completed"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Done"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.linkedin?.completed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Completed"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"sql"}),className:`bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="linkedin"&&Q?.metric==="sql"?"border-indigo-400 ring-2 ring-indigo-200":"border-indigo-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full",children:"SQL"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.linkedin?.sql||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"SQL"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"win"}),className:`bg-gradient-to-br from-emerald-50 to-green-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="linkedin"&&Q?.metric==="win"?"border-emerald-400 ring-2 ring-emerald-200":"border-emerald-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full",children:"WON"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.linkedin?.win||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Win"})]})]}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-start",children:[t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"todayFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Today's Follow-ups (",Tr.linkedin.today,")"]}),t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"tomorrowFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-emerald-200 text-emerald-700 bg-emerald-50 hover:bg-emerald-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Tomorrow's Follow-ups (",Tr.linkedin.tomorrow,")"]}),t.jsxs("button",{onClick:()=>Qe({channel:"linkedin",metric:"missedFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-rose-200 text-rose-700 bg-rose-50 hover:bg-rose-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Missed Follow-ups (",Tr.linkedin.missed,")"]})]})]}),Nr.includes("call")&&Fe==="call"&&is&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2",children:[t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"totalCalls"}),className:`bg-gradient-to-br from-teal-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="totalCalls"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5h6m-6 4h6m-6 4h6m-6 4h6"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Total"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.callsMade||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Total Calls"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"callsAttempted"}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="callsAttempted"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Calls"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.callsAttempted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Calls Attempted"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"callsConnected"}),className:`bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="callsConnected"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"Connected"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.callsConnected||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Calls Connected"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"decisionMakerReached"}),className:`bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="decisionMakerReached"?"border-purple-400 ring-2 ring-purple-200":"border-purple-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full",children:"DM"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.decisionMakerReached||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Decision Maker Reached"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"interested"}),className:`bg-gradient-to-br from-yellow-50 to-amber-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="interested"?"border-yellow-400 ring-2 ring-yellow-200":"border-yellow-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-yellow-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-yellow-700 bg-white/70 border border-yellow-100 px-2 py-1 rounded-full",children:"Interest"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.interested||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Interested"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"detailsShared"}),className:`bg-gradient-to-br from-indigo-50 to-blue-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="detailsShared"?"border-indigo-400 ring-2 ring-indigo-200":"border-indigo-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full",children:"Details"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.detailsShared||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Details Shared"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"demoBooked"}),className:`bg-gradient-to-br from-teal-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="demoBooked"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Demo"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.demoBooked||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Demo Booked"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"demoCompleted"}),className:`bg-gradient-to-br from-emerald-50 to-green-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="demoCompleted"?"border-emerald-400 ring-2 ring-emerald-200":"border-emerald-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full",children:"Done"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.demoCompleted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Demo Completed"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"sql"}),className:`bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="sql"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"SQL"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.sql||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"SQL"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"won"}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="won"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"WON"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.won||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"WON"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"notInterested"}),className:`bg-gradient-to-br from-red-50 to-pink-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="call"&&Q?.metric==="notInterested"?"border-red-400 ring-2 ring-red-200":"border-red-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full",children:"Not Interested"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.call?.notInterested||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Not Interested"})]})]}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-start",children:[t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"todayFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Today's Follow-ups (",is.call?.todayFollowups||0,")"]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"tomorrowFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-emerald-200 text-emerald-700 bg-emerald-50 hover:bg-emerald-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Tomorrow's Follow-ups (",is.call?.tomorrowFollowups||0,")"]}),t.jsxs("button",{onClick:()=>Qe({channel:"call",metric:"missedFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-rose-200 text-rose-700 bg-rose-50 hover:bg-rose-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Missed Follow-ups (",is.call?.missedFollowups||0,")"]})]})]}),Nr.includes("email")&&Fe==="email"&&is&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-9 gap-2",children:[t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"emailsSent"}),className:`bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="email"&&Q?.metric==="emailsSent"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"Sent"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.email?.emailsSent||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Emails Sent"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"accepted"}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="email"&&Q?.metric==="accepted"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Accepted"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.email?.accepted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Accepted"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"followups"}),className:`bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="email"&&Q?.metric==="followups"?"border-purple-400 ring-2 ring-purple-200":"border-purple-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full",children:"Followups"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.email?.followups||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Follow-ups"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"cip"}),className:`bg-gradient-to-br from-amber-50 to-yellow-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="email"&&Q?.metric==="cip"?"border-amber-400 ring-2 ring-amber-200":"border-amber-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full",children:"CIP"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.email?.cip||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"CIP"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"meetingProposed"}),className:`bg-gradient-to-br from-teal-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="email"&&Q?.metric==="meetingProposed"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Proposed"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.email?.meetingProposed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Meeting Proposed"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"scheduled"}),className:`bg-gradient-to-br from-indigo-50 to-blue-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="email"&&Q?.metric==="scheduled"?"border-indigo-400 ring-2 ring-indigo-200":"border-indigo-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full",children:"Scheduled"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.email?.scheduled||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Scheduled"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"completed"}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="email"&&Q?.metric==="completed"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Completed"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.email?.completed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Completed"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"sql"}),className:`bg-gradient-to-br from-pink-50 to-rose-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="email"&&Q?.metric==="sql"?"border-pink-400 ring-2 ring-pink-200":"border-pink-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-pink-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),t.jsx("span",{className:"text-xs font-semibold text-pink-700 bg-white/70 border border-pink-100 px-2 py-1 rounded-full",children:"SQL"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.email?.sql||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"SQL"})]}),t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"emailBounce"}),className:`bg-gradient-to-br from-red-50 to-rose-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${Q?.channel==="email"&&Q?.metric==="emailBounce"?"border-red-400 ring-2 ring-red-200":"border-red-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full",children:"Bounce"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:is.email?.emailBounce||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Email Bounce"})]})]}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-start",children:[t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"todayFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Today's Follow-ups (",Tr.email.today,")"]}),t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"tomorrowFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-emerald-200 text-emerald-700 bg-emerald-50 hover:bg-emerald-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Tomorrow's Follow-ups (",Tr.email.tomorrow,")"]}),t.jsxs("button",{onClick:()=>Qe({channel:"email",metric:"missedFollowups"}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-rose-200 text-rose-700 bg-rose-50 hover:bg-rose-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Missed Follow-ups (",Tr.email.missed,")"]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),t.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"})]}),Q&&t.jsxs("button",{onClick:()=>we(null),className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear KPI Filter"]})]}),t.jsx("div",{className:"mb-4",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",placeholder:"Search by name, company, email...",value:L,onChange:G=>M(G.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[t.jsx("div",{className:"text-xs font-medium text-gray-500",children:"Quick Filters:"}),t.jsx("button",{onClick:()=>{Ce(se==="due-today"?"":"due-today")},className:`px-3 py-1.5 text-xs font-medium rounded-lg transition-all duration-200 ${se==="due-today"?"bg-blue-600 text-white border border-blue-600 shadow-sm":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200 hover:border-gray-400"}`,children:"Due Today"}),t.jsx("button",{onClick:()=>{const G=se==="new-prospects"?"":"new-prospects";Ce(G),G==="new-prospects"?Ne("New"):se==="new-prospects"&&Ne("")},className:`px-3 py-1.5 text-xs font-medium rounded-lg transition-all duration-200 ${se==="new-prospects"?"bg-blue-600 text-white border border-blue-600 shadow-sm":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200 hover:border-gray-400"}`,children:"New Prospects"}),t.jsxs("div",{className:"ml-auto flex items-center gap-3",children:[t.jsxs("select",{value:ge,onChange:G=>{Ne(G.target.value),G.target.value!=="New"&&se==="new-prospects"&&Ce("")},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Filter by status"}),t.jsxs("optgroup",{label:"Call Statuses",children:[t.jsx("option",{value:"Ring",children:"Ring"}),t.jsx("option",{value:"Busy",children:"Busy"}),t.jsx("option",{value:"Call Back",children:"Call Back"}),t.jsx("option",{value:"Hang Up",children:"Hang Up"}),t.jsx("option",{value:"Switch Off",children:"Switch Off"}),t.jsx("option",{value:"Invalid",children:"Invalid"}),t.jsx("option",{value:"Future",children:"Future"}),t.jsx("option",{value:"Existing",children:"Existing"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Details Shared",children:"Details Shared"}),t.jsx("option",{value:"Demo Booked",children:"Demo Booked"}),t.jsx("option",{value:"Demo Completed",children:"Demo Completed"})]}),t.jsxs("optgroup",{label:"Email & LinkedIn Statuses",children:[t.jsx("option",{value:"CIP",children:"CIP"}),t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Out of Office",children:"Out of Office"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"In-Person Meeting",children:"In-Person Meeting"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"}),t.jsx("option",{value:"SQL",children:"SQL"}),t.jsx("option",{value:"Tech Discussion",children:"Tech Discussion"}),t.jsx("option",{value:"WON",children:"WON"}),t.jsx("option",{value:"Lost",children:"Lost"}),t.jsx("option",{value:"Low Potential - Open",children:"Low Potential - Open"}),t.jsx("option",{value:"Potential Future",children:"Potential Future"}),t.jsx("option",{value:"Wrong Person",children:"Wrong Person"}),t.jsx("option",{value:"Bounce",children:"Bounce"}),t.jsx("option",{value:"Opt-Out",children:"Opt-Out"})]})]}),t.jsxs("select",{value:J,onChange:G=>{de(G.target.value),G.target.value!=="custom"&&(ze(""),oe(""))},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Action Date"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"this-week",children:"This Week"}),t.jsx("option",{value:"this-month",children:"This Month"}),t.jsx("option",{value:"custom",children:"Custom Range"})]}),J==="custom"&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"date",value:le,onChange:G=>{ze(G.target.value),G.target.value&&me&&new Date(G.target.value)>new Date(me)&&oe(G.target.value)},max:me||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"From"}),t.jsx("span",{className:"text-xs text-gray-500",children:"to"}),t.jsx("input",{type:"date",value:me,onChange:G=>{oe(G.target.value),G.target.value&&le&&new Date(G.target.value)<new Date(le)&&ze(G.target.value)},min:le||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"To"})]}),t.jsxs("select",{value:ce,onChange:G=>{ye(G.target.value),G.target.value!=="custom"&&(fe(""),Ye(""))},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Last Interaction"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"this-week",children:"This Week"}),t.jsx("option",{value:"this-month",children:"This Month"}),t.jsx("option",{value:"custom",children:"Custom Range"})]}),ce==="custom"&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"date",value:ke,onChange:G=>{fe(G.target.value),G.target.value&&Se&&new Date(G.target.value)>new Date(Se)&&Ye(G.target.value)},max:Se||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"From"}),t.jsx("span",{className:"text-xs text-gray-500",children:"to"}),t.jsx("input",{type:"date",value:Se,onChange:G=>{Ye(G.target.value),G.target.value&&ke&&new Date(G.target.value)<new Date(ke)&&fe(G.target.value)},min:ke||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"To"})]}),t.jsxs("select",{value:te,onChange:G=>{pe(G.target.value),G.target.value!=="custom"&&(be(""),De(""))},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Import Date"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"yesterday",children:"Yesterday"}),t.jsx("option",{value:"custom",children:"Custom Range"})]}),te==="custom"&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"date",value:V,onChange:G=>{be(G.target.value),G.target.value&&_e&&new Date(G.target.value)>new Date(_e)&&De(G.target.value)},max:_e||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"From"}),t.jsx("span",{className:"text-xs text-gray-500",children:"to"}),t.jsx("input",{type:"date",value:_e,onChange:G=>{De(G.target.value),G.target.value&&V&&new Date(G.target.value)<new Date(V)&&be(G.target.value)},min:V||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"To"})]}),t.jsxs("label",{className:"flex items-center gap-2 px-3 py-1.5 text-xs border border-gray-300 rounded-lg bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:W,onChange:G=>H(G.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500 cursor-pointer"}),t.jsx("span",{className:"text-gray-700",children:"No Activity"})]})]})]}),(L||se||ge||J||le||me||ce||ke||Se||te||V||_e||W||X)&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 flex items-center gap-2 flex-wrap",children:[t.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Active filters:"}),L&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:['Search: "',L,'"',t.jsx("button",{onClick:()=>M(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),se==="due-today"&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Due Today",t.jsx("button",{onClick:()=>Ce(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),se==="new-prospects"&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["New Prospects",t.jsx("button",{onClick:()=>{Ce(""),Ne("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),ge&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Status: ",ge,t.jsx("button",{onClick:()=>Ne(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(J||le||me)&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Action Date: ",J==="custom"&&(le||me)?`${le?sn(le):"..."} to ${me?sn(me):"..."}`:J==="today"?"Today":J==="this-week"?"This Week":J==="this-month"?"This Month":J,t.jsx("button",{onClick:()=>{de(""),ze(""),oe("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(ce||ke||Se)&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Last Interaction: ",ce==="custom"&&(ke||Se)?`${ke?sn(ke):"..."} to ${Se?sn(Se):"..."}`:ce==="today"?"Today":ce==="this-week"?"This Week":ce==="this-month"?"This Month":ce,t.jsx("button",{onClick:()=>{ye(""),fe(""),Ye("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(te||V||_e)&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Import Date: ",te==="custom"&&(V||_e)?`${V?sn(V):"..."} to ${_e?sn(_e):"..."}`:te==="today"?"Today":te==="yesterday"?"Yesterday":te,t.jsx("button",{onClick:()=>{pe(""),be(""),De("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),W&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["No Activity",t.jsx("button",{onClick:()=>H(!1),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),X&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Match: ",X==="exact"?"Exact":X==="good"?"Good":X==="similar"?"Similar":X==="loose"?"Loose":"Imported",t.jsx("button",{onClick:()=>je(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("button",{onClick:()=>{M(""),Ce(""),Ne(""),de(""),ze(""),oe(""),ye(""),fe(""),Ye(""),pe(""),be(""),De(""),H(!1),je("")},className:"text-xs text-gray-600 hover:text-gray-900 font-medium ml-2",children:"Clear all"})]})]}),t.jsx("div",{className:"mb-3 flex items-center justify-between flex-wrap gap-3",children:t.jsx("div",{className:"flex items-center gap-4 flex-wrap",children:xt&&t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[xt.imported>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-700 text-xs font-semibold rounded-md border border-purple-200",children:[t.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),xt.imported," Imported"]}),xt.exact>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-md border border-green-200",children:[t.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),xt.exact," Exact"]}),xt.good>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-md border border-blue-200",children:[t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),xt.good," Good"]}),xt.similar>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-semibold rounded-md border border-yellow-200",children:[t.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),xt.similar," Similar"]})]})})}),ka&&tn&&s?.icpDefinition&&t.jsx("div",{className:"mb-4 bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 border-2 border-indigo-200 rounded-2xl p-5 shadow-lg",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"ICP-Based Recommendations"}),t.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Showing prospects from databank that match your project's Ideal Customer Profile"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mt-4",children:[s.icpDefinition.targetIndustries&&s.icpDefinition.targetIndustries.length>0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Target Industries"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.targetIndustries.slice(0,2).join(", "),s.icpDefinition.targetIndustries.length>2&&` +${s.icpDefinition.targetIndustries.length-2} more`]})]}),s.icpDefinition.targetJobTitles&&s.icpDefinition.targetJobTitles.length>0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Target Job Titles"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.targetJobTitles.slice(0,2).join(", "),s.icpDefinition.targetJobTitles.length>2&&` +${s.icpDefinition.targetJobTitles.length-2} more`]})]}),s.icpDefinition.companySizeMin!==void 0&&s.icpDefinition.companySizeMax!==void 0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Company Size"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.companySizeMin.toLocaleString()," - ",s.icpDefinition.companySizeMax.toLocaleString()," employees"]})]}),s.icpDefinition.geographies&&s.icpDefinition.geographies.length>0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Geographies"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.geographies.slice(0,2).join(", "),s.icpDefinition.geographies.length>2&&` +${s.icpDefinition.geographies.length-2} more`]})]})]}),xt&&t.jsx("div",{className:"mt-4 flex items-center gap-4 flex-wrap",children:t.jsxs("div",{className:"text-xs text-gray-600 font-medium",children:["Recommendations:",t.jsxs("span",{className:"ml-2 inline-flex items-center gap-2",children:[xt.exact>0&&t.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full font-semibold",children:[xt.exact," Exact"]}),xt.good>0&&t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full font-semibold",children:[xt.good," Good"]}),xt.similar>0&&t.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full font-semibold",children:[xt.similar," Similar"]}),xt.loose>0&&t.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded-full font-semibold",children:[xt.loose," Loose"]})]})]})})]})})}),Za.size>0&&t.jsxs("div",{className:"mb-4 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border-2 border-blue-200 rounded-2xl p-5 shadow-xl animate-slide-down backdrop-blur-sm relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 opacity-5",children:t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 animate-pulse"})}),t.jsxs("div",{className:"relative flex items-center justify-between flex-wrap gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-700 rounded-2xl flex items-center justify-center shadow-lg transform hover:scale-110 transition-transform duration-300 ring-4 ring-blue-200 ring-opacity-50 animate-bounce-subtle",children:t.jsx("span",{className:"text-white font-bold text-lg",children:Za.size})}),t.jsx("div",{className:"absolute inset-0 bg-blue-600 rounded-2xl animate-ping opacity-20"})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("p",{className:"text-base font-bold text-gray-900 tracking-tight",children:[Za.size," ",Za.size===1?"prospect":"prospects"," selected"]}),t.jsx("p",{className:"text-xs text-gray-600 font-medium mt-0.5",children:"Choose an activity type to log for all selected prospects"})]})]}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[Nr.includes("call")&&t.jsxs("button",{onClick:()=>xr({isOpen:!0,type:"call"}),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-green-500 via-green-600 to-emerald-600 text-white text-sm font-bold rounded-xl hover:from-green-600 hover:via-green-700 hover:to-emerald-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:rotate-12 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{className:"relative z-10",children:"Log Call"})]}),Nr.includes("email")&&t.jsxs("button",{onClick:()=>xr({isOpen:!0,type:"email"}),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 via-blue-600 to-cyan-600 text-white text-sm font-bold rounded-xl hover:from-blue-600 hover:via-blue-700 hover:to-cyan-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:scale-110 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{className:"relative z-10",children:"Log Email"})]}),Nr.includes("linkedin")&&t.jsxs("button",{onClick:()=>xr({isOpen:!0,type:"linkedin"}),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-700 via-indigo-700 to-purple-700 text-white text-sm font-bold rounded-xl hover:from-blue-800 hover:via-indigo-800 hover:to-purple-800 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:scale-110 transition-transform duration-300",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("span",{className:"relative z-10",children:"Log LinkedIn"})]}),t.jsxs("button",{onClick:()=>Ua(!0),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-red-500 via-red-600 to-rose-600 text-white text-sm font-bold rounded-xl hover:from-red-600 hover:via-red-700 hover:to-rose-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:scale-110 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),t.jsx("span",{className:"relative z-10",children:"Remove"})]}),t.jsxs("button",{onClick:fl,className:"group relative inline-flex items-center justify-center gap-2 px-5 py-3 bg-white border-2 border-gray-300 text-gray-700 text-sm font-bold rounded-xl hover:bg-gray-50 hover:border-gray-400 hover:text-gray-900 transition-all duration-300 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95",children:[t.jsx("svg",{className:"w-4 h-4 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})}),t.jsx("span",{children:"Clear"})]})]})]})]}),Vl&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full mx-4 transform animate-fade-in-up",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Remove Prospects?"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"This action cannot be undone."})]})]}),t.jsxs("p",{className:"text-sm text-gray-700 mb-6",children:["Are you sure you want to remove ",t.jsx("span",{className:"font-bold text-gray-900",children:Za.size})," ",Za.size===1?"prospect":"prospects"," from this project? They will be removed from the project but will remain in the databank."]}),t.jsxs("div",{className:"flex items-center justify-end gap-3",children:[t.jsx("button",{onClick:()=>Ua(!1),disabled:Yn,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{onClick:rn,disabled:Yn,className:"px-4 py-2 text-sm font-medium text-white bg-gradient-to-r from-red-500 to-red-600 rounded-lg hover:from-red-600 hover:to-red-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:Yn?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Removing..."]}):"Remove"})]})]})}),Ra.length>0?t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[Ys>0&&t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-white flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",t.jsx("span",{className:"font-semibold",children:(vs-1)*gn+1})," to"," ",t.jsx("span",{className:"font-semibold",children:(vs-1)*gn+Qc.length})," ","of ",t.jsx("span",{className:"font-semibold",children:Ys.toLocaleString()})," contacts"]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>Br(vs-1),disabled:vs===1||w,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-colors",children:"Previous"}),(()=>{const G=[];let Xe=Math.max(1,vs-Math.floor(2.5)),He=Math.min(Va,Xe+5-1);He-Xe<4&&(Xe=Math.max(1,He-5+1)),Xe>1&&(G.push(t.jsx("button",{onClick:()=>Br(1),className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"1"},1)),Xe>2&&G.push(t.jsx("span",{className:"px-2 text-gray-500",children:"..."},"ellipsis1")));for(let st=Xe;st<=He;st++)G.push(t.jsx("button",{onClick:()=>Br(st),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${st===vs?"bg-blue-600 text-white border border-blue-600":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:st},st));return He<Va&&(He<Va-1&&G.push(t.jsx("span",{className:"px-2 text-gray-500",children:"..."},"ellipsis2")),G.push(t.jsx("button",{onClick:()=>Br(Va),className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:Va},Va))),G})(),t.jsx("button",{onClick:()=>Br(vs+1),disabled:vs===Va||w,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-colors",children:"Next"})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-fixed",children:[t.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-2.5 text-left text-[10px] font-semibold text-gray-700 uppercase tracking-wider w-12",children:t.jsx("input",{type:"checkbox",checked:Gl,onChange:c0,className:"h-3.5 w-3.5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer",title:"Select all"})}),t.jsx("th",{className:"px-3 py-2.5 text-left text-[10px] font-semibold text-gray-700 uppercase tracking-wider w-12"}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[20%] cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>{hi==="name"?Bo(fi==="asc"?"desc":"asc"):(qr("name"),Bo("asc"))},children:t.jsxs("div",{className:"flex items-center gap-1.5",children:["Contact",hi==="name"?fi==="asc"?t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):t.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]})}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[18%]",children:"Contact Info"}),t.jsxs("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[12%] relative",ref:Ri,children:[t.jsxs("div",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 transition-colors rounded px-1 py-0.5 -mx-1 -my-0.5",onClick:()=>mi(!Li),children:["Status",t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})})]}),Li&&t.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[200px] max-h-96 overflow-y-auto",children:t.jsxs("div",{className:"p-2",children:[t.jsx("button",{onClick:()=>{Ne(""),mi(!1)},className:`w-full text-left px-3 py-2 text-xs rounded hover:bg-gray-100 ${ge?"text-gray-700":"bg-blue-50 text-blue-700 font-medium"}`,children:"All Statuses"}),["New","Interested","Not Interested","Details Shared","Demo Booked","Demo Completed","SQL","WON","Lost","CIP","No Reply","Meeting Proposed","Meeting Scheduled","Meeting Completed","Ring","Busy","Call Back","Hang Up","Switch Off","Invalid","Future","Existing","Bounce","Opt-Out"].map(G=>t.jsx("button",{onClick:()=>{Ne(G),mi(!1)},className:`w-full text-left px-3 py-2 text-xs rounded hover:bg-gray-100 ${ge===G?"bg-blue-50 text-blue-700 font-medium":"text-gray-700"}`,children:G},G))]})})]}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[15%]",children:"Last Interaction"}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[18%]",children:"Next Action"}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[12%]",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Qc.map(G=>{const Oe=G._id||G.name,Xe=$t.has(Oe),He=Es[Oe]||[],st=ms[Oe],Ue=G._id?.toString?G._id.toString():G._id;let lt=null,Ke=null,Be=null;if(Ue){const Gt=Ue.toString?Ue.toString():String(Ue);lt=_r.lastActivityByContactId.get(Gt)||null,Ke=_r.nextActionByContactId.get(Gt)||null,Be=_r.latestActivityStatusByContactId.get(Gt)||null}let Nt=Be?.status||null;if((!lt||!Ke||!Be)&&!Ue){const Gt=G.name?.toLowerCase()||"",js=G.email?.toLowerCase()||"";if(!lt&&(Gt||js)&&(lt=jr.filter(cr=>{if(cr.contactId)return!1;const hs=cr.conversationNotes?.toLowerCase()||"";return hs.includes(Gt)||hs.includes(js)}).sort((cr,hs)=>Vn(hs)-Vn(cr))[0]),!Ke&&(Gt||js)){const cr=Tc(new Date),hs=jr.filter(sa=>{if(!sa.nextActionDate||sa.contactId)return!1;const _n=sa.conversationNotes?.toLowerCase()||"";return _n.includes(Gt)||_n.includes(js)}),ta=hs.filter(sa=>Tc(sa.nextActionDate)>=cr).sort((sa,_n)=>new Date(sa.nextActionDate)-new Date(_n.nextActionDate)),tr=hs.filter(sa=>Tc(sa.nextActionDate)<cr).sort((sa,_n)=>new Date(_n.nextActionDate)-new Date(sa.nextActionDate));Ke=ta[0]||tr[0]||null}if(!Be&&(Gt||js)){const cr=jr.filter(hs=>{if(hs.contactId||!(hs.type==="call"&&hs.callStatus&&hs.callStatus.trim()!==""||hs.status&&hs.status.trim()!==""))return!1;const tr=hs.conversationNotes?.toLowerCase()||"";return tr.includes(Gt)||tr.includes(js)}).sort((hs,ta)=>Vn(ta)-Vn(hs));if(cr.length>0){const hs=cr[0];Nt=hs.type==="call"&&hs.callStatus?hs.callStatus:hs.status}}}const Ct=Nt||G.stage||"New";G.assignedTo||s?.assignedTo;const Rt=Ue&&(typeof Ue=="string"&&Ue.length===24||typeof G._id=="object"&&G._id!==null),Le=Gt=>{if(!(Gt.target.closest("button")||Gt.target.closest("svg")||Gt.target.closest("a"))&&Rt&&Ue){const js=new URLSearchParams;L&&js.set("search",L),se&&js.set("quickFilter",se),ge&&js.set("filterStatus",ge),J&&js.set("filterActionDate",J),le&&js.set("filterActionDateFrom",le),me&&js.set("filterActionDateTo",me),ce&&js.set("filterLastInteraction",ce),ke&&js.set("filterLastInteractionFrom",ke),Se&&js.set("filterLastInteractionTo",Se),te&&js.set("filterImportDate",te),V&&js.set("filterImportDateFrom",V),_e&&js.set("filterImportDateTo",_e),W&&js.set("filterNoActivity","true"),X&&js.set("filterMatchType",X),js.set("page",vs.toString()),Q&&(js.set("kpiChannel",Q.channel),js.set("kpiMetric",Q.metric),js.set("kpiOpen","1"));const cr=`/projects/${l}${js.toString()?"?"+js.toString():""}`;n(`/contacts/${Ue}/activities?projectId=${l}&returnTo=${encodeURIComponent(cr)}`)}};return t.jsxs(Mo.Fragment,{children:[t.jsxs("tr",{onClick:Le,className:`transition-all duration-150 ${Rt?"hover:bg-blue-50 cursor-pointer":"hover:bg-gray-50"} ${Xe?"bg-blue-50":""}`,children:[t.jsx("td",{className:"px-3 py-2.5",onClick:Gt=>Gt.stopPropagation(),children:t.jsx("input",{type:"checkbox",checked:Za.has(Oe.toString()),onChange:Gt=>d0(Oe,Gt.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"})}),t.jsx("td",{className:"px-3 py-2.5",children:t.jsx("button",{onClick:Gt=>{Gt.stopPropagation(),Gn(Oe,G.email,G.name)},className:"text-gray-400 hover:text-gray-600 transition-all",title:Xe?"Collapse details":"Expand details",children:t.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${Xe?"-rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}),t.jsx("td",{className:"px-4 py-2.5",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0 shadow-md",children:t.jsx("span",{className:"text-sm font-semibold text-white",children:Uo(G.name)})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsx("div",{className:`text-sm font-semibold ${Rt?"text-gray-900 hover:text-blue-600":"text-gray-900"}`,children:G.name||"N/A"}),!G.isImported&&G.recommendationReasons&&G.recommendationReasons.length>0&&t.jsxs("div",{className:"group relative",children:[t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${G.matchType==="exact"?"bg-green-100 text-green-800":G.matchType==="good"?"bg-blue-100 text-blue-800":G.matchType==="similar"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),G.matchScore,"% Match"]}),t.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 p-4 z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 pointer-events-none",children:[t.jsx("div",{className:"absolute -top-2 left-4 w-4 h-4 bg-white border-l border-t border-gray-200 transform rotate-45"}),t.jsxs("div",{className:"relative",children:[t.jsxs("h4",{className:"text-xs font-bold text-gray-900 mb-2 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Recommended Based on ICP"]}),t.jsx("div",{className:"space-y-2",children:G.recommendationReasons.map((Gt,js)=>t.jsxs("div",{className:"text-xs text-gray-700 bg-gray-50 rounded p-2 border-l-2 border-blue-500",children:[t.jsxs("div",{className:"font-semibold text-gray-900 mb-1 capitalize",children:[Gt.type==="industry"&&" Industry Match",Gt.type==="jobTitle"&&" Job Title Match",Gt.type==="companySize"&&" Company Size Match",Gt.type==="geography"&&" Location Match",Gt.type==="keywords"&&" Keywords Match"]}),t.jsx("div",{className:"text-gray-600",children:Gt.message})]},js))}),t.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200",children:t.jsxs("div",{className:"text-xs text-gray-500",children:[t.jsx("span",{className:"font-semibold",children:"Match Score:"})," ",G.matchScore,"% (",G.matchType,")"]})})]})]})]})]}),t.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:G.company||"N/A"})]})]})}),t.jsx("td",{className:"px-4 py-2.5",children:t.jsxs("div",{className:"space-y-0.5",children:[G.email?(()=>{const js=String(G.email).trim().split(/[,\s]+/).filter(hs=>hs.trim()),cr=js.length>=2;return t.jsxs("div",{className:"text-sm text-gray-900 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),cr?`${js[0]}....`:G.email]})})():t.jsx("div",{className:"text-xs text-gray-400",children:"No email"}),G.firstPhone?t.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),G.firstPhone]}):t.jsx("div",{className:"text-xs text-gray-400",children:"No phone"}),G.personLinkedinUrl||G.companyLinkedinUrl?t.jsxs("div",{className:"text-xs text-blue-600 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("a",{href:G.personLinkedinUrl||G.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"hover:underline truncate",onClick:Gt=>Gt.stopPropagation(),children:"LinkedIn"})]}):t.jsx("div",{className:"text-xs text-gray-400",children:"No LinkedIn"})]})}),t.jsx("td",{className:"px-4 py-2.5",children:Gc(Ct)}),t.jsx("td",{className:"px-4 py-2.5",children:lt?t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-900 font-medium",children:sn(Vn(lt))}),t.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:lt.type==="call"?"Call":lt.type==="email"?"Email":lt.type==="linkedin"?"LinkedIn":"Activity"})]}):t.jsx("div",{className:"text-sm text-gray-400",children:"-"})}),t.jsx("td",{className:"px-4 py-2.5",children:Ke?t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("svg",{className:`w-4 h-4 flex-shrink-0 ${new Date(Ke.nextActionDate)<new Date?"text-red-600":new Date(Ke.nextActionDate)<=new Date(Date.now()+4320*60*1e3)?"text-orange-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ke.nextAction}),t.jsx("div",{className:`text-xs font-medium mt-0.5 ${new Date(Ke.nextActionDate)<new Date?"text-red-600":new Date(Ke.nextActionDate)<=new Date(Date.now()+4320*60*1e3)?"text-orange-600":"text-gray-500"}`,children:sn(Ke.nextActionDate)})]})]}):t.jsx("div",{className:"text-sm text-gray-400",children:"-"})}),t.jsx("td",{className:"px-4 py-2.5",children:t.jsxs("div",{className:"flex items-center gap-1.5",children:[Nr.includes("call")&&t.jsx("button",{onClick:Gt=>{Gt.stopPropagation(),Ca("call",G)},className:"p-1.5 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Log Call",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),Nr.includes("email")&&t.jsx("button",{onClick:Gt=>{Gt.stopPropagation(),Ca("email",G)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Log Email",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),Nr.includes("linkedin")&&t.jsx("button",{onClick:Gt=>{Gt.stopPropagation(),Ca("linkedin",G)},className:"p-1.5 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Log LinkedIn",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})})]})})]}),Xe&&t.jsx("tr",{className:"animate-fade-in",children:t.jsx("td",{colSpan:"7",className:"px-6 py-4 bg-blue-50 border-t-2 border-blue-200 transition-all duration-300",children:st?t.jsx("div",{className:"flex items-center justify-center py-8 animate-fade-in",children:t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Loading activities..."})]})}):t.jsx("div",{className:"animate-fade-in-up",children:t.jsx(ws,{contact:G,activities:He})})})})]},Oe)})})]})})]}):t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-12",children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No prospects found"}),t.jsx("p",{className:"text-sm text-gray-600",children:"No similar contacts found for this project"})]})}),t.jsx(Nv,{isOpen:Re.isOpen,onClose:fs,type:Re.type,contactName:Re.contactName,companyName:Re.companyName,projectId:Re.projectId,contactId:Re.contactId,phoneNumber:Re.phoneNumber,email:Re.email,linkedInProfileUrl:Re.linkedInProfileUrl,lastActivity:Re.lastActivity}),t.jsx(Xk,{isOpen:Ft,onClose:()=>Is(!1),projectId:l,onImportSuccess:()=>{ka?kr():ga(1),hr()}}),t.jsx(Jk,{isOpen:Ir.isOpen,onClose:Tn,type:Ir.type,selectedContacts:Za,projectId:l,contacts:m}),xe.isOpen&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[xe.filter?.channel==="linkedin"&&"LinkedIn Pipeline",xe.filter?.channel==="call"&&"Cold Calling Pipeline",xe.filter?.channel==="email"&&"Email Pipeline"]}),t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[xe.filter?.metric==="connectionSent"&&"Connection Sent",xe.filter?.metric==="accepted"&&"Accepted",(xe.filter?.metric==="followUps"||xe.filter?.metric==="followups")&&"Follow-ups",xe.filter?.metric==="cip"&&"CIP",xe.filter?.metric==="meetingProposed"&&"Meeting Proposed",xe.filter?.metric==="scheduled"&&"Scheduled",xe.filter?.metric==="completed"&&"Completed",xe.filter?.metric==="sql"&&"SQL",xe.filter?.metric==="win"&&"Win",xe.filter?.metric==="connectionRequestsSent"&&"Connection Requests Sent",xe.filter?.metric==="connectionAcceptanceRate"&&"Connection Acceptance Rate",xe.filter?.metric==="messagesSent"&&"Messages Sent",xe.filter?.metric==="messageReplyRate"&&"Message Reply Rate",xe.filter?.metric==="allProspects"&&"All Prospects",xe.filter?.metric==="callsAttempted"&&"Calls Attempted",xe.filter?.metric==="totalCalls"&&"Total Calls",xe.filter?.metric==="callsConnected"&&"Calls Connected",xe.filter?.metric==="decisionMakerReached"&&"Decision Maker Reached",xe.filter?.metric==="interested"&&"Interested",xe.filter?.metric==="detailsShared"&&"Details Shared",xe.filter?.metric==="demoBooked"&&"Demo Booked",xe.filter?.metric==="demoCompleted"&&"Demo Completed",xe.filter?.metric==="sql"&&"SQL",xe.filter?.metric==="won"&&"WON",xe.filter?.metric==="callsMade"&&"Calls Made",xe.filter?.metric==="callAnswerRate"&&"Call Answer Rate",xe.filter?.metric==="callInterestedRate"&&"Call Interested Rate",xe.filter?.metric==="emailsSent"&&"Emails Sent",xe.filter?.metric==="accepted"&&"Accepted",xe.filter?.metric==="followups"&&"Follow-ups",xe.filter?.metric==="cip"&&"CIP",xe.filter?.metric==="meetingProposed"&&"Meeting Proposed",xe.filter?.metric==="scheduled"&&"Scheduled",xe.filter?.metric==="completed"&&"Completed",xe.filter?.metric==="sql"&&"SQL",xe.filter?.metric==="emailBounce"&&"Email Bounce",xe.filter?.metric==="emailOpenRate"&&"Email Open Rate",xe.filter?.metric==="emailReplyRate"&&"Email Reply Rate",xe.filter?.metric==="meetingsBooked"&&"Meetings Booked"]}),!pi&&xe.filter&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing all ",or(xe.filter).length," prospects"]})]}),t.jsx("button",{onClick:Ve,className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:pi?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsx("p",{className:"text-sm font-medium",children:"Loading prospects..."})]}):(()=>{const G=or(xe.filter);return G.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm font-medium",children:"No prospects found for this metric"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"CONTACT"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"COMPANY"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"DATE"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"STATUS"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:G.map(Oe=>{const Xe=(Oe._id?.toString?Oe._id.toString():Oe._id)||"",He=Xe?_r.lastActivityByContactId.get(Xe):null,Ue=(Xe?_r.latestActivityStatusByContactId.get(Xe):null)?.status||Oe.stage||"New",lt=He?Vn(He):null,Ke=lt?lt.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",Be=Xe&&(typeof Xe=="string"&&Xe.length===24||typeof Oe._id=="object"&&Oe._id!==null),Nt=Ct=>{if(!(Ct.target.closest("button")||Ct.target.closest("svg")||Ct.target.closest("a"))&&Be&&Xe){const Rt=new URLSearchParams;Rt.set("page",vs.toString()),Q&&(Rt.set("kpiChannel",Q.channel),Rt.set("kpiMetric",Q.metric),Rt.set("kpiOpen","1"));const Le=`/projects/${l}${Rt.toString()?"?"+Rt.toString():""}`;n(`/contacts/${Xe}/activities?projectId=${l}&returnTo=${encodeURIComponent(Le)}`)}};return t.jsxs("tr",{onClick:Nt,className:`transition-colors ${Be?"hover:bg-blue-50 cursor-pointer":"hover:bg-gray-50"}`,children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:Oe.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:Oe.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:Ke}),t.jsx("td",{className:"px-4 py-3 text-sm",children:t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded-full border border-green-200",children:Ue})})]},Oe._id||Oe.name)})})]})})})()})]})})]})}const tC=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Line}))),Eb=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Bar}))),sC=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Doughnut}))),rC=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Pie})));cl.register(Vc,Wc,Ic,dl,Bc,ym,Uc,Hc,zc);function aC(){const l=Dr(),[n,a]=B.useState(null),[o,s]=B.useState(!0),[e,m]=B.useState("overview"),[v,w]=B.useState("30d");B.useEffect(()=>{N()},[v]);const N=async()=>{try{s(!0);const M=await Ut.get("/projects/analytics");M.data.success&&a(M.data.data)}catch(M){console.error("Error fetching project analytics:",M)}finally{s(!1)}},S=[{id:"overview",label:"Overview",icon:"grid"},{id:"pipeline",label:"Pipeline",icon:"funnel"},{id:"channels",label:"Channels",icon:"megaphone"},{id:"team",label:"Team Performance",icon:"users"}],D=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(o)return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((M,F)=>t.jsx(D,{},F))}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[...Array(4)].map((M,F)=>t.jsx(D,{},F))})]})});if(!n)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data"}),t.jsx("button",{onClick:N,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})});const L=({title:M,value:F,subtitle:O,icon:P,trend:K,trendDirection:ne,color:se="blue"})=>{const Ce={blue:{bg:"from-blue-50 to-indigo-50",border:"border-blue-100",icon:"text-indigo-600",badge:"text-blue-700 bg-white/70 border-blue-100"},green:{bg:"from-emerald-50 to-teal-50",border:"border-emerald-100",icon:"text-emerald-600",badge:"text-emerald-700 bg-white/70 border-emerald-100"},purple:{bg:"from-purple-50 to-indigo-50",border:"border-purple-100",icon:"text-purple-600",badge:"text-purple-700 bg-white/70 border-purple-100"},orange:{bg:"from-amber-50 to-orange-50",border:"border-amber-100",icon:"text-amber-600",badge:"text-amber-700 bg-white/70 border-amber-100"}},ge=Ce[se]||Ce.blue;return t.jsxs("div",{className:`bg-gradient-to-br ${ge.bg} rounded-xl border ${ge.border} shadow-sm p-6 hover:shadow-md transition-shadow`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:`w-12 h-12 rounded-lg bg-white/80 border ${ge.border} flex items-center justify-center shadow-xs`,children:P}),K&&t.jsxs("span",{className:`text-xs font-semibold ${ge.badge} px-2 py-1 rounded-full shadow-xs flex items-center gap-1`,children:[ne==="up"?"":""," ",K]})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:F}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:M}),O&&t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:O})]})};return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>l("/projects"),className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors",title:"Back to Projects",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Project Analytics Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Comprehensive insights into your lead generation campaigns"})]})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs("select",{value:v,onChange:M=>w(M.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"7d",children:"Last 7 days"}),t.jsx("option",{value:"30d",children:"Last 30 days"}),t.jsx("option",{value:"90d",children:"Last 90 days"})]})})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:S.map(M=>t.jsx("button",{onClick:()=>m(M.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${e===M.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:M.label},M.id))})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(L,{title:"Total Projects",value:n.overview.totalProjects,icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),color:"blue"}),t.jsx(L,{title:"Win Rate",value:`${n.pipeline.conversion.winRate}%`,subtitle:`${n.pipeline.conversion.won} won / ${n.pipeline.conversion.total} total`,icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green"}),t.jsx(L,{title:"Meeting Rate",value:`${n.pipeline.conversion.meetingRate}%`,subtitle:`${n.pipeline.conversion.meetings} meetings scheduled`,icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),color:"blue"}),t.jsx(L,{title:"SQL Count",value:n.pipeline.conversion.sql||0,subtitle:"Sales Qualified Leads",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),color:"purple"}),t.jsx(L,{title:"Avg Activities/Prospect",value:n.overview.totalProspects>0?(n.overview.totalActivities/n.overview.totalProspects).toFixed(1):"0",subtitle:"Average engagement",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"orange"}),t.jsx(L,{title:"Total Prospects",value:n.overview.totalProspects.toLocaleString(),subtitle:"Across all projects",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),color:"purple"}),t.jsx(L,{title:"Total Activities",value:n.overview.totalActivities.toLocaleString(),subtitle:"Calls, emails & LinkedIn",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"orange"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Trends (Last 7 Days)"}),n.activities.trends.labels.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(tC,{data:{labels:n.activities.trends.labels,datasets:[{label:"Calls",data:n.activities.trends.call,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4},{label:"Emails",data:n.activities.trends.email,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4},{label:"LinkedIn",data:n.activities.trends.linkedin,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Distribution"}),n.activities.byType.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(sC,{data:{labels:n.activities.byType.map(M=>M.type.charAt(0).toUpperCase()+M.type.slice(1)),datasets:[{data:n.activities.byType.map(M=>M.count),backgroundColor:["rgb(34, 197, 94)","rgb(59, 130, 246)","rgb(168, 85, 247)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Project Growth"}),n.growth.monthly.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Eb,{data:{labels:n.growth.monthly.map(M=>M.month),datasets:[{label:"Projects Created",data:n.growth.monthly.map(M=>M.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No growth data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conversion Metrics"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Win Rate"}),t.jsxs("span",{className:"text-lg font-bold text-green-600",children:[n.pipeline.conversion.winRate,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:"bg-green-500 h-3 rounded-full",style:{width:`${n.pipeline.conversion.winRate}%`}})}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n.pipeline.conversion.won," won / ",n.pipeline.conversion.total," total"]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Meeting Rate"}),t.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[n.pipeline.conversion.meetingRate,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:"bg-blue-500 h-3 rounded-full",style:{width:`${n.pipeline.conversion.meetingRate}%`}})}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n.pipeline.conversion.meetings," meetings scheduled"]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.pipeline.conversion.sql}),t.jsx("div",{className:"text-xs text-gray-500",children:"SQL"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.pipeline.conversion.cip}),t.jsx("div",{className:"text-xs text-gray-500",children:"CIP"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:n.pipeline.conversion.lost}),t.jsx("div",{className:"text-xs text-gray-500",children:"Lost"})]})]})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performing Projects"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Project"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Prospects"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Activities"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Won"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Meetings"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:n.projects.topPerformers.slice(0,5).map(M=>t.jsxs("tr",{onClick:()=>l(`/projects/${M.id}`),className:"hover:bg-gray-50 cursor-pointer",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:M.companyName}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.contactCount}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.activityCount}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:M.wonCount}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.meetingCount})]},M.id))})]})})]})]}),e==="pipeline"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pipeline Stage Distribution"}),n.pipeline.stageDistribution.length>0?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Eb,{data:{labels:n.pipeline.stageDistribution.map(M=>M.stage),datasets:[{label:"Prospects",data:n.pipeline.stageDistribution.map(M=>M.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No pipeline data available"})})]})}),e==="channels"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Channel Usage"}),t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(rC,{data:{labels:["LinkedIn","Email","Cold Calling"],datasets:[{data:[n.channels.linkedIn,n.channels.email,n.channels.calling],backgroundColor:["rgb(168, 85, 247)","rgb(59, 130, 246)","rgb(34, 197, 94)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Channel Statistics"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600",children:"LinkedIn Outreach"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.channels.linkedIn}),t.jsx("div",{className:"text-xs text-gray-500",children:"Projects using this channel"})]}),t.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})})]}),t.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Cold Email"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.channels.email}),t.jsx("div",{className:"text-xs text-gray-500",children:"Projects using this channel"})]}),t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),t.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Cold Calling"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.channels.calling}),t.jsx("div",{className:"text-xs text-gray-500",children:"Projects using this channel"})]}),t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]})]})]})]})}),e==="team"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Team Performance"}),n.team.performance.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Team Member"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Activities"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Calls"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Emails"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"LinkedIn"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:n.team.performance.map(M=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:M.name||"Unknown"}),t.jsx("div",{className:"text-xs text-gray-500",children:M.email})]}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-semibold",children:M.totalActivities}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.calls}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.emails}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.linkedin})]},M.id))})]})}):t.jsx("div",{className:"text-center py-12 text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No team performance data available"})})]})})]})]})}const nC=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Line}))),$u=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Bar}))),np=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Doughnut}))),iC=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Pie})));cl.register(Vc,Wc,Ic,dl,Bc,ym,Uc,Hc,zc);const Db={},Tb={},_b={},lC=60*1e3,M1=(l,n)=>{const a=l[n];return a?Date.now()-a.timestamp>lC?(delete l[n],null):a.data:null},L1=(l,n,a)=>{l[n]={data:a,timestamp:Date.now()}},oC=l=>l.type==="call"&&l.callDate?new Date(l.callDate):l.type==="email"&&l.emailDate?new Date(l.emailDate):l.type==="linkedin"&&l.linkedinDate?new Date(l.linkedinDate):new Date(l.createdAt);function cC(){const l=Dr(),[n,a]=i0(),[o,s]=B.useState(null),[e,m]=B.useState(!0),[v,w]=B.useState("overview"),[N,S]=B.useState([]),[D,L]=B.useState(n.get("projectId")||""),[M,F]=B.useState(null),[O,P]=B.useState([]),[K,ne]=B.useState(!1),[se,Ce]=B.useState(null),[ge,Ne]=B.useState("today"),[J,de]=B.useState(null),[le,ze]=B.useState(!1),[me,oe]=B.useState([]),[ce,ye]=B.useState(!1);B.useEffect(()=>(M?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[M]),B.useEffect(()=>{fe()},[]),B.useEffect(()=>{Se()},[D]),B.useEffect(()=>{Ye()},[D,ge]),B.useEffect(()=>{ke()},[D]);const ke=async()=>{try{const H=D||"all",X=M1(_b,H);X?(oe(X),ye(!1)):ye(!0);const je=D?{projectId:D}:{},Q=await Ut.get("/projects/team-member-funnels",{params:je});if(Q.data.success){const we=Q.data.data||[];oe(we),L1(_b,H,we)}}catch(H){console.error("Error fetching team member funnels:",H),oe([])}finally{ye(!1)}},fe=async()=>{try{const H=await Ut.get("/projects");H.data.success&&S(H.data.data||[])}catch(H){console.error("Error fetching projects:",H)}},Se=async()=>{try{const H=D||"all",X=M1(Db,H);X?(s(X),m(!1)):m(!0);const je=D?{projectId:D}:{},Q=await Ut.get("/projects/prospect-analytics",{params:je});if(Q.data.success){const we=Q.data.data;s(we),L1(Db,H,we)}}catch(H){console.error("Error fetching prospect analytics:",H)}finally{m(!1)}},Ye=async()=>{try{const H=`${D||"all"}:${ge}`,X=M1(Tb,H);X?(de(X),ze(!1)):ze(!0);const je={timeFilter:ge};D&&(je.projectId=D);const Q=await Ut.get("/activities/team-performance",{params:je});if(Q.data.success){const we=Q.data.data;de(we),L1(Tb,H,we)}}catch(H){console.error("Error fetching team activity data:",H),de(null)}finally{ze(!1)}},te=H=>{L(H),a(H?{projectId:H}:{})},pe=async(H,X,je,Q=null)=>{try{if(ne(!0),F({stage:H,funnelType:X,funnelData:je,memberId:Q}),H==="prospectData"){if(!D){Ce({type:"info",message:"Please select a project to view prospects"}),ne(!1);return}const[Fe,ue]=await Promise.all([Ut.get(`/projects/${D}/project-contacts?limit=100`),Ut.get(`/activities/project/${D}?limit=5000`)]);if(Fe.data.success){let xe=Fe.data.data||[],tt=ue.data.success?ue.data.data||[]:[];if(Q){const Ve=Q.toString?Q.toString():String(Q);tt=tt.filter(nt=>nt.createdBy?(nt.createdBy?.toString?nt.createdBy.toString():nt.createdBy?._id?nt.createdBy._id.toString():String(nt.createdBy))===Ve:!1);const xt=new Set(tt.map(nt=>nt.contactId?.toString?nt.contactId.toString():String(nt.contactId)).filter(Boolean));xe=xe.filter(nt=>{const $t=nt._id?.toString?nt._id.toString():String(nt._id);return xt.has($t)})}const Qe=new Map;tt.forEach(Ve=>{if(Ve.contactId&&Ve.status&&Ve.status.trim()!==""){const xt=Ve.contactId.toString?Ve.contactId.toString():String(Ve.contactId),nt=oC(Ve),$t=Qe.get(xt);(!$t||nt>$t.activityDate)&&Qe.set(xt,{status:Ve.status,activityDate:nt})}}),P(xe.map(Ve=>{const xt=Ve._id?.toString?Ve._id.toString():String(Ve._id),$t=Qe.get(xt)?.status||Ve.stage||"New";return{...Ve,isProspect:!0,displayStatus:$t}}))}ne(!1);return}if(!D){Ce({type:"info",message:"Please select a project to view stage details"}),ne(!1);return}const we=await Ut.get(`/activities/project/${D}`);if(we.data.success){let Fe=we.data.data||[];if(Q){const Ve=Q.toString?Q.toString():String(Q);Fe=Fe.filter(xt=>xt.createdBy?(xt.createdBy?.toString?xt.createdBy.toString():xt.createdBy?._id?xt.createdBy._id.toString():String(xt.createdBy))===Ve:!1)}let ue=[];if(X==="call")switch(H){case"callsAttempted":case"callSent":ue=Fe.filter(Mt=>Mt.type==="call"&&Mt.callDate);break;case"callsConnected":case"accepted":const Ve=["Interested","Not Interested","Call Back","Future","Details Shared","Demo Booked","Demo Completed","Existing"];ue=Fe.filter(Mt=>Mt.type==="call"&&Mt.callStatus&&Ve.includes(Mt.callStatus));break;case"decisionMakerReached":const xt=["Interested","Details Shared","Demo Booked","Demo Completed"];ue=Fe.filter(Mt=>Mt.type==="call"&&Mt.callStatus&&xt.includes(Mt.callStatus));break;case"interested":ue=Fe.filter(Mt=>Mt.type==="call"&&Mt.callStatus==="Interested");break;case"detailsShared":ue=Fe.filter(Mt=>Mt.type==="call"&&Mt.callStatus==="Details Shared");break;case"demoBooked":case"scheduled":ue=Fe.filter(Mt=>Mt.type==="call"&&Mt.callStatus==="Demo Booked");break;case"demoCompleted":case"completed":ue=Fe.filter(Mt=>Mt.type==="call"&&Mt.callStatus==="Demo Completed");break;case"sql":ue=Fe.filter(Mt=>Mt.type==="call"&&(Mt.callStatus==="Demo Completed"||Mt.callStatus==="Interested"&&Mt.conversationNotes&&Mt.conversationNotes.length>50||Mt.status==="SQL"));break;case"followups":const nt={};Fe.filter(Mt=>Mt.type==="call"&&Mt.callDate).forEach(Mt=>{const Es=Mt.contactId?.toString();Es&&(nt[Es]=(nt[Es]||0)+1)});const $t=Object.keys(nt).filter(Mt=>nt[Mt]>1);ue=Fe.filter(Mt=>Mt.type==="call"&&$t.includes(Mt.contactId?.toString()));break;case"cip":ue=Fe.filter(Mt=>Mt.type==="call"&&["Interested","Call Back","Future"].includes(Mt.callStatus));break;case"meetingProposed":ue=Fe.filter(Mt=>Mt.type==="call"&&Mt.nextAction&&(Mt.nextAction.toLowerCase().includes("meeting")||Mt.nextAction.toLowerCase().includes("demo")||Mt.nextAction.toLowerCase().includes("call")));break}else if(X==="email")switch(H){case"emailSent":ue=Fe.filter(nt=>nt.type==="email"&&nt.emailDate);break;case"accepted":ue=Fe.filter(nt=>nt.type==="email"&&["Interested","Meeting Proposed","Meeting Scheduled"].includes(nt.status));break;case"followups":const Ve={};Fe.filter(nt=>nt.type==="email"&&nt.emailDate).forEach(nt=>{const $t=nt.contactId?.toString();$t&&(Ve[$t]=(Ve[$t]||0)+1)});const xt=Object.keys(Ve).filter(nt=>Ve[nt]>1);ue=Fe.filter(nt=>nt.type==="email"&&xt.includes(nt.contactId?.toString()));break;case"cip":ue=Fe.filter(nt=>nt.type==="email"&&nt.status==="CIP");break;case"meetingProposed":ue=Fe.filter(nt=>nt.type==="email"&&nt.status==="Meeting Proposed");break;case"scheduled":ue=Fe.filter(nt=>nt.type==="email"&&nt.status==="Meeting Scheduled");break;case"completed":ue=Fe.filter(nt=>nt.type==="email"&&nt.status==="Meeting Completed");break;case"sql":ue=Fe.filter(nt=>nt.type==="email"&&["SQL","Meeting Completed"].includes(nt.status));break}else if(X==="linkedin")switch(H){case"connectionSent":ue=Fe.filter(nt=>nt.type==="linkedin"&&(nt.lnRequestSent==="Yes"||nt.lnRequestSent===!0));break;case"accepted":ue=Fe.filter(nt=>nt.type==="linkedin"&&(nt.connected==="Yes"||nt.connected===!0));break;case"followups":const Ve={};Fe.filter(nt=>nt.type==="linkedin").forEach(nt=>{const $t=nt.contactId?.toString();$t&&(Ve[$t]=(Ve[$t]||0)+1)});const xt=Object.keys(Ve).filter(nt=>Ve[nt]>1);ue=Fe.filter(nt=>nt.type==="linkedin"&&xt.includes(nt.contactId?.toString()));break;case"cip":ue=Fe.filter(nt=>nt.type==="linkedin"&&nt.status==="CIP");break;case"meetingProposed":ue=Fe.filter(nt=>nt.type==="linkedin"&&nt.status==="Meeting Proposed");break;case"scheduled":ue=Fe.filter(nt=>nt.type==="linkedin"&&nt.status==="Meeting Scheduled");break;case"completed":ue=Fe.filter(nt=>nt.type==="linkedin"&&nt.status==="Meeting Completed");break;case"sql":ue=Fe.filter(nt=>nt.type==="linkedin"&&["SQL","Meeting Completed"].includes(nt.status));break}const xe=[...new Set(ue.map(Ve=>Ve.contactId).filter(Boolean))],tt=new Map;xe.length>0&&(await Promise.all(xe.slice(0,100).map(xt=>Ut.get(`/contacts/${xt}`).catch(()=>null)))).forEach((xt,nt)=>{xt?.data?.success&&tt.set(xe[nt],xt.data.data)});const Qe=ue.map(Ve=>({...Ve,contact:tt.get(Ve.contactId?.toString())||null}));P(Qe)}}catch(we){console.error("Error fetching stage data:",we),P([])}finally{ne(!1)}},V=B.useMemo(()=>{if(!D)return["call","email","linkedin"];const H=N.find(je=>je._id===D);if(!H?.channels)return["call","email","linkedin"];const X=[];return H.channels.coldCalling&&X.push("call"),H.channels.coldEmail&&X.push("email"),H.channels.linkedInOutreach&&X.push("linkedin"),X.length>0?X:["call","email","linkedin"]},[D,N]),be=B.useMemo(()=>[{id:"overview",label:"Overview"},{id:"pipeline",label:"Pipeline"},{id:"linkedin",label:"LinkedIn"},{id:"calls",label:"Cold Calls"},{id:"email",label:"Email"},{id:"team",label:"Team Performance"}].filter(X=>["overview","pipeline","team"].includes(X.id)?!0:X.id==="linkedin"?V.includes("linkedin"):X.id==="calls"?V.includes("call"):X.id==="email"?V.includes("email"):!0),[V]);B.useEffect(()=>{const H=be.map(X=>X.id);H.includes(v)||w(H[0]||"overview")},[be,v]);const _e=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(e)return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((H,X)=>t.jsx(_e,{},X))})})});if(!o)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-600",children:"Having trouble loading the dashboard. Refresh the page."}),t.jsx("button",{onClick:Se,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})});const De=({title:H,value:X,subtitle:je,icon:Q,color:we="blue",compact:Fe=!1})=>{const ue={blue:{bg:"from-blue-50 to-indigo-50",border:"border-blue-100",icon:"text-indigo-600",badge:"text-blue-700 bg-white/70 border-blue-100"},green:{bg:"from-emerald-50 to-teal-50",border:"border-emerald-100",icon:"text-emerald-600",badge:"text-emerald-700 bg-white/70 border-emerald-100"},purple:{bg:"from-purple-50 to-indigo-50",border:"border-purple-100",icon:"text-purple-600",badge:"text-purple-700 bg-white/70 border-purple-100"},orange:{bg:"from-amber-50 to-orange-50",border:"border-amber-100",icon:"text-amber-600",badge:"text-amber-700 bg-white/70 border-amber-100"}},xe=ue[we]||ue.blue;return Fe?t.jsxs("div",{className:`bg-gradient-to-br ${xe.bg} rounded-lg border ${xe.border} shadow-sm p-4 hover:shadow-md transition-shadow h-full`,children:[t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsx("div",{className:`w-8 h-8 rounded-lg bg-white/80 border ${xe.border} flex items-center justify-center shadow-xs`,children:typeof Q=="object"&&Q.props?Mo.cloneElement(Q,{className:"w-4 h-4"}):Q})}),t.jsx("div",{className:"text-xl font-bold text-gray-900 leading-tight mb-1",children:X}),t.jsx("div",{className:"text-xs font-medium text-gray-700",children:H}),je&&t.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:je})]}):t.jsxs("div",{className:`bg-gradient-to-br ${xe.bg} rounded-xl border ${xe.border} shadow-sm p-6 hover:shadow-md transition-shadow`,children:[t.jsx("div",{className:"flex items-center justify-between mb-3",children:t.jsx("div",{className:`w-12 h-12 rounded-lg bg-white/80 border ${xe.border} flex items-center justify-center shadow-xs`,children:Q})}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:X}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:H}),je&&t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:je})]})},W=({title:H,data:X,color:je="blue",funnelType:Q="call",totalProspects:we=null,memberId:Fe=null})=>{let ue=[];X.prospectData===void 0&&we!==null&&(X={...X,prospectData:we}),X.callsAttempted!==void 0||X.callSent!==void 0?(ue=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"callsAttempted",label:"Calls Attempted",clickable:!0},{key:"callsConnected",label:"Calls Connected",clickable:!0},{key:"decisionMakerReached",label:"Decision Maker Reached",clickable:!0},{key:"interested",label:"Interested",clickable:!0},{key:"detailsShared",label:"Details Shared",clickable:!0},{key:"demoBooked",label:"Demo Booked",clickable:!0},{key:"demoCompleted",label:"Demo Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}],X.callSent!==void 0&&X.callsAttempted===void 0&&(ue=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"callSent",label:"Call Sent",clickable:!0},{key:"accepted",label:"Accepted",clickable:!0},{key:"followups",label:"Followups",clickable:!0},{key:"cip",label:"CIP",clickable:!0},{key:"meetingProposed",label:"Meeting Proposed",clickable:!0},{key:"scheduled",label:"Scheduled",clickable:!0},{key:"completed",label:"Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}])):X.emailSent!==void 0?ue=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"emailSent",label:"Email Sent",clickable:!0},{key:"accepted",label:"Accepted",clickable:!0},{key:"followups",label:"Followups",clickable:!0},{key:"cip",label:"CIP",clickable:!0},{key:"meetingProposed",label:"Meeting Proposed",clickable:!0},{key:"scheduled",label:"Scheduled",clickable:!0},{key:"completed",label:"Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}]:X.connectionSent!==void 0&&(ue=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"connectionSent",label:"Connection Sent",clickable:!0},{key:"accepted",label:"Accepted",clickable:!0},{key:"followups",label:"Followups",clickable:!0},{key:"cip",label:"CIP",clickable:!0},{key:"meetingProposed",label:"Meeting Proposed",clickable:!0},{key:"scheduled",label:"Scheduled",clickable:!0},{key:"completed",label:"Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}]),ue=ue.filter(nt=>nt.key);const xe=X.prospectData||(X.prospectData===0?0:1),tt={blue:{primary:"rgb(59, 130, 246)",light:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 0.3)",hover:"rgba(59, 130, 246, 0.2)"},green:{primary:"rgb(34, 197, 94)",light:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",hover:"rgba(34, 197, 94, 0.2)"},purple:{primary:"rgb(168, 85, 247)",light:"rgba(168, 85, 247, 0.1)",border:"rgba(168, 85, 247, 0.3)",hover:"rgba(168, 85, 247, 0.2)"}},Qe=tt[je]||tt.blue,Ve=(nt,$t)=>nt===0?100:Math.max(15,100-nt*10),xt=nt=>{if(nt.key==="prospectData"){pe(nt.key,Q,X,Fe);return}nt.clickable&&(X[nt.key]||0)>0?pe(nt.key,Q,X,Fe):nt.clickable&&(Ce({type:"info",message:`No records found for ${nt.label} stage`}),setTimeout(()=>Ce(null),3e3))};return t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow h-full",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4 text-center",children:H}),t.jsx("div",{className:"flex flex-col items-center space-y-0",children:ue.map((nt,$t)=>{const Mt=nt.key==="prospectData"?X[nt.key]!==void 0?X[nt.key]:xe:X[nt.key]||0,Es=xe>0?(Mt/xe*100).toFixed(1):0,qs=Ve($t,ue.length),ms=xe>0?Mt/xe*qs:0,ys=nt.clickable;return t.jsxs("div",{className:"relative w-full flex flex-col items-center",children:[t.jsxs("div",{onClick:()=>xt(nt),className:`relative transition-all duration-300 ${ys?"cursor-pointer hover:scale-[1.03] group":"cursor-default"}`,style:{width:`${qs}%`,minHeight:"28px",display:"flex",alignItems:"center",justifyContent:"center"},title:ys?Mt>0?`Click to view ${Mt} ${nt.label.toLowerCase()} records`:`Click to view ${nt.label.toLowerCase()}`:"",children:[t.jsx("div",{className:`absolute inset-0 transition-all duration-300 ${ys?"group-hover:brightness-110 group-hover:shadow-md":""}`,style:{clipPath:$t===0?"polygon(0 0, 100% 0, 95% 100%, 5% 100%)":$t===ue.length-1?"polygon(15% 0, 85% 0, 100% 100%, 0 100%)":"polygon(8% 0, 92% 0, 96% 100%, 4% 100%)",backgroundColor:Qe.light,border:`2px solid ${Qe.border}`,borderBottom:$t<ue.length-1?"none":`2px solid ${Qe.border}`}}),ms>0&&t.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 transition-all duration-500",style:{width:`${Math.max(20,ms/qs*100)}%`,height:"100%",backgroundColor:Qe.primary,clipPath:$t===0?"polygon(0 0, 100% 0, 95% 100%, 5% 100%)":$t===ue.length-1?"polygon(15% 0, 85% 0, 100% 100%, 0 100%)":"polygon(8% 0, 92% 0, 96% 100%, 4% 100%)",opacity:.85}}),t.jsxs("div",{className:"relative z-10 w-full px-2 py-1 text-center",children:[t.jsxs("div",{className:`text-xs font-bold mb-0.5 ${ys?"text-gray-800":"text-gray-600"}`,children:[nt.label,ys&&t.jsxs("svg",{className:"w-2.5 h-2.5 inline-block ml-1 opacity-70",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})]}),t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx("span",{className:"text-xs font-bold text-gray-900",children:Mt.toLocaleString()}),t.jsxs("span",{className:"text-xs text-gray-500",children:["(",Es,"%)"]})]})]})]}),$t<ue.length-1&&t.jsx("div",{className:"w-0.5",style:{height:"4px",backgroundColor:Qe.primary,opacity:.3}})]},nt.key)})}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-600 mb-1 text-xs font-medium",children:"Conversion"}),t.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[xe>0?(X.sql/xe*100).toFixed(1):0,"%"]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-600 mb-1 text-xs font-medium",children:"Meetings"}),t.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[xe>0?(X.scheduled/xe*100).toFixed(1):0,"%"]})]})]})})]})};return t.jsxs("div",{className:"min-h-screen bg-gray-50 relative",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-20 shadow-sm backdrop-blur-sm bg-white/95",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>{if(D||o?.project?.id){const H=D||o.project.id;l(`/projects/${H}`)}else l("/projects")},className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors",title:D||o?.project?.id?"Back to Prospect Management":"Back to Projects",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Prospect Analytics Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.project?`Analytics for ${o.project.companyName}`:"Comprehensive insights across all projects"})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("select",{value:D,onChange:H=>te(H.target.value),className:"px-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white min-w-[200px]",children:[t.jsx("option",{value:"",children:"All Projects"}),N.map(H=>t.jsx("option",{value:H._id,children:H.companyName},H._id))]}),o.project&&t.jsx("button",{onClick:()=>l(`/projects/${o.project.id}`),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"View Project"})]})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:be.map(H=>t.jsx("button",{onClick:()=>w(H.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${v===H.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:H.label},H.id))})]})}),se&&t.jsx("div",{className:"fixed top-20 right-4 z-50",style:{animation:"slideInRight 0.3s ease-out"},children:t.jsx("div",{className:`px-4 py-3 rounded-lg shadow-xl border-2 ${se.type==="info"?"bg-blue-50 border-blue-200 text-blue-800":se.type==="error"?"bg-red-50 border-red-200 text-red-800":"bg-green-50 border-green-200 text-green-800"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[se.type==="info"&&t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"text-sm font-medium",children:se.message}),t.jsx("button",{onClick:()=>Ce(null),className:"ml-2 text-current opacity-70 hover:opacity-100 transition-opacity",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}),t.jsx("style",{children:`
        @keyframes slideInRight {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
      `}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 relative z-0",children:[v==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:[t.jsx(De,{title:"Total Prospects",value:o.overview.totalProspects.toLocaleString(),icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),color:"blue",compact:!0}),t.jsx(De,{title:"Total Activities",value:o.overview.totalActivities.toLocaleString(),subtitle:"Calls, emails & LinkedIn",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"green",compact:!0}),t.jsx(De,{title:"Win Rate",value:`${o.pipeline.conversion.winRate}%`,subtitle:`${o.pipeline.conversion.won} won`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"purple",compact:!0}),t.jsx(De,{title:"Meeting Rate",value:`${o.pipeline.conversion.meetingRate}%`,subtitle:`${o.pipeline.conversion.meetings} meetings`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),color:"orange",compact:!0}),t.jsx(De,{title:"SQL Rate",value:o.overview.totalProspects>0?`${(o.pipeline.conversion.sql/o.overview.totalProspects*100).toFixed(1)}%`:"0%",subtitle:`${o.pipeline.conversion.sql} SQL leads`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),color:"blue",compact:!0}),t.jsx(De,{title:"CIP Rate",value:o.overview.totalProspects>0?`${(o.pipeline.conversion.cip/o.overview.totalProspects*100).toFixed(1)}%`:"0%",subtitle:`${o.pipeline.conversion.cip} CIP prospects`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),color:"green",compact:!0}),t.jsx(De,{title:"Avg Activities/Prospect",value:o.overview.totalProspects>0?(o.overview.totalActivities/o.overview.totalProspects).toFixed(1):"0",subtitle:"Average engagement",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"purple",compact:!0}),t.jsx(De,{title:"Lost Deals",value:o.pipeline.conversion.lost||0,subtitle:"Deals lost",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),color:"orange",compact:!0})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Funnel Analytics"}),t.jsx("div",{className:`${V.length===1?"flex justify-center":V.length===2?"flex justify-center gap-6":"overflow-x-auto"}`,children:t.jsxs("div",{className:`${V.length===1?"w-80":V.length===2?"flex gap-6":"flex gap-6 min-w-max pb-2"}`,children:[V.includes("call")&&t.jsx("div",{className:`${V.length===1||V.length===2?"w-80":"flex-shrink-0 w-80"}`,children:t.jsx(W,{title:"Cold Calling Funnel",data:o.funnels.coldCalling,color:"green",funnelType:"call",totalProspects:o.overview?.totalProspects})}),V.includes("email")&&t.jsx("div",{className:`${V.length===1||V.length===2?"w-80":"flex-shrink-0 w-80"}`,children:t.jsx(W,{title:"Email Funnel",data:o.funnels.email,color:"blue",funnelType:"email",totalProspects:o.overview?.totalProspects})}),V.includes("linkedin")&&t.jsx("div",{className:`${V.length===1||V.length===2?"w-80":"flex-shrink-0 w-80"}`,children:t.jsx(W,{title:"LinkedIn Funnel",data:o.funnels.linkedin,color:"purple",funnelType:"linkedin",totalProspects:o.overview?.totalProspects})})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Trends (Last 7 Days)"}),o.activities.trends.labels.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(nC,{data:{labels:o.activities.trends.labels,datasets:[...V.includes("call")?[{label:"Calls",data:o.activities.trends.call,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4}]:[],...V.includes("email")?[{label:"Emails",data:o.activities.trends.email,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4}]:[],...V.includes("linkedin")?[{label:"LinkedIn",data:o.activities.trends.linkedin,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4}]:[]]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Distribution"}),o.activities.byType.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(np,{data:{labels:o.activities.byType.filter(H=>{const X=H.type.toLowerCase();return X==="call"&&V.includes("call")||X==="email"&&V.includes("email")||X==="linkedin"&&V.includes("linkedin")}).map(H=>H.type.charAt(0).toUpperCase()+H.type.slice(1)),datasets:[{data:o.activities.byType.filter(H=>{const X=H.type.toLowerCase();return X==="call"&&V.includes("call")||X==="email"&&V.includes("email")||X==="linkedin"&&V.includes("linkedin")}).map(H=>H.count),backgroundColor:[...V.includes("call")?["rgb(34, 197, 94)"]:[],...V.includes("email")?["rgb(59, 130, 246)"]:[],...V.includes("linkedin")?["rgb(168, 85, 247)"]:[]]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Prospect Stage Distribution"}),o.prospects.stageDistribution.length>0?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx($u,{data:{labels:o.prospects.stageDistribution.map(H=>H.stage),datasets:[{label:"Prospects",data:o.prospects.stageDistribution.map(H=>H.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No stage data available"})})]}),o.topPerformers&&o.topPerformers.length>0&&t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performing Prospects"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Prospect"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Activities"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Last Activity"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:o.topPerformers.map(H=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:H.name}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.company}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-semibold",children:H.activityCount}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.lastActivity?new Date(H.lastActivity).toLocaleDateString():"N/A"})]},H.id))})]})})]})]}),v==="funnels"&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:`${V.length===1?"flex justify-center":V.length===2?"grid grid-cols-1 lg:grid-cols-2 gap-3 justify-center":"grid grid-cols-1 lg:grid-cols-3 gap-3"}`,children:[V.includes("call")&&t.jsx(W,{title:"Cold Calling Funnel",data:o.funnels.coldCalling,color:"green",funnelType:"call",totalProspects:o.overview?.totalProspects}),V.includes("email")&&t.jsx(W,{title:"Email Funnel",data:o.funnels.email,color:"blue",funnelType:"email",totalProspects:o.overview?.totalProspects}),V.includes("linkedin")&&t.jsx(W,{title:"LinkedIn Funnel",data:o.funnels.linkedin,color:"purple",funnelType:"linkedin",totalProspects:o.overview?.totalProspects})]}),M&&t.jsx("div",{className:"text-xs text-gray-500 text-center mt-2",children:"Click on any stage above to view detailed records"})]}),v==="pipeline"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Pipeline Analysis"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Monitor your sales pipeline and conversion metrics"})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Conversion Metrics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:[o.pipeline.conversion.winRate,"%"]}),t.jsx("div",{className:"text-base font-semibold text-gray-700 mb-1",children:"Win Rate"}),t.jsxs("div",{className:"text-sm text-gray-600",children:[o.pipeline.conversion.won," won / ",o.pipeline.conversion.total," total"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"text-4xl font-bold text-green-600 mb-2",children:[o.pipeline.conversion.meetingRate,"%"]}),t.jsx("div",{className:"text-base font-semibold text-gray-700 mb-1",children:"Meeting Rate"}),t.jsxs("div",{className:"text-sm text-gray-600",children:[o.pipeline.conversion.meetings," meetings scheduled"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:o.pipeline.conversion.sql}),t.jsx("div",{className:"text-base font-semibold text-gray-700 mb-1",children:"SQL Count"}),t.jsx("div",{className:"text-sm text-gray-600",children:"Sales Qualified Leads"})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Pipeline Stage Distribution"}),o.prospects.byStage&&o.prospects.byStage.length>0?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx($u,{data:{labels:o.prospects.byStage.map(H=>H.stage||H._id),datasets:[{label:"Prospects",data:o.prospects.byStage.map(H=>H.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0,ticks:{stepSize:50}},y:{ticks:{font:{size:12}}}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No pipeline data available"})})]})]}),V.includes("linkedin")&&v==="linkedin"&&(()=>{const H=o.funnels.linkedin||{},X=H.connectionSent||0,je=H.accepted||0,Q=H.followups||0,we=H.scheduled||0,Fe=H.completed||0,ue=X>0?je/X*100:0,xe=Q>0?Q/X*100:0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"LinkedIn"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:X.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Connection Requests Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ue.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[je.toLocaleString()," accepted"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Messages"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Q.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Messages Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[xe.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[Q.toLocaleString()," replies"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(we+Fe).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"LinkedIn Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx($u,{data:{labels:["Requests Sent","Accepted","Messages Sent","Replies","Meetings"],datasets:[{label:"LinkedIn Funnel",data:[X,je,Q,Q,we+Fe],backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:tt=>`${tt.label}: ${tt.parsed.y.toLocaleString()}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:12}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Connection Acceptance Rate"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(np,{data:{labels:["Accepted","Not Accepted"],datasets:[{label:"Connection Requests",data:[je,Math.max(0,X-je)],backgroundColor:["#10B981","#EF4444"],borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:tt=>{const Qe=tt.label||"",Ve=tt.parsed||0,xt=X>0?Ve/X*100:0;return`${Qe}: ${Ve.toLocaleString()} (${xt.toFixed(1)}%)`}}}}}})})})]})]})]})})(),V.includes("call")&&v==="calls"&&(()=>{const H=o.funnels.coldCalling||{},X=H.callsAttempted||0,je=H.callsConnected||0,Q=H.decisionMakerReached||0,we=H.interested||0,Fe=(H.demoBooked||0)+(H.demoCompleted||0),ue=X>0?je/X*100:0,xe=H.callStatusBreakdown||{},tt=Object.keys(xe).filter(nt=>xe[nt]>0&&xe[nt]!==void 0),Qe=tt.map(nt=>xe[nt]),Ve={Interested:"#10B981","Not Interested":"#EF4444",Ring:"#F59E0B",Busy:"#F97316","Call Back":"#3B82F6","Hang Up":"#EF4444","Switch Off":"#6B7280",Future:"#8B5CF6","Details Shared":"#06B6D4","Demo Booked":"#10B981",Invalid:"#9CA3AF",Existing:"#6366F1","Demo Completed":"#059669","No Status":"#D1D5DB"},xt=tt.map(nt=>Ve[nt]||"#9CA3AF");return tt.length===0&&X>0&&console.log("Call Status Breakdown Debug:",{callStatusBreakdown:xe,callData:H,callsMade:X,statusLabels:tt}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Calls"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:X.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Calls Made"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ue.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[je.toLocaleString()," connected"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Decision"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Q.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Decision Maker Connects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Interested"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:we.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Interested"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Fe.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Cold Call Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx($u,{data:{labels:["Calls Made","Connected","Decision Maker","Interested","Meetings"],datasets:[{label:"Cold Call Funnel",data:[X,je,Q,we,Fe],backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:nt=>`${nt.label}: ${nt.parsed.y.toLocaleString()}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:25}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Call Status Distribution"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:tt.length>0?t.jsx(np,{data:{labels:tt,datasets:[{label:"Call Status",data:Qe,backgroundColor:xt,borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle",color:"#374151"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,callbacks:{label:nt=>{const $t=nt.label||"",Mt=nt.parsed||0,Es=Qe.reduce((ms,ys)=>ms+ys,0),qs=Es>0?(Mt/Es*100).toFixed(1):0;return`${$t}: ${Mt.toLocaleString()} (${qs}%)`}}}}}}):X>0?t.jsxs("div",{className:"text-gray-500 text-sm text-center",children:[t.jsx("p",{children:"No call status data available"}),t.jsx("p",{className:"text-xs mt-2",children:"Calls have been made but status information is missing"})]}):t.jsx("div",{className:"text-gray-500 text-sm",children:"No calls made yet"})})})]})]})]})})(),V.includes("email")&&v==="email"&&(()=>{const H=o.funnels.email||{},X=H.emailSent||0,je=H.accepted||0,Q=H.scheduled||0,we=H.completed||0,Fe=H.sql||0,ue=X>0?je/X*100:0,xe=X>0?Fe/X*100:0,tt=Q+we;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Email"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:X.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Emails Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsxs("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ue.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[je.toLocaleString()," opened"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[xe.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[Fe.toLocaleString()," replies"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:tt.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-pink-50 rounded-xl border border-red-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full shadow-xs",children:"Bounce"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:"0.0%"}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Bounce Rate"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx($u,{data:{labels:["Emails Sent","Opened","Replied","Meetings"],datasets:[{label:"Email Funnel",data:[X,je,Fe,tt],backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:Qe=>`${Qe.label}: ${Qe.parsed.y.toLocaleString()}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:10}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Status Distribution"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(np,{data:{labels:["Replied","Opened","No Reply"],datasets:[{label:"Email Status",data:[Fe,Math.max(0,je-Fe),Math.max(0,X-je)],backgroundColor:["#10B981","#3B82F6","#9CA3AF"],borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:Qe=>{const Ve=Qe.label||"",xt=Qe.parsed||0,nt=X>0?xt/X*100:0;return`${Ve}: ${xt.toLocaleString()} (${nt.toFixed(1)}%)`}}}}}})})})]})]})]})})(),v==="team"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Team Performance"}),ce?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):me.length>0?t.jsx("div",{className:`${me.length===1?"flex justify-center":me.length===2?"grid grid-cols-1 lg:grid-cols-2 gap-6":"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6"}`,children:me.map(H=>{const X=o?.team?.performance?.find(je=>je.id===H.memberId);return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-100",children:[t.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-1",children:H.name}),t.jsx("p",{className:"text-xs text-gray-600",children:H.email}),X&&t.jsxs("div",{className:"mt-2 flex gap-4 text-xs text-gray-600",children:[t.jsxs("span",{children:["Total: ",t.jsx("span",{className:"font-semibold text-gray-900",children:X.totalActivities})]}),V.includes("call")&&t.jsxs("span",{children:["Calls: ",t.jsx("span",{className:"font-semibold text-gray-900",children:X.calls})]}),V.includes("email")&&t.jsxs("span",{children:["Emails: ",t.jsx("span",{className:"font-semibold text-gray-900",children:X.emails})]}),V.includes("linkedin")&&t.jsxs("span",{children:["LinkedIn: ",t.jsx("span",{className:"font-semibold text-gray-900",children:X.linkedin})]})]})]}),t.jsxs("div",{className:"space-y-3",children:[V.includes("call")&&H.funnels.coldCalling&&t.jsx(W,{title:`${H.name} - Cold Calling`,data:H.funnels.coldCalling,color:"green",funnelType:"call",totalProspects:o.overview?.totalProspects,memberId:H.memberId}),V.includes("linkedin")&&H.funnels.linkedin&&t.jsx(W,{title:`${H.name} - LinkedIn`,data:H.funnels.linkedin,color:"purple",funnelType:"linkedin",totalProspects:o.overview?.totalProspects,memberId:H.memberId}),V.includes("email")&&H.funnels.email&&t.jsx(W,{title:`${H.name} - Email`,data:H.funnels.email,color:"blue",funnelType:"email",totalProspects:o.overview?.totalProspects,memberId:H.memberId})]})]},H.memberId)})}):t.jsx("div",{className:"text-center py-12 text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No team performance data available"})})]}),t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Time Period:"}),t.jsx("button",{onClick:()=>Ne("today"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${ge==="today"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Today"}),t.jsx("button",{onClick:()=>Ne("last7days"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${ge==="last7days"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Last 7 Days"}),t.jsx("button",{onClick:()=>Ne("lastMonth"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${ge==="lastMonth"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Last Month"})]})}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Trends"}),le?t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):J?.chartData?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-full flex items-center justify-center",children:"Loading chart..."}),children:t.jsx($u,{data:J.chartData,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Activities by Type and Status"}},scales:{x:{stacked:!0},y:{stacked:!0,beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Distribution by Channel"}),le?t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):J?.pieData?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-full flex items-center justify-center",children:"Loading chart..."}),children:t.jsx(iC,{data:J.pieData,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"},title:{display:!0,text:"Activities by Channel"}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]})]})]}),M&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[100] flex items-center justify-center p-4",onClick:()=>{F(null),P([])},style:{position:"fixed",top:0,left:0,right:0,bottom:0},children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] flex flex-col relative z-[101]",onClick:H=>H.stopPropagation(),style:{position:"relative",zIndex:101},children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gradient-to-r from-gray-50 to-white",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900",children:M.memberId?(()=>{const X=me.find(je=>{const Q=je.memberId?.toString?je.memberId.toString():String(je.memberId),we=M.memberId?.toString?M.memberId.toString():String(M.memberId);return Q===we})?.name||"Team Member";return M.stage==="prospectData"?`${X} - All Prospects`:`${X} - ${M.stage.charAt(0).toUpperCase()+M.stage.slice(1)} - ${M.funnelType==="call"?"Cold Calling":M.funnelType==="email"?"Email":"LinkedIn"} Funnel`})():M.stage==="prospectData"?"All Prospects":M.stage.charAt(0).toUpperCase()+M.stage.slice(1)+" - "+(M.funnelType==="call"?"Cold Calling":M.funnelType==="email"?"Email":"LinkedIn")+" Funnel"}),t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[O.length," ",M.stage==="prospectData"?"prospect":"record",O.length!==1?"s":""," found"]})]}),t.jsx("button",{onClick:()=>{F(null),P([])},className:"text-gray-400 hover:text-gray-600 transition-colors p-1 hover:bg-gray-100 rounded-lg",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:K?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}):O.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-200 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:M.stage==="prospectData"?"Prospect":"Contact"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Company"}),M.stage==="prospectData"?t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Phone"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Stage"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Priority"})]}):t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Status"})]})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:O.map((H,X)=>H.isProspect||M.stage==="prospectData"?t.jsxs("tr",{className:"hover:bg-blue-50/50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:H.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:H.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.email||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.firstPhone||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm",children:(H.displayStatus||H.stage)&&t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-purple-100 text-purple-800 rounded-full border border-purple-200",children:H.displayStatus||H.stage})}),t.jsx("td",{className:"px-4 py-3 text-sm",children:H.priority&&t.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full border ${H.priority==="High"?"bg-red-100 text-red-800 border-red-200":H.priority==="Medium"?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-gray-100 text-gray-800 border-gray-200"}`,children:H.priority})})]},X):t.jsxs("tr",{className:"hover:bg-blue-50/50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:H.contact?.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:H.contact?.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.callDate||H.emailDate||H.linkedinDate?new Date(H.callDate||H.emailDate||H.linkedinDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):H.createdAt?new Date(H.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}),t.jsxs("td",{className:"px-4 py-3 text-sm",children:[H.status&&t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded-full border border-blue-200",children:H.status}),H.callStatus&&t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded-full border border-green-200",children:H.callStatus}),!H.status&&!H.callStatus&&t.jsx("span",{className:"text-xs text-gray-400",children:"-"})]})]},X))})]})}):t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm font-medium",children:"No records found for this stage"})]})})]})})]})}const dC=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Line}))),Do=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Bar}))),qu=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Doughnut})));cl.register(Vc,Wc,Ic,dl,Bc,ym,Uc,Hc,zc);let R1=null,Fb=0;const uC=60*1e3;function hC(){const[l,n]=B.useState(null),[a,o]=B.useState(!0),[s,e]=B.useState("executive"),m=B.useRef(!0);B.useEffect(()=>(m.current=!0,(async()=>{const pe=Date.now();R1&&pe-Fb<uC?m.current&&(n(R1),o(!1)):await v()})(),()=>{m.current=!1}),[]);const v=async()=>{if(m.current)try{o(!0);const te=await Ut.get("/master-dashboard");if(te.data.success&&m.current){const pe=te.data.data;n(pe),R1=pe,Fb=Date.now()}}catch(te){console.error("Error fetching master dashboard data:",te)}finally{m.current&&o(!1)}},w=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(a)return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(8)].map((te,pe)=>t.jsx(w,{},pe))})})});if(!l)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-600",children:"Couldn't load the dashboard right now. Try refreshing."}),t.jsx("button",{onClick:v,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})});const N=l?.executive||{},S=l?.rankings||{bestPerformingProjects:[],channelEfficiency:{linkedin:{acceptanceRate:0},call:{connectRate:0},email:{replyRate:0}},teamLeaderboard:[]},D=l?.alerts||{lowActivityProjects:[],highBounceProjects:[],missingFollowUps:[]},L=l?.dataQuality||{leadsAddedDaily:0,leadsAddedWeekly:0,validEmailPercent:0,validPhonePercent:0,duplicatePercent:0,dataQualityScore:0,totalProspects:0,validEmailCount:0,validPhoneCount:0,duplicateCount:0},M=l?.linkedin||{connectionRequestsSent:0,acceptanceRate:0,accepted:0,messagesSent:0,replies:0,replyRate:0,meetingsBooked:0},F=l?.coldCall||{callsMade:0,connectRate:0,connected:0,decisionMakerConnects:0,interested:0,meetingsBooked:0},O=l?.email||{emailsSent:0,bounceRate:0,bounced:0,replyRate:0,replied:0,positiveReplies:0,meetingsBooked:0},P=l?.followUp||{totalDue:0,completed:0,overdueCount:0,completionRate:0,slaCompliance:0,chartData:null,projectData:null},K=te=>{const pe=typeof te=="string"?parseFloat(te):te;return typeof pe!="number"||isNaN(pe)||!isFinite(pe)||pe<0?0:Math.max(0,Math.min(100,pe))},ne=te=>te.map(pe=>{const V=typeof pe=="string"?parseFloat(pe):pe;return typeof V!="number"||isNaN(V)||!isFinite(V)?0:V}),se=[S?.channelEfficiency?.linkedin?.acceptanceRate,S?.channelEfficiency?.call?.connectRate,S?.channelEfficiency?.email?.replyRate].map(te=>K(te||0)),Ce={labels:["LinkedIn","Call","Email"],datasets:[{label:"Efficiency Rate (%)",data:ne(se),backgroundColor:["#3B82F6","#10B981","#F59E0B"],borderColor:["#2563EB","#059669","#D97706"],borderWidth:2}]},ge={labels:(S?.teamLeaderboard||[]).slice(0,10).map(te=>te?.name||"Unknown"),datasets:[{label:"Total Activities",data:(S?.teamLeaderboard||[]).slice(0,10).map(te=>{const pe=te?.totalActivities||0;return typeof pe=="number"&&isFinite(pe)?pe:0}),backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},Ne=[L?.validEmailPercent||0,L?.validPhonePercent||0,L?.duplicatePercent||0].map(te=>K(te)),J={labels:["Valid Email","Valid Phone","Duplicates"],datasets:[{data:ne(Ne),backgroundColor:["#10B981","#3B82F6","#EF4444"],borderWidth:2,borderColor:"#ffffff",hoverOffset:4}]},de={labels:["Requests Sent","Accepted","Messages Sent","Replies","Meetings"],datasets:[{label:"LinkedIn Funnel",data:[M?.connectionRequestsSent||0,M?.accepted||0,M?.messagesSent||0,M?.replies||0,M?.meetingsBooked||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#0077B5","#00A0DC","#008CC9","#006699","#004D73"],borderColor:["#005885","#0077B5","#006699","#004D73","#003D5C"],borderWidth:2}]},le={labels:["Accepted","Not Accepted"],datasets:[{label:"Connection Requests",data:[M?.accepted||0,Math.max(0,(M?.connectionRequestsSent||0)-(M?.accepted||0))].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#10B981","#EF4444"],borderWidth:2}]},ze={labels:["Calls Made","Connected","Decision Maker","Interested","Meetings"],datasets:[{label:"Cold Call Funnel",data:[F?.callsMade||0,F?.connected||0,F?.decisionMakerConnects||0,F?.interested||0,F?.meetingsBooked||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#3B82F6","#2563EB","#1D4ED8","#1E40AF","#1E3A8A"],borderColor:["#2563EB","#1D4ED8","#1E40AF","#1E3A8A","#1E3A8A"],borderWidth:2}]},me={labels:["Connected","Not Connected"],datasets:[{label:"Call Connections",data:[F?.connected||0,Math.max(0,(F?.callsMade||0)-(F?.connected||0))].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#10B981","#EF4444"],borderWidth:2}]},oe={labels:["Emails Sent","Replied","Positive Replies","Meetings"],datasets:[{label:"Email Funnel",data:[O?.emailsSent||0,O?.replied||0,O?.positiveReplies||0,O?.meetingsBooked||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#8B5CF6","#7C3AED","#6D28D9","#5B21B6"],borderColor:["#7C3AED","#6D28D9","#5B21B6","#4C1D95"],borderWidth:2}]},ce={labels:["Replied","Bounced","No Reply"],datasets:[{label:"Email Status",data:[O?.replied||0,O?.bounced||0,Math.max(0,(O?.emailsSent||0)-(O?.replied||0)-(O?.bounced||0))].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#10B981","#EF4444","#9CA3AF"],borderWidth:2,borderColor:"#ffffff"}]},ye={labels:["Touches","Meetings"],datasets:[{label:"This Week",data:[N?.totalTouchesThisWeek||0,N?.totalMeetingsBookedThisWeek||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:2},{label:"This Month",data:[N?.totalTouchesThisMonth||0,N?.totalMeetingsBookedThisMonth||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:"#10B981",borderColor:"#059669",borderWidth:2}]},ke={labels:["LinkedIn","Cold Call","Email"],datasets:[{label:"Activities by Channel",data:[M?.connectionRequestsSent||0,F?.callsMade||0,O?.emailsSent||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#0077B5","#3B82F6","#8B5CF6"],borderWidth:2,borderColor:"#ffffff",hoverOffset:4}]},fe={labels:["Conversion Rate","SLA Compliance"],datasets:[{label:"Performance Metrics (%)",data:[K(N?.weightedConversionRate||0),K(N?.slaCompliance||0)],backgroundColor:["#10B981","#3B82F6"],borderColor:["#059669","#2563EB"],borderWidth:2}]},Se={labels:["Leads in Play","Total Touches","Meetings Booked"],datasets:[{label:"Overall Funnel",data:[N?.totalLeadsInPlay||0,N?.totalTouchesThisMonth||0,N?.totalMeetingsBookedThisMonth||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#3B82F6","#8B5CF6","#10B981"],borderColor:["#2563EB","#7C3AED","#059669"],borderWidth:2}]},Ye=[{id:"executive",label:"Executive Summary"},{id:"rankings",label:"Rankings"},{id:"alerts",label:"Alerts"},{id:"data",label:"Data Quality"},{id:"linkedin",label:"LinkedIn"},{id:"calls",label:"Cold Calls"},{id:"email",label:"Email"},{id:"followup",label:"Follow-ups"}];return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-20 shadow-sm backdrop-blur-sm bg-white/95",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>window.history.back(),className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors",title:"Go Back",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Master Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"All Projects Summary & Analytics"})]})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium text-sm text-gray-700",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:Ye.map(te=>t.jsx("button",{onClick:()=>e(te.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${s===te.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:te.label},te.id))})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 relative z-0",children:[s==="executive"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Projects"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N?.activeProjects||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Active Projects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Leads"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(N?.totalLeadsInPlay||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Leads in Play"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full shadow-xs",children:"Activity"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(N?.totalTouchesThisWeek||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Touches This Week"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N?.totalMeetingsBookedThisWeek||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings This Week"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-blue-50 rounded-xl border border-indigo-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full shadow-xs",children:"Activity"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(N?.totalTouchesThisMonth||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Touches This Month"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-rose-50 to-pink-50 rounded-xl border border-rose-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-rose-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-rose-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-rose-700 bg-white/70 border border-rose-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N?.totalMeetingsBookedThisMonth||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings This Month"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-cyan-50 rounded-xl border border-teal-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full shadow-xs",children:"Conversion"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[K(N?.weightedConversionRate||0).toFixed(1),"%"]}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Weighted Conversion Rate"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl border border-orange-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-orange-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-orange-700 bg-white/70 border border-orange-100 px-2 py-1 rounded-full shadow-xs",children:"Compliance"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[K(N?.slaCompliance||0).toFixed(1),"%"]}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"SLA Compliance"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Week vs Month Performance"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:ye,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{position:"top",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:te=>{const pe=typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0;return`${te.dataset.label}: ${pe.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const pe=typeof te=="number"?te:parseFloat(te);return typeof pe=="number"&&isFinite(pe)?Math.round(pe):0},stepSize:1}},x:{grid:{display:!1}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Activity by Channel"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(qu,{data:ke,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:te=>{const pe=te.label||"",V=te.parsed||0,be=(M?.connectionRequestsSent||0)+(F?.callsMade||0)+(O?.emailsSent||0),_e=be>0?V/be*100:0;return`${pe}: ${V.toLocaleString()} (${_e.toFixed(1)}%)`}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Overall Sales Funnel"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:Se,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>{const pe=typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0;return`${te.label}: ${pe.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const pe=typeof te=="number"?te:parseFloat(te);return typeof pe=="number"&&isFinite(pe)?Math.round(pe):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Key Performance Metrics"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:fe,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>{const pe=K(te.parsed.y);return`${te.label}: ${pe.toFixed(2)}%`}}}},scales:{y:{beginAtZero:!0,max:100,min:0,ticks:{callback:te=>`${K(te)}%`,stepSize:20,maxTicksLimit:6},afterDataLimits:te=>{te.max=100,te.min=0}},x:{grid:{display:!1}}}}})})})]})]})]}),s==="rankings"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Best Performing Projects"}),t.jsx("div",{className:"space-y-3",children:(S?.bestPerformingProjects||[]).slice(0,10).map((te,pe)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${pe===0?"bg-yellow-100 text-yellow-800":pe===1?"bg-gray-100 text-gray-800":pe===2?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:pe+1}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:te.projectName}),t.jsxs("p",{className:"text-xs text-gray-500",children:[te.totalProspects," prospects"]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-semibold text-gray-900",children:te.meetingsPer100Leads.toFixed(1)}),t.jsx("p",{className:"text-xs text-gray-500",children:"meetings/100 leads"})]})]},pe))})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Channel Efficiency Leaderboard"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:Ce,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>`Efficiency: ${K(te.parsed.y).toFixed(2)}%`}}},scales:{y:{beginAtZero:!0,max:100,min:0,grace:0,ticks:{callback:te=>`${K(te)}%`,stepSize:20,maxTicksLimit:6,precision:0},afterDataLimits:te=>{te.max=100,te.min=0},afterBuildTicks:te=>{te.ticks=te.ticks.filter(pe=>{const V=typeof pe.value=="number"?pe.value:parseFloat(pe.value);return isFinite(V)&&V>=0&&V<=100})}},x:{grid:{display:!1}}}}})})}),t.jsxs("div",{className:"mt-4 space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg border border-blue-200",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"LinkedIn Acceptance"}),t.jsxs("span",{className:"font-bold text-lg text-blue-700",children:[K(S?.channelEfficiency?.linkedin?.acceptanceRate||0).toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-green-100 rounded-lg border border-green-200",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Call Connect Rate"}),t.jsxs("span",{className:"font-bold text-lg text-green-700",children:[K(S?.channelEfficiency?.call?.connectRate||0).toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-amber-50 to-amber-100 rounded-lg border border-amber-200",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Email Reply Rate"}),t.jsxs("span",{className:"font-bold text-lg text-amber-700",children:[K(S?.channelEfficiency?.email?.replyRate||0).toFixed(2),"%"]})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm lg:col-span-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Team Leaderboard"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:ge,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2.5,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>`Activities: ${typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0}`}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const pe=typeof te=="number"?te:parseFloat(te);return typeof pe=="number"&&isFinite(pe)?Math.round(pe):0},stepSize:1},afterBuildTicks:te=>{te.ticks=te.ticks.filter(pe=>{const V=typeof pe.value=="number"?pe.value:parseFloat(pe.value);return isFinite(V)&&V>=0})}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})}),t.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:(S?.teamLeaderboard||[]).slice(0,10).map((te,pe)=>t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900 text-sm",children:te.name||"Unknown"}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[te.totalActivities," activities"]}),t.jsxs("div",{className:"mt-2 flex gap-2 text-xs",children:[t.jsxs("span",{className:"text-blue-600",children:[te.calls," calls"]}),t.jsxs("span",{className:"text-green-600",children:[te.emails," emails"]}),t.jsxs("span",{className:"text-purple-600",children:[te.linkedin," LI"]})]})]},pe))})]})]})}),s==="alerts"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Low Activity (Last 3 Days)"}),t.jsx("div",{className:"space-y-2",children:(D?.lowActivityProjects||[]).length>0?(D?.lowActivityProjects||[]).map((te,pe)=>t.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900",children:te.projectName}),t.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[te.activityCount," activities / ",te.totalContacts," contacts"]})]},pe)):t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No low activity projects"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"High Bounce/Wrong Data"})]}),t.jsx("div",{className:"space-y-2",children:(D?.highBounceProjects||[]).length>0?(D?.highBounceProjects||[]).map((te,pe)=>t.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900",children:te.projectName}),t.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[te.errorRate.toFixed(1),"% error rate (",te.bounceCount," bounces, ",te.wrongPersonCount," wrong)"]})]},pe)):t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No high bounce projects"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Missing Follow-ups"}),t.jsx("div",{className:"space-y-2",children:(D?.missingFollowUps||[]).length>0?(D?.missingFollowUps||[]).map((te,pe)=>t.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900",children:te.projectName}),t.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[te.overdueCount," overdue follow-ups"]})]},pe)):t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No missing follow-ups"})})]})]})}),s==="data"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Daily"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:L?.leadsAddedDaily||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Leads Added (Daily)"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Weekly"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:L?.leadsAddedWeekly||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Leads Added (Weekly)"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Quality"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[K(L?.validEmailPercent||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(L?.validEmailCount||0).toLocaleString()," of ",(L?.totalProspects||0).toLocaleString()]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Quality"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[K(L?.validPhonePercent||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(L?.validPhoneCount||0).toLocaleString()," of ",(L?.totalProspects||0).toLocaleString()]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 rounded-xl border border-red-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full shadow-xs",children:"Duplicates"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[K(L?.duplicatePercent||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(L?.duplicateCount||0).toLocaleString()," duplicates"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Score"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[K(L?.dataQualityScore||0).toFixed(1),"%"]}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Data Quality Score"})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Data Quality Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx(qu,{data:J,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",layout:{padding:{top:20,bottom:20}},plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:te=>{const pe=te.label||"",V=K(te.parsed||0),be=Ne.reduce((De,W)=>De+K(W),0),_e=be>0?K(te.parsed||0)/be*100:0;return`${pe}: ${V.toFixed(2)}% (${_e.toFixed(1)}% of total)`}}}}}})})})]})]}),s==="linkedin"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"LinkedIn"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(M?.connectionRequestsSent||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Connection Requests Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[K(M?.acceptanceRate||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(M?.accepted||0).toLocaleString()," accepted"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Messages"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(M?.messagesSent||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Messages Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[K(M?.replyRate||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(M?.replies||0).toLocaleString()," replies"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:M?.meetingsBooked||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"LinkedIn Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:de,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>{const pe=typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0;return`${te.label}: ${pe.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const pe=typeof te=="number"?te:parseFloat(te);return typeof pe=="number"&&isFinite(pe)?Math.round(pe):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Connection Acceptance Rate"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(qu,{data:le,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:te=>{const pe=te.label||"",V=te.parsed||0,be=M?.connectionRequestsSent||0,_e=be>0?V/be*100:0;return`${pe}: ${V.toLocaleString()} (${_e.toFixed(1)}%)`}}}}}})})})]})]})]}),s==="calls"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Calls Made"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:(F?.callsMade||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Connect Rate"}),t.jsxs("p",{className:"text-4xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent",children:[K(F?.connectRate||0).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-medium",children:[(F?.connected||0).toLocaleString()," connected"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Decision Maker Connects"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:(F?.decisionMakerConnects||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 border-2 border-cyan-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Interested"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent",children:(F?.interested||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Meetings Booked"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent",children:F?.meetingsBooked||0})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Cold Call Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:ze,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>{const pe=typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0;return`${te.label}: ${pe.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const pe=typeof te=="number"?te:parseFloat(te);return typeof pe=="number"&&isFinite(pe)?Math.round(pe):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Call Connection Rate"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(qu,{data:me,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:te=>{const pe=te.label||"",V=te.parsed||0,be=F?.callsMade||0,_e=be>0?V/be*100:0;return`${pe}: ${V.toLocaleString()} (${_e.toFixed(1)}%)`}}}}}})})})]})]})]}),s==="email"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Emails Sent"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:(O?.emailsSent||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 border-2 border-red-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Bounce Rate"}),t.jsxs("p",{className:"text-4xl font-bold bg-gradient-to-r from-red-600 to-orange-600 bg-clip-text text-transparent",children:[K(O?.bounceRate||0).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-medium",children:[(O?.bounced||0).toLocaleString()," bounced"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Reply Rate"}),t.jsxs("p",{className:"text-4xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent",children:[K(O?.replyRate||0).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-medium",children:[(O?.replied||0).toLocaleString()," replied"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Positive Replies"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:(O?.positiveReplies||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Meetings Booked"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent",children:O?.meetingsBooked||0})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:oe,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>{const pe=typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0;return`${te.label}: ${pe.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const pe=typeof te=="number"?te:parseFloat(te);return typeof pe=="number"&&isFinite(pe)?Math.round(pe):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Status Breakdown"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(qu,{data:ce,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:te=>{const pe=te.label||"",V=te.parsed||0,be=O?.emailsSent||0,_e=be>0?V/be*100:0;return`${pe}: ${V.toLocaleString()} (${_e.toFixed(1)}%)`}}}}}})})})]})]})]}),s==="followup"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Total Due"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(P?.totalDue||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Completed"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(P?.completed||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Overdue Count"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(P?.overdueCount||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Completion Rate"}),t.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[(P?.completionRate||0).toFixed(2),"%"]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"SLA Compliance"}),t.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[(P?.slaCompliance||0).toFixed(2),"%"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-up Status Distribution"}),P?.totalDue>0?t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(qu,{data:{labels:["Completed","Overdue","Pending"],datasets:[{label:"Follow-ups",data:[P.completed||0,P.overdueCount||0,(P.totalDue||0)-(P.completed||0)-(P.overdueCount||0)],backgroundColor:["#10B981","#EF4444","#F59E0B"],borderColor:["#059669","#DC2626","#D97706"],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12}}},tooltip:{callbacks:{label:function(te){const pe=te.label||"",V=te.parsed||0,be=te.dataset.data.reduce((De,W)=>De+W,0),_e=be>0?(V/be*100).toFixed(1):0;return`${pe}: ${V} (${_e}%)`}}}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:"No follow-up data available"})]}),P?.projectData&&P.projectData.labels.length>0?t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-ups by Project (Top 10)"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:{labels:P.projectData.labels,datasets:[{label:"Completed",data:P.projectData.completed,backgroundColor:"#10B981",borderColor:"#059669",borderWidth:1},{label:"Overdue",data:P.projectData.overdue,backgroundColor:"#EF4444",borderColor:"#DC2626",borderWidth:1},{label:"Pending",data:P.projectData.total.map((te,pe)=>te-P.projectData.completed[pe]-P.projectData.overdue[pe]),backgroundColor:"#F59E0B",borderColor:"#D97706",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:10,font:{size:12}}},tooltip:{mode:"index",intersect:!1}},scales:{x:{stacked:!0,ticks:{maxRotation:45,minRotation:45,font:{size:10}}},y:{stacked:!0,beginAtZero:!0,ticks:{stepSize:1}}}}})})})]}):t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-ups by Project"}),t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:"No project data available"})]}),P?.chartData&&P.chartData.labels.length>0?t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm lg:col-span-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-up Trends Over Time"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(dC,{data:{labels:P.chartData.labels,datasets:[{label:"Total Due",data:P.chartData.total,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!0,tension:.4},{label:"Completed",data:P.chartData.completed,borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:2,fill:!0,tension:.4},{label:"Overdue",data:P.chartData.overdue,borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderWidth:2,fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12}}},tooltip:{mode:"index",intersect:!1}},scales:{x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}},y:{beginAtZero:!0,ticks:{stepSize:1}}}}})})})]}):t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm lg:col-span-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-up Trends Over Time"}),t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:"No trend data available"})]})]})]})]})]})}const O1=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Bar})));B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Line})));const P1=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Doughnut}))),fC=B.lazy(()=>_a(()=>Promise.resolve().then(()=>Fa),void 0).then(l=>({default:l.Pie})));cl.register(Vc,Wc,Ic,dl,Bc,ym,Uc,Hc,zc,Ip);const Mb={},mC=60*1e3;function gC(){const l=Dr(),[n,a]=B.useState(!0),[o,s]=B.useState(null),[e,m]=B.useState(null),[v,w]=B.useState("overview"),[N,S]=B.useState("last7days");B.useEffect(()=>{(async()=>{const ne=Mb[N||"all"];if(ne&&Date.now()-ne.timestamp<mC){const se=ne.data;s(se),se.employees.length>0&&!e&&m(se.employees[0].userId),a(!1)}else await D()})()},[N]);const D=async()=>{try{a(!0);const P=await Ut.get("/projects/employee-performance",{params:{timeFilter:N}});if(P.data.success){const K=P.data.data;s(K),Mb[N||"all"]={data:K,timestamp:Date.now()},K.employees.length>0&&!e&&m(K.employees[0].userId)}}catch(P){console.error("Error fetching employee performance:",P)}finally{a(!1)}},L=B.useMemo(()=>!o||!e?null:o.employees.find(P=>P.userId===e)||o.employees[0],[o,e]),M=B.useMemo(()=>o?{channelDistribution:{labels:["Email","Call","LinkedIn"],datasets:[{label:"Activities by Channel",data:[o.summary.byChannel.email,o.summary.byChannel.call,o.summary.byChannel.linkedin],backgroundColor:["#3B82F6","#10B981","#8B5CF6"],borderWidth:2,borderColor:"#ffffff"}]},employeeComparison:{labels:o.employees.map(P=>P.name),datasets:[{label:"Email",data:o.employees.map(P=>P.byChannel.email.total),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"#3B82F6",borderWidth:1},{label:"Call",data:o.employees.map(P=>P.byChannel.call.total),backgroundColor:"rgba(16, 185, 129, 0.8)",borderColor:"#10B981",borderWidth:1},{label:"LinkedIn",data:o.employees.map(P=>P.byChannel.linkedin.total),backgroundColor:"rgba(139, 92, 246, 0.8)",borderColor:"#8B5CF6",borderWidth:1}]},topPerformers:o.employees.sort((P,K)=>K.totalActivities-P.totalActivities).slice(0,5)}:null,[o]),F=B.useMemo(()=>{if(!L)return null;const P=Object.keys(L.byChannel.email.byStatus||{}),K=Object.keys(L.byChannel.call.byStatus||{}),ne=Object.keys(L.byChannel.linkedin.byStatus||{});return{channelDistribution:{labels:["Email","Call","LinkedIn"],datasets:[{label:"Activities",data:[L.byChannel.email.total,L.byChannel.call.total,L.byChannel.linkedin.total],backgroundColor:["#3B82F6","#10B981","#8B5CF6"],borderWidth:2,borderColor:"#ffffff"}]},emailStatus:{labels:P.length>0?P:["No Status"],datasets:[{label:"Email Status",data:P.length>0?P.map(se=>L.byChannel.email.byStatus[se]):[0],backgroundColor:["#3B82F6","#60A5FA","#93C5FD","#DBEAFE","#EFF6FF"],borderWidth:2,borderColor:"#ffffff"}]},callStatus:{labels:K.length>0?K:["No Status"],datasets:[{label:"Call Status",data:K.length>0?K.map(se=>L.byChannel.call.byStatus[se]):[0],backgroundColor:["#10B981","#34D399","#6EE7B7","#A7F3D0","#D1FAE5"],borderWidth:2,borderColor:"#ffffff"}]},linkedinStatus:{labels:ne.length>0?ne:["No Status"],datasets:[{label:"LinkedIn Status",data:ne.length>0?ne.map(se=>L.byChannel.linkedin.byStatus[se]):[0],backgroundColor:["#8B5CF6","#A78BFA","#C4B5FD","#DDD6FE","#EDE9FE"],borderWidth:2,borderColor:"#ffffff"}]},projectPerformance:{labels:L.byProject.map(se=>se.projectName),datasets:[{label:"Email",data:L.byProject.map(se=>se.email),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"#3B82F6",borderWidth:1},{label:"Call",data:L.byProject.map(se=>se.call),backgroundColor:"rgba(16, 185, 129, 0.8)",borderColor:"#10B981",borderWidth:1},{label:"LinkedIn",data:L.byProject.map(se=>se.linkedin),backgroundColor:"rgba(139, 92, 246, 0.8)",borderColor:"#8B5CF6",borderWidth:1}]}}},[L]);if(n)return t.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-gray-200 border-t-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Loading performance data..."})]})});if(!o||!o.employees||o.employees.length===0)return t.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm p-8 text-center",children:[t.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Employee Data Available"}),t.jsx("p",{className:"text-gray-600",children:"There are no employees with performance data for the selected time period."})]})})});const O={today:"Today",last7days:"Last 7 Days",lastMonth:"Last Month"};return t.jsx("div",{className:"bg-gray-50 min-h-screen",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Employee Performance"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Comprehensive analytics and insights for team performance tracking"})]}),t.jsx("div",{className:"flex items-center gap-2 bg-white rounded-lg border border-gray-200 p-1 shadow-sm",children:["today","last7days","lastMonth"].map(P=>t.jsx("button",{onClick:()=>S(P),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${N===P?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-50"}`,children:O[P]},P))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Total Employees"}),t.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalEmployees})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-green-700",children:"Total Activities"}),t.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalActivities.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Total Projects"}),t.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalProjects})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 border border-amber-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-amber-700",children:"Avg per Employee"}),t.jsx("div",{className:"w-10 h-10 bg-amber-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalEmployees>0?Math.round(o.summary.totalActivities/o.summary.totalEmployees):0})]})]})]}),t.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm mb-6",children:t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"flex -mb-px",children:[t.jsx("button",{onClick:()=>w("overview"),className:`px-6 py-4 text-sm font-semibold border-b-2 transition-colors ${v==="overview"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:"Overview"}),t.jsx("button",{onClick:()=>w("employee"),className:`px-6 py-4 text-sm font-semibold border-b-2 transition-colors ${v==="employee"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:"Employee Details"})]})})}),v==="overview"&&M&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Email Activities"}),t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:o.summary.byChannel.email.toLocaleString()}),t.jsxs("div",{className:"text-xs text-gray-500",children:[(o.summary.byChannel.email/o.summary.totalActivities*100).toFixed(1),"% of total"]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Call Activities"}),t.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:o.summary.byChannel.call.toLocaleString()}),t.jsxs("div",{className:"text-xs text-gray-500",children:[(o.summary.byChannel.call/o.summary.totalActivities*100).toFixed(1),"% of total"]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"LinkedIn Activities"}),t.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:o.summary.byChannel.linkedin.toLocaleString()}),t.jsxs("div",{className:"text-xs text-gray-500",children:[(o.summary.byChannel.linkedin/o.summary.totalActivities*100).toFixed(1),"% of total"]})]})]}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Employee Activity Comparison"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(O1,{data:M.employeeComparison,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{padding:10,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12}},scales:{y:{beginAtZero:!0,ticks:{font:{size:11}},grid:{color:"rgba(0, 0, 0, 0.05)"}},x:{ticks:{font:{size:11}},grid:{display:!1}}}}})})})]})}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Performers"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Ranked by total activities"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Rank"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Employee"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Total Activities"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Call"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"LinkedIn"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Projects"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.topPerformers.map((P,K)=>t.jsxs("tr",{className:K<3?"bg-gradient-to-r from-amber-50 to-yellow-50":"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"flex items-center",children:K<3?t.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-amber-500 text-white font-bold text-sm",children:K+1}):t.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["#",K+1]})})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:P.name}),t.jsx("div",{className:"text-sm text-gray-500",children:P.email})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:P.totalActivities.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-blue-600",children:P.byChannel.email.total.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-green-600",children:P.byChannel.call.total.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-purple-600",children:P.byChannel.linkedin.total.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-gray-900",children:P.projects.length})})]},P.userId))})]})})]})]}),v==="employee"&&L&&F&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Select Employee"}),t.jsx("select",{value:e,onChange:P=>m(P.target.value),className:"w-full md:w-80 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm font-medium",children:o.employees.map(P=>t.jsxs("option",{value:P.userId,children:[P.name," (",P.email,")"]},P.userId))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-blue-700 mb-2",children:"Total Activities"}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:L.totalActivities.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-blue-700 mb-2",children:"Email Activities"}),t.jsx("div",{className:"text-3xl font-bold text-blue-600",children:L.byChannel.email.total.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-green-700 mb-2",children:"Call Activities"}),t.jsx("div",{className:"text-3xl font-bold text-green-600",children:L.byChannel.call.total.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-purple-700 mb-2",children:"LinkedIn Activities"}),t.jsx("div",{className:"text-3xl font-bold text-purple-600",children:L.byChannel.linkedin.total.toLocaleString()})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Channel Distribution"}),t.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-4 text-center",children:[t.jsx("div",{className:"text-xs font-medium text-blue-700 mb-1",children:"Email"}),t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:L.byChannel.email.total.toLocaleString()}),t.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[L.totalActivities>0?(L.byChannel.email.total/L.totalActivities*100).toFixed(1):0,"%"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-lg p-4 text-center",children:[t.jsx("div",{className:"text-xs font-medium text-green-700 mb-1",children:"Call"}),t.jsx("div",{className:"text-2xl font-bold text-green-600",children:L.byChannel.call.total.toLocaleString()}),t.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[L.totalActivities>0?(L.byChannel.call.total/L.totalActivities*100).toFixed(1):0,"%"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-lg p-4 text-center",children:[t.jsx("div",{className:"text-xs font-medium text-purple-700 mb-1",children:"LinkedIn"}),t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:L.byChannel.linkedin.total.toLocaleString()}),t.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:[L.totalActivities>0?(L.byChannel.linkedin.total/L.totalActivities*100).toFixed(1):0,"%"]})]})]}),t.jsx("div",{className:"mb-6",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(O1,{data:{labels:["Email","Call","LinkedIn"],datasets:[{label:"Activities",data:[L.byChannel.email.total,L.byChannel.call.total,L.byChannel.linkedin.total],backgroundColor:["#3B82F6","#10B981","#8B5CF6"],borderRadius:8,borderSkipped:!1}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,callbacks:{label:function(P){const K=L.totalActivities,ne=P.parsed.x,se=K>0?(ne/K*100).toFixed(1):0;return`${ne.toLocaleString()} activities (${se}%)`}}}},scales:{x:{beginAtZero:!0,ticks:{callback:function(P){return P.toLocaleString()}},grid:{color:"rgba(0, 0, 0, 0.05)"}},y:{grid:{display:!1}}}}})})})}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(fC,{data:F.channelDistribution,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,callbacks:{label:function(P){const K=L.totalActivities,ne=P.parsed,se=K>0?(ne/K*100).toFixed(1):0;return`${P.label}: ${ne.toLocaleString()} (${se}%)`}}}}}})})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Email Status"}),t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(P1,{data:F.emailStatus,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:8,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:10}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Call Status"}),t.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(P1,{data:F.callStatus,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:8,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:10}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"LinkedIn Status"}),t.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})})]}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(P1,{data:F.linkedinStatus,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:8,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:10}}}})})})]})]}),L.byProject.length>0&&t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Activity by Project"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(O1,{data:F.projectPerformance,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{padding:10,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12}},scales:{y:{beginAtZero:!0,ticks:{font:{size:11}},grid:{color:"rgba(0, 0, 0, 0.05)"}},x:{ticks:{font:{size:11}},grid:{display:!1}}}}})})})]}),L.projects.length>0&&t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Assigned Projects"})}),t.jsx("div",{className:"divide-y divide-gray-200",children:L.projects.map(P=>t.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>l(`/projects/${P.id}`),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-gray-900",children:P.companyName}),t.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[P.isCreator&&t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-blue-100 text-blue-800 text-xs font-medium mr-2",children:"Creator"}),P.isTeamMember&&t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-green-100 text-green-800 text-xs font-medium",children:"Team Member"})]})]}),t.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},P.id))})]})]})]})})}function pC(){const{id:l}=di(),n=Dr(),a=e=>{n(e==="linkedin"?`/projects/${l}/linkedin-funnel`:e==="cold-calling"?`/projects/${l}/cold-calling-funnel`:e==="email"?`/projects/${l}/email-funnel`:`/projects/${l}?funnel=${e}`)},o=[{id:"cold-calling",title:"Cold Calling",description:"Manage phone outreach and call activities",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),color:"green",accentColor:"emerald"},{id:"email",title:"Email",description:"Track email campaigns and responses",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),color:"blue",accentColor:"blue"},{id:"linkedin",title:"LinkedIn",description:"Manage LinkedIn connections and messages",icon:t.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),color:"indigo",accentColor:"indigo"}],s=(e,m)=>{const v={green:{bg:"bg-emerald-50",border:"border-emerald-200",hoverBorder:"hover:border-emerald-300",iconBg:"bg-emerald-100",iconColor:"text-emerald-600",title:"text-gray-900",description:"text-gray-600",hoverBg:"hover:bg-emerald-50",hoverShadow:"hover:shadow-lg"},blue:{bg:"bg-blue-50",border:"border-blue-200",hoverBorder:"hover:border-blue-300",iconBg:"bg-blue-100",iconColor:"text-blue-600",title:"text-gray-900",description:"text-gray-600",hoverBg:"hover:bg-blue-50",hoverShadow:"hover:shadow-lg"},indigo:{bg:"bg-indigo-50",border:"border-indigo-200",hoverBorder:"hover:border-indigo-300",iconBg:"bg-indigo-100",iconColor:"text-indigo-600",title:"text-gray-900",description:"text-gray-600",hoverBg:"hover:bg-indigo-50",hoverShadow:"hover:shadow-lg"}};return v[e]||v.blue};return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-12",children:[t.jsxs("div",{className:"mb-12",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 mb-8 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("h1",{className:"text-3xl font-semibold text-gray-900 tracking-tight mb-3",children:"Sales Report"}),t.jsx("div",{className:"w-16 h-0.5 bg-gradient-to-r from-emerald-500 via-blue-500 to-indigo-500 rounded-full"})]}),t.jsx("p",{className:"text-base text-gray-600 mt-4",children:"Select a channel to view and manage prospects"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl",children:o.map(e=>{const m=s(e.color,e.accentColor);return t.jsxs("button",{onClick:()=>a(e.id),className:`group relative bg-white border-2 ${m.border} ${m.hoverBorder} rounded-xl p-8 text-left transition-all duration-200 ${m.hoverBg} ${m.hoverShadow} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-${e.accentColor}-500`,children:[t.jsx("div",{className:`w-14 h-14 ${m.iconBg} rounded-lg flex items-center justify-center mb-5 ${m.iconColor} transition-colors duration-200`,children:e.icon}),t.jsxs("div",{children:[t.jsx("h3",{className:`text-xl font-semibold ${m.title} mb-2`,children:e.title}),t.jsx("p",{className:`text-sm ${m.description} leading-relaxed`,children:e.description})]}),t.jsx("div",{className:"absolute bottom-6 right-6 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:t.jsx("svg",{className:`w-5 h-5 ${m.iconColor}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]},e.id)})})]})})}const kv="label";function Lb(l,n){typeof l=="function"?l(n):l&&(l.current=n)}function xC(l,n){const a=l.options;a&&n&&Object.assign(a,n)}function Cv(l,n){l.labels=n}function Sv(l,n,a=kv){const o=[];l.datasets=n.map(s=>{const e=l.datasets.find(m=>m[a]===s[a]);return!e||!s.data||o.includes(e)?{...s}:(o.push(e),Object.assign(e,s),e)})}function bC(l,n=kv){const a={labels:[],datasets:[]};return Cv(a,l.labels),Sv(a,l.datasets,n),a}function yC(l,n){return l.getElementsAtEventForMode(n.nativeEvent,"dataset",{intersect:!0},!1)}function vC(l,n){return l.getElementsAtEventForMode(n.nativeEvent,"nearest",{intersect:!0},!1)}function wC(l,n){return l.getElementsAtEventForMode(n.nativeEvent,"index",{intersect:!0},!1)}function jC(l,n){const{height:a=150,width:o=300,redraw:s=!1,datasetIdKey:e,type:m,data:v,options:w,plugins:N=[],fallbackContent:S,updateMode:D,...L}=l,M=B.useRef(null),F=B.useRef(null),O=()=>{M.current&&(F.current=new cl(M.current,{type:m,data:bC(v,e),options:w&&{...w},plugins:N}),Lb(n,F.current))},P=()=>{Lb(n,null),F.current&&(F.current.destroy(),F.current=null)};return B.useEffect(()=>{!s&&F.current&&w&&xC(F.current,w)},[s,w]),B.useEffect(()=>{!s&&F.current&&Cv(F.current.config.data,v.labels)},[s,v.labels]),B.useEffect(()=>{!s&&F.current&&v.datasets&&Sv(F.current.config.data,v.datasets,e)},[s,v.datasets]),B.useEffect(()=>{F.current&&(s?(P(),setTimeout(O)):F.current.update(D))},[s,w,v.labels,v.datasets,D]),B.useEffect(()=>{F.current&&(P(),setTimeout(O))},[m]),B.useEffect(()=>(O(),()=>P()),[]),t.jsx("canvas",{ref:M,role:"img",height:a,width:o,...L,children:S})}const Av=B.forwardRef(jC);function $c(l,n){return cl.register(n),B.forwardRef((a,o)=>t.jsx(Av,{...a,ref:o,type:l}))}const a0=$c("line",b6),n0=$c("bar",g6),NC=$c("radar",w6),kC=$c("doughnut",nv),CC=$c("polarArea",y6),SC=$c("bubble",p6),AC=$c("pie",v6),EC=$c("scatter",j6),Fa=Object.freeze(Object.defineProperty({__proto__:null,Bar:n0,Bubble:SC,Chart:Av,Doughnut:kC,Line:a0,Pie:AC,PolarArea:CC,Radar:NC,Scatter:EC,getDatasetAtEvent:yC,getElementAtEvent:vC,getElementsAtEvent:wC},Symbol.toStringTag,{value:"Module"}));cl.register(Vc,Wc,Ic,dl,Bc,Uc,Hc,zc,Ip);function DC(){const{id:l}=di(),n=Dr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({}),[L,M]=B.useState(null),[F,O]=B.useState("month");B.useEffect(()=>{l&&P()},[l]),B.useEffect(()=>{const me=()=>{l&&!w&&P()};return window.addEventListener("focus",me),()=>window.removeEventListener("focus",me)},[l,w]);const P=async()=>{try{N(!0);const me=await Ut.get(`/projects/${l}`);me.data.success&&o(me.data.data);const oe=await Ut.get(`/activities/project/${l}?limit=10000`);if(oe.data.success){const ke=(oe.data.data||[]).filter(fe=>fe.type==="linkedin");e(ke)}const ce=await Ut.get(`/projects/${l}/project-contacts`);ce.data.success&&v(ce.data.data||[]),M(new Date)}catch(me){console.error("Error fetching data:",me)}finally{N(!1)}};B.useEffect(()=>{(s.length>0||m.length>0)&&ge()},[s,m,F]);const K=me=>{const oe=new Date(me),ce=oe.toLocaleString("default",{month:"short"}),ye=oe.getFullYear().toString().slice(-2);return`${ce} '${ye}`},ne=me=>new Date(me).getFullYear().toString(),se=()=>{const me=new Set;return s.forEach(ce=>{ce.createdAt&&me.add(K(ce.createdAt))}),m.forEach(ce=>{ce.createdAt&&me.add(K(ce.createdAt))}),me.add(K(new Date)),Array.from(me).sort((ce,ye)=>{const[ke,fe]=ce.split(" '"),[Se,Ye]=ye.split(" '"),te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pe=te.indexOf(ke),V=te.indexOf(Se);return fe!==Ye?parseInt(fe)-parseInt(Ye):pe-V})},Ce=()=>{const me=new Set;return s.forEach(oe=>{oe.createdAt&&me.add(ne(oe.createdAt))}),m.forEach(oe=>{oe.createdAt&&me.add(ne(oe.createdAt))}),me.add(ne(new Date)),Array.from(me).sort((oe,ce)=>parseInt(oe)-parseInt(ce))},ge=()=>{const me=F==="month"?se():Ce(),oe={};me.forEach(fe=>{oe[fe]={dataResearch:0,connectionRequestSent:0,connectionAccepted:0,firstMessageSent:0,followupMessagesSent:0,existingConnection:0,conversationsInProgress:0,meetingProposed:0,meetingScheduled:0,meetingCompleted:0}}),m.forEach(fe=>{if(fe.createdAt){const Se=F==="month"?K(fe.createdAt):ne(fe.createdAt);oe[Se]&&oe[Se].dataResearch++}});const ce={};s.forEach(fe=>{if(!fe.createdAt)return;const Se=fe.contactId?.toString()||"unknown";ce[Se]||(ce[Se]=[]),ce[Se].push(fe)}),s.forEach(fe=>{const Se=fe.linkedinDate?new Date(fe.linkedinDate):fe.createdAt?new Date(fe.createdAt):null;if(!Se)return;const Ye=F==="month"?K(Se):ne(Se);if(!oe[Ye])return;const te=fe.template?.trim()||"";(fe.lnRequestSent==="Yes"||te==="introduction-message")&&oe[Ye].connectionRequestSent++,fe.lnRequestSent==="Existing Connect"&&oe[Ye].existingConnection++,fe.connected==="Yes"&&oe[Ye].connectionAccepted++,fe.status==="CIP"?oe[Ye].conversationsInProgress++:fe.status==="Meeting Proposed"?oe[Ye].meetingProposed++:fe.status==="Meeting Scheduled"?oe[Ye].meetingScheduled++:fe.status==="Meeting Completed"&&oe[Ye].meetingCompleted++});const ye={},ke={};s.forEach(fe=>{const Se=fe.linkedinDate?new Date(fe.linkedinDate):fe.createdAt?new Date(fe.createdAt):null;if(!Se)return;const Ye=F==="month"?K(Se):ne(Se);if(!oe[Ye])return;ye[Ye]||(ye[Ye]=new Set),ke[Ye]||(ke[Ye]=new Set);const te=fe.contactId?.toString()||"unknown",pe=fe.template?.trim()||"";pe==="introduction-message"&&ye[Ye].add(te),pe==="follow-up-message"&&ke[Ye].add(te)}),Object.keys(oe).forEach(fe=>{ye[fe]&&(oe[fe].firstMessageSent=ye[fe].size),ke[fe]&&(oe[fe].followupMessagesSent=ke[fe].size)}),D(oe)},Ne=[{key:"dataResearch",label:"Data Research manually",section:"DRA"},{key:"connectionRequestSent",label:"Connection Request Sent",section:"DRA"},{key:"connectionAccepted",label:"Connection Accepted",section:"DRA"},{key:"firstMessageSent",label:"First Message Sent",section:"DRA"},{key:"followupMessagesSent",label:"Followup Messages sent",section:"DRA"},{key:"existingConnection",label:"Existing Connection",section:"Linked IN"},{key:"conversationsInProgress",label:"Conversations in Progress",section:"Linked IN",highlight:!0},{key:"meetingProposed",label:"Meeting Proposed",section:"Linked IN",highlight:!0},{key:"meetingScheduled",label:"Meeting Scheduled",section:"Linked IN",highlight:!0},{key:"meetingCompleted",label:"Meeting Completed",section:"Linked IN",highlight:!0}],J=F==="month"?se():Ce(),de=B.useMemo(()=>{const me=J;return{connectionFunnel:{labels:me,datasets:[{label:"Connection Request Sent",data:me.map(oe=>S[oe]?.connectionRequestSent||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0},{label:"Connection Accepted",data:me.map(oe=>S[oe]?.connectionAccepted||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0}]},messageActivity:{labels:me,datasets:[{label:"First Message Sent",data:me.map(oe=>S[oe]?.firstMessageSent||0),borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4,fill:!0},{label:"Followup Messages",data:me.map(oe=>S[oe]?.followupMessagesSent||0),borderColor:"rgb(236, 72, 153)",backgroundColor:"rgba(236, 72, 153, 0.1)",tension:.4,fill:!0}]},meetingPipeline:{labels:me,datasets:[{label:"Meeting Proposed",data:me.map(oe=>S[oe]?.meetingProposed||0),backgroundColor:"rgba(251, 191, 36, 0.8)"},{label:"Meeting Scheduled",data:me.map(oe=>S[oe]?.meetingScheduled||0),backgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Meeting Completed",data:me.map(oe=>S[oe]?.meetingCompleted||0),backgroundColor:"rgba(34, 197, 94, 0.8)"}]},conversationsStatus:{labels:me,datasets:[{label:"Conversations in Progress",data:me.map(oe=>S[oe]?.conversationsInProgress||0),backgroundColor:"rgba(34, 197, 94, 0.8)"}]}}},[J,S]),le={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"600"},bodyFont:{size:13},cornerRadius:8,displayColors:!0}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}},x:{grid:{display:!1},ticks:{font:{size:11}}}}},ze={...le,scales:{...le.scales,x:{...le.scales.x,stacked:!0},y:{...le.scales.y,stacked:!0}}};return w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading report..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}/funnel`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Sales Report"]}),t.jsxs("button",{onClick:P,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh data",children:[t.jsx("svg",{className:`w-4 h-4 ${w?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:[F==="month"?"Monthly":"Yearly"," Report - ",a?.companyName||"Project"]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[L&&t.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",L.toLocaleTimeString()]}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>O("month"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Monthly"}),t.jsx("button",{onClick:()=>O("year"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="year"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Yearly"})]})]})]})})]}),J.length>0&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Connection Funnel"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:de.connectionFunnel,options:le})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Message Activity"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:de.messageActivity,options:le})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Meeting Pipeline"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:de.meetingPipeline,options:ze})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conversations in Progress"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:de.conversationsStatus,options:le})})]})]}),t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200",children:"Key Results"}),J.map(me=>t.jsxs("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200 last:border-r-0",children:[t.jsx("div",{children:me}),t.jsx("div",{className:"text-xs font-normal text-gray-500 mt-1",children:"Progress"})]},me))]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:["DRA","Linked IN"].map(me=>t.jsx(Mo.Fragment,{children:Ne.filter(oe=>oe.section===me).map((oe,ce)=>t.jsxs("tr",{className:oe.highlight?"bg-green-50":"hover:bg-gray-50",children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border-r border-gray-200 ${oe.highlight?"font-semibold":""}`,children:oe.label}),J.map(ye=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${oe.highlight?"font-semibold text-gray-900":"text-gray-700"}`,children:S[ye]?.[oe.key]||0},ye))]},oe.key))},me))})]})})})]})})}cl.register(Vc,Wc,Ic,dl,Bc,Uc,Hc,zc,Ip);function TC(){const{id:l}=di(),n=Dr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({}),[L,M]=B.useState(null),[F,O]=B.useState("day");B.useEffect(()=>{l&&P()},[l]),B.useEffect(()=>{const ce=()=>{l&&!w&&P()};return window.addEventListener("focus",ce),()=>window.removeEventListener("focus",ce)},[l,w]);const P=async()=>{try{N(!0);const ce=await Ut.get(`/projects/${l}`);ce.data.success&&o(ce.data.data);const ye=await Ut.get(`/activities/project/${l}?limit=10000`);if(ye.data.success){const Se=(ye.data.data||[]).filter(Ye=>Ye.type==="call");e(Se)}const ke=await Ut.get(`/projects/${l}/project-contacts`);ke.data.success&&v(ke.data.data||[]),M(new Date)}catch(ce){console.error("Error fetching data:",ce)}finally{N(!1)}};B.useEffect(()=>{(s.length>0||m.length>0)&&ge()},[s,m,F]);const K=ce=>{const ye=new Date(ce),ke=ye.getDate(),fe=ye.toLocaleString("default",{month:"short"}),Se=ye.getFullYear().toString().slice(-2);return`${ke} ${fe} '${Se}`},ne=ce=>{const ye=new Date(ce),ke=ye.toLocaleString("default",{month:"short"}),fe=ye.getFullYear().toString().slice(-2);return`${ke} '${fe}`},se=()=>{const ce=new Set;return s.forEach(ke=>{const fe=ke.callDate?new Date(ke.callDate):new Date(ke.createdAt);fe&&ce.add(K(fe))}),m.forEach(ke=>{ke.createdAt&&ce.add(K(new Date(ke.createdAt)))}),Array.from(ce).sort((ke,fe)=>{const Se=new Date(ke.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3")),Ye=new Date(fe.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3"));return Se-Ye})},Ce=()=>{const ce=new Set;return s.forEach(ke=>{const fe=ke.callDate?new Date(ke.callDate):new Date(ke.createdAt);fe&&ce.add(ne(fe))}),m.forEach(ke=>{ke.createdAt&&ce.add(ne(new Date(ke.createdAt)))}),Array.from(ce).sort((ke,fe)=>{const[Se,Ye]=ke.split(" '"),[te,pe]=fe.split(" '"),V=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],be=V.indexOf(Se),_e=V.indexOf(te);return Ye!==pe?parseInt(Ye)-parseInt(pe):be-_e})},ge=()=>{const ce=F==="day"?se():Ce(),ye={};ce.forEach(Se=>{ye[Se]={dataAllocated:0,interested:0,notInterested:0,ring:0,busy:0,hangUp:0,callBack:0,switchOff:0,detailsShared:0,future:0,invalid:0,demoBooked:0,followUps:0,totalCalls:0,freshCalls:0}}),m.forEach(Se=>{if(Se.createdAt){const Ye=F==="day"?K(new Date(Se.createdAt)):ne(new Date(Se.createdAt));ye[Ye]&&ye[Ye].dataAllocated++}});const ke=new Map,fe={};s.forEach(Se=>{const Ye=Se.callDate?new Date(Se.callDate):new Date(Se.createdAt);if(!Ye)return;const te=F==="day"?K(Ye):ne(Ye);if(!ye[te])return;const pe=Se.contactId?.toString()||"unknown";Se.callNumber==="1st call"&&!ke.has(pe)&&ke.set(pe,te),fe[te]||(fe[te]={}),fe[te][pe]||(fe[te][pe]=[]),fe[te][pe].push(Se)}),s.forEach(Se=>{const Ye=Se.callDate?new Date(Se.callDate):new Date(Se.createdAt);if(!Ye)return;const te=F==="day"?K(Ye):ne(Ye);if(ye[te]){if(Se.callStatus)switch(Se.callStatus){case"Interested":ye[te].interested++;break;case"Not Interested":ye[te].notInterested++;break;case"Ring":ye[te].ring++;break;case"Busy":ye[te].busy++;break;case"Hang Up":ye[te].hangUp++;break;case"Call Back":ye[te].callBack++;break;case"Switch Off":ye[te].switchOff++;break;case"Details Shared":ye[te].detailsShared++;break;case"Future":ye[te].future++;break;case"Invalid":ye[te].invalid++;break;case"Demo Booked":ye[te].demoBooked++;break}ye[te].totalCalls++}}),Object.keys(fe).forEach(Se=>{const Ye=fe[Se];let te=0,pe=0;Object.keys(Ye).forEach(V=>{const be=Ye[V],_e=ke.get(V);be.forEach(De=>{De.callNumber==="1st call"||_e===Se&&!De.callNumber?te++:pe++})}),ye[Se]&&(ye[Se].freshCalls=te,ye[Se].followUps=pe)}),D(ye)},Ne=[{key:"dataAllocated",label:"Data Allocated",section:"DRA",bold:!1},{key:"interested",label:"Interested",section:"DRA",bold:!0},{key:"notInterested",label:"Not Interested",section:"DRA",bold:!0},{key:"ring",label:"Ring",section:"DRA",bold:!1},{key:"busy",label:"Busy",section:"DRA",bold:!1,highlight:!0},{key:"hangUp",label:"Hang Up",section:"DRA",bold:!1},{key:"callBack",label:"Call Back",section:"DRA",bold:!1},{key:"switchOff",label:"Switch Off",section:"DRA",bold:!1},{key:"detailsShared",label:"Detailed Shared",section:"Cold Calling",bold:!0,highlight:!0},{key:"future",label:"Future",section:"Cold Calling",bold:!1},{key:"invalid",label:"Invalid",section:"Cold Calling",bold:!1},{key:"demoBooked",label:"Demo Booked",section:"Cold Calling",bold:!0,highlight:!0,highlightDark:!0},{key:"followUps",label:"Follow Ups",section:"Cold Calling",bold:!0},{key:"totalCalls",label:"Total Calls",section:"Cold Calling",bold:!0},{key:"freshCalls",label:"(Fresh Calls + FollowUpS)",section:"Cold Calling",bold:!1,isFormula:!0}],J=F==="day"?se():Ce(),de=B.useMemo(()=>{const ce=J;return{draMetrics:{labels:ce,datasets:[{label:"Interested",data:ce.map(ye=>S[ye]?.interested||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0},{label:"Not Interested",data:ce.map(ye=>S[ye]?.notInterested||0),borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",tension:.4,fill:!0}]},callStatusBreakdown:{labels:ce,datasets:[{label:"Ring",data:ce.map(ye=>S[ye]?.ring||0),backgroundColor:"rgba(156, 163, 175, 0.8)"},{label:"Busy",data:ce.map(ye=>S[ye]?.busy||0),backgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Call Back",data:ce.map(ye=>S[ye]?.callBack||0),backgroundColor:"rgba(168, 85, 247, 0.8)"}]},coldCallingMetrics:{labels:ce,datasets:[{label:"Details Shared",data:ce.map(ye=>S[ye]?.detailsShared||0),borderColor:"rgb(251, 191, 36)",backgroundColor:"rgba(251, 191, 36, 0.1)",tension:.4,fill:!0},{label:"Demo Booked",data:ce.map(ye=>S[ye]?.demoBooked||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0}]},callVolume:{labels:ce,datasets:[{label:"Total Calls",data:ce.map(ye=>S[ye]?.totalCalls||0),backgroundColor:"rgba(34, 197, 94, 0.8)"},{label:"Fresh Calls",data:ce.map(ye=>S[ye]?.freshCalls||0),backgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Follow Ups",data:ce.map(ye=>S[ye]?.followUps||0),backgroundColor:"rgba(168, 85, 247, 0.8)"}]}}},[J,S]),le={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"600"},bodyFont:{size:13},cornerRadius:8,displayColors:!0}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}},x:{grid:{display:!1},ticks:{font:{size:11}}}}},ze={...le,scales:{...le.scales,x:{...le.scales.x,stacked:!0},y:{...le.scales.y,stacked:!0}}};if(w)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading report..."})]})});const me=Ne.filter(ce=>ce.section==="DRA"),oe=Ne.filter(ce=>ce.section==="Cold Calling");return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}/funnel`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Sales Report"]}),t.jsxs("button",{onClick:P,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh data",children:[t.jsx("svg",{className:`w-4 h-4 ${w?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:[F==="day"?"Daily":"Monthly"," Report - ",a?.companyName||"Project"]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[L&&t.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",L.toLocaleTimeString()]}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>O("day"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="day"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Daily"}),t.jsx("button",{onClick:()=>O("month"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Monthly"})]})]})]})})]}),J.length>0&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"DRA Metrics"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:de.draMetrics,options:le})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Call Status Breakdown"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:de.callStatusBreakdown,options:ze})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cold Calling Metrics"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:de.coldCallingMetrics,options:le})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Call Volume"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:de.callVolume,options:ze})})]})]}),J.length>0&&t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200",children:"Key Results"}),J.map(ce=>t.jsxs("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200 last:border-r-0 bg-blue-50",children:[t.jsx("div",{children:ce}),t.jsx("div",{className:"text-xs font-normal text-gray-500 mt-1",children:"Progress"})]},ce))]})}),t.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.jsx("tr",{children:t.jsx("td",{colSpan:J.length+1,className:"px-6 py-3 bg-yellow-100 border-b-2 border-yellow-200",children:t.jsx("span",{className:"text-sm font-bold text-gray-900",children:"DRA"})})}),me.map(ce=>t.jsxs("tr",{className:`${ce.highlight?"bg-green-50":"hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm border-r border-gray-200 ${ce.bold?"font-bold text-gray-900":"text-gray-700"} ${ce.highlightDark?"bg-green-100":""}`,children:ce.label}),J.map(ye=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${ce.bold?"font-semibold text-gray-900":"text-gray-700"}`,children:ce.isFormula?`(${S[ye]?.freshCalls||0} + ${S[ye]?.followUps||0})`:S[ye]?.[ce.key]||0},ye))]},ce.key)),t.jsx("tr",{children:t.jsx("td",{colSpan:J.length+1,className:"px-6 py-3 bg-yellow-100 border-b-2 border-yellow-200",children:t.jsx("span",{className:"text-sm font-bold text-gray-900",children:"Cold Calling"})})}),oe.map(ce=>t.jsxs("tr",{className:`${ce.highlight?ce.highlightDark?"bg-green-200":"bg-green-50":"hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm border-r border-gray-200 ${ce.bold?"font-bold text-gray-900":"text-gray-700"} ${ce.highlightDark?"bg-green-200":""}`,children:ce.label}),J.map(ye=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${ce.bold?"font-semibold text-gray-900":"text-gray-700"}`,children:ce.isFormula?`(${S[ye]?.freshCalls||0} + ${S[ye]?.followUps||0})`:S[ye]?.[ce.key]||0},ye))]},ce.key))]})]})})}),J.length===0&&!w&&t.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:t.jsx("p",{className:"text-gray-500",children:"No call activities found for this project."})})]})})}cl.register(Vc,Wc,Ic,dl,Bc,Uc,Hc,zc,Ip);function _C(){const{id:l}=di(),n=Dr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({}),[L,M]=B.useState(null),[F,O]=B.useState("month");B.useEffect(()=>{l&&P()},[l]),B.useEffect(()=>{const oe=()=>{l&&!w&&P()};return window.addEventListener("focus",oe),()=>window.removeEventListener("focus",oe)},[l,w]);const P=async()=>{try{N(!0);const oe=await Ut.get(`/projects/${l}`);oe.data.success&&o(oe.data.data);const ce=await Ut.get(`/activities/project/${l}?limit=10000`);if(ce.data.success){const fe=(ce.data.data||[]).filter(Se=>Se.type==="email");e(fe)}const ye=await Ut.get(`/projects/${l}/project-contacts`);ye.data.success&&v(ye.data.data||[]),M(new Date)}catch(oe){console.error("Error fetching data:",oe)}finally{N(!1)}};B.useEffect(()=>{(s.length>0||m.length>0)&&ge()},[s,m,F]);const K=oe=>{const ce=new Date(oe),ye=ce.toLocaleString("default",{month:"short"}),ke=ce.getFullYear().toString().slice(-2);return`${ye} '${ke}`},ne=oe=>new Date(oe).getFullYear().toString(),se=()=>{const oe=new Set;return s.forEach(ye=>{ye.createdAt&&oe.add(K(ye.createdAt))}),m.forEach(ye=>{ye.createdAt&&oe.add(K(new Date(ye.createdAt)))}),Array.from(oe).sort((ye,ke)=>{const[fe,Se]=ye.split(" '"),[Ye,te]=ke.split(" '"),pe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],V=pe.indexOf(fe),be=pe.indexOf(Ye);return Se!==te?parseInt(Se)-parseInt(te):V-be})},Ce=()=>{const oe=new Set;return s.forEach(ye=>{ye.createdAt&&oe.add(ne(ye.createdAt))}),m.forEach(ye=>{ye.createdAt&&oe.add(ne(new Date(ye.createdAt)))}),Array.from(oe).sort((ye,ke)=>parseInt(ye)-parseInt(ke))},ge=()=>{const oe=F==="month"?se():Ce(),ce={};oe.forEach(ye=>{ce[ye]={emailsSent:0,noReply:0,notInterested:0,outOfOffice:0,meetingProposed:0,meetingScheduled:0,interested:0,wrongPerson:0,bounce:0,optOut:0,meetingCompleted:0,totalResponses:0,responseRate:0,openRate:0,clickRate:0}}),s.forEach(ye=>{if(ye.createdAt){const ke=F==="month"?K(ye.createdAt):ne(ye.createdAt);ce[ke]&&ce[ke].emailsSent++}}),s.forEach(ye=>{if(ye.createdAt&&ye.status){const ke=F==="month"?K(ye.createdAt):ne(ye.createdAt);if(!ce[ke])return;switch(ye.status){case"No Reply":ce[ke].noReply++;break;case"Not Interested":ce[ke].notInterested++,ce[ke].totalResponses++;break;case"Out of Office":ce[ke].outOfOffice++,ce[ke].totalResponses++;break;case"Meeting Proposed":ce[ke].meetingProposed++,ce[ke].totalResponses++;break;case"Meeting Scheduled":ce[ke].meetingScheduled++,ce[ke].totalResponses++;break;case"Interested":ce[ke].interested++,ce[ke].totalResponses++;break;case"Wrong Person":ce[ke].wrongPerson++,ce[ke].totalResponses++;break;case"Bounce":ce[ke].bounce++;break;case"Opt-Out":ce[ke].optOut++,ce[ke].totalResponses++;break;case"Meeting Completed":ce[ke].meetingCompleted++,ce[ke].totalResponses++;break}}}),oe.forEach(ye=>{ce[ye].emailsSent>0&&(ce[ye].responseRate=(ce[ye].totalResponses/ce[ye].emailsSent*100).toFixed(1))}),D(ce)},Ne=[{key:"emailsSent",label:"Emails Sent",section:"Email Activity",bold:!0},{key:"noReply",label:"No Reply",section:"Email Activity",bold:!1},{key:"notInterested",label:"Not Interested",section:"Email Activity",bold:!1},{key:"outOfOffice",label:"Out of Office",section:"Email Activity",bold:!1},{key:"meetingProposed",label:"Meeting Proposed",section:"Email Activity",bold:!0,highlight:!0},{key:"meetingScheduled",label:"Meeting Scheduled",section:"Email Activity",bold:!0,highlight:!0},{key:"interested",label:"Interested",section:"Email Activity",bold:!0,highlight:!0},{key:"wrongPerson",label:"Wrong Person",section:"Email Activity",bold:!1},{key:"bounce",label:"Bounce",section:"Email Activity",bold:!1},{key:"optOut",label:"Opt-Out",section:"Email Activity",bold:!1},{key:"meetingCompleted",label:"Meeting Completed",section:"Email Activity",bold:!0,highlight:!0,highlightDark:!0},{key:"totalResponses",label:"Total Responses",section:"Email Activity",bold:!0},{key:"responseRate",label:"Response Rate (%)",section:"Email Activity",bold:!0,isPercentage:!0}],J=F==="month"?se():Ce(),de=B.useMemo(()=>{const oe=J;return{emailFunnel:{labels:oe,datasets:[{label:"Emails Sent",data:oe.map(ce=>S[ce]?.emailsSent||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0},{label:"Total Responses",data:oe.map(ce=>S[ce]?.totalResponses||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0}]},responseBreakdown:{labels:oe,datasets:[{label:"No Reply",data:oe.map(ce=>S[ce]?.noReply||0),backgroundColor:"rgba(156, 163, 175, 0.8)"},{label:"Not Interested",data:oe.map(ce=>S[ce]?.notInterested||0),backgroundColor:"rgba(239, 68, 68, 0.8)"},{label:"Interested",data:oe.map(ce=>S[ce]?.interested||0),backgroundColor:"rgba(34, 197, 94, 0.8)"},{label:"Meeting Proposed",data:oe.map(ce=>S[ce]?.meetingProposed||0),backgroundColor:"rgba(251, 191, 36, 0.8)"},{label:"Meeting Scheduled",data:oe.map(ce=>S[ce]?.meetingScheduled||0),backgroundColor:"rgba(6, 182, 212, 0.8)"}]},meetingPipeline:{labels:oe,datasets:[{label:"Meeting Proposed",data:oe.map(ce=>S[ce]?.meetingProposed||0),backgroundColor:"rgba(251, 191, 36, 0.8)"},{label:"Meeting Scheduled",data:oe.map(ce=>S[ce]?.meetingScheduled||0),backgroundColor:"rgba(6, 182, 212, 0.8)"},{label:"Meeting Completed",data:oe.map(ce=>S[ce]?.meetingCompleted||0),backgroundColor:"rgba(34, 197, 94, 0.8)"}]},responseRate:{labels:oe,datasets:[{label:"Response Rate (%)",data:oe.map(ce=>parseFloat(S[ce]?.responseRate||0)),borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4,fill:!0}]}}},[J,S]),le={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"600"},bodyFont:{size:13},cornerRadius:8,displayColors:!0}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}},x:{grid:{display:!1},ticks:{font:{size:11}}}}},ze={...le,scales:{...le.scales,x:{...le.scales.x,stacked:!0},y:{...le.scales.y,stacked:!0}}};if(w)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading report..."})]})});const me=Ne.filter(oe=>oe.section==="Email Activity");return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}/funnel`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Sales Report"]}),t.jsxs("button",{onClick:P,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh data",children:[t.jsx("svg",{className:`w-4 h-4 ${w?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:[F==="month"?"Monthly":"Yearly"," Email Report - ",a?.companyName||"Project"]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[L&&t.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",L.toLocaleTimeString()]}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>O("month"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Monthly"}),t.jsx("button",{onClick:()=>O("year"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="year"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Yearly"})]})]})]})})]}),J.length>0&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Funnel"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:de.emailFunnel,options:le})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Response Breakdown"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:de.responseBreakdown,options:ze})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Meeting Pipeline"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:de.meetingPipeline,options:ze})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Response Rate"}),t.jsx("div",{className:"h-64",children:t.jsx(a0,{data:de.responseRate,options:le})})]})]}),J.length>0&&t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200",children:"Key Results"}),J.map(oe=>t.jsxs("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200 last:border-r-0 bg-blue-50",children:[t.jsx("div",{children:oe}),t.jsx("div",{className:"text-xs font-normal text-gray-500 mt-1",children:"Progress"})]},oe))]})}),t.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.jsx("tr",{children:t.jsx("td",{colSpan:J.length+1,className:"px-6 py-3 bg-yellow-100 border-b-2 border-yellow-200",children:t.jsx("span",{className:"text-sm font-bold text-gray-900",children:"Email Activity"})})}),me.map(oe=>t.jsxs("tr",{className:`${oe.highlight?oe.highlightDark?"bg-green-200":"bg-green-50":"hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm border-r border-gray-200 ${oe.bold?"font-bold text-gray-900":"text-gray-700"} ${oe.highlightDark?"bg-green-200":""}`,children:oe.label}),J.map(ce=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${oe.bold?"font-semibold text-gray-900":"text-gray-700"}`,children:oe.isPercentage?`${S[ce]?.[oe.key]||0}%`:S[ce]?.[oe.key]||0},ce))]},oe.key))]})]})})}),J.length===0&&!w&&t.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:t.jsx("p",{className:"text-gray-500",children:"No email activities found for this project."})})]})})}function mp(l){throw new Error('Could not dynamically require "'+l+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ip={exports:{}},gp={exports:{}};var FC=gp.exports,Rb;function MC(){return Rb||(Rb=1,(function(l){var n={version:"1.15.0"};n[437]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[620]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[737]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[850]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[852]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[857]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[861]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[865]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[866]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[874]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[895]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[932]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(o[s[129][e]]=33024+e,a[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(o[s[130][e]]=33280+e,a[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(o[s[131][e]]=33536+e,a[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(o[s[132][e]]=33792+e,a[33792+e]=s[132][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(o[s[135][e]]=34560+e,a[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(o[s[136][e]]=34816+e,a[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(o[s[137][e]]=35072+e,a[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(o[s[138][e]]=35328+e,a[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(o[s[139][e]]=35584+e,a[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(o[s[140][e]]=35840+e,a[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(o[s[141][e]]=36096+e,a[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(o[s[142][e]]=36352+e,a[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(o[s[143][e]]=36608+e,a[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(o[s[144][e]]=36864+e,a[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(o[s[145][e]]=37120+e,a[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(o[s[146][e]]=37376+e,a[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(o[s[147][e]]=37632+e,a[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(o[s[148][e]]=37888+e,a[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(o[s[149][e]]=38144+e,a[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(o[s[150][e]]=38400+e,a[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(o[s[151][e]]=38656+e,a[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(o[s[152][e]]=38912+e,a[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(o[s[153][e]]=39168+e,a[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(o[s[154][e]]=39424+e,a[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(o[s[155][e]]=39680+e,a[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(o[s[156][e]]=39936+e,a[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(o[s[157][e]]=40192+e,a[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(o[s[158][e]]=40448+e,a[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(o[s[159][e]]=40704+e,a[40704+e]=s[159][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(o[s[250][e]]=64e3+e,a[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(o[s[251][e]]=64256+e,a[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(o[s[252][e]]=64512+e,a[64512+e]=s[252][e]);return{enc:o,dec:a}})(),n[936]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(o[s[129][e]]=33024+e,a[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(o[s[130][e]]=33280+e,a[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(o[s[131][e]]=33536+e,a[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(o[s[132][e]]=33792+e,a[33792+e]=s[132][e]);for(s[133]="".split(""),e=0;e!=s[133].length;++e)s[133][e].charCodeAt(0)!==65533&&(o[s[133][e]]=34048+e,a[34048+e]=s[133][e]);for(s[134]="".split(""),e=0;e!=s[134].length;++e)s[134][e].charCodeAt(0)!==65533&&(o[s[134][e]]=34304+e,a[34304+e]=s[134][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(o[s[135][e]]=34560+e,a[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(o[s[136][e]]=34816+e,a[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(o[s[137][e]]=35072+e,a[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(o[s[138][e]]=35328+e,a[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(o[s[139][e]]=35584+e,a[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(o[s[140][e]]=35840+e,a[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(o[s[141][e]]=36096+e,a[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(o[s[142][e]]=36352+e,a[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(o[s[143][e]]=36608+e,a[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(o[s[144][e]]=36864+e,a[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(o[s[145][e]]=37120+e,a[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(o[s[146][e]]=37376+e,a[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(o[s[147][e]]=37632+e,a[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(o[s[148][e]]=37888+e,a[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(o[s[149][e]]=38144+e,a[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(o[s[150][e]]=38400+e,a[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(o[s[151][e]]=38656+e,a[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(o[s[152][e]]=38912+e,a[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(o[s[153][e]]=39168+e,a[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(o[s[154][e]]=39424+e,a[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(o[s[155][e]]=39680+e,a[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(o[s[156][e]]=39936+e,a[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(o[s[157][e]]=40192+e,a[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(o[s[158][e]]=40448+e,a[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(o[s[159][e]]=40704+e,a[40704+e]=s[159][e]);for(s[160]="".split(""),e=0;e!=s[160].length;++e)s[160][e].charCodeAt(0)!==65533&&(o[s[160][e]]=40960+e,a[40960+e]=s[160][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(o[s[170][e]]=43520+e,a[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(o[s[171][e]]=43776+e,a[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(o[s[172][e]]=44032+e,a[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(o[s[173][e]]=44288+e,a[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(o[s[174][e]]=44544+e,a[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(o[s[175][e]]=44800+e,a[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(o[s[199][e]]=50944+e,a[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(o[s[200][e]]=51200+e,a[51200+e]=s[200][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(o[s[201][e]]=51456+e,a[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(o[s[248][e]]=63488+e,a[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(o[s[249][e]]=63744+e,a[63744+e]=s[249][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(o[s[250][e]]=64e3+e,a[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(o[s[251][e]]=64256+e,a[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(o[s[252][e]]=64512+e,a[64512+e]=s[252][e]);for(s[253]="".split(""),e=0;e!=s[253].length;++e)s[253][e].charCodeAt(0)!==65533&&(o[s[253][e]]=64768+e,a[64768+e]=s[253][e]);for(s[254]="".split(""),e=0;e!=s[254].length;++e)s[254][e].charCodeAt(0)!==65533&&(o[s[254][e]]=65024+e,a[65024+e]=s[254][e]);return{enc:o,dec:a}})(),n[949]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(o[s[129][e]]=33024+e,a[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(o[s[130][e]]=33280+e,a[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(o[s[131][e]]=33536+e,a[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(o[s[132][e]]=33792+e,a[33792+e]=s[132][e]);for(s[133]="".split(""),e=0;e!=s[133].length;++e)s[133][e].charCodeAt(0)!==65533&&(o[s[133][e]]=34048+e,a[34048+e]=s[133][e]);for(s[134]="".split(""),e=0;e!=s[134].length;++e)s[134][e].charCodeAt(0)!==65533&&(o[s[134][e]]=34304+e,a[34304+e]=s[134][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(o[s[135][e]]=34560+e,a[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(o[s[136][e]]=34816+e,a[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(o[s[137][e]]=35072+e,a[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(o[s[138][e]]=35328+e,a[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(o[s[139][e]]=35584+e,a[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(o[s[140][e]]=35840+e,a[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(o[s[141][e]]=36096+e,a[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(o[s[142][e]]=36352+e,a[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(o[s[143][e]]=36608+e,a[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(o[s[144][e]]=36864+e,a[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(o[s[145][e]]=37120+e,a[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(o[s[146][e]]=37376+e,a[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(o[s[147][e]]=37632+e,a[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(o[s[148][e]]=37888+e,a[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(o[s[149][e]]=38144+e,a[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(o[s[150][e]]=38400+e,a[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(o[s[151][e]]=38656+e,a[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(o[s[152][e]]=38912+e,a[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(o[s[153][e]]=39168+e,a[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(o[s[154][e]]=39424+e,a[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(o[s[155][e]]=39680+e,a[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(o[s[156][e]]=39936+e,a[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(o[s[157][e]]=40192+e,a[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(o[s[158][e]]=40448+e,a[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(o[s[159][e]]=40704+e,a[40704+e]=s[159][e]);for(s[160]="".split(""),e=0;e!=s[160].length;++e)s[160][e].charCodeAt(0)!==65533&&(o[s[160][e]]=40960+e,a[40960+e]=s[160][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(o[s[170][e]]=43520+e,a[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(o[s[171][e]]=43776+e,a[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(o[s[172][e]]=44032+e,a[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(o[s[173][e]]=44288+e,a[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(o[s[174][e]]=44544+e,a[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(o[s[175][e]]=44800+e,a[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(o[s[199][e]]=50944+e,a[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(o[s[200][e]]=51200+e,a[51200+e]=s[200][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(o[s[248][e]]=63488+e,a[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(o[s[249][e]]=63744+e,a[63744+e]=s[249][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(o[s[250][e]]=64e3+e,a[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(o[s[251][e]]=64256+e,a[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(o[s[252][e]]=64512+e,a[64512+e]=s[252][e]);for(s[253]="".split(""),e=0;e!=s[253].length;++e)s[253][e].charCodeAt(0)!==65533&&(o[s[253][e]]=64768+e,a[64768+e]=s[253][e]);return{enc:o,dec:a}})(),n[950]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(o[s[170][e]]=43520+e,a[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(o[s[171][e]]=43776+e,a[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(o[s[172][e]]=44032+e,a[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(o[s[173][e]]=44288+e,a[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(o[s[174][e]]=44544+e,a[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(o[s[175][e]]=44800+e,a[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(o[s[201][e]]=51456+e,a[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(o[s[248][e]]=63488+e,a[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(o[s[249][e]]=63744+e,a[63744+e]=s[249][e]);return{enc:o,dec:a}})(),n[1250]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1251]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1252]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1253]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1254]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1255]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1256]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1257]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1258]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1e4]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10006]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10007]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10008]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(o[s[199][e]]=50944+e,a[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(o[s[200][e]]=51200+e,a[51200+e]=s[200][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(o[s[201][e]]=51456+e,a[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);return{enc:o,dec:a}})(),n[10029]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10079]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10081]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[28591]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),l.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"&&(l.exports=n);(function(a,o){if(typeof n>"u")if(typeof mp<"u"){var s=n;l.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"?l.exports=o(s):a.cptable=o(s)}else throw new Error("cptable not found");else n=o(n)})(FC,function(a){var o={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},s=[874,1250,1251,1252,1253,1254,1255,1256,1e4],e=[932,936,949,950],m=[65001],v={},w={},N={},S={},D=function(pe){return String.fromCharCode(pe)},L=function(pe){return pe.charCodeAt(0)},M=typeof Buffer<"u",F=function(){};if(M){var O=!Buffer.from;if(!O)try{Buffer.from("foo","utf8")}catch{O=!0}F=O?function(te,pe){return pe?new Buffer(te,pe):new Buffer(te)}:Buffer.from.bind(Buffer),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(te){return new Buffer(te)});var P=1024,K=Buffer.allocUnsafe(P),ne=function(pe){for(var V=Buffer.allocUnsafe(65536),be=0;be<65536;++be)V[be]=0;for(var _e=Object.keys(pe),De=_e.length,W=0,H=_e[W];W<De;++W)(H=_e[W])&&(V[H.charCodeAt(0)]=pe[H]);return V},se=function(pe){var V=ne(a[pe].enc);return function(_e,De){var W=_e.length,H,X=0,je=0,Q=0,we=0;if(typeof _e=="string")for(H=Buffer.allocUnsafe(W),X=0;X<W;++X)H[X]=V[_e.charCodeAt(X)];else if(Buffer.isBuffer(_e)){for(H=Buffer.allocUnsafe(2*W),je=0,X=0;X<W;++X)Q=_e[X],Q<128?H[je++]=V[Q]:Q<224?(H[je++]=V[((Q&31)<<6)+(_e[X+1]&63)],++X):Q<240?(H[je++]=V[((Q&15)<<12)+((_e[X+1]&63)<<6)+(_e[X+2]&63)],X+=2):(we=((Q&7)<<18)+((_e[X+1]&63)<<12)+((_e[X+2]&63)<<6)+(_e[X+3]&63),X+=3,we<65536?H[je++]=V[we]:(we-=65536,H[je++]=V[55296+(we>>10&1023)],H[je++]=V[56320+(we&1023)]));H=H.slice(0,je)}else for(H=Buffer.allocUnsafe(W),X=0;X<W;++X)H[X]=V[_e[X].charCodeAt(0)];return!De||De==="buf"?H:De!=="arr"?H.toString("binary"):[].slice.call(H)}},Ce=function(pe){var V=a[pe].dec,be=Buffer.allocUnsafe(131072),_e=0,De="";for(_e=0;_e<V.length;++_e)if(De=V[_e]){var W=De.charCodeAt(0);be[2*_e]=W&255,be[2*_e+1]=W>>8}return function(X){var je=X.length,Q=0,we=0;if(2*je>P&&(P=2*je,K=Buffer.allocUnsafe(P)),Buffer.isBuffer(X))for(Q=0;Q<je;Q++)we=2*X[Q],K[2*Q]=be[we],K[2*Q+1]=be[we+1];else if(typeof X=="string")for(Q=0;Q<je;Q++)we=2*X.charCodeAt(Q),K[2*Q]=be[we],K[2*Q+1]=be[we+1];else for(Q=0;Q<je;Q++)we=2*X[Q],K[2*Q]=be[we],K[2*Q+1]=be[we+1];return K.slice(0,2*je).toString("ucs2")}},ge=function(pe){for(var V=a[pe].enc,be=Buffer.allocUnsafe(131072),_e=0;_e<131072;++_e)be[_e]=0;for(var De=Object.keys(V),W=0,H=De[W];W<De.length;++W)if(H=De[W]){var X=H.charCodeAt(0);be[2*X]=V[H]&255,be[2*X+1]=V[H]>>8}return function(Q,we){var Fe=Q.length,ue=Buffer.allocUnsafe(2*Fe),xe=0,tt=0,Qe=0,Ve=0,xt=0;if(typeof Q=="string"){for(xe=Ve=0;xe<Fe;++xe)tt=Q.charCodeAt(xe)*2,ue[Ve++]=be[tt+1]||be[tt],be[tt+1]>0&&(ue[Ve++]=be[tt]);ue=ue.slice(0,Ve)}else if(Buffer.isBuffer(Q)){for(xe=Ve=0;xe<Fe;++xe)xt=Q[xe],xt<128?tt=xt:xt<224?(tt=((xt&31)<<6)+(Q[xe+1]&63),++xe):xt<240?(tt=((xt&15)<<12)+((Q[xe+1]&63)<<6)+(Q[xe+2]&63),xe+=2):(tt=((xt&7)<<18)+((Q[xe+1]&63)<<12)+((Q[xe+2]&63)<<6)+(Q[xe+3]&63),xe+=3),tt<65536?(tt*=2,ue[Ve++]=be[tt+1]||be[tt],be[tt+1]>0&&(ue[Ve++]=be[tt])):(Qe=tt-65536,tt=2*(55296+(Qe>>10&1023)),ue[Ve++]=be[tt+1]||be[tt],be[tt+1]>0&&(ue[Ve++]=be[tt]),tt=2*(56320+(Qe&1023)),ue[Ve++]=be[tt+1]||be[tt],be[tt+1]>0&&(ue[Ve++]=be[tt]));ue=ue.slice(0,Ve)}else for(xe=Ve=0;xe<Fe;xe++)tt=Q[xe].charCodeAt(0)*2,ue[Ve++]=be[tt+1]||be[tt],be[tt+1]>0&&(ue[Ve++]=be[tt]);return!we||we==="buf"?ue:we!=="arr"?ue.toString("binary"):[].slice.call(ue)}},Ne=function(pe){var V=a[pe].dec,be=Buffer.allocUnsafe(131072),_e=0,De,W=0,H=0,X=0;for(X=0;X<65536;++X)be[2*X]=255,be[2*X+1]=253;for(_e=0;_e<V.length;++_e)(De=V[_e])&&(W=De.charCodeAt(0),H=2*_e,be[H]=W&255,be[H+1]=W>>8);return function(Q){var we=Q.length,Fe=Buffer.allocUnsafe(2*we),ue=0,xe=0,tt=0;if(Buffer.isBuffer(Q))for(ue=0;ue<we;ue++)xe=2*Q[ue],be[xe]===255&&be[xe+1]===253&&(xe=2*((Q[ue]<<8)+Q[ue+1]),++ue),Fe[tt++]=be[xe],Fe[tt++]=be[xe+1];else if(typeof Q=="string")for(ue=0;ue<we;ue++)xe=2*Q.charCodeAt(ue),be[xe]===255&&be[xe+1]===253&&(xe=2*((Q.charCodeAt(ue)<<8)+Q.charCodeAt(ue+1)),++ue),Fe[tt++]=be[xe],Fe[tt++]=be[xe+1];else for(ue=0;ue<we;ue++)xe=2*Q[ue],be[xe]===255&&be[xe+1]===253&&(xe=2*((Q[ue]<<8)+Q[ue+1]),++ue),Fe[tt++]=be[xe],Fe[tt++]=be[xe+1];return Fe.slice(0,tt).toString("ucs2")}};v[65001]=function te(pe){if(typeof pe=="string")return te(pe.split("").map(L));var V=pe.length,be=0,_e=0;4*V>P&&(P=4*V,K=Buffer.allocUnsafe(P));var De=0;V>=3&&pe[0]==239&&pe[1]==187&&pe[2]==191&&(De=3);for(var W=1,H=0,X=0;De<V;De+=W)W=1,X=pe[De],X<128?be=X:X<224?(be=(X&31)*64+(pe[De+1]&63),W=2):X<240?(be=((X&15)<<12)+(pe[De+1]&63)*64+(pe[De+2]&63),W=3):(be=(X&7)*262144+((pe[De+1]&63)<<12)+(pe[De+2]&63)*64+(pe[De+3]&63),W=4),be<65536?(K[H++]=be&255,K[H++]=be>>8):(be-=65536,_e=55296+(be>>10&1023),be=56320+(be&1023),K[H++]=_e&255,K[H++]=_e>>>8,K[H++]=be&255,K[H++]=be>>>8&255);return K.slice(0,H).toString("ucs2")},w[65001]=function(pe,V){if(M&&Buffer.isBuffer(pe))return!V||V==="buf"?pe:V!=="arr"?pe.toString("binary"):[].slice.call(pe);var be=pe.length,_e=0,De=0,W=0,H=typeof pe=="string";4*be>P&&(P=4*be,K=Buffer.allocUnsafe(P));for(var X=0;X<be;++X)_e=H?pe.charCodeAt(X):pe[X].charCodeAt(0),_e<=127?K[W++]=_e:_e<=2047?(K[W++]=192+(_e>>6),K[W++]=128+(_e&63)):_e>=55296&&_e<=57343?(_e-=55296,++X,De=(H?pe.charCodeAt(X):pe[X].charCodeAt(0))-56320+(_e<<10),K[W++]=240+(De>>>18&7),K[W++]=144+(De>>>12&63),K[W++]=128+(De>>>6&63),K[W++]=128+(De&63)):(K[W++]=224+(_e>>12),K[W++]=128+(_e>>6&63),K[W++]=128+(_e&63));return!V||V==="buf"?K.slice(0,W):V!=="arr"?K.slice(0,W).toString("binary"):[].slice.call(K,0,W)}}var J=function(){if(M){if(N[s[0]])return;var pe=0,V=0;for(pe=0;pe<s.length;++pe)V=s[pe],a[V]&&(N[V]=Ce(V),S[V]=se(V));for(pe=0;pe<e.length;++pe)V=e[pe],a[V]&&(N[V]=Ne(V),S[V]=ge(V));for(pe=0;pe<m.length;++pe)V=m[pe],v[V]&&(N[V]=v[V]),w[V]&&(S[V]=w[V])}},de=function(te,pe){return""},le=function(pe){delete N[pe],delete S[pe]},ze=function(){if(M){if(!N[s[0]])return;s.forEach(le),e.forEach(le),m.forEach(le)}ye=de,ke=0},me={encache:J,decache:ze,sbcs:s,dbcs:e};J();var oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?",ye=de,ke=0,fe=function te(pe,V,be){if(pe===ke&&ye)return ye(V,be);if(S[pe])return ye=S[ke=pe],ye(V,be);M&&Buffer.isBuffer(V)&&(V=V.toString("utf8"));var _e=V.length,De=M?Buffer.allocUnsafe(4*_e):[],W=0,H=0,X=0,je=0,Q=a[pe],we,Fe="",ue=typeof V=="string";if(Q&&(we=Q.enc))for(H=0;H<_e;++H,++X)W=we[ue?V.charAt(H):V[H]],W>255?(De[X]=W>>8,De[++X]=W&255):De[X]=W&255;else if(Fe=o[pe])switch(Fe){case"utf8":if(M&&ue){De=F(V,Fe),X=De.length;break}for(H=0;H<_e;++H,++X)W=ue?V.charCodeAt(H):V[H].charCodeAt(0),W<=127?De[X]=W:W<=2047?(De[X]=192+(W>>6),De[++X]=128+(W&63)):W>=55296&&W<=57343?(W-=55296,je=(ue?V.charCodeAt(++H):V[++H].charCodeAt(0))-56320+(W<<10),De[X]=240+(je>>>18&7),De[++X]=144+(je>>>12&63),De[++X]=128+(je>>>6&63),De[++X]=128+(je&63)):(De[X]=224+(W>>12),De[++X]=128+(W>>6&63),De[++X]=128+(W&63));break;case"ascii":if(M&&typeof V=="string"){De=F(V,Fe),X=De.length;break}for(H=0;H<_e;++H,++X)if(W=ue?V.charCodeAt(H):V[H].charCodeAt(0),W<=127)De[X]=W;else throw new Error("bad ascii "+W);break;case"utf16le":if(M&&typeof V=="string"){De=F(V,Fe),X=De.length;break}for(H=0;H<_e;++H)W=ue?V.charCodeAt(H):V[H].charCodeAt(0),De[X++]=W&255,De[X++]=W>>8;break;case"utf16be":for(H=0;H<_e;++H)W=ue?V.charCodeAt(H):V[H].charCodeAt(0),De[X++]=W>>8,De[X++]=W&255;break;case"utf32le":for(H=0;H<_e;++H)W=ue?V.charCodeAt(H):V[H].charCodeAt(0),W>=55296&&W<=57343&&(W=65536+(W-55296<<10)+(V[++H].charCodeAt(0)-56320)),De[X++]=W&255,W>>=8,De[X++]=W&255,W>>=8,De[X++]=W&255,W>>=8,De[X++]=W&255;break;case"utf32be":for(H=0;H<_e;++H)W=ue?V.charCodeAt(H):V[H].charCodeAt(0),W>=55296&&W<=57343&&(W=65536+(W-55296<<10)+(V[++H].charCodeAt(0)-56320)),De[X+3]=W&255,W>>=8,De[X+2]=W&255,W>>=8,De[X+1]=W&255,W>>=8,De[X]=W&255,X+=4;break;case"utf7":for(H=0;H<_e;H++){var xe=ue?V.charAt(H):V[H].charAt(0);if(xe==="+"){De[X++]=43,De[X++]=45;continue}if(ce.indexOf(xe)>-1){De[X++]=xe.charCodeAt(0);continue}var tt=te(1201,xe);De[X++]=43,De[X++]=oe.charCodeAt(tt[0]>>2),De[X++]=oe.charCodeAt(((tt[0]&3)<<4)+((tt[1]||0)>>4)),De[X++]=oe.charCodeAt(((tt[1]&15)<<2)+((tt[2]||0)>>6)),De[X++]=45}break;default:throw new Error("Unsupported magic: "+pe+" "+o[pe])}else throw new Error("Unrecognized CP: "+pe);return De=De.slice(0,X),M?!be||be==="buf"?De:be!=="arr"?De.toString("binary"):[].slice.call(De):be=="str"?De.map(D).join(""):De},Se=function te(pe,V){var be;if(be=N[pe])return be(V);if(typeof V=="string")return te(pe,V.split("").map(L));var _e=V.length,De=new Array(_e),W="",H=0,X=0,je=1,Q=0,we=0,Fe=a[pe],ue,xe="";if(Fe&&(ue=Fe.dec))for(X=0;X<_e;X+=je){if(je=2,W=ue[(V[X]<<8)+V[X+1]],W||(je=1,W=ue[V[X]]),!W)throw new Error("Unrecognized code: "+V[X]+" "+V[X+je-1]+" "+X+" "+je+" "+ue[V[X]]);De[Q++]=W}else if(xe=o[pe])switch(xe){case"utf8":for(_e>=3&&V[0]==239&&V[1]==187&&V[2]==191&&(X=3);X<_e;X+=je)je=1,V[X]<128?H=V[X]:V[X]<224?(H=(V[X]&31)*64+(V[X+1]&63),je=2):V[X]<240?(H=((V[X]&15)<<12)+(V[X+1]&63)*64+(V[X+2]&63),je=3):(H=(V[X]&7)*262144+((V[X+1]&63)<<12)+(V[X+2]&63)*64+(V[X+3]&63),je=4),H<65536||(H-=65536,we=55296+(H>>10&1023),H=56320+(H&1023),De[Q++]=String.fromCharCode(we)),De[Q++]=String.fromCharCode(H);break;case"ascii":if(M&&Buffer.isBuffer(V))return V.toString(xe);for(X=0;X<_e;X++)De[X]=String.fromCharCode(V[X]);Q=_e;break;case"utf16le":if(_e>=2&&V[0]==255&&V[1]==254&&(X=2),M&&Buffer.isBuffer(V))return V.toString(xe);for(je=2;X+1<_e;X+=je)De[Q++]=String.fromCharCode((V[X+1]<<8)+V[X]);break;case"utf16be":for(_e>=2&&V[0]==254&&V[1]==255&&(X=2),je=2;X+1<_e;X+=je)De[Q++]=String.fromCharCode((V[X]<<8)+V[X+1]);break;case"utf32le":for(_e>=4&&V[0]==255&&V[1]==254&&V[2]===0&&V[3]===0&&(X=4),je=4;X<_e;X+=je)H=(V[X+3]<<24)+(V[X+2]<<16)+(V[X+1]<<8)+V[X],H>65535?(H-=65536,De[Q++]=String.fromCharCode(55296+(H>>10&1023)),De[Q++]=String.fromCharCode(56320+(H&1023))):De[Q++]=String.fromCharCode(H);break;case"utf32be":for(_e>=4&&V[3]==255&&V[2]==254&&V[1]===0&&V[0]===0&&(X=4),je=4;X<_e;X+=je)H=(V[X]<<24)+(V[X+1]<<16)+(V[X+2]<<8)+V[X+3],H>65535?(H-=65536,De[Q++]=String.fromCharCode(55296+(H>>10&1023)),De[Q++]=String.fromCharCode(56320+(H&1023))):De[Q++]=String.fromCharCode(H);break;case"utf7":for(_e>=4&&V[0]==43&&V[1]==47&&V[2]==118&&(_e>=5&&V[3]==56&&V[4]==45?X=5:(V[3]==56||V[3]==57||V[3]==43||V[3]==47)&&(X=4));X<_e;X+=je){if(V[X]!==43){je=1,De[Q++]=String.fromCharCode(V[X]);continue}if(je=1,V[X+1]===45){je=2,De[Q++]="+";continue}for(;String.fromCharCode(V[X+je]).match(/[A-Za-z0-9+\/]/);)je++;var tt=0;V[X+je]===45&&(++je,tt=1);for(var Qe=[],Ve="",xt=0,nt=0,$t=0,Mt=0,Es=0,qs=0,ms=0,ys=1;ys<je-tt&&(Mt=oe.indexOf(String.fromCharCode(V[X+ys++])),Es=oe.indexOf(String.fromCharCode(V[X+ys++])),xt=Mt<<2|Es>>4,Qe.push(xt),qs=oe.indexOf(String.fromCharCode(V[X+ys++])),!(qs===-1||(nt=(Es&15)<<4|qs>>2,Qe.push(nt),ms=oe.indexOf(String.fromCharCode(V[X+ys++])),ms===-1)));)$t=(qs&3)<<6|ms,ms<64&&Qe.push($t);for(Ve=te(1201,Qe),ys=0;ys<Ve.length;++ys)De[Q++]=Ve.charAt(ys)}break;default:throw new Error("Unsupported magic: "+pe+" "+o[pe])}else throw new Error("Unrecognized CP: "+pe);return De.slice(0,Q).join("")},Ye=function(pe){return!!(a[pe]||o[pe])};return a.utils={decode:Se,encode:fe,hascp:Ye,magic:o,cache:me},a})})(gp)),gp.exports}const LC={},RC=Object.freeze(Object.defineProperty({__proto__:null,default:LC},Symbol.toStringTag,{value:"Module"})),I1=Dv(RC);var Ob;function OC(){return Ob||(Ob=1,(function(l,n){var a={};function o(s){s.version="0.18.5",s.style_version="1.2.0";var e,m=1200,v=1252;typeof cptable<"u"?e=cptable:typeof mp<"u"&&(e=MC());var w=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},S=function(r){w.indexOf(r)!=-1&&(v=N[0]=r)},D=function(r){S(m=r)};function L(){D(1200),S(1252)}function M(r){for(var d=[],u=0,h=r.length;u<h;++u)d[u]=r.charCodeAt(u);return d}function F(r){for(var d=[],u=0;u<r.length>>1;++u)d[u]=String.fromCharCode(r.charCodeAt(2*u+1)+(r.charCodeAt(2*u)<<8));return d.join("")}var O=function(r){var d=r.charCodeAt(0),u=r.charCodeAt(1);return d==255&&u==254?(function(h){for(var g=[],b=0;b<h.length>>1;++b)g[b]=String.fromCharCode(h.charCodeAt(2*b)+(h.charCodeAt(2*b+1)<<8));return g.join("")})(r.slice(2)):d==254&&u==255?F(r.slice(2)):d==65279?r.slice(1):r},P=function(r){return String.fromCharCode(r)},K=function(r){return String.fromCharCode(r)};e!==void 0&&(D=function(r){S(m=r)},O=function(r){return r.charCodeAt(0)===255&&r.charCodeAt(1)===254?e.utils.decode(1200,M(r.slice(2))):r},P=function(r){return m===1200?String.fromCharCode(r):e.utils.decode(m,[255&r,r>>8])[0]},K=function(r){return e.utils.decode(v,[r])[0]});var ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function se(r){for(var d,u,h,g,b,x="",y=0,j=0,k=0;k<r.length;)g=(d=r.charCodeAt(k++))>>2,b=(3&d)<<4|(u=r.charCodeAt(k++))>>4,y=(15&u)<<2|(h=r.charCodeAt(k++))>>6,j=63&h,isNaN(u)?y=j=64:isNaN(h)&&(j=64),x+=ne.charAt(g)+ne.charAt(b)+ne.charAt(y)+ne.charAt(j);return x}function Ce(r){var d,u,h,g,b,x,y="";r=r.replace(/[^\w\+\/\=]/g,"");for(var j=0;j<r.length;)d=ne.indexOf(r.charAt(j++))<<2|(g=ne.indexOf(r.charAt(j++)))>>4,y+=String.fromCharCode(d),u=(15&g)<<4|(b=ne.indexOf(r.charAt(j++)))>>2,b!==64&&(y+=String.fromCharCode(u)),h=(3&b)<<6|(x=ne.indexOf(r.charAt(j++))),x!==64&&(y+=String.fromCharCode(h));return y}var ge=typeof Buffer<"u"&&typeof process<"u"&&process.versions!==void 0&&!!process.versions.node,Ne=(function(){if(typeof Buffer>"u")return function(){};var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(d,u){return u?new Buffer(d,u):new Buffer(d)}:Buffer.from.bind(Buffer)})();function J(r){return ge?Buffer.alloc?Buffer.alloc(r):new Buffer(r):new(typeof Uint8Array<"u"?Uint8Array:Array)(r)}function de(r){return ge?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):new(typeof Uint8Array<"u"?Uint8Array:Array)(r)}var le=function(r){return ge?Ne(r,"binary"):r.split("").map(function(d){return 255&d.charCodeAt(0)})};function ze(r){if(typeof ArrayBuffer>"u")return le(r);for(var d=new ArrayBuffer(r.length),u=new Uint8Array(d),h=0;h!=r.length;++h)u[h]=255&r.charCodeAt(h);return d}function me(r){if(Array.isArray(r))return r.map(function(h){return String.fromCharCode(h)}).join("");for(var d=[],u=0;u<r.length;++u)d[u]=String.fromCharCode(r[u]);return d.join("")}function oe(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return oe(new Uint8Array(r));for(var d=new Array(r.length),u=0;u<r.length;++u)d[u]=r[u];return d}var ce=ge?function(r){return Buffer.concat(r.map(function(d){return Buffer.isBuffer(d)?d:Ne(d)}))}:function(r){if(typeof Uint8Array>"u")return[].concat.apply([],r.map(function(b){return Array.isArray(b)?b:[].slice.call(b)}));for(var u=0,d=0,u=0;u<r.length;++u)d+=r[u].length;for(var h,g=new Uint8Array(d),d=u=0;u<r.length;d+=h,++u)if(h=r[u].length,r[u]instanceof Uint8Array)g.set(r[u],d);else{if(typeof r[u]=="string")throw"wtf";g.set(new Uint8Array(r[u]),d)}return g},ye=/\u0000/g,ke=/[\u0001-\u0006]/g;function fe(r){for(var d="",u=r.length-1;0<=u;)d+=r.charAt(u--);return d}function Se(r,d){return r=""+r,d<=r.length?r:lr("0",d-r.length)+r}function Ye(r,d){return r=""+r,d<=r.length?r:lr(" ",d-r.length)+r}function te(r,d){return r=""+r,d<=r.length?r:r+lr(" ",d-r.length)}var pe=Math.pow(2,32);function V(g,d){if(pe<g||g<-pe)return u=g,h=d,u=""+Math.round(u),h<=u.length?u:lr("0",h-u.length)+u;var u,h,g=Math.round(g);return(d=d)<=(g=""+(g=g)).length?g:lr("0",d-g.length)+g}function be(r,d){return d=d||0,r.length>=7+d&&(32|r.charCodeAt(d))==103&&(32|r.charCodeAt(d+1))==101&&(32|r.charCodeAt(d+2))==110&&(32|r.charCodeAt(d+3))==101&&(32|r.charCodeAt(d+4))==114&&(32|r.charCodeAt(d+5))==97&&(32|r.charCodeAt(d+6))==108}var _e=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],De=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],W={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},H={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},X={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function je(r,d,u){for(var h=r<0?-1:1,g=r*h,b=0,x=1,y=0,j=1,k=0,E=0,T=Math.floor(g);k<d&&(y=(T=Math.floor(g))*x+b,E=T*k+j,!(g-T<5e-8));)g=1/(g-T),b=x,x=y,j=k,k=E;return d<E&&(y=d<k?(E=j,b):(E=k,x)),u?(u=Math.floor(h*y/E),[u,h*y-u*E,E]):[0,h*y,E]}function Q(y,d,u){if(2958465<y||y<0)return null;var h=0|y,g=Math.floor(86400*(y-h)),b=0,x=[],y={D:h,T:g,u:86400*(y-h)-g,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(y.u)<1e-6&&(y.u=0),d&&d.date1904&&(h+=1462),.9999<y.u&&(y.u=0,++g==86400&&(y.T=g=0,++h,++y.D)),h===60?(x=u?[1317,10,29]:[1900,2,29],b=3):h===0?(x=u?[1317,8,29]:[1900,1,0],b=6):(60<h&&--h,(d=new Date(1900,0,1)).setDate(d.getDate()+h-1),x=[d.getFullYear(),d.getMonth()+1,d.getDate()],b=d.getDay(),h<60&&(b=(b+6)%7),u&&(b=(function(j,k){return k[0]-=581,k=j.getDay(),j<60&&(k=(k+6)%7),k})(d,x))),y.y=x[0],y.m=x[1],y.d=x[2],y.S=g%60,g=Math.floor(g/60),y.M=g%60,g=Math.floor(g/60),y.H=g,y.q=b,y}var we=new Date(1899,11,31,0,0,0),Fe=we.getTime(),ue=new Date(1900,2,1,0,0,0);function xe(r,d){var u=r.getTime();return d?u-=1262304e5:ue<=r&&(u+=864e5),(u-(Fe+6e4*(r.getTimezoneOffset()-we.getTimezoneOffset())))/864e5}function tt(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Qe(r){var d,u,h,g=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),b=-4<=g&&g<=-1?r.toPrecision(10+g):Math.abs(g)<=9?(u=(d=r)<0?12:11,(h=tt(d.toFixed(12))).length<=u||(h=d.toPrecision(10)).length<=u?h:d.toExponential(5)):g===10?r.toFixed(10).substr(0,12):(b=tt((r=r).toFixed(11))).length>(r<0?12:11)||b==="0"||b==="-0"?r.toPrecision(6):b;return tt((b=b.toUpperCase()).indexOf("E")==-1?b:b.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function Ve(r,d){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(0|r)===r?r.toString(10):Qe(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Ir(14,xe(r,d&&d.date1904),d)}throw new Error("unsupported value in General format: "+r)}function xt(r){if(r.length<=3)return r;for(var d=r.length%3,u=r.substr(0,d);d!=r.length;d+=3)u+=(0<u.length?",":"")+r.substr(d,3);return u}var nt=/%/g,$t=/# (\?+)( ?)\/( ?)(\d+)/,Mt=/^#*0*\.([0#]+)/,Es=/\).*[0#]/,qs=/\(###\) ###\\?-####/;function ms(r){for(var d,u="",h=0;h!=r.length;++h)switch(d=r.charCodeAt(h)){case 35:break;case 63:u+=" ";break;case 48:u+="0";break;default:u+=String.fromCharCode(d)}return u}function ys(r,d){return d=Math.pow(10,d),""+Math.round(r*d)/d}function Re(h,d){var u=h-Math.floor(h),h=Math.pow(10,d);return d<(""+Math.round(u*h)).length?0:Math.round(u*h)}function ht(r,d,u){if(r.charCodeAt(0)===40&&!d.match(Es)){var h=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?ht("n",h,u):"("+ht("n",h,-u)+")"}if(d.charCodeAt(d.length-1)===44)return(function(z,Z,ae){for(var ie=Z.length-1;Z.charCodeAt(ie-1)===44;)--ie;return Is(z,Z.substr(0,ie),ae/Math.pow(10,3*(Z.length-ie)))})(r,d,u);if(d.indexOf("%")!==-1)return y=r,k=u,j=(E=d).replace(nt,""),E=E.length-j.length,Is(y,j,k*Math.pow(10,2*E))+lr("%",E);var g;if(d.indexOf("E")!==-1)return(function z(Z,ae){var ie,Ee=Z.indexOf("E")-Z.indexOf(".")-1;if(Z.match(/^#+0.0E\+0$/)){if(ae==0)return"0.0E+0";if(ae<0)return"-"+z(Z,-ae);var We=Z.indexOf(".");We===-1&&(We=Z.indexOf("E"));var Ie=Math.floor(Math.log(ae)*Math.LOG10E)%We;if(Ie<0&&(Ie+=We),(ie=(ae/Math.pow(10,Ie)).toPrecision(1+Ee+(We+Ie)%We)).indexOf("e")===-1){var Je=Math.floor(Math.log(ae)*Math.LOG10E);for(ie.indexOf(".")===-1?ie=ie.charAt(0)+"."+ie.substr(1)+"E+"+(Je-ie.length+Ie):ie+="E+"+(Je-Ie);ie.substr(0,2)==="0.";)ie=(ie=ie.charAt(0)+ie.substr(2,We)+"."+ie.substr(2+We)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");ie=ie.replace(/\+-/,"-")}ie=ie.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(bt,yt,it,St){return yt+it+St.substr(0,(We+Ie)%We)+"."+St.substr(Ie)+"E"})}else ie=ae.toExponential(Ee);return Z.match(/E\+00$/)&&ie.match(/e[+-]\d$/)&&(ie=ie.substr(0,ie.length-1)+"0"+ie.charAt(ie.length-1)),(ie=Z.match(/E\-/)&&ie.match(/e\+/)?ie.replace(/e\+/,"e"):ie).replace("e","E")})(d,u);if(d.charCodeAt(0)===36)return"$"+ht(r,d.substr(d.charAt(1)==" "?2:1),u);var b,x,y,j,k,E,T,_=Math.abs(u),R=u<0?"-":"";if(d.match(/^00+$/))return R+V(_,d.length);if(d.match(/^[#?]+$/))return(g=(g=V(u,0))==="0"?"":g).length>d.length?g:ms(d.substr(0,d.length-g.length))+g;if(b=d.match($t))return T=b,y=_,j=R,k=parseInt(T[4],10),E=Math.round(y*k),y=Math.floor(E/k),j+(y===0?"":""+y)+" "+((E-=y*k)==0?lr(" ",T[1].length+1+T[4].length):Ye(E,T[1].length)+T[2]+"/"+T[3]+Se(k,T[4].length));if(d.match(/^#+0+$/))return R+V(_,d.length-d.indexOf("0"));if(b=d.match(Mt))return g=ys(u,b[1].length).replace(/^([^\.]+)$/,"$1."+ms(b[1])).replace(/\.$/,"."+ms(b[1])).replace(/\.(\d*)$/,function(z,Z){return"."+Z+lr("0",ms(b[1]).length-Z.length)}),d.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(d=d.replace(/^#+([0.])/,"$1"),b=d.match(/^(0*)\.(#*)$/))return R+ys(_,b[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,b[1].length?"0.":".");if(b=d.match(/^#{1,3},##0(\.?)$/))return R+xt(V(_,0));if(b=d.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+ht(r,d,-u):xt(""+(Math.floor(u)+(T=u,(q=b[1].length)<(""+Math.round((T-Math.floor(T))*Math.pow(10,q))).length?1:0)))+"."+Se(Re(u,b[1].length),b[1].length);if(b=d.match(/^#,#*,#0/))return ht(r,d.replace(/^#,#*,/,""),u);if(b=d.match(/^([0#]+)(\\?-([0#]+))+$/))return g=fe(ht(r,d.replace(/[\\-]/g,""),u)),x=0,fe(fe(d.replace(/\\/g,"")).replace(/[0#]/g,function(z){return x<g.length?g.charAt(x++):z==="0"?"0":""}));if(d.match(qs))return"("+(g=ht(r,"##########",u)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var q="";if(b=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(b[4].length,7),I=je(_,Math.pow(10,x)-1,!1),g=R,(q=Is("n",b[1],I[1])).charAt(q.length-1)==" "&&(q=q.substr(0,q.length-1)+"0"),g+=q+b[2]+"/"+b[3],(q=te(I[2],x)).length<b[4].length&&(q=ms(b[4].substr(b[4].length-q.length))+q),g+=q;if(b=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(Math.max(b[1].length,b[4].length),7),R+((I=je(_,Math.pow(10,x)-1,!0))[0]||(I[1]?"":"0"))+" "+(I[1]?Ye(I[1],x)+b[2]+"/"+b[3]+te(I[2],x):lr(" ",2*x+1+b[2].length+b[3].length));if(b=d.match(/^[#0?]+$/))return g=V(u,0),d.length<=g.length?g:ms(d.substr(0,d.length-g.length))+g;if(b=d.match(/^([#0?]+)\.([#0]+)$/)){g=""+u.toFixed(Math.min(b[2].length,10)).replace(/([^0])0+$/,"$1"),x=g.indexOf(".");var I=d.indexOf(".")-x,ee=d.length-g.length-I;return ms(d.substr(0,I)+g+d.substr(d.length-ee))}if(b=d.match(/^00,000\.([#0]*0)$/))return x=Re(u,b[1].length),u<0?"-"+ht(r,d,-u):xt((ee=u)<2147483647&&-2147483648<ee?""+(0<=ee?0|ee:ee-1|0):""+Math.floor(ee)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(z){return"00,"+(z.length<3?Se(0,3-z.length):"")+z})+"."+Se(x,b[1].length);switch(d){case"###,##0.00":return ht(r,"#,##0.00",u);case"###,###":case"##,###":case"#,###":var Y=xt(V(_,0));return Y!=="0"?R+Y:"";case"###,###.00":return ht(r,"###,##0.00",u).replace(/^0\./,".");case"#,###.00":return ht(r,"#,##0.00",u).replace(/^0\./,".")}throw new Error("unsupported format |"+d+"|")}function Ft(r,d,u){if(r.charCodeAt(0)===40&&!d.match(Es)){var h=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?Ft("n",h,u):"("+Ft("n",h,-u)+")"}if(d.charCodeAt(d.length-1)===44)return(function(I,ee,Y){for(var z=ee.length-1;ee.charCodeAt(z-1)===44;)--z;return Is(I,ee.substr(0,z),Y/Math.pow(10,3*(ee.length-z)))})(r,d,u);if(d.indexOf("%")!==-1)return g=r,x=u,h=(b=d).replace(nt,""),b=b.length-h.length,Is(g,h,x*Math.pow(10,2*b))+lr("%",b);var g,b,x,y;if(d.indexOf("E")!==-1)return(function I(ee,Y){var z,Z=ee.indexOf("E")-ee.indexOf(".")-1;if(ee.match(/^#+0.0E\+0$/)){if(Y==0)return"0.0E+0";if(Y<0)return"-"+I(ee,-Y);var ae=ee.indexOf(".");ae===-1&&(ae=ee.indexOf("E"));var ie,Ee=Math.floor(Math.log(Y)*Math.LOG10E)%ae;Ee<0&&(Ee+=ae),(z=(Y/Math.pow(10,Ee)).toPrecision(1+Z+(ae+Ee)%ae)).match(/[Ee]/)||(ie=Math.floor(Math.log(Y)*Math.LOG10E),z.indexOf(".")===-1?z=z.charAt(0)+"."+z.substr(1)+"E+"+(ie-z.length+Ee):z+="E+"+(ie-Ee),z=z.replace(/\+-/,"-")),z=z.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(We,Ie,Je,bt){return Ie+Je+bt.substr(0,(ae+Ee)%ae)+"."+bt.substr(Ee)+"E"})}else z=Y.toExponential(Z);return ee.match(/E\+00$/)&&z.match(/e[+-]\d$/)&&(z=z.substr(0,z.length-1)+"0"+z.charAt(z.length-1)),(z=ee.match(/E\-/)&&z.match(/e\+/)?z.replace(/e\+/,"e"):z).replace("e","E")})(d,u);if(d.charCodeAt(0)===36)return"$"+Ft(r,d.substr(d.charAt(1)==" "?2:1),u);var j,k,E=Math.abs(u),T=u<0?"-":"";if(d.match(/^00+$/))return T+Se(E,d.length);if(d.match(/^[#?]+$/))return(y=u===0?"":""+u).length>d.length?y:ms(d.substr(0,d.length-y.length))+y;if(j=d.match($t))return T+((_=E)===0?"":""+_)+lr(" ",(_=j)[1].length+2+_[4].length);if(d.match(/^#+0+$/))return T+Se(E,d.length-d.indexOf("0"));if(j=d.match(Mt))return y=(y=(""+u).replace(/^([^\.]+)$/,"$1."+ms(j[1])).replace(/\.$/,"."+ms(j[1]))).replace(/\.(\d*)$/,function(I,ee){return"."+ee+lr("0",ms(j[1]).length-ee.length)}),d.indexOf("0.")!==-1?y:y.replace(/^0\./,".");if(d=d.replace(/^#+([0.])/,"$1"),j=d.match(/^(0*)\.(#*)$/))return T+(""+E).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,j[1].length?"0.":".");if(j=d.match(/^#{1,3},##0(\.?)$/))return T+xt(""+E);if(j=d.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+Ft(r,d,-u):xt(""+u)+"."+lr("0",j[1].length);if(j=d.match(/^#,#*,#0/))return Ft(r,d.replace(/^#,#*,/,""),u);if(j=d.match(/^([0#]+)(\\?-([0#]+))+$/))return y=fe(Ft(r,d.replace(/[\\-]/g,""),u)),k=0,fe(fe(d.replace(/\\/g,"")).replace(/[0#]/g,function(I){return k<y.length?y.charAt(k++):I==="0"?"0":""}));if(d.match(qs))return"("+(y=Ft(r,"##########",u)).substr(0,3)+") "+y.substr(3,3)+"-"+y.substr(6);var _="";if(j=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(j[4].length,7),R=je(E,Math.pow(10,k)-1,!1),y=T,(_=Is("n",j[1],R[1])).charAt(_.length-1)==" "&&(_=_.substr(0,_.length-1)+"0"),y+=_+j[2]+"/"+j[3],(_=te(R[2],k)).length<j[4].length&&(_=ms(j[4].substr(j[4].length-_.length))+_),y+=_;if(j=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(j[1].length,j[4].length),7),T+((R=je(E,Math.pow(10,k)-1,!0))[0]||(R[1]?"":"0"))+" "+(R[1]?Ye(R[1],k)+j[2]+"/"+j[3]+te(R[2],k):lr(" ",2*k+1+j[2].length+j[3].length));if(j=d.match(/^[#0?]+$/))return y=""+u,d.length<=y.length?y:ms(d.substr(0,d.length-y.length))+y;if(j=d.match(/^([#0]+)\.([#0]+)$/)){y=""+u.toFixed(Math.min(j[2].length,10)).replace(/([^0])0+$/,"$1"),k=y.indexOf(".");var _=d.indexOf(".")-k,R=d.length-y.length-_;return ms(d.substr(0,_)+y+d.substr(d.length-R))}if(j=d.match(/^00,000\.([#0]*0)$/))return u<0?"-"+Ft(r,d,-u):xt(""+u).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(I){return"00,"+(I.length<3?Se(0,3-I.length):"")+I})+"."+Se(0,j[1].length);switch(d){case"###,###":case"##,###":case"#,###":var q=xt(""+E);return q!=="0"?T+q:"";default:if(d.match(/\.[0#?]*$/))return Ft(r,d.slice(0,d.lastIndexOf(".")),u)+ms(d.slice(d.lastIndexOf(".")))}throw new Error("unsupported format |"+d+"|")}function Is(r,d,u){return((0|u)===u?Ft:ht)(r,d,u)}var jr=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function $r(r){for(var d=0,u="",h="";d<r.length;)switch(u=r.charAt(d)){case"G":be(r,d)&&(d+=6),d++;break;case'"':for(;r.charCodeAt(++d)!==34&&d<r.length;);++d;break;case"\\":case"_":d+=2;break;case"@":++d;break;case"B":case"b":if(r.charAt(d+1)==="1"||r.charAt(d+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(d,3).toUpperCase()==="A/P"||r.substr(d,5).toUpperCase()==="AM/PM"||r.substr(d,5).toUpperCase()==="/")return!0;++d;break;case"[":for(h=u;r.charAt(d++)!=="]"&&d<r.length;)h+=r.charAt(d);if(h.match(jr))return!0;break;case".":case"0":case"#":for(;d<r.length&&(-1<"0#?.,E+-%".indexOf(u=r.charAt(++d))||u=="\\"&&r.charAt(d+1)=="-"&&-1<"0#".indexOf(r.charAt(d+2))););break;case"?":for(;r.charAt(++d)===u;);break;case"*":++d,r.charAt(d)!=" "&&r.charAt(d)!="*"||++d;break;case"(":case")":++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;d<r.length&&-1<"0123456789".indexOf(r.charAt(++d)););break;default:++d}return!1}function Za(r,d,u,h){for(var g,b,x,y=[],j="",k=0,E="",T="t",_="H";k<r.length;)switch(E=r.charAt(k)){case"G":if(!be(r,k))throw new Error("unrecognized character "+E+" in "+r);y[y.length]={t:"G",v:"General"},k+=7;break;case'"':for(j="";(x=r.charCodeAt(++k))!==34&&k<r.length;)j+=String.fromCharCode(x);y[y.length]={t:"t",v:j},++k;break;case"\\":var R=r.charAt(++k),q=R==="("||R===")"?R:"t";y[y.length]={t:q,v:R},++k;break;case"_":y[y.length]={t:"t",v:" "},k+=2;break;case"@":y[y.length]={t:"T",v:d},++k;break;case"B":case"b":if(r.charAt(k+1)==="1"||r.charAt(k+1)==="2"){if(g==null&&(g=Q(d,u,r.charAt(k+1)==="2"))==null)return"";y[y.length]={t:"X",v:r.substr(k,2)},T=E,k+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":E=E.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(d<0||g==null&&(g=Q(d,u))==null)return"";for(j=E;++k<r.length&&r.charAt(k).toLowerCase()===E;)j+=E;(E=E==="m"&&T.toLowerCase()==="h"?"M":E)==="h"&&(E=_),y[y.length]={t:E,v:j},T=E;break;case"A":case"a":case"":if(R={t:E,v:E},g==null&&(g=Q(d,u)),r.substr(k,3).toUpperCase()==="A/P"?(g!=null&&(R.v=12<=g.H?"P":"A"),R.t="T",_="h",k+=3):r.substr(k,5).toUpperCase()==="AM/PM"?(g!=null&&(R.v=12<=g.H?"PM":"AM"),R.t="T",k+=5,_="h"):r.substr(k,5).toUpperCase()==="/"?(g!=null&&(R.v=12<=g.H?"":""),R.t="T",k+=5,_="h"):(R.t="t",++k),g==null&&R.t==="T")return"";y[y.length]=R,T=E;break;case"[":for(j=E;r.charAt(k++)!=="]"&&k<r.length;)j+=r.charAt(k);if(j.slice(-1)!=="]")throw'unterminated "[" block: |'+j+"|";if(j.match(jr)){if(g==null&&(g=Q(d,u))==null)return"";y[y.length]={t:"Z",v:j.toLowerCase()},T=j.charAt(1)}else-1<j.indexOf("$")&&(j=(j.match(/\$([^-\[\]]*)/)||[])[1]||"$",$r(r)||(y[y.length]={t:"t",v:j}));break;case".":if(g!=null){for(j=E;++k<r.length&&(E=r.charAt(k))==="0";)j+=E;y[y.length]={t:"s",v:j};break}case"0":case"#":for(j=E;++k<r.length&&-1<"0#?.,E+-%".indexOf(E=r.charAt(k));)j+=E;y[y.length]={t:"n",v:j};break;case"?":for(j=E;r.charAt(++k)===E;)j+=E;y[y.length]={t:E,v:j},T=E;break;case"*":++k,r.charAt(k)!=" "&&r.charAt(k)!="*"||++k;break;case"(":case")":y[y.length]={t:h===1?"t":E,v:E},++k;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(j=E;k<r.length&&-1<"0123456789".indexOf(r.charAt(++k));)j+=r.charAt(k);y[y.length]={t:"D",v:j};break;case" ":y[y.length]={t:E,v:E},++k;break;case"$":y[y.length]={t:"t",v:"$"},++k;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(E)===-1)throw new Error("unrecognized character "+E+" in "+r);y[y.length]={t:"t",v:E},++k}var I,ee=0,Y=0;for(k=y.length-1,T="t";0<=k;--k)switch(y[k].t){case"h":case"H":y[k].t=_,T="h",ee<1&&(ee=1);break;case"s":(I=y[k].v.match(/\.0+$/))&&(Y=Math.max(Y,I[0].length-1)),ee<3&&(ee=3);case"d":case"y":case"M":case"e":T=y[k].t;break;case"m":T==="s"&&(y[k].t="M",ee<2&&(ee=2));break;case"X":break;case"Z":(ee=(ee=ee<1&&y[k].v.match(/[Hh]/)?1:ee)<2&&y[k].v.match(/[Mm]/)?2:ee)<3&&y[k].v.match(/[Ss]/)&&(ee=3)}switch(ee){case 0:break;case 1:.5<=g.u&&(g.u=0,++g.S),60<=g.S&&(g.S=0,++g.M),60<=g.M&&(g.M=0,++g.H);break;case 2:.5<=g.u&&(g.u=0,++g.S),60<=g.S&&(g.S=0,++g.M)}var z,Z="";for(k=0;k<y.length;++k)switch(y[k].t){case"t":case"T":case" ":case"D":break;case"X":y[k].v="",y[k].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":y[k].v=(function(bt,yt,it,St){var Ht,zt="",Lt=0,Ot=0,Tt=it.y,jt=0;switch(bt){case 98:Tt=it.y+543;case 121:switch(yt.length){case 1:case 2:Ht=Tt%100,jt=2;break;default:Ht=Tt%1e4,jt=4}break;case 109:switch(yt.length){case 1:case 2:Ht=it.m,jt=yt.length;break;case 3:return De[it.m-1][1];case 5:return De[it.m-1][0];default:return De[it.m-1][2]}break;case 100:switch(yt.length){case 1:case 2:Ht=it.d,jt=yt.length;break;case 3:return _e[it.q][0];default:return _e[it.q][1]}break;case 104:switch(yt.length){case 1:case 2:Ht=1+(it.H+11)%12,jt=yt.length;break;default:throw"bad hour format: "+yt}break;case 72:switch(yt.length){case 1:case 2:Ht=it.H,jt=yt.length;break;default:throw"bad hour format: "+yt}break;case 77:switch(yt.length){case 1:case 2:Ht=it.M,jt=yt.length;break;default:throw"bad minute format: "+yt}break;case 115:if(yt!="s"&&yt!="ss"&&yt!=".0"&&yt!=".00"&&yt!=".000")throw"bad second format: "+yt;return it.u!==0||yt!="s"&&yt!="ss"?(60*(Ot=2<=St?St===3?1e3:100:St===1?10:1)<=(Lt=Math.round(Ot*(it.S+it.u)))&&(Lt=0),yt==="s"?Lt===0?"0":""+Lt/Ot:(zt=Se(Lt,2+St),yt==="ss"?zt.substr(0,2):"."+zt.substr(2,yt.length-1))):Se(it.S,yt.length);case 90:switch(yt){case"[h]":case"[hh]":Ht=24*it.D+it.H;break;case"[m]":case"[mm]":Ht=60*(24*it.D+it.H)+it.M;break;case"[s]":case"[ss]":Ht=60*(60*(24*it.D+it.H)+it.M)+Math.round(it.S+it.u);break;default:throw"bad abstime format: "+yt}jt=yt.length===3?1:2;break;case 101:Ht=Tt,jt=1}return 0<jt?Se(Ht,jt):""})(y[k].t.charCodeAt(0),y[k].v,g,Y),y[k].t="t";break;case"n":case"?":for(z=k+1;y[z]!=null&&((E=y[z].t)==="?"||E==="D"||(E===" "||E==="t")&&y[z+1]!=null&&(y[z+1].t==="?"||y[z+1].t==="t"&&y[z+1].v==="/")||y[k].t==="("&&(E===" "||E==="n"||E===")")||E==="t"&&(y[z].v==="/"||y[z].v===" "&&y[z+1]!=null&&y[z+1].t=="?"));)y[k].v+=y[z].v,y[z]={v:"",t:";"},++z;Z+=y[k].v,k=z-1;break;case"G":y[k].t="t",y[k].v=Ve(d,u)}var ae,ie,Ee="";if(0<Z.length){Z.charCodeAt(0)==40?(ae=d<0&&Z.charCodeAt(0)===45?-d:d,ie=Is("n",Z,ae)):(ie=Is("n",Z,ae=d<0&&1<h?-d:d),ae<0&&y[0]&&y[0].t=="t"&&(ie=ie.substr(1),y[0].v="-"+y[0].v)),z=ie.length-1;for(var We=y.length,k=0;k<y.length;++k)if(y[k]!=null&&y[k].t!="t"&&-1<y[k].v.indexOf(".")){We=k;break}var Ie=y.length;if(We===y.length&&ie.indexOf("E")===-1){for(k=y.length-1;0<=k;--k)y[k]!=null&&"n?".indexOf(y[k].t)!==-1&&(z>=y[k].v.length-1?(z-=y[k].v.length,y[k].v=ie.substr(z+1,y[k].v.length)):z<0?y[k].v="":(y[k].v=ie.substr(0,z+1),z=-1),y[k].t="t",Ie=k);0<=z&&Ie<y.length&&(y[Ie].v=ie.substr(0,z+1)+y[Ie].v)}else if(We!==y.length&&ie.indexOf("E")===-1){for(z=ie.indexOf(".")-1,k=We;0<=k;--k)if(y[k]!=null&&"n?".indexOf(y[k].t)!==-1){for(b=-1<y[k].v.indexOf(".")&&k===We?y[k].v.indexOf(".")-1:y[k].v.length-1,Ee=y[k].v.substr(b+1);0<=b;--b)0<=z&&(y[k].v.charAt(b)==="0"||y[k].v.charAt(b)==="#")&&(Ee=ie.charAt(z--)+Ee);y[k].v=Ee,y[k].t="t",Ie=k}for(0<=z&&Ie<y.length&&(y[Ie].v=ie.substr(0,z+1)+y[Ie].v),z=ie.indexOf(".")+1,k=We;k<y.length;++k)if(y[k]!=null&&("n?(".indexOf(y[k].t)!==-1||k===We)){for(b=-1<y[k].v.indexOf(".")&&k===We?y[k].v.indexOf(".")+1:0,Ee=y[k].v.substr(0,b);b<y[k].v.length;++b)z<ie.length&&(Ee+=ie.charAt(z++));y[k].v=Ee,y[k].t="t",Ie=k}}}for(k=0;k<y.length;++k)y[k]!=null&&-1<"n?".indexOf(y[k].t)&&(ae=1<h&&d<0&&0<k&&y[k-1].v==="-"?-d:d,y[k].v=Is(y[k].t,y[k].v,ae),y[k].t="t");var Je="";for(k=0;k!==y.length;++k)y[k]!=null&&(Je+=y[k].v);return Je}var ul=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ka(r,d){if(d!=null){var u=parseFloat(d[2]);switch(d[1]){case"=":if(r==u)return 1;break;case">":if(u<r)return 1;break;case"<":if(r<u)return 1;break;case"<>":if(r!=u)return 1;break;case">=":if(u<=r)return 1;break;case"<=":if(r<=u)return 1}}}function ma(r,d){var u=(function(x){for(var y=[],j=!1,k=0,E=0;k<x.length;++k)switch(x.charCodeAt(k)){case 34:j=!j;break;case 95:case 42:case 92:++k;break;case 59:y[y.length]=x.substr(E,k-E),E=k+1}if(y[y.length]=x.substr(E),j===!0)throw new Error("Format |"+x+"| unterminated string ");return y})(r),h=u.length,g=u[h-1].indexOf("@");if(h<4&&-1<g&&--h,4<u.length)throw new Error("cannot find right format for |"+u.join("|")+"|");if(typeof d!="number")return[4,u.length===4||-1<g?u[u.length-1]:"@"];switch(u.length){case 1:u=-1<g?["General","General","General",u[0]]:[u[0],u[0],u[0],"@"];break;case 2:u=-1<g?[u[0],u[0],u[0],u[1]]:[u[0],u[1],u[0],"@"];break;case 3:u=-1<g?[u[0],u[1],u[0],u[2]]:[u[0],u[1],u[2],"@"]}var b=0<d?u[0]:d<0?u[1]:u[2];return u[0].indexOf("[")===-1&&u[1].indexOf("[")===-1?[h,b]:u[0].match(/\[[=<>]/)==null&&u[1].match(/\[[=<>]/)==null?[h,b]:(r=u[0].match(ul),b=u[1].match(ul),ka(d,r)?[h,u[0]]:ka(d,b)?[h,u[1]]:[h,u[r!=null&&b!=null?2:1]])}function Ir(r,d,u){u==null&&(u={});var h="";switch(typeof r){case"string":h=r=="m/d/yy"&&u.dateNF?u.dateNF:r;break;case"number":(h=(h=r==14&&u.dateNF?u.dateNF:(u.table!=null?u.table:W)[r])==null?u.table&&u.table[H[r]]||W[H[r]]:h)==null&&(h=X[r]||"General")}if(be(h,0))return Ve(d,u);var g=ma(h,d=d instanceof Date?xe(d,u.date1904):d);if(be(g[1]))return Ve(d,u);if(d===!0)d="TRUE";else if(d===!1)d="FALSE";else if(d===""||d==null)return"";return Za(g[1],d,u,g[0])}function xr(r,d){if(typeof d!="number"){d=+d||-1;for(var u=0;u<392;++u)if(W[u]!=null){if(W[u]==r){d=u;break}}else d<0&&(d=u);d<0&&(d=391)}return W[d]=r,d}function Io(r){for(var d=0;d!=392;++d)r[d]!==void 0&&xr(r[d],d)}function Hl(){var r;(r=r||{})[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',W=r}var nh={format:Ir,load:xr,_table:W,load_table:Io,parse_date_code:Q,is_date:$r,get_table:function(){return nh._table=W}},qc={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Vl=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,Ua,Yn=(function(){var r={};r.version="1.2.0";var d=(function(){for(var z=0,Z=new Array(256),ae=0;ae!=256;++ae)z=1&(z=1&(z=1&(z=1&(z=1&(z=1&(z=1&(z=1&(z=ae)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1,Z[ae]=z;return typeof Int32Array<"u"?new Int32Array(Z):Z})(),u=(function(z){for(var Z=0,ae=0,Ee=0,ie=new(typeof Int32Array<"u"?Int32Array:Array)(4096),Ee=0;Ee!=256;++Ee)ie[Ee]=z[Ee];for(Ee=0;Ee!=256;++Ee)for(ae=z[Ee],Z=256+Ee;Z<4096;Z+=256)ae=ie[Z]=ae>>>8^z[255&ae];var We=[];for(Ee=1;Ee!=16;++Ee)We[Ee-1]=typeof Int32Array<"u"?ie.subarray(256*Ee,256*Ee+256):ie.slice(256*Ee,256*Ee+256);return We})(d),h=u[0],g=u[1],b=u[2],x=u[3],y=u[4],j=u[5],k=u[6],E=u[7],T=u[8],_=u[9],R=u[10],q=u[11],I=u[12],ee=u[13],Y=u[14];return r.table=d,r.bstr=function(z,Z){for(var ae=-1^Z,ie=0,Ee=z.length;ie<Ee;)ae=ae>>>8^d[255&(ae^z.charCodeAt(ie++))];return~ae},r.buf=function(z,Z){for(var ae=-1^Z,ie=z.length-15,Ee=0;Ee<ie;)ae=Y[z[Ee++]^255&ae]^ee[z[Ee++]^ae>>8&255]^I[z[Ee++]^ae>>16&255]^q[z[Ee++]^ae>>>24]^R[z[Ee++]]^_[z[Ee++]]^T[z[Ee++]]^E[z[Ee++]]^k[z[Ee++]]^j[z[Ee++]]^y[z[Ee++]]^x[z[Ee++]]^b[z[Ee++]]^g[z[Ee++]]^h[z[Ee++]]^d[z[Ee++]];for(ie+=15;Ee<ie;)ae=ae>>>8^d[255&(ae^z[Ee++])];return~ae},r.str=function(z,Z){for(var ae,ie=-1^Z,Ee=0,We=z.length,Ie=0;Ee<We;)ie=(Ie=z.charCodeAt(Ee++))<128?ie>>>8^d[255&(ie^Ie)]:Ie<2048?(ie=ie>>>8^d[255&(ie^(192|Ie>>6&31))])>>>8^d[255&(ie^(128|63&Ie))]:55296<=Ie&&Ie<57344?(Ie=64+(1023&Ie),ae=1023&z.charCodeAt(Ee++),(ie=(ie=(ie=ie>>>8^d[255&(ie^(240|Ie>>8&7))])>>>8^d[255&(ie^(128|Ie>>2&63))])>>>8^d[255&(ie^(128|ae>>6&15|(3&Ie)<<4))])>>>8^d[255&(ie^(128|63&ae))]):(ie=(ie=ie>>>8^d[255&(ie^(224|Ie>>12&15))])>>>8^d[255&(ie^(128|Ie>>6&63))])>>>8^d[255&(ie^(128|63&Ie))];return~ie},r})(),es=(function(){var r,d={};function u(he){if(he.charAt(he.length-1)=="/")return he.slice(0,-1).indexOf("/")===-1?he:u(he.slice(0,-1));var ot=he.lastIndexOf("/");return ot===-1?he:he.slice(0,ot+1)}function h(he){if(he.charAt(he.length-1)=="/")return h(he.slice(0,-1));var ot=he.lastIndexOf("/");return ot===-1?he:he.slice(ot+1)}function g(he){Sa(he,0);for(var ot,Te={};he.l<=he.length-4;){var at=he.read_shift(2),Ae=he.read_shift(2),kt=he.l+Ae,Ze={};at===21589&&(1&(ot=he.read_shift(1))&&(Ze.mtime=he.read_shift(4)),5<Ae&&(2&ot&&(Ze.atime=he.read_shift(4)),4&ot&&(Ze.ctime=he.read_shift(4))),Ze.mtime&&(Ze.mt=new Date(1e3*Ze.mtime))),he.l=kt,Te[at]=Ze}return Te}function b(){return r=r||I1}function x(he,ot){if(he[0]==80&&he[1]==75)return $s(he,ot);if((32|he[0])==109&&(32|he[1])==105)return(function(Dt,rs){if(z(Dt.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Wt=rs&&rs.root||"",_t=(ge&&Buffer.isBuffer(Dt)?Dt.toString("binary"):z(Dt)).split(`\r
`),os=0,as="";for(os=0;os<_t.length;++os)if(as=_t[os],/^Content-Location:/i.test(as)&&(as=as.slice(as.indexOf("file")),Wt=Wt||as.slice(0,as.lastIndexOf("/")+1),as.slice(0,Wt.length)!=Wt))for(;0<Wt.length&&(Wt=(Wt=Wt.slice(0,Wt.length-1)).slice(0,Wt.lastIndexOf("/")+1),as.slice(0,Wt.length)!=Wt););if(Dt=(_t[1]||"").match(/boundary="(.*?)"/),!Dt)throw new Error("MAD cannot find boundary");var gr="--"+(Dt[1]||""),cs={FileIndex:[],FullPaths:[]};j(cs);var Ns,Jt=0;for(os=0;os<_t.length;++os){var zs=_t[os];zs!==gr&&zs!==gr+"--"||(Jt++&&(function(Ms,i,c){for(var f,p="",C="",A="",U=0;U<10;++U){var re=i[U];if(!re||re.match(/^\s*$/))break;var ve=re.match(/^(.*?):\s*([^\s].*)$/);if(ve)switch(ve[1].toLowerCase()){case"content-location":p=ve[2].trim();break;case"content-type":A=ve[2].trim();break;case"content-transfer-encoding":C=ve[2].trim()}}switch(++U,C.toLowerCase()){case"base64":f=le(Ce(i.slice(U).join("")));break;case"quoted-printable":f=(function(qe){for(var ft=[],gt=0;gt<qe.length;++gt){for(var et=qe[gt];gt<=qe.length&&et.charAt(et.length-1)=="=";)et=et.slice(0,et.length-1)+qe[++gt];ft.push(et)}for(var ct=0;ct<ft.length;++ct)ft[ct]=ft[ct].replace(/[=][0-9A-Fa-f]{2}/g,function(Zt){return String.fromCharCode(parseInt(Zt.slice(1),16))});return le(ft.join(`\r
`))})(i.slice(U));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+C)}c=Un(Ms,p.slice(c.length),f,{unsafe:!0}),A&&(c.ctype=A)})(cs,_t.slice(Ns,os),Wt),Ns=os)}return cs})(he,ot);if(he.length<512)throw new Error("CFB file size "+he.length+" < 512");var Te,at,Ae,kt=3,Ze=512,Pt=0,dt=[],Ge=he.slice(0,512);Sa(Ge,0);var mt=(function(Dt){if(Dt[Dt.l]==80&&Dt[Dt.l+1]==75)return[0,0];Dt.chk(q,"Header Signature: "),Dt.l+=16;var rs=Dt.read_shift(2,"u");return[Dt.read_shift(2,"u"),rs]})(Ge);switch(kt=mt[0]){case 3:Ze=512;break;case 4:Ze=4096;break;case 0:if(mt[1]==0)return $s(he,ot);default:throw new Error("Major Version: Expected 3 or 4 saw "+kt)}Ze!==512&&Sa(Ge=he.slice(0,Ze),28);var Et=he.slice(0,Ze);(function(Dt,rs){var Wt=9;switch(Dt.l+=2,Wt=Dt.read_shift(2)){case 9:if(rs!=3)throw new Error("Sector Shift: Expected 9 saw "+Wt);break;case 12:if(rs!=4)throw new Error("Sector Shift: Expected 12 saw "+Wt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Wt)}Dt.chk("0600","Mini Sector Shift: "),Dt.chk("000000000000","Reserved: ")})(Ge,kt);var ss=Ge.read_shift(4,"i");if(kt===3&&ss!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ss);Ge.l+=4,at=Ge.read_shift(4,"i"),Ge.l+=4,Ge.chk("00100000","Mini Stream Cutoff Size: "),Ae=Ge.read_shift(4,"i"),Te=Ge.read_shift(4,"i"),ts=Ge.read_shift(4,"i"),Pt=Ge.read_shift(4,"i");for(var Kt,Yt=0;Yt<109&&!((Kt=Ge.read_shift(4,"i"))<0);++Yt)dt[Yt]=Kt;var Bt=(function(Dt,rs){for(var Wt=Math.ceil(Dt.length/rs)-1,_t=[],os=1;os<Wt;++os)_t[os-1]=Dt.slice(os*rs,(os+1)*rs);return _t[Wt-1]=Dt.slice(Wt*rs),_t})(he,Ze);(function Dt(rs,Wt,_t,os,as){var gr=R;if(rs===R){if(Wt!==0)throw new Error("DIFAT chain shorter than expected")}else if(rs!==-1){var cs=_t[rs],Ns=(os>>>2)-1;if(cs){for(var Jt=0;Jt<Ns&&(gr=Kl(cs,4*Jt))!==R;++Jt)as.push(gr);Dt(Kl(cs,os-4),Wt-1,_t,os,as)}}})(ts,Pt,Bt,Ze,dt);var Qt=(function(Dt,rs,Wt,_t){var os=Dt.length,as=[],gr=[],cs=[],Ns=[],Jt=_t-1,zs=0,Ms=0,i=0,c=0;for(zs=0;zs<os;++zs)if(cs=[],os<=(i=zs+rs)&&(i-=os),!gr[i]){Ns=[];var f=[];for(Ms=i;0<=Ms;){f[Ms]=!0,gr[Ms]=!0,cs[cs.length]=Ms,Ns.push(Dt[Ms]);var p=Wt[Math.floor(4*Ms/_t)];if(_t<4+(c=4*Ms&Jt))throw new Error("FAT boundary crossed: "+Ms+" 4 "+_t);if(!Dt[p]||(Ms=Kl(Dt[p],c),f[Ms]))break}as[i]={nodes:cs,data:jm([Ns])}}return as})(Bt,at,dt,Ze);Qt[at].name="!Directory",0<Te&&Ae!==R&&(Qt[Ae].name="!MiniFAT"),Qt[dt[0]].name="!FAT",Qt.fat_addrs=dt,Qt.ssz=Ze;var ss=[],ts=[],Pt=[];return(function(Dt,rs,Wt,_t,os,as,gr){for(var cs,Ns=0,Jt=Wt.length?2:0,zs=Dt[at].data,Ms=0,i=0;Ms<zs.length;Ms+=128){var c=zs.slice(Ms,Ms+128);Sa(c,64),i=c.read_shift(2),cs=f0(c,0,i-Jt),Wt.push(cs);var f={name:cs,type:c.read_shift(1),color:c.read_shift(1),L:c.read_shift(4,"i"),R:c.read_shift(4,"i"),C:c.read_shift(4,"i"),clsid:c.read_shift(16),state:c.read_shift(4,"i"),start:0,size:0};c.read_shift(2)+c.read_shift(2)+c.read_shift(2)+c.read_shift(2)!==0&&(f.ct=y(c,c.l-8)),c.read_shift(2)+c.read_shift(2)+c.read_shift(2)+c.read_shift(2)!==0&&(f.mt=y(c,c.l-8)),f.start=c.read_shift(4,"i"),f.size=c.read_shift(4,"i"),f.size<0&&f.start<0&&(f.size=f.type=0,f.start=R,f.name=""),f.type===5?(Ns=f.start,0<_t&&Ns!==R&&(Dt[Ns].name="!StreamData")):4096<=f.size?(f.storage="fat",Dt[f.start]===void 0&&(Dt[f.start]=(function(p,C,A,U,re){var ve=[],qe=[];re=re||[];var ft=U-1,gt=0,et=0;for(gt=C;0<=gt;){re[gt]=!0,ve[ve.length]=gt,qe.push(p[gt]);var ct=A[Math.floor(4*gt/U)];if(U<4+(et=4*gt&ft))throw new Error("FAT boundary crossed: "+gt+" 4 "+U);if(!p[ct])break;gt=Kl(p[ct],et)}return{nodes:ve,data:jm([qe])}})(rs,f.start,Dt.fat_addrs,Dt.ssz)),Dt[f.start].name=f.name,f.content=Dt[f.start].data.slice(0,f.size)):(f.storage="minifat",f.size<0?f.size=0:Ns!==R&&f.start!==R&&Dt[Ns]&&(f.content=(function(p,C,A){for(var U=p.start,re=p.size,ve=[],qe=U;A&&0<re&&0<=qe;)ve.push(C.slice(qe*_,qe*_+_)),re-=_,qe=Kl(A,4*qe);return ve.length===0?pt(0):ce(ve).slice(0,p.size)})(f,Dt[Ns].data,(Dt[gr]||{}).data))),f.content&&Sa(f.content,0),os[cs]=f,as.push(f)}})(Qt,Bt,ss,Te,{},ts,Ae),(function(Dt,rs,Wt){for(var _t=0,os=0,as=0,gr=0,cs=0,Ns=Wt.length,Jt=[],zs=[];_t<Ns;++_t)Jt[_t]=zs[_t]=_t,rs[_t]=Wt[_t];for(;cs<zs.length;++cs)_t=zs[cs],os=Dt[_t].L,as=Dt[_t].R,gr=Dt[_t].C,Jt[_t]===_t&&(os!==-1&&Jt[os]!==os&&(Jt[_t]=Jt[os]),as!==-1&&Jt[as]!==as&&(Jt[_t]=Jt[as])),gr!==-1&&(Jt[gr]=_t),os!==-1&&_t!=Jt[_t]&&(Jt[os]=Jt[_t],zs.lastIndexOf(os)<cs&&zs.push(os)),as!==-1&&_t!=Jt[_t]&&(Jt[as]=Jt[_t],zs.lastIndexOf(as)<cs&&zs.push(as));for(_t=1;_t<Ns;++_t)Jt[_t]===_t&&(as!==-1&&Jt[as]!==as?Jt[_t]=Jt[as]:os!==-1&&Jt[os]!==os&&(Jt[_t]=Jt[os]));for(_t=1;_t<Ns;++_t)if(Dt[_t].type!==0){if((cs=_t)!=Jt[cs])for(;cs=Jt[cs],rs[_t]=rs[cs]+"/"+rs[_t],cs!==0&&Jt[cs]!==-1&&cs!=Jt[cs];);Jt[_t]=-1}for(rs[0]+="/",_t=1;_t<Ns;++_t)Dt[_t].type!==2&&(rs[_t]+="/")})(ts,Pt,ss),ss.shift(),Pt={FileIndex:ts,FullPaths:Pt},ot&&ot.raw&&(Pt.raw={header:Et,sectors:Bt}),Pt}function y(he,ot){return new Date(1e3*(pa(he,ot+4)/1e7*Math.pow(2,32)+pa(he,ot)/1e7-11644473600))}function j(he,at){var Te=at||{},at=Te.root||"Root Entry";if(he.FullPaths||(he.FullPaths=[]),he.FileIndex||(he.FileIndex=[]),he.FullPaths.length!==he.FileIndex.length)throw new Error("inconsistent CFB structure");he.FullPaths.length===0&&(he.FullPaths[0]=at+"/",he.FileIndex[0]={name:at,type:5}),Te.CLSID&&(he.FileIndex[0].clsid=Te.CLSID),at=he,Te="Sh33tJ5",es.find(at,"/"+Te)||((he=pt(4))[0]=55,he[1]=he[3]=50,he[2]=54,at.FileIndex.push({name:Te,type:2,content:he,size:4,L:69,R:69,C:69}),at.FullPaths.push(at.FullPaths[0]+Te),k(at))}function k(he,ot){j(he);for(var Te=!1,at=!1,Ae=he.FullPaths.length-1;0<=Ae;--Ae){var kt=he.FileIndex[Ae];switch(kt.type){case 0:at?Te=!0:(he.FileIndex.pop(),he.FullPaths.pop());break;case 1:case 2:case 5:at=!0,isNaN(kt.R*kt.L*kt.C)&&(Te=!0),-1<kt.R&&-1<kt.L&&kt.R==kt.L&&(Te=!0);break;default:Te=!0}}if(Te||ot){for(var Ze=new Date(1987,1,19),dt=0,Ge=Object.create?Object.create(null):{},mt=[],Ae=0;Ae<he.FullPaths.length;++Ae)Ge[he.FullPaths[Ae]]=!0,he.FileIndex[Ae].type!==0&&mt.push([he.FullPaths[Ae],he.FileIndex[Ae]]);for(Ae=0;Ae<mt.length;++Ae){var Et=u(mt[Ae][0]);(at=Ge[Et])||(mt.push([Et,{name:h(Et).replace("/",""),type:1,clsid:ee,ct:Ze,mt:Ze,content:null}]),Ge[Et]=!0)}for(mt.sort(function(Bt,Qt){return(function(ss,ts){for(var Pt,Dt=ss.split("/"),rs=ts.split("/"),Wt=0,_t=Math.min(Dt.length,rs.length);Wt<_t;++Wt){if(Pt=Dt[Wt].length-rs[Wt].length)return Pt;if(Dt[Wt]!=rs[Wt])return Dt[Wt]<rs[Wt]?-1:1}return Dt.length-rs.length})(Bt[0],Qt[0])}),he.FullPaths=[],he.FileIndex=[],Ae=0;Ae<mt.length;++Ae)he.FullPaths[Ae]=mt[Ae][0],he.FileIndex[Ae]=mt[Ae][1];for(Ae=0;Ae<mt.length;++Ae){var Kt=he.FileIndex[Ae],Yt=he.FullPaths[Ae];if(Kt.name=h(Yt).replace("/",""),Kt.L=Kt.R=Kt.C=-(Kt.color=1),Kt.size=Kt.content?Kt.content.length:0,Kt.start=0,Kt.clsid=Kt.clsid||ee,Ae===0)Kt.C=1<mt.length?1:-1,Kt.size=0,Kt.type=5;else if(Yt.slice(-1)=="/"){for(dt=Ae+1;dt<mt.length&&u(he.FullPaths[dt])!=Yt;++dt);for(Kt.C=dt>=mt.length?-1:dt,dt=Ae+1;dt<mt.length&&u(he.FullPaths[dt])!=u(Yt);++dt);Kt.R=dt>=mt.length?-1:dt,Kt.type=1}else u(he.FullPaths[Ae+1]||"")==u(Yt)&&(Kt.R=Ae+1),Kt.type=2}}}function E(he,ot){var Te=ot||{};if(Te.fileType=="mad")return(function(Yt,Bt){for(var Qt=Bt||{},ss=Qt.boundary||"SheetJS",ts=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(ss="------="+ss).slice(2)+'"',"","",""],Pt=Yt.FullPaths[0],Dt=Pt,rs=Yt.FileIndex[0],Wt=1;Wt<Yt.FullPaths.length;++Wt)if(Dt=Yt.FullPaths[Wt].slice(Pt.length),(rs=Yt.FileIndex[Wt]).size&&rs.content&&Dt!="Sh33tJ5"){Dt=Dt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Jt){return"_x"+Jt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Jt){return"_u"+Jt.charCodeAt(0).toString(16)+"_"});for(var _t=rs.content,os=ge&&Buffer.isBuffer(_t)?_t.toString("binary"):z(_t),as=0,gr=Math.min(1024,os.length),cs=0,Ns=0;Ns<=gr;++Ns)32<=(cs=os.charCodeAt(Ns))&&cs<128&&++as;_t=4*gr/5<=as,ts.push(ss),ts.push("Content-Location: "+(Qt.root||"file:///C:/SheetJS/")+Dt),ts.push("Content-Transfer-Encoding: "+(_t?"quoted-printable":"base64")),ts.push("Content-Type: "+(function(i,zs){if(i.ctype)return i.ctype;var Ms=i.name||"",i=Ms.match(/\.([^\.]+)$/);return i&&ha[i[1]]||zs&&(i=(Ms=zs).match(/[\.\\]([^\.\\])+$/))&&ha[i[1]]?ha[i[1]]:"application/octet-stream"})(rs,Dt)),ts.push(""),ts.push((_t?function(Jt){Jt=Jt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(A){return A=A.charCodeAt(0).toString(16).toUpperCase(),"="+(A.length==1?"0"+A:A)}),(Jt=Jt.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)==`
`&&(Jt="=0D"+Jt.slice(1)),Jt=Jt.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,`
=0A`).replace(/([^\r\n])\n/gm,"$1=0A");for(var zs=[],Ms=Jt.split(`\r
`),i=0;i<Ms.length;++i){var c=Ms[i];if(c.length!=0)for(var f=0;f<c.length;){var p=76,C=c.slice(f,f+p);C.charAt(p-1)=="="?p--:C.charAt(p-2)=="="?p-=2:C.charAt(p-3)=="="&&(p-=3),C=c.slice(f,f+p),(f+=p)<c.length&&(C+="="),zs.push(C)}else zs.push("")}return zs.join(`\r
`)}:function(Jt){for(var zs=se(Jt),Ms=[],i=0;i<zs.length;i+=76)Ms.push(zs.slice(i,i+76));return Ms.join(`\r
`)+`\r
`})(os))}return ts.push(ss+`--\r
`),ts.join(`\r
`)})(he,Te);if(k(he),Te.fileType==="zip")return(function(Yt,Qt){var Qt=Qt||{},ss=[],ts=[],Pt=pt(1),Dt=Qt.compression?8:0,rs=0,Wt=0,_t=0,os=0,as=0,gr=Yt.FullPaths[0],cs=gr,Ns=Yt.FileIndex[0],Jt=[],zs=0;for(Wt=1;Wt<Yt.FullPaths.length;++Wt)if(cs=Yt.FullPaths[Wt].slice(gr.length),(Ns=Yt.FileIndex[Wt]).size&&Ns.content&&cs!="Sh33tJ5"){var Ms=os,i=pt(cs.length);for(_t=0;_t<cs.length;++_t)i.write_shift(1,127&cs.charCodeAt(_t));i=i.slice(0,i.l),Jt[as]=Yn.buf(Ns.content,0);var c=Ns.content;Dt==8&&(c=(function(f){return T?T.deflateRawSync(f):Vt(f)})(c)),(Pt=pt(30)).write_shift(4,67324752),Pt.write_shift(2,20),Pt.write_shift(2,rs),Pt.write_shift(2,Dt),Ns.mt?(function(f,p){var C=(p=typeof p=="string"?new Date(p):p).getHours();C=(C=C<<6|p.getMinutes())<<5|p.getSeconds()>>>1,f.write_shift(2,C),C=(C=(C=p.getFullYear()-1980)<<4|p.getMonth()+1)<<5|p.getDate(),f.write_shift(2,C)})(Pt,Ns.mt):Pt.write_shift(4,0),Pt.write_shift(-4,Jt[as]),Pt.write_shift(4,c.length),Pt.write_shift(4,Ns.content.length),Pt.write_shift(2,i.length),Pt.write_shift(2,0),os+=Pt.length,ss.push(Pt),os+=i.length,ss.push(i),os+=c.length,ss.push(c),(Pt=pt(46)).write_shift(4,33639248),Pt.write_shift(2,0),Pt.write_shift(2,20),Pt.write_shift(2,rs),Pt.write_shift(2,Dt),Pt.write_shift(4,0),Pt.write_shift(-4,Jt[as]),Pt.write_shift(4,c.length),Pt.write_shift(4,Ns.content.length),Pt.write_shift(2,i.length),Pt.write_shift(2,0),Pt.write_shift(2,0),Pt.write_shift(2,0),Pt.write_shift(2,0),Pt.write_shift(4,0),Pt.write_shift(4,Ms),zs+=Pt.l,ts.push(Pt),zs+=i.length,ts.push(i),++as}return(Pt=pt(22)).write_shift(4,101010256),Pt.write_shift(2,0),Pt.write_shift(2,0),Pt.write_shift(2,as),Pt.write_shift(2,as),Pt.write_shift(4,zs),Pt.write_shift(4,os),Pt.write_shift(2,0),ce([ce(ss),ce(ts),Pt])})(he,Te);for(var at=(function(Yt){for(var Bt=0,Qt=0,ss=0;ss<Yt.FileIndex.length;++ss){var ts=Yt.FileIndex[ss];ts.content&&0<(ts=ts.content.length)&&(ts<4096?Bt+=ts+63>>6:Qt+=ts+511>>9)}for(var Pt=Yt.FullPaths.length+3>>2,Dt=Bt+127>>7,rs=(Bt+7>>3)+Qt+Pt+Dt,Wt=rs+127>>7,_t=Wt<=109?0:Math.ceil((Wt-109)/127);Wt<rs+Wt+_t+127>>7;)_t=++Wt<=109?0:Math.ceil((Wt-109)/127);return Pt=[1,_t,Wt,Dt,Pt,Qt,Bt,0],Yt.FileIndex[0].size=Bt<<6,Pt[7]=(Yt.FileIndex[0].start=Pt[0]+Pt[1]+Pt[2]+Pt[3]+Pt[4]+Pt[5])+(Pt[6]+7>>3),Pt})(he),Ae=pt(at[7]<<9),Ze=0,kt=0,Ze=0;Ze<8;++Ze)Ae.write_shift(1,I[Ze]);for(Ze=0;Ze<8;++Ze)Ae.write_shift(2,0);for(Ae.write_shift(2,62),Ae.write_shift(2,3),Ae.write_shift(2,65534),Ae.write_shift(2,9),Ae.write_shift(2,6),Ze=0;Ze<3;++Ze)Ae.write_shift(2,0);for(Ae.write_shift(4,0),Ae.write_shift(4,at[2]),Ae.write_shift(4,at[0]+at[1]+at[2]+at[3]-1),Ae.write_shift(4,0),Ae.write_shift(4,4096),Ae.write_shift(4,at[3]?at[0]+at[1]+at[2]-1:R),Ae.write_shift(4,at[3]),Ae.write_shift(-4,at[1]?at[0]-1:R),Ae.write_shift(4,at[1]),Ze=0;Ze<109;++Ze)Ae.write_shift(-4,Ze<at[2]?at[1]+Ze:-1);if(at[1])for(kt=0;kt<at[1];++kt){for(;Ze<236+127*kt;++Ze)Ae.write_shift(-4,Ze<at[2]?at[1]+Ze:-1);Ae.write_shift(-4,kt===at[1]-1?R:kt+1)}function dt(Yt){for(kt+=Yt;Ze<kt-1;++Ze)Ae.write_shift(-4,Ze+1);Yt&&(++Ze,Ae.write_shift(-4,R))}for(kt=Ze=0,kt+=at[1];Ze<kt;++Ze)Ae.write_shift(-4,Y.DIFSECT);for(kt+=at[2];Ze<kt;++Ze)Ae.write_shift(-4,Y.FATSECT);dt(at[3]),dt(at[4]);for(var Ge=0,mt=0,Et=he.FileIndex[0];Ge<he.FileIndex.length;++Ge)(Et=he.FileIndex[Ge]).content&&((mt=Et.content.length)<4096||(Et.start=kt,dt(mt+511>>9)));for(dt(at[6]+7>>3);511&Ae.l;)Ae.write_shift(-4,Y.ENDOFCHAIN);for(Ge=kt=Ze=0;Ge<he.FileIndex.length;++Ge)(Et=he.FileIndex[Ge]).content&&(!(mt=Et.content.length)||4096<=mt||(Et.start=kt,dt(mt+63>>6)));for(;511&Ae.l;)Ae.write_shift(-4,Y.ENDOFCHAIN);for(Ze=0;Ze<at[4]<<2;++Ze){var Kt=he.FullPaths[Ze];if(Kt&&Kt.length!==0){if(Et=he.FileIndex[Ze],Ze===0&&(Et.start=Et.size?Et.start-1:R),Kt=Ze===0&&Te.root||Et.name,mt=2*(Kt.length+1),Ae.write_shift(64,Kt,"utf16le"),Ae.write_shift(2,mt),Ae.write_shift(1,Et.type),Ae.write_shift(1,Et.color),Ae.write_shift(-4,Et.L),Ae.write_shift(-4,Et.R),Ae.write_shift(-4,Et.C),Et.clsid)Ae.write_shift(16,Et.clsid,"hex");else for(Ge=0;Ge<4;++Ge)Ae.write_shift(4,0);Ae.write_shift(4,Et.state||0),Ae.write_shift(4,0),Ae.write_shift(4,0),Ae.write_shift(4,0),Ae.write_shift(4,0),Ae.write_shift(4,Et.start),Ae.write_shift(4,Et.size),Ae.write_shift(4,0)}else{for(Ge=0;Ge<17;++Ge)Ae.write_shift(4,0);for(Ge=0;Ge<3;++Ge)Ae.write_shift(4,-1);for(Ge=0;Ge<12;++Ge)Ae.write_shift(4,0)}}for(Ze=1;Ze<he.FileIndex.length;++Ze)if(4096<=(Et=he.FileIndex[Ze]).size)if(Ae.l=Et.start+1<<9,ge&&Buffer.isBuffer(Et.content))Et.content.copy(Ae,Ae.l,0,Et.size),Ae.l+=Et.size+511&-512;else{for(Ge=0;Ge<Et.size;++Ge)Ae.write_shift(1,Et.content[Ge]);for(;511&Ge;++Ge)Ae.write_shift(1,0)}for(Ze=1;Ze<he.FileIndex.length;++Ze)if(0<(Et=he.FileIndex[Ze]).size&&Et.size<4096)if(ge&&Buffer.isBuffer(Et.content))Et.content.copy(Ae,Ae.l,0,Et.size),Ae.l+=Et.size+63&-64;else{for(Ge=0;Ge<Et.size;++Ge)Ae.write_shift(1,Et.content[Ge]);for(;63&Ge;++Ge)Ae.write_shift(1,0)}if(ge)Ae.l=Ae.length;else for(;Ae.l<Ae.length;)Ae.write_shift(1,0);return Ae}d.version="1.2.1";var T,_=64,R=-2,q="d0cf11e0a1b11ae1",I=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function z(he){for(var ot=new Array(he.length),Te=0;Te<he.length;++Te)ot[Te]=String.fromCharCode(he[Te]);return ot.join("")}for(var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Ee,We=typeof Uint8Array<"u",Ie=We?new Uint8Array(256):[],Je=0;Je<256;++Je)Ie[Je]=255&((Ee=139536&((Ee=Je)<<1|Ee<<11)|558144&(Ee<<5|Ee<<15))>>16|Ee>>8|Ee);function bt(he,at){var Te=7&at,at=at>>>3;return(he[at]|(Te<=5?0:he[1+at]<<8))>>>Te&7}function yt(he,at){var Te=7&at,at=at>>>3;return(he[at]|(Te<=3?0:he[1+at]<<8))>>>Te&31}function it(he,at){var Te=7&at,at=at>>>3;return(he[at]|(Te<=1?0:he[1+at]<<8))>>>Te&127}function St(he,Ze,Te){var at=7&Ze,Ae=Ze>>>3,kt=(1<<Te)-1,Ze=he[Ae]>>>at;return Te<8-at?Ze&kt:(Ze|=he[1+Ae]<<8-at,Te<16-at?Ze&kt:(Ze|=he[2+Ae]<<16-at,Te<24-at?Ze&kt:(Ze|=he[3+Ae]<<24-at)&kt))}function Ht(he,ot,Te){var at=7&ot,Ae=ot>>>3;return at<=5?he[Ae]|=(7&Te)<<at:(he[Ae]|=Te<<at&255,he[1+Ae]=(7&Te)>>8-at),ot+3}function zt(he,ot,Te){var at=ot>>>3;return Te<<=7&ot,he[at]|=255&Te,Te>>>=8,he[1+at]=Te,ot+8}function Lt(he,ot,Te){var at=ot>>>3;return Te<<=7&ot,he[at]|=255&Te,Te>>>=8,he[1+at]=255&Te,he[2+at]=Te>>>8,ot+16}function Ot(he,ot){var Te=he.length,at=ot<2*Te?2*Te:ot+5,Ae=0;if(ot<=Te)return he;if(ge){var kt=de(at);if(he.copy)he.copy(kt);else for(;Ae<he.length;++Ae)kt[Ae]=he[Ae];return kt}if(We){var Ze=new Uint8Array(at);if(Ze.set)Ze.set(he);else for(;Ae<Te;++Ae)Ze[Ae]=he[Ae];return Ze}return he.length=at,he}function Tt(he){for(var ot=new Array(he),Te=0;Te<he;++Te)ot[Te]=0;return ot}function jt(he,ot,Te){for(var at,Ae=1,mt=0,kt=0,Ze=0,dt=he.length,Ge=We?new Uint16Array(32):Tt(32),mt=0;mt<32;++mt)Ge[mt]=0;for(mt=dt;mt<Te;++mt)he[mt]=0;dt=he.length;var Et=We?new Uint16Array(dt):Tt(dt);for(mt=0;mt<dt;++mt)Ge[at=he[mt]]++,Ae<at&&(Ae=at),Et[mt]=0;for(Ge[0]=0,mt=1;mt<=Ae;++mt)Ge[mt+16]=Ze=Ze+Ge[mt-1]<<1;for(mt=0;mt<dt;++mt)(Ze=he[mt])!=0&&(Et[mt]=Ge[Ze+16]++);var Kt,Yt,Bt,Qt;for(mt=0;mt<dt;++mt)if((Kt=he[mt])!=0)for(Yt=Et[mt],Bt=Ae,Qt=void 0,Qt=Ie[255&Yt],Ze=(Bt<=8?Qt>>>8-Bt:(Qt=Qt<<8|Ie[Yt>>8&255],Bt<=16?Qt>>>16-Bt:(Qt=Qt<<8|Ie[Yt>>16&255])>>>24-Bt))>>Ae-Kt,kt=(1<<Ae+4-Kt)-1;0<=kt;--kt)ot[Ze|kt<<Kt]=15&Kt|mt<<4;return Ae}var qt=We?new Uint16Array(512):Tt(512),Xt=We?new Uint16Array(32):Tt(32);if(!We){for(var ns=0;ns<512;++ns)qt[ns]=0;for(ns=0;ns<32;++ns)Xt[ns]=0}(function(){for(var he=[],ot=0;ot<32;ot++)he.push(5);jt(he,Xt,32);for(var Te=[],ot=0;ot<=143;ot++)Te.push(8);for(;ot<=255;ot++)Te.push(9);for(;ot<=279;ot++)Te.push(7);for(;ot<=287;ot++)Te.push(8);jt(Te,qt,288)})();var Ds=(function(){for(var he=We?new Uint8Array(32768):[],ot=0,Te=0;ot<ie.length-1;++ot)for(;Te<ie[ot+1];++Te)he[Te]=ot;for(;Te<32768;++Te)he[Te]=29;for(var at=We?new Uint8Array(259):[],ot=0,Te=0;ot<ae.length-1;++ot)for(;Te<ae[ot+1];++Te)at[Te]=ot;return function(Ae,kt){return(Ae.length<8?function(Ze,dt){for(var Ge=0;Ge<Ze.length;){var mt=Math.min(65535,Ze.length-Ge),Et=Ge+mt==Ze.length;for(dt.write_shift(1,+Et),dt.write_shift(2,mt),dt.write_shift(2,65535&~mt);0<mt--;)dt[dt.l++]=Ze[Ge++]}return dt.l}:function(Ze,dt){for(var Ge=0,mt=0,Et=We?new Uint16Array(32768):[];mt<Ze.length;){var Kt=Math.min(65535,Ze.length-mt);if(Kt<10){for(7&(Ge=Ht(dt,Ge,+(mt+Kt==Ze.length)))&&(Ge+=8-(7&Ge)),dt.l=Ge/8|0,dt.write_shift(2,Kt),dt.write_shift(2,65535&~Kt);0<Kt--;)dt[dt.l++]=Ze[mt++];Ge=8*dt.l}else{Ge=Ht(dt,Ge,+(mt+Kt==Ze.length)+2);for(var Yt=0;0<Kt--;){var Bt=Ze[mt],Yt=32767&(Yt<<5^Bt),Qt=-1,ss=0;if((Qt=Et[Yt])&&(mt<(Qt|=-32768&mt)&&(Qt-=32768),Qt<mt))for(;Ze[Qt+ss]==Ze[mt+ss]&&ss<250;)++ss;if(2<ss){(Bt=at[ss])<=22?Ge=zt(dt,Ge,Ie[Bt+1]>>1)-1:(zt(dt,Ge,3),zt(dt,Ge+=5,Ie[Bt-23]>>5),Ge+=3);var ts=Bt<8?0:Bt-4>>2;0<ts&&(Lt(dt,Ge,ss-ae[Bt]),Ge+=ts),Bt=he[mt-Qt],Ge=zt(dt,Ge,Ie[Bt]>>3),Ge-=3;var Pt=Bt<4?0:Bt-2>>1;0<Pt&&(Lt(dt,Ge,mt-Qt-ie[Bt]),Ge+=Pt);for(var Dt=0;Dt<ss;++Dt)Et[Yt]=32767&mt,Yt=32767&(Yt<<5^Ze[mt]),++mt;Kt-=ss-1}else Bt<=143?Bt+=48:(ts=((ts=1)&ts)<<(7&(Pt=Ge)),dt[Pt>>>3]|=ts,Ge=Pt+1),Ge=zt(dt,Ge,Ie[Bt]),Et[Yt]=32767&mt,++mt}Ge=zt(dt,Ge,0)-1}}return dt.l=(Ge+7)/8|0,dt.l})(Ae,kt)}})();function Vt(Te){var ot=pt(50+Math.floor(1.1*Te.length)),Te=Ds(Te,ot);return ot.slice(0,Te)}var At=We?new Uint16Array(32768):Tt(32768),gs=We?new Uint16Array(32768):Tt(32768),Us=We?new Uint16Array(128):Tt(128),Os=1,Zs=1;function Pr(he,ot){if(he[0]==3&&!(3&he[1]))return[J(ot),2];for(var Te=0,at=0,Ae=de(ot||1<<18),kt=0,Ze=Ae.length>>>0,dt=0,Ge=0;(1&at)==0;)if(at=bt(he,Te),Te+=3,at>>>1!=0)for(Ge=at>>1==1?(dt=9,5):(Te=(function(ss,ts){var Pt,Dt,rs,Wt=yt(ss,ts)+257,_t=yt(ss,ts+=5)+1,os=(rs=7&(Dt=ts+=5),4+(((Pt=ss)[Dt=Dt>>>3]|(rs<=4?0:Pt[1+Dt]<<8))>>>rs&15));ts+=4;for(var as=0,gr=We?new Uint8Array(19):Tt(19),cs=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ns=1,Jt=We?new Uint8Array(8):Tt(8),zs=We?new Uint8Array(8):Tt(8),Ms=gr.length,i=0;i<os;++i)gr[Z[i]]=as=bt(ss,ts),Ns<as&&(Ns=as),Jt[as]++,ts+=3;var c=0;for(Jt[0]=0,i=1;i<=Ns;++i)zs[i]=c=c+Jt[i-1]<<1;for(i=0;i<Ms;++i)(c=gr[i])!=0&&(cs[i]=zs[c]++);for(var f,i=0;i<Ms;++i)if((f=gr[i])!=0){c=Ie[cs[i]]>>8-f;for(var p=(1<<7-f)-1;0<=p;--p)Us[c|p<<f]=7&f|i<<3}for(var C,A,U,re=[],Ns=1;re.length<Wt+_t;)switch(ts+=7&(c=Us[it(ss,ts)]),c>>>=3){case 16:for(as=3+(U=void 0,U=7&(A=ts),((C=ss)[A=A>>>3]|(U<=6?0:C[1+A]<<8))>>>U&3),ts+=2,c=re[re.length-1];0<as--;)re.push(c);break;case 17:for(as=3+bt(ss,ts),ts+=3;0<as--;)re.push(0);break;case 18:for(as=11+it(ss,ts),ts+=7;0<as--;)re.push(0);break;default:re.push(c),Ns<c&&(Ns=c)}var ve=re.slice(0,Wt),qe=re.slice(Wt);for(i=Wt;i<286;++i)ve[i]=0;for(i=_t;i<30;++i)qe[i]=0;return Os=jt(ve,At,286),Zs=jt(qe,gs,30),ts})(he,Te),dt=Os,Zs);;){!ot&&Ze<kt+32767&&(Ze=(Ae=Ot(Ae,kt+32767)).length);var mt=St(he,Te,dt),Et=(at>>>1==1?qt:At)[mt];if(Te+=15&Et,((Et>>>=4)>>>8&255)==0)Ae[kt++]=Et;else{if(Et==256)break;var Kt=(Et-=257)<8?0:Et-4>>2;5<Kt&&(Kt=0);var Yt=kt+ae[Et];0<Kt&&(Yt+=St(he,Te,Kt),Te+=Kt),mt=St(he,Te,Ge),Te+=15&(Et=(at>>>1==1?Xt:gs)[mt]);var mt=(Et>>>=4)<4?0:Et-2>>1,Bt=ie[Et];for(0<mt&&(Bt+=St(he,Te,mt),Te+=mt),!ot&&Ze<Yt&&(Ze=(Ae=Ot(Ae,Yt+100)).length);kt<Yt;)Ae[kt]=Ae[kt-Bt],++kt}}else{7&Te&&(Te+=8-(7&Te));var Qt=he[Te>>>3]|he[1+(Te>>>3)]<<8;if(Te+=32,0<Qt)for(!ot&&Ze<kt+Qt&&(Ze=(Ae=Ot(Ae,kt+Qt)).length);0<Qt--;)Ae[kt++]=he[Te>>>3],Te+=8}return ot?[Ae,Te+7>>>3]:[Ae.slice(0,kt),Te+7>>>3]}function Me(he,ot){return ot=Pr(he.slice(he.l||0),ot),he.l+=ot[1],ot[0]}function er(he,ot){if(!he)throw new Error(ot);typeof console<"u"&&console.error(ot)}function $s(he,ot){var Te=he;Sa(Te,0);var at={FileIndex:[],FullPaths:[]};j(at,{root:ot.root});for(var Ae=Te.length-4;(Te[Ae]!=80||Te[Ae+1]!=75||Te[Ae+2]!=5||Te[Ae+3]!=6)&&0<=Ae;)--Ae;Te.l=Ae+4,Te.l+=4;var kt=Te.read_shift(2);for(Te.l+=6,ot=Te.read_shift(4),Te.l=ot,Ae=0;Ae<kt;++Ae){Te.l+=20;var Ze=Te.read_shift(4),dt=Te.read_shift(4),Ge=Te.read_shift(2),mt=Te.read_shift(2),Et=Te.read_shift(2);Te.l+=8;var Kt=Te.read_shift(4),Yt=g(Te.slice(Te.l+Ge,Te.l+Ge+mt));Te.l+=Ge+mt+Et,Et=Te.l,Te.l=Kt+4,(function(Bt,Qt,ss,ts,Pt){Bt.l+=2;var Dt=Bt.read_shift(2),rs=Bt.read_shift(2),Wt=(function(C){var i=65535&C.read_shift(2),c=65535&C.read_shift(2),f=new Date,p=31&c,C=15&(c>>>=5);return c>>>=4,f.setMilliseconds(0),f.setFullYear(1980+c),f.setMonth(C-1),f.setDate(p),C=31&i,p=63&(i>>>=5),i>>>=6,f.setHours(i),f.setMinutes(p),f.setSeconds(C<<1),f})(Bt);if(8257&Dt)throw new Error("Unsupported ZIP encryption");Bt.read_shift(4);for(var _t,os=Bt.read_shift(4),as=Bt.read_shift(4),gr=Bt.read_shift(2),cs=Bt.read_shift(2),Ns="",Jt=0;Jt<gr;++Jt)Ns+=String.fromCharCode(Bt[Bt.l++]);cs&&(((_t=g(Bt.slice(Bt.l,Bt.l+cs)))[21589]||{}).mt&&(Wt=_t[21589].mt),((Pt||{})[21589]||{}).mt&&(Wt=Pt[21589].mt)),Bt.l+=cs;var zs=Bt.slice(Bt.l,Bt.l+os);switch(rs){case 8:zs=(function(Ms,f){if(!T)return Me(Ms,f);var c=new T.InflateRaw,f=c._processChunk(Ms.slice(Ms.l),c._finishFlushFlag);return Ms.l+=c.bytesRead,f})(Bt,as);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+rs)}cs=!1,8&Dt&&(Bt.read_shift(4)==134695760&&(Bt.read_shift(4),cs=!0),os=Bt.read_shift(4),as=Bt.read_shift(4)),os!=Qt&&er(cs,"Bad compressed size: "+Qt+" != "+os),as!=ss&&er(cs,"Bad uncompressed size: "+ss+" != "+as),Un(ts,Ns,zs,{unsafe:!0,mt:Wt})})(Te,Ze,dt,at,Yt),Te.l=Et}return at}var ha={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Un(he,ot,Te,at){var Ae=at&&at.unsafe;Ae||j(he);var kt,Ze=!Ae&&es.find(he,ot);return Ze||(kt=he.FullPaths[0],kt=ot.slice(0,kt.length)==kt?ot:(kt.slice(-1)!="/"&&(kt+="/"),(kt+ot).replace("//","/")),Ze={name:h(ot),type:2},he.FileIndex.push(Ze),he.FullPaths.push(kt),Ae||es.utils.cfb_gc(he)),Ze.content=Te,Ze.size=Te?Te.length:0,at&&(at.CLSID&&(Ze.clsid=at.CLSID),at.mt&&(Ze.mt=at.mt),at.ct&&(Ze.ct=at.ct)),Ze}return d.find=function(he,ot){var Te=he.FullPaths.map(function(Ge){return Ge.toUpperCase()}),at=Te.map(function(Ge){var mt=Ge.split("/");return mt[mt.length-(Ge.slice(-1)=="/"?2:1)]}),Ae=!1;ot.charCodeAt(0)===47?(Ae=!0,ot=Te[0].slice(0,-1)+ot):Ae=ot.indexOf("/")!==-1;var dt=ot.toUpperCase(),kt=(Ae===!0?Te:at).indexOf(dt);if(kt!==-1)return he.FileIndex[kt];var Ze=!dt.match(ke),dt=dt.replace(ye,"");for(Ze&&(dt=dt.replace(ke,"!")),kt=0;kt<Te.length;++kt)if((Ze?Te[kt].replace(ke,"!"):Te[kt]).replace(ye,"")==dt||(Ze?at[kt].replace(ke,"!"):at[kt]).replace(ye,"")==dt)return he.FileIndex[kt];return null},d.read=function(he,ot){var Te,at,Ae=ot&&ot.type;switch(Ae||ge&&Buffer.isBuffer(he)&&(Ae="buffer"),Ae||"base64"){case"file":return Te=he,at=ot,b(),x(r.readFileSync(Te),at);case"base64":return x(le(Ce(he)),ot);case"binary":return x(le(he),ot)}return x(he,ot)},d.parse=x,d.write=function(he,ot){var Te=E(he,ot);switch(ot&&ot.type||"buffer"){case"file":return b(),r.writeFileSync(ot.filename,Te),Te;case"binary":return typeof Te=="string"?Te:z(Te);case"base64":return se(typeof Te=="string"?Te:z(Te));case"buffer":if(ge)return Buffer.isBuffer(Te)?Te:Ne(Te);case"array":return typeof Te=="string"?le(Te):Te}return Te},d.writeFile=function(he,ot,Te){b(),Te=E(he,Te),r.writeFileSync(ot,Te)},d.utils={cfb_new:function(he){var ot={};return j(ot,he),ot},cfb_add:Un,cfb_del:function(he,ot){j(he);var Te=es.find(he,ot);if(Te){for(var at=0;at<he.FileIndex.length;++at)if(he.FileIndex[at]==Te)return he.FileIndex.splice(at,1),he.FullPaths.splice(at,1),!0}return!1},cfb_mov:function(he,ot,Te){j(he);var at=es.find(he,ot);if(at){for(var Ae=0;Ae<he.FileIndex.length;++Ae)if(he.FileIndex[Ae]==at)return he.FileIndex[Ae].name=h(Te),he.FullPaths[Ae]=Te,!0}return!1},cfb_gc:function(he){k(he,!0)},ReadShift:qo,CheckField:Nm,prep_blob:Sa,bconcat:ce,use_zlib:function(he){try{var ot=new he.InflateRaw;if(ot._processChunk(new Uint8Array([3,0]),ot._finishFlushFlag),!ot.bytesRead)throw new Error("zlib does not expose bytesRead");T=he}catch(Te){console.error("cannot use native zlib: "+(Te.message||Te))}},_deflateRaw:Vt,_inflateRaw:Me,consts:Y},d})();if(typeof mp<"u")try{Ua=I1}catch{}function ui(r){return typeof r=="string"?ze(r):Array.isArray(r)?(function(d){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(d)})(r):r}function Wl(r,d,u){if(Ua!==void 0&&Ua.writeFileSync)return u?Ua.writeFileSync(r,d,u):Ua.writeFileSync(r,d);if(typeof Deno<"u"){if(u&&typeof d=="string")switch(u){case"utf8":d=new TextEncoder(u).encode(d);break;case"binary":d=ze(d);break;default:throw new Error("Unsupported encoding "+u)}return Deno.writeFileSync(r,d)}var h=u=="utf8"?Xe(d):d;if(typeof IE_SaveFile<"u")return IE_SaveFile(h,r);if(typeof Blob<"u"){if(h=new Blob([ui(h)],{type:"application/octet-stream"}),typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(h,r);if(typeof saveAs<"u")return saveAs(h,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var g=URL.createObjectURL(h);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),chrome.downloads.download({url:g,filename:r,saveAs:!0});if(h=document.createElement("a"),h.download!=null)return h.download=r,h.href=g,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),g}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var b=File(r);return b.open("w"),b.encoding="binary",Array.isArray(d)&&(d=me(d)),b.write(d),b.close(),d}catch(x){if(!x.message||!x.message.match(/onstruct/))throw x}throw new Error("cannot save file "+r)}function is(r){for(var d=Object.keys(r),u=[],h=0;h<d.length;++h)Object.prototype.hasOwnProperty.call(r,d[h])&&u.push(d[h]);return u}function $l(r,d){for(var u=[],h=is(r),g=0;g!==h.length;++g)u[r[h[g]][d]]==null&&(u[r[h[g]][d]]=h[g]);return u}function Mi(r){for(var d=[],u=is(r),h=0;h!==u.length;++h)d[r[u[h]]]=u[h];return d}function ql(r){for(var d=[],u=is(r),h=0;h!==u.length;++h)d[r[u[h]]]=parseInt(u[h],10);return d}var hi=new Date(1899,11,30,0,0,0);function qr(r,d){var u=r.getTime();return(u-(hi.getTime()+6e4*(r.getTimezoneOffset()-hi.getTimezoneOffset())))/864e5}var fi=new Date,Bo=hi.getTime()+6e4*(fi.getTimezoneOffset()-hi.getTimezoneOffset()),Li=fi.getTimezoneOffset();function mi(r){var d=new Date;return d.setTime(24*r*60*60*1e3+Bo),d.getTimezoneOffset()!==Li&&d.setTime(d.getTime()+6e4*(d.getTimezoneOffset()-Li)),d}var Ri=new Date("2017-02-19T19:06:09.000Z"),Nr=isNaN(Ri.getFullYear())?new Date("2/19/17"):Ri,Tr=Nr.getFullYear()==2017;function _s(r,d){var u=new Date(r);return Tr?(0<d?u.setTime(u.getTime()+60*u.getTimezoneOffset()*1e3):d<0&&u.setTime(u.getTime()-60*u.getTimezoneOffset()*1e3),u):r instanceof Date?r:Nr.getFullYear()==1917&&!isNaN(u.getFullYear())?(d=u.getFullYear(),-1<r.indexOf(""+d)||u.setFullYear(u.getFullYear()+100),u):(u=r.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+u[0],+u[1]-1,+u[2],+u[3]||0,+u[4]||0,+u[5]||0),u=-1<r.indexOf("Z")?new Date(u.getTime()-60*u.getTimezoneOffset()*1e3):u)}function Ha(r,d){if(ge&&Buffer.isBuffer(r)){if(d){if(r[0]==255&&r[1]==254)return Xe(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return Xe(F(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(d){if(r[0]==255&&r[1]==254)return Xe(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return Xe(new TextDecoder("utf-16be").decode(r.slice(2)))}var u={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(b){return u[b]||b})}catch{}for(var h=[],g=0;g!=r.length;++g)h.push(String.fromCharCode(r[g]));return h.join("")}function vs(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var d,u={};for(d in r)Object.prototype.hasOwnProperty.call(r,d)&&(u[d]=vs(r[d]));return u}function lr(r,d){for(var u="";u.length<d;)u+=r;return u}function en(h){var d=Number(h);if(!isNaN(d))return isFinite(d)?d:NaN;if(!/\d/.test(h))return d;var u=1,h=h.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return u*=100,""});return isNaN(d=Number(h))?(h=h.replace(/[(](.*)[)]/,function(g,b){return u=-u,b}),isNaN(d=Number(h))?d:d/u):d/u}var o0=["january","february","march","april","may","june","july","august","september","october","november","december"];function mn(r){var d=new Date(r),u=new Date(NaN),h=d.getYear(),g=d.getMonth(),b=d.getDate();if(isNaN(b))return u;var x=r.toLowerCase();if(x.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(x=x.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&o0.indexOf(x)==-1)return u}else if(x.match(/[a-z]/))return u;return h<0||8099<h||(!(0<g||1<b)||h==101)&&r.match(/[^-0-9:,\/\\]/)?u:d}var zo,gn=(zo="abacaba".split(/(:?b)/i).length==5,function(r,d,u){if(zo||typeof d=="string")return r.split(d);for(var h=r.split(d),g=[h[0]],b=1;b<h.length;++b)g.push(u),g.push(h[b]);return g});function Ma(r){return r?r.content&&r.type?Ha(r.content,!0):r.data?O(r.data):r.asNodeBuffer&&ge?O(r.asNodeBuffer().toString("binary")):r.asBinary?O(r.asBinary()):r._data&&r._data.getContent?O(Ha(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function ga(r){if(!r)return null;if(r.data)return M(r.data);if(r.asNodeBuffer&&ge)return r.asNodeBuffer();if(r._data&&r._data.getContent){var d=r._data.getContent();return typeof d=="string"?M(d):Array.prototype.slice.call(d)}return r.content&&r.type?r.content:null}function Br(r,d){for(var u=r.FullPaths||is(r.files),h=d.toLowerCase().replace(/[\/]/g,"\\"),g=h.replace(/\\/g,"/"),b=0;b<u.length;++b){var x=u[b].replace(/^Root Entry[\/]/,"").toLowerCase();if(h==x||g==x)return r.files?r.files[u[b]]:r.FileIndex[b]}return null}function kr(r,d){if(r=Br(r,d),r==null)throw new Error("Cannot find file "+d+" in zip");return r}function zr(r,d,u){if(!u)return((u=kr(r,d))&&u.name.slice(-4)===".bin"?ga:Ma)(u);if(!d)return null;try{return zr(r,d)}catch{return null}}function La(r,d,u){if(!u)return Ma(kr(r,d));if(!d)return null;try{return La(r,d)}catch{return null}}function gi(r){for(var d=r.FullPaths||is(r.files),u=[],h=0;h<d.length;++h)d[h].slice(-1)!="/"&&u.push(d[h].replace(/^Root Entry[\/]/,""));return u.sort()}function xs(r,d,u){if(r.FullPaths){if(typeof u=="string"){var h=(ge?Ne:function(g){for(var b=[],x=0,y=g.length+250,j=J(g.length+255),k=0;k<g.length;++k){var E,T=g.charCodeAt(k);T<128?j[x++]=T:T<2048?(j[x++]=192|T>>6&31,j[x++]=128|63&T):55296<=T&&T<57344?(T=64+(1023&T),E=1023&g.charCodeAt(++k),j[x++]=240|T>>8&7,j[x++]=128|T>>2&63,j[x++]=128|E>>6&15|(3&T)<<4,j[x++]=128|63&E):(j[x++]=224|T>>12&15,j[x++]=128|T>>6&63,j[x++]=128|63&T),y<x&&(b.push(j.slice(0,x)),x=0,j=J(65535),y=65530)}return b.push(j.slice(0,x)),ce(b)})(u);return es.utils.cfb_add(r,d,h)}es.utils.cfb_add(r,d,u)}else r.file(d,u)}function Yc(){return es.utils.cfb_new()}function tn(r,d){switch(d.type){case"base64":return es.read(r,{type:"base64"});case"binary":return es.read(r,{type:"binary"});case"buffer":case"array":return es.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+d.type)}function hl(r,d){if(r.charAt(0)=="/")return r.slice(1);var u=d.split("/");d.slice(-1)!="/"&&u.pop();for(var h=r.split("/");h.length!==0;){var g=h.shift();g===".."?u.pop():g!=="."&&u.push(g)}return u.join("/")}var hr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_r=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Md=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Fr=hr.match(Md)?Md:/<[^>]*>/g,Gn=/<\w*:/,Ca=/<(\/?)\w+:/;function fs(r,d,u){for(var h={},g=0,b=0;g!==r.length&&(b=r.charCodeAt(g))!==32&&b!==10&&b!==13;++g);if(d||(h[0]=r.slice(0,g)),g===r.length)return h;var x,y,j,k=r.match(_r),E=0,T=0,_="",R="";if(k)for(T=0;T!=k.length;++T){for(R=k[T],b=0;b!=R.length&&R.charCodeAt(b)!==61;++b);for(_=R.slice(0,b).trim();R.charCodeAt(b+1)==32;)++b;for(y=(g=R.charCodeAt(b+1))==34||g==39?1:0,x=R.slice(b+1+y,R.length-y),E=0;E!=_.length&&_.charCodeAt(E)!==58;++E);E===_.length?(h[_=0<_.indexOf("_")?_.slice(0,_.indexOf("_")):_]=x,h[_.toLowerCase()]=x):h[j=(E===5&&_.slice(0,5)==="xmlns"?"xmlns":"")+_.slice(E+1)]&&_.slice(E-3,E)=="ext"||(h[j]=x,h[j.toLowerCase()]=x)}return h}function Tn(r){return r.replace(Ca,"<$1")}var Uo,Gc,sn={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Kc=Mi(sn),ws=(Uo=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,Gc=/_x([\da-fA-F]{4})_/gi,function r(d){var u=d+"",h=u.indexOf("<![CDATA[");return h==-1?u.replace(Uo,function(g,b){return sn[g]||String.fromCharCode(parseInt(b,-1<g.indexOf("x")?16:10))||g}).replace(Gc,function(g,b){return String.fromCharCode(parseInt(b,16))}):(d=u.indexOf("]]>"),r(u.slice(0,h))+u.slice(h+9,d)+r(u.slice(d+3)))}),Ra=/[&<>'"]/g,Qc=/[\u0000-\u0008\u000b-\u001f]/g;function Ys(r){return(r+"").replace(Ra,function(d){return Kc[d]}).replace(Qc,function(d){return"_x"+("000"+d.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Va(r){return Ys(r).replace(/ /g,"_x0020_")}var Yl=/[\u0000-\u001f]/g;function Oi(r){return(r+"").replace(Ra,function(d){return Kc[d]}).replace(/\n/g,"<br/>").replace(Yl,function(d){return"&#x"+("000"+d.charCodeAt(0).toString(16)).slice(-4)+";"})}var pi,Xc=(pi=/&#(\d+);/g,function(r){return r.replace(pi,Jc)});function Jc(r,d){return String.fromCharCode(parseInt(d,10))}function or(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gl(r){for(var d,u,h,g,b="",x=0,y=0;x<r.length;)(d=r.charCodeAt(x++))<128?b+=String.fromCharCode(d):(u=r.charCodeAt(x++),191<d&&d<224?(y=(31&d)<<6,y|=63&u,b+=String.fromCharCode(y)):(h=r.charCodeAt(x++),d<240?b+=String.fromCharCode((15&d)<<12|(63&u)<<6|63&h):(g=((7&d)<<18|(63&u)<<12|(63&h)<<6|63&(y=r.charCodeAt(x++)))-65536,b+=String.fromCharCode(55296+(g>>>10&1023)),b+=String.fromCharCode(56320+(1023&g)))));return b}function c0(r){for(var d,u,h=J(2*r.length),g=1,b=0,x=0,y=0;y<r.length;y+=g)g=1,(u=r.charCodeAt(y))<128?d=u:u<224?(d=64*(31&u)+(63&r.charCodeAt(y+1)),g=2):u<240?(d=4096*(15&u)+64*(63&r.charCodeAt(y+1))+(63&r.charCodeAt(y+2)),g=3):(g=4,d=262144*(7&u)+4096*(63&r.charCodeAt(y+1))+64*(63&r.charCodeAt(y+2))+(63&r.charCodeAt(y+3)),x=55296+((d-=65536)>>>10&1023),d=56320+(1023&d)),x!==0&&(h[b++]=255&x,h[b++]=x>>>8,x=0),h[b++]=d%256,h[b++]=d>>>8;return h.slice(0,b).toString("ucs2")}function d0(r){return Ne(r,"binary").toString("utf8")}var fl,rn,G,Ei="foo bar baz",Oe=ge&&(d0(Ei)==Gl(Ei)?d0:c0(Ei)==Gl(Ei)&&c0)||Gl,Xe=ge?function(r){return Ne(r,"utf8").toString("binary")}:function(r){for(var d,u=[],h=0,g=0;h<r.length;)switch(!0){case(g=r.charCodeAt(h++))<128:u.push(String.fromCharCode(g));break;case g<2048:u.push(String.fromCharCode(192+(g>>6))),u.push(String.fromCharCode(128+(63&g)));break;case(55296<=g&&g<57344):g-=55296,d=r.charCodeAt(h++)-56320+(g<<10),u.push(String.fromCharCode(240+(d>>18&7))),u.push(String.fromCharCode(144+(d>>12&63))),u.push(String.fromCharCode(128+(d>>6&63))),u.push(String.fromCharCode(128+(63&d)));break;default:u.push(String.fromCharCode(224+(g>>12))),u.push(String.fromCharCode(128+(g>>6&63))),u.push(String.fromCharCode(128+(63&g)))}return u.join("")},He=(fl={},function(r,d){var u=r+"|"+(d||"");return fl[u]||(fl[u]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",d||""))}),st=(rn=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]}),function(r){for(var d=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),u=0;u<rn.length;++u)d=d.replace(rn[u][0],rn[u][1]);return d}),Ue=(G={},function(r){return G[r]!==void 0?G[r]:G[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}),lt=/<\/?(?:vt:)?variant>/g,Ke=/<(?:vt:)([^>]*)>([\s\S]*)</;function Be(h,d){var u=fs(h),h=h.match(Ue(u.baseType))||[],g=[];if(h.length==u.size)return h.forEach(function(b){b=b.replace(lt,"").match(Ke),b&&g.push({v:Oe(b[2]),t:b[1]})}),g;if(d.WTF)throw new Error("unexpected vector length "+h.length+" != "+u.size);return g}var Nt=/(^\s|\s$|\n)/;function Ct(r,d){return"<"+r+(d.match(Nt)?' xml:space="preserve"':"")+">"+d+"</"+r+">"}function Rt(r){return is(r).map(function(d){return" "+d+'="'+r[d]+'"'}).join("")}function Le(r,d,u){return"<"+r+(u!=null?Rt(u):"")+(d!=null?(d.match(Nt)?' xml:space="preserve"':"")+">"+d+"</"+r:"/")+">"}function Gt(r,d){try{return r.toISOString().replace(/\.\d*/,"")}catch(u){if(d)throw u}return""}function js(r){if(ge&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return Oe(me(oe(r)));throw new Error("Bad input format: expected Buffer or string")}var cr=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,hs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ta=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],tr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function sa(r){for(var d=[],u=0;u<r[0].length;++u)if(r[0][u])for(var h=0,g=r[0][u].length;h<g;h+=10240)d.push.apply(d,r[0][u].slice(h,h+10240));return d}function _n(r,d,u){for(var h=[],g=d;g<u;g+=2)h.push(String.fromCharCode(Pi(r,g)));return h.join("").replace(ye,"")}function Ho(r,d,u){for(var h=[],g=d;g<d+u;++g)h.push(("0"+r[g].toString(16)).slice(-2));return h.join("")}function vm(r,d,u){for(var h=[],g=d;g<u;g++)h.push(String.fromCharCode($o(r,g)));return h.join("")}function u0(r,d){var u=pa(r,d);return 0<u?Wo(r,d+4,d+4+u-1):""}function h0(r,d){var u=pa(r,d);return 0<u?Wo(r,d+4,d+4+u-1):""}function Vo(r,d){var u=2*pa(r,d);return 0<u?Wo(r,d+4,d+4+u-1):""}function Zc(r,d){var u=pa(r,d);return 0<u?f0(r,d+4,d+4+u):""}function ih(r,d){var u=pa(r,d);return 0<u?Wo(r,d+4,d+4+u):""}function wm(r,d){for(var u=1-2*(r[d+7]>>>7),h=((127&r[d+7])<<4)+(r[d+6]>>>4&15),g=15&r[d+6],b=5;0<=b;--b)g=256*g+r[d+b];return h==2047?g==0?1/0*u:NaN:(h==0?h=-1022:(h-=1023,g+=Math.pow(2,52)),u*Math.pow(2,h-52)*g)}var jm=ge?function(r){return 0<r[0].length&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(d){return Buffer.isBuffer(d)?d:Ne(d)})):sa(r)}:sa,f0=ge?function(r,d,u){return Buffer.isBuffer(r)?r.toString("utf16le",d,u).replace(ye,""):_n(r,d,u)}:_n,m0=ge?function(r,d,u){return Buffer.isBuffer(r)?r.toString("hex",d,d+u):Ho(r,d,u)}:Ho,Wo=ge?function(r,d,u){return Buffer.isBuffer(r)?r.toString("utf8",d,u):vm(r,d,u)}:vm,lh=u0,oh=h0,ch=Vo,dh=Zc,g0=ih,p0=wm,uh=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};ge&&(lh=function(r,d){if(!Buffer.isBuffer(r))return u0(r,d);var u=r.readUInt32LE(d);return 0<u?r.toString("utf8",d+4,d+4+u-1):""},oh=function(r,d){if(!Buffer.isBuffer(r))return h0(r,d);var u=r.readUInt32LE(d);return 0<u?r.toString("utf8",d+4,d+4+u-1):""},ch=function(r,d){if(!Buffer.isBuffer(r))return Vo(r,d);var u=2*r.readUInt32LE(d);return r.toString("utf16le",d+4,d+4+u-1)},dh=function(r,d){if(!Buffer.isBuffer(r))return Zc(r,d);var u=r.readUInt32LE(d);return r.toString("utf16le",d+4,d+4+u)},g0=function(r,d){if(!Buffer.isBuffer(r))return ih(r,d);var u=r.readUInt32LE(d);return r.toString("utf8",d+4,d+4+u)},p0=function(r,d){return Buffer.isBuffer(r)?r.readDoubleLE(d):wm(r,d)},uh=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array}),e!==void 0&&(f0=function(r,d,u){return e.utils.decode(1200,r.slice(d,u)).replace(ye,"")},Wo=function(r,d,u){return e.utils.decode(65001,r.slice(d,u))},lh=function(r,d){var u=pa(r,d);return 0<u?e.utils.decode(v,r.slice(d+4,d+4+u-1)):""},oh=function(r,d){var u=pa(r,d);return 0<u?e.utils.decode(m,r.slice(d+4,d+4+u-1)):""},ch=function(r,d){var u=2*pa(r,d);return 0<u?e.utils.decode(1200,r.slice(d+4,d+4+u-1)):""},dh=function(r,d){var u=pa(r,d);return 0<u?e.utils.decode(1200,r.slice(d+4,d+4+u)):""},g0=function(r,d){var u=pa(r,d);return 0<u?e.utils.decode(65001,r.slice(d+4,d+4+u)):""});var $o=function(r,d){return r[d]},Pi=function(r,d){return 256*r[d+1]+r[d]},hh=function(r,d){return d=256*r[d+1]+r[d],d<32768?d:-1*(65535-d+1)},pa=function(r,d){return r[d+3]*(1<<24)+(r[d+2]<<16)+(r[d+1]<<8)+r[d]},Kl=function(r,d){return r[d+3]<<24|r[d+2]<<16|r[d+1]<<8|r[d]},zp=function(r,d){return r[d]<<24|r[d+1]<<16|r[d+2]<<8|r[d+3]};function qo(r,d){var u,h,g,b,x,y,j="",k=[];switch(d){case"dbcs":if(y=this.l,ge&&Buffer.isBuffer(this))j=this.slice(this.l,this.l+2*r).toString("utf16le");else for(x=0;x<r;++x)j+=String.fromCharCode(Pi(this,y)),y+=2;r*=2;break;case"utf8":j=Wo(this,this.l,this.l+r);break;case"utf16le":r*=2,j=f0(this,this.l,this.l+r);break;case"wstr":if(e===void 0)return qo.call(this,r,"dbcs");j=e.utils.decode(m,this.slice(this.l,this.l+2*r)),r*=2;break;case"lpstr-ansi":j=lh(this,this.l),r=4+pa(this,this.l);break;case"lpstr-cp":j=oh(this,this.l),r=4+pa(this,this.l);break;case"lpwstr":j=ch(this,this.l),r=4+2*pa(this,this.l);break;case"lpp4":r=4+pa(this,this.l),j=dh(this,this.l),2&r&&(r+=2);break;case"8lpp4":r=4+pa(this,this.l),j=g0(this,this.l),3&r&&(r+=4-(3&r));break;case"cstr":for(r=0,j="";(g=$o(this,this.l+r++))!==0;)k.push(P(g));j=k.join("");break;case"_wstr":for(r=0,j="";(g=Pi(this,this.l+r))!==0;)k.push(P(g)),r+=2;r+=2,j=k.join("");break;case"dbcs-cont":for(j="",y=this.l,x=0;x<r;++x){if(this.lens&&this.lens.indexOf(y)!==-1)return g=$o(this,y),this.l=y+1,b=qo.call(this,r-x,g?"dbcs-cont":"sbcs-cont"),k.join("")+b;k.push(P(Pi(this,y))),y+=2}j=k.join(""),r*=2;break;case"cpstr":if(e!==void 0){j=e.utils.decode(m,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(j="",y=this.l,x=0;x!=r;++x){if(this.lens&&this.lens.indexOf(y)!==-1)return g=$o(this,y),this.l=y+1,b=qo.call(this,r-x,g?"dbcs-cont":"sbcs-cont"),k.join("")+b;k.push(P($o(this,y))),y+=1}j=k.join("");break;default:switch(r){case 1:return u=$o(this,this.l),this.l++,u;case 2:return u=(d==="i"?hh:Pi)(this,this.l),this.l+=2,u;case 4:case-4:return d==="i"||(128&this[this.l+3])==0?(u=(0<r?Kl:zp)(this,this.l),this.l+=4,u):(h=pa(this,this.l),this.l+=4,h);case 8:case-8:if(d==="f")return h=r==8?p0(this,this.l):p0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,h;r=8;case 16:j=m0(this,this.l,r)}}return this.l+=r,j}var Up=function(r,d,u){r[u]=255&d,r[u+1]=d>>>8&255,r[u+2]=d>>>16&255,r[u+3]=d>>>24&255},Hp=function(r,d,u){r[u]=255&d,r[u+1]=d>>8&255,r[u+2]=d>>16&255,r[u+3]=d>>24&255},Vp=function(r,d,u){r[u]=255&d,r[u+1]=d>>>8&255};function Wp(r,d,u){var h=0,g=0;if(u==="dbcs"){for(g=0;g!=d.length;++g)Vp(this,d.charCodeAt(g),this.l+2*g);h=2*d.length}else if(u==="sbcs"){if(e!==void 0&&v==874)for(g=0;g!=d.length;++g){var b=e.utils.encode(v,d.charAt(g));this[this.l+g]=b[0]}else for(d=d.replace(/[^\x00-\x7F]/g,"_"),g=0;g!=d.length;++g)this[this.l+g]=255&d.charCodeAt(g);h=d.length}else{if(u==="hex"){for(;g<r;++g)this[this.l++]=parseInt(d.slice(2*g,2*g+2),16)||0;return this}if(u==="utf16le"){for(var x=Math.min(this.l+r,this.length),g=0;g<Math.min(d.length,r);++g){var y=d.charCodeAt(g);this[this.l++]=255&y,this[this.l++]=y>>8}for(;this.l<x;)this[this.l++]=0;return this}switch(r){case 1:h=1,this[this.l]=255&d;break;case 2:h=2,this[this.l]=255&d,d>>>=8,this[this.l+1]=255&d;break;case 3:h=3,this[this.l]=255&d,d>>>=8,this[this.l+1]=255&d,d>>>=8,this[this.l+2]=255&d;break;case 4:h=4,Up(this,d,this.l);break;case 8:if(h=8,u==="f"){(function(j,k,E){var T=(k<0||1/k==-1/0?1:0)<<7,_=0,R=0,q=T?-k:k;isFinite(q)?q==0?_=R=0:(_=Math.floor(Math.log(q)/Math.LN2),R=q*Math.pow(2,52-_),_<=-1023&&(!isFinite(R)||R<Math.pow(2,52))?_=-1022:(R-=Math.pow(2,52),_+=1023)):(_=2047,R=isNaN(k)?26985:0);for(var I=0;I<=5;++I,R/=256)j[E+I]=255&R;j[E+6]=(15&_)<<4|15&R,j[E+7]=_>>4|T})(this,d,this.l);break}case 16:break;case-4:h=4,Hp(this,d,this.l)}}return this.l+=h,this}function Nm(r,d){var u=m0(this,this.l,r.length>>1);if(u!==r)throw new Error(d+"Expected "+r+" saw "+u);this.l+=r.length>>1}function Sa(r,d){r.l=d,r.read_shift=qo,r.chk=Nm,r.write_shift=Wp}function Oa(r,d){r.l+=d}function pt(r){return r=J(r),Sa(r,0),r}function Ii(r,d,u){if(r){Sa(r,r.l||0);for(var h,g=r.length,b=0;r.l<g;){128&(b=r.read_shift(1))&&(b=(127&b)+((127&r.read_shift(1))<<7));for(var x,y=jo[b]||jo[65535],j=127&(x=r.read_shift(1)),k=1;k<4&&128&x;++k)j+=(127&(x=r.read_shift(1)))<<7*k;h=r.l+j;var E=y.f&&y.f(r,j,u);if(r.l=h,d(E,y,b))return}}}function Pa(){function r(x){return Sa(x=pt(x),0),x}function d(){b&&(b.length>b.l&&((b=b.slice(0,b.l)).l=b.length),0<b.length&&h.push(b),b=null)}function u(x){return b&&x<b.length-b.l?b:(d(),b=r(Math.max(x+1,g)))}var h=[],g=ge?256:2048,b=r(g);return{next:u,push:function(x){d(),(b=x).l==null&&(b.l=b.length),u(g)},end:function(){return d(),ce(h)},_bufs:h}}function wt(r,d,u,h){var g=+d;if(!isNaN(g)){d=1+(128<=g?1:0)+1,128<=(h=h||jo[g].p||(u||[]).length||0)&&++d,16384<=h&&++d,2097152<=h&&++d;var b=r.next(d);g<=127?b.write_shift(1,g):(b.write_shift(1,128+(127&g)),b.write_shift(1,g>>7));for(var x=0;x!=4;++x){if(!(128<=h)){b.write_shift(1,h);break}b.write_shift(1,128+(127&h)),h>>=7}0<h&&uh(u)&&r.push(u)}}function ed(r,d,u){var h=vs(r);if(d.s?(h.cRel&&(h.c+=d.s.c),h.rRel&&(h.r+=d.s.r)):(h.cRel&&(h.c+=d.c),h.rRel&&(h.r+=d.r)),!u||u.biff<12){for(;256<=h.c;)h.c-=256;for(;65536<=h.r;)h.r-=65536}return h}function fh(r,d,u){return r=vs(r),r.s=ed(r.s,d.s,u),r.e=ed(r.e,d.s,u),r}function Yo(r,d){if(r.cRel&&r.c<0)for(r=vs(r);r.c<0;)r.c+=8<d?16384:256;if(r.rRel&&r.r<0)for(r=vs(r);r.r<0;)r.r+=8<d?1048576:5<d?65536:16384;var u=bs(r);return r.cRel||r.cRel==null||(u=u.replace(/^([A-Z])/,"$$$1")),u=!r.rRel&&r.rRel!=null?u.replace(/([A-Z]|^)(\d+)$/,"$1$$$2"):u}function x0(r,d){return r.s.r!=0||r.s.rRel||r.e.r!=(12<=d.biff?1048575:8<=d.biff?65536:16384)||r.e.rRel?r.s.c!=0||r.s.cRel||r.e.c!=(12<=d.biff?16383:255)||r.e.cRel?Yo(r.s,d.biff)+":"+Yo(r.e,d.biff):(r.s.rRel?"":"$")+Ur(r.s.r)+":"+(r.e.rRel?"":"$")+Ur(r.e.r):(r.s.cRel?"":"$")+Ar(r.s.c)+":"+(r.e.cRel?"":"$")+Ar(r.e.c)}function b0(r){return parseInt(r.replace(/\$(\d+)$/,"$1"),10)-1}function Ur(r){return""+(r+1)}function ml(r){for(var d=r.replace(/^\$([A-Z])/,"$1"),u=0,h=0;h!==d.length;++h)u=26*u+d.charCodeAt(h)-64;return u-1}function Ar(r){if(r<0)throw new Error("invalid column "+r);var d="";for(++r;r;r=Math.floor((r-1)/26))d=String.fromCharCode((r-1)%26+65)+d;return d}function Hr(r){for(var d=0,u=0,h=0;h<r.length;++h){var g=r.charCodeAt(h);48<=g&&g<=57?d=10*d+(g-48):65<=g&&g<=90&&(u=26*u+(g-64))}return{c:u-1,r:d-1}}function bs(r){for(var d=r.c+1,u="";d;d=(d-1)/26|0)u=String.fromCharCode((d-1)%26+65)+u;return u+(r.r+1)}function Ia(r){var d=r.indexOf(":");return d==-1?{s:Hr(r),e:Hr(r)}:{s:Hr(r.slice(0,d)),e:Hr(r.slice(d+1))}}function Cs(r,d){return d===void 0||typeof d=="number"?Cs(r.s,r.e):(r=typeof r!="string"?bs(r):r)==(d=typeof d!="string"?bs(d):d)?r:r+":"+d}function Fs(r){for(var d={s:{c:0,r:0},e:{c:0,r:0}},b=0,u=0,h=0,g=r.length,b=0;u<g&&!((h=r.charCodeAt(u)-64)<1||26<h);++u)b=26*b+h;for(d.s.c=--b,b=0;u<g&&!((h=r.charCodeAt(u)-48)<0||9<h);++u)b=10*b+h;if(d.s.r=--b,u===g||h!=10)return d.e.c=d.s.c,d.e.r=d.s.r,d;for(++u,b=0;u!=g&&!((h=r.charCodeAt(u)-64)<1||26<h);++u)b=26*b+h;for(d.e.c=--b,b=0;u!=g&&!((h=r.charCodeAt(u)-48)<0||9<h);++u)b=10*b+h;return d.e.r=--b,d}function td(r,d){var u=r.t=="d"&&d instanceof Date;if(r.z!=null)try{return r.w=Ir(r.z,u?qr(d):d)}catch{}try{return r.w=Ir((r.XF||{}).numFmtId||(u?14:0),u?qr(d):d)}catch{return""+d}}function xi(r,d,u){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&u&&u.dateNF&&(r.z=u.dateNF),r.t=="e"?Xn[r.v]||r.v:td(r,d??r.v))}function Kn(r,h){var u=h&&h.sheet?h.sheet:"Sheet1",h={};return h[u]=r,{SheetNames:[u],Sheets:h}}function mh(r,d,u){var h=u||{},g=r?Array.isArray(r):h.dense,b=r||(g?[]:{}),x=0,y=0;b&&h.origin!=null&&(typeof h.origin=="number"?x=h.origin:(x=(j=typeof h.origin=="string"?Hr(h.origin):h.origin).r,y=j.c),b["!ref"]||(b["!ref"]="A1:A1"));var j,k={s:{c:1e7,r:1e7},e:{c:0,r:0}};b["!ref"]&&(j=Fs(b["!ref"]),k.s.c=j.s.c,k.s.r=j.s.r,k.e.c=Math.max(k.e.c,j.e.c),k.e.r=Math.max(k.e.r,j.e.r),x==-1&&(k.e.r=x=j.e.r+1));for(var E=0;E!=d.length;++E)if(d[E]){if(!Array.isArray(d[E]))throw new Error("aoa_to_sheet expects an array of arrays");for(var T=0;T!=d[E].length;++T)if(d[E][T]!==void 0){var _={v:d[E][T]},R=x+E,q=y+T;if(k.s.r>R&&(k.s.r=R),k.s.c>q&&(k.s.c=q),k.e.r<R&&(k.e.r=R),k.e.c<q&&(k.e.c=q),!d[E][T]||typeof d[E][T]!="object"||Array.isArray(d[E][T])||d[E][T]instanceof Date)if(Array.isArray(_.v)&&(_.f=d[E][T][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(h.nullError)_.t="e",_.v=0;else{if(!h.sheetStubs)continue;_.t="z"}else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=h.dateNF||W[14],h.cellDates?(_.t="d",_.w=Ir(_.z,qr(_.v))):(_.t="n",_.v=qr(_.v),_.w=Ir(_.z,_.v))):_.t="s";else _=d[E][T];g?(b[R]||(b[R]=[]),b[R][q]&&b[R][q].z&&(_.z=b[R][q].z),b[R][q]=_):(b[R=bs({c:q,r:R})]&&b[R].z&&(_.z=b[R].z),b[R]=_)}}return k.s.c<1e7&&(b["!ref"]=Cs(k)),b}function Ql(r,d){return mh(null,r,d)}function pn(r,d){return(d=d||pt(4)).write_shift(4,r),d}function xa(r){var d=r.read_shift(4);return d===0?"":r.read_shift(d,"dbcs")}function ca(r,d){var u=!1;return d==null&&(u=!0,d=pt(4+2*r.length)),d.write_shift(4,r.length),0<r.length&&d.write_shift(0,r,"dbcs"),u?d.slice(0,d.l):d}function y0(r,d){var u,h=r.l,g=r.read_shift(1),x=xa(r),b=[],x={t:x,h:x};if((1&g)!=0){for(var y=r.read_shift(4),j=0;j!=y;++j)b.push({ich:(u=r).read_shift(2),ifnt:u.read_shift(2)});x.r=b}else x.r=[{ich:0,ifnt:0}];return r.l=h+d,x}var km=y0;function $p(r,d){var u,h=!1;return d==null&&(h=!0,d=pt(23+4*r.t.length)),d.write_shift(1,1),ca(r.t,d),d.write_shift(4,1),u={ich:0,ifnt:0},(r=(r=d)||pt(4)).write_shift(2,u.ich||0),r.write_shift(2,u.ifnt||0),h?d.slice(0,d.l):d}function Fn(r){var d=r.read_shift(4),u=r.read_shift(2);return u+=r.read_shift(1)<<16,r.l++,{c:d,iStyleRef:u}}function Xl(r,d){return(d=d??pt(8)).write_shift(-4,r.c),d.write_shift(3,r.iStyleRef||r.s),d.write_shift(1,0),d}function Jl(r){var d=r.read_shift(2);return d+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:d}}function Zl(r,d){return(d=d??pt(4)).write_shift(3,r.iStyleRef||r.s),d.write_shift(1,0),d}var xn=xa,Go=ca;function v0(r){var d=r.read_shift(4);return d===0||d===4294967295?"":r.read_shift(d,"dbcs")}function sd(r,d){var u=!1;return d==null&&(u=!0,d=pt(127)),d.write_shift(4,0<r.length?r.length:4294967295),0<r.length&&d.write_shift(0,r,"dbcs"),u?d.slice(0,d.l):d}var Cm=xa,w0=v0,rd=sd;function gh(r){var d=r.slice(r.l,r.l+4),u=1&d[0],h=2&d[0];return r.l+=4,d=h==0?p0([0,0,0,0,252&d[0],d[1],d[2],d[3]],0):Kl(d,0)>>2,u?d/100:d}function eo(r,d){d==null&&(d=pt(4));var u=0,h=0,g=100*r;if(r==(0|r)&&-536870912<=r&&r<1<<29?h=1:g==(0|g)&&-536870912<=g&&g<1<<29&&(u=h=1),!h)throw new Error("unsupported RkNumber "+r);d.write_shift(-4,((u?g:r)<<2)+(u+2))}function j0(r){var d={s:{},e:{}};return d.s.r=r.read_shift(4),d.e.r=r.read_shift(4),d.s.c=r.read_shift(4),d.e.c=r.read_shift(4),d}var Qn=j0,gl=function(r,d){return(d=d||pt(16)).write_shift(4,r.s.r),d.write_shift(4,r.e.r),d.write_shift(4,r.s.c),d.write_shift(4,r.e.c),d};function Aa(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Mn(r,d){return(d||pt(8)).write_shift(8,r,"f")}function Bi(r,d){if(d=d||pt(8),!r||r.auto)return d.write_shift(4,0),d.write_shift(4,0),d;r.index!=null?(d.write_shift(1,2),d.write_shift(1,r.index)):r.theme!=null?(d.write_shift(1,6),d.write_shift(1,r.theme)):(d.write_shift(1,5),d.write_shift(1,0));var u=r.tint||0;return 0<u?u*=32767:u<0&&(u*=32768),d.write_shift(2,u),r.rgb&&r.theme==null?(typeof(r=r.rgb||"FFFFFF")=="number"&&(r=("000000"+r.toString(16)).slice(-6)),d.write_shift(1,parseInt(r.slice(0,2),16)),d.write_shift(1,parseInt(r.slice(2,4),16)),d.write_shift(1,parseInt(r.slice(4,6),16)),d.write_shift(1,255)):(d.write_shift(2,0),d.write_shift(1,0),d.write_shift(1,0)),d}function N0(r,d){var u=r.read_shift(4);switch(u){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[r.read_shift(4)]||""}if(400<u)throw new Error("Unsupported Clipboard: "+u.toString(16));return r.l-=4,r.read_shift(0,d==1?"lpstr":"lpwstr")}var k0=2,ra=3,ph=12,xh=81,Sm=[80,xh],bh={1:{n:"CodePage",t:k0},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:ra},5:{n:"LineCount",t:ra},6:{n:"ParagraphCount",t:ra},7:{n:"SlideCount",t:ra},8:{n:"NoteCount",t:ra},9:{n:"HiddenCount",t:ra},10:{n:"MultimediaClipCount",t:ra},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:ra},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:ra,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},yh={1:{n:"CodePage",t:k0},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:ra},15:{n:"WordCount",t:ra},16:{n:"CharCount",t:ra},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:ra},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Am={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Em=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ko=vs([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(r){return[r>>16&255,r>>8&255,255&r]})),Xn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ln={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Qo={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Wa={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function pl(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function C0(r,d){var u,h=(function(j){for(var k=[],E=is(j),T=0;T!==E.length;++T)k[j[E[T]]]==null&&(k[j[E[T]]]=[]),k[j[E[T]]].push(E[T]);return k})(Qo),g=[];g[g.length]=hr,g[g.length]=Le("Types",null,{xmlns:hs.CT,"xmlns:xsd":hs.xsd,"xmlns:xsi":hs.xsi}),g=g.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(j){return Le("Default",null,{Extension:j[0],ContentType:j[1]})}));function b(j){r[j]&&0<r[j].length&&(u=r[j][0],g[g.length]=Le("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Wa[j][d.bookType]||Wa[j].xlsx}))}function x(j){(r[j]||[]).forEach(function(k){g[g.length]=Le("Override",null,{PartName:(k[0]=="/"?"":"/")+k,ContentType:Wa[j][d.bookType]||Wa[j].xlsx})})}function y(j){(r[j]||[]).forEach(function(k){g[g.length]=Le("Override",null,{PartName:(k[0]=="/"?"":"/")+k,ContentType:h[j][0]})})}return b("workbooks"),x("sheets"),x("charts"),y("themes"),["strs","styles"].forEach(b),["coreprops","extprops","custprops"].forEach(y),y("vba"),y("comments"),y("threadedcomments"),y("drawings"),x("metadata"),y("people"),2<g.length&&(g[g.length]="</Types>",g[1]=g[1].replace("/>",">")),g.join("")}var ks={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xl(r){var d=r.lastIndexOf("/");return r.slice(0,d+1)+"_rels/"+r.slice(d+1)+".rels"}function to(r,d){var u={"!id":{}};if(!r)return u;d.charAt(0)!=="/"&&(d="/"+d);var h={};return(r.match(Fr)||[]).forEach(function(g){var b,x=fs(g);x[0]==="<Relationship"&&((b={}).Type=x.Type,b.Target=x.Target,b.Id=x.Id,x.TargetMode&&(b.TargetMode=x.TargetMode),g=x.TargetMode==="External"?x.Target:hl(x.Target,d),u[g]=b,h[x.Id]=b)}),u["!id"]=h,u}function Rn(r){var d=[hr,Le("Relationships",null,{xmlns:hs.RELS})];return is(r["!id"]).forEach(function(u){d[d.length]=Le("Relationship",null,r["!id"][u])}),2<d.length&&(d[d.length]="</Relationships>",d[1]=d[1].replace("/>",">")),d.join("")}function rr(r,d,u,h,g,b){if(g=g||{},r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),d<0)for(d=r["!idx"];r["!id"]["rId"+d];++d);if(r["!idx"]=d+1,g.Id="rId"+d,g.Type=h,g.Target=u,-1<[ks.HLINK,ks.XPATH,ks.XMISS].indexOf(g.Type)&&(g.TargetMode="External"),r["!id"][g.Id])throw new Error("Cannot rewrite rId "+d);return r["!id"][g.Id]=g,r[("/"+g.Target).replace("//","/")]=g,d}var S0="application/vnd.oasis.opendocument.spreadsheet";function so(r,d,u){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(u||"odf")+"#"+d+`"/>
`,`  </rdf:Description>
`].join("")}function Dm(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+s.version+"</meta:generator></office:meta></office:document-meta>"}var Mr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vh=(function(){for(var r=new Array(Mr.length),d=0;d<Mr.length;++d){var u=Mr[d],u="(?:"+u[0].slice(0,u[0].indexOf(":"))+":)"+u[0].slice(u[0].indexOf(":")+1);r[d]=new RegExp("<"+u+"[^>]*>([\\s\\S]*?)</"+u+">")}return r})();function bi(r){var d={};r=Oe(r);for(var u=0;u<Mr.length;++u){var h=Mr[u],g=r.match(vh[u]);g!=null&&0<g.length&&(d[h[1]]=ws(g[1])),h[2]==="date"&&d[h[1]]&&(d[h[1]]=_s(d[h[1]]))}return d}function A0(r,d,u,h,g){g[r]==null&&d!=null&&d!==""&&(d=Ys(g[r]=d),h[h.length]=u?Le(r,d,u):Ct(r,d))}function ad(r,d){var u=d||{},h=[hr,Le("cp:coreProperties",null,{"xmlns:cp":hs.CORE_PROPS,"xmlns:dc":hs.dc,"xmlns:dcterms":hs.dcterms,"xmlns:dcmitype":hs.dcmitype,"xmlns:xsi":hs.xsi})],g={};if(!r&&!u.Props)return h.join("");r&&(r.CreatedDate!=null&&A0("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:Gt(r.CreatedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},h,g),r.ModifiedDate!=null&&A0("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:Gt(r.ModifiedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},h,g));for(var b=0;b!=Mr.length;++b){var x=Mr[b],y=u.Props&&u.Props[x[1]]!=null?u.Props[x[1]]:r?r[x[1]]:null;y===!0?y="1":y===!1?y="0":typeof y=="number"&&(y=String(y)),y!=null&&A0(x[0],y,null,h,g)}return 2<h.length&&(h[h.length]="</cp:coreProperties>",h[1]=h[1].replace("/>",">")),h.join("")}var bn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],E0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wh(r,d,u,h){var g=[];if(typeof r=="string")g=Be(r,h);else for(var b=0;b<r.length;++b)g=g.concat(r[b].map(function(E){return{v:E}}));var x,y=typeof d=="string"?Be(d,h).map(function(E){return E.v}):d,j=0;if(0<y.length)for(var k=0;k!==g.length;k+=2){switch(x=+g[k+1].v,g[k].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":u.Worksheets=x,u.SheetNames=y.slice(j,j+x);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":u.NamedRanges=x,u.DefinedNames=y.slice(j,j+x);break;case"Charts":case"Diagramme":u.Chartsheets=x,u.ChartNames=y.slice(j,j+x)}j+=x}}function D0(r){var d=[],u=Le;return(r=r||{}).Application="SheetJS",d[d.length]=hr,d[d.length]=Le("Properties",null,{xmlns:hs.EXT_PROPS,"xmlns:vt":hs.vt}),bn.forEach(function(h){if(r[h[1]]!==void 0){var g;switch(h[2]){case"string":g=Ys(String(r[h[1]]));break;case"bool":g=r[h[1]]?"true":"false"}g!==void 0&&(d[d.length]=u(h[0],g))}}),d[d.length]=u("HeadingPairs",u("vt:vector",u("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+u("vt:variant",u("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),d[d.length]=u("TitlesOfParts",u("vt:vector",r.SheetNames.map(function(h){return"<vt:lpstr>"+Ys(h)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),2<d.length&&(d[d.length]="</Properties>",d[1]=d[1].replace("/>",">")),d.join("")}var Tm=/<[^>]+>[^<]*/g;function yn(r){var d=[hr,Le("Properties",null,{xmlns:hs.CUST_PROPS,"xmlns:vt":hs.vt})];if(!r)return d.join("");var u=1;return is(r).forEach(function(h){++u,d[d.length]=Le("property",(function(g,b){switch(typeof g){case"string":var x=Le("vt:lpwstr",Ys(g));return x=x.replace(/&quot;/g,"_x0022_");case"number":return Le((0|g)==g?"vt:i4":"vt:r8",Ys(String(g)));case"boolean":return Le("vt:bool",g?"true":"false")}if(g instanceof Date)return Le("vt:filetime",Gt(g));throw new Error("Unable to serialize "+g)})(r[h]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:u,name:Ys(h)})}),2<d.length&&(d[d.length]="</Properties>",d[1]=d[1].replace("/>",">")),d.join("")}var ro,bl={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Xo(u){var d=u.read_shift(4),u=u.read_shift(4);return new Date(1e3*(u/1e7*Math.pow(2,32)+d/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Jo(r,d,u){var h=r.l,g=r.read_shift(0,"lpstr-cp");if(u)for(;r.l-h&3;)++r.l;return g}function vn(r,d,u){var h=r.read_shift(0,"lpwstr");return h}function wn(r,d,u){return d===31?vn(r):Jo(r,0,u)}function zi(r,d,u){return wn(r,d,u===!1?0:4)}function yi(r){for(var d,u,h,g=r.read_shift(4),b=[],x=0;x<g/2;++x)b.push((h=u=void 0,u=(d=r).l,h=nd(d,xh),d[d.l]==0&&d[d.l+1]==0&&d.l-u&2&&(d.l+=2),[h,nd(d,ra)]));return b}function Jn(r,d){for(var u=r.read_shift(4),h={},g=0;g!=u;++g){var b=r.read_shift(4),x=r.read_shift(4);h[b]=r.read_shift(x,d===1200?"utf16le":"utf8").replace(ye,"").replace(ke,"!"),d===1200&&x%2&&(r.l+=2)}return 3&r.l&&(r.l=r.l>>3<<2),h}function vi(r){var d=r.read_shift(4),u=r.slice(r.l,r.l+d);return r.l+=d,0<(3&d)&&(r.l+=4-(3&d)&3),u}function nd(r,d,u){var h,g,b=r.read_shift(2),x=u||{};if(r.l+=2,d!==ph&&b!==d&&Sm.indexOf(d)===-1&&((65534&d)!=4126||(65534&b)!=4126))throw new Error("Expected type "+d+" saw "+b);switch(d===ph?b:d){case 2:return h=r.read_shift(2,"i"),x.raw||(r.l+=2),h;case 3:return h=r.read_shift(4,"i");case 11:return r.read_shift(4)!==0;case 19:return h=r.read_shift(4);case 30:return Jo(r,0,4).replace(ye,"");case 31:return vn(r);case 64:return Xo(r);case 65:return vi(r);case 71:return(g={}).Size=(h=r).read_shift(4),h.l+=g.Size+3-(g.Size-1)%4,g;case 80:return zi(r,b,!x.raw).replace(ye,"");case 81:return(function(y,j){if(!j)throw new Error("VtUnalignedString must have positive length");return wn(y,j,0)})(r,b).replace(ye,"");case 4108:return yi(r);case 4126:case 4127:return(b==4127?function(y){for(var j=y.read_shift(4),k=[],E=0;E!=j;++E){var T=y.l;k[E]=y.read_shift(0,"lpwstr").replace(ye,""),y.l-T&2&&(y.l+=2)}return k}:function(y){for(var j=y.read_shift(4),k=[],E=0;E!=j;++E)k[E]=y.read_shift(0,"lpstr-cp").replace(ye,"");return k})(r);default:throw new Error("TypedPropertyValue unrecognized type "+d+" "+b)}}function T0(r,d){var u,h,g,b=pt(4),x=pt(4);switch(b.write_shift(4,r==80?31:r),r){case 3:x.write_shift(-4,d);break;case 5:(x=pt(8)).write_shift(8,d,"f");break;case 11:x.write_shift(4,d?1:0);break;case 64:h=(typeof(u=d)=="string"?new Date(Date.parse(u)):u).getTime()/1e3+11644473600,g=h%Math.pow(2,32),u=(h-g)/Math.pow(2,32),u*=1e7,0<(h=(g*=1e7)/Math.pow(2,32)|0)&&(g%=Math.pow(2,32),u+=h),(h=pt(8)).write_shift(4,g),h.write_shift(4,u),x=h;break;case 31:case 80:for((x=pt(4+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,d.length+1),x.write_shift(0,d,"dbcs");x.l!=x.length;)x.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+d)}return ce([b,x])}function _0(r,d){for(var u=r.l,h=r.read_shift(4),g=r.read_shift(4),b=[],k=0,x=0,y=-1,j={},k=0;k!=g;++k){var E=r.read_shift(4),T=r.read_shift(4);b[k]=[E,T+u]}b.sort(function(Y,z){return Y[1]-z[1]});var _={};for(k=0;k!=g;++k){if(r.l!==b[k][1]){var R=!0;if(0<k&&d)switch(d[b[k-1][0]].t){case 2:r.l+2===b[k][1]&&(r.l+=2,R=!1);break;case 80:case 4108:r.l<=b[k][1]&&(r.l=b[k][1],R=!1)}if((!d||k==0)&&r.l<=b[k][1]&&(R=!1,r.l=b[k][1]),R)throw new Error("Read Error: Expected address "+b[k][1]+" at "+r.l+" :"+k)}if(d){var q=d[b[k][0]];if(_[q.n]=nd(r,q.t,{raw:!0}),q.p==="version"&&(_[q.n]=String(_[q.n]>>16)+"."+("0000"+String(65535&_[q.n])).slice(-4)),q.n=="CodePage")switch(_[q.n]){case 0:_[q.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:D(x=_[q.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[q.n])}}else if(b[k][0]===1)x=_.CodePage=nd(r,k0),D(x),y!==-1&&(ee=r.l,r.l=b[y][1],j=Jn(r,x),r.l=ee);else if(b[k][0]===0)x!==0?j=Jn(r,x):(y=k,r.l=b[k+1][1]);else{var I,ee=j[b[k][0]];switch(r[r.l]){case 65:r.l+=4,I=vi(r);break;case 30:case 31:r.l+=4,I=zi(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,I=r.read_shift(4,"i");break;case 19:r.l+=4,I=r.read_shift(4);break;case 5:r.l+=4,I=r.read_shift(8,"f");break;case 11:r.l+=4,I=Js(r,4);break;case 64:r.l+=4,I=_s(Xo(r));break;default:throw new Error("unparsed value: "+r[r.l])}_[ee]=I}}return r.l=u+h,_}var jh=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ba(r,d,u){var h,g,b,x,y=pt(8),j=[],k=[],E=8,T=0,_=pt(8),R=pt(8);if(_.write_shift(4,2),_.write_shift(4,1200),R.write_shift(4,1),k.push(_),j.push(R),E+=8+_.length,!d){(R=pt(8)).write_shift(4,0),j.unshift(R);var q=[pt(4)];for(q[0].write_shift(4,r.length),T=0;T<r.length;++T){var I=r[T][0];for((_=pt(8+2*(I.length+1)+(I.length%2?0:2))).write_shift(4,T+2),_.write_shift(4,I.length+1),_.write_shift(0,I,"dbcs");_.l!=_.length;)_.write_shift(1,0);q.push(_)}_=ce(q),k.unshift(_),E+=8+_.length}for(T=0;T<r.length;++T)d&&!d[r[T][0]]||-1<jh.indexOf(r[T][0])||-1<E0.indexOf(r[T][0])||r[T][1]!=null&&(b=r[T][1],h=0,_=d?((x=u[h=+d[r[T][0]]]).p=="version"&&typeof b=="string"&&(b=(+(g=b.split("."))[0]<<16)+(+g[1]||0)),T0(x.t,b)):((x=(function(Y){switch(typeof Y){case"boolean":return 11;case"number":return(0|Y)==Y?3:5;case"string":return 31;case"object":if(Y instanceof Date)return 64}return-1})(b))==-1&&(x=31,b=String(b)),T0(x,b)),k.push(_),(R=pt(8)).write_shift(4,d?h:2+T),j.push(R),E+=8+_.length);for(var ee=8*(k.length+1),T=0;T<k.length;++T)j[T].write_shift(4,ee),ee+=k[T].length;return y.write_shift(4,E),y.write_shift(4,k.length),ce([y].concat(j).concat(k))}function Cr(r,d,u){var h=r.content;if(!h)return{};Sa(h,0);var g,b=0;h.chk("feff","Byte Order: "),h.read_shift(2);var x=h.read_shift(4),y=h.read_shift(16);if(y!==es.utils.consts.HEADER_CLSID&&y!==u)throw new Error("Bad PropertySet CLSID "+y);if((r=h.read_shift(4))!==1&&r!==2)throw new Error("Unrecognized #Sets: "+r);if(u=h.read_shift(16),y=h.read_shift(4),r===1&&y!==h.l)throw new Error("Length mismatch: "+y+" !== "+h.l);r===2&&(g=h.read_shift(16),b=h.read_shift(4));var j,k,E=_0(h,d),T={SystemIdentifier:x};for(j in E)T[j]=E[j];if(T.FMTID=u,r===1)return T;if(b-h.l==2&&(h.l+=2),h.l!==b)throw new Error("Length mismatch 2: "+h.l+" !== "+b);try{k=_0(h,null)}catch{}for(j in k)T[j]=k[j];return T.FMTID=[u,g],T}function Hs(r,d,u,h,g,b){var x=pt(g?68:48),y=[x];return x.write_shift(2,65534),x.write_shift(2,0),x.write_shift(4,842412599),x.write_shift(16,es.utils.consts.HEADER_CLSID,"hex"),x.write_shift(4,g?2:1),x.write_shift(16,d,"hex"),x.write_shift(4,g?68:48),h=ba(r,u,h),y.push(h),g&&(g=ba(g,null,null),x.write_shift(16,b,"hex"),x.write_shift(4,68+h.length),y.push(g)),ce(y)}function $a(r,d){return r.read_shift(d),null}function Js(r,d){return r.read_shift(d)===1}function Ea(r,d){return(d=d||pt(2)).write_shift(2,+!!r),d}function br(r){return r.read_shift(2,"u")}function jn(r,d){return(d=d||pt(2)).write_shift(2,r),d}function Nh(r,d){return(function(u,h,g){for(var b=[],x=u.l+h;u.l<x;)b.push(g(u,x-u.l));if(x!==u.l)throw new Error("Slurp error");return b})(r,d,br)}function ao(r,d,u){return(u=u||pt(2)).write_shift(1,d=="e"?+r:+!!r),u.write_shift(1,d=="e"?1:0),u}function Zn(r,d,u){var h=r.read_shift(u&&12<=u.biff?2:1),g="sbcs-cont",b=m;return u&&8<=u.biff&&(m=1200),u&&u.biff!=8?u.biff==12&&(g="wstr"):r.read_shift(1)&&(g="dbcs-cont"),2<=u.biff&&u.biff<=5&&(g="cpstr"),g=h?r.read_shift(h,g):"",m=b,g}function Ui(r,d,u){if(u){if(2<=u.biff&&u.biff<=5)return r.read_shift(d,"cpstr");if(12<=u.biff)return r.read_shift(d,"dbcs-cont")}return r.read_shift(1)===0?r.read_shift(d,"sbcs-cont"):r.read_shift(d,"dbcs-cont")}function Hi(r,d,u){var h=r.read_shift(u&&u.biff==2?1:2);return h===0?(r.l++,""):Ui(r,h,u)}function Vi(r,d,u){if(5<u.biff)return Hi(r,0,u);var h=r.read_shift(1);return h===0?(r.l++,""):r.read_shift(h,u.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function yl(r,d,u){return(u=u||pt(3+2*r.length)).write_shift(2,r.length),u.write_shift(1,1),u.write_shift(31,r,"utf16le"),u}function Wi(r){var d,u,h,g,b=r.read_shift(16);switch(b){case"e0c9ea79f9bace118c8200aa004ba90b":return u=(d=r).read_shift(4),h=d.l,g=!1,24<u&&(d.l+=u-24,d.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(g=!0),d.l=h),u=d.read_shift((g?u-24:u)>>1,"utf16le").replace(ye,""),g&&(d.l+=24),u;case"0303000000000000c000000000000046":return(function(x){for(var y=x.read_shift(2),j="";0<y--;)j+="../";var k=x.read_shift(0,"lpstr-ansi");if(x.l+=2,x.read_shift(2)!=57005)throw new Error("Bad FileMoniker");if(x.read_shift(4)===0)return j+k.replace(/\\/g,"/");if(k=x.read_shift(4),x.read_shift(2)!=3)throw new Error("Bad FileMoniker");return j+x.read_shift(k>>1,"utf16le").replace(ye,"")})(r);default:throw new Error("Unsupported Moniker "+b)}}function ei(r){var d=r.read_shift(4);return 0<d?r.read_shift(d,"utf16le").replace(ye,""):""}function wi(r,d){(d=d||pt(6+2*r.length)).write_shift(4,1+r.length);for(var u=0;u<r.length;++u)d.write_shift(2,r.charCodeAt(u));return d.write_shift(2,0),d}function F0(r){return[r.read_shift(1),r.read_shift(1),r.read_shift(1),r.read_shift(1)]}function M0(r){return r=F0(r),r[3]=0,r}function qa(r){return{r:r.read_shift(2),c:r.read_shift(2),ixfe:r.read_shift(2)}}function ji(r,d,u,h){return(h=h||pt(6)).write_shift(2,r),h.write_shift(2,d),h.write_shift(2,u||0),h}function vl(r){return[r.read_shift(2),gh(r)]}function aa(r){var d=r.read_shift(2),u=r.read_shift(2);return{s:{c:r.read_shift(2),r:d},e:{c:r.read_shift(2),r:u}}}function id(r,d){return(d=d||pt(8)).write_shift(2,r.s.r),d.write_shift(2,r.e.r),d.write_shift(2,r.s.c),d.write_shift(2,r.e.c),d}function kh(r){var d=r.read_shift(2),u=r.read_shift(2);return{s:{c:r.read_shift(1),r:d},e:{c:r.read_shift(1),r:u}}}var qp=kh;function _m(r){r.l+=4;var d=r.read_shift(2),u=r.read_shift(2),h=r.read_shift(2);return r.l+=12,[u,d,h]}function Ba(r){r.l+=2,r.l+=r.read_shift(2)}var na={0:Ba,4:Ba,5:Ba,6:Ba,7:function(r){return r.l+=4,r.cf=r.read_shift(2),{}},8:Ba,9:Ba,10:Ba,11:Ba,12:Ba,13:function(r){var d={};return r.l+=4,r.l+=16,d.fSharedNote=r.read_shift(2),r.l+=4,d},14:Ba,15:Ba,16:Ba,17:Ba,18:Ba,19:Ba,20:Ba,21:_m};function Zo(r,d){var u={BIFFVer:0,dt:0};switch(u.BIFFVer=r.read_shift(2),2<=(d-=2)&&(u.dt=r.read_shift(2),r.l-=2),u.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<d)throw new Error("Unexpected BIFF Ver "+u.BIFFVer)}return r.read_shift(d),u}function no(r,d,u){var h=1536,g=16;switch(u.bookType){case"biff8":break;case"biff5":h=1280,g=8;break;case"biff4":h=4,g=6;break;case"biff3":h=3,g=6;break;case"biff2":h=2,g=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}return u=pt(g),u.write_shift(2,h),u.write_shift(2,d),4<g&&u.write_shift(2,29282),6<g&&u.write_shift(2,1997),8<g&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function ld(r){var d=pt(8);d.write_shift(4,r.Count),d.write_shift(4,r.Unique);for(var u,h,g,b=[],x=0;x<r.length;++x)b[x]=(u=r[x],g=h=void 0,h=u.t||"",(g=pt(3)).write_shift(2,h.length),g.write_shift(1,1),(u=pt(2*h.length)).write_shift(2*h.length,h,"utf16le"),ce([g,u]));var y=ce([d].concat(b));return y.parts=[d.length].concat(b.map(function(j){return j.length})),y}function L0(r,d,u){var h=0;return u&&u.biff==2||(h=r.read_shift(2)),r=r.read_shift(2),u&&u.biff==2&&(h=1-(r>>15),r&=32767),[{Unsynced:1&h,DyZero:(2&h)>>1,ExAsc:(4&h)>>2,ExDsc:(8&h)>>3},r]}var Ll=Vi;function io(r,b,x){var h=r.l+b,y=x.biff!=8&&x.biff?2:4,g=r.read_shift(y),b=r.read_shift(y),x=r.read_shift(2),y=r.read_shift(2);return r.l=h,{s:{r:g,c:x},e:{r:b,c:y}}}function lo(r,d,u,h){return u=u&&u.biff==5,(h=h||pt(u?16:20)).write_shift(2,0),r.style?(h.write_shift(2,r.numFmtId||0),h.write_shift(2,65524)):(h.write_shift(2,r.numFmtId||0),h.write_shift(2,d<<4)),d=0,0<r.numFmtId&&u&&(d|=1024),h.write_shift(4,d),h.write_shift(4,0),u||h.write_shift(4,0),h.write_shift(2,0),h}function Fm(r,d,u){var h=qa(r);return u.biff!=2&&d!=9||++r.l,r=(d=r).read_shift(1),r=d.read_shift(1)===1?r:r===1,h.val=r,h.t=r===!0||r===!1?"b":"e",h}function Ch(r,d,u){return d===0?"":Vi(r,0,u)}function Mm(r,d,u){var h,g=r.read_shift(2),g={fBuiltIn:1&g,fWantAdvise:g>>>1&1,fWantPict:g>>>2&1,fOle:g>>>3&1,fOleLink:g>>>4&1,cf:g>>>5&1023,fIcon:g>>>15&1};return u.sbcch===14849&&(h=(function(b,k,y){b.l+=4,k-=4;var j=b.l+k,k=Zn(b,0,y);if((y=b.read_shift(2))!==(j-=b.l))throw new Error("Malformed AddinUdf: padding = "+j+" != "+y);return b.l+=y,k})(r,d-2,u)),g.body=h||r.read_shift(d-2),typeof h=="string"&&(g.Name=h),g}var Lm=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function wl(r,j,u){var h=r.l+j,g=r.read_shift(2),b=r.read_shift(1),x=r.read_shift(1),y=r.read_shift(u&&u.biff==2?1:2),j=0;return(!u||5<=u.biff)&&(u.biff!=5&&(r.l+=2),j=r.read_shift(2),u.biff==5&&(r.l+=2),r.l+=4),x=Ui(r,x,u),32&g&&(x=Lm[x.charCodeAt(0)]),g=h-r.l,u&&u.biff==2&&--g,{chKey:b,Name:x,itab:j,rgce:h!=r.l&&y!==0&&0<g?(function(k,q,T,I){var R,q=k.l+q,I=Dd(k,I,T);return q!==k.l&&(R=yo(k,q-k.l,I,T)),[I,R]})(r,g,u,y):[]}}function R0(r,d,u){if(u.biff<8)return(function(y,j){return y[y.l+1]==3&&y[y.l]++,j=Zn(y,0,j),j.charCodeAt(0)==3?j.slice(1):j})(r,u);for(var h,g,b=[],d=r.l+d,x=r.read_shift(8<u.biff?4:2);x--!=0;)b.push((h=r,u.biff,g=8<(g=u).biff?4:2,[h.read_shift(g),h.read_shift(g,"i"),h.read_shift(g,"i")]));if(r.l!=d)throw new Error("Bad ExternSheet: "+r.l+" != "+d);return b}function od(r,d,u){var h=qp(r);switch(u.biff){case 2:r.l++,d-=7;break;case 3:case 4:r.l+=2,d-=8;break;default:r.l+=6,d-=12}return[h,(function(g,b,x){var y,j=g.l+b,k=x.biff==2?1:2,E=g.read_shift(k);if(E==65535)return[[],Oa(g,b-2)];var T=Dd(g,E,x);return b!==E+k&&(y=yo(g,b-E-k,T,x)),g.l=j,[T,y]})(r,d,u)]}var Rm={8:function(r,d){var u=r.l+d;r.l+=10;var h=r.read_shift(2);return r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4,d=r.read_shift(1),r.l+=d,r.l=u,{fmt:h}}};function ec(r){var d=pt(24),u=Hr(r[0]);d.write_shift(2,u.r),d.write_shift(2,u.r),d.write_shift(2,u.c),d.write_shift(2,u.c);for(var h="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),g=0;g<16;++g)d.write_shift(1,parseInt(h[g],16));return ce([d,(function(b){var x=pt(512),y=0,j=b.Target,k=-1<(b=(j=j.slice(0,7)=="file://"?j.slice(7):j).indexOf("#"))?31:23;switch(j.charAt(0)){case"#":k=28;break;case".":k&=-3}x.write_shift(4,2),x.write_shift(4,k);for(var E=[8,6815827,6619237,4849780,83],y=0;y<E.length;++y)x.write_shift(4,E[y]);if(k==28)wi(j=j.slice(1),x);else if(2&k){for(E="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),y=0;y<E.length;++y)x.write_shift(1,parseInt(E[y],16));var T=-1<b?j.slice(0,b):j;for(x.write_shift(4,2*(T.length+1)),y=0;y<T.length;++y)x.write_shift(2,T.charCodeAt(y));x.write_shift(2,0),8&k&&wi(-1<b?j.slice(b+1):"",x)}else{for(E="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),y=0;y<E.length;++y)x.write_shift(1,parseInt(E[y],16));for(var _=0;j.slice(3*_,3*_+3)=="../"||j.slice(3*_,3*_+3)=="..\\";)++_;for(x.write_shift(2,_),x.write_shift(4,j.length-3*_+1),y=0;y<j.length-3*_;++y)x.write_shift(1,255&j.charCodeAt(y+3*_));for(x.write_shift(1,0),x.write_shift(2,65535),x.write_shift(2,57005),y=0;y<6;++y)x.write_shift(4,0)}return x.slice(0,x.l)})(r[1])])}function O0(r,j,u){if(!u.cellStyles)return Oa(r,j);var h=u&&12<=u.biff?4:2,g=r.read_shift(h),b=r.read_shift(h),x=r.read_shift(h),y=r.read_shift(h),j=r.read_shift(2);return h==2&&(r.l+=2),y={s:g,e:b,w:x,ixfe:y,flags:j},(5<=u.biff||!u.biff)&&(y.level=j>>8&7),y}var P0=qa,I0=Nh,Bf=Hi,Sh,Ah,Ni,oo=[2,3,48,49,131,139,140,245],B0=(Sh={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},Ah=Mi({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),Ni={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(r,d){try{return Kn(Eh(r,d),d)}catch(u){if(d&&d.WTF)throw u}return{SheetNames:[],Sheets:{}}},to_sheet:Eh,from_sheet:function(r,d){if(0<=+(d=d||{}).codepage&&D(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");for(var u=Pa(),h=(d=Pu(r,{header:1,raw:!0,cellDates:!0}))[0],g=d.slice(1),b=r["!cols"]||[],k=0,x=0,y=0,j=1,k=0;k<h.length;++k)if(((b[k]||{}).DBF||{}).name)h[k]=b[k].DBF.name,++y;else if(h[k]!=null){if(++y,typeof h[k]=="number"&&(h[k]=h[k].toString(10)),typeof h[k]!="string")throw new Error("DBF Invalid column name "+h[k]+" |"+typeof h[k]+"|");if(h.indexOf(h[k])!==k){for(x=0;x<1024;++x)if(h.indexOf(h[k]+"_"+x)==-1){h[k]+="_"+x;break}}}var E=Fs(r["!ref"]),T=[],_=[],R=[];for(k=0;k<=E.e.c-E.s.c;++k){for(var q="",I="",ee=0,Y=[],x=0;x<g.length;++x)g[x][k]!=null&&Y.push(g[x][k]);if(Y.length!=0&&h[k]!=null){for(x=0;x<Y.length;++x){switch(typeof Y[x]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=Y[x]instanceof Date?"D":"C";break;default:I="C"}ee=Math.max(ee,String(Y[x]).length),q=q&&q!=I?"C":I}250<ee&&(ee=250),(I=((b[k]||{}).DBF||{}).type)=="C"&&b[k].DBF.len>ee&&(ee=b[k].DBF.len),q=="B"&&I=="N"&&(q="N",R[k]=b[k].DBF.dec,ee=b[k].DBF.len),_[k]=q=="C"||I=="N"?ee:Ni[q]||0,j+=_[k],T[k]=q}else T[k]="?"}var z,Z,ae=u.next(32);for(ae.write_shift(4,318902576),ae.write_shift(4,g.length),ae.write_shift(2,296+32*y),ae.write_shift(2,j),k=0;k<4;++k)ae.write_shift(4,0);for(ae.write_shift(4,0|(+Ah[v]||3)<<8),x=k=0;k<h.length;++k)h[k]!=null&&(z=u.next(32),Z=(h[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),z.write_shift(1,Z,"sbcs"),z.write_shift(1,T[k]=="?"?"C":T[k],"sbcs"),z.write_shift(4,x),z.write_shift(1,_[k]||Ni[T[k]]||0),z.write_shift(1,R[k]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),x+=_[k]||Ni[T[k]]||0);var ie=u.next(264);for(ie.write_shift(4,13),k=0;k<65;++k)ie.write_shift(4,0);for(k=0;k<g.length;++k){var Ee=u.next(j);for(Ee.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(T[x]){case"L":Ee.write_shift(1,g[k][x]==null?63:g[k][x]?84:70);break;case"B":Ee.write_shift(8,g[k][x]||0,"f");break;case"N":var We="0";for(typeof g[k][x]=="number"&&(We=g[k][x].toFixed(R[x]||0)),y=0;y<_[x]-We.length;++y)Ee.write_shift(1,32);Ee.write_shift(1,We,"sbcs");break;case"D":g[k][x]?(Ee.write_shift(4,("0000"+g[k][x].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(g[k][x].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+g[k][x].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var Ie=String(g[k][x]!=null?g[k][x]:"").slice(0,_[x]);for(Ee.write_shift(1,Ie,"sbcs"),y=0;y<_[x]-Ie.length;++y)Ee.write_shift(1,32)}}return u.next(1).write_shift(1,26),u.end()}});function Eh(r,d){return d=d||{},d.dateNF||(d.dateNF="yyyymmdd"),r=Ql((function(u,h){var g=[],b=J(1);switch(h.type){case"base64":b=le(Ce(u));break;case"binary":b=le(u);break;case"buffer":case"array":b=u}Sa(b,0);var x=b.read_shift(1),y=!!(136&x),j=!1,k=!1;switch(x){case 2:case 3:break;case 48:case 49:y=j=!0;break;case 131:case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var E=0,T=521;x==2&&(E=b.read_shift(2)),b.l+=3,1048576<(E=x!=2?b.read_shift(4):E)&&(E=1e6),x!=2&&(T=b.read_shift(2));var _=b.read_shift(2),R=h.codepage||1252;x!=2&&(b.l+=16,b.read_shift(1),b[b.l]!==0&&(R=Sh[b[b.l]]),b.l+=1,b.l+=2),k&&(b.l+=36);for(var q=[],I={},ee=Math.min(b.length,x==2?521:T-10-(j?264:0)),Y=k?32:11;b.l<ee&&b[b.l]!=13;)switch((I={}).name=e.utils.decode(R,b.slice(b.l,b.l+Y)).replace(/[\u0000\r\n].*$/g,""),b.l+=Y,I.type=String.fromCharCode(b.read_shift(1)),x==2||k||(I.offset=b.read_shift(4)),I.len=b.read_shift(1),x==2&&(I.offset=b.read_shift(2)),I.dec=b.read_shift(1),I.name.length&&q.push(I),x!=2&&(b.l+=k?13:14),I.type){case"B":j&&I.len==8||!h.WTF||console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(b[b.l]!==13&&(b.l=T-1),b.read_shift(1)!==13)throw new Error("DBF Terminator not found "+b.l+" "+b[b.l]);b.l=T;var z=0,Z=0;for(g[0]=[],Z=0;Z!=q.length;++Z)g[0][Z]=q[Z].name;for(;0<E--;)if(b[b.l]!==42)for(++b.l,g[++z]=[],Z=Z=0;Z!=q.length;++Z){var ae=b.slice(b.l,b.l+q[Z].len);b.l+=q[Z].len,Sa(ae,0);var ie=e.utils.decode(R,ae);switch(q[Z].type){case"C":ie.trim().length&&(g[z][Z]=ie.replace(/\s+$/,""));break;case"D":ie.length===8?g[z][Z]=new Date(+ie.slice(0,4),+ie.slice(4,6)-1,+ie.slice(6,8)):g[z][Z]=ie;break;case"F":g[z][Z]=parseFloat(ie.trim());break;case"+":case"I":g[z][Z]=k?2147483648^ae.read_shift(-4,"i"):ae.read_shift(4,"i");break;case"L":switch(ie.trim().toUpperCase()){case"Y":case"T":g[z][Z]=!0;break;case"N":case"F":g[z][Z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ie+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));g[z][Z]="##MEMO##"+(k?parseInt(ie.trim(),10):ae.read_shift(4));break;case"N":(ie=ie.replace(/\u0000/g,"").trim())&&ie!="."&&(g[z][Z]=+ie||0);break;case"@":g[z][Z]=new Date(ae.read_shift(-8,"f")-621356832e5);break;case"T":g[z][Z]=new Date(864e5*(ae.read_shift(4)-2440588)+ae.read_shift(4));break;case"Y":g[z][Z]=ae.read_shift(4,"i")/1e4+ae.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[z][Z]=-ae.read_shift(-8,"f");break;case"B":if(j&&q[Z].len==8){g[z][Z]=ae.read_shift(8,"f");break}case"G":case"P":ae.l+=q[Z].len;break;case"0":if(q[Z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+q[Z].type)}}else b.l+=_;if(x!=2&&b.l<b.length&&b[b.l++]!=26)throw new Error("DBF EOF Marker missing "+(b.l-1)+" of "+b.length+" "+b[b.l-1].toString(16));return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),h.DBF=q,g})(r,d),d),r["!cols"]=d.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete d.DBF,r}var $i,tc,cd,sc,dd=($i={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},tc=new RegExp("\x1BN("+is($i).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),cd=function(r,d){return d=$i[d],typeof d=="number"?K(d):d},sc=function(r,d,u){return u=d.charCodeAt(0)-32<<4|u.charCodeAt(0)-48,u==59?r:K(u)},$i["|"]=254,{to_workbook:function(r,d){return Kn(jl(r,d),d)},to_sheet:jl,from_sheet:function(r,d){var u,h,g=["ID;PWXL;N;E"],b=[],x=Fs(r["!ref"]),y=Array.isArray(r),j=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),r["!cols"]&&(u=g,r["!cols"].forEach(function(_,R){R="F;W"+(R+1)+" "+(R+1)+" ",_.hidden?R+="0":(typeof _.width!="number"||_.wpx||(_.wpx=oc(_.width)),typeof _.wpx!="number"||_.wch||(_.wch=kl(_.wpx)),typeof _.wch=="number"&&(R+=Math.round(_.wch))),R.charAt(R.length-1)!=" "&&u.push(R)})),r["!rows"]&&(h=g,r["!rows"].forEach(function(_,R){var q="F;";_.hidden?q+="M0;":_.hpt?q+="M"+20*_.hpt+";":_.hpx&&(q+="M"+20*cc(_.hpx)+";"),2<q.length&&h.push(q+"R"+(R+1))})),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var k=x.s.r;k<=x.e.r;++k)for(var E=x.s.c;E<=x.e.c;++E){var T=bs({r:k,c:E});(T=y?(r[k]||[])[E]:r[T])&&(T.v!=null||T.f&&!T.F)&&b.push((function(_,R,q){var I="C;Y"+(R+1)+";X"+(q+1)+";K";switch(_.t){case"n":I+=_.v||0,_.f&&!_.F&&(I+=";E"+nu(_.f,{r:R,c:q}));break;case"b":I+=_.v?"TRUE":"FALSE";break;case"e":I+=_.w||_.v;break;case"d":I+='"'+(_.w||_.v)+'"';break;case"s":I+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return I})(T,k,E))}return g.join(j)+j+b.join(j)+j+"E"+j}});function ud(_,d){var u,h,g=_.split(/[\n\r]+/),b=-1,x=-1,y=0,j=0,k=[],E=[],T=null,_={},R=[],q=[],I=0;for(0<=+d.codepage&&D(+d.codepage);y!==g.length;++y){I=0;var ee,Y=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,sc).replace(tc,cd),z=Y.replace(/;;/g,"\0").split(";").map(function(St){return St.replace(/\u0000/g,";")}),Z=z[0];if(0<Y.length)switch(Z){case"ID":case"E":case"B":case"O":case"W":break;case"P":z[1].charAt(0)=="P"&&E.push(Y.slice(3).replace(/;;/g,";"));break;case"C":for(var ae=!1,ie=!1,Ee=!1,We=!1,Ie=-1,Je=-1,j=1;j<z.length;++j)switch(z[j].charAt(0)){case"A":break;case"X":x=parseInt(z[j].slice(1))-1,ie=!0;break;case"Y":for(b=parseInt(z[j].slice(1))-1,ie||(x=0),h=k.length;h<=b;++h)k[h]=[];break;case"K":(ee=z[j].slice(1)).charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(en(ee))?isNaN(mn(ee).getDate())||(ee=_s(ee)):(ee=en(ee),T!==null&&$r(T)&&(ee=mi(ee))),e!==void 0&&typeof ee=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(ee=e.utils.decode(d.codepage,ee)),ae=!0;break;case"E":We=!0;var bt=xo(z[j].slice(1),{r:b,c:x});k[b][x]=[k[b][x],bt];break;case"S":Ee=!0,k[b][x]=[k[b][x],"S5S"];break;case"G":break;case"R":Ie=parseInt(z[j].slice(1))-1;break;case"C":Je=parseInt(z[j].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+Y)}if(ae&&(k[b][x]&&k[b][x].length==2?k[b][x][0]=ee:k[b][x]=ee,T=null),Ee){if(We)throw new Error("SYLK shared formula cannot have own formula");var yt=-1<Ie&&k[Ie][Je];if(!yt||!yt[1])throw new Error("SYLK shared formula cannot find base");k[b][x][1]=Sd(yt[1],{r:b-Ie,c:x-Je})}break;case"F":var it=0;for(j=1;j<z.length;++j)switch(z[j].charAt(0)){case"X":x=parseInt(z[j].slice(1))-1,++it;break;case"Y":for(b=parseInt(z[j].slice(1))-1,h=k.length;h<=b;++h)k[h]=[];break;case"M":I=parseInt(z[j].slice(1))/20;break;case"F":case"G":break;case"P":T=E[parseInt(z[j].slice(1))];break;case"S":case"D":case"N":break;case"W":for(u=z[j].slice(1).split(" "),h=parseInt(u[0],10);h<=parseInt(u[1],10);++h)I=parseInt(u[2],10),q[h-1]=I===0?{hidden:!0}:{wch:I},Cl(q[h-1]);break;case"C":q[x=parseInt(z[j].slice(1))-1]||(q[x]={});break;case"R":R[b=parseInt(z[j].slice(1))-1]||(R[b]={}),0<I?(R[b].hpt=I,R[b].hpx=po(I)):I===0&&(R[b].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+Y)}it<1&&(T=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+Y)}}return 0<R.length&&(_["!rows"]=R),0<q.length&&(_["!cols"]=q),[k=d&&d.sheetRows?k.slice(0,d.sheetRows):k,_]}function jl(h,d){var u=(function(x,y){switch(y.type){case"base64":return ud(Ce(x),y);case"binary":return ud(x,y);case"buffer":return ud(ge&&Buffer.isBuffer(x)?x.toString("binary"):me(x),y);case"array":return ud(Ha(x),y)}throw new Error("Unrecognized type "+y.type)})(h,d),h=u[0],g=u[1],b=Ql(h,d);return is(g).forEach(function(x){b[x]=g[x]}),b}var Dh={to_workbook:function(r,d){return Kn(z0(r,d),d)},to_sheet:z0,from_sheet:function(r){var d=[],u=Fs(r["!ref"]),h=Array.isArray(r);rc(d,"TABLE",0,1,"sheetjs"),rc(d,"VECTORS",0,u.e.r-u.s.r+1,""),rc(d,"TUPLES",0,u.e.c-u.s.c+1,""),rc(d,"DATA",0,0,"");for(var g=u.s.r;g<=u.e.r;++g){Da(d,-1,0,"BOT");for(var b=u.s.c;b<=u.e.c;++b){var x,y=bs({r:g,c:b});if(x=h?(r[g]||[])[b]:r[y])switch(x.t){case"n":var j=x.w;(j=!j&&x.v!=null?x.v:j)==null?x.f&&!x.F?Da(d,1,0,"="+x.f):Da(d,1,0,""):Da(d,0,j,"V");break;case"b":Da(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":Da(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Ir(x.z||W[14],qr(_s(x.v)))),Da(d,0,x.w,"V");break;default:Da(d,1,0,"")}else Da(d,1,0,"")}}return Da(d,-1,0,"EOD"),d.join(`\r
`)}};function ti(r,d){for(var u=r.split(`
`),h=-1,g=-1,b=0,x=[];b!==u.length;++b)if(u[b].trim()!=="BOT"){if(!(h<0)){for(var y=u[b].trim().split(","),j=y[0],k=y[1],E=u[++b]||"";1&(E.match(/["]/g)||[]).length&&b<u.length-1;)E+=`
`+u[++b];switch(E=E.trim(),+j){case-1:if(E==="BOT"){x[++h]=[],g=0;continue}if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?x[h][g]=!0:E==="FALSE"?x[h][g]=!1:isNaN(en(k))?isNaN(mn(k).getDate())?x[h][g]=k:x[h][g]=_s(k):x[h][g]=en(k),++g;break;case 1:E=(E=E.slice(1,E.length-1)).replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),x[h][g++]=E!==""?E:null}if(E==="EOD")break}}else x[++h]=[],g=0;return x=d&&d.sheetRows?x.slice(0,d.sheetRows):x}function z0(r,d){return Ql((function(u,h){switch(h.type){case"base64":return ti(Ce(u),h);case"binary":return ti(u,h);case"buffer":return ti(ge&&Buffer.isBuffer(u)?u.toString("binary"):me(u),h);case"array":return ti(Ha(u),h)}throw new Error("Unrecognized type "+h.type)})(r,d),d)}function rc(r,d,u,h,g){r.push(d),r.push(u+","+h),r.push('"'+g.replace(/"/g,'""')+'"')}function Da(r,d,u,h){r.push(d+","+u),r.push(d==1?'"'+h.replace(/"/g,'""')+'"':h)}var qi,co,U0,H0,ac=(qi=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),co=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,U0=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),H0="--SocialCalcSpreadsheetControlSave--",{to_workbook:function(r,d){return Kn(Th(r,d),d)},to_sheet:Th,from_sheet:function(r){return[qi,co,U0,co,(function(d){if(!d||!d["!ref"])return"";for(var u,h,g=[],b=[],x=Ia(d["!ref"]),y=Array.isArray(d),j=x.s.r;j<=x.e.r;++j)for(var k=x.s.c;k<=x.e.c;++k)if(h=bs({r:j,c:k}),(u=y?(d[j]||[])[k]:d[h])&&u.v!=null&&u.t!=="z"){switch(b=["cell",h,"t"],u.t){case"s":case"str":b.push(uo(u.v));break;case"n":u.f?(b[2]="vtf",b[3]="n",b[4]=u.v,b[5]=uo(u.f)):(b[2]="v",b[3]=u.v);break;case"b":b[2]="vt"+(u.f?"f":"c"),b[3]="nl",b[4]=u.v?"1":"0",b[5]=uo(u.f||(u.v?"TRUE":"FALSE"));break;case"d":var E=qr(_s(u.v));b[2]="vtc",b[3]="nd",b[4]=""+E,b[5]=u.w||Ir(u.z||W[14],E);break;case"e":continue}g.push(b.join(":"))}return g.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)})(r),H0].join(`
`)}});function uo(r){return r.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function Th(r,d){return Ql((function(u,h){for(var g,b=u.split(`
`),x=-1,y=0,j=[];y!==b.length;++y){var k=b[y].trim().split(":");if(k[0]==="cell"){var E=Hr(k[1]);if(j.length<=E.r)for(x=j.length;x<=E.r;++x)j[x]||(j[x]=[]);switch(x=E.r,g=E.c,k[2]){case"t":j[x][g]=k[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`);break;case"v":j[x][g]=+k[3];break;case"vtf":var T=k[k.length-1];case"vtc":k[3]==="nl"?j[x][g]=!!+k[4]:j[x][g]=+k[4],k[2]=="vtf"&&(j[x][g]=[j[x][g],T])}}}return j=h&&h.sheetRows?j.slice(0,h.sheetRows):j})(r,d),d)}var V0,Yi,Gi=(V0={44:",",9:"	",59:";",124:"|"},Yi={44:3,9:2,59:1,124:0},{to_workbook:function(r,d){return Kn(kn(r,d),d)},to_sheet:kn,from_sheet:function(r){for(var d=[],u=Fs(r["!ref"]),h=Array.isArray(r),g=u.s.r;g<=u.e.r;++g){for(var b=[],x=u.s.c;x<=u.e.c;++x){var y=bs({r:g,c:x});if((y=h?(r[g]||[])[x]:r[y])&&y.v!=null){for(var j=(y.w||(xi(y),y.w)||"").slice(0,10);j.length<10;)j+=" ";b.push(j+(x===0?" ":""))}else b.push("          ")}d.push(b.join(""))}return d.join(`
`)}});function _h(r,d,u,h,g){g.raw?d[u][h]=r:r===""||(r==="TRUE"?d[u][h]=!0:r==="FALSE"?d[u][h]=!1:isNaN(en(r))?isNaN(mn(r).getDate())?d[u][h]=r:d[u][h]=_s(r):d[u][h]=en(r))}function W0(r){for(var d={},u=!1,h=0,g=0;h<r.length;++h)(g=r.charCodeAt(h))==34?u=!u:!u&&g in V0&&(d[g]=(d[g]||0)+1);for(h in g=[],d)Object.prototype.hasOwnProperty.call(d,h)&&g.push([d[h],h]);if(!g.length)for(h in d=Yi)Object.prototype.hasOwnProperty.call(d,h)&&g.push([d[h],h]);return g.sort(function(b,x){return b[0]-x[0]||Yi[b[1]]-Yi[x[1]]}),V0[g.pop()[1]]||44}function Fh(r,h){var u=h||{},h="",g=u.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};r.slice(0,4)=="sep="?r.charCodeAt(5)==13&&r.charCodeAt(6)==10?(h=r.charAt(4),r=r.slice(7)):r.charCodeAt(5)==13||r.charCodeAt(5)==10?(h=r.charAt(4),r=r.slice(6)):h=W0(r.slice(0,1024)):h=u&&u.FS?u.FS:W0(r.slice(0,1024));var x=0,y=0,j=0,k=0,E=0,T=h.charCodeAt(0),_=!1,R=0,q=r.charCodeAt(0);r=r.replace(/\r\n/gm,`
`);var I=u.dateNF!=null?(h=(h=typeof(h=u.dateNF)=="number"?W[h]:h).replace(Vl,"(\\d+)"),new RegExp("^"+h+"$")):null;function ee(){var Y,z=r.slice(k,E),Z={};if((z=z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'?z.slice(1,-1).replace(/""/g,'"'):z).length===0?Z.t="z":u.raw||z.trim().length===0?(Z.t="s",Z.v=z):z.charCodeAt(0)==61?z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(Z.t="s",Z.v=z.slice(2,-1).replace(/""/g,'"')):z.length!=1?(Z.t="n",Z.f=z.slice(1)):(Z.t="s",Z.v=z):z=="TRUE"?(Z.t="b",Z.v=!0):z=="FALSE"?(Z.t="b",Z.v=!1):isNaN(j=en(z))?!isNaN(mn(z).getDate())||I&&z.match(I)?(Z.z=u.dateNF||W[14],Y=0,I&&z.match(I)&&(z=(function(ae,ie){var Ee=-1,We=-1,Ie=-1,Je=-1,bt=-1,yt=-1;(ae.match(Vl)||[]).forEach(function(St,Ht){var zt=parseInt(ie[Ht+1],10);switch(St.toLowerCase().charAt(0)){case"y":Ee=zt;break;case"d":Ie=zt;break;case"h":Je=zt;break;case"s":yt=zt;break;case"m":0<=Je?bt=zt:We=zt}}),0<=yt&&bt==-1&&0<=We&&(bt=We,We=-1);var it=(""+(0<=Ee?Ee:new Date().getFullYear())).slice(-4)+"-"+("00"+(1<=We?We:1)).slice(-2)+"-"+("00"+(1<=Ie?Ie:1)).slice(-2);return(it=it.length==7?"0"+it:it).length==8&&(it="20"+it),ae=("00"+(0<=Je?Je:0)).slice(-2)+":"+("00"+(0<=bt?bt:0)).slice(-2)+":"+("00"+(0<=yt?yt:0)).slice(-2),Je==-1&&bt==-1&&yt==-1?it:Ee==-1&&We==-1&&Ie==-1?ae:it+"T"+ae})(u.dateNF,z.match(I)||[]),Y=1),u.cellDates?(Z.t="d",Z.v=_s(z,Y)):(Z.t="n",Z.v=qr(_s(z,Y))),u.cellText!==!1&&(Z.w=Ir(Z.z,Z.v instanceof Date?qr(Z.v):Z.v)),u.cellNF||delete Z.z):(Z.t="s",Z.v=z):(!(Z.t="n")!==u.cellText&&(Z.w=z),Z.v=j),Z.t=="z"||(u.dense?(g[x]||(g[x]=[]),g[x][y]=Z):g[bs({c:y,r:x})]=Z),k=E+1,q=r.charCodeAt(k),b.e.c<y&&(b.e.c=y),b.e.r<x&&(b.e.r=x),R!=T)return y=0,++x,u.sheetRows&&u.sheetRows<=x?1:void 0;++y}e:for(;E<r.length;++E)switch(R=r.charCodeAt(E)){case 34:q===34&&(_=!_);break;case T:case 10:case 13:if(!_&&ee())break e}return 0<E-k&&ee(),g["!ref"]=Cs(b),g}function Nn(r,d){return!d||!d.PRN||d.FS||r.slice(0,4)=="sep="||0<=r.indexOf("	")||0<=r.indexOf(",")||0<=r.indexOf(";")?Fh(r,d):Ql((function(u,h){var g=h||{},b=[];if(!u||u.length===0)return b;for(var x=u.split(/[\r\n]/),y=x.length-1;0<=y&&x[y].length===0;)--y;for(var j=10,k=0,E=0;E<=y;++E)(k=x[E].indexOf(" "))==-1?k=x[E].length:k++,j=Math.max(j,k);for(E=0;E<=y;++E){b[E]=[];var T=0;for(_h(x[E].slice(0,j).trim(),b,E,T,g),T=1;T<=(x[E].length-j)/10+1;++T)_h(x[E].slice(j+10*(T-1),j+10*T).trim(),b,E,T,g)}return b=g.sheetRows?b.slice(0,g.sheetRows):b})(r,d),d)}function kn(r,d){var u="",h=d.type=="string"?[0,0,0,0]:Ff(r,d);switch(d.type){case"base64":u=Ce(r);break;case"binary":u=r;break;case"buffer":u=d.codepage==65001?r.toString("utf8"):d.codepage&&e!==void 0?e.utils.decode(d.codepage,r):ge&&Buffer.isBuffer(r)?r.toString("binary"):me(r);break;case"array":u=Ha(r);break;case"string":u=r;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?u=Oe(u.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?u=Oe(u):d.type=="binary"&&e!==void 0&&d.codepage&&(u=e.utils.decode(d.codepage,e.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?ac.to_sheet(d.type=="string"?u:Oe(u),d):Nn(u,d)}var si,hd,$0,Ki,da=(si={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},hd=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""],$0={0:{n:"BOF",f:br},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(r,d,u){var h={s:{c:0,r:0},e:{c:0,r:0}};return d==8&&u.qpro?(h.s.c=r.read_shift(1),r.l++,h.s.r=r.read_shift(2),h.e.c=r.read_shift(1),r.l++,h.e.r=r.read_shift(2)):(h.s.c=r.read_shift(2),h.s.r=r.read_shift(2),d==12&&u.qpro&&(r.l+=2),h.e.c=r.read_shift(2),h.e.r=r.read_shift(2),d==12&&u.qpro&&(r.l+=2),h.s.c==65535&&(h.s.c=h.e.c=h.s.r=h.e.r=0)),h}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(r,d,u){return(u=On(r,0,u))[1].v=r.read_shift(2,"i"),u}},14:{n:"NUMBER",f:function(r,d,u){return(u=On(r,0,u))[1].v=r.read_shift(8,"f"),u}},15:{n:"LABEL",f:Ss},16:{n:"FORMULA",f:function(r,d,u){var h=r.l+d;return(d=On(r,0,u))[1].v=r.read_shift(8,"f"),u.qpro?r.l=h:(h=r.read_shift(2),(function(g,b){Sa(g,0);for(var x=[],y=0,j="",k="",E="",T="";g.l<g.length;){var _=g[g.l++];switch(_){case 0:x.push(g.read_shift(8,"f"));break;case 1:k=Xs(b[0].c,g.read_shift(2),!0),j=Xs(b[0].r,g.read_shift(2),!1),x.push(k+j);break;case 2:var R=Xs(b[0].c,g.read_shift(2),!0),q=Xs(b[0].r,g.read_shift(2),!1);k=Xs(b[0].c,g.read_shift(2),!0),j=Xs(b[0].r,g.read_shift(2),!1),x.push(R+q+":"+k+j);break;case 3:if(g.l<g.length)return console.error("WK1 premature formula end");break;case 4:x.push("("+x.pop()+")");break;case 5:x.push(g.read_shift(2));break;case 6:for(var I="";_=g[g.l++];)I+=String.fromCharCode(_);x.push('"'+I.replace(/"/g,'""')+'"');break;case 8:x.push("-"+x.pop());break;case 23:x.push("+"+x.pop());break;case 22:x.push("NOT("+x.pop()+")");break;case 20:case 21:T=x.pop(),E=x.pop(),x.push(["AND","OR"][_-20]+"("+E+","+T+")");break;default:if(_<32&&hd[_])T=x.pop(),E=x.pop(),x.push(E+hd[_]+T);else{if(!si[_])return _<=7?console.error("WK1 invalid opcode "+_.toString(16)):_<=24?console.error("WK1 unsupported op "+_.toString(16)):_<=30?console.error("WK1 invalid opcode "+_.toString(16)):_<=115?console.error("WK1 unsupported function opcode "+_.toString(16)):console.error("WK1 unrecognized opcode "+_.toString(16));if((y=(y=si[_][1])==69?g[g.l++]:y)>x.length)return console.error("WK1 bad formula parse 0x"+_.toString(16)+":|"+x.join("|")+"|");q=x.slice(-y),x.length-=y,x.push(si[_][0]+"("+q.join(",")+")")}}}x.length==1?b[1].f=""+x[0]:console.error("WK1 bad formula parse |"+x.join("|")+"|")})(r.slice(r.l,r.l+h),d),r.l+=h),d}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:Ss},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Nl},222:{n:"SHEETNAMELP",f:function(r,d){var u=r[r.l++];d-1<u&&(u=d-1);for(var h="";h.length<u;)h+=String.fromCharCode(r[r.l++]);return h}},65535:{n:""}},Ki={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(r,d){var u=Lr(r);return u[1].t="s",u[1].v=r.read_shift(d-4,"cstr"),u}},23:{n:"NUMBER17",f:fd},24:{n:"NUMBER18",f:function(r,d){var u=Lr(r);u[1].v=r.read_shift(2);var h=u[1].v>>1;if(1&u[1].v)switch(7&h){case 0:h=5e3*(h>>3);break;case 1:h=500*(h>>3);break;case 2:h=(h>>3)/20;break;case 3:h=(h>>3)/200;break;case 4:h=(h>>3)/2e3;break;case 5:h=(h>>3)/2e4;break;case 6:h=(h>>3)/16;break;case 7:h=(h>>3)/64}return u[1].v=h,u}},25:{n:"FORMULA19",f:function(r,d){var u=fd(r);return r.l+=d-14,u}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(r,d){for(var u={},h=r.l+d;r.l<h;){var g=r.read_shift(2);if(g==14e3){for(u[g]=[0,""],u[g][0]=r.read_shift(2);r[r.l];)u[g][1]+=String.fromCharCode(r[r.l]),r.l++;r.l++}}return u}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(h,d){var u=Lr(h),h=h.read_shift(4);return u[1].v=h>>6,u}},38:{n:"??"},39:{n:"NUMBER27",f:ho},40:{n:"FORMULA28",f:function(r,d){var u=ho(r);return r.l+=d-10,u}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Nl},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(r,d,u){if(u.qpro&&!(d<21))return u=r.read_shift(1),r.l+=17,r.l+=1,r.l+=2,[u,r.read_shift(d-21,"cstr")]}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},{sheet_to_wk1:function(r,d){var u=d||{};if(0<=+u.codepage&&D(+u.codepage),u.type=="string")throw new Error("Cannot write WK1 to JS string");var h=Pa(),g=Fs(r["!ref"]),b=Array.isArray(r),x=[];It(h,0,(d=1030,(u=pt(2)).write_shift(2,d),u)),It(h,6,(d=g,(u=pt(8)).write_shift(2,d.s.c),u.write_shift(2,d.s.r),u.write_shift(2,d.e.c),u.write_shift(2,d.e.r),u));for(var y,j,k,E,T=Math.min(g.e.r,8191),_=g.s.r;_<=T;++_)for(var R=Ur(_),q=g.s.c;q<=g.e.c;++q){_===g.s.r&&(x[q]=Ar(q));var I=x[q]+R,I=b?(r[_]||[])[q]:r[I];I&&I.t!="z"&&(I.t=="n"?(0|I.v)==I.v&&-32768<=I.v&&I.v<=32767?It(h,13,(y=_,j=q,k=I.v,E=void 0,(E=pt(7)).write_shift(1,255),E.write_shift(2,j),E.write_shift(2,y),E.write_shift(2,k,"i"),E)):It(h,14,(j=_,y=q,k=I.v,E=void 0,(E=pt(13)).write_shift(1,255),E.write_shift(2,y),E.write_shift(2,j),E.write_shift(8,k,"f"),E)):It(h,15,(function(ee,Y,z){var Z=pt(7+z.length);Z.write_shift(1,255),Z.write_shift(2,Y),Z.write_shift(2,ee),Z.write_shift(1,39);for(var ae=0;ae<Z.length;++ae){var ie=z.charCodeAt(ae);Z.write_shift(1,128<=ie?95:ie)}return Z.write_shift(1,0),Z})(_,q,xi(I).slice(0,239))))}return It(h,1),h.end()},book_to_wk3:function(r,d){if(0<=+(d=d||{}).codepage&&D(+d.codepage),d.type=="string")throw new Error("Cannot write WK3 to JS string");var u=Pa();It(u,0,(function(I){var ee=pt(26);ee.write_shift(2,4096),ee.write_shift(2,4),ee.write_shift(4,0);for(var Y=0,z=0,Z=0,ae=0;ae<I.SheetNames.length;++ae){var ie=I.SheetNames[ae],ie=I.Sheets[ie];ie&&ie["!ref"]&&(++Z,ie=Ia(ie["!ref"]),Y<ie.e.r&&(Y=ie.e.r),z<ie.e.c&&(z=ie.e.c))}return 8191<Y&&(Y=8191),ee.write_shift(2,Y),ee.write_shift(1,Z),ee.write_shift(1,z),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(1,1),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(4,0),ee})(r));for(var h=0,g=0;h<r.SheetNames.length;++h)(r.Sheets[r.SheetNames[h]]||{})["!ref"]&&It(u,27,(function(I,ee){var Y=pt(5+I.length);Y.write_shift(2,14e3),Y.write_shift(2,ee);for(var z=0;z<I.length;++z){var Z=I.charCodeAt(z);Y[Y.l++]=127<Z?95:Z}return Y[Y.l++]=0,Y})(r.SheetNames[h],g++));for(var b=0,h=0;h<r.SheetNames.length;++h){var x=r.Sheets[r.SheetNames[h]];if(x&&x["!ref"]){for(var y=Fs(x["!ref"]),j=Array.isArray(x),k=[],E=Math.min(y.e.r,8191),T=y.s.r;T<=E;++T)for(var _=Ur(T),R=y.s.c;R<=y.e.c;++R){T===y.s.r&&(k[R]=Ar(R));var q=k[R]+_,q=j?(x[T]||[])[R]:x[q];q&&q.t!="z"&&(q.t=="n"?It(u,23,(function(Ee,Ie,We,Z){var ae=pt(14);if(ae.write_shift(2,Ee),ae.write_shift(1,We),ae.write_shift(1,Ie),Z==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var ie=0,Ee=0,We=0,Ie=0;return Z<0&&(ie=1,Z=-Z),Ee=0|Math.log2(Z),Z/=Math.pow(2,Ee-31),(2147483648&(Ie=Z>>>0))==0&&(++Ee,Ie=(Z/=2)>>>0),Z-=Ie,Ie|=2147483648,Ie>>>=0,Z*=Math.pow(2,32),We=Z>>>0,ae.write_shift(4,We),ae.write_shift(4,Ie),Ee+=16383+(ie?32768:0),ae.write_shift(2,Ee),ae})(T,R,b,q.v)):It(u,22,(function(ee,Y,z,Z){var ae=pt(6+Z.length);ae.write_shift(2,ee),ae.write_shift(1,z),ae.write_shift(1,Y),ae.write_shift(1,39);for(var ie=0;ie<Z.length;++ie){var Ee=Z.charCodeAt(ie);ae.write_shift(1,128<=Ee?95:Ee)}return ae.write_shift(1,0),ae})(T,R,b,xi(q).slice(0,239))))}++b}}return It(u,1),u.end()},to_workbook:function(r,d){switch(d.type){case"base64":return nc(le(Ce(r)),d);case"binary":return nc(le(r),d);case"buffer":case"array":return nc(r,d)}throw"Unsupported type "+d.type}});function Yr(r,d,u){if(r){Sa(r,r.l||0);for(var h=u.Enum||$0;r.l<r.length;){var g=r.read_shift(2),b=h[g]||h[65535],y=r.read_shift(2),x=r.l+y,y=b.f&&b.f(r,y,u);if(r.l=x,d(y,b,g))return}}}function nc(r,d){if(!r)return r;var u=d||{},h=u.dense?[]:{},g="Sheet1",b="",x=0,y={},j=[],k=[],E={s:{r:0,c:0},e:{r:0,c:0}},T=u.sheetRows||0;if(r[2]==0&&(r[3]==8||r[3]==9)&&16<=r.length&&r[14]==5&&r[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(r[2]==2)u.Enum=$0,Yr(r,function(I,ee,Y){switch(Y){case 0:4096<=(u.vers=I)&&(u.qpro=!0);break;case 6:E=I;break;case 204:I&&(b=I);break;case 222:b=I;break;case 15:case 51:u.qpro||(I[1].v=I[1].v.slice(1));case 13:case 14:case 16:Y==14&&(112&I[2])==112&&1<(15&I[2])&&(15&I[2])<15&&(I[1].z=u.dateNF||W[14],u.cellDates&&(I[1].t="d",I[1].v=mi(I[1].v))),u.qpro&&I[3]>x&&(h["!ref"]=Cs(E),y[g]=h,j.push(g),h=u.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},x=I[3],g=b||"Sheet"+(x+1),b="");var z=u.dense?(h[I[0].r]||[])[I[0].c]:h[bs(I[0])];if(z){z.t=I[1].t,z.v=I[1].v,I[1].z!=null&&(z.z=I[1].z),I[1].f!=null&&(z.f=I[1].f);break}u.dense?(h[I[0].r]||(h[I[0].r]=[]),h[I[0].r][I[0].c]=I[1]):h[bs(I[0])]=I[1]}},u);else{if(r[2]!=26&&r[2]!=14)throw new Error("Unrecognized LOTUS BOF "+r[2]);u.Enum=Ki,r[2]==14&&(u.qpro=!0,r.l=0),Yr(r,function(I,ee,Y){switch(Y){case 204:g=I;break;case 22:I[1].v=I[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(I[3]>x&&(h["!ref"]=Cs(E),y[g]=h,j.push(g),h=u.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},x=I[3],g="Sheet"+(x+1)),0<T&&I[0].r>=T)break;u.dense?(h[I[0].r]||(h[I[0].r]=[]),h[I[0].r][I[0].c]=I[1]):h[bs(I[0])]=I[1],E.e.c<I[0].c&&(E.e.c=I[0].c),E.e.r<I[0].r&&(E.e.r=I[0].r);break;case 27:I[14e3]&&(k[I[14e3][0]]=I[14e3][1]);break;case 1537:k[I[0]]=I[1],I[0]==x&&(g=I[1])}},u)}if(h["!ref"]=Cs(E),y[b||g]=h,j.push(b||g),!k.length)return{SheetNames:j,Sheets:y};for(var _={},R=[],q=0;q<k.length;++q)y[j[q]]?(R.push(k[q]||j[q]),_[k[q]]=y[k[q]]||y[j[q]]):(R.push(k[q]),_[k[q]]={"!ref":"A1"});return{SheetNames:R,Sheets:_}}function On(r,d,u){var h=[{c:0,r:0},{t:"n",v:0},0,0];return u.qpro&&u.vers!=20768?(h[0].c=r.read_shift(1),h[3]=r.read_shift(1),h[0].r=r.read_shift(2),r.l+=2):(h[2]=r.read_shift(1),h[0].c=r.read_shift(2),h[0].r=r.read_shift(2)),h}function Ss(r,g,u){var h=r.l+g,g=On(r,0,u);return g[1].t="s",u.vers!=20768?(u.qpro&&r.l++,g[1].v=r.read_shift(h-r.l,"cstr"),g):(r.l++,h=r.read_shift(1),g[1].v=r.read_shift(h,"utf8"),g)}function Xs(r,d,u){var h=32768&d;return(h?"":"$")+(u?Ar:Ur)(d=(h?r:0)+(8192<=(d&=-32769)?d-16384:d))}function Lr(r){var d=[{c:0,r:0},{t:"n",v:0},0];return d[0].r=r.read_shift(2),d[3]=r[r.l++],d[0].c=r[r.l++],d}function fd(b,d){var u=Lr(b),h=b.read_shift(4),g=b.read_shift(4);if((x=b.read_shift(2))==65535)return h===0&&g===3221225472?(u[1].t="e",u[1].v=15):h===0&&g===3489660928?(u[1].t="e",u[1].v=42):u[1].v=0,u;var b=32768&x,x=(32767&x)-16446;return u[1].v=(1-2*b)*(g*Math.pow(2,32+x)+h*Math.pow(2,x)),u}function ho(h,d){var u=Lr(h),h=h.read_shift(8,"f");return u[1].v=h,u}function Nl(r,d){return r[r.l+d-1]==0?r.read_shift(d,"cstr"):""}var md,ic,fo,Om,Gr=(md=He("t"),ic=He("rPr"),fo=/<(?:\w+:)?r>/g,Om=/<\/(?:\w+:)?r>/,function(r){return r.replace(fo,"").split(Om).map(Mh).filter(function(d){return d.v})});function Mh(r){var d=r.match(md);return d?(d={t:"s",v:ws(d[1])},r=r.match(ic),r&&(d.s=(function(u){var h={},g=u.match(Fr),b=0,x=!1;if(g)for(;b!=g.length;++b){var y=fs(g[b]);switch(y[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!y.val)break;case"<shadow>":case"<shadow/>":h.shadow=1;break;case"</shadow>":break;case"<charset":if(y.val=="1")break;h.cp=N[parseInt(y.val,10)];break;case"<outline":if(!y.val)break;case"<outline>":case"<outline/>":h.outline=1;break;case"</outline>":break;case"<rFont":h.name=y.val;break;case"<sz":h.sz=y.val;break;case"<strike":if(!y.val)break;case"<strike>":case"<strike/>":h.strike=1;break;case"</strike>":break;case"<u":if(!y.val)break;switch(y.val){case"double":h.uval="double";break;case"singleAccounting":h.uval="single-accounting";break;case"doubleAccounting":h.uval="double-accounting"}case"<u>":case"<u/>":h.u=1;break;case"</u>":break;case"<b":if(y.val=="0")break;case"<b>":case"<b/>":h.b=1;break;case"</b>":break;case"<i":if(y.val=="0")break;case"<i>":case"<i/>":h.i=1;break;case"</i>":break;case"<color":y.rgb&&(h.color=y.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":h.family=y.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":h.valign=y.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":x=!0;break;case"</ext>":x=!1;break;default:if(y[0].charCodeAt(1)!==47&&!x)throw new Error("Unrecognized rich format "+y[0])}}return h})(r[1])),d):{t:"s",v:""}}var q0,Pm=(q0=/(\r\n|\n)/g,function(r){return r.map(Im).join("")});function Im(r){var d,u,h,g=[[],r.v,[]];return r.v?(r.s&&(d=r.s,u=g[0],h=g[2],r=[],d.u&&r.push("text-decoration: underline;"),d.uval&&r.push("text-underline-style:"+d.uval+";"),d.sz&&r.push("font-size:"+d.sz+"pt;"),d.outline&&r.push("text-effect: outline;"),d.shadow&&r.push("text-shadow: auto;"),u.push('<span style="'+r.join("")+'">'),d.b&&(u.push("<b>"),h.push("</b>")),d.i&&(u.push("<i>"),h.push("</i>")),d.strike&&(u.push("<s>"),h.push("</s>")),(r=d.valign||"")=="superscript"||r=="super"?r="sup":r=="subscript"&&(r="sub"),r!=""&&(u.push("<"+r+">"),h.push("</"+r+">")),h.push("</span>")),g[0].join("")+g[1].replace(q0,"<br/>")+g[2].join("")):""}var Yp=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Lh=/<(?:\w+:)?r>/,Rh=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function gd(r,h){var u=!h||h.cellHTML,h={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(h.t=ws(Oe(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),h.r=Oe(r),u&&(h.h=Oi(h.t))):r.match(Lh)&&(h.r=Oe(r),h.t=ws(Oe((r.replace(Rh,"").match(Yp)||[]).join("").replace(Fr,""))),u&&(h.h=Pm(Gr(h.r)))),h):{t:""}}var Ya=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Xr=/<(?:\w+:)?(?:si|sstItem)>/g,Y0=/<\/(?:\w+:)?(?:si|sstItem)>/,pd=/^\s|\s$|[\t\n\r]/;function xd(r,d){if(!d.bookSST)return"";var u=[hr];u[u.length]=Le("sst",null,{xmlns:ta[0],count:r.Count,uniqueCount:r.Unique});for(var h,g,b=0;b!=r.length;++b)r[b]!=null&&(g="<si>",(h=r[b]).r?g+=h.r:(g+="<t",h.t||(h.t=""),h.t.match(pd)&&(g+=' xml:space="preserve"'),g+=">"+Ys(h.t)+"</t>"),g+="</si>",u[u.length]=g);return 2<u.length&&(u[u.length]="</sst>",u[1]=u[1].replace("/>",">")),u.join("")}var Oh=function(r,d){var u=!1;return d==null&&(u=!0,d=pt(15+4*r.t.length)),d.write_shift(1,0),ca(r.t,d),u?d.slice(0,d.l):d};function Qi(r){var d,u,h=Pa();wt(h,159,(d=r,(u=u||pt(8)).write_shift(4,d.Count),u.write_shift(4,d.Unique),u));for(var g=0;g<r.length;++g)wt(h,19,Oh(r[g]));return wt(h,160),h.end()}function bd(r){if(e!==void 0)return e.utils.encode(v,r);for(var d=[],u=r.split(""),h=0;h<u.length;++h)d[h]=u[h].charCodeAt(0);return d}function ri(r,d){var u={};return u.Major=r.read_shift(2),u.Minor=r.read_shift(2),4<=d&&(r.l+=d-4),u}function Ph(r){var d=[];r.l+=4;for(var u=r.read_shift(4);0<u--;)d.push((function(h){for(var b=h.read_shift(4),g=h.l+b-4,b={},x=h.read_shift(4),y=[];0<x--;)y.push({t:h.read_shift(4),v:h.read_shift(0,"lpp4")});if(b.name=h.read_shift(0,"lpp4"),b.comps=y,h.l!=g)throw new Error("Bad DataSpaceMapEntry: "+h.l+" != "+g);return b})(r));return d}function Bm(r){var d,u,u=(u={},(d=r).read_shift(4),d.l+=4,u.id=d.read_shift(0,"lpp4"),u.name=d.read_shift(0,"lpp4"),u.R=ri(d,4),u.U=ri(d,4),u.W=ri(d,4),u);if(u.ename=r.read_shift(0,"8lpp4"),u.blksz=r.read_shift(4),u.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return u}function Ih(r,u){var u=r.l+u,h={};h.Flags=63&r.read_shift(4),r.l+=4,h.AlgID=r.read_shift(4);var g=!1;switch(h.AlgID){case 26126:case 26127:case 26128:g=h.Flags==36;break;case 26625:g=h.Flags==4;break;case 0:g=h.Flags==16||h.Flags==4||h.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+h.AlgID}if(!g)throw new Error("Encryption Flags/AlgID mismatch");return h.AlgIDHash=r.read_shift(4),h.KeySize=r.read_shift(4),h.ProviderType=r.read_shift(4),r.l+=8,h.CSPName=r.read_shift(u-r.l>>1,"utf16le"),r.l=u,h}function Bh(r,h){var u={},h=r.l+h;return r.l+=4,u.Salt=r.slice(r.l,r.l+16),r.l+=16,u.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),u.VerifierHash=r.slice(r.l,h),r.l=h,u}function zm(r){var d=ri(r);switch(d.Minor){case 2:return[d.Minor,(function(g){if((63&g.read_shift(4))!=36)throw new Error("EncryptionInfo mismatch");var h=g.read_shift(4),h=Ih(g,h),g=Bh(g,g.length-g.l);return{t:"Std",h,v:g}})(r)];case 3:return[d.Minor,(function(){throw new Error("File is password-protected: ECMA-376 Extensible")})()];case 4:return[d.Minor,(function(g){var h=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];g.l+=4;var g=g.read_shift(g.length-g.l,"utf8"),b={};return g.replace(Fr,function(x){var y=fs(x);switch(Tn(y[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":h.forEach(function(j){b[j]=y[j]});break;case"<dataIntegrity":b.encryptedHmacKey=y.encryptedHmacKey,b.encryptedHmacValue=y.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":b.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":b.uri=y.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":b.encs.push(y);break;default:throw y[0]}}),b})(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+d.Minor)}function G0(r){var d,u=0,h=bd(r),g=h.length+1,b=J(g);for(b[0]=h.length,d=1;d!=g;++d)b[d]=h[d-1];for(d=g-1;0<=d;--d)u=(((16384&u)==0?0:1)|u<<1&32767)^b[d];return 52811^u}var K0,Q0,zh,Um=(K0=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],Q0=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],zh=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],function(r){for(var d,u,h=bd(r),g=(function(j){for(var k=Q0[j.length-1],E=104,T=j.length-1;0<=T;--T)for(var _=j[T],R=0;R!=7;++R)64&_&&(k^=zh[E]),_*=2,--E;return k})(h),b=h.length,x=J(16),y=0;y!=16;++y)x[y]=0;for((1&b)==1&&(d=g>>8,x[b]=mo(K0[0],d),--b,d=255&g,r=h[h.length-1],x[b]=mo(r,d));0<b;)d=g>>8,x[--b]=mo(h[b],d),d=255&g,x[--b]=mo(h[b],d);for(u=(b=15)-h.length;0<u;)d=g>>8,x[b]=mo(K0[u],d),--u,d=255&g,x[--b]=mo(h[b],d),--b,--u;return x});function mo(r,d){return 255&((d=r^d)/2|128*d)}var Hm=function(r){var d=0,u=Um(r);return function(h){return h=(function(g,b,x,y,j){var k,E;for(j=j||b,y=y||Um(g),k=0;k!=b.length;++k)E=b[k],E=255&((E^=y[x])>>5|E<<3),j[k]=E,++x;return[j,x,y]})("",h,d,u),d=h[1],h[0]}};function Vm(r,d,u){return u=u||{},u.Info=r.read_shift(2),r.l-=2,u.Info===1?u.Data=(function(h){var g={},b=g.EncryptionVersionInfo=ri(h,4);if(b.Major!=1||b.Minor!=1)throw"unrecognized version code "+b.Major+" : "+b.Minor;return g.Salt=h.read_shift(16),g.EncryptedVerifier=h.read_shift(16),g.EncryptedVerifierHash=h.read_shift(16),g})(r):u.Data=(function(h,g){var b={},x=b.EncryptionVersionInfo=ri(h,4);if(g-=4,x.Minor!=2)throw new Error("unrecognized minor version code: "+x.Minor);if(4<x.Major||x.Major<2)throw new Error("unrecognized major version code: "+x.Major);return b.Flags=h.read_shift(4),g-=4,x=h.read_shift(4),g-=4,b.EncryptionHeader=Ih(h,x),g-=x,b.EncryptionVerifier=Bh(h,g),b})(r,d),u}var X0={to_workbook:function(r,d){return Kn(Uh(r,d),d)},to_sheet:Uh,from_sheet:function(r){for(var d=["{\\rtf1\\ansi"],u=Fs(r["!ref"]),h=Array.isArray(r),g=u.s.r;g<=u.e.r;++g){d.push("\\trowd\\trautofit1");for(var b=u.s.c;b<=u.e.c;++b)d.push("\\cellx"+(b+1));for(d.push("\\pard\\intbl"),b=u.s.c;b<=u.e.c;++b){var x=bs({r:g,c:b});(x=h?(r[g]||[])[b]:r[x])&&(x.v!=null||x.f&&!x.F)&&(d.push(" "+(x.w||(xi(x),x.w))),d.push("\\cell"))}d.push("\\pard\\intbl\\row")}return d.join("")+"}"}};function Uh(r,d){switch(d.type){case"base64":return yd(Ce(r),d);case"binary":return yd(r,d);case"buffer":return yd(ge&&Buffer.isBuffer(r)?r.toString("binary"):me(r),d);case"array":return yd(Ha(r),d)}throw new Error("Unrecognized type "+d.type)}function yd(h,d){var u=(d||{}).dense?[]:{},h=h.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(b,x){Array.isArray(u)&&(u[x]=[]);for(var y,j=/\\\w+\b/g,k=0,E=-1;y=j.exec(b);)y[0]==="\\cell"&&(++E,(y=(y=b.slice(k,j.lastIndex-y[0].length))[0]==" "?y.slice(1):y).length&&(y={v:y,t:"s"},Array.isArray(u)?u[x][E]=y:u[bs({r:x,c:E})]=y)),k=j.lastIndex;E>g.e.c&&(g.e.c=E)}),u["!ref"]=Cs(g),u}function lc(r){for(var d=0,u=1;d!=3;++d)u=256*u+(255<r[d]?255:r[d]<0?0:r[d]);return u.toString(16).toUpperCase().slice(1)}function vd(r,d){return d===0?r:(r=(function(E){var h=E[0]/255,g=E[1]/255,b=E[2]/255,x=Math.max(h,g,b),y=Math.min(h,g,b),j=x-y;if(j==0)return[0,0,h];var k=0,E=0,E=j/(1<(y=x+y)?2-y:y);switch(x){case h:k=((g-b)/j+6)%6;break;case g:k=(b-h)/j+2;break;case b:k=(h-g)/j+4}return[k/6,E,y/2]})((r=(r=r).slice(r[0]==="#"?1:0).slice(0,6),[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)])),r[2]=d<0?r[2]*(1+d):1-(1-r[2])*(1-d),lc((function(x){var h,g=x[0],b=x[1],x=x[2],y=2*b*(x<.5?x:1-x),j=[x=x-y/2,x,x],k=6*g;if(b!==0)switch(0|k){case 0:case 6:h=y*k,j[0]+=y,j[1]+=h;break;case 1:h=y*(2-k),j[0]+=h,j[1]+=y;break;case 2:h=y*(k-2),j[1]+=y,j[2]+=h;break;case 3:h=y*(4-k),j[1]+=h,j[2]+=y;break;case 4:h=y*(k-4),j[2]+=y,j[0]+=h;break;case 5:h=y*(6-k),j[2]+=h,j[0]+=y}for(var E=0;E!=3;++E)j[E]=Math.round(255*j[E]);return j})(r)))}var Hh=6,Gp=15,Wm=1,Jr=Hh;function oc(r){return Math.floor((r+Math.round(128/Jr)/256)*Jr)}function kl(r){return Math.floor((r-5)/Jr*100+.5)/100}function go(r){return Math.round((r*Jr+5)/Jr*256)/256}function J0(r){return go(kl(oc(r)))}function wd(r){var d=Math.abs(r-J0(r)),u=Jr;if(.005<d)for(Jr=Wm;Jr<Gp;++Jr)Math.abs(r-J0(r))<=d&&(d=Math.abs(r-J0(r)),u=Jr);Jr=u}function Cl(r){r.width?(r.wpx=oc(r.width),r.wch=kl(r.wpx),r.MDW=Jr):r.wpx?(r.wch=kl(r.wpx),r.width=go(r.wch),r.MDW=Jr):typeof r.wch=="number"&&(r.width=go(r.wch),r.wpx=oc(r.width),r.MDW=Jr),r.customWidth&&delete r.customWidth}var Vh=96;function cc(r){return 96*r/Vh}function po(r){return r*Vh/96}var $m={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},jd=["numFmtId","fillId","fontId","borderId","xfId"],dc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Wh,$h,Z0,qh,Yh,Nd,Gh=(Wh=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,$h=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,Z0=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,qh=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,Yh=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(r,d,u){var h,g,b,x,y,j={};return r&&((h=(r=r.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(Wh))&&(function(k,E,T){E.NumberFmt=[];for(var _=is(W),R=0;R<_.length;++R)E.NumberFmt[_[R]]=W[_[R]];var q=k[0].match(Fr);if(q)for(R=0;R<q.length;++R){var I=fs(q[R]);switch(Tn(I[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var ee=ws(Oe(I.formatCode)),Y=parseInt(I.numFmtId,10);if(E.NumberFmt[Y]=ee,0<Y){if(392<Y){for(Y=392;60<Y&&E.NumberFmt[Y]!=null;--Y);E.NumberFmt[Y]=ee}xr(ee,Y)}break;case"</numFmt>":break;default:if(T.WTF)throw new Error("unrecognized "+I[0]+" in numFmts")}}})(h,j,u),(h=r.match(qh))&&(function(k,E,T,_){E.Fonts=[];var R={},q=!1;(k[0].match(Fr)||[]).forEach(function(I){var ee,Y=fs(I);switch(Tn(Y[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":E.Fonts.push(R),R={};break;case"<name":Y.val&&(R.name=Oe(Y.val));break;case"<name/>":case"</name>":break;case"<b":R.bold=Y.val?or(Y.val):1;break;case"<b/>":R.bold=1;break;case"<i":R.italic=Y.val?or(Y.val):1;break;case"<i/>":R.italic=1;break;case"<u":switch(Y.val){case"none":R.underline=0;break;case"single":R.underline=1;break;case"double":R.underline=2;break;case"singleAccounting":R.underline=33;break;case"doubleAccounting":R.underline=34}break;case"<u/>":R.underline=1;break;case"<strike":R.strike=Y.val?or(Y.val):1;break;case"<strike/>":R.strike=1;break;case"<outline":R.outline=Y.val?or(Y.val):1;break;case"<outline/>":R.outline=1;break;case"<shadow":R.shadow=Y.val?or(Y.val):1;break;case"<shadow/>":R.shadow=1;break;case"<condense":R.condense=Y.val?or(Y.val):1;break;case"<condense/>":R.condense=1;break;case"<extend":R.extend=Y.val?or(Y.val):1;break;case"<extend/>":R.extend=1;break;case"<sz":Y.val&&(R.sz=+Y.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":Y.val&&(R.vertAlign=Y.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":Y.val&&(R.family=parseInt(Y.val,10));break;case"<family/>":case"</family>":break;case"<scheme":Y.val&&(R.scheme=Y.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(Y.val=="1")break;Y.codepage=N[parseInt(Y.val,10)];break;case"<color":R.color||(R.color={}),Y.auto&&(R.color.auto=or(Y.auto)),Y.rgb?R.color.rgb=Y.rgb.slice(-6):Y.indexed?(R.color.index=parseInt(Y.indexed,10),ee=Ko[R.color.index],ee=(ee=R.color.index==81?Ko[1]:ee)||Ko[1],R.color.rgb=ee[0].toString(16)+ee[1].toString(16)+ee[2].toString(16)):Y.theme&&(R.color.theme=parseInt(Y.theme,10),Y.tint&&(R.color.tint=parseFloat(Y.tint)),Y.theme&&T.themeElements&&T.themeElements.clrScheme&&(R.color.rgb=vd(T.themeElements.clrScheme[R.color.theme].rgb,R.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":q=!0;break;case"</AlternateContent>":q=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":q=!0;break;case"</ext>":q=!1;break;default:if(_&&_.WTF&&!q)throw new Error("unrecognized "+Y[0]+" in fonts")}})})(h,j,d,u),(h=r.match(Z0))&&(function(k,E,T){E.Fills=[];var _={},R=!1;(k[0].match(Fr)||[]).forEach(function(q){var I=fs(q);switch(Tn(I[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":_={},E.Fills.push(_);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":E.Fills.push(_),_={};break;case"<patternFill":case"<patternFill>":I.patternType&&(_.patternType=I.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":_.bgColor||(_.bgColor={}),I.indexed&&(_.bgColor.indexed=parseInt(I.indexed,10)),I.theme&&(_.bgColor.theme=parseInt(I.theme,10)),I.tint&&(_.bgColor.tint=parseFloat(I.tint)),I.rgb&&(_.bgColor.rgb=I.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":_.fgColor||(_.fgColor={}),I.theme&&(_.fgColor.theme=parseInt(I.theme,10)),I.tint&&(_.fgColor.tint=parseFloat(I.tint)),I.rgb!=null&&(_.fgColor.rgb=I.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":R=!0;break;case"</ext>":R=!1;break;default:if(T&&T.WTF&&!R)throw new Error("unrecognized "+I[0]+" in fills")}})})(h,j,u),(h=r.match(Yh))&&(function(k,E,T){E.Borders=[];var _={},R=!1;(k[0].match(Fr)||[]).forEach(function(q){var I=fs(q);switch(Tn(I[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":_={},I.diagonalUp&&(_.diagonalUp=or(I.diagonalUp)),I.diagonalDown&&(_.diagonalDown=or(I.diagonalDown)),E.Borders.push(_);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":R=!0;break;case"</ext>":R=!1;break;default:if(T&&T.WTF&&!R)throw new Error("unrecognized "+I[0]+" in borders")}})})(h,j,u),(h=r.match($h))&&(h=h,b=u,y=!((g=j).CellXf=[]),(h[0].match(Fr)||[]).forEach(function(k){var E=fs(k),T=0;switch(Tn(E[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(x=E)[0],T=0;T<jd.length;++T)x[jd[T]]&&(x[jd[T]]=parseInt(x[jd[T]],10));for(T=0;T<dc.length;++T)x[dc[T]]&&(x[dc[T]]=or(x[dc[T]]));if(g.NumberFmt&&392<x.numFmtId){for(T=392;60<T;--T)if(g.NumberFmt[x.numFmtId]==g.NumberFmt[T]){x.numFmtId=T;break}}g.CellXf.push(x);break;case"</xf>":break;case"<alignment":case"<alignment/>":var _={};E.vertical&&(_.vertical=E.vertical),E.horizontal&&(_.horizontal=E.horizontal),E.textRotation!=null&&(_.textRotation=E.textRotation),E.indent&&(_.indent=E.indent),E.wrapText&&(_.wrapText=or(E.wrapText)),x.alignment=_;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":y=!0;break;case"</AlternateContent>":y=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":y=!0;break;case"</ext>":y=!1;break;default:if(b&&b.WTF&&!y)throw new Error("unrecognized "+E[0]+" in cellXfs")}}))),j});function Kh(r,d){if(Nd!==void 0)return Nd.toXml();var u,h,g,b,x=[hr,Le("styleSheet",null,{xmlns:ta[0],"xmlns:vt":hs.vt})];return r.SSF&&(h=r.SSF,g=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(y){for(var j=y[0];j<=y[1];++j)h[j]!=null&&(g[g.length]=Le("numFmt",null,{numFmtId:j,formatCode:Ys(h[j])}))}),(u=g.length===1?"":(g[g.length]="</numFmts>",g[0]=Le("numFmts",null,{count:g.length-2}).replace("/>",">"),g.join("")))!=null)&&(x[x.length]=u),x[x.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',x[x.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',x[x.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',x[x.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',d=d.cellXfs,(b=[])[b.length]="<cellXfs/>",d.forEach(function(y){b[b.length]=Le("xf",null,y)}),b[b.length]="</cellXfs>",(u=b.length===2?"":(b[0]=Le("cellXfs",null,{count:b.length-2}).replace("/>",">"),b.join("")))&&(x[x.length]=u),x[x.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',x[x.length]='<dxfs count="0"/>',x[x.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<x.length&&(x[x.length]="</styleSheet>",x[1]=x[1].replace("/>",">")),x.join("")}function qm(r,d){var u;(d=d||pt(153)).write_shift(2,20*r.sz),u=r,h=(h=d)||pt(2),u=(u.italic?2:0)|(u.strike?8:0)|(u.outline?16:0)|(u.shadow?32:0)|(u.condense?64:0)|(u.extend?128:0),h.write_shift(1,u),h.write_shift(1,0),d.write_shift(2,r.bold?700:400);var h=0;return r.vertAlign=="superscript"?h=1:r.vertAlign=="subscript"&&(h=2),d.write_shift(2,h),d.write_shift(1,r.underline||0),d.write_shift(1,r.family||0),d.write_shift(1,r.charset||0),d.write_shift(1,0),Bi(r.color,d),h=0,r.scheme=="major"&&(h=1),r.scheme=="minor"&&(h=2),d.write_shift(1,h),ca(r.name,d),d.length>d.l?d.slice(0,d.l):d}var eu,Ym=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Gm=Oa;function Km(r,d){d=d||pt(84),r=(eu=eu||Mi(Ym))[r.patternType],r==null&&(r=40),d.write_shift(4,r);var u=0;if(r!=40)for(Bi({auto:1},d),Bi({auto:1},d);u<12;++u)d.write_shift(4,0);else{for(;u<4;++u)d.write_shift(4,0);for(;u<12;++u)d.write_shift(4,0)}return d.length>d.l?d.slice(0,d.l):d}function Qm(r,d,u){return(u=u||pt(16)).write_shift(2,d||0),u.write_shift(2,r.numFmtId||0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u}function uc(r,d){return(d=d||pt(10)).write_shift(1,0),d.write_shift(1,0),d.write_shift(4,0),d.write_shift(4,0),d}fi=Oa;function kd(r,d){var u;d&&(u=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g=h[0];g<=h[1];++g)d[g]!=null&&++u}),u!=0&&(wt(r,615,pn(u)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g,b,x,y=h[0];y<=h[1];++y)d[y]!=null&&wt(r,44,(g=y,b=d[y],(x=(x=void 0)||pt(6+4*b.length)).write_shift(2,g),ca(b,x),b=x.length>x.l?x.slice(0,x.l):x,x.l==null&&(x.l=x.length),b))}),wt(r,616)))}function Qh(r){var d;wt(r,613,pn(1)),wt(r,46,((d=d||pt(51)).write_shift(1,0),uc(0,d),uc(0,d),uc(0,d),uc(0,d),uc(0,d),d.length>d.l?d.slice(0,d.l):d)),wt(r,614)}function tu(r){var d,u;wt(r,619,pn(1)),wt(r,48,(d={xfId:0,builtinId:0,name:"Normal"},(u=u||pt(52)).write_shift(4,d.xfId),u.write_shift(2,1),u.write_shift(1,+d.builtinId),u.write_shift(1,0),sd(d.name||"",u),u.length>u.l?u.slice(0,u.l):u)),wt(r,620)}function Xm(r){var d,u,h,g;wt(r,508,(d=0,u="TableStyleMedium9",h="PivotStyleMedium4",(g=pt(2052)).write_shift(4,d),sd(u,g),sd(h,g),g.length>g.l?g.slice(0,g.l):g)),wt(r,509)}function Jm(r,d){var u,h=Pa();return wt(h,278),kd(h,r.SSF),wt(r=h,611,pn(1)),wt(r,43,qm({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),wt(r,612),wt(r=h,603,pn(2)),wt(r,45,Km({patternType:"none"})),wt(r,45,Km({patternType:"gray125"})),wt(r,604),Qh(h),wt(r=h,626,pn(1)),wt(r,47,Qm({numFmtId:0},65535)),wt(r,627),u=h,d=d.cellXfs,wt(u,617,pn(d.length)),d.forEach(function(g){wt(u,47,Qm(g,0))}),wt(u,618),tu(h),wt(d=h,505,pn(0)),wt(d,506),Xm(h),wt(h,279),h.end()}var Cd=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Zm(r,d,u){d.themeElements.clrScheme=[];var h={};(r[0].match(Fr)||[]).forEach(function(g){var b=fs(g);switch(b[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":h.rgb=b.val;break;case"<a:sysClr":h.rgb=b.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":b[0].charAt(1)==="/"?(d.themeElements.clrScheme[Cd.indexOf(b[0])]=h,h={}):h.name=b[0].slice(3,b[0].length-1);break;default:if(u&&u.WTF)throw new Error("Unrecognized "+b[0]+" in clrScheme")}})}function Xh(){}function eg(){}var Jh=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Zh=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,tg=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,sg=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Sl(r,d){var u,h,g,b,x,y={};if(!(u=(r=!r||r.length===0?su():r).match(sg)))throw new Error("themeElements not found in theme");return h=u[0],b=d,(g=y).themeElements={},[["clrScheme",Jh,Zm],["fontScheme",Zh,Xh],["fmtScheme",tg,eg]].forEach(function(j){if(!(x=h.match(j[1])))throw new Error(j[0]+" not found in themeElements");j[2](x,g,b)}),y.raw=r,y}function su(r,d){return d&&d.themeXLSX?d.themeXLSX:r&&typeof r.raw=="string"?r.raw:(r=[hr],r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join(""))}function rg(r){var d={};switch(d.xclrType=r.read_shift(2),d.nTintShade=r.read_shift(2),d.xclrType){case 0:r.l+=4;break;case 1:d.xclrValue=Oa(r,4);break;case 2:d.xclrValue=F0(r);break;case 3:d.xclrValue=r.read_shift(4);break;case 4:r.l+=4}return r.l+=8,d}function ag(r){var d=r.read_shift(2),u=r.read_shift(2)-4,h=[d];switch(d){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:h[1]=rg(r);break;case 6:h[1]=Oa(r,u);break;case 14:case 15:h[1]=r.read_shift(u==1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+d+" "+u)}return h}function ru(){var r,d,u,h=Pa();return wt(h,332),wt(h,334,pn(1)),wt(h,335,((u=pt(12+2*(d={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,d.flags),u.write_shift(4,d.version),ca(d.name,u),u.slice(0,u.l))),wt(h,336),wt(h,339,(r=1,(u=pt(8+2*(d="XLDAPR").length)).write_shift(4,r),ca(d,u),u.slice(0,u.l))),wt(h,52),wt(h,35,pn(514)),wt(h,4096,pn(0)),wt(h,4097,jn(1)),wt(h,36),wt(h,53),wt(h,340),wt(h,337,(r=1,d=!0,(u=pt(8)).write_shift(4,r),u.write_shift(4,d?1:0),u)),wt(h,51,(function(g){var b=pt(4+8*g.length);b.write_shift(4,g.length);for(var x=0;x<g.length;++x)b.write_shift(4,g[x][0]),b.write_shift(4,g[x][1]);return b})([[1,0]])),wt(h,338),wt(h,333),h.end()}function ef(){var r=[hr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}var Al=1024;function tf(r,d){for(var u=[21600,21600],h=["m0,0l0",u[1],u[0],u[1],u[0],"0xe"].join(","),g=[Le("xml",null,{"xmlns:v":tr.v,"xmlns:o":tr.o,"xmlns:x":tr.x,"xmlns:mv":tr.mv}).replace(/\/>/,">"),Le("o:shapelayout",Le("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Le("v:shapetype",[Le("v:stroke",null,{joinstyle:"miter"}),Le("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:u.join(","),path:h})];Al<1e3*r;)Al+=1e3;return d.forEach(function(b){var x=Hr(b[0]),j={color2:"#BEFF82",type:"gradient"};j.type=="gradient"&&(j.angle="-180");var y=j.type=="gradient"?Le("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,j=Le("v:fill",y,j);++Al,g=g.concat(["<v:shape"+Rt({id:"_x0000_s"+Al,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(b[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",j,Le("v:shadow",null,{on:"t",obscured:"t"}),Le("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ct("x:Anchor",[x.c+1,0,x.r+1,0,x.c+3,20,x.r+5,20].join(",")),Ct("x:AutoFill","False"),Ct("x:Row",String(x.r)),Ct("x:Column",String(x.c)),b[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),g.push("</xml>"),g.join("")}function sf(r,d,u,h){var g,b=Array.isArray(r);d.forEach(function(x){var y,j=Hr(x.ref);(g=b?(r[j.r]||(r[j.r]=[]),r[j.r][j.c]):r[x.ref])||(g={t:"z"},b?r[j.r][j.c]=g:r[x.ref]=g,(y=Fs(r["!ref"]||"BDWGO1000001:A1")).s.r>j.r&&(y.s.r=j.r),y.e.r<j.r&&(y.e.r=j.r),y.s.c>j.c&&(y.s.c=j.c),y.e.c<j.c&&(y.e.c=j.c),(y=Cs(y))!==r["!ref"]&&(r["!ref"]=y)),g.c||(g.c=[]);var k={a:x.author,t:x.t,r:x.r,T:u};x.h&&(k.h=x.h);for(var E=g.c.length-1;0<=E;--E){if(!u&&g.c[E].T)return;u&&!g.c[E].T&&g.c.splice(E,1)}if(u&&h){for(E=0;E<h.length;++E)if(k.a==h[E].id){k.a=h[E].name||k.a;break}}g.c.push(k)})}function ng(r){var d=[hr,Le("comments",null,{xmlns:ta[0]})],u=[];return d.push("<authors>"),r.forEach(function(h){h[1].forEach(function(g){var b=Ys(g.a);u.indexOf(b)==-1&&(u.push(b),d.push("<author>"+b+"</author>")),g.T&&g.ID&&u.indexOf("tc="+g.ID)==-1&&(u.push("tc="+g.ID),d.push("<author>tc="+g.ID+"</author>"))})}),u.length==0&&(u.push("SheetJ5"),d.push("<author>SheetJ5</author>")),d.push("</authors>"),d.push("<commentList>"),r.forEach(function(h){var g=0,b=[];if(h[1][0]&&h[1][0].T&&h[1][0].ID?g=u.indexOf("tc="+h[1][0].ID):h[1].forEach(function(j){j.a&&(g=u.indexOf(Ys(j.a))),b.push(j.t||"")}),d.push('<comment ref="'+h[0]+'" authorId="'+g+'"><text>'),b.length<=1)d.push(Ct("t",Ys(b[0]||"")));else{for(var x=`Comment:
    `+b[0]+`
`,y=1;y<b.length;++y)x+=`Reply:
    `+b[y]+`
`;d.push(Ct("t",Ys(x)))}d.push("</text></comment>")}),d.push("</commentList>"),2<d.length&&(d[d.length]="</comments>",d[1]=d[1].replace("/>",">")),d.join("")}Ri=xa;function rf(r){var d=Pa(),u=[];return wt(d,628),wt(d,630),r.forEach(function(h){h[1].forEach(function(g){-1<u.indexOf(g.a)||(u.push(g.a.slice(0,54)),wt(d,632,ca(g.a.slice(0,54))))})}),wt(d,631),wt(d,633),r.forEach(function(h){h[1].forEach(function(g){g.iauthor=u.indexOf(g.a);var b,x={s:Hr(h[0]),e:Hr(h[0])};wt(d,635,(x=[x,g],(b=b??pt(36)).write_shift(4,x[1].iauthor),gl(x[0],b),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b)),g.t&&0<g.t.length&&wt(d,637,$p(g)),wt(d,636),delete g.iauthor})}),wt(d,634),wt(d,629),d.end()}var ia="application/vnd.ms-office.vbaProject",ya=["xlsb","xlsm","xlam","biff8","xla"],au,af,xo=(af=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,function(r,d){return au=d,r.replace(af,ig)});function ig(r,d,u,h){var g=!1,b=!1;return u.length==0?b=!0:u.charAt(0)=="["&&(b=!0,u=u.slice(1,-1)),h.length==0?g=!0:h.charAt(0)=="["&&(g=!0,h=h.slice(1,-1)),u=0<u.length?0|parseInt(u,10):0,h=0<h.length?0|parseInt(h,10):0,g?h+=au.c:--h,b?u+=au.r:--u,d+(g?"":"$")+Ar(h)+(b?"":"$")+Ur(u)}var bo=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nu=function(r,d){return r.replace(bo,function(u,h,g,b,x,y){return b=ml(b)-(g?0:d.c),y=b0(y)-(x?0:d.r),h+"R"+(y==0?"":x?1+y:"["+y+"]")+"C"+(b==0?"":g?1+b:"["+b+"]")})};function Sd(r,d){return r.replace(bo,function(u,h,g,b,x,y){return h+(g=="$"?g+b:Ar(ml(b)+d.c))+(x=="$"?x+y:Ur(b0(y)+d.r))})}function nf(r){return r.replace(/_xlfn\./g,"")}function la(r){r.l+=1}function ai(r,d){return d=r.read_shift(d==1?1:2),[16383&d,d>>14&1,d>>15&1]}function iu(x,d,g){var b=2;if(g){if(2<=g.biff&&g.biff<=5)return lf(x);g.biff==12&&(b=4)}var h=x.read_shift(b),g=x.read_shift(b),b=ai(x,2),x=ai(x,2);return{s:{r:h,c:b[0],cRel:b[1],rRel:b[2]},e:{r:g,c:x[0],cRel:x[1],rRel:x[2]}}}function lf(g){var d=ai(g,2),u=ai(g,2),h=g.read_shift(1),g=g.read_shift(1);return{s:{r:d[0],c:h,cRel:d[1],rRel:d[2]},e:{r:u[0],c:g,cRel:u[1],rRel:u[2]}}}function of(x,d,b){if(b&&2<=b.biff&&b.biff<=5)return g=ai(h=x,2),h=h.read_shift(1),{r:g[0],c:h,cRel:g[1],rRel:g[2]};var h,g,b=x.read_shift(b&&b.biff==12?4:2),x=ai(x,2);return{r:b,c:x[0],cRel:x[1],rRel:x[2]}}function lg(x,d,b){if(b=b&&b.biff?b.biff:8,2<=b&&b<=5)return(function(T){var j=T.read_shift(2),k=T.read_shift(1),E=(32768&j)>>15,T=(16384&j)>>14;return j&=16383,E==1&&8192<=j&&(j-=16384),T==1&&128<=k&&(k-=256),{r:j,c:k,cRel:T,rRel:E}})(x);var h=x.read_shift(12<=b?4:2),g=x.read_shift(2),b=(16384&g)>>14,x=(32768&g)>>15;if(g&=16383,x==1)for(;524287<h;)h-=1048576;if(b==1)for(;8191<g;)g-=16384;return{r:h,c:g,cRel:b,rRel:x}}function lu(r){var d=1&r[r.l+1];return r.l+=4,[d,1]}function ou(r){return[r.read_shift(1),r.read_shift(1)]}function cf(r,d,u){var h=0,g=0;u.biff==12?(h=r.read_shift(4),g=r.read_shift(4)):(g=1+r.read_shift(1),h=1+r.read_shift(2)),2<=u.biff&&u.biff<8&&(--h,--g==0&&(g=256));for(var b=0,x=[];b!=h&&(x[b]=[]);++b)for(var y=0;y!=g;++y)x[b][y]=(function(j,k){var E=[j.read_shift(1)];if(k==12)switch(E[0]){case 2:E[0]=4;break;case 4:E[0]=16;break;case 0:E[0]=1;break;case 1:E[0]=2}switch(E[0]){case 4:E[1]=Js(j,1)?"TRUE":"FALSE",k!=12&&(j.l+=7);break;case 37:case 16:E[1]=Xn[j[j.l]],j.l+=k==12?4:8;break;case 0:j.l+=8;break;case 1:E[1]=Aa(j);break;case 2:E[1]=Vi(j,0,{biff:0<k&&k<8?2:k});break;default:throw new Error("Bad SerAr: "+E[0])}return E})(r,u.biff);return x}function hc(r,d,u){return r.l+=2,[(r=(h=r).read_shift(2),h=h.read_shift(2),{r,c:255&h,fQuoted:!!(16384&h),cRel:h>>15,rRel:h>>15})];var h}function Ad(r){return r.l+=6,[]}function Ed(r){return r.l+=2,[br(r),1&r.read_shift(2)]}var df=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],uf={1:{n:"PtgExp",f:function(r,d,u){return r.l++,u&&u.biff==12?[r.read_shift(4,"i"),0]:[r.read_shift(2),r.read_shift(u&&u.biff==2?1:2)]}},2:{n:"PtgTbl",f:Oa},3:{n:"PtgAdd",f:la},4:{n:"PtgSub",f:la},5:{n:"PtgMul",f:la},6:{n:"PtgDiv",f:la},7:{n:"PtgPower",f:la},8:{n:"PtgConcat",f:la},9:{n:"PtgLt",f:la},10:{n:"PtgLe",f:la},11:{n:"PtgEq",f:la},12:{n:"PtgGe",f:la},13:{n:"PtgGt",f:la},14:{n:"PtgNe",f:la},15:{n:"PtgIsect",f:la},16:{n:"PtgUnion",f:la},17:{n:"PtgRange",f:la},18:{n:"PtgUplus",f:la},19:{n:"PtgUminus",f:la},20:{n:"PtgPercent",f:la},21:{n:"PtgParen",f:la},22:{n:"PtgMissArg",f:la},23:{n:"PtgStr",f:function(r,d,u){return r.l++,Zn(r,0,u)}},26:{n:"PtgSheet",f:function(r,d,u){return r.l+=5,r.l+=2,r.l+=u.biff==2?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(r,d,u){return r.l+=u.biff==2?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(r){return r.l++,Xn[r.read_shift(1)]}},29:{n:"PtgBool",f:function(r){return r.l++,r.read_shift(1)!==0}},30:{n:"PtgInt",f:function(r){return r.l++,r.read_shift(2)}},31:{n:"PtgNum",f:function(r){return r.l++,Aa(r)}},32:{n:"PtgArray",f:function(r,d,u){var h=(96&r[r.l++])>>5;return r.l+=u.biff==2?6:u.biff==12?14:7,[h]}},33:{n:"PtgFunc",f:function(r,d,u){var h=(96&r[r.l])>>5;return r.l+=1,u=r.read_shift(u&&u.biff<=3?1:2),[ug[u],ff[u],h]}},34:{n:"PtgFuncVar",f:function(r,d,u){var h=r[r.l++],g=r.read_shift(1),b=u&&u.biff<=3?[h==88?-1:0,r.read_shift(1)]:[(b=r)[b.l+1]>>7,32767&b.read_shift(2)];return[g,(b[0]===0?ff:El)[b[1]]]}},35:{n:"PtgName",f:function(r,d,u){var h=r.read_shift(1)>>>5&3,g=!u||8<=u.biff?4:2,g=r.read_shift(g);switch(u.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12}return[h,0,g]}},36:{n:"PtgRef",f:function(r,d,u){var h=(96&r[r.l])>>5;return r.l+=1,[h,of(r,0,u)]}},37:{n:"PtgArea",f:function(r,d,u){return[(96&r[r.l++])>>5,iu(r,2<=u.biff&&u.biff,u)]}},38:{n:"PtgMemArea",f:function(r,d,u){var h=r.read_shift(1)>>>5&3;return r.l+=u&&u.biff==2?3:4,[h,r.read_shift(u&&u.biff==2?1:2)]}},39:{n:"PtgMemErr",f:Oa},40:{n:"PtgMemNoMem",f:Oa},41:{n:"PtgMemFunc",f:function(r,d,u){return[r.read_shift(1)>>>5&3,r.read_shift(u&&u.biff==2?1:2)]}},42:{n:"PtgRefErr",f:function(r,d,u){var h=r.read_shift(1)>>>5&3;return r.l+=4,u.biff<8&&r.l--,u.biff==12&&(r.l+=2),[h]}},43:{n:"PtgAreaErr",f:function(r,d,u){var h=(96&r[r.l++])>>5;return r.l+=u&&8<u.biff?12:u.biff<8?6:8,[h]}},44:{n:"PtgRefN",f:function(r,d,u){var h=(96&r[r.l])>>5;return r.l+=1,[h,lg(r,0,u)]}},45:{n:"PtgAreaN",f:function(r,d,u){return[(96&r[r.l++])>>5,(function(j,y){if(y.biff<8)return lf(j);var b=j.read_shift(y.biff==12?4:2),x=j.read_shift(y.biff==12?4:2),y=ai(j,2),j=ai(j,2);return{s:{r:b,c:y[0],cRel:y[1],rRel:y[2]},e:{r:x,c:j[0],cRel:j[1],rRel:j[2]}}})(r,u)]}},46:{n:"PtgMemAreaN",f:function(r){return[r.read_shift(1)>>>5&3,r.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(r){return[r.read_shift(1)>>>5&3,r.read_shift(2)]}},57:{n:"PtgNameX",f:function(r,d,u){return u.biff==5?(function(h){var g=h.read_shift(1)>>>5&3,b=h.read_shift(2,"i");h.l+=8;var x=h.read_shift(2);return h.l+=12,[g,b,x]})(r):[r.read_shift(1)>>>5&3,r.read_shift(2),r.read_shift(4)]}},58:{n:"PtgRef3d",f:function(r,d,u){var h=(96&r[r.l])>>5;r.l+=1;var g=r.read_shift(2);return u&&u.biff==5&&(r.l+=12),[h,g,of(r,0,u)]}},59:{n:"PtgArea3d",f:function(r,d,u){var h=(96&r[r.l++])>>5,g=r.read_shift(2,"i");return u&&u.biff===5&&(r.l+=12),[h,g,iu(r,0,u)]}},60:{n:"PtgRefErr3d",f:function(r,d,u){var h=(96&r[r.l++])>>5,g=r.read_shift(2),b=4;if(u)switch(u.biff){case 5:b=15;break;case 12:b=6}return r.l+=b,[h,g]}},61:{n:"PtgAreaErr3d",f:function(r,d,u){var h=(96&r[r.l++])>>5,g=r.read_shift(2),b=8;if(u)switch(u.biff){case 5:r.l+=12,b=6;break;case 12:b=12}return r.l+=b,[h,g]}},255:{}},hf={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},og={1:{n:"PtgElfLel",f:Ed},2:{n:"PtgElfRw",f:hc},3:{n:"PtgElfCol",f:hc},6:{n:"PtgElfRwV",f:hc},7:{n:"PtgElfColV",f:hc},10:{n:"PtgElfRadical",f:hc},11:{n:"PtgElfRadicalS",f:Ad},13:{n:"PtgElfColS",f:Ad},15:{n:"PtgElfColSV",f:Ad},16:{n:"PtgElfRadicalLel",f:Ed},25:{n:"PtgList",f:function(b){b.l+=2;var d=b.read_shift(2),u=b.read_shift(2),h=b.read_shift(4),g=b.read_shift(2),b=b.read_shift(2);return{ixti:d,coltype:3&u,rt:df[u>>2&31],idx:h,c:g,C:b}}},29:{n:"PtgSxName",f:function(r){return r.l+=2,[r.read_shift(4)]}},255:{}},Xi={0:{n:"PtgAttrNoop",f:function(r){return r.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(r,d,u){var h=255&r[r.l+1]?1:0;return r.l+=u&&u.biff==2?3:4,[h]}},2:{n:"PtgAttrIf",f:function(r,d,u){var h=255&r[r.l+1]?1:0;return r.l+=2,[h,r.read_shift(u&&u.biff==2?1:2)]}},4:{n:"PtgAttrChoose",f:function(r,d,u){r.l+=2;for(var h=r.read_shift(u&&u.biff==2?1:2),g=[],b=0;b<=h;++b)g.push(r.read_shift(u&&u.biff==2?1:2));return g}},8:{n:"PtgAttrGoto",f:function(r,d,u){var h=255&r[r.l+1]?1:0;return r.l+=2,[h,r.read_shift(u&&u.biff==2?1:2)]}},16:{n:"PtgAttrSum",f:function(r,d,u){r.l+=u&&u.biff==2?3:4}},32:{n:"PtgAttrBaxcel",f:lu},33:{n:"PtgAttrBaxcel",f:lu},64:{n:"PtgAttrSpace",f:function(r){return r.read_shift(2),ou(r)}},65:{n:"PtgAttrSpaceSemi",f:function(r){return r.read_shift(2),ou(r)}},128:{n:"PtgAttrIfError",f:function(r){var d=255&r[r.l+1]?1:0;return r.l+=2,[d,r.read_shift(2)]}},255:{}};function yo(r,d,u,h){if(h.biff<8)return Oa(r,d);for(var g=r.l+d,b=[],x=0;x!==u.length;++x)switch(u[x][0]){case"PtgArray":u[x][1]=cf(r,0,h),b.push(u[x][1]);break;case"PtgMemArea":u[x][2]=(function(y,j){for(var k=y.read_shift(j.biff==12?4:2),E=[],T=0;T!=k;++T)E.push((j.biff==12?Qn:aa)(y));return E})(r,(u[x][1],h)),b.push(u[x][2]);break;case"PtgExp":h&&h.biff==12&&(u[x][1][1]=r.read_shift(4),b.push(u[x][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+u[x][0]}return(d=g-r.l)!==0&&b.push(Oa(r,d)),b}function Dd(r,d,u){for(var h,g,b=r.l+d,x=[];b!=r.l;)d=b-r.l,g=r[r.l],h=uf[g]||uf[hf[g]],(h=g===24||g===25?(g===24?og:Xi)[r[r.l+1]]:h)&&h.f?x.push([h.n,h.f(r,d,u)]):Oa(r,d);return x}var cg={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ki(r,d,u){if(!r)return"SH33TJSERR0";if(8<u.biff&&(!r.XTI||!r.XTI[d]))return r.SheetNames[d];if(!r.XTI)return"SH33TJSERR6";var h=r.XTI[d];if(u.biff<8)return 1e4<d&&(d-=65536),(d=d<0?-d:d)==0?"":r.XTI[d-1];if(!h)return"SH33TJSERR1";var g="";if(8<u.biff)switch(r[h[0]][0]){case 357:return g=h[1]==-1?"#REF":r.SheetNames[h[1]],h[1]==h[2]?g:g+":"+r.SheetNames[h[2]];case 358:return u.SID!=null?r.SheetNames[u.SID]:"SH33TJSSAME"+r[h[0]][0];default:return"SH33TJSSRC"+r[h[0]][0]}switch(r[h[0]][0][0]){case 1025:return g=h[1]==-1?"#REF":r.SheetNames[h[1]]||"SH33TJSERR3",h[1]==h[2]?g:g+":"+r.SheetNames[h[2]];case 14849:return r[h[0]].slice(1).map(function(b){return b.Name}).join(";;");default:return r[h[0]][0][3]?(g=h[1]==-1?"#REF":r[h[0]][0][3][h[1]]||"SH33TJSERR4",h[1]==h[2]?g:g+":"+r[h[0]][0][3][h[2]]):"SH33TJSERR2"}}function cu(r,d,u){return d=ki(r,d,u),d=="#REF"?d:(function(h,g){if(!(h||g&&g.biff<=5&&2<=g.biff))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(h)?"'"+h+"'":h})(d,u)}function za(r,d,u,h,g){var b,x,y,j=g&&g.biff||8,k={s:{c:0,r:0}},E=[],T=0,_=0,R="";if(!r[0]||!r[0][0])return"";for(var q=-1,I="",ee=0,Y=r[0].length;ee<Y;++ee){var z=r[0][ee];switch(z[0]){case"PtgUminus":E.push("-"+E.pop());break;case"PtgUplus":E.push("+"+E.pop());break;case"PtgPercent":E.push(E.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(Ht=E.pop(),b=E.pop(),0<=q){switch(r[0][q][1][0]){case 0:I=lr(" ",r[0][q][1][1]);break;case 1:I=lr("\r",r[0][q][1][1]);break;default:if(I="",g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][q][1][0])}b+=I,q=-1}E.push(b+cg[z[0]]+Ht);break;case"PtgIsect":Ht=E.pop(),b=E.pop(),E.push(b+" "+Ht);break;case"PtgUnion":Ht=E.pop(),b=E.pop(),E.push(b+","+Ht);break;case"PtgRange":Ht=E.pop(),b=E.pop(),E.push(b+":"+Ht);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":x=ed(z[1][1],k,g),E.push(Yo(x,j));break;case"PtgRefN":x=u?ed(z[1][1],u,g):z[1][1],E.push(Yo(x,j));break;case"PtgRef3d":T=z[1][1],x=ed(z[1][2],k,g),R=cu(h,T,g),E.push(R+"!"+Yo(x,j));break;case"PtgFunc":case"PtgFuncVar":var ae=z[1][0],Z=z[1][1],ae=ae||0,ie=(ae&=127)==0?[]:E.slice(-ae);E.length-=ae,Z==="User"&&(Z=ie.shift()),E.push(Z+"("+ie.join(",")+")");break;case"PtgBool":E.push(z[1]?"TRUE":"FALSE");break;case"PtgInt":E.push(z[1]);break;case"PtgNum":E.push(String(z[1]));break;case"PtgStr":E.push('"'+z[1].replace(/"/g,'""')+'"');break;case"PtgErr":E.push(z[1]);break;case"PtgAreaN":y=fh(z[1][1],u?{s:u}:k,g),E.push(x0(y,g));break;case"PtgArea":y=fh(z[1][1],k,g),E.push(x0(y,g));break;case"PtgArea3d":T=z[1][1],y=z[1][2],R=cu(h,T,g),E.push(R+"!"+x0(y,g));break;case"PtgAttrSum":E.push("SUM("+E.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=z[1][2];var Ee=(h.names||[])[_-1]||(h[0]||[])[_],We=Ee?Ee.Name:"SH33TJSNAME"+String(_);We&&We.slice(0,6)=="_xlfn."&&!g.xlfn&&(We=We.slice(6)),E.push(We);break;case"PtgNameX":var Ie,Je=z[1][1],_=z[1][2];if(!(g.biff<=5)){Ee="",((h[Je]||[])[0]||[])[0]==14849||(((h[Je]||[])[0]||[])[0]==1025?h[Je][_]&&0<h[Je][_].itab&&(Ee=h.SheetNames[h[Je][_].itab-1]+"!"):Ee=h.SheetNames[_-1]+"!"),h[Je]&&h[Je][_]?Ee+=h[Je][_].Name:h[0]&&h[0][_]?Ee+=h[0][_].Name:(We=(ki(h,Je,g)||"").split(";;"))[_-1]?Ee=We[_-1]:Ee+="SH33TJSERRX",E.push(Ee);break}Ie=(Ie=h[Je=Je<0?-Je:Je]?h[Je][_]:Ie)||{Name:"SH33TJSERRY"},E.push(Ie.Name);break;case"PtgParen":var bt="(",yt=")";if(0<=q){switch(I="",r[0][q][1][0]){case 2:bt=lr(" ",r[0][q][1][1])+bt;break;case 3:bt=lr("\r",r[0][q][1][1])+bt;break;case 4:yt=lr(" ",r[0][q][1][1])+yt;break;case 5:yt=lr("\r",r[0][q][1][1])+yt;break;default:if(g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][q][1][0])}q=-1}E.push(bt+E.pop()+yt);break;case"PtgRefErr":case"PtgRefErr3d":E.push("#REF!");break;case"PtgExp":x={c:z[1][1],r:z[1][0]};var it={c:u.c,r:u.r};if(h.sharedf[bs(x)])Je=h.sharedf[bs(x)],E.push(za(Je,0,it,h,g));else{for(var St=!1,Ht=0;Ht!=h.arrayf.length;++Ht)if(b=h.arrayf[Ht],!(x.c<b[0].s.c||x.c>b[0].e.c||x.r<b[0].s.r||x.r>b[0].e.r)){E.push(za(b[1],0,it,h,g)),St=!0;break}St||E.push(z[1])}break;case"PtgArray":E.push("{"+(function(Ot){for(var Tt=[],jt=0;jt<Ot.length;++jt){for(var qt=Ot[jt],Xt=[],ns=0;ns<qt.length;++ns){var Ds=qt[ns];Ds?Ds[0]===2?Xt.push('"'+Ds[1].replace(/"/g,'""')+'"'):Xt.push(Ds[1]):Xt.push("")}Tt.push(Xt.join(","))}return Tt.join(";")})(z[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":q=ee;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":E.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":E.push("#REF!");break;case"PtgList":E.push("Table"+z[1].idx+"[#"+z[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(z))}if(g.biff!=3&&0<=q&&["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(r[0][ee][0])==-1){var zt=!0;switch((z=r[0][q])[1][0]){case 4:zt=!1;case 0:I=lr(" ",z[1][1]);break;case 5:zt=!1;case 1:I=lr("\r",z[1][1]);break;default:if(I="",g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+z[1][0])}E.push((zt?I:"")+E.pop()+(zt?"":I)),q=-1}}if(1<E.length&&g.WTF)throw new Error("bad formula stack");return E[0]}function fc(r,x,u){var h=r.l+x,g=qa(r);u.biff==2&&++r.l;var b=(function(y){var j;if(Pi(y,y.l+6)!==65535)return[Aa(y),"n"];switch(y[y.l]){case 0:return y.l+=8,["String","s"];case 1:return j=y[y.l+2]===1,y.l+=8,[j,"b"];case 2:return j=y[y.l+2],y.l+=8,[j,"e"];case 3:return y.l+=8,["","s"]}return[]})(r),x=r.read_shift(1);return u.biff!=2&&(r.read_shift(1),5<=u.biff&&r.read_shift(4)),u=(function(y,j,k){var E,T=y.l+j,_=k.biff==2?1:2,R=y.read_shift(_);if(R==65535)return[[],Oa(y,j-2)];var q=Dd(y,R,k);return j!==R+_&&(E=yo(y,j-R-_,q,k)),y.l=T,[q,E]})(r,h-r.l,u),{cell:g,val:b[0],formula:u,shared:x>>3&1,tt:b[1]}}function Td(r,d,u,h,g){d=ji(d,u,g),g=(u=r.v)!=null?Mn(typeof u=="number"?u:0):((u=pt(8)).write_shift(1,3),u.write_shift(1,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,65535),u),u=pt(6),u.write_shift(2,33),u.write_shift(4,0);for(var b=pt(r.bf.length),x=0;x<r.bf.length;++x)b[x]=r.bf[x];return ce([d,g,u,b])}function fr(r,d,u){var g=r.read_shift(4),h=Dd(r,g,u),g=r.read_shift(4);return[h,0<g?yo(r,g,h,u):null]}var Kp=fr,du=fr,dg=fr,_d=fr,El={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ff={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ug={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function mc(r){return(r=(r=(r=(r=(r=r.slice(0,3)=="of:"?r.slice(3):r).charCodeAt(0)==61&&(r=r.slice(1)).charCodeAt(0)==61?r.slice(1):r).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(d,u){return u.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Pn(r){return r=r.split(":"),[r[0].split(".")[0],r[0].split(".")[1]+(1<r.length?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var gc={},Dl={},pc=typeof Map<"u";function Fd(r,d,u){var h=0,g=r.length;if(u){if(pc?u.has(d):Object.prototype.hasOwnProperty.call(u,d)){for(var b=pc?u.get(d):u[d];h<b.length;++h)if(r[b[h]].t===d)return r.Count++,b[h]}}else for(;h<g;++h)if(r[h].t===d)return r.Count++,h;return r[g]={t:d},r.Count++,r.Unique++,u&&(pc?(u.has(d)||u.set(d,[]),u.get(d).push(g)):(Object.prototype.hasOwnProperty.call(u,d)||(u[d]=[]),u[d].push(g))),g}function xc(h,d){var u={min:h+1,max:h+1},h=-1;return d.MDW&&(Jr=d.MDW),d.width!=null?u.customWidth=1:d.wpx!=null?h=kl(d.wpx):d.wch!=null&&(h=d.wch),-1<h?(u.width=go(h),u.customWidth=1):d.width!=null&&(u.width=d.width),d.hidden&&(u.hidden=!0),d.level!=null&&(u.outlineLevel=u.level=d.level),u}function Ci(r,d){r&&(d=d=="xlml"?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],r.left==null&&(r.left=d[0]),r.right==null&&(r.right=d[1]),r.top==null&&(r.top=d[2]),r.bottom==null&&(r.bottom=d[3]),r.header==null&&(r.header=d[4]),r.footer==null&&(r.footer=d[5]))}function Ji(r,d,u){if(Nd!==void 0){if(/^\d+$/.exec(d.s)||d.s&&d.s==+d.s)return d.s;var h=d.s||{};return d.z&&(h.numFmt=d.z),Nd.addStyle(h)}var g=u.revssf[d.z!=null?d.z:"General"],b=60,x=r.length;if(g==null&&u.ssf){for(;b<392;++b)if(u.ssf[b]==null){xr(d.z,b),u.ssf[b]=d.z,u.revssf[d.z]=g=b;break}}for(b=0;b!=x;++b)if(r[b].numFmtId===g)return b;return r[x]={numFmtId:g,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},x}function Si(r,d,u,h,g,b){try{h.cellNF&&(r.z=W[d])}catch(y){if(h.WTF)throw y}if(r.t!=="z"||h.cellStyles){if(r.t==="d"&&typeof r.v=="string"&&(r.v=_s(r.v)),(!h||h.cellText!==!1)&&r.t!=="z")try{if(W[d]==null&&xr(qc[d]||"General",d),r.t==="e")r.w=r.w||Xn[r.v];else if(d===0)if(r.t==="n")(0|r.v)===r.v?r.w=r.v.toString(10):r.w=Qe(r.v);else if(r.t==="d"){var x=qr(r.v);r.w=(0|x)===x?x.toString(10):Qe(x)}else{if(r.v===void 0)return;r.w=Ve(r.v,Dl)}else r.t==="d"?r.w=Ir(d,qr(r.v),Dl):r.w=Ir(d,r.v,Dl)}catch(y){if(h.WTF)throw y}if(h.cellStyles&&u!=null)try{r.s=b.Fills[u],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=vd(g.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),h.WTF&&(r.s.fgColor.raw_rgb=g.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=vd(g.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),h.WTF&&(r.s.bgColor.raw_rgb=g.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(y){if(h.WTF&&b.Fills)throw y}}}var oa=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,mf=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hg=/<(?:\w:)?hyperlink [^>]*>/gm,va=/"(\w*:\w*)"/,Qp=/<(?:\w:)?col\b[^>]*[\/]?>/g,fg=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,mg=/<(?:\w:)?pageMargins[^>]*\/>/g,Er=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,an=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Zi=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function gg(r,d,u,h,g,b,x){if(!r)return r;h=h||{"!id":{}};var y=d.dense?[]:{},j={s:{r:2e6,c:2e6},e:{r:0,c:0}},k="",We="",E=r.match(mf);E?(k=r.slice(0,E.index),We=r.slice(E.index+E[0].length)):k=We=r;var T=k.match(Er);T?uu(T[0],0,g,u):(T=k.match(an))&&(r=T[0],T[1],T=y,_=g,R=u,uu(r.slice(0,r.indexOf(">")),0,_,R));var _,R,q=(k.match(/<(?:\w*:)?dimension/)||{index:-1}).index;0<q&&(_=k.slice(q,q+50).match(va))&&(R=y,(ee=Fs(ee=_[1])).s.r<=ee.e.r&&ee.s.c<=ee.e.c&&0<=ee.s.r&&0<=ee.s.c&&(R["!ref"]=Cs(ee)));var I,ee=k.match(Zi);ee&&ee[1]&&(z=ee[1],(I=g).Views||(I.Views=[{}]),(z.match(hu)||[]).forEach(function(Ie,Je){Ie=fs(Ie),I.Views[Je]||(I.Views[Je]={}),+Ie.zoomScale&&(I.Views[Je].zoom=+Ie.zoomScale),or(Ie.rightToLeft)&&(I.Views[Je].RTL=!0)}));var Y,z=[];d.cellStyles&&(Y=k.match(Qp))&&(function(Ie,Je){for(var bt=!1,yt=0;yt!=Je.length;++yt){var it=fs(Je[yt],!0);it.hidden&&(it.hidden=or(it.hidden));var St=parseInt(it.min,10)-1,Ht=parseInt(it.max,10)-1;for(it.outlineLevel&&(it.level=+it.outlineLevel||0),delete it.min,delete it.max,it.width=+it.width,!bt&&it.width&&(bt=!0,wd(it.width)),Cl(it);St<=Ht;)Ie[St++]=vs(it)}})(z,Y),E&&el(E[1],y,d,j,b,x),x=We.match(fg),x&&(y["!autofilter"]={ref:(x[0].match(/ref="([^"]*)"/)||[])[1]});var Z=[],ae=We.match(oa);if(ae)for(q=0;q!=ae.length;++q)Z[q]=Fs(ae[q].slice(ae[q].indexOf('"')+1));x=We.match(hg),x&&(function(Ie,Je,bt){for(var yt=Array.isArray(Ie),it=0;it!=Je.length;++it){var St=fs(Oe(Je[it]),!0);if(!St.ref)return;var Ht=((bt||{})["!id"]||[])[St.id];Ht?(St.Target=Ht.Target,St.location&&(St.Target+="#"+ws(St.location))):(St.Target="#"+ws(St.location),Ht={Target:St.Target,TargetMode:"Internal"}),St.Rel=Ht,St.tooltip&&(St.Tooltip=St.tooltip,delete St.tooltip);for(var zt=Fs(St.ref),Lt=zt.s.r;Lt<=zt.e.r;++Lt)for(var Ot=zt.s.c;Ot<=zt.e.c;++Ot){var Tt=bs({c:Ot,r:Lt});yt?(Ie[Lt]||(Ie[Lt]=[]),Ie[Lt][Ot]||(Ie[Lt][Ot]={t:"z",v:void 0}),Ie[Lt][Ot].l=St):(Ie[Tt]||(Ie[Tt]={t:"z",v:void 0}),Ie[Tt].l=St)}}})(y,x,h);var ie,Ee,We=We.match(mg);return We&&(y["!margins"]=(ie=fs(We[0]),Ee={},["left","right","top","bottom","header","footer"].forEach(function(Ie){ie[Ie]&&(Ee[Ie]=parseFloat(ie[Ie]))}),Ee)),!y["!ref"]&&j.e.c>=j.s.c&&j.e.r>=j.s.r&&(y["!ref"]=Cs(j)),0<d.sheetRows&&y["!ref"]&&(We=Fs(y["!ref"]),d.sheetRows<=+We.e.r&&(We.e.r=d.sheetRows-1,We.e.r>j.e.r&&(We.e.r=j.e.r),We.e.r<We.s.r&&(We.s.r=We.e.r),We.e.c>j.e.c&&(We.e.c=j.e.c),We.e.c<We.s.c&&(We.s.c=We.e.c),y["!fullref"]=y["!ref"],y["!ref"]=Cs(We))),0<z.length&&(y["!cols"]=z),0<Z.length&&(y["!merges"]=Z),y}function uu(r,d,u,h){r=fs(r),u.Sheets[h]||(u.Sheets[h]={}),r.codeName&&(u.Sheets[h].CodeName=ws(Oe(r.codeName)))}var pg=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Xp=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],hu=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,Ga,In,gf,Ka,pf,Ai,Tl,el=(Ga=/<(?:\w+:)?c[ \/>]/,In=/<\/(?:\w+:)?row>/,gf=/r=["']([^"']*)["']/,Ka=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,pf=/ref=["']([^"']*)["']/,Ai=He("v"),Tl=He("f"),function(r,d,u,h,g,b){for(var x,y,j,k,E,T,_=0,R="",q=[],I=[],ee=0,Y=0,z="",Z=0,ae=0,ie=0,Ee=0,We=Array.isArray(b.CellXf),Ie=[],Je=[],bt=Array.isArray(d),yt=[],it={},St=!1,Ht=!!u.sheetStubs,zt=r.split(In),Lt=0,Ot=zt.length;Lt!=Ot;++Lt){var Tt=(R=zt[Lt].trim()).length;if(Tt!==0){var jt=0;e:for(_=0;_<Tt;++_)switch(R[_]){case">":if(R[_-1]!="/"){++_;break e}if(u&&u.cellStyles){if(Z=(j=fs(R.slice(jt,_),!0)).r!=null?parseInt(j.r,10):Z+1,ae=-1,u.sheetRows&&u.sheetRows<Z)continue;St=!(it={}),j.ht&&(St=!0,it.hpt=parseFloat(j.ht),it.hpx=po(it.hpt)),j.hidden=="1"&&(St=!0,it.hidden=!0),j.outlineLevel!=null&&(St=!0,it.level=+j.outlineLevel),St&&(yt[Z-1]=it)}break;case"<":jt=_}if(_<=jt)break;if(Z=(j=fs(R.slice(jt,_),!0)).r!=null?parseInt(j.r,10):Z+1,ae=-1,!(u.sheetRows&&u.sheetRows<Z)){h.s.r>Z-1&&(h.s.r=Z-1),h.e.r<Z-1&&(h.e.r=Z-1),u&&u.cellStyles&&(St=!(it={}),j.ht&&(St=!0,it.hpt=parseFloat(j.ht),it.hpx=po(it.hpt)),j.hidden=="1"&&(St=!0,it.hidden=!0),j.outlineLevel!=null&&(St=!0,it.level=+j.outlineLevel),St&&(yt[Z-1]=it)),q=R.slice(_).split(Ga);for(var qt,Xt=0;Xt!=q.length&&q[Xt].trim().charAt(0)=="<";++Xt);for(q=q.slice(Xt),_=0;_!=q.length;++_)if((R=q[_].trim()).length!==0){if(I=R.match(gf),ee=_,Y=0,R="<c "+(R.slice(0,1)=="<"?">":"")+R,I!=null&&I.length===2){for(ee=0,z=I[1],Y=0;Y!=z.length&&!((x=z.charCodeAt(Y)-64)<1||26<x);++Y)ee=26*ee+x;ae=--ee}else++ae;for(Y=0;Y!=R.length&&R.charCodeAt(Y)!==62;++Y);if(++Y,(j=fs(R.slice(0,Y),!0)).r||(j.r=bs({r:Z-1,c:ae})),y={t:""},(I=(z=R.slice(Y)).match(Ai))!=null&&I[1]!==""&&(y.v=ws(I[1])),u.cellFormula){(I=z.match(Tl))!=null&&I[1]!==""?(y.f=ws(Oe(I[1])).replace(/\r\n/g,`
`),u.xlfn||(y.f=nf(y.f)),-1<I[0].indexOf('t="array"')?(y.F=(z.match(pf)||[])[1],-1<y.F.indexOf(":")&&Ie.push([Fs(y.F),y.F])):-1<I[0].indexOf('t="shared"')&&(E=fs(I[0]),qt=ws(Oe(I[1])),u.xlfn||(qt=nf(qt)),Je[parseInt(E.si,10)]=[E,qt,j.r])):(I=z.match(/<f[^>]*\/>/))&&Je[(E=fs(I[0])).si]&&(y.f=(T=Je[E.si][1],Vt=Je[E.si][2],qt=j.r,Vt=Ia(Vt).s,qt=Hr(qt),Sd(T,{r:qt.r-Vt.r,c:qt.c-Vt.c})));for(var ns=Hr(j.r),Y=0;Y<Ie.length;++Y)ns.r>=Ie[Y][0].s.r&&ns.r<=Ie[Y][0].e.r&&ns.c>=Ie[Y][0].s.c&&ns.c<=Ie[Y][0].e.c&&(y.F=Ie[Y][1])}if(j.t==null&&y.v===void 0)if(y.f||y.F)y.v=0,y.t="n";else{if(!Ht)continue;y.t="z"}else y.t=j.t||"n";switch(h.s.c>ae&&(h.s.c=ae),h.e.c<ae&&(h.e.c=ae),y.t){case"n":if(y.v==""||y.v==null){if(!Ht)continue;y.t="z"}else y.v=parseFloat(y.v);break;case"s":if(y.v===void 0){if(!Ht)continue;y.t="z"}else k=gc[parseInt(y.v,10)],y.v=k.t,y.r=k.r,u.cellHTML&&(y.h=k.h);break;case"str":y.t="s",y.v=y.v!=null?Oe(y.v):"",u.cellHTML&&(y.h=Oi(y.v));break;case"inlineStr":I=z.match(Ka),y.t="s",I!=null&&(k=gd(I[1]))?(y.v=k.t,u.cellHTML&&(y.h=k.h)):y.v="";break;case"b":y.v=or(y.v);break;case"d":u.cellDates?y.v=_s(y.v,1):(y.v=qr(_s(y.v,1)),y.t="n");break;case"e":u&&u.cellText===!1||(y.w=y.v),y.v=Ln[y.v]}var Ds,ie=Ee=0,Vt=null;We&&j.s!==void 0&&(Vt=b.CellXf[j.s])!=null&&(Vt.numFmtId!=null&&(ie=Vt.numFmtId),u.cellStyles&&Vt.fillId!=null&&(Ee=Vt.fillId)),Si(y,ie,Ee,u,g,b),u.cellDates&&We&&y.t=="n"&&$r(W[ie])&&(y.t="d",y.v=mi(y.v)),j.cm&&u.xlmeta&&(Ds=(u.xlmeta.Cell||[])[+j.cm-1])&&Ds.type=="XLDAPR"&&(y.D=!0),bt?(d[(Ds=Hr(j.r)).r]||(d[Ds.r]=[]),d[Ds.r][Ds.c]=y):d[j.r]=y}}}}0<yt.length&&(d["!rows"]=yt)});function xf(r,d){for(var u,h,g,b,x=[],y=[],j=Fs(r["!ref"]),k=[],E=0,I=0,T=r["!rows"],_=Array.isArray(r),R={r:""},q=-1,I=j.s.c;I<=j.e.c;++I)k[I]=Ar(I);for(E=j.s.r;E<=j.e.r;++E){for(y=[],g=Ur(E),I=j.s.c;I<=j.e.c;++I){h=k[I]+g;var ee=_?(r[E]||[])[I]:r[h];ee!==void 0&&(u=(function(Y,z,Z,ae){if(Y.c&&Z["!comments"].push([z,Y.c]),Y.v===void 0&&typeof Y.f!="string"||Y.t==="z"&&!Y.f)return"";var ie="",Ee=Y.t,We=Y.v;if(Y.t!=="z")switch(Y.t){case"b":ie=Y.v?"1":"0";break;case"n":ie=""+Y.v;break;case"e":ie=Xn[Y.v];break;case"d":ie=ae&&ae.cellDates?_s(Y.v,-1).toISOString():((Y=vs(Y)).t="n",""+(Y.v=qr(_s(Y.v)))),Y.z===void 0&&(Y.z=W[14]);break;default:ie=Y.v}var Ie=Ct("v",Ys(ie)),Je={r:z},bt=Ji(ae.cellXfs,Y,ae);switch(bt!==0&&(Je.s=bt),Y.t){case"n":break;case"d":Je.t="d";break;case"b":Je.t="b";break;case"e":Je.t="e";break;case"z":break;default:if(Y.v==null){delete Y.t;break}if(32767<Y.v.length)throw new Error("Text length must not exceed 32767 characters");if(ae&&ae.bookSST){Ie=Ct("v",""+Fd(ae.Strings,Y.v,ae.revStrings)),Je.t="s";break}Je.t="str"}return Y.t!=Ee&&(Y.t=Ee,Y.v=We),typeof Y.f=="string"&&Y.f&&(We=Y.F&&Y.F.slice(0,z.length)==z?{t:"array",ref:Y.F}:null,Ie=Le("f",Ys(Y.f),We)+(Y.v!=null?Ie:"")),Y.l&&Z["!links"].push([z,Y.l]),Y.D&&(Je.cm=1),Le("c",Ie,Je)})(ee,h,r,d))!=null&&y.push(u)}(0<y.length||T&&T[E])&&(R={r:g},T&&T[E]&&((b=T[E]).hidden&&(R.hidden=1),q=-1,b.hpx?q=cc(b.hpx):b.hpt&&(q=b.hpt),-1<q&&(R.ht=q,R.customHeight=1),b.level&&(R.outlineLevel=b.level)),x[x.length]=Le("row",y.join(""),R))}if(T)for(;E<T.length;++E)T&&T[E]&&(R={r:E+1},(b=T[E]).hidden&&(R.hidden=1),q=-1,b.hpx?q=cc(b.hpx):b.hpt&&(q=b.hpt),-1<q&&(R.ht=q,R.customHeight=1),b.level&&(R.outlineLevel=b.level),x[x.length]=Le("row","",R));return x.join("")}function fu(r,d,u,h){var g,b,x=[hr,Le("worksheet",null,{xmlns:ta[0],"xmlns:r":hs.r})],y=u.SheetNames[r],j=u.Sheets[y],k=(j=j??{})["!ref"]||"A1",E=Fs(k);if(16383<E.e.c||1048575<E.e.r){if(d.WTF)throw new Error("Range "+k+" exceeds format limit A1:XFD1048576");E.e.c=Math.min(E.e.c,16383),E.e.r=Math.min(E.e.c,1048575),k=Cs(E)}h=h||{},j["!comments"]=[];var T,_,R=[];(function(Y,z,Z,ae,ie){var Ee=!1,We={},Ie=null;if(ae.bookType!=="xlsx"&&z.vbaraw){var Je=z.SheetNames[Z];try{z.Workbook&&(Je=z.Workbook.Sheets[Z].CodeName||Je)}catch{}Ee=!0,We.codeName=Xe(Ys(Je))}Y&&Y["!outline"]&&(ae={summaryBelow:1,summaryRight:1},Y["!outline"].above&&(ae.summaryBelow=0),Y["!outline"].left&&(ae.summaryRight=0),Ie=(Ie||"")+Le("outlinePr",null,ae)),(Ee||Ie)&&(ie[ie.length]=Le("sheetPr",Ie,We))})(j,u,r,d,x),x[x.length]=Le("dimension",null,{ref:k}),x[x.length]=(y={workbookViewId:"0"},((((E=u)||{}).Workbook||{}).Views||[])[0]&&(y.rightToLeft=E.Workbook.Views[0].RTL?"1":"0"),Le("sheetViews",Le("sheetView",null,y),{})),d.sheetFormat&&(x[x.length]=Le("sheetFormatPr",null,{defaultRowHeight:d.sheetFormat.defaultRowHeight||"16",baseColWidth:d.sheetFormat.baseColWidth||"10",outlineLevelRow:d.sheetFormat.outlineLevelRow||"7"})),j["!cols"]!=null&&0<j["!cols"].length&&(x[x.length]=(function(Y){for(var z,Z=["<cols>"],ae=0;ae!=Y.length;++ae)(z=Y[ae])&&(Z[Z.length]=Le("col",null,xc(ae,z)));return Z[Z.length]="</cols>",Z.join("")})(j["!cols"])),x[g=x.length]="<sheetData/>",j["!links"]=[],j["!ref"]!=null&&0<(b=xf(j,d)).length&&(x[x.length]=b),x.length>g+1&&(x[x.length]="</sheetData>",x[g]=x[g].replace("/>",">")),j["!protect"]&&(x[x.length]=(T=j["!protect"],_={sheet:1},pg.forEach(function(Y){T[Y]!=null&&T[Y]&&(_[Y]="1")}),Xp.forEach(function(Y){T[Y]==null||T[Y]||(_[Y]="0")}),T.password&&(_.password=G0(T.password).toString(16).toUpperCase()),Le("sheetProtection",null,_))),j["!autofilter"]!=null&&(x[x.length]=(function(Y,z,Z,ae){var ie=typeof Y.ref=="string"?Y.ref:Cs(Y.ref);Z.Workbook||(Z.Workbook={Sheets:[]}),Z.Workbook.Names||(Z.Workbook.Names=[]);var Ee=Z.Workbook.Names;(Y=Ia(ie)).s.r==Y.e.r&&(Y.e.r=Ia(z["!ref"]).e.r,ie=Cs(Y));for(var We=0;We<Ee.length;++We){var Ie=Ee[We];if(Ie.Name=="_xlnm._FilterDatabase"&&Ie.Sheet==ae){Ie.Ref="'"+Z.SheetNames[ae]+"'!"+ie;break}}return We==Ee.length&&Ee.push({Name:"_xlnm._FilterDatabase",Sheet:ae,Ref:"'"+Z.SheetNames[ae]+"'!"+ie}),Le("autoFilter",null,{ref:ie})})(j["!autofilter"],j,u,r)),j["!merges"]!=null&&0<j["!merges"].length&&(x[x.length]=(function(Y){if(Y.length===0)return"";for(var z='<mergeCells count="'+Y.length+'">',Z=0;Z!=Y.length;++Z)z+='<mergeCell ref="'+Cs(Y[Z])+'"/>';return z+"</mergeCells>"})(j["!merges"]));var q,I,ee=-1;return 0<j["!links"].length&&(x[x.length]="<hyperlinks>",j["!links"].forEach(function(Y){Y[1].Target&&(I={ref:Y[0]},Y[1].Target.charAt(0)!="#"&&(ee=rr(h,-1,Ys(Y[1].Target).replace(/#.*$/,""),ks.HLINK),I["r:id"]="rId"+ee),-1<(q=Y[1].Target.indexOf("#"))&&(I.location=Ys(Y[1].Target.slice(q+1))),Y[1].Tooltip&&(I.tooltip=Ys(Y[1].Tooltip)),x[x.length]=Le("hyperlink",null,I))}),x[x.length]="</hyperlinks>"),delete j["!links"],j["!margins"]!=null&&(x[x.length]=(Ci(u=j["!margins"]),Le("pageMargins",null,u))),d&&!d.ignoreEC&&d.ignoreEC!=null||(x[x.length]=Ct("ignoredErrors",Le("ignoredError",null,{numberStoredAsText:1,sqref:k}))),0<R.length&&(ee=rr(h,-1,"../drawings/drawing"+(r+1)+".xml",ks.DRAW),x[x.length]=Le("drawing",null,{"r:id":"rId"+ee}),j["!drawing"]=R),0<j["!comments"].length&&(ee=rr(h,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ks.VML),x[x.length]=Le("legacyDrawing",null,{"r:id":"rId"+ee}),j["!legacy"]=ee),1<x.length&&(x[x.length]="</worksheet>",x[1]=x[1].replace("/>",">")),x.join("")}function ni(r,d,u,h){u=(function(g,b,x){var y=pt(145),j=(x["!rows"]||[])[g]||{};y.write_shift(4,g),y.write_shift(4,0);var E=320;j.hpx?E=20*cc(j.hpx):j.hpt&&(E=20*j.hpt),y.write_shift(2,E),y.write_shift(1,0),E=0,j.level&&(E|=j.level),j.hidden&&(E|=16),(j.hpx||j.hpt)&&(E|=32),y.write_shift(1,E),y.write_shift(1,0);var k=0,E=y.l;y.l+=4;for(var T={r:g,c:0},_=0;_<16;++_)if(!(b.s.c>_+1<<10||b.e.c<_<<10)){for(var R=-1,q=-1,I=_<<10;I<_+1<<10;++I)T.c=I,(Array.isArray(x)?(x[T.r]||[])[T.c]:x[bs(T)])&&(R<0&&(R=I),q=I);R<0||(++k,y.write_shift(4,R),y.write_shift(4,q))}return g=y.l,y.l=E,y.write_shift(4,k),y.l=g,y.length>y.l?y.slice(0,y.l):y})(h,u,d),(17<u.length||(d["!rows"]||[])[h])&&wt(r,0,u)}var Md=Qn,bc=gl;function yc(r){return[Jl(r),Aa(r),"n"]}var Ei=Qn,vc=gl,bf=["left","right","top","bottom","header","footer"];function xg(r,d,u,h,g,b,x){if(d.v===void 0)return!1;var y="";switch(d.t){case"b":y=d.v?"1":"0";break;case"d":(d=vs(d)).z=d.z||W[14],d.v=qr(_s(d.v)),d.t="n";break;case"n":case"e":y=""+d.v;break;default:y=d.v}var j,k,E,T,_,R,q,I,ee,Y,z,Z,ae,ie,Ee,We,Ie,Je,bt,yt,it={r:u,c:h};switch(it.s=Ji(g.cellXfs,d,g),d.l&&b["!links"].push([bs(it),d.l]),d.c&&b["!comments"].push([bs(it),d.c]),d.t){case"s":case"str":return g.bookSST?(y=Fd(g.Strings,d.v,g.revStrings),it.t="s",it.v=y,x?wt(r,18,(Zl(Ie=it,Je=Je??pt(8)),Je.write_shift(4,Ie.v),Je)):wt(r,7,(Xl(Ie=it,We=We??pt(12)),We.write_shift(4,Ie.v),We))):(it.t="str",x?wt(r,17,(ie=d,Zl(it,Ee=Ee??pt(8+4*ie.v.length)),ca(ie.v,Ee),Ee.length>Ee.l?Ee.slice(0,Ee.l):Ee)):wt(r,6,(ie=d,Xl(it,ae=ae??pt(12+4*ie.v.length)),ca(ie.v,ae),ae.length>ae.l?ae.slice(0,ae.l):ae))),!0;case"n":return d.v==(0|d.v)&&-1e3<d.v&&d.v<1e3?x?wt(r,13,(z=d,Zl(it,Z=Z??pt(8)),eo(z.v,Z),Z)):wt(r,2,(z=d,Xl(it,Y=Y??pt(12)),eo(z.v,Y),Y)):x?wt(r,16,(I=d,Zl(it,ee=ee??pt(12)),Mn(I.v,ee),ee)):wt(r,5,(I=d,Xl(it,q=q??pt(16)),Mn(I.v,q),q)),!0;case"b":return it.t="b",x?wt(r,15,(_=d,Zl(it,R=R??pt(5)),R.write_shift(1,_.v?1:0),R)):wt(r,4,(_=d,Xl(it,T=T??pt(9)),T.write_shift(1,_.v?1:0),T)),!0;case"e":return it.t="e",x?wt(r,14,(k=d,Zl(it,E=E??pt(8)),E.write_shift(1,k.v),E.write_shift(2,0),E.write_shift(1,0),E)):wt(r,3,(k=d,Xl(it,j=j??pt(9)),j.write_shift(1,k.v),j)),!0}return x?wt(r,12,Zl(it,yt=yt??pt(4))):wt(r,1,Xl(it,bt=bt??pt(8))),!0}function Ld(r,d){var u,h;d&&d["!merges"]&&(wt(r,177,(u=d["!merges"].length,(h=h??pt(4)).write_shift(4,u),h)),d["!merges"].forEach(function(g){wt(r,176,vc(g))}),wt(r,178))}function bg(r,d){d&&d["!cols"]&&(wt(r,390),d["!cols"].forEach(function(u,h){u&&wt(r,60,(function(g,b,x){x==null&&(x=pt(18));var y=xc(g,b);return x.write_shift(-4,g),x.write_shift(-4,g),x.write_shift(4,256*(y.width||10)),x.write_shift(4,0),g=0,b.hidden&&(g|=1),typeof y.width=="number"&&(g|=2),b.level&&(g|=b.level<<8),x.write_shift(2,g),x})(h,u))}),wt(r,391))}function mu(r,d){var u;d&&d["!ref"]&&(wt(r,648),wt(r,649,(u=Fs(d["!ref"]),(d=pt(24)).write_shift(4,4),d.write_shift(4,1),gl(u,d),d)),wt(r,650))}function yg(r,d,u){d["!links"].forEach(function(h){var g,b;h[1].Target&&(g=rr(u,-1,h[1].Target.replace(/#.*$/,""),ks.HLINK),wt(r,494,(b=g,h=pt(50+4*((g=h)[1].Target.length+(g[1].Tooltip||"").length)),gl({s:Hr(g[0]),e:Hr(g[0])},h),rd("rId"+b,h),ca(((b=g[1].Target.indexOf("#"))==-1?"":g[1].Target.slice(b+1))||"",h),ca(g[1].Tooltip||"",h),ca("",h),h.slice(0,h.l))))}),delete d["!links"]}function Jp(r,d,u){wt(r,133),wt(r,137,(function(h,g){g==null&&(g=pt(30));var b=924;return(((h||{}).Views||[])[0]||{}).RTL&&(b|=32),g.write_shift(2,b),g.write_shift(4,0),g.write_shift(4,0),g.write_shift(4,0),g.write_shift(1,0),g.write_shift(1,0),g.write_shift(2,0),g.write_shift(2,100),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(4,0),g})(u)),wt(r,138),wt(r,134)}function Zp(r,d){var u,h;d["!protect"]&&wt(r,535,(u=d["!protect"],(h=h??pt(66)).write_shift(2,u.password?G0(u.password):0),h.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(g){g[1]?h.write_shift(4,u[g[0]]==null||u[g[0]]?0:1):h.write_shift(4,u[g[0]]!=null&&u[g[0]]?0:1)}),h))}function sr(r,d,u,h){var g=Pa(),k=u.SheetNames[r],b=u.Sheets[k]||{},x=k;try{u&&u.Workbook&&(x=u.Workbook.Sheets[r].CodeName||x)}catch{}var y,j,k=Fs(b["!ref"]||"A1");if(16383<k.e.c||1048575<k.e.r){if(d.WTF)throw new Error("Range "+(b["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");k.e.c=Math.min(k.e.c,16383),k.e.r=Math.min(k.e.c,1048575)}return b["!links"]=[],b["!comments"]=[],wt(g,129),(u.vbaraw||b["!outline"])&&wt(g,147,(function(E,T,_){_==null&&(_=pt(84+4*E.length));var R=192;T&&(T.above&&(R&=-65),T.left&&(R&=-129)),_.write_shift(1,R);for(var q=1;q<3;++q)_.write_shift(1,0);return Bi({auto:1},_),_.write_shift(-4,-1),_.write_shift(-4,-1),Go(E,_),_.slice(0,_.l)})(x,b["!outline"])),wt(g,148,bc(k)),Jp(g,0,u.Workbook),bg(g,b),(function(E,T,_){var R,q=Fs(T["!ref"]||"A1"),I=[];wt(E,145);var ee=Array.isArray(T),Y=q.e.r;T["!rows"]&&(Y=Math.max(q.e.r,T["!rows"].length-1));for(var z=q.s.r;z<=Y;++z){R=Ur(z),ni(E,T,q,z);var Z=!1;if(z<=q.e.r)for(var ae=q.s.c;ae<=q.e.c;++ae){z===q.s.r&&(I[ae]=Ar(ae)),ie=I[ae]+R;var ie=ee?(T[z]||[])[ae]:T[ie];ie?Z=xg(E,ie,z,ae,_,T,Z):Z=!1}}wt(E,146)})(g,b,d),Zp(g,b),(function(E,T,_,R){if(T["!autofilter"]){var ee=T["!autofilter"],q=typeof ee.ref=="string"?ee.ref:Cs(ee.ref);_.Workbook||(_.Workbook={Sheets:[]}),_.Workbook.Names||(_.Workbook.Names=[]);var I=_.Workbook.Names,ee=Ia(q);ee.s.r==ee.e.r&&(ee.e.r=Ia(T["!ref"]).e.r,q=Cs(ee));for(var Y=0;Y<I.length;++Y){var z=I[Y];if(z.Name=="_xlnm._FilterDatabase"&&z.Sheet==R){z.Ref="'"+_.SheetNames[R]+"'!"+q;break}}Y==I.length&&I.push({Name:"_xlnm._FilterDatabase",Sheet:R,Ref:"'"+_.SheetNames[R]+"'!"+q}),wt(E,161,gl(Fs(q))),wt(E,162)}})(g,b,u,r),Ld(g,b),yg(g,b,h),b["!margins"]&&wt(g,476,(y=b["!margins"],j==null&&(j=pt(48)),Ci(y),bf.forEach(function(E){Mn(y[E],j)}),j)),d&&!d.ignoreEC&&d.ignoreEC!=null||mu(g,b),k=g,d=r,h=h,0<(b=b)["!comments"].length&&(d=rr(h,-1,"../drawings/vmlDrawing"+(d+1)+".vml",ks.VML),wt(k,551,rd("rId"+d)),b["!legacy"]=d),wt(g,130),g.end()}function yr(r,d,u,h,g,b){var x=b||{"!type":"chart"};if(!r)return b;var y,j=0,k=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(T){var _=(function(R){var q,I=[],ee=R.match(/^<c:numCache>/);(R.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(z){z=z.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/),z&&(I[+z[1]]=ee?+z[2]:z[2])});var Y=ws((R.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(R.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(z){q=z.replace(/<.*?>/g,"")}),[I,Y,q]})(T);E.s.r=E.s.c=0,E.e.c=j,y=Ar(j),_[0].forEach(function(R,q){x[y+Ur(q)]={t:"n",v:R,z:_[1]},k=q}),E.e.r<k&&(E.e.r=k),++j}),0<j&&(x["!ref"]=Cs(E)),x}var Rs=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Vs=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],dr=[],Cn=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function tl(r,d){for(var u=0;u!=r.length;++u)for(var h=r[u],g=0;g!=d.length;++g){var b=d[g];if(h[b[0]]==null)h[b[0]]=b[1];else switch(b[2]){case"bool":typeof h[b[0]]=="string"&&(h[b[0]]=or(h[b[0]]));break;case"int":typeof h[b[0]]=="string"&&(h[b[0]]=parseInt(h[b[0]],10))}}}function vo(r,d){for(var u=0;u!=d.length;++u){var h=d[u];if(r[h[0]]==null)r[h[0]]=h[1];else switch(h[2]){case"bool":typeof r[h[0]]=="string"&&(r[h[0]]=or(r[h[0]]));break;case"int":typeof r[h[0]]=="string"&&(r[h[0]]=parseInt(r[h[0]],10))}}}function gu(r){vo(r.WBProps,Rs),vo(r.CalcPr,Cn),tl(r.WBView,Vs),tl(r.Sheets,dr),Dl.date1904=or(r.WBProps.date1904)}var sl="][*?/\\".split("");function Vr(r,d){if(31<r.length)throw new Error("Sheet names cannot exceed 31 chars");var u=!0;return sl.forEach(function(h){if(r.indexOf(h)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),u}function rl(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var d,u,h,g=r.Workbook&&r.Workbook.Sheets||[];d=r.SheetNames,u=g,h=!!r.vbaraw,d.forEach(function(x,y){Vr(x);for(var j=0;j<y;++j)if(x==d[j])throw new Error("Duplicate Sheet Name: "+x);if(h){var k=u&&u[y]&&u[y].CodeName||x;if(k.charCodeAt(0)==95&&22<k.length)throw new Error("Bad Code Name: Worksheet"+k)}});for(var b=0;b<r.SheetNames.length;++b)(function(x,y){if(x&&x["!ref"]){var j=Fs(x["!ref"]);if(j.e.c<j.s.c||j.e.r<j.s.r)throw new Error("Bad range ("+y+"): "+x["!ref"])}})(r.Sheets[r.SheetNames[b]],(r.SheetNames[b],b))}var wo=/<\w+:workbook/;function pu(r){var d=[hr];d[d.length]=Le("workbook",null,{xmlns:ta[0],"xmlns:r":hs.r});var u=r.Workbook&&0<(r.Workbook.Names||[]).length,h={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(Rs.forEach(function(y){r.Workbook.WBProps[y[0]]!=null&&r.Workbook.WBProps[y[0]]!=y[1]&&(h[y[0]]=r.Workbook.WBProps[y[0]])}),r.Workbook.WBProps.CodeName&&(h.codeName=r.Workbook.WBProps.CodeName,delete h.CodeName)),d[d.length]=Le("workbookPr",null,h);var g=r.Workbook&&r.Workbook.Sheets||[],b=0;if(g&&g[0]&&g[0].Hidden){for(d[d.length]="<bookViews>",b=0;b!=r.SheetNames.length&&g[b]&&g[b].Hidden;++b);b==r.SheetNames.length&&(b=0),d[d.length]='<workbookView firstSheet="'+b+'" activeTab="'+b+'"/>',d[d.length]="</bookViews>"}for(d[d.length]="<sheets>",b=0;b!=r.SheetNames.length;++b){var x={name:Ys(r.SheetNames[b].slice(0,31))};if(x.sheetId=""+(b+1),x["r:id"]="rId"+(b+1),g[b])switch(g[b].Hidden){case 1:x.state="hidden";break;case 2:x.state="veryHidden"}d[d.length]=Le("sheet",null,x)}return d[d.length]="</sheets>",u&&(d[d.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(y){var j={name:y.Name};y.Comment&&(j.comment=y.Comment),y.Sheet!=null&&(j.localSheetId=""+y.Sheet),y.Hidden&&(j.hidden="1"),y.Ref&&(d[d.length]=Le("definedName",Ys(y.Ref),j))}),d[d.length]="</definedNames>"),2<d.length&&(d[d.length]="</workbook>",d[1]=d[1].replace("/>",">")),d.join("")}function Sn(r,d){var u={};return r.read_shift(4),u.ArchID=r.read_shift(4),r.l+=d-8,u}function wc(r,d){wt(r,143);for(var u,h=0;h!=d.SheetNames.length;++h){var g={Hidden:d.Workbook&&d.Workbook.Sheets&&d.Workbook.Sheets[h]&&d.Workbook.Sheets[h].Hidden||0,iTabID:h+1,strRelID:"rId"+(h+1),name:d.SheetNames[h]};wt(r,156,(u=g,(g=(g=void 0)||pt(127)).write_shift(4,u.Hidden),g.write_shift(4,u.iTabID),rd(u.strRelID,g),ca(u.name.slice(0,31),g),g.length>g.l?g.slice(0,g.l):g))}wt(r,144)}function Rd(r,d){if(d.Workbook&&d.Workbook.Sheets){for(var u,h=d.Workbook.Sheets,g=0,b=-1,x=-1;g<h.length;++g)!h[g]||!h[g].Hidden&&b==-1?b=g:h[g].Hidden==1&&x==-1&&(x=g);b<x||(wt(r,135),wt(r,158,(d=b,(u=u||pt(29)).write_shift(-4,0),u.write_shift(-4,460),u.write_shift(4,28800),u.write_shift(4,17600),u.write_shift(4,500),u.write_shift(4,d),u.write_shift(4,d),u.write_shift(1,120),u.length>u.l?u.slice(0,u.l):u)),wt(r,136))}}function nn(r,d){var u=Pa();return wt(u,131),wt(u,128,(function(h){h=h||pt(127);for(var g=0;g!=4;++g)h.write_shift(4,0);return ca("SheetJS",h),ca(s.version,h),ca(s.version,h),ca("7262",h),h.length>h.l?h.slice(0,h.l):h})()),wt(u,153,(function(h,g){g=g||pt(72);var b=0;return h&&h.filterPrivacy&&(b|=8),g.write_shift(4,b),g.write_shift(4,0),Go(h&&h.CodeName||"ThisWorkbook",g),g.slice(0,g.l)})(r.Workbook&&r.Workbook.WBProps||null)),Rd(u,r),wc(u,r),wt(u,132),u.end()}function yf(r,d,u){return(d.slice(-4)===".bin"?function(h,g){var b={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},x=[],y=!1;(g=g||{}).biff=12;var j=[],k=[[]];return k.SheetNames=[],k.XTI=[],jo[16]={n:"BrtFRTArchID$",f:Sn},Ii(h,function(E,T,_){switch(_){case 156:k.SheetNames.push(E.name),b.Sheets.push(E);break;case 153:b.WBProps=E;break;case 39:E.Sheet!=null&&(g.SID=E.Sheet),E.Ref=za(E.Ptg,0,null,k,g),delete g.SID,delete E.Ptg,j.push(E);break;case 1036:break;case 357:case 358:case 355:case 667:k[0].length?k.push([_,E]):k[0]=[_,E],k[k.length-1].XTI=[];break;case 362:k.length===0&&(k[0]=[],k[0].XTI=[]),k[k.length-1].XTI=k[k.length-1].XTI.concat(E),k.XTI=k.XTI.concat(E);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:x.push(_),y=!0;break;case 36:x.pop(),y=!1;break;case 37:x.push(_),y=!0;break;case 38:x.pop(),y=!1;break;case 16:break;default:if(!T.T&&(!y||g.WTF&&x[x.length-1]!=37&&x[x.length-1]!=35))throw new Error("Unexpected record 0x"+_.toString(16))}},g),gu(b),b.Names=j,b.supbooks=k,b}:function(h,g){if(!h)throw new Error("Could not find file");var b={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},x=!1,y="xmlns",j={},k=0;if(h.replace(Fr,function(E,T){var _=fs(E);switch(Tn(_[0])){case"<?xml":break;case"<workbook":E.match(wo)&&(y="xmlns"+E.match(/<(\w+):/)[1]),b.xmlns=_[y];break;case"</workbook>":break;case"<fileVersion":delete _[0],b.AppVersion=_;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Rs.forEach(function(R){if(_[R[0]]!=null)switch(R[2]){case"bool":b.WBProps[R[0]]=or(_[R[0]]);break;case"int":b.WBProps[R[0]]=parseInt(_[R[0]],10);break;default:b.WBProps[R[0]]=_[R[0]]}}),_.codeName&&(b.WBProps.CodeName=Oe(_.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete _[0],b.WBView.push(_);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(_.state){case"hidden":_.Hidden=1;break;case"veryHidden":_.Hidden=2;break;default:_.Hidden=0}delete _.state,_.name=ws(Oe(_.name)),delete _[0],b.Sheets.push(_);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":x=!0;break;case"</definedNames>":x=!1;break;case"<definedName":(j={}).Name=Oe(_.name),_.comment&&(j.Comment=_.comment),_.localSheetId&&(j.Sheet=+_.localSheetId),or(_.hidden||"0")&&(j.Hidden=!0),k=T+E.length;break;case"</definedName>":j.Ref=ws(Oe(h.slice(k,T))),b.Names.push(j);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete _[0],b.CalcPr=_;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":x=!0;break;case"</ext>":x=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":x=!0;break;case"</AlternateContent>":x=!1;break;case"<revisionPtr":break;default:if(!x&&g.WTF)throw new Error("unrecognized "+_[0]+" in workbook")}return E}),ta.indexOf(b.xmlns)===-1)throw new Error("Unknown Namespace: "+b.xmlns);return gu(b),b})(r,u)}function xu(r,d,u,h,g,b,x,y){return(d.slice(-4)===".bin"?function(j,k,E,T,_,R,q){if(!j)return j;var I=k||{};T=T||{"!id":{}};var ee,Y,z,Z,ae,ie,Ee,We,Ie,Je,bt=I.dense?[]:{},yt={s:{r:2e6,c:2e6},e:{r:0,c:0}},it=!1,St=!1,Ht=[];I.biff=12;var zt=I["!row"]=0,Lt=!1,Ot=[],Tt={},jt=I.supbooks||_.supbooks||[[]];if(jt.sharedf=Tt,jt.arrayf=Ot,jt.SheetNames=_.SheetNames||_.Sheets.map(function(At){return At.name}),!I.supbooks&&(I.supbooks=jt,_.Names))for(var qt=0;qt<_.Names.length;++qt)jt[0][qt+1]=_.Names[qt];var Xt,ns=[],Ds=[],Vt=!1;return jo[16]={n:"BrtShortReal",f:yc},Ii(j,function(At,gs,Us){if(!St)switch(Us){case 148:ee=At;break;case 0:Y=At,I.sheetRows&&I.sheetRows<=Y.r&&(St=!0),Ie=Ur(ae=Y.r),I["!row"]=Y.r,(At.hidden||At.hpt||At.level!=null)&&(At.hpt&&(At.hpx=po(At.hpt)),Ds[At.r]=At);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(z={t:At[2]},At[2]){case"n":z.v=At[1];break;case"s":We=gc[At[1]],z.v=We.t,z.r=We.r;break;case"b":z.v=!!At[1];break;case"e":z.v=At[1],I.cellText!==!1&&(z.w=Xn[z.v]);break;case"str":z.t="s",z.v=At[1];break;case"is":z.t="s",z.v=At[1].t}if((Z=q.CellXf[At[0].iStyleRef])&&Si(z,Z.numFmtId,null,I,R,q),ie=At[0].c==-1?ie+1:At[0].c,I.dense?(bt[ae]||(bt[ae]=[]),bt[ae][ie]=z):bt[Ar(ie)+Ie]=z,I.cellFormula){for(Lt=!1,zt=0;zt<Ot.length;++zt){var Os=Ot[zt];Y.r>=Os[0].s.r&&Y.r<=Os[0].e.r&&ie>=Os[0].s.c&&ie<=Os[0].e.c&&(z.F=Cs(Os[0]),Lt=!0)}!Lt&&3<At.length&&(z.f=At[3])}yt.s.r>Y.r&&(yt.s.r=Y.r),yt.s.c>ie&&(yt.s.c=ie),yt.e.r<Y.r&&(yt.e.r=Y.r),yt.e.c<ie&&(yt.e.c=ie),I.cellDates&&Z&&z.t=="n"&&$r(W[Z.numFmtId])&&(Zs=Q(z.v))&&(z.t="d",z.v=new Date(Zs.y,Zs.m-1,Zs.d,Zs.H,Zs.M,Zs.S,Zs.u)),Xt&&(Xt.type=="XLDAPR"&&(z.D=!0),Xt=void 0);break;case 1:case 12:if(!I.sheetStubs||it)break;z={t:"z",v:void 0},ie=At[0].c==-1?ie+1:At[0].c,I.dense?(bt[ae]||(bt[ae]=[]),bt[ae][ie]=z):bt[Ar(ie)+Ie]=z,yt.s.r>Y.r&&(yt.s.r=Y.r),yt.s.c>ie&&(yt.s.c=ie),yt.e.r<Y.r&&(yt.e.r=Y.r),yt.e.c<ie&&(yt.e.c=ie),Xt&&(Xt.type=="XLDAPR"&&(z.D=!0),Xt=void 0);break;case 176:Ht.push(At);break;case 49:Xt=((I.xlmeta||{}).Cell||[])[At-1];break;case 494:var Zs=T["!id"][At.relId];for(Zs?(At.Target=Zs.Target,At.loc&&(At.Target+="#"+At.loc),At.Rel=Zs):At.relId==""&&(At.Target="#"+At.loc),ae=At.rfx.s.r;ae<=At.rfx.e.r;++ae)for(ie=At.rfx.s.c;ie<=At.rfx.e.c;++ie)I.dense?(bt[ae]||(bt[ae]=[]),bt[ae][ie]||(bt[ae][ie]={t:"z",v:void 0}),bt[ae][ie].l=At):(Ee=bs({c:ie,r:ae}),bt[Ee]||(bt[Ee]={t:"z",v:void 0}),bt[Ee].l=At);break;case 426:if(!I.cellFormula)break;Ot.push(At),(Je=I.dense?bt[ae][ie]:bt[Ar(ie)+Ie]).f=za(At[1],0,{r:Y.r,c:ie},jt,I),Je.F=Cs(At[0]);break;case 427:if(!I.cellFormula)break;Tt[bs(At[0].s)]=At[1],(Je=I.dense?bt[ae][ie]:bt[Ar(ie)+Ie]).f=za(At[1],0,{r:Y.r,c:ie},jt,I);break;case 60:if(!I.cellStyles)break;for(;At.e>=At.s;)ns[At.e--]={width:At.w/256,hidden:!!(1&At.flags),level:At.level},Vt||(Vt=!0,wd(At.w/256)),Cl(ns[At.e+1]);break;case 161:bt["!autofilter"]={ref:Cs(At)};break;case 476:bt["!margins"]=At;break;case 147:_.Sheets[E]||(_.Sheets[E]={}),At.name&&(_.Sheets[E].CodeName=At.name),(At.above||At.left)&&(bt["!outline"]={above:At.above,left:At.left});break;case 137:_.Views||(_.Views=[{}]),_.Views[0]||(_.Views[0]={}),At.RTL&&(_.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:it=!0;break;case 36:it=!1;break;case 37:it=!0;break;case 38:it=!1;break;default:if(!gs.T&&(!it||I.WTF))throw new Error("Unexpected record 0x"+Us.toString(16))}},I),delete I.supbooks,delete I["!row"],!bt["!ref"]&&(yt.s.r<2e6||ee&&(0<ee.e.r||0<ee.e.c||0<ee.s.r||0<ee.s.c))&&(bt["!ref"]=Cs(ee||yt)),I.sheetRows&&bt["!ref"]&&(j=Fs(bt["!ref"]),I.sheetRows<=+j.e.r&&(j.e.r=I.sheetRows-1,j.e.r>yt.e.r&&(j.e.r=yt.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>yt.e.c&&(j.e.c=yt.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),bt["!fullref"]=bt["!ref"],bt["!ref"]=Cs(j))),0<Ht.length&&(bt["!merges"]=Ht),0<ns.length&&(bt["!cols"]=ns),0<Ds.length&&(bt["!rows"]=Ds),bt}:gg)(r,h,u,g,b,x,y)}function vg(r,d,u,h,g,b){return d.slice(-4)===".bin"?(function(x,y,j,k,E){if(!x)return x;k=k||{"!id":{}};var T={"!type":"chart","!drawel":null,"!rel":""},_=!1;return Ii(x,function(R,q,I){switch(I){case 550:T["!rel"]=R;break;case 651:E.Sheets[j]||(E.Sheets[j]={}),R.name&&(E.Sheets[j].CodeName=R.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:_=!0;break;case 36:_=!1;break;case 37:break;case 38:break;default:if(!(0<q.T)){if(!(q.T<0)){if(!_||y.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}}},y),k["!id"][T["!rel"]]&&(T["!drawel"]=k["!id"][T["!rel"]]),T})(r,h,u,g,b):(function(x,y,j,k){if(!x)return x;j=j||{"!id":{}};var E={"!type":"chart","!drawel":null,"!rel":""},T=x.match(Er);return T&&uu(T[0],0,k,y),(x=x.match(/drawing r:id="(.*?)"/))&&(E["!rel"]=x[1]),j["!id"][E["!rel"]]&&(E["!drawel"]=j["!id"][E["!rel"]]),E})(r,u,g,b)}function bu(r,d,u,h){return(d.slice(-4)===".bin"?function(g,b,x){var y,j={NumberFmt:[]};for(y in W)j.NumberFmt[y]=W[y];j.CellXf=[],j.Fonts=[];var k=[],E=!1;return Ii(g,function(T,_,R){switch(R){case 44:j.NumberFmt[T[0]]=T[1],xr(T[1],T[0]);break;case 43:j.Fonts.push(T),T.color.theme!=null&&b&&b.themeElements&&b.themeElements.clrScheme&&(T.color.rgb=vd(b.themeElements.clrScheme[T.color.theme].rgb,T.color.tint||0));break;case 1025:case 45:case 46:break;case 47:k[k.length-1]==617&&j.CellXf.push(T);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:E=!0;break;case 36:E=!1;break;case 37:k.push(R),E=!0;break;case 38:k.pop(),E=!1;break;default:if(0<_.T)k.push(R);else if(_.T<0)k.pop();else if(!E||x.WTF&&k[k.length-1]!=37)throw new Error("Unexpected record 0x"+R.toString(16))}}),j}:Gh)(r,u,h)}function yu(r,d,u){return d.slice(-4)===".bin"?(h=u,b=!(g=[]),Ii(r,function(x,y,j){switch(j){case 159:g.Count=x[0],g.Unique=x[1];break;case 19:g.push(x);break;case 160:return 1;case 35:b=!0;break;case 36:b=!1;break;default:if(y.T,!b||h.WTF)throw new Error("Unexpected record 0x"+j.toString(16))}}),g):(function(x,y){var j=[],k="";if(!x)return j;if(x=x.match(Ya)){k=x[2].replace(Xr,"").split(Y0);for(var E=0;E!=k.length;++E){var T=gd(k[E].trim(),y);T!=null&&(j[j.length]=T)}x=fs(x[1]),j.Count=x.count,j.Unique=x.uniqueCount}return j})(r,u);var h,g,b}function _l(r,d,u){return d.slice(-4)===".bin"?(h=u,g=[],b=[],y=!(x={}),Ii(r,function(j,k,E){switch(E){case 632:b.push(j);break;case 635:x=j;break;case 637:x.t=j.t,x.h=j.h,x.r=j.r;break;case 636:if(x.author=b[x.iauthor],delete x.iauthor,h.sheetRows&&x.rfx&&h.sheetRows<=x.rfx.r)break;x.t||(x.t=""),delete x.rfx,g.push(x);break;case 3072:break;case 35:y=!0;break;case 36:y=!1;break;case 37:case 38:break;default:if(!k.T&&(!y||h.WTF))throw new Error("Unexpected record 0x"+E.toString(16))}}),g):(function(j,k){if(j.match(/<(?:\w+:)?comments *\/>/))return[];var E=[],T=[],_=j.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);return _&&_[1]&&_[1].split(/<\/\w*:?author>/).forEach(function(R){R===""||R.trim()===""||(R=R.match(/<(?:\w+:)?author[^>]*>(.*)/))&&E.push(R[1])}),(j=j.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&j[1]&&j[1].split(/<\/\w*:?comment>/).forEach(function(R){var q,I;R===""||R.trim()===""||(q=R.match(/<(?:\w+:)?comment[^>]*>/))&&(q={author:(I=fs(q[0])).authorId&&E[I.authorId]||"sheetjsghost",ref:I.ref,guid:I.guid},I=Hr(I.ref),k.sheetRows&&k.sheetRows<=I.r||(R=!!(R=R.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!R[1]&&gd(R[1])||{r:"",t:"",h:""},q.r=R.r,R.r=="<t></t>"&&(R.t=R.h=""),q.t=(R.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),k.cellHTML&&(q.h=R.h),T.push(q)))}),T})(r,u);var h,g,b,x,y}function ua(r,d){return d.slice(-4)===".bin"?(u=[],Ii(r,function(h,g,b){if(b===63)u.push(h);else if(!g.T)throw new Error("Unexpected record 0x"+b.toString(16))}),u):(function(h){var g=[];if(!h)return g;var b=1;return(h.match(Fr)||[]).forEach(function(x){var y=fs(x);switch(y[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete y[0],y.i?b=y.i:y.i=b,g.push(y)}}),g})(r);var u}function Fl(r,d,u,h){if(u.slice(-4)===".bin")return(function(g,b){if(!g)return g;var x=b||{},y=!1;Ii(g,function(j,k,E){switch(E){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:y=!0;break;case 36:y=!1;break;default:if(!k.T&&(!y||x.WTF))throw new Error("Unexpected record 0x"+E.toString(16))}},x)})(r,h)}function jc(r,d,u){return d.slice(-4)===".bin"?(h={Types:[],Cell:[],Value:[]},g=u||{},x=!(b=[]),y=2,Ii(r,function(j,k,E){switch(E){case 335:h.Types.push({name:j.name});break;case 51:j.forEach(function(T){y==1?h.Cell.push({type:h.Types[T[0]-1].name,index:T[1]}):y==0&&h.Value.push({type:h.Types[T[0]-1].name,index:T[1]})});break;case 337:y=j?1:0;break;case 338:y=2;break;case 35:b.push(E),x=!0;break;case 36:b.pop(),x=!1;break;default:if(!k.T&&(!x||g.WTF&&b[b.length-1]!=35))throw new Error("Unexpected record 0x"+E.toString(16))}}),h):(function(j,k){var E={Types:[],Cell:[],Value:[]};if(!j)return E;var T,_=!1,R=2;return j.replace(Fr,function(q){var I=fs(q);switch(Tn(I[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":E.Types.push({name:I.name});break;case"</metadataType>":break;case"<futureMetadata":for(var ee=0;ee<E.Types.length;++ee)E.Types[ee].name==I.name&&(T=E.Types[ee]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":R==1?E.Cell.push({type:E.Types[I.t-1].name,index:+I.v}):R==0&&E.Value.push({type:E.Types[I.t-1].name,index:+I.v});break;case"</rc>":break;case"<cellMetadata":R=1;break;case"</cellMetadata>":R=2;break;case"<valueMetadata":R=0;break;case"</valueMetadata>":R=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":_=!0;break;case"</ext>":_=!1;break;case"<rvb":if(!T)break;T.offsets||(T.offsets=[]),T.offsets.push(+I.i);break;default:if(!_&&k.WTF)throw new Error("unrecognized "+I[0]+" in metadata")}return q}),E})(r,u);var h,g,b,x,y}var An,vu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Bn(r,d){var u=r.split(/\s+/),h=[];if(h[0]=u[0],u.length===1)return h;var g,b,x,y=r.match(vu);if(y)for(x=0;x!=y.length;++x)(b=(g=y[x].match(wu))[1].indexOf(":"))===-1?h[g[1]]=g[2].slice(1,g[2].length-1):h[g[1].slice(0,6)==="xmlns:"?"xmlns"+g[1].slice(6):g[1].slice(b+1)]=g[2].slice(1,g[2].length-1);return h}function Od(r,d,u){if(r.t!=="z"){if(!u||u.cellText!==!1)try{r.t==="e"?r.w=r.w||Xn[r.v]:d==="General"?r.t==="n"?(0|r.v)===r.v?r.w=r.v.toString(10):r.w=Qe(r.v):r.w=Ve(r.v):r.w=(h=d||"General",g=r.v,(h=An[h]||ws(h))==="General"?Ve(g):Ir(h,g))}catch(x){if(u.WTF)throw x}var h,g;try{var b=An[d]||d||"General";u.cellNF&&(r.z=b),u.cellDates&&r.t=="n"&&$r(b)&&(b=Q(r.v))&&(r.t="d",r.v=new Date(b.y,b.m-1,b.d,b.H,b.M,b.S,b.u))}catch(x){if(u.WTF)throw x}}}function Pd(r,d){var u=d||{};Hl();var h,g=O(js(r)),b=(g=u.type=="binary"||u.type=="array"||u.type=="base64"?e!==void 0?e.utils.decode(65001,M(g)):Oe(g):g).slice(0,1024).toLowerCase(),x=!1;if((1023&(b=b.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&b.indexOf(","),1023&b.indexOf(";"))){var y=vs(u);return y.type="string",Gi.to_workbook(g,y)}if(b.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ae){0<=b.indexOf("<"+Ae)&&(x=!0)}),x)return(function(Ae,kt){if(Ae=Ae.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi),!Ae||Ae.length==0)throw new Error("Invalid HTML: could not find <table>");if(Ae.length==1)return Kn(Ud(Ae[0],kt),kt);var Ze=If();return Ae.forEach(function(dt,Ge){Uu(Ze,Ud(dt,kt),"Sheet"+(Ge+1))}),Ze})(g,u);An={"General Number":"General","General Date":W[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":W[15],"Short Date":W[14],"Long Time":W[19],"Medium Time":W[18],"Short Time":W[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:W[2],Standard:W[4],Percent:W[10],Scientific:W[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var j,k=[],E,T={},_=[],R=u.dense?[]:{},q="",I={},ee={},Y=Bn('<Data ss:Type="String">'),z=0,Z=0,ae=0,ie={s:{r:2e6,c:2e6},e:{r:0,c:0}},Ee={},We={},Ie="",Je=0,bt=[],yt={},it={},St=0,Ht=[],zt=[],Lt={},Ot=[],Tt=!1,jt=[],qt=[],Xt={},ns=0,Ds=0,Vt={Sheets:[],WBProps:{date1904:!1}},At={};cr.lastIndex=0,g=g.replace(/<!--([\s\S]*?)-->/gm,"");for(var gs,Us,Os,Zs,Pr="";h=cr.exec(g);)switch(h[3]=(Pr=h[3]).toLowerCase()){case"data":if(Pr=="data"){if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break}if(k[k.length-1][1])break;h[1]==="/"?(function(Ae,kt,Ze,dt,Ge,mt,Et,Kt,Yt,Bt){var Qt="General",ss=dt.StyleID,ts={};Bt=Bt||{};var Pt=[],Dt=0;for((ss=ss===void 0&&Kt?Kt.StyleID:ss)===void 0&&Et&&(ss=Et.StyleID);mt[ss]!==void 0&&(mt[ss].nf&&(Qt=mt[ss].nf),mt[ss].Interior&&Pt.push(mt[ss].Interior),mt[ss].Parent);)ss=mt[ss].Parent;switch(Ze.Type){case"Boolean":dt.t="b",dt.v=or(Ae);break;case"String":dt.t="s",dt.r=Xc(ws(Ae)),dt.v=-1<Ae.indexOf("<")?ws(kt||Ae).replace(/<.*?>/g,""):dt.r;break;case"DateTime":Ae.slice(-1)!="Z"&&(Ae+="Z"),dt.v=(_s(Ae)-new Date(Date.UTC(1899,11,30)))/864e5,dt.v!=dt.v?dt.v=ws(Ae):dt.v<60&&(dt.v=dt.v-1),Qt&&Qt!="General"||(Qt="yyyy-mm-dd");case"Number":dt.v===void 0&&(dt.v=+Ae),dt.t||(dt.t="n");break;case"Error":dt.t="e",dt.v=Ln[Ae],Bt.cellText!==!1&&(dt.w=Ae);break;default:Ae==""&&kt==""?dt.t="z":(dt.t="s",dt.v=Xc(kt||Ae))}if(Od(dt,Qt,Bt),Bt.cellFormula!==!1)if(dt.Formula)Ze=ws(dt.Formula),Ze.charCodeAt(0)==61&&(Ze=Ze.slice(1)),dt.f=xo(Ze,Ge),delete dt.Formula,dt.ArrayRange=="RC"?dt.F=xo("RC:RC",Ge):dt.ArrayRange&&(dt.F=xo(dt.ArrayRange,Ge),Yt.push([Fs(dt.F),dt.F]));else for(Dt=0;Dt<Yt.length;++Dt)Ge.r>=Yt[Dt][0].s.r&&Ge.r<=Yt[Dt][0].e.r&&Ge.c>=Yt[Dt][0].s.c&&Ge.c<=Yt[Dt][0].e.c&&(dt.F=Yt[Dt][1]);Bt.cellStyles&&(Pt.forEach(function(rs){!ts.patternType&&rs.patternType&&(ts.patternType=rs.patternType)}),dt.s=ts),dt.StyleID!==void 0&&(dt.ixfe=dt.StyleID)})(g.slice(z,h.index),Ie,Y,k[k.length-1][0]=="comment"?Lt:I,{c:Z,r:ae},Ee,Ot[Z],ee,jt,u):(Ie="",Y=Bn(h[0]),z=h.index+h[0].length);break;case"cell":if(h[1]==="/")if(0<zt.length&&(I.c=zt),(!u.sheetRows||u.sheetRows>ae)&&I.v!==void 0&&(u.dense?(R[ae]||(R[ae]=[]),R[ae][Z]=I):R[Ar(Z)+Ur(ae)]=I),I.HRef&&(I.l={Target:ws(I.HRef)},I.HRefScreenTip&&(I.l.Tooltip=I.HRefScreenTip),delete I.HRef,delete I.HRefScreenTip),(I.MergeAcross||I.MergeDown)&&(ns=Z+(0|parseInt(I.MergeAcross,10)),Ds=ae+(0|parseInt(I.MergeDown,10)),bt.push({s:{c:Z,r:ae},e:{c:ns,r:Ds}})),u.sheetStubs)if(I.MergeAcross||I.MergeDown){for(var Me=Z;Me<=ns;++Me)for(var er=ae;er<=Ds;++er)(Z<Me||ae<er)&&(u.dense?(R[er]||(R[er]=[]),R[er][Me]={t:"z"}):R[Ar(Me)+Ur(er)]={t:"z"});Z=ns+1}else++Z;else I.MergeAcross?Z=ns+1:++Z;else(Z=(I=(function(Ae){var kt={};if(Ae.split(/\s+/).length===1)return kt;var Ze,dt,Ge,mt=Ae.match(vu);if(mt)for(Ge=0;Ge!=mt.length;++Ge)(dt=(Ze=mt[Ge].match(wu))[1].indexOf(":"))===-1?kt[Ze[1]]=Ze[2].slice(1,Ze[2].length-1):kt[Ze[1].slice(0,6)==="xmlns:"?"xmlns"+Ze[1].slice(6):Ze[1].slice(dt+1)]=Ze[2].slice(1,Ze[2].length-1);return kt})(h[0])).Index?+I.Index-1:Z)<ie.s.c&&(ie.s.c=Z),Z>ie.e.c&&(ie.e.c=Z),h[0].slice(-2)==="/>"&&++Z,zt=[];break;case"row":h[1]==="/"||h[0].slice(-2)==="/>"?(ae<ie.s.r&&(ie.s.r=ae),ae>ie.e.r&&(ie.e.r=ae),h[0].slice(-2)==="/>"&&(ee=Bn(h[0])).Index&&(ae=+ee.Index-1),Z=0,++ae):((ee=Bn(h[0])).Index&&(ae=+ee.Index-1),Xt={},ee.AutoFitHeight!="0"&&!ee.Height||(Xt.hpx=parseInt(ee.Height,10),Xt.hpt=cc(Xt.hpx),qt[ae]=Xt),ee.Hidden=="1"&&(Xt.hidden=!0,qt[ae]=Xt));break;case"worksheet":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"));_.push(q),ie.s.r<=ie.e.r&&ie.s.c<=ie.e.c&&(R["!ref"]=Cs(ie),u.sheetRows&&u.sheetRows<=ie.e.r&&(R["!fullref"]=R["!ref"],ie.e.r=u.sheetRows-1,R["!ref"]=Cs(ie))),bt.length&&(R["!merges"]=bt),0<Ot.length&&(R["!cols"]=Ot),0<qt.length&&(R["!rows"]=qt),T[q]=R}else ie={s:{r:2e6,c:2e6},e:{r:0,c:0}},ae=Z=0,k.push([h[3],!1]),j=Bn(h[0]),q=ws(j.Name),R=u.dense?[]:{},bt=[],jt=[],qt=[],At={name:q,Hidden:0},Vt.Sheets.push(At);break;case"table":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else{if(h[0].slice(-2)=="/>")break;k.push([h[3],!1]),Tt=!(Ot=[])}break;case"style":h[1]==="/"?(Us=Ee,Os=We,(Zs=u).cellStyles&&(!Os.Interior||(Zs=Os.Interior).Pattern&&(Zs.patternType=$m[Zs.Pattern]||Zs.Pattern)),Us[Os.ID]=Os):We=Bn(h[0]);break;case"numberformat":We.nf=ws(Bn(h[0]).Format||"General"),An[We.nf]&&(We.nf=An[We.nf]);for(var $s=0;$s!=392&&W[$s]!=We.nf;++$s);if($s==392){for($s=57;$s!=392;++$s)if(W[$s]==null){xr(We.nf,$s);break}}break;case"column":if(k[k.length-1][0]!=="table")break;if((E=Bn(h[0])).Hidden&&(E.hidden=!0,delete E.Hidden),E.Width&&(E.wpx=parseInt(E.Width,10)),!Tt&&10<E.wpx){Tt=!0,Jr=Hh;for(var ha=0;ha<Ot.length;++ha)Ot[ha]&&Cl(Ot[ha])}Tt&&Cl(E),Ot[E.Index-1||Ot.length]=E;for(var Un=0;Un<+E.Span;++Un)Ot[Ot.length]=vs(E);break;case"namedrange":if(h[1]==="/")break;Vt.Names||(Vt.Names=[]);var he=fs(h[0]),ot={Name:he.Name,Ref:xo(he.RefersTo.slice(1),{r:0,c:0})};0<Vt.Sheets.length&&(ot.Sheet=Vt.Sheets.length-1),Vt.Names.push(ot);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":if(h[0].slice(-2)==="/>")break;h[1]==="/"?Ie+=g.slice(Je,h.index):Je=h.index+h[0].length;break;case"interior":if(!u.cellStyles)break;We.Interior=Bn(h[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(h[0].slice(-2)==="/>")break;h[1]==="/"?(Os=yt,he=Pr,ot=g.slice(St,h.index),Os[he=(ro=ro||Mi(bl))[he]||he]=ot):St=h.index+h[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else k.push([h[3],!1]);break;case"comment":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"));(gs=Lt).t=gs.v||"",gs.t=gs.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),gs.v=gs.w=gs.ixfe=void 0,zt.push(Lt)}else k.push([h[3],!1]),Lt={a:(j=Bn(h[0])).Author};break;case"autofilter":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&(gs=Bn(h[0]),R["!autofilter"]={ref:xo(gs.Range).replace(/\$/g,"")},k.push([h[3],!0]));break;case"name":break;case"datavalidation":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break;case"null":break;default:if(k.length==0&&h[3]=="document"||k.length==0&&h[3]=="uof")return Su(g,u);var Te=!0;switch(k[k.length-1][0]){case"officedocumentsettings":switch(h[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(h[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(h[3]){case"date1904":Vt.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(h[3]){case"owcversion":case"height":case"width":break;default:Te=!1}break;case"worksheetoptions":switch(h[3]){case"visible":if(h[0].slice(-2)!=="/>")if(h[1]==="/")switch(g.slice(St,h.index)){case"SheetHidden":At.Hidden=1;break;case"SheetVeryHidden":At.Hidden=2}else St=h.index+h[0].length;break;case"header":R["!margins"]||Ci(R["!margins"]={},"xlml"),isNaN(+fs(h[0]).Margin)||(R["!margins"].header=+fs(h[0]).Margin);break;case"footer":R["!margins"]||Ci(R["!margins"]={},"xlml"),isNaN(+fs(h[0]).Margin)||(R["!margins"].footer=+fs(h[0]).Margin);break;case"pagemargins":var at=fs(h[0]);R["!margins"]||Ci(R["!margins"]={},"xlml"),isNaN(+at.Top)||(R["!margins"].top=+at.Top),isNaN(+at.Left)||(R["!margins"].left=+at.Left),isNaN(+at.Right)||(R["!margins"].right=+at.Right),isNaN(+at.Bottom)||(R["!margins"].bottom=+at.Bottom);break;case"displayrighttoleft":Vt.Views||(Vt.Views=[]),Vt.Views[0]||(Vt.Views[0]={}),Vt.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":break;case"nosummaryrowsbelowdetail":R["!outline"]||(R["!outline"]={}),R["!outline"].above=!0;break;case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":R["!outline"]||(R["!outline"]={}),R["!outline"].left=!0;break;case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(h[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(h[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Te=!1}break;case"autofilter":switch(h[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Te=!1}break;case"querytable":switch(h[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(h[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(h[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(h[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1}if(Te||h[3].match(/!\[CDATA/))break;if(!k[k.length-1][1])throw"Unrecognized tag: "+h[3]+"|"+k.join("|");if(k[k.length-1][0]==="customdocumentproperties"){if(h[0].slice(-2)==="/>")break;h[1]==="/"?(function(Ae,kt,Ze,dt){var Ge=dt;switch((Ze[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":Ge=or(dt);break;case"i2":case"int":Ge=parseInt(dt,10);break;case"r4":case"float":Ge=parseFloat(dt);break;case"date":case"dateTime.tz":Ge=_s(dt);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+Ze[0])}Ae[ws(kt)]=Ge})(it,Pr,Ht,g.slice(St,h.index)):St=(Ht=h).index+h[0].length;break}if(u.WTF)throw"Unrecognized tag: "+h[3]+"|"+k.join("|")}return y={},u.bookSheets||u.bookProps||(y.Sheets=T),y.SheetNames=_,y.Workbook=Vt,y.SSF=vs(W),y.Props=yt,y.Custprops=it,y}function Qa(r,d){switch(Df(d=d||{}),d.type||"base64"){case"base64":return Pd(Ce(r),d);case"binary":case"buffer":case"file":return Pd(r,d);case"array":return Pd(me(r),d)}}function wg(r,d){var u,h,g,b,x,y,j,k=[];return r.Props&&k.push((u=r.Props,h=d,g=[],is(bl).map(function(E){for(var T=0;T<Mr.length;++T)if(Mr[T][1]==E)return Mr[T];for(T=0;T<bn.length;++T)if(bn[T][1]==E)return bn[T];throw E}).forEach(function(E){var T;u[E[1]]!=null&&(T=(h&&h.Props&&h.Props[E[1]]!=null?h.Props:u)[E[1]],typeof(T=E[2]==="date"?new Date(T).toISOString().replace(/\.\d*Z/,"Z"):T)=="number"?T=String(T):T===!0||T===!1?T=T?"1":"0":T instanceof Date&&(T=new Date(T).toISOString().replace(/\.\d*Z/,"")),g.push(Ct(bl[E[1]]||E[1],T)))}),Le("DocumentProperties",g.join(""),{xmlns:tr.o}))),r.Custprops&&k.push((b=r.Props,x=r.Custprops,y=["Worksheets","SheetNames"],r="CustomDocumentProperties",j=[],b&&is(b).forEach(function(E){if(Object.prototype.hasOwnProperty.call(b,E)){for(var T=0;T<Mr.length;++T)if(E==Mr[T][1])return;for(T=0;T<bn.length;++T)if(E==bn[T][1])return;for(T=0;T<y.length;++T)if(E==y[T])return;var _="string",R=typeof(R=b[E])=="number"?(_="float",String(R)):R===!0||R===!1?(_="boolean",R?"1":"0"):String(R);j.push(Le(Va(E),R,{"dt:dt":_}))}}),x&&is(x).forEach(function(E){var T,_;Object.prototype.hasOwnProperty.call(x,E)&&(b&&Object.prototype.hasOwnProperty.call(b,E)||(T="string",_=typeof(_=x[E])=="number"?(T="float",String(_)):_===!0||_===!1?(T="boolean",_?"1":"0"):_ instanceof Date?(T="dateTime.tz",_.toISOString()):String(_),j.push(Le(Va(E),_,{"dt:dt":T}))))}),"<"+r+' xmlns="'+tr.o+'">'+j.join("")+"</"+r+">")),k.join("")}function Xa(r){return Le("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+nu(r.Ref,{r:0,c:0})})}function jg(r,d,u,h,g,b,x){if(!r||r.v==null&&r.f==null)return"";var y={};if(r.f&&(y["ss:Formula"]="="+Ys(nu(r.f,x))),r.F&&r.F.slice(0,d.length)==d&&(d=Hr(r.F.slice(d.length+1)),y["ss:ArrayRange"]="RC:R"+(d.r==x.r?"":"["+(d.r-x.r)+"]")+"C"+(d.c==x.c?"":"["+(d.c-x.c)+"]")),r.l&&r.l.Target&&(y["ss:HRef"]=Ys(r.l.Target),r.l.Tooltip&&(y["x:HRefScreenTip"]=Ys(r.l.Tooltip))),u["!merges"])for(var j=u["!merges"],k=0;k!=j.length;++k)j[k].s.c==x.c&&j[k].s.r==x.r&&(j[k].e.c>j[k].s.c&&(y["ss:MergeAcross"]=j[k].e.c-j[k].s.c),j[k].e.r>j[k].s.r&&(y["ss:MergeDown"]=j[k].e.r-j[k].s.r));var E="",T="";switch(r.t){case"z":if(!h.sheetStubs)return"";break;case"n":E="Number",T=String(r.v);break;case"b":E="Boolean",T=r.v?"1":"0";break;case"e":E="Error",T=Xn[r.v];break;case"d":E="DateTime",T=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||W[14]);break;case"s":E="String",T=((r.v||"")+"").replace(Ra,function(_){return Kc[_]}).replace(Yl,function(_){return"&#x"+_.charCodeAt(0).toString(16).toUpperCase()+";"})}return u=Ji(h.cellXfs,r,h),y["ss:StyleID"]="s"+(21+u),y["ss:Index"]=x.c+1,u=r.v!=null?T:"",u=r.t=="z"?"":'<Data ss:Type="'+E+'">'+u+"</Data>",0<(r.c||[]).length&&(u+=r.c.map(function(_){var R=Le("ss:Data",(_.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Le("Comment",R,{"ss:Author":_.a})}).join("")),Le("Cell",u,y)}function Ng(r,d){if(!r["!ref"])return"";var u=Fs(r["!ref"]),h=r["!merges"]||[],g=0,b=[];r["!cols"]&&r["!cols"].forEach(function(ee,ae){Cl(ee);var z=!!ee.width,Z=xc(ae,ee),ae={"ss:Index":ae+1};z&&(ae["ss:Width"]=oc(Z.width)),ee.hidden&&(ae["ss:Hidden"]="1"),b.push(Le("Column",null,ae))});for(var x,y,j=Array.isArray(r),k=u.s.r;k<=u.e.r;++k){for(var E=[(x=k,y=(r["!rows"]||[])[k],x='<Row ss:Index="'+(x+1)+'"',y&&(y.hpt&&!y.hpx&&(y.hpx=po(y.hpt)),y.hpx&&(x+=' ss:AutoFitHeight="0" ss:Height="'+y.hpx+'"'),y.hidden&&(x+=' ss:Hidden="1"')),x+">")],T=u.s.c;T<=u.e.c;++T){for(var _,R,q,I=!1,g=0;g!=h.length;++g)if(!(h[g].s.c>T||h[g].s.r>k||h[g].e.c<T||h[g].e.r<k)){h[g].s.c==T&&h[g].s.r==k||(I=!0);break}I||(R=bs(_={r:k,c:T}),q=j?(r[k]||[])[T]:r[R],E.push(jg(q,R,r,d,0,0,_)))}E.push("</Row>"),2<E.length&&b.push(E.join(""))}return b.join("")}function e1(r,d,u){var h=[],b=u.SheetNames[r],g=u.Sheets[b],b=g?(function(x,y,j){if(!x||!((j||{}).Workbook||{}).Names)return"";for(var k=j.Workbook.Names,E=[],T=0;T<k.length;++T){var _=k[T];_.Sheet==y&&(_.Name.match(/^_xlfn\./)||E.push(Xa(_)))}return E.join("")})(g,r,u):"";return 0<b.length&&h.push("<Names>"+b+"</Names>"),0<(b=g?Ng(g,d):"").length&&h.push("<Table>"+b+"</Table>"),h.push((function(x,y,j){if(!x)return"";var k=[];if(x["!margins"]&&(k.push("<PageSetup>"),x["!margins"].header&&k.push(Le("Header",null,{"x:Margin":x["!margins"].header})),x["!margins"].footer&&k.push(Le("Footer",null,{"x:Margin":x["!margins"].footer})),k.push(Le("PageMargins",null,{"x:Bottom":x["!margins"].bottom||"0.75","x:Left":x["!margins"].left||"0.7","x:Right":x["!margins"].right||"0.7","x:Top":x["!margins"].top||"0.75"})),k.push("</PageSetup>")),j&&j.Workbook&&j.Workbook.Sheets&&j.Workbook.Sheets[y])if(j.Workbook.Sheets[y].Hidden)k.push(Le("Visible",j.Workbook.Sheets[y].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var E=0;E<y&&(!j.Workbook.Sheets[E]||j.Workbook.Sheets[E].Hidden);++E);E==y&&k.push("<Selected/>")}return((((j||{}).Workbook||{}).Views||[])[0]||{}).RTL&&k.push("<DisplayRightToLeft/>"),x["!protect"]&&(k.push(Ct("ProtectContents","True")),x["!protect"].objects&&k.push(Ct("ProtectObjects","True")),x["!protect"].scenarios&&k.push(Ct("ProtectScenarios","True")),x["!protect"].selectLockedCells==null||x["!protect"].selectLockedCells?x["!protect"].selectUnlockedCells==null||x["!protect"].selectUnlockedCells||k.push(Ct("EnableSelection","UnlockedCells")):k.push(Ct("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(T){x["!protect"][T[0]]&&k.push("<"+T[1]+"/>")})),k.length==0?"":Le("WorksheetOptions",k.join(""),{xmlns:tr.x})})(g,r,u)),h.join("")}function Ml(r,d){d=d||{},r.SSF||(r.SSF=vs(W)),r.SSF&&(Hl(),Io(r.SSF),d.revssf=ql(r.SSF),d.revssf[r.SSF[65535]]=0,d.ssf=r.SSF,d.cellXfs=[],Ji(d.cellXfs,{},{revssf:{General:0}}));var u=[];u.push(wg(r,d)),u.push(""),u.push(""),u.push("");for(var h,g=0;g<r.SheetNames.length;++g)u.push(Le("Worksheet",e1(g,d,r),{"ss:Name":Ys(r.SheetNames[g])}));return u[2]=(h=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],d.cellXfs.forEach(function(b,x){var y=[];y.push(Le("NumberFormat",null,{"ss:Format":Ys(W[b.numFmtId])})),x={"ss:ID":"s"+(21+x)},h.push(Le("Style",y.join(""),x))}),Le("Styles",h.join(""))),u[3]=(function(b){if(!((b||{}).Workbook||{}).Names)return"";for(var x=b.Workbook.Names,y=[],j=0;j<x.length;++j){var k=x[j];k.Sheet==null&&(k.Name.match(/^_xlfn\./)||y.push(Xa(k)))}return Le("Names",y.join(""))})(r),hr+Le("Workbook",u.join(""),{xmlns:tr.ss,"xmlns:o":tr.o,"xmlns:x":tr.x,"xmlns:ss":tr.ss,"xmlns:dt":tr.dt,"xmlns:html":tr.html})}function ju(r){var d={},u=r.content;return u.l=28,d.AnsiUserType=u.read_shift(0,"lpstr-ansi"),d.AnsiClipboardFormat=N0(u,1),u.length-u.l<=4?d:(r=u.read_shift(4),r==0||40<r?d:(u.l-=4,d.Reserved1=u.read_shift(0,"lpstr-ansi"),u.length-u.l<=4||(r=u.read_shift(4))!==1907505652?d:(d.UnicodeClipboardFormat=N0(u,2),(r=u.read_shift(4))==0||40<r?d:(u.l-=4,void(d.Reserved2=u.read_shift(0,"lpwstr"))))))}var vf=[60,1084,2066,2165,2175];function Ja(r,d,u){if(r.t!=="z"&&r.XF){var h,g=0;try{g=r.z||r.XF.numFmtId||0,d.cellNF&&(r.z=W[g])}catch(b){if(d.WTF)throw b}if(!d||d.cellText!==!1)try{r.t==="e"?r.w=r.w||Xn[r.v]:g===0||g=="General"?r.t==="n"?(0|r.v)===r.v?r.w=r.v.toString(10):r.w=Qe(r.v):r.w=Ve(r.v):r.w=Ir(g,r.v,{date1904:!!u,dateNF:d&&d.dateNF})}catch(b){if(d.WTF)throw b}d.cellDates&&g&&r.t=="n"&&$r(W[g]||String(g))&&(h=Q(r.v))&&(r.t="d",r.v=new Date(h.y,h.m-1,h.d,h.H,h.M,h.S,h.u))}}function Id(r,d,u){return{v:r,ixfe:d,t:u}}function kg(r,d){var u={opts:{}},h={};function g(Ge){return!(Ge<8)&&Ge<64&&Ee[Ge-8]||Ko[Ge]}function b(Ge,mt,Et){if(!(1<Tt||Et.sheetRows&&Ge.r>=Et.sheetRows)){var Kt,Yt,Bt;if(Et.cellStyles&&mt.XF&&mt.XF.data&&(Yt=Et,(Bt=(Kt=mt).XF.data)&&Bt.patternType&&Yt&&Yt.cellStyles&&(Kt.s={},Kt.s.patternType=Bt.patternType,(Yt=lc(g(Bt.icvFore)))&&(Kt.s.fgColor={rgb:Yt}),(Yt=lc(g(Bt.icvBack)))&&(Kt.s.bgColor={rgb:Yt}))),delete mt.ixfe,delete mt.XF,z=bs(x=Ge),R&&R.s&&R.e||(R={s:{r:0,c:0},e:{r:0,c:0}}),Ge.r<R.s.r&&(R.s.r=Ge.r),Ge.c<R.s.c&&(R.s.c=Ge.c),Ge.r+1>R.e.r&&(R.e.r=Ge.r+1),Ge.c+1>R.e.c&&(R.e.c=Ge.c+1),Et.cellFormula&&mt.f){for(var Qt=0;Qt<ae.length;++Qt)if(!(ae[Qt][0].s.c>Ge.c||ae[Qt][0].s.r>Ge.r||ae[Qt][0].e.c<Ge.c||ae[Qt][0].e.r<Ge.r)){mt.F=Cs(ae[Qt][0]),ae[Qt][0].s.c==Ge.c&&ae[Qt][0].s.r==Ge.r||delete mt.f,mt.f&&(mt.f=""+za(ae[Qt][1],0,Ge,zt,Je));break}}Et.dense?(T[Ge.r]||(T[Ge.r]=[]),T[Ge.r][Ge.c]=mt):T[z]=mt}}var x,y,j,k,E,T=d.dense?[]:{},_={},R={},q=null,I=[],ee="",Y={},z="",Z={},ae=[],ie=[],Ee=[],We={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Ie={},Je={enc:!1,sbcch:0,snames:[],sharedf:Z,arrayf:ae,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!d&&!!d.cellStyles,WTF:!!d&&!!d.wtf};d.password&&(Je.password=d.password);var bt=[],yt=[],it=[],St=[],Ht=!1,zt=[];zt.SheetNames=Je.snames,zt.sharedf=Je.sharedf,zt.arrayf=Je.arrayf,zt.names=[],zt.XTI=[];var Lt,Ot=0,Tt=0,jt=0,qt=[],Xt=[];Je.codepage=1200,D(1200);for(var ns=!1;r.l<r.length-1;){var Ds=r.l,Vt=r.read_shift(2);if(Vt===0&&Ot===10)break;var At=r.l===r.length?0:r.read_shift(2),gs=wf[Vt];if(gs&&gs.f){if(d.bookSheets&&Ot===133&&Vt!==133)break;if(Ot=Vt,gs.r===2||gs.r==12){var Us=r.read_shift(2);if(At-=2,!Je.enc&&Us!==Vt&&((255&Us)<<8|Us>>8)!==Vt)throw new Error("rt mismatch: "+Us+"!="+Vt);gs.r==12&&(r.l+=10,At-=10)}var Os,Zs,Pr,Me={},Me=Vt===10?gs.f(r,At,Je):(function(Ge,mt,Et,Kt,Yt){var Bt=Kt,Qt=[],ss=Et.slice(Et.l,Et.l+Bt);if(Yt&&Yt.enc&&Yt.enc.insitu&&0<ss.length)switch(Ge){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:Yt.enc.insitu(ss)}Qt.push(ss),Et.l+=Bt;for(var ts=Pi(Et,Et.l),Pt=wf[ts],Dt=0;Pt!=null&&-1<vf.indexOf(ts);)Bt=Pi(Et,Et.l+2),Dt=Et.l+4,ts==2066?Dt+=4:ts!=2165&&ts!=2175||(Dt+=12),ss=Et.slice(Dt,Et.l+4+Bt),Qt.push(ss),Et.l+=4+Bt,Pt=wf[ts=Pi(Et,Et.l)];var rs=ce(Qt);Sa(rs,0);var Wt=0;rs.lens=[];for(var _t=0;_t<Qt.length;++_t)rs.lens.push(Wt),Wt+=Qt[_t].length;if(rs.length<Kt)throw"XLS Record 0x"+Ge.toString(16)+" Truncated: "+rs.length+" < "+Kt;return mt.f(rs,rs.length,Yt)})(Vt,gs,r,At,Je);if(Tt!=0||[9,521,1033,2057].indexOf(Ot)!==-1)switch(Vt){case 34:u.opts.Date1904=We.WBProps.date1904=Me;break;case 134:u.opts.WriteProtect=!0;break;case 47:if(Je.enc||(r.l=0),Je.enc=Me,!d.password)throw new Error("File is password-protected");if(Me.valid==null)throw new Error("Encryption scheme unsupported");if(!Me.valid)throw new Error("Password is incorrect");break;case 92:Je.lastuser=Me;break;case 66:var er=Number(Me);switch(er){case 21010:er=1200;break;case 32768:er=1e4;break;case 32769:er=1252}D(Je.codepage=er),ns=!0;break;case 317:Je.rrtabid=Me;break;case 25:Je.winlocked=Me;break;case 439:u.opts.RefreshAll=Me;break;case 12:u.opts.CalcCount=Me;break;case 16:u.opts.CalcDelta=Me;break;case 17:u.opts.CalcIter=Me;break;case 13:u.opts.CalcMode=Me;break;case 14:u.opts.CalcPrecision=Me;break;case 95:u.opts.CalcSaveRecalc=Me;break;case 15:Je.CalcRefMode=Me;break;case 2211:u.opts.FullCalc=Me;break;case 129:Me.fDialog&&(T["!type"]="dialog"),Me.fBelow||((T["!outline"]||(T["!outline"]={})).above=!0),Me.fRight||((T["!outline"]||(T["!outline"]={})).left=!0);break;case 224:ie.push(Me);break;case 430:zt.push([Me]),zt[zt.length-1].XTI=[];break;case 35:case 547:zt[zt.length-1].push(Me);break;case 24:case 536:Lt={Name:Me.Name,Ref:za(Me.rgce,0,null,zt,Je)},0<Me.itab&&(Lt.Sheet=Me.itab-1),zt.names.push(Lt),zt[0]||(zt[0]=[],zt[0].XTI=[]),zt[zt.length-1].push(Me),Me.Name=="_xlnm._FilterDatabase"&&0<Me.itab&&Me.rgce&&Me.rgce[0]&&Me.rgce[0][0]&&Me.rgce[0][0][0]=="PtgArea3d"&&(Xt[Me.itab-1]={ref:Cs(Me.rgce[0][0][1][2])});break;case 22:Je.ExternCount=Me;break;case 23:zt.length==0&&(zt[0]=[],zt[0].XTI=[]),zt[zt.length-1].XTI=zt[zt.length-1].XTI.concat(Me),zt.XTI=zt.XTI.concat(Me);break;case 2196:if(Je.biff<8)break;Lt!=null&&(Lt.Comment=Me[1]);break;case 18:T["!protect"]=Me;break;case 19:Me!==0&&Je.WTF&&console.error("Password verifier: "+Me);break;case 133:_[Me.pos]=Me,Je.snames.push(Me.name);break;case 10:if(--Tt)break;R.e&&(0<R.e.r&&0<R.e.c&&(R.e.r--,R.e.c--,T["!ref"]=Cs(R),d.sheetRows&&d.sheetRows<=R.e.r&&($s=R.e.r,R.e.r=d.sheetRows-1,T["!fullref"]=T["!ref"],T["!ref"]=Cs(R),R.e.r=$s),R.e.r++,R.e.c++),0<bt.length&&(T["!merges"]=bt),0<yt.length&&(T["!objects"]=yt),0<it.length&&(T["!cols"]=it),0<St.length&&(T["!rows"]=St),We.Sheets.push(Ie)),ee===""?Y=T:h[ee]=T,T=d.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(Je.biff===8&&(Je.biff={9:2,521:3,1033:4}[Vt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Me.BIFFVer]||8),Je.biffguess=Me.BIFFVer==0,Me.BIFFVer==0&&Me.dt==4096&&(Je.biff=5,ns=!0,D(Je.codepage=28591)),Je.biff==8&&Me.BIFFVer==0&&Me.dt==16&&(Je.biff=2),Tt++)break;var $s,T=d.dense?[]:{};Je.biff<8&&!ns&&(ns=!0,D(Je.codepage=d.codepage||1252)),Je.biff<5||Me.BIFFVer==0&&Me.dt==4096?(ee===""&&(ee="Sheet1"),R={s:{r:0,c:0},e:{r:0,c:0}},$s={pos:r.l-At,name:ee},_[$s.pos]=$s,Je.snames.push(ee)):ee=(_[Ds]||{name:""}).name,Me.dt==32&&(T["!type"]="chart"),Me.dt==64&&(T["!type"]="macro"),bt=[],yt=[],Je.arrayf=ae=[],it=[],Ht=!(St=[]),Ie={Hidden:(_[Ds]||{hs:0}).hs,name:ee};break;case 515:case 3:case 2:T["!type"]=="chart"&&(d.dense?(T[Me.r]||[])[Me.c]:T[bs({c:Me.c,r:Me.r})])&&++Me.c,he={ixfe:Me.ixfe,XF:ie[Me.ixfe]||{},v:Me.val,t:"n"},0<jt&&(he.z=qt[he.ixfe>>8&63]),Ja(he,d,u.opts.Date1904),b({c:Me.c,r:Me.r},he,d);break;case 5:case 517:he={ixfe:Me.ixfe,XF:ie[Me.ixfe],v:Me.val,t:Me.t},0<jt&&(he.z=qt[he.ixfe>>8&63]),Ja(he,d,u.opts.Date1904),b({c:Me.c,r:Me.r},he,d);break;case 638:he={ixfe:Me.ixfe,XF:ie[Me.ixfe],v:Me.rknum,t:"n"},0<jt&&(he.z=qt[he.ixfe>>8&63]),Ja(he,d,u.opts.Date1904),b({c:Me.c,r:Me.r},he,d);break;case 189:for(var ha=Me.c;ha<=Me.C;++ha){var Un=Me.rkrec[ha-Me.c][0],he={ixfe:Un,XF:ie[Un],v:Me.rkrec[ha-Me.c][1],t:"n"};0<jt&&(he.z=qt[he.ixfe>>8&63]),Ja(he,d,u.opts.Date1904),b({c:ha,r:Me.r},he,d)}break;case 6:case 518:case 1030:if(Me.val=="String"){q=Me;break}(he=Id(Me.val,Me.cell.ixfe,Me.tt)).XF=ie[he.ixfe],d.cellFormula&&(!((ot=Me.formula)&&ot[0]&&ot[0][0]&&ot[0][0][0]=="PtgExp")||Z[Pr=bs({r:Os=ot[0][0][1][0],c:Zs=ot[0][0][1][1]})]?he.f=""+za(Me.formula,0,Me.cell,zt,Je):he.F=((d.dense?(T[Os]||[])[Zs]:T[Pr])||{}).F),0<jt&&(he.z=qt[he.ixfe>>8&63]),Ja(he,d,u.opts.Date1904),b(Me.cell,he,d),q=Me;break;case 7:case 519:if(!q)throw new Error("String record expects Formula");(he=Id(q.val=Me,q.cell.ixfe,"s")).XF=ie[he.ixfe],d.cellFormula&&(he.f=""+za(q.formula,0,q.cell,zt,Je)),0<jt&&(he.z=qt[he.ixfe>>8&63]),Ja(he,d,u.opts.Date1904),b(q.cell,he,d),q=null;break;case 33:case 545:ae.push(Me);var ot=bs(Me[0].s),Te=d.dense?(T[Me[0].s.r]||[])[Me[0].s.c]:T[ot];if(d.cellFormula&&Te){if(!q||!ot||!Te)break;Te.f=""+za(Me[1],0,Me[0],zt,Je),Te.F=Cs(Me[0])}break;case 1212:if(!d.cellFormula)break;if(z){if(!q)break;Z[bs(q.cell)]=Me[0],((Te=d.dense?(T[q.cell.r]||[])[q.cell.c]:T[bs(q.cell)])||{}).f=""+za(Me[0],0,x,zt,Je)}break;case 253:he=Id(I[Me.isst].t,Me.ixfe,"s"),I[Me.isst].h&&(he.h=I[Me.isst].h),he.XF=ie[he.ixfe],0<jt&&(he.z=qt[he.ixfe>>8&63]),Ja(he,d,u.opts.Date1904),b({c:Me.c,r:Me.r},he,d);break;case 513:d.sheetStubs&&(he={ixfe:Me.ixfe,XF:ie[Me.ixfe],t:"z"},0<jt&&(he.z=qt[he.ixfe>>8&63]),Ja(he,d,u.opts.Date1904),b({c:Me.c,r:Me.r},he,d));break;case 190:if(d.sheetStubs)for(var at=Me.c;at<=Me.C;++at){var Ae=Me.ixfe[at-Me.c];he={ixfe:Ae,XF:ie[Ae],t:"z"},0<jt&&(he.z=qt[he.ixfe>>8&63]),Ja(he,d,u.opts.Date1904),b({c:at,r:Me.r},he,d)}break;case 214:case 516:case 4:(he=Id(Me.val,Me.ixfe,"s")).XF=ie[he.ixfe],0<jt&&(he.z=qt[he.ixfe>>8&63]),Ja(he,d,u.opts.Date1904),b({c:Me.c,r:Me.r},he,d);break;case 0:case 512:Tt===1&&(R=Me);break;case 252:I=Me;break;case 1054:if(Je.biff==4){qt[jt++]=Me[1];for(var kt=0;kt<jt+163&&W[kt]!=Me[1];++kt);163<=kt&&xr(Me[1],jt+163)}else xr(Me[1],Me[0]);break;case 30:qt[jt++]=Me;for(var Ze=0;Ze<jt+163&&W[Ze]!=Me;++Ze);163<=Ze&&xr(Me,jt+163);break;case 229:bt=bt.concat(Me);break;case 93:yt[Me.cmo[0]]=Je.lastobj=Me;break;case 438:Je.lastobj.TxO=Me;break;case 127:Je.lastobj.ImData=Me;break;case 440:for(j=Me[0].s.r;j<=Me[0].e.r;++j)for(y=Me[0].s.c;y<=Me[0].e.c;++y)(Te=d.dense?(T[j]||[])[y]:T[bs({c:y,r:j})])&&(Te.l=Me[1]);break;case 2048:for(j=Me[0].s.r;j<=Me[0].e.r;++j)for(y=Me[0].s.c;y<=Me[0].e.c;++y)(Te=d.dense?(T[j]||[])[y]:T[bs({c:y,r:j})])&&Te.l&&(Te.l.Tooltip=Me[1]);break;case 28:if(Je.biff<=5&&2<=Je.biff)break;Te=d.dense?(T[Me[0].r]||[])[Me[0].c]:T[bs(Me[0])];var dt=yt[Me[2]];Te||(Te=d.dense?(T[Me[0].r]||(T[Me[0].r]=[]),T[Me[0].r][Me[0].c]={t:"z"}):T[bs(Me[0])]={t:"z"},R.e.r=Math.max(R.e.r,Me[0].r),R.s.r=Math.min(R.s.r,Me[0].r),R.e.c=Math.max(R.e.c,Me[0].c),R.s.c=Math.min(R.s.c,Me[0].c)),Te.c||(Te.c=[]),dt={a:Me[1],t:dt.TxO.t},Te.c.push(dt);break;case 2173:ie[Me.ixfe],Me.ext.forEach(function(mt){mt[0]});break;case 125:if(!Je.cellStyles)break;for(;Me.e>=Me.s;)it[Me.e--]={width:Me.w/256,level:Me.level||0,hidden:!!(1&Me.flags)},Ht||(Ht=!0,wd(Me.w/256)),Cl(it[Me.e+1]);break;case 520:dt={},Me.level!=null&&((St[Me.r]=dt).level=Me.level),Me.hidden&&((St[Me.r]=dt).hidden=!0),Me.hpt&&((St[Me.r]=dt).hpt=Me.hpt,dt.hpx=po(Me.hpt));break;case 38:case 39:case 40:case 41:T["!margins"]||Ci(T["!margins"]={}),T["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Vt]]=Me;break;case 161:T["!margins"]||Ci(T["!margins"]={}),T["!margins"].header=Me.header,T["!margins"].footer=Me.footer;break;case 574:Me.RTL&&(We.Views[0].RTL=!0);break;case 146:Ee=Me;break;case 2198:E=Me;break;case 140:k=Me;break;case 442:ee?Ie.CodeName=Me||Ie.name:We.WBProps.CodeName=Me||"ThisWorkbook"}}else gs||console.error("Missing Info for XLS Record 0x"+Vt.toString(16)),r.l+=At}return u.SheetNames=is(_).sort(function(Ge,mt){return Number(Ge)-Number(mt)}).map(function(Ge){return _[Ge].name}),d.bookSheets||(u.Sheets=h),!u.SheetNames.length&&Y["!ref"]?(u.SheetNames.push("Sheet1"),u.Sheets&&(u.Sheets.Sheet1=Y)):u.Preamble=Y,u.Sheets&&Xt.forEach(function(Ge,mt){u.Sheets[u.SheetNames[mt]]["!autofilter"]=Ge}),u.Strings=I,u.SSF=vs(W),Je.enc&&(u.Encryption=Je.enc),E&&(u.Themes=E),u.Metadata={},k!==void 0&&(u.Metadata.Country=k),0<zt.names.length&&(We.Names=zt.names),u.Workbook=We,u}var Nc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Bd(r,d){var u,h,g,b,x;if(Df(d=d||{}),L(),d.codepage&&S(d.codepage),r.FullPaths){if(es.find(r,"/encryption"))throw new Error("File is password-protected");u=es.find(r,"!CompObj"),g=es.find(r,"/Workbook")||es.find(r,"/Book")}else{switch(d.type){case"base64":r=le(Ce(r));break;case"binary":r=le(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r))}Sa(r,0),g={content:r}}if(u&&ju(u),d.bookProps&&!d.bookSheets)h={};else{var y=ge?"buffer":"array";if(g&&g.content)h=kg(g.content,d);else if((g=es.find(r,"PerfectOffice_MAIN"))&&g.content)h=da.to_workbook(g.content,(d.type=y,d));else{if(!(g=es.find(r,"NativeContent_MAIN"))||!g.content)throw(g=es.find(r,"MN0"))&&g.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");h=da.to_workbook(g.content,(d.type=y,d))}d.bookVBA&&r.FullPaths&&es.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(h.vbaraw=(b=r,x=es.utils.cfb_new({root:"R"}),b.FullPaths.forEach(function(j,k){j.slice(-1)!=="/"&&j.match(/_VBA_PROJECT_CUR/)&&(j=j.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),es.utils.cfb_add(x,j,b.FileIndex[k].content))}),es.write(x)))}return y={},r.FullPaths&&(function(j,k,E){var T=es.find(j,"/!DocumentSummaryInformation");if(T&&0<T.size)try{var _,R=Cr(T,bh,Nc.DSI);for(_ in R)k[_]=R[_]}catch(Y){if(E.WTF)throw Y}var q=es.find(j,"/!SummaryInformation");if(q&&0<q.size)try{var I,ee=Cr(q,yh,Nc.SI);for(I in ee)k[I]==null&&(k[I]=ee[I])}catch(Y){if(E.WTF)throw Y}k.HeadingPairs&&k.TitlesOfParts&&(wh(k.HeadingPairs,k.TitlesOfParts,k,E),delete k.HeadingPairs,delete k.TitlesOfParts)})(r,y,d),h.Props=h.Custprops=y,d.bookFiles&&(h.cfb=r),h}function Nu(r,b){var u,h,g=b||{},b=es.utils.cfb_new({root:"R"}),x="/Workbook";switch(g.bookType||"xls"){case"xls":g.bookType="biff8";case"xla":g.bookType||(g.bookType="xla");case"biff8":x="/Workbook",g.biff=8;break;case"biff5":x="/Book",g.biff=5;break;default:throw new Error("invalid type "+g.bookType+" for XLS CFB")}return es.utils.cfb_add(b,x,jf(r,g)),g.biff==8&&(r.Props||r.Custprops)&&(function(y,j){var k,E=[],T=[],_=[],R=0,q=$l(bh,"n"),I=$l(yh,"n");if(y.Props)for(k=is(y.Props),R=0;R<k.length;++R)(Object.prototype.hasOwnProperty.call(q,k[R])?E:Object.prototype.hasOwnProperty.call(I,k[R])?T:_).push([k[R],y.Props[k[R]]]);if(y.Custprops)for(k=is(y.Custprops),R=0;R<k.length;++R)Object.prototype.hasOwnProperty.call(y.Props||{},k[R])||(Object.prototype.hasOwnProperty.call(q,k[R])?E:Object.prototype.hasOwnProperty.call(I,k[R])?T:_).push([k[R],y.Custprops[k[R]]]);for(var ee=[],R=0;R<_.length;++R)-1<jh.indexOf(_[R][0])||-1<E0.indexOf(_[R][0])||_[R][1]!=null&&ee.push(_[R]);T.length&&es.utils.cfb_add(j,"/SummaryInformation",Hs(T,Nc.SI,I,yh)),(E.length||ee.length)&&es.utils.cfb_add(j,"/DocumentSummaryInformation",Hs(E,Nc.DSI,q,bh,ee.length?ee:null,Nc.UDI))})(r,b),g.biff==8&&r.vbaraw&&(u=b,(h=es.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})).FullPaths.forEach(function(y,j){j==0||(y=y.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)!=="/"&&es.utils.cfb_add(u,y,h.FileIndex[j].content)})),b}var jo={0:{f:function(r,d){var u={},h=r.l+d;u.r=r.read_shift(4),r.l+=4;var g=r.read_shift(2);return r.l+=1,d=r.read_shift(1),r.l=h,7&d&&(u.level=7&d),16&d&&(u.hidden=!0),32&d&&(u.hpt=g/20),u}},1:{f:function(r){return[Fn(r)]}},2:{f:function(r){return[Fn(r),gh(r),"n"]}},3:{f:function(r){return[Fn(r),r.read_shift(1),"e"]}},4:{f:function(r){return[Fn(r),r.read_shift(1),"b"]}},5:{f:function(r){return[Fn(r),Aa(r),"n"]}},6:{f:function(r){return[Fn(r),xa(r),"str"]}},7:{f:function(r){return[Fn(r),r.read_shift(4),"s"]}},8:{f:function(r,d,u){var h=r.l+d,g=Fn(r);g.r=u["!row"];var b=[g,xa(r),"str"];return u.cellFormula?(r.l+=2,d=du(r,h-r.l,u),b[3]=za(d,0,g,u.supbooks,u)):r.l=h,b}},9:{f:function(r,d,u){var h=r.l+d,g=Fn(r);g.r=u["!row"];var b=[g,Aa(r),"n"];return u.cellFormula?(r.l+=2,d=du(r,h-r.l,u),b[3]=za(d,0,g,u.supbooks,u)):r.l=h,b}},10:{f:function(r,d,u){var h=r.l+d,g=Fn(r);g.r=u["!row"];var b=[g,r.read_shift(1),"b"];return u.cellFormula?(r.l+=2,d=du(r,h-r.l,u),b[3]=za(d,0,g,u.supbooks,u)):r.l=h,b}},11:{f:function(r,d,u){var h=r.l+d,g=Fn(r);g.r=u["!row"];var b=[g,r.read_shift(1),"e"];return u.cellFormula?(r.l+=2,d=du(r,h-r.l,u),b[3]=za(d,0,g,u.supbooks,u)):r.l=h,b}},12:{f:function(r){return[Jl(r)]}},13:{f:function(r){return[Jl(r),gh(r),"n"]}},14:{f:function(r){return[Jl(r),r.read_shift(1),"e"]}},15:{f:function(r){return[Jl(r),r.read_shift(1),"b"]}},16:{f:yc},17:{f:function(r){return[Jl(r),xa(r),"str"]}},18:{f:function(r){return[Jl(r),r.read_shift(4),"s"]}},19:{f:y0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(r,x,y){var h=r.l+x;r.l+=4,r.l+=1;var g=r.read_shift(4),b=Cm(r),x=dg(r,0,y),y=v0(r);return r.l=h,x={Name:b,Ptg:x},g<268435455&&(x.Sheet=g),y&&(x.Comment=y),x}},40:{},42:{},43:{f:function(r,d,u){var h={};h.sz=r.read_shift(2)/20;var g,b=(b=(g=r).read_shift(1),g.l++,{fBold:1&b,fItalic:2&b,fUnderline:4&b,fStrikeout:8&b,fOutline:16&b,fShadow:32&b,fCondense:64&b,fExtend:128&b});switch(b.fItalic&&(h.italic=1),b.fCondense&&(h.condense=1),b.fExtend&&(h.extend=1),b.fShadow&&(h.shadow=1),b.fOutline&&(h.outline=1),b.fStrikeout&&(h.strike=1),r.read_shift(2)===700&&(h.bold=1),r.read_shift(2)){case 1:h.vertAlign="superscript";break;case 2:h.vertAlign="subscript"}switch((b=r.read_shift(1))!=0&&(h.underline=b),0<(b=r.read_shift(1))&&(h.family=b),0<(b=r.read_shift(1))&&(h.charset=b),r.l++,h.color=(function(x){var y={},j=x.read_shift(1)>>>1,k=x.read_shift(1),E=x.read_shift(2,"i"),T=x.read_shift(1),_=x.read_shift(1),R=x.read_shift(1);switch(x.l++,j){case 0:y.auto=1;break;case 1:y.index=k;var q=Ko[k];q&&(y.rgb=lc(q));break;case 2:y.rgb=lc([T,_,R]);break;case 3:y.theme=k}return E!=0&&(y.tint=0<E?E/32767:E/32768),y})(r),r.read_shift(1)){case 1:h.scheme="major";break;case 2:h.scheme="minor"}return h.name=xa(r),h}},44:{f:function(r,d){return[r.read_shift(2),xa(r)]}},45:{f:Gm},46:{f:fi},47:{f:function(r,g){var u=r.l+g,h=r.read_shift(2),g=r.read_shift(2);return r.l=u,{ixfe:h,numFmtId:g}}},48:{},49:{f:function(r){return r.read_shift(4,"i")}},50:{},51:{f:function(r){for(var d=[],u=r.read_shift(4);0<u--;)d.push([r.read_shift(4),r.read_shift(4)]);return d}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:O0},62:{f:function(r){return[Fn(r),y0(r),"is"]}},63:{f:function(r){var d={};d.i=r.read_shift(4);var u={};return u.r=r.read_shift(4),u.c=r.read_shift(4),d.r=bs(u),2&(r=r.read_shift(1))&&(d.l="1"),8&r&&(d.a="1"),d}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Oa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(r){var d=r.read_shift(2);return r.l+=28,{RTL:32&d}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(r,d){var u={},h=r[r.l];return++r.l,u.above=!(64&h),u.left=!(128&h),r.l+=18,u.name=xn(r),u}},148:{f:Md,p:16},151:{f:function(){}},152:{},153:{f:function(r,d){var u={},h=r.read_shift(4);return u.defaultThemeVersion=r.read_shift(4),0<(r=8<d?xa(r):"").length&&(u.CodeName=r),u.autoCompressPictures=!!(65536&h),u.backupFile=!!(64&h),u.checkCompatibility=!!(4096&h),u.date1904=!!(1&h),u.filterPrivacy=!!(8&h),u.hidePivotFieldList=!!(1024&h),u.promptedSolutions=!!(16&h),u.publishItems=!!(2048&h),u.refreshAllConnections=!!(262144&h),u.saveExternalLinkValues=!!(128&h),u.showBorderUnselectedTables=!!(4&h),u.showInkAnnotation=!!(32&h),u.showObjects=["all","placeholders","none"][h>>13&3],u.showPivotChartFilter=!!(32768&h),u.updateLinks=["userSet","never","always"][h>>8&3],u}},154:{},155:{},156:{f:function(r,d){var u={};return u.Hidden=r.read_shift(4),u.iTabID=r.read_shift(4),u.strRelID=w0(r),u.name=xa(r),u}},157:{},158:{},159:{T:1,f:function(r){return[r.read_shift(4),r.read_shift(4)]}},160:{T:-1},161:{T:1,f:Qn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ei},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(r,d){return{flags:r.read_shift(4),version:r.read_shift(4),name:xa(r)}}},336:{T:-1},337:{f:function(r){return r.l+=4,r.read_shift(4)!=0},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:w0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:R0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(r,b,u){var h=r.l+b,g=j0(r),b=r.read_shift(1);return(g=[g])[2]=b,u.cellFormula?(u=Kp(r,h-r.l,u),g[1]=u):r.l=h,g}},427:{f:function(r,g,u){var h=r.l+g,g=[Qn(r)];return u.cellFormula&&(u=_d(r,h-r.l,u),g[1]=u),r.l=h,g}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(r){var d={};return bf.forEach(function(u){d[u]=Aa(r)}),d}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(r,y){var u=r.l+y,h=Qn(r),g=v0(r),b=xa(r),x=xa(r),y=xa(r);return r.l=u,y={rfx:h,relId:g,loc:b,display:y},x&&(y.Tooltip=x),y}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:w0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Ri},633:{T:1},634:{T:-1},635:{T:1,f:function(r){var d={};d.iauthor=r.read_shift(4);var u=Qn(r);return d.rfx=u.s,d.ref=bs(u.s),r.l+=16,d}},636:{T:-1},637:{f:km},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(r,d){return r.l+=10,{name:xa(r)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},wf={6:{f:fc},10:{f:$a},12:{f:br},13:{f:br},14:{f:Js},15:{f:Js},16:{f:Aa},17:{f:Js},18:{f:Js},19:{f:br},20:{f:Ch},21:{f:Ch},23:{f:R0},24:{f:wl},25:{f:Js},26:{},27:{},28:{f:function(r,d,u){return(function(h,g){if(!(g.biff<8)){var b=h.read_shift(2),x=h.read_shift(2),y=h.read_shift(2),j=h.read_shift(2),k=Vi(h,0,g);return g.biff<8&&h.read_shift(1),[{r:b,c:x},k,j,y]}})(r,u)}},29:{},34:{f:Js},35:{f:Mm},38:{f:Aa},39:{f:Aa},40:{f:Aa},41:{f:Aa},42:{f:Js},43:{f:Js},47:{f:function(r,d,u){var h={Type:8<=u.biff?r.read_shift(2):0};return h.Type?Vm(r,d-2,h):(d=r,u.biff,r=u,u=h,d={key:br(d),verificationBytes:br(d)},r.password&&(d.verifier=G0(r.password)),u.valid=d.verificationBytes===d.verifier,u.valid&&(u.insitu=Hm(r.password))),h}},49:{f:function(r,d,u){var h={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(u&&u.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10}return h.name=Zn(r,0,u),h}},51:{f:br},60:{},61:{f:function(r){return{Pos:[r.read_shift(2),r.read_shift(2)],Dim:[r.read_shift(2),r.read_shift(2)],Flags:r.read_shift(2),CurTab:r.read_shift(2),FirstTab:r.read_shift(2),Selected:r.read_shift(2),TabRatio:r.read_shift(2)}}},64:{f:Js},65:{f:function(){}},66:{f:br},77:{},80:{},81:{},82:{},85:{f:br},89:{},90:{},91:{},92:{f:function(r,d,g){if(g.enc)return r.l+=d,"";var h=r.l,g=Vi(r,0,g);return r.read_shift(d+h-r.l),g}},93:{f:function(r,d,u){return u&&u.biff<8?(function(h,g,b){h.l+=4;var x=h.read_shift(2),y=h.read_shift(2),j=h.read_shift(2);h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=6,g-=36;var k=[];return k.push((Rm[x]||Oa)(h,g,b)),{cmo:[y,x,j],ft:k}})(r,d,u):{cmo:u=_m(r),ft:(function(h,g){for(var b=h.l+g,x=[];h.l<b;){var y=h.read_shift(2);h.l-=2;try{x.push(na[y](h,b-h.l))}catch{return h.l=b,x}}return h.l!=b&&(h.l=b),x})(r,d-22,u[1])}}},94:{},95:{f:Js},96:{},97:{},99:{f:Js},125:{f:O0},128:{f:function(r){if(r.l+=4,(r=[r.read_shift(2),r.read_shift(2)])[0]!==0&&r[0]--,r[1]!==0&&r[1]--,7<r[0]||7<r[1])throw new Error("Bad Gutters: "+r.join("|"));return r}},129:{f:function(r,d,u){return{fDialog:16&(d=u&&u.biff==8||d==2?r.read_shift(2):(r.l+=d,0)),fBelow:64&d,fRight:128&d}}},130:{f:br},131:{f:Js},132:{f:Js},133:{f:function(r,d,u){var h=r.read_shift(4),g=3&r.read_shift(1),b=r.read_shift(1);switch(b){case 0:b="Worksheet";break;case 1:b="Macrosheet";break;case 2:b="Chartsheet";break;case 6:b="VBAModule"}return u=Zn(r,0,u),{pos:h,hs:g,dt:b,name:u=u.length===0?"Sheet1":u}}},134:{},140:{f:function(r){var d=[0,0],u=r.read_shift(2);return d[0]=Am[u]||u,u=r.read_shift(2),d[1]=Am[u]||u,d}},141:{f:br},144:{},146:{f:function(r){for(var d=r.read_shift(2),u=[];0<d--;)u.push(M0(r));return u}},151:{},152:{},153:{},154:{},155:{},156:{f:br},157:{},158:{},160:{f:I0},161:{f:function(r,d){var u={};return d<32||(r.l+=16,u.header=Aa(r),u.footer=Aa(r),r.l+=2),u}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(r,d){for(var u=r.l+d-2,h=r.read_shift(2),g=r.read_shift(2),b=[];r.l<u;)b.push(vl(r));if(r.l!==u)throw new Error("MulRK read error");if(d=r.read_shift(2),b.length!=d-g+1)throw new Error("MulRK length mismatch");return{r:h,c:g,C:d,rkrec:b}}},190:{f:function(r,d){for(var u=r.l+d-2,h=r.read_shift(2),g=r.read_shift(2),b=[];r.l<u;)b.push(r.read_shift(2));if(r.l!==u)throw new Error("MulBlank read error");if(d=r.read_shift(2),b.length!=d-g+1)throw new Error("MulBlank length mismatch");return{r:h,c:g,C:d,ixfe:b}}},193:{f:$a},197:{},198:{},199:{},200:{},201:{},202:{f:Js},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:br},220:{},221:{f:Js},222:{},224:{f:function(r,d,u){var h,g,b,x={};return x.ifnt=r.read_shift(2),x.numFmtId=r.read_shift(2),x.flags=r.read_shift(2),x.fStyle=x.flags>>2&1,d-=6,x.data=(h=r,x.fStyle,g=u,b={},d=h.read_shift(4),r=h.read_shift(4),u=h.read_shift(4),h=h.read_shift(2),b.patternType=Em[u>>26],g.cellStyles&&(b.alc=7&d,b.fWrap=d>>3&1,b.alcV=d>>4&7,b.fJustLast=d>>7&1,b.trot=d>>8&255,b.cIndent=d>>16&15,b.fShrinkToFit=d>>20&1,b.iReadOrder=d>>22&2,b.fAtrNum=d>>26&1,b.fAtrFnt=d>>27&1,b.fAtrAlc=d>>28&1,b.fAtrBdr=d>>29&1,b.fAtrPat=d>>30&1,b.fAtrProt=d>>31&1,b.dgLeft=15&r,b.dgRight=r>>4&15,b.dgTop=r>>8&15,b.dgBottom=r>>12&15,b.icvLeft=r>>16&127,b.icvRight=r>>23&127,b.grbitDiag=r>>30&3,b.icvTop=127&u,b.icvBottom=u>>7&127,b.icvDiag=u>>14&127,b.dgDiag=u>>21&15,b.icvFore=127&h,b.icvBack=h>>7&127,b.fsxButton=h>>14&1),b),x}},225:{f:function(r,d){return d===0||r.read_shift(2),1200}},226:{f:$a},227:{},229:{f:function(r,d){for(var u=[],h=r.read_shift(2);h--;)u.push(aa(r));return u}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(r,d){for(var u=r.l+d,d=r.read_shift(4),h=r.read_shift(4),g=[],b=0;b!=h&&r.l<u;++b)g.push((function(y){var j=m;m=1200;var k,E=y.read_shift(2),T=4&(I=y.read_shift(1)),_=8&I,R=1+(1&I),q=0,I={};return _&&(q=y.read_shift(2)),T&&(k=y.read_shift(4)),R=R==2?"dbcs-cont":"sbcs-cont",R=E===0?"":y.read_shift(E,R),_&&(y.l+=4*q),T&&(y.l+=k),I.t=R,_||(I.raw="<t>"+I.t+"</t>",I.r=I.t),m=j,I})(r));return g.Count=d,g.Unique=h,g}},253:{f:function(r){var d=qa(r);return d.isst=r.read_shift(4),d}},255:{f:function(r,d){var u={};return u.dsst=r.read_shift(2),r.l+=d-2,u}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Nh},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Js},353:{f:$a},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(r,b,u){var h=r.l+b,g=r.read_shift(2),b=r.read_shift(2);if((u.sbcch=b)==1025||b==14849)return[b,g];if(b<1||255<b)throw new Error("Unexpected SupBook type: "+b);for(var u=Ui(r,b),x=[];h>r.l;)x.push(Hi(r));return[b,g,u,x]}},431:{f:Js},432:{},433:{},434:{},437:{},438:{f:function(r,d,u){var h=r.l,g="";try{r.l+=4;var b=(u.lastobj||{cmo:[0,0]}).cmo[1];[0,5,7,11,12,14].indexOf(b)==-1?r.l+=6:(function(k){var E=k.read_shift(1);k.l++;var T=k.read_shift(2);k.l+=2})(r);var x=r.read_shift(2);r.read_shift(2),br(r),b=r.read_shift(2),r.l+=b;for(var y=1;y<r.lens.length-1;++y){if(r.l-h!=r.lens[y])throw new Error("TxO: bad continue record");var j=r[r.l];if((g+=Ui(r,r.lens[y+1]-r.lens[y]-1)).length>=(j?x:2*x))break}if(g.length!==x&&g.length!==2*x)throw new Error("cchText: "+x+" != "+g.length);return r.l=h+d,{t:g}}catch{return r.l=h+d,{t:g}}}},439:{f:Js},440:{f:function(r,d){var u=aa(r);return r.l+=16,[u,(function(h,g){var b=h.l+g;if((T=h.read_shift(4))!==2)throw new Error("Unrecognized streamVersion: "+T);g=h.read_shift(2),h.l+=2;var x,y,j,k,E,T="";16&g&&(x=ei(h,h.l)),128&g&&(y=ei(h,h.l)),(257&g)==257&&(j=ei(h,h.l)),(257&g)==1&&(_=Wi(h,h.l)),8&g&&(T=ei(h,h.l)),32&g&&(k=h.read_shift(16)),64&g&&(E=Xo(h)),h.l=b;var _=y||j||_||"";return _&&T&&(_+="#"+T),_=_||"#"+T,_={Target:_=2&g&&_.charAt(0)=="/"&&_.charAt(1)!="/"?"file://"+_:_},k&&(_.guid=k),E&&(_.time=E),x&&(_.Tooltip=x),_})(r,d-24)]}},441:{},442:{f:Hi},443:{},444:{f:br},445:{},446:{},448:{f:$a},449:{f:function(r){return r.read_shift(2),r.read_shift(4)},r:2},450:{f:$a},512:{f:io},513:{f:P0},515:{f:function(r,d,u){return u.biffguess&&u.biff==2&&(u.biff=5),u=qa(r),r=Aa(r),u.val=r,u}},516:{f:function(r,d,u){return u.biffguess&&u.biff==2&&(u.biff=5),r.l,d=qa(r),u.biff==2&&r.l++,u=Hi(r,r.l,u),d.val=u,d}},517:{f:Fm},519:{f:Bf},520:{f:function(r){var d={};d.r=r.read_shift(2),d.c=r.read_shift(2),d.cnt=r.read_shift(2)-d.c;var u=r.read_shift(2);r.l+=4;var h=r.read_shift(1);return r.l+=3,7&h&&(d.level=7&h),32&h&&(d.hidden=!0),64&h&&(d.hpt=u/20),d}},523:{},545:{f:od},549:{f:L0},566:{},574:{f:function(r,d,u){return u&&2<=u.biff&&u.biff<5?{}:{RTL:64&r.read_shift(2)}}},638:{f:function(h){var d=h.read_shift(2),u=h.read_shift(2),h=vl(h);return{r:d,c:u,ixfe:h[0],rknum:h[1]}}},659:{},1048:{},1054:{f:function(r,d,u){return[r.read_shift(2),Vi(r,0,u)]}},1084:{},1212:{f:function(r,d,u){var h=kh(r);r.l++;var g=r.read_shift(1);return[(function(b,x,y){var j,k=b.l+x,E=b.read_shift(2),T=Dd(b,E,y);return E==65535?[[],Oa(b,x-2)]:(x!==E+2&&(j=yo(b,k-E-2,T,y)),[T,j])})(r,d-=8,u),g,h]}},2048:{f:function(r,d){return r.read_shift(2),[aa(r),r.read_shift((d-10)/2,"dbcs-cont").replace(ye,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Zo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:$a},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(r){r.l+=2;var d={cxfs:0,crc:0};return d.cxfs=r.read_shift(2),d.crc=r.read_shift(4),d},r:12},2173:{f:function(r,d){r.l,r.l+=2,d=r.read_shift(2),r.l+=2;for(var u=r.read_shift(2),h=[];0<u--;)h.push(ag(r,r.l));return{ixfe:d,ext:h}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Js,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(r,d,u){if(!(u.biff<8)){var h=r.read_shift(2),g=r.read_shift(2);return[Ui(r,h,u),Ui(r,g,u)]}r.l+=d},r:12},2197:{},2198:{f:function(r,d,u){var h=r.l+d;if(r.read_shift(4)!==124226)if(u.cellStyles){var g,b=r.slice(r.l);r.l=h;try{g=tn(b,{type:"array"})}catch{return}if(d=La(g,"theme/theme/theme1.xml",!0),d)return Sl(d,u)}else r.l=h},r:12},2199:{},2200:{},2201:{},2202:{f:function(r){return[r.read_shift(4)!==0,r.read_shift(4)!==0,r.read_shift(4)]},r:12},2203:{f:$a},2204:{},2205:{},2206:{},2207:{},2211:{f:function(r){var d,u,h=(u=(d=r).read_shift(2),h=d.read_shift(2),d.l+=8,{type:u});if(h.type!=2211)throw new Error("Invalid Future Record "+h.type);return r.read_shift(4)!==0}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:br},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(r,d,u){var h={area:!1};return u.biff!=5?r.l+=d:(d=r.read_shift(1),r.l+=3,16&d&&(h.area=!0)),h}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(r){for(var d=r.read_shift(2),u=[];0<d--;)u.push(M0(r));return u}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:io},1:{},2:{f:function(r){var d=qa(r);return++r.l,r=r.read_shift(2),d.t="n",d.val=r,d}},3:{f:function(r){var d=qa(r);return++r.l,r=Aa(r),d.t="n",d.val=r,d}},4:{f:function(r,d,u){u.biffguess&&u.biff==5&&(u.biff=2);var h=qa(r);return++r.l,u=Vi(r,0,u),h.t="str",h.val=u,h}},5:{f:Fm},7:{f:function(r){var d=r.read_shift(1);return d===0?(r.l++,""):r.read_shift(d,"sbcs-cont")}},8:{},9:{f:Zo},11:{},22:{f:br},30:{f:Ll},31:{},32:{},33:{f:od},36:{},37:{f:L0},50:{f:function(r,d){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=d-13}},62:{},52:{},67:{},68:{f:br},69:{},86:{},126:{},127:{f:function(r){var d=r.read_shift(2),h=r.read_shift(2),u=r.read_shift(4),h={fmt:d,env:h,len:u,data:r.slice(r.l,r.l+u)};return r.l+=u,h}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(r,b,x){var h=r.l+b,g=qa(r),b=r.read_shift(2),x=Ui(r,b,x);return r.l=h,g.t="str",g.val=x,g}},223:{},234:{},354:{},421:{},518:{f:fc},521:{f:Zo},536:{f:wl},547:{f:Mm},561:{},579:{},1030:{f:fc},1033:{f:Zo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function It(r,d,u,h){var g=d;isNaN(g)||(d=h||(u||[]).length||0,(h=r.next(4)).write_shift(2,g),h.write_shift(2,d),0<d&&uh(u)&&r.push(u))}function zd(r,d,u){return(r=r||pt(7)).write_shift(2,d),r.write_shift(2,u),r.write_shift(2,0),r.write_shift(1,0),r}function Cg(r,d,u,h){if(d.v!=null)switch(d.t){case"d":case"n":var g=d.t=="d"?qr(_s(d.v)):d.v;return void(g==(0|g)&&0<=g&&g<65536?It(r,2,(E=u,T=h,_=g,zd(R=pt(9),E,T),R.write_shift(2,_),R)):It(r,3,(_=u,R=h,g=g,zd(k=pt(15),_,R),k.write_shift(8,g,"f"),k)));case"b":case"e":return void It(r,5,(k=u,b=h,x=d.v,y=d.t,zd(j=pt(9),k,b),ao(x,y||"b",j),j));case"s":case"str":return void It(r,4,(b=u,x=h,y=(d.v||"").slice(0,255),zd(j=pt(8+2*y.length),b,x),j.write_shift(1,y.length),j.write_shift(y.length,y,"sbcs"),j.l<j.length?j.slice(0,j.l):j))}var b,x,y,j,k,E,T,_,R;It(r,1,zd(null,u,h))}function Sg(r,d){for(var u=d||{},d=Pa(),h=0,g=0;g<r.SheetNames.length;++g)r.SheetNames[g]==u.sheet&&(h=g);if(h==0&&u.sheet&&r.SheetNames[0]!=u.sheet)throw new Error("Sheet not found: "+u.sheet);return It(d,u.biff==4?1033:u.biff==3?521:9,no(0,16,u)),(function(b,x,y){var j,k,E=Array.isArray(x),T=Fs(x["!ref"]||"A1"),_=[];if(255<T.e.c||16383<T.e.r){if(y.WTF)throw new Error("Range "+(x["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,16383),j=Cs(T)}for(var R=T.s.r;R<=T.e.r;++R){k=Ur(R);for(var q=T.s.c;q<=T.e.c;++q){R===T.s.r&&(_[q]=Ar(q)),j=_[q]+k;var I=E?(x[R]||[])[q]:x[j];I&&Cg(b,I,R,q)}}})(d,r.Sheets[r.SheetNames[h]],u),It(d,10),d.end()}function kc(r,d,u){var h,g;It(r,49,(g=(h={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(r=pt((u=(r=u)&&r.biff==5)?15+g.length:16+2*g.length)).write_shift(2,20*(h.sz||12)),r.write_shift(4,0),r.write_shift(2,400),r.write_shift(4,0),r.write_shift(2,0),r.write_shift(1,g.length),u||r.write_shift(1,1),r.write_shift((u?1:2)*g.length,g,u?"sbcs":"utf16le"),r))}function ku(r,d,u){d&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g,b,x,y,j=h[0];j<=h[1];++j)d[j]!=null&&It(r,1054,(g=j,b=d[j],y=void 0,x=(x=u)&&x.biff==5,(y=y||pt(x?3+b.length:5+2*b.length)).write_shift(2,g),y.write_shift(x?1:2,b.length),x||y.write_shift(1,1),y.write_shift((x?1:2)*b.length,b,x?"sbcs":"utf16le"),(y=y.length>y.l?y.slice(0,y.l):y).l==null&&(y.l=y.length),y))})}function Ag(r,d){for(var u=0;u<d["!links"].length;++u){var h=d["!links"][u];It(r,440,ec(h)),h[1].Tooltip&&It(r,2048,(function(g){var b=g[1].Tooltip,x=pt(10+2*(b.length+1));x.write_shift(2,2048),g=Hr(g[0]),x.write_shift(2,g.r),x.write_shift(2,g.r),x.write_shift(2,g.c),x.write_shift(2,g.c);for(var y=0;y<b.length;++y)x.write_shift(2,b.charCodeAt(y));return x.write_shift(2,0),x})(h))}delete d["!links"]}function Eg(r,d){var u;d&&(u=0,d.forEach(function(h,g){var b;++u<=256&&h&&It(r,125,(b=xc(g,h),h=g,(g=pt(12)).write_shift(2,h),g.write_shift(2,h),g.write_shift(2,256*b.width),g.write_shift(2,0),h=0,b.hidden&&(h|=1),g.write_shift(1,h),h=b.level||0,g.write_shift(1,h),g.write_shift(2,0),g))}))}function Dg(r,d,u,h,g){var b,x,y,j,k,E,T,_,R,q,I,ee=16+Ji(g.cellXfs,d,g);if(d.v!=null||d.bf)if(d.bf)It(r,6,Td(d,u,h,0,ee));else switch(d.t){case"d":case"n":var Y=d.t=="d"?qr(_s(d.v)):d.v;It(r,515,(E=u,T=h,_=Y,R=ee,q=pt(14),ji(E,T,R,q),Mn(_,q),q));break;case"b":case"e":It(r,517,(Y=u,E=h,T=d.v,R=ee,_=d.t,q=pt(8),ji(Y,E,R,q),ao(T,_,q),q));break;case"s":case"str":g.bookSST?(I=Fd(g.Strings,d.v,g.revStrings),It(r,253,(b=u,x=h,y=I,j=ee,k=pt(10),ji(b,x,j,k),k.write_shift(4,y),k))):It(r,516,(I=u,b=h,x=(d.v||"").slice(0,255),j=ee,y=pt(+(k=!(y=g)||y.biff==8)+8+(1+k)*x.length),ji(I,b,j,y),y.write_shift(2,x.length),k&&y.write_shift(1,1),y.write_shift((1+k)*x.length,x,k?"utf16le":"sbcs"),y));break;default:It(r,513,ji(u,h,ee))}else It(r,513,ji(u,h,ee))}function Tg(r,d,u){var h,g,b=Pa(),Z=u.SheetNames[r],x=u.Sheets[Z]||{},y=(u||{}).Workbook||{},j=(y.Sheets||[])[r]||{},k=Array.isArray(x),E=d.biff==8,T=[],_=Fs(x["!ref"]||"A1"),R=E?65536:16384;if(255<_.e.c||_.e.r>=R){if(d.WTF)throw new Error("Range "+(x["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,R-1)}It(b,2057,no(0,16,d)),It(b,13,jn(1)),It(b,12,jn(100)),It(b,15,Ea(!0)),It(b,17,Ea(!1)),It(b,16,Mn(.001)),It(b,95,Ea(!0)),It(b,42,Ea(!1)),It(b,43,Ea(!1)),It(b,130,jn(1)),It(b,128,(u=[0,0],(r=pt(8)).write_shift(4,0),r.write_shift(2,u[0]?u[0]+1:0),r.write_shift(2,u[1]?u[1]+1:0),r)),It(b,131,Ea(!1)),It(b,132,Ea(!1)),E&&Eg(b,x["!cols"]),It(b,512,(R=_,(u=pt(2*(r=(u=d).biff!=8&&u.biff?2:4)+6)).write_shift(r,R.s.r),u.write_shift(r,R.e.r+1),u.write_shift(2,R.s.c),u.write_shift(2,R.e.c+1),u.write_shift(2,0),u)),E&&(x["!links"]=[]);for(var q=_.s.r;q<=_.e.r;++q){g=Ur(q);for(var I=_.s.c;I<=_.e.c;++I){q===_.s.r&&(T[I]=Ar(I)),h=T[I]+g;var ee=k?(x[q]||[])[I]:x[h];ee&&(Dg(b,ee,q,I,d),E&&ee.l&&x["!links"].push([h,ee.l]))}}var Y,z,Z=j.CodeName||j.name||Z;return E&&It(b,574,(y=(y.Views||[])[0],z=pt(18),Y=1718,y&&y.RTL&&(Y|=64),z.write_shift(2,Y),z.write_shift(4,0),z.write_shift(4,64),z.write_shift(4,0),z.write_shift(4,0),z)),E&&(x["!merges"]||[]).length&&It(b,229,(function(ae){var ie=pt(2+8*ae.length);ie.write_shift(2,ae.length);for(var Ee=0;Ee<ae.length;++Ee)id(ae[Ee],ie);return ie})(x["!merges"])),E&&Ag(b,x),It(b,442,yl(Z)),E&&(Y=b,z=x,(Z=pt(19)).write_shift(4,2151),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,3),Z.write_shift(1,1),Z.write_shift(4,0),It(Y,2151,Z),(Z=pt(39)).write_shift(4,2152),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,3),Z.write_shift(1,0),Z.write_shift(4,0),Z.write_shift(2,1),Z.write_shift(4,4),Z.write_shift(2,0),id(Fs(z["!ref"]||"A1"),Z),Z.write_shift(4,4),It(Y,2152,Z)),It(b,10),b.end()}function _g(r,d,u){var h=Pa(),y=(r||{}).Workbook||{},g=y.Sheets||[],b=y.WBProps||{},x=u.biff==8,y=u.biff==5;It(h,2057,no(0,5,u)),u.bookType=="xla"&&It(h,135),It(h,225,x?jn(1200):null),It(h,193,(function(Y,z){z=z||pt(Y);for(var Z=0;Z<Y;++Z)z.write_shift(1,0);return z})(2)),y&&It(h,191),y&&It(h,192),It(h,226),It(h,92,(function(Y){var z=!Y||Y.biff==8,Z=pt(z?112:54);for(Z.write_shift(Y.biff==8?2:1,7),z&&Z.write_shift(1,0),Z.write_shift(4,859007059),Z.write_shift(4,5458548|(z?0:536870912));Z.l<Z.length;)Z.write_shift(1,z?0:32);return Z})(u)),It(h,66,jn(x?1200:1252)),x&&It(h,353,jn(0)),x&&It(h,448),It(h,317,(function(Y){for(var z=pt(2*Y),Z=0;Z<Y;++Z)z.write_shift(2,Z+1);return z})(r.SheetNames.length)),x&&r.vbaraw&&It(h,211),x&&r.vbaraw&&It(h,442,yl(b.CodeName||"ThisWorkbook")),It(h,156,jn(17)),It(h,25,Ea(!1)),It(h,18,Ea(!1)),It(h,19,jn(0)),x&&It(h,431,Ea(!1)),x&&It(h,444,jn(0)),It(h,61,((y=pt(18)).write_shift(2,0),y.write_shift(2,0),y.write_shift(2,29280),y.write_shift(2,17600),y.write_shift(2,56),y.write_shift(2,0),y.write_shift(2,0),y.write_shift(2,1),y.write_shift(2,500),y)),It(h,64,Ea(!1)),It(h,141,jn(0)),It(h,34,Ea(((b=r).Workbook&&b.Workbook.WBProps&&or(b.Workbook.WBProps.date1904)?"true":"false")=="true")),It(h,14,Ea(!0)),x&&It(h,439,Ea(!1)),It(h,218,jn(0)),kc(h,0,u),ku(h,r.SSF,u),(function(Y,z){for(var Z=0;Z<16;++Z)It(Y,224,lo({numFmtId:0,style:!0},0,z));z.cellXfs.forEach(function(ae){It(Y,224,lo(ae,0,z))})})(h,u),x&&It(h,352,Ea(!1)),y=h.end(),b=Pa(),x&&It(b,140,((ee=ee||pt(4)).write_shift(2,1),ee.write_shift(2,1),ee)),x&&u.Strings&&(function(Y,z,Z){var ae=(Z||[]).length||0;if(ae<=8224)return It(Y,z,Z,ae);if(!isNaN(z)){for(var ie=Z.parts||[],Ee=0,We=0,Ie=0;Ie+(ie[Ee]||8224)<=8224;)Ie+=ie[Ee]||8224,Ee++;var Je=Y.next(4);for(Je.write_shift(2,z),Je.write_shift(2,Ie),Y.push(Z.slice(We,We+Ie)),We+=Ie;We<ae;){for((Je=Y.next(4)).write_shift(2,60),Ie=0;Ie+(ie[Ee]||8224)<=8224;)Ie+=ie[Ee]||8224,Ee++;Je.write_shift(2,Ie),Y.push(Z.slice(We,We+Ie)),We+=Ie}}})(b,252,ld(u.Strings)),It(b,10);for(var h=b.end(),j=Pa(),k=0,E=0,E=0;E<r.SheetNames.length;++E)k+=(x?12:11)+(x?2:1)*r.SheetNames[E].length;var T,_,R,q,I=y.length+k+h.length;for(E=0;E<r.SheetNames.length;++E)It(j,133,(T={pos:I,hs:(g[E]||{}).Hidden||0,dt:0,name:r.SheetNames[E]},q=R=void 0,R=!(_=u)||8<=_.biff?2:1,(q=pt(8+R*T.name.length)).write_shift(4,T.pos),q.write_shift(1,T.hs||0),q.write_shift(1,T.dt),q.write_shift(1,T.name.length),8<=_.biff&&q.write_shift(1,1),q.write_shift(R*T.name.length,T.name,_.biff<8?"sbcs":"utf16le"),(_=q.slice(0,q.l)).l=q.l,_)),I+=d[E].length;var ee=j.end();if(k!=ee.length)throw new Error("BS8 "+k+" != "+ee.length);return b=[],y.length&&b.push(y),ee.length&&b.push(ee),h.length&&b.push(h),ce(b)}function jf(r,d){for(var u=0;u<=r.SheetNames.length;++u){var h=r.Sheets[r.SheetNames[u]];h&&h["!ref"]&&255<Ia(h["!ref"]).e.c&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[u]+"' extends beyond column IV (255).  Data may be lost.")}var g=d||{};switch(g.biff||2){case 8:case 5:return(function(b,x){var y=x||{},j=[];b&&!b.SSF&&(b.SSF=vs(W)),b&&b.SSF&&(Hl(),Io(b.SSF),y.revssf=ql(b.SSF),y.revssf[b.SSF[65535]]=0,y.ssf=b.SSF),y.Strings=[],y.Strings.Count=0,y.Strings.Unique=0,Mu(y),y.cellXfs=[],Ji(y.cellXfs,{},{revssf:{General:0}}),b.Props||(b.Props={});for(var k=0;k<b.SheetNames.length;++k)j[j.length]=Tg(k,y,b);return j.unshift(_g(b,j,y)),ce(j)})(r,d);case 4:case 3:case 2:return Sg(r,d)}throw new Error("invalid type "+g.bookType+" for BIFF")}function Ud(r,d){var u=d||{},h=u.dense?[]:{},g=(r=r.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!g)throw new Error("Invalid HTML: could not find <table>");for(var b,d=r.match(/<\/table/i),_=g.index,x=d&&d.index||r.length,y=gn(r.slice(_,x),/(:?<tr[^>]*>)/i,"<tr>"),j=-1,k=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},T=[],_=0;_<y.length;++_){var R=y[_].trim(),q=R.slice(0,3).toLowerCase();if(q!="<tr"){if(q=="<td"||q=="<th")for(var I=R.split(/<\/t[dh]>/i),x=0;x<I.length;++x){var ee=I[x].trim();if(ee.match(/<t[dh]/i)){for(var Y=ee,z=0;Y.charAt(0)=="<"&&-1<(z=Y.indexOf(">"));)Y=Y.slice(z+1);for(var Z=0;Z<T.length;++Z){var ae=T[Z];ae.s.c==k&&ae.s.r<j&&j<=ae.e.r&&(k=ae.e.c+1,Z=-1)}var ie=fs(ee.slice(0,ee.indexOf(">"))),Ee=ie.colspan?+ie.colspan:1;(1<(b=+ie.rowspan)||1<Ee)&&T.push({s:{r:j,c:k},e:{r:j+(b||1)-1,c:k+Ee-1}}),ee=ie.t||ie["data-t"]||"",Y.length&&(Y=st(Y),E.s.r>j&&(E.s.r=j),E.e.r<j&&(E.e.r=j),E.s.c>k&&(E.s.c=k),E.e.c<k&&(E.e.c=k),Y.length&&(ie={t:"s",v:Y},u.raw||!Y.trim().length||ee=="s"||(Y==="TRUE"?ie={t:"b",v:!0}:Y==="FALSE"?ie={t:"b",v:!1}:isNaN(en(Y))?isNaN(mn(Y).getDate())||(ie={t:"d",v:_s(Y)},(ie=u.cellDates?ie:{t:"n",v:qr(ie.v)}).z=u.dateNF||W[14]):ie={t:"n",v:en(Y)}),u.dense?(h[j]||(h[j]=[]),h[j][k]=ie):h[bs({r:j,c:k})]=ie)),k+=Ee}}}else{if(++j,u.sheetRows&&u.sheetRows<=j){--j;break}k=0}}return h["!ref"]=Cs(E),T.length&&(h["!merges"]=T),h}function Nf(r,d,u,h){for(var g=r["!merges"]||[],b=[],x=d.s.c;x<=d.e.c;++x){for(var y,j,k,E,T=0,_=0,R=0;R<g.length;++R)if(!(g[R].s.r>u||g[R].s.c>x||g[R].e.r<u||g[R].e.c<x)){if(g[R].s.r<u||g[R].s.c<x){T=-1;break}T=g[R].e.r-g[R].s.r+1,_=g[R].e.c-g[R].s.c+1;break}T<0||(y=bs({r:u,c:x}),k=(j=h.dense?(r[u]||[])[x]:r[y])&&j.v!=null&&(j.h||Oi(j.w||(xi(j),j.w)||""))||"",E={},1<T&&(E.rowspan=T),1<_&&(E.colspan=_),h.editable?k='<span contenteditable="true">'+k+"</span>":j&&(E["data-t"]=j&&j.t||"z",j.v!=null&&(E["data-v"]=j.v),j.z!=null&&(E["data-z"]=j.z),j.l&&(j.l.Target||"#").charAt(0)!="#"&&(k='<a href="'+j.l.Target+'">'+k+"</a>")),E.id=(h.id||"sjs")+"-"+y,b.push(Le("td",k,E)))}return"<tr>"+b.join("")+"</tr>"}var kf='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ar="</body></html>";function Cu(r,d,u){return[].join("")+"<table"+(u&&u.id?' id="'+u.id+'"':"")+">"}function Fg(r,g){var u=g||{},h=u.header!=null?u.header:kf,g=u.footer!=null?u.footer:ar,b=[h],x=Ia(r["!ref"]);u.dense=Array.isArray(r),b.push(Cu(0,0,u));for(var y=x.s.r;y<=x.e.r;++y)b.push(Nf(r,x,y,u));return b.push("</table>"+g),b.join("")}function Cf(r,d,u){var h=u||{},g=0,b=0;h.origin!=null&&(typeof h.origin=="number"?g=h.origin:(g=(u=typeof h.origin=="string"?Hr(h.origin):h.origin).r,b=u.c));var x=d.getElementsByTagName("tr"),y=Math.min(h.sheetRows||1e7,x.length),j={s:{r:0,c:0},e:{r:g,c:b}};r["!ref"]&&(d=Ia(r["!ref"]),j.s.r=Math.min(j.s.r,d.s.r),j.s.c=Math.min(j.s.c,d.s.c),j.e.r=Math.max(j.e.r,d.e.r),j.e.c=Math.max(j.e.c,d.e.c),g==-1&&(j.e.r=g=d.e.r+1));var k,E,T=[],_=0,R=r["!rows"]||(r["!rows"]=[]),q=0,I=0,ee=0,Y=0;for(r["!cols"]||(r["!cols"]=[]);q<x.length&&I<y;++q){var z=x[q];if(Lg(z)){if(h.display)continue;R[I]={hidden:!0}}for(var Z=z.children,ee=Y=0;ee<Z.length;++ee){var ae=Z[ee];if(!h.display||!Lg(ae)){for(var ie=ae.hasAttribute("data-v")?ae.getAttribute("data-v"):ae.hasAttribute("v")?ae.getAttribute("v"):st(ae.innerHTML),Ee=ae.getAttribute("data-z")||ae.getAttribute("z"),_=0;_<T.length;++_){var We=T[_];We.s.c==Y+b&&We.s.r<I+g&&I+g<=We.e.r&&(Y=We.e.c+1-b,_=-1)}E=+ae.getAttribute("colspan")||1,(1<(k=+ae.getAttribute("rowspan")||1)||1<E)&&T.push({s:{r:I+g,c:Y+b},e:{r:I+g+(k||1)-1,c:Y+b+(E||1)-1}});var Ie={t:"s",v:ie},Je=ae.getAttribute("data-t")||ae.getAttribute("t")||"";ie!=null&&(ie.length==0?Ie.t=Je||"z":h.raw||ie.trim().length==0||Je=="s"||(ie==="TRUE"?Ie={t:"b",v:!0}:ie==="FALSE"?Ie={t:"b",v:!1}:isNaN(en(ie))?isNaN(mn(ie).getDate())||(Ie={t:"d",v:_s(ie)},(Ie=h.cellDates?Ie:{t:"n",v:qr(Ie.v)}).z=h.dateNF||W[14]):Ie={t:"n",v:en(ie)})),Ie.z===void 0&&Ee!=null&&(Ie.z=Ee);var bt="",yt=ae.getElementsByTagName("A");if(yt&&yt.length)for(var it=0;it<yt.length&&(!yt[it].hasAttribute("href")||(bt=yt[it].getAttribute("href")).charAt(0)=="#");++it);bt&&bt.charAt(0)!="#"&&(Ie.l={Target:bt}),h.dense?(r[I+g]||(r[I+g]=[]),r[I+g][Y+b]=Ie):r[bs({c:Y+b,r:I+g})]=Ie,j.e.c<Y+b&&(j.e.c=Y+b),Y+=E}}++I}return T.length&&(r["!merges"]=(r["!merges"]||[]).concat(T)),j.e.r=Math.max(j.e.r,I-1+g),r["!ref"]=Cs(j),y<=I&&(r["!fullref"]=Cs((j.e.r=x.length-q+I-1+g,j))),r}function Mg(r,d){return Cf((d||{}).dense?[]:{},r,d)}function Lg(r){var u,d="",u=(u=r).ownerDocument.defaultView&&typeof u.ownerDocument.defaultView.getComputedStyle=="function"?u.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null;return(d=(d=u?u(r).getPropertyValue("display"):d)||r.style&&r.style.display)==="none"}var Rg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Hd(r,d){var u=d||{},h,g,b,x,y,j=js(r),k=[],E={name:""},T="",_=0,R={},q=[],I=u.dense?[]:{},ee={value:""},Y="",z=0,Z=[],ae=-1,ie=-1,Ee={s:{r:1e6,c:1e7},e:{r:0,c:0}},We=0,Ie={},Je=[],bt={},yt=[],it=1,St=1,Ht=[],zt={Names:[]},Lt={},Ot=["",""],Tt=[],jt={},qt="",Xt=0,ns=!1,Ds=!1,Vt=0;for(cr.lastIndex=0,j=j.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=cr.exec(j);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(Ee.e.c>=Ee.s.c&&Ee.e.r>=Ee.s.r?I["!ref"]=Cs(Ee):I["!ref"]="A1:A1",0<u.sheetRows&&u.sheetRows<=Ee.e.r&&(I["!fullref"]=I["!ref"],Ee.e.r=u.sheetRows-1,I["!ref"]=Cs(Ee)),Je.length&&(I["!merges"]=Je),yt.length&&(I["!rows"]=yt),b.name=b.||b.name,typeof JSON<"u"&&JSON.stringify(b),q.push(b.name),R[b.name]=I,Ds=!1):x[0].charAt(x[0].length-2)!=="/"&&(b=fs(x[0],!1),ae=ie=-1,Ee.s.r=Ee.s.c=1e7,Ee.e.r=Ee.e.c=0,I=u.dense?[]:{},Je=[],yt=[],Ds=!0);break;case"table-row-group":x[1]==="/"?--We:++We;break;case"table-row":case"":if(x[1]==="/"){ae+=it,it=1;break}if((At=fs(x[0],!1)).?ae=At.-1:ae==-1&&(ae=0),(it=+At["number-rows-repeated"]||1)<10)for(Vt=0;Vt<it;++Vt)0<We&&(yt[ae+Vt]={level:We});ie=-1;break;case"covered-table-cell":x[1]!=="/"&&++ie,u.sheetStubs&&(u.dense?(I[ae]||(I[ae]=[]),I[ae][ie]={t:"z"}):I[bs({r:ae,c:ie})]={t:"z"}),Y="",Z=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++ie,ee=fs(x[0],!1),St=parseInt(ee["number-columns-repeated"]||"1",10),y={t:"z",v:null},ee.formula&&u.cellFormula!=0&&(y.f=mc(ws(ee.formula))),(ee.||ee["value-type"])=="string"&&(y.t="s",y.v=ws(ee["string-value"]||""),u.dense?(I[ae]||(I[ae]=[]),I[ae][ie]=y):I[bs({r:ae,c:ie})]=y),ie+=St-1;else if(x[1]!=="/"){Y="",z=0,Z=[],St=1;var At=it?ae+it-1:ae;if(++ie>Ee.e.c&&(Ee.e.c=ie),ie<Ee.s.c&&(Ee.s.c=ie),ae<Ee.s.r&&(Ee.s.r=ae),At>Ee.e.r&&(Ee.e.r=At),Tt=[],jt={},y={t:(ee=fs(x[0],!1)).||ee["value-type"],v:null},u.cellFormula)if(ee.formula&&(ee.formula=ws(ee.formula)),ee["number-matrix-columns-spanned"]&&ee["number-matrix-rows-spanned"]&&(bt={s:{r:ae,c:ie},e:{r:ae+(parseInt(ee["number-matrix-rows-spanned"],10)||0)-1,c:ie+(parseInt(ee["number-matrix-columns-spanned"],10)||0)-1}},y.F=Cs(bt),Ht.push([bt,y.F])),ee.formula)y.f=mc(ee.formula);else for(Vt=0;Vt<Ht.length;++Vt)ae>=Ht[Vt][0].s.r&&ae<=Ht[Vt][0].e.r&&ie>=Ht[Vt][0].s.c&&ie<=Ht[Vt][0].e.c&&(y.F=Ht[Vt][1]);switch((ee["number-columns-spanned"]||ee["number-rows-spanned"])&&(bt={s:{r:ae,c:ie},e:{r:ae+(parseInt(ee["number-rows-spanned"],10)||0)-1,c:ie+(parseInt(ee["number-columns-spanned"],10)||0)-1}},Je.push(bt)),ee["number-columns-repeated"]&&(St=parseInt(ee["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=or(ee["boolean-value"]);break;case"float":case"percentage":case"currency":y.t="n",y.v=parseFloat(ee.value);break;case"date":y.t="d",y.v=_s(ee["date-value"]),u.cellDates||(y.t="n",y.v=qr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=(function(Os){var Zs=0,Pr=0,Me=!1,er=Os.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!er)throw new Error("|"+Os+"| is not an ISO8601 Duration");for(var $s=1;$s!=er.length;++$s)if(er[$s]){switch(Pr=1,3<$s&&(Me=!0),er[$s].slice(er[$s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+er[$s].slice(er[$s].length-1));case"D":Pr*=24;case"H":Pr*=60;case"M":if(!Me)throw new Error("Unsupported ISO Duration Field: M");Pr*=60}Zs+=Pr*parseInt(er[$s],10)}return Zs})(ee["time-value"])/86400,u.cellDates&&(y.t="d",y.v=mi(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(ee.);break;default:if(y.t!=="string"&&y.t!=="text"&&y.t)throw new Error("Unsupported value type "+y.t);y.t="s",ee["string-value"]!=null&&(Y=ws(ee["string-value"]),Z=[])}}else{if(ns=!1,y.t==="s"&&(y.v=Y||"",Z.length&&(y.R=Z),ns=z==0),Lt.Target&&(y.l=Lt),0<Tt.length&&(y.c=Tt,Tt=[]),Y&&u.cellText!==!1&&(y.w=Y),ns&&(y.t="z",delete y.v),(!ns||u.sheetStubs)&&!(u.sheetRows&&u.sheetRows<=ae))for(var gs=0;gs<it;++gs){if(St=parseInt(ee["number-columns-repeated"]||"1",10),u.dense)for(I[ae+gs]||(I[ae+gs]=[]),I[ae+gs][ie]=gs==0?y:vs(y);0<--St;)I[ae+gs][ie+St]=vs(y);else for(I[bs({r:ae+gs,c:ie})]=y;0<--St;)I[bs({r:ae+gs,c:ie+St})]=vs(y);Ee.e.c<=ie&&(Ee.e.c=ie)}ie+=(St=parseInt(ee["number-columns-repeated"]||"1",10))-1,St=0,y={},Y="",Z=[]}Lt={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((h=k.pop())[0]!==x[3])throw"Bad state: "+h}else x[0].charAt(x[0].length-2)!=="/"&&k.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((h=k.pop())[0]!==x[3])throw"Bad state: "+h;jt.t=Y,Z.length&&(jt.R=Z),jt.a=qt,Tt.push(jt)}else x[0].charAt(x[0].length-2)!=="/"&&k.push([x[3],!1]);Y=qt="",z=Xt=0,Z=[];break;case"creator":x[1]==="/"?qt=j.slice(Xt,x.index):Xt=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((h=k.pop())[0]!==x[3])throw"Bad state: "+h}else x[0].charAt(x[0].length-2)!=="/"&&k.push([x[3],!1]);Y="",z=0,Z=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(Ie[E.name]=T,(h=k.pop())[0]!==x[3])throw"Bad state: "+h}else x[0].charAt(x[0].length-2)!=="/"&&(T="",E=fs(x[0],!1),k.push([x[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(k[k.length-1][0]){case"time-style":case"date-style":g=fs(x[0],!1),T+=Rg[x[3]][g.style==="long"?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(k[k.length-1][0]){case"time-style":case"date-style":g=fs(x[0],!1),T+=Rg[x[3]][g.style==="long"?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(k[k.length-1][0]){case"number-style":case"date-style":case"time-style":T+=j.slice(_,x.index)}else _=x.index+x[0].length;break;case"named-range":Ot=Pn((g=fs(x[0],!1))["cell-range-address"]);var Us={Name:g.name,Ref:Ot[0]+"!"+Ot[1]};Ds&&(Us.Sheet=q.length),zt.Names.push(Us);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":if(-1<["master-styles"].indexOf(k[k.length-1][0]))break;x[1]!=="/"||ee&&ee["string-value"]?(fs(x[0],!1),z=x.index+x[0].length):(Us=(Us=j.slice(z,x.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(Os,Zs){return Array(parseInt(Zs,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),Us=[ws(Us.replace(/<[^>]*>/g,""))],Y=(0<Y.length?Y+`
`:"")+Us[0]);break;case"s":break;case"database-range":if(x[1]==="/")break;try{R[(Ot=Pn(fs(x[0])["target-range-address"]))[0]]["!autofilter"]={ref:Ot[1]}}catch{}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if(x[1]!=="/"){if(!(Lt=fs(x[0],!1)).href)break;Lt.Target=ws(Lt.href),delete Lt.href,Lt.Target.charAt(0)=="#"&&-1<Lt.Target.indexOf(".")?(Ot=Pn(Lt.Target.slice(1)),Lt.Target="#"+Ot[0]+"!"+Ot[1]):Lt.Target.match(/^\.\.[\\\/]/)&&(Lt.Target=Lt.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(u.WTF)throw new Error(x)}}return r={Sheets:R,SheetNames:q,Workbook:zt},u.bookSheets&&delete r.Sheets,r}function No(r,d){d=d||{},Br(r,"META-INF/manifest.xml")&&(function(h,g){for(var b,x,y=js(h);b=cr.exec(y);)switch(b[3]){case"manifest":break;case"file-entry":if((x=fs(b[0],!1)).path=="/"&&x.type!==S0)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(g&&g.WTF)throw b}})(zr(r,"META-INF/manifest.xml"),d);var u=La(r,"content.xml");if(!u)throw new Error("Missing content.xml in ODS / UOF file");return d=Hd(Oe(u),d),Br(r,"meta.xml")&&(d.Props=bi(zr(r,"meta.xml"))),d}function Su(r,d){return Hd(r,d)}var Au=(function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),d="<office:document-styles "+Rt({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return hr+d}})(),Eu=(function(){function r(u,h,g){var b=[];b.push('      <table:table table:name="'+Ys(h.SheetNames[g])+`" table:style-name="ta1">
`);var x=0,y=0,j=Ia(u["!ref"]||"A1"),k=u["!merges"]||[],E=0,T=Array.isArray(u);if(u["!cols"])for(y=0;y<=j.e.c;++y)b.push("        <table:table-column"+(u["!cols"][y]?' table:style-name="co'+u["!cols"][y].ods+'"':"")+`></table:table-column>
`);for(var _="",R=u["!rows"]||[],x=0;x<j.s.r;++x)_=R[x]?' table:style-name="ro'+R[x].ods+'"':"",b.push("        <table:table-row"+_+`></table:table-row>
`);for(;x<=j.e.r;++x){for(_=R[x]?' table:style-name="ro'+R[x].ods+'"':"",b.push("        <table:table-row"+_+`>
`),y=0;y<j.s.c;++y)b.push(d);for(;y<=j.e.c;++y){for(var q=!1,I={},ee="",E=0;E!=k.length;++E)if(!(k[E].s.c>y||k[E].s.r>x||k[E].e.c<y||k[E].e.r<x)){k[E].s.c==y&&k[E].s.r==x||(q=!0),I["table:number-columns-spanned"]=k[E].e.c-k[E].s.c+1,I["table:number-rows-spanned"]=k[E].e.r-k[E].s.r+1;break}if(q)b.push(`          <table:covered-table-cell/>
`);else{var Y=bs({r:x,c:y}),z=T?(u[x]||[])[y]:u[Y];if(z&&z.f&&(I["table:formula"]=Ys(("of:="+z.f.replace(bo,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),z.F&&z.F.slice(0,Y.length)==Y&&(Z=Ia(z.F),I["table:number-matrix-columns-spanned"]=Z.e.c-Z.s.c+1,I["table:number-matrix-rows-spanned"]=Z.e.r-Z.s.r+1)),z){switch(z.t){case"b":ee=z.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=z.v?"true":"false";break;case"n":ee=z.w||String(z.v||0),I["office:value-type"]="float",I["office:value"]=z.v||0;break;case"s":case"str":ee=z.v==null?"":z.v,I["office:value-type"]="string";break;case"d":ee=z.w||_s(z.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=_s(z.v).toISOString(),I["table:style-name"]="ce1";break;default:b.push(d);continue}var Z,Y=Ys(ee).replace(/  +/g,function(ie){return'<text:s text:c="'+ie.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");z.l&&z.l.Target&&(Y=Le("text:a",Y,{"xlink:href":(Z=(Z=(Z=z.l.Target).charAt(0)=="#"?"#"+Z.slice(1).replace(/\./,"!"):Z).charAt(0)!="#"&&!Z.match(/^\w+:/)?"../"+Z:Z).replace(/&/g,"&amp;")})),b.push("          "+Le("table:table-cell",Le("text:p",Y,{}),I)+`
`)}else b.push(d)}}b.push(`        </table:table-row>
`)}return b.push(`      </table:table>
`),b.join("")}var d=`          <table:table-cell />
`;return function(u,h){var g=[hr],b=Rt({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=Rt({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(g.push("<office:document"+b+x+`>
`),g.push(Dm().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+b+`>
`),(function(j,k){j.push(` <office:automatic-styles>
`),j.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),j.push(`   <number:month number:style="long"/>
`),j.push(`   <number:text>/</number:text>
`),j.push(`   <number:day number:style="long"/>
`),j.push(`   <number:text>/</number:text>
`),j.push(`   <number:year/>
`),j.push(`  </number:date-style>
`);var E=0;k.SheetNames.map(function(_){return k.Sheets[_]}).forEach(function(_){if(_&&_["!cols"]){for(var R=0;R<_["!cols"].length;++R)if(_["!cols"][R]){var q=_["!cols"][R];if(q.width==null&&q.wpx==null&&q.wch==null)continue;Cl(q),q.ods=E,q=_["!cols"][R].wpx+"px",j.push('  <style:style style:name="co'+E+`" style:family="table-column">
`),j.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+q+`"/>
`),j.push(`  </style:style>
`),++E}}});var T=0;k.SheetNames.map(function(_){return k.Sheets[_]}).forEach(function(_){if(_&&_["!rows"])for(var R,q=0;q<_["!rows"].length;++q)_["!rows"][q]&&(_["!rows"][q].ods=T,R=_["!rows"][q].hpx+"px",j.push('  <style:style style:name="ro'+T+`" style:family="table-row">
`),j.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+R+`"/>
`),j.push(`  </style:style>
`),++T)}),j.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),j.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),j.push(`  </style:style>
`),j.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),j.push(` </office:automatic-styles>
`)})(g,u),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var y=0;y!=u.SheetNames.length;++y)g.push(r(u.Sheets[u.SheetNames[y]],u,y));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),h.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}})();function al(r,d){if(d.bookType=="fods")return Eu(r,d);var u=Yc(),h=[],g=[];return xs(u,"mimetype","application/vnd.oasis.opendocument.spreadsheet"),xs(u,"content.xml",Eu(r,d)),h.push(["content.xml","text/xml"]),g.push(["content.xml","ContentFile"]),xs(u,"styles.xml",Au(r,d)),h.push(["styles.xml","text/xml"]),g.push(["styles.xml","StylesFile"]),xs(u,"meta.xml",hr+Dm()),h.push(["meta.xml","text/xml"]),g.push(["meta.xml","MetadataFile"]),xs(u,"manifest.rdf",(function(b){var x=[hr];x.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var y=0;y!=b.length;++y)x.push(so(b[y][0],b[y][1])),x.push([`  <rdf:Description rdf:about="">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+b[y][0]+`"/>
`,`  </rdf:Description>
`].join(""));return x.push(so("","Document","pkg")),x.push("</rdf:RDF>"),x.join("")})(g)),h.push(["manifest.rdf","application/rdf+xml"]),xs(u,"META-INF/manifest.xml",(function(b){var x=[hr];x.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),x.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var y=0;y<b.length;++y)x.push('  <manifest:file-entry manifest:full-path="'+b[y][0]+'" manifest:media-type="'+b[y][1]+`"/>
`);return x.push("</manifest:manifest>"),x.join("")})(h)),u}function wa(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function ko(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):Oe(me(r))}function Og(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):le(Xe(r))}function nl(r){var d=r.reduce(function(g,b){return g+b.length},0),u=new Uint8Array(d),h=0;return r.forEach(function(g){u.set(g,h),h+=g.length}),u}function Sf(r){return 16843009*((r=(858993459&(r-=r>>1&1431655765))+(r>>2&858993459))+(r>>4)&252645135)>>>24}function Cc(r,d){var u=d?d[0]:0,h=127&r[u];return 128<=r[u++]&&(h|=(127&r[u])<<7,r[u++]<128||(h|=(127&r[u])<<14,r[u++]<128||(h|=(127&r[u])<<21,r[u++]<128||(h+=(127&r[u])*Math.pow(2,28),++u,r[u++]<128||(h+=(127&r[u])*Math.pow(2,35),++u,r[u++]<128||(h+=(127&r[u])*Math.pow(2,42),++u,r[u++])))))),d&&(d[0]=u),h}function Gs(r){var d=new Uint8Array(7);d[0]=127&r;var u=1;return 127<r&&(d[u-1]|=128,d[u]=r>>7&127,++u,r<=16383||(d[u-1]|=128,d[u]=r>>14&127,++u,r<=2097151||(d[u-1]|=128,d[u]=r>>21&127,++u,r<=268435455||(d[u-1]|=128,d[u]=r/256>>>21&127,++u,r<=34359738367||(d[u-1]|=128,d[u]=r/65536>>>21&127,++u,r<=4398046511103||(d[u-1]|=128,d[u]=r/16777216>>>21&127,++u)))))),d.slice(0,u)}function Rr(r){var d=0,u=127&r[0];return 128<=r[d++]&&(u|=(127&r[1])<<7,r[d++]<128||(u|=(127&r[2])<<14,r[d++]<128||(u|=(127&r[3])<<21,r[+d]<128||(u|=(127&r[4])<<28)))),u}function Bs(r){for(var d=[],u=[0];u[0]<r.length;){var h,g=u[0],b=Cc(r,u),x=7&b,y=0;if((b=Math.floor(b/8))==0)break;switch(x){case 0:for(var j=u[0];128<=r[u[0]++];);h=r.slice(j,u[0]);break;case 5:y=4,h=r.slice(u[0],u[0]+y),u[0]+=y;break;case 1:y=8,h=r.slice(u[0],u[0]+y),u[0]+=y;break;case 2:y=Cc(r,u),h=r.slice(u[0],u[0]+y),u[0]+=y;break;default:throw new Error("PB Type ".concat(x," for Field ").concat(b," at offset ").concat(g))}var k={data:h,type:x};d[b]==null?d[b]=[k]:d[b].push(k)}return d}function Or(r){var d=[];return r.forEach(function(u,h){h!=0&&u.forEach(function(g){g.data&&(d.push(Gs(8*h+g.type)),g.type==2&&d.push(Gs(g.data.length)),d.push(g.data))})}),nl(d)}function Du(r,d){return r?.map(function(u){return d(u.data)})||[]}function zn(r){for(var d=[],u=[0];u[0]<r.length;){var h=Cc(r,u),g=Bs(r.slice(u[0],u[0]+h));u[0]+=h;var b={id:Rr(g[1][0].data),messages:[]};g[2].forEach(function(j){var y=Bs(j.data),j=Rr(y[3][0].data);b.messages.push({meta:y,data:r.slice(u[0],u[0]+j)}),u[0]+=j}),(h=g[3])!=null&&h[0]&&(b.merge=0<Rr(g[3][0].data)>>>0),d.push(b)}return d}function il(r){var d=[];return r.forEach(function(u){var h=[[],[{data:Gs(u.id),type:0}],[]];u.merge!=null&&(h[3]=[{data:Gs(+!!u.merge),type:0}]);var g=[];u.messages.forEach(function(b){g.push(b.data),b.meta[3]=[{type:0,data:Gs(b.data.length)}],h[2].push({data:Or(b.meta),type:2})}),u=Or(h),d.push(Gs(u.length)),d.push(u),g.forEach(function(b){return d.push(b)})}),nl(d)}function ln(r){for(var d=[],u=0;u<r.length;){var h=r[u++],g=r[u]|r[u+1]<<8|r[u+2]<<16;u+=3,d.push((function(b,x){if(b!=0)throw new Error("Unexpected Snappy chunk type ".concat(b));for(var y=[0],j=Cc(x,y),k=[];y[0]<x.length;){var E=3&x[y[0]];if(E!=0){var T=0,_=0;if(E==1?(_=4+(x[y[0]]>>2&7),T=(224&x[y[0]++])<<3,T|=x[y[0]++]):(_=1+(x[y[0]++]>>2),E==2?(T=x[y[0]]|x[y[0]+1]<<8,y[0]+=2):(T=(x[y[0]]|x[y[0]+1]<<8|x[y[0]+2]<<16|x[y[0]+3]<<24)>>>0,y[0]+=4)),k=[nl(k)],T==0)throw new Error("Invalid offset 0");if(T>k[0].length)throw new Error("Invalid offset beyond length");if(T<=_)for(k.push(k[0].slice(-T)),_-=T;_>=k[k.length-1].length;)k.push(k[k.length-1]),_-=k[k.length-1].length;k.push(k[0].slice(-T,-T+_))}else E=x[y[0]++]>>2,E<60?++E:(T=E-59,E=x[y[0]],1<T&&(E|=x[y[0]+1]<<8),2<T&&(E|=x[y[0]+2]<<16),3<T&&(E|=x[y[0]+3]<<24),E>>>=0,E++,y[0]+=T),k.push(x.slice(y[0],y[0]+E)),y[0]+=E}if((b=nl(k)).length!=j)throw new Error("Unexpected length: ".concat(b.length," != ").concat(j));return b})(h,r.slice(u,u+g))),u+=g}if(u!==r.length)throw new Error("data is not a valid framed stream!");return nl(d)}function Co(r){for(var d=[],u=0;u<r.length;){var h=Math.min(r.length-u,268435455),g=new Uint8Array(4);d.push(g);var b=Gs(h),x=b.length;d.push(b),h<=60?(x++,d.push(new Uint8Array([h-1<<2]))):h<=256?(x+=2,d.push(new Uint8Array([240,h-1&255]))):h<=65536?(x+=3,d.push(new Uint8Array([244,h-1&255,h-1>>8&255]))):h<=16777216?(x+=4,d.push(new Uint8Array([248,h-1&255,h-1>>8&255,h-1>>16&255]))):h<=4294967296&&(x+=5,d.push(new Uint8Array([252,h-1&255,h-1>>8&255,h-1>>16&255,h-1>>>24&255]))),d.push(r.slice(u,u+h)),x+=h,g[0]=0,g[1]=255&x,g[2]=x>>8&255,g[3]=x>>16&255,u+=h}return nl(d)}function t1(r,d,u){var h,g=wa(r),b=g.getUint32(8,!0),x=12,y=-1,j=-1,k=NaN,E=NaN,T=new Date(2001,0,1);switch(1&b&&(k=(function(_,R){for(var q=(127&_[R+15])<<7|_[R+14]>>1,I=1&_[R+14],ee=R+13;R<=ee;--ee)I=256*I+_[ee];return(128&_[R+15]?-I:I)*Math.pow(10,q-6176)})(r,x),x+=16),2&b&&(E=g.getFloat64(x,!0),x+=8),4&b&&(T.setTime(T.getTime()+1e3*g.getFloat64(x,!0)),x+=8),8&b&&(j=g.getUint32(x,!0),x+=4),16&b&&(y=g.getUint32(x,!0),x+=4),r[1]){case 0:break;case 2:h={t:"n",v:k};break;case 3:h={t:"s",v:d[j]};break;case 5:h={t:"d",v:T};break;case 6:h={t:"b",v:0<E};break;case 7:h={t:"n",v:E/86400};break;case 8:h={t:"e",v:0};break;case 9:if(!(-1<y))throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(31&b," : ").concat(r.slice(0,4)));h={t:"s",v:u[y]};break;case 10:h={t:"n",v:k};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(31&b," : ").concat(r.slice(0,4)))}return h}function So(r,d){var u=new Uint8Array(32),h=wa(u),g=12,b=0;switch(u[0]=5,r.t){case"n":u[1]=2,(function(x,y,j){var k=Math.floor(j==0?0:Math.LOG10E*Math.log(Math.abs(j)))+6176-16,E=j/Math.pow(10,k-6176);x[y+15]|=k>>7,x[y+14]|=(127&k)<<1;for(var T=0;1<=E;++T,E/=256)x[y+T]=255&E;x[y+15]|=0<=j?0:128})(u,g,r.v),b|=1,g+=16;break;case"b":u[1]=6,h.setFloat64(g,r.v?1:0,!0),b|=2,g+=8;break;case"s":if(d.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));u[1]=3,h.setUint32(g,d.indexOf(r.v),!0),b|=8,g+=4;break;default:throw"unsupported cell type "+r.t}return h.setUint32(8,b,!0),u.slice(0,g)}function Af(r,d){var u=new Uint8Array(32),h=wa(u),g=12,b=0;switch(u[0]=3,r.t){case"n":u[2]=2,h.setFloat64(g,r.v,!0),b|=32,g+=8;break;case"b":u[2]=6,h.setFloat64(g,r.v?1:0,!0),b|=32,g+=8;break;case"s":if(d.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));u[2]=3,h.setUint32(g,d.indexOf(r.v),!0),b|=16,g+=4;break;default:throw"unsupported cell type "+r.t}return h.setUint32(4,b,!0),u.slice(0,g)}function Pg(r,d,u){switch(r[0]){case 0:case 1:case 2:case 3:return(function(h,g,b,x){var y,j=wa(h),k=j.getUint32(4,!0),E=(1<x?12:8)+4*Sf(k&(1<x?3470:398)),T=-1,_=-1,R=NaN,q=new Date(2001,0,1);switch(512&k&&(T=j.getUint32(E,!0),E+=4),E+=4*Sf(k&(1<x?12288:4096)),16&k&&(_=j.getUint32(E,!0),E+=4),32&k&&(R=j.getFloat64(E,!0),E+=8),64&k&&(q.setTime(q.getTime()+1e3*j.getFloat64(E,!0)),E+=8),h[2]){case 0:break;case 2:y={t:"n",v:R};break;case 3:y={t:"s",v:g[_]};break;case 5:y={t:"d",v:q};break;case 6:y={t:"b",v:0<R};break;case 7:y={t:"n",v:R/86400};break;case 8:y={t:"e",v:0};break;case 9:if(-1<T)y={t:"s",v:b[T]};else if(-1<_)y={t:"s",v:g[_]};else{if(isNaN(R))throw new Error("Unsupported cell type ".concat(h.slice(0,4)));y={t:"n",v:R}}break;default:throw new Error("Unsupported cell type ".concat(h.slice(0,4)))}return y})(r,d,u,r[0]);case 5:return t1(r,d,u);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function ds(r){return Cc(Bs(r)[1][0].data)}function Tu(r,h){var h=Bs(h.data),u=Rr(h[1][0].data),h=h[3],g=[];return(h||[]).forEach(function(b){var x=Bs(b.data),y=Rr(x[1][0].data)>>>0;switch(u){case 1:g[y]=ko(x[3][0].data);break;case 8:var k=Bs(r[ds(x[9][0].data)][0].data),j=r[ds(k[1][0].data)][0],k=Rr(j.meta[1][0].data);if(k!=2001)throw new Error("2000 unexpected reference to ".concat(k));j=Bs(j.data),g[y]=j[3].map(function(E){return ko(E.data)}).join("")}}),g}function _u(r,g){var u=Bs(g.data),h=(g=u?.[7])!=null&&g[0]?0<Rr(u[7][0].data)>>>0?1:0:-1,g=Du(u[5],function(b){return(function(x,y){var j,k,E,T=Bs(x),_=Rr(T[1][0].data)>>>0,R=Rr(T[2][0].data)>>>0,q=((x=(q=T[8])==null?void 0:q[0])==null?void 0:x.data)&&0<Rr(T[8][0].data)||!1;if((x=(x=T[7])==null?void 0:x[0])!=null&&x.data&&y!=0)k=(j=(j=T[7])==null?void 0:j[0])==null?void 0:j.data,E=(j=(j=T[6])==null?void 0:j[0])==null?void 0:j.data;else{if((j=(j=T[4])==null?void 0:j[0])==null||!j.data||y==1)throw"NUMBERS Tile missing ".concat(y," cell storage");k=(y=(y=T[4])==null?void 0:y[0])==null?void 0:y.data,E=(T=(T=T[3])==null?void 0:T[0])==null?void 0:T.data}for(var I=q?4:1,ee=wa(k),Y=[],z=0;z<k.length/2;++z){var Z=ee.getUint16(2*z,!0);Z<65535&&Y.push([z,Z])}if(Y.length!=R)throw"Expected ".concat(R," cells, found ").concat(Y.length);for(var ae=[],z=0;z<Y.length-1;++z)ae[Y[z][0]]=E.subarray(Y[z][1]*I,Y[z+1][1]*I);return 1<=Y.length&&(ae[Y[Y.length-1][0]]=E.subarray(Y[Y.length-1][1]*I)),{R:_,cells:ae}})(b,h)});return{nrows:Rr(u[4][0].data)>>>0,data:g.reduce(function(b,x){return b[x.R]||(b[x.R]=[]),x.cells.forEach(function(y,j){if(b[x.R][j])throw new Error("Duplicate cell r=".concat(x.R," c=").concat(j));b[x.R][j]=y}),b},[])}}function Ef(r,g){var u={"!ref":"A1"},h=r[ds(Bs(g.data)[2][0].data)],g=Rr(h[0].meta[1][0].data);if(g!=6001)throw new Error("6000 unexpected reference to ".concat(g));return(function(b,j,y){var T=Bs(j.data);if((j={s:{r:0,c:0},e:{r:0,c:0}}).e.r=(Rr(T[6][0].data)>>>0)-1,j.e.r<0)throw new Error("Invalid row varint ".concat(T[6][0].data));if(j.e.c=(Rr(T[7][0].data)>>>0)-1,j.e.c<0)throw new Error("Invalid col varint ".concat(T[7][0].data));y["!ref"]=Cs(j);var j=Bs(T[4][0].data),k=Tu(b,b[ds(j[4][0].data)][0]),E=(T=j[17])!=null&&T[0]?Tu(b,b[ds(j[17][0].data)][0]):[],T=Bs(j[3][0].data),_=0;if(T[1].forEach(function(q){var I=Bs(q.data),q=b[ds(I[2][0].data)][0],I=Rr(q.meta[1][0].data);if(I!=6002)throw new Error("6001 unexpected reference to ".concat(I));q=_u(0,q),q.data.forEach(function(ee,Y){ee.forEach(function(z,Z){Z=bs({r:_+Y,c:Z}),z=Pg(z,k,E),z&&(y[Z]=z)})}),_+=q.nrows}),(T=j[13])!=null&&T[0]){if(T=b[ds(j[13][0].data)][0],j=Rr(T.meta[1][0].data),j!=6144)throw new Error("Expected merge type 6144, found ".concat(j));y["!merges"]=(T=Bs(T.data))==null?void 0:T[1].map(function(q){var I=Bs(q.data),q=wa(Bs(I[1][0].data)[1][0].data),I=wa(Bs(I[2][0].data)[1][0].data);return{s:{r:q.getUint16(0,!0),c:q.getUint16(2,!0)},e:{r:q.getUint16(0,!0)+I.getUint16(0,!0)-1,c:q.getUint16(2,!0)+I.getUint16(2,!0)-1}}})}})(r,h[0],u),u}function Ig(r,d){var u=If(),h=Bs(d.data);if((d=h[2])!=null&&d[0])throw new Error("Keynote presentations are not supported");if(Du(h[1],ds).forEach(function(g){r[g].forEach(function(b){var x,y,j,k;Rr(b.meta[1][0].data)==2&&(y=r,b=Bs((j=b).data),k={name:(j=b[1])!=null&&j[0]?ko(b[1][0].data):"",sheets:[]},Du(b[2],ds).forEach(function(E){y[E].forEach(function(T){Rr(T.meta[1][0].data)==6e3&&k.sheets.push(Ef(y,T))})}),(x=k).sheets.forEach(function(E,T){Uu(u,E,T==0?x.name:x.name+"_"+T,!0)}))})}),u.SheetNames.length==0)throw new Error("Empty NUMBERS file");return u}function Fu(r){var d={},u=[];if(r.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var b,x;try{b=ln(g.content)}catch(y){return console.log("?? "+g.content.length+" "+(y.message||y))}try{x=zn(b)}catch(y){return console.log("## "+(y.message||y))}x.forEach(function(y){d[y.id]=y.messages,u.push(y.id)})}}),!u.length)throw new Error("File has no messages");if((r=(r=(r=(r=d?.[1])==null?void 0:r[0])==null?void 0:r.meta)==null?void 0:r[1])!=null&&r[0].data&&Rr(d[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var h=((r=(r=(r=(r=d?.[1])==null?void 0:r[0])==null?void 0:r.meta)==null?void 0:r[1])==null?void 0:r[0].data)&&Rr(d[1][0].meta[1][0].data)==1&&d[1][0];if(h||u.forEach(function(g){d[g].forEach(function(b){if(Rr(b.meta[1][0].data)>>>0==1){if(h)throw new Error("Document has multiple roots");h=b}})}),!h)throw new Error("Cannot find Document root");return Ig(d,h)}function Vd(r,d){if(!d||!d.numbers)throw new Error("Must pass a `numbers` option -- check the README");var u=r.Sheets[r.SheetNames[0]];1<r.SheetNames.length&&console.error("The Numbers writer currently writes only the first table");var h=Ia(u["!ref"]);h.s.r=h.s.c=0;var g=!1;9<h.e.c&&(g=!0,h.e.c=9),49<h.e.r&&(g=!0,h.e.r=49),g&&console.error("The Numbers writer is currently limited to ".concat(Cs(h)));var b=Pu(u,{range:h,header:1}),x=["~Sh33tJ5~"];b.forEach(function(Lt){return Lt.forEach(function(Ot){typeof Ot=="string"&&x.push(Ot)})});var y={},j=[],k=es.read(d.numbers,{type:"base64"});k.FileIndex.map(function(Lt,Ot){return[Lt,k.FullPaths[Ot]]}).forEach(function(Lt){var Ot=Lt[0],Tt=Lt[1];Ot.type==2&&Ot.name.match(/\.iwa/)&&zn(ln(Ot.content)).forEach(function(jt){j.push(jt.id),y[jt.id]={deps:[],location:Tt,type:Rr(jt.messages[0].meta[1][0].data)}})}),j.sort(function(Lt,Ot){return Lt-Ot});var E=j.filter(function(Lt){return 1<Lt}).map(function(Lt){return[Lt,Gs(Lt)]});k.FileIndex.map(function(Lt,Ot){return[Lt,k.FullPaths[Ot]]}).forEach(function(Lt){var Ot=Lt[0];Lt[1],Ot.name.match(/\.iwa/)&&zn(ln(Ot.content)).forEach(function(Tt){Tt.messages.forEach(function(jt){E.forEach(function(qt){Tt.messages.some(function(Xt){return Rr(Xt.meta[1][0].data)!=11006&&(function(ns,Ds){e:for(var Vt=0;Vt<=ns.length-Ds.length;++Vt){for(var At=0;At<Ds.length;++At)if(ns[Vt+At]!=Ds[At])continue e;return!0}return!1})(Xt.data,qt[1])})&&y[qt[0]].deps.push(Tt.id)})})})});for(var T,_=es.find(k,y[1].location),R=zn(ln(_.content)),q=0;q<R.length;++q){var I=R[q];I.id==1&&(T=I)}for(var ee=ds(Bs(T.messages[0].data)[1][0].data),R=zn(ln((_=es.find(k,y[ee].location)).content)),q=0;q<R.length;++q)(I=R[q]).id==ee&&(T=I);var bt=Bs(T.messages[0].data);for(bt[1]=[{type:2,data:Og(r.SheetNames[0])}],T.messages[0].data=Or(bt),_.content=Co(il(R)),_.size=_.content.length,ee=ds(bt[2][0].data),R=zn(ln((_=es.find(k,y[ee].location)).content)),q=0;q<R.length;++q)(I=R[q]).id==ee&&(T=I);for(ee=ds(Bs(T.messages[0].data)[2][0].data),R=zn(ln((_=es.find(k,y[ee].location)).content)),q=0;q<R.length;++q)(I=R[q]).id==ee&&(T=I);g=Bs(T.messages[0].data),g[6][0].data=Gs(h.e.r+1),g[7][0].data=Gs(h.e.c+1);for(var Y=ds(g[46][0].data),d=es.find(k,y[Y].location),z=zn(ln(d.content)),Z=0;Z<z.length&&z[Z].id!=Y;++Z);if(z[Z].id!=Y)throw"Bad ColumnRowUIDMapArchive";var ae=Bs(z[Z].messages[0].data);ae[1]=[],ae[2]=[],ae[3]=[];for(var ie=0;ie<=h.e.c;++ie)ae[1].push({type:2,data:Or([[],[{type:0,data:Gs(ie+420690)}],[{type:0,data:Gs(ie+420690)}]])}),ae[2].push({type:0,data:Gs(ie)}),ae[3].push({type:0,data:Gs(ie)});ae[4]=[],ae[5]=[],ae[6]=[];for(var Ee=0;Ee<=h.e.r;++Ee)ae[4].push({type:2,data:Or([[],[{type:0,data:Gs(Ee+726270)}],[{type:0,data:Gs(Ee+726270)}]])}),ae[5].push({type:0,data:Gs(Ee)}),ae[6].push({type:0,data:Gs(Ee)});if(z[Z].messages[0].data=Or(ae),d.content=Co(il(z)),d.size=d.content.length,delete g[46],r=Bs(g[4][0].data),r[7][0].data=Gs(h.e.r+1),bt=ds(Bs(r[1][0].data)[2][0].data),(z=zn(ln((d=es.find(k,y[bt].location)).content)))[0].id!=bt)throw"Bad HeaderStorageBucket";for(var We=Bs(z[0].messages[0].data),Ee=0;Ee<b.length;++Ee){var Ie=Bs(We[2][0].data);Ie[1][0].data=Gs(Ee),Ie[4][0].data=Gs(b[Ee].length),We[2][Ee]={type:We[2][0].type,data:Or(Ie)}}z[0].messages[0].data=Or(We),d.content=Co(il(z)),d.size=d.content.length;var Je,bt=ds(r[2][0].data);if((z=zn(ln((d=es.find(k,y[bt].location)).content)))[0].id!=bt)throw"Bad HeaderStorageBucket";for(We=Bs(z[0].messages[0].data),ie=0;ie<=h.e.c;++ie)(Ie=Bs(We[2][0].data))[1][0].data=Gs(ie),Ie[4][0].data=Gs(h.e.r+1),We[2][ie]={type:We[2][0].type,data:Or(Ie)};z[0].messages[0].data=Or(We),d.content=Co(il(z)),d.size=d.content.length,u["!merges"]&&(Ht=(function(Lt){for(var Ot=927262;Ot<2e6;++Ot)if(!y[Ot])return y[Ot]=Lt,Ot;throw new Error("Too many messages")})({type:6144,deps:[ee],location:y[ee].location}),Je=[[],[]],u["!merges"].forEach(function(Lt){Je[1].push({type:2,data:Or([[],[{type:2,data:Or([[],[{type:5,data:new Uint8Array(new Uint16Array([Lt.s.r,Lt.s.c]).buffer)}]])}],[{type:2,data:Or([[],[{type:5,data:new Uint8Array(new Uint16Array([Lt.e.r-Lt.s.r+1,Lt.e.c-Lt.s.c+1]).buffer)}]])}]])})}),r[13]=[{type:2,data:Or([[],[{type:0,data:Gs(Ht)}]])}],R.push({id:Ht,messages:[(St=6144,Ht=Or(Je),{meta:[[],[{type:0,data:Gs(St)}]],data:Ht})]}));var yt=ds(r[4][0].data);(function(){for(var Lt,Ot=es.find(k,y[yt].location),Tt=zn(ln(Ot.content)),jt=0;jt<Tt.length;++jt){var qt=Tt[jt];qt.id==yt&&(Lt=qt)}var Xt=Bs(Lt.messages[0].data);Xt[3]=[],x.forEach(function(ns,Ds){Xt[3].push({type:2,data:Or([[],[{type:0,data:Gs(Ds)}],[{type:0,data:Gs(1)}],[{type:2,data:Og(ns)}]])})}),Lt.messages[0].data=Or(Xt),Ot.content=Co(il(Tt)),Ot.size=Ot.content.length})();var it=Bs(r[3][0].data),St=it[1][0];delete it[2];var St,Ht,Ht=Bs(St.data),zt=ds(Ht[2][0].data);return(function(){for(var Lt,Ot=es.find(k,y[zt].location),Tt=zn(ln(Ot.content)),jt=0;jt<Tt.length;++jt){var qt=Tt[jt];qt.id==zt&&(Lt=qt)}var Xt=Bs(Lt.messages[0].data);delete Xt[6],delete it[7];var ns=new Uint8Array(Xt[5][0].data);Xt[5]=[];for(var Ds=0,Vt=0;Vt<=h.e.r;++Vt){var At=Bs(ns);Ds+=(function(gs,Us,Os){var Zs,Pr;if((Zs=gs[6])==null||!Zs[0]||(Pr=gs[7])==null||!Pr[0])throw"Mutation only works on post-BNC storages!";if((Pr=(Pr=gs[8])==null?void 0:Pr[0])!=null&&Pr.data&&0<Rr(gs[8][0].data))throw"Math only works with normal offsets";for(var Me,er,$s=0,ha=wa(gs[7][0].data),Un=0,he=[],ot=wa(gs[4][0].data),Te=0,at=[],Ae=0;Ae<Us.length;++Ae)if(Us[Ae]!=null){switch(ha.setUint16(2*Ae,Un,!0),ot.setUint16(2*Ae,Te,!0),typeof Us[Ae]){case"string":Me=So({t:"s",v:Us[Ae]},Os),er=Af({t:"s",v:Us[Ae]},Os);break;case"number":Me=So({t:"n",v:Us[Ae]},Os),er=Af({t:"n",v:Us[Ae]},Os);break;case"boolean":Me=So({t:"b",v:Us[Ae]},Os),er=Af({t:"b",v:Us[Ae]},Os);break;default:throw new Error("Unsupported value "+Us[Ae])}he.push(Me),Un+=Me.length,at.push(er),Te+=er.length,++$s}else ha.setUint16(2*Ae,65535,!0),ot.setUint16(2*Ae,65535);for(gs[2][0].data=Gs($s);Ae<gs[7][0].data.length/2;++Ae)ha.setUint16(2*Ae,65535,!0),ot.setUint16(2*Ae,65535,!0);return gs[6][0].data=nl(he),gs[3][0].data=nl(at),$s})(At,b[Vt],x),At[1][0].data=Gs(Vt),Xt[5].push({data:Or(At),type:2})}Xt[1]=[{type:0,data:Gs(h.e.c+1)}],Xt[2]=[{type:0,data:Gs(h.e.r+1)}],Xt[3]=[{type:0,data:Gs(Ds)}],Xt[4]=[{type:0,data:Gs(h.e.r+1)}],Lt.messages[0].data=Or(Xt),Ot.content=Co(il(Tt)),Ot.size=Ot.content.length})(),St.data=Or(Ht),r[3][0].data=Or(it),g[4][0].data=Or(r),T.messages[0].data=Or(g),_.content=Co(il(R)),_.size=_.content.length,k}function Wd(r){return function(d){for(var u=0;u!=r.length;++u){var h=r[u];d[h[0]]===void 0&&(d[h[0]]=h[1]),h[2]==="n"&&(d[h[0]]=Number(d[h[0]]))}}}function Df(r){Wd([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function Mu(r){Wd([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function s1(r,d){if(!r)return 0;try{r=d.map(function(u){return u.id||(u.id=u.strRelID),[u.name,r["!id"][u.id].Target,(u=r["!id"][u.id].Type,-1<ks.WS.indexOf(u)?"sheet":ks.CS&&u==ks.CS?"chart":ks.DS&&u==ks.DS?"dialog":ks.MS&&u==ks.MS?"macro":u&&u.length?u:"sheet")]})}catch{return null}return r&&r.length!==0?r:null}function r1(r,d,u,h,g,b,x,y,j,k,E,T){try{b[h]=to(La(r,u,!0),d);var _=zr(r,d);switch(y){case"sheet":I=xu(_,d,g,j,b[h],k,E,T);break;case"chart":if(!(I=vg(_,d,g,j,b[h],k))||!I["!drawel"])break;var q=hl(I["!drawel"].Target,d),R=xl(q),z=hl((z=La(r,q,!0),R=to(La(r,R,!0),q),z?(z=(z.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],R["!id"][z].Target):"??"),q),q=xl(z),I=yr(La(r,z,!0),0,0,to(La(r,q,!0),z),0,I);break;case"macro":Y=d,b[h],Y.slice(-4),I={"!type":"macro"};break;case"dialog":Y=d,b[h],Y.slice(-4),I={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+y)}x[h]=I;var ee=[];b&&b[h]&&is(b[h]).forEach(function(Z){var ae,ie,Ee,We,Ie,Je,bt="";if(b[h][Z].Type==ks.CMNT){bt=hl(b[h][Z].Target,d);var yt=_l(zr(r,bt,!0),bt,j);if(!yt||!yt.length)return;sf(I,yt,!1)}b[h][Z].Type==ks.TCMNT&&(bt=hl(b[h][Z].Target,d),ee=ee.concat((ae=zr(r,bt,!0),ie=j,We=!(Ee=[]),Ie={},Je=0,ae.replace(Fr,function(it,St){var Ht=fs(it);switch(Tn(Ht[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":Ie={author:Ht.personId,guid:Ht.id,ref:Ht.ref,T:1};break;case"</threadedComment>":Ie.t!=null&&Ee.push(Ie);break;case"<text>":case"<text":Je=St+it.length;break;case"</text>":Ie.t=ae.slice(Je,St).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":We=!0;break;case"</mentions>":We=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":We=!0;break;case"</ext>":We=!1;break;default:if(!We&&ie.WTF)throw new Error("unrecognized "+Ht[0]+" in threaded comments")}return it}),Ee)))}),ee&&ee.length&&sf(I,ee,!0,j.people||[])}catch(Z){if(j.WTF)throw Z}var Y,z}function En(r){return r.charAt(0)=="/"?r.slice(1):r}function Tf(r,d){if(Hl(),Df(d=d||{}),Br(r,"META-INF/manifest.xml")||Br(r,"objectdata.xml"))return No(r,d);if(Br(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(r.FileIndex)return Fu(r);var u=es.utils.cfb_new();return gi(r).forEach(function(Tt){xs(u,Tt,(function(qt,Xt,ns){return ga(kr(qt,Xt))})(r,Tt))}),Fu(u)}if(!Br(r,"[Content_Types].xml"))throw Br(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Br(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var h,g,b=gi(r),x=(function(Tt){var jt=pl();if(!Tt||!Tt.match)return jt;var qt={};if((Tt.match(Fr)||[]).forEach(function(Xt){var ns=fs(Xt);switch(ns[0].replace(Gn,"<")){case"<?xml":break;case"<Types":jt.xmlns=ns["xmlns"+(ns[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":qt[ns.Extension]=ns.ContentType;break;case"<Override":jt[Qo[ns.ContentType]]!==void 0&&jt[Qo[ns.ContentType]].push(ns.PartName)}}),jt.xmlns!==hs.CT)throw new Error("Unknown Namespace: "+jt.xmlns);return jt.calcchain=0<jt.calcchains.length?jt.calcchains[0]:"",jt.sst=0<jt.strs.length?jt.strs[0]:"",jt.style=0<jt.styles.length?jt.styles[0]:"",jt.defaults=qt,delete jt.calcchains,jt})(La(r,"[Content_Types].xml")),Ie=!1;if(x.workbooks.length===0&&zr(r,g="xl/workbook.xml",!0)&&x.workbooks.push(g),x.workbooks.length===0){if(!zr(r,g="xl/workbook.bin",!0))throw new Error("Could not find workbook");x.workbooks.push(g),Ie=!0}x.workbooks[0].slice(-3)=="bin"&&(Ie=!0);var y={},j={};if(!d.bookSheets&&!d.bookProps){if(gc=[],x.sst)try{gc=yu(zr(r,En(x.sst)),x.sst,d)}catch(Tt){if(d.WTF)throw Tt}d.cellStyles&&x.themes.length&&(q=La(r,x.themes[0].replace(/^\//,""),!0)||"",x.themes[0],y=Sl(q,d)),x.style&&(j=bu(zr(r,En(x.style)),x.style,y,d))}x.links.map(function(Tt){try{return to(La(r,xl(En(Tt))),Tt),Fl(zr(r,En(Tt)),0,Tt,d)}catch{}});var k,E,T,_=yf(zr(r,En(x.workbooks[0])),x.workbooks[0],d),R={},q="";x.coreprops.length&&((q=zr(r,En(x.coreprops[0]),!0))&&(R=bi(q)),x.extprops.length!==0&&(q=zr(r,En(x.extprops[0]),!0))&&(I=d,T={},E=(E=R)||{},k=Oe(k=q),bn.forEach(function(Tt){var jt=(k.match(He(Tt[0]))||[])[1];switch(Tt[2]){case"string":jt&&(E[Tt[1]]=ws(jt));break;case"bool":E[Tt[1]]=jt==="true";break;case"raw":var qt=k.match(new RegExp("<"+Tt[0]+"[^>]*>([\\s\\S]*?)</"+Tt[0]+">"));qt&&0<qt.length&&(T[Tt[1]]=qt[1])}}),T.HeadingPairs&&T.TitlesOfParts&&wh(T.HeadingPairs,T.TitlesOfParts,E,I)));var I={};d.bookSheets&&!d.bookProps||x.custprops.length!==0&&(q=La(r,En(x.custprops[0]),!0))&&(I=(function(Tt,jt){var qt={},Xt="",ns=Tt.match(Tm);if(ns)for(var Ds=0;Ds!=ns.length;++Ds){var Vt=ns[Ds],At=fs(Vt);switch(At[0]){case"<?xml":case"<Properties":break;case"<property":Xt=ws(At.name);break;case"</property>":Xt=null;break;default:if(Vt.indexOf("<vt:")===0){var gs=Vt.split(">"),Us=gs[0].slice(4),Os=gs[1];switch(Us){case"lpstr":case"bstr":case"lpwstr":qt[Xt]=ws(Os);break;case"bool":qt[Xt]=or(Os);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":qt[Xt]=parseInt(Os,10);break;case"r4":case"r8":case"decimal":qt[Xt]=parseFloat(Os);break;case"filetime":case"date":qt[Xt]=_s(Os);break;case"cy":case"error":qt[Xt]=ws(Os);break;default:if(Us.slice(-1)=="/")break;jt.WTF&&typeof console<"u"&&console.warn("Unexpected",Vt,Us,gs)}}else if(Vt.slice(0,2)!=="</"&&jt.WTF)throw new Error(Vt)}}return qt})(q,d));var ee={};if((d.bookSheets||d.bookProps)&&(_.Sheets?h=_.Sheets.map(function(Tt){return Tt.name}):R.Worksheets&&0<R.SheetNames.length&&(h=R.SheetNames),d.bookProps&&(ee.Props=R,ee.Custprops=I),d.bookSheets&&h!==void 0&&(ee.SheetNames=h),d.bookSheets?ee.SheetNames:d.bookProps))return ee;h={},q={},d.bookDeps&&x.calcchain&&(q=ua(zr(r,En(x.calcchain)),x.calcchain));var Y,z,Z=0,ae={},ie=_.Sheets;R.Worksheets=ie.length,R.SheetNames=[];for(var Ee=0;Ee!=ie.length;++Ee)R.SheetNames[Ee]=ie[Ee].name;var We=Ie?"bin":"xml",Ie=x.workbooks[0].lastIndexOf("/"),Je=(x.workbooks[0].slice(0,Ie+1)+"_rels/"+x.workbooks[0].slice(Ie+1)+".rels").replace(/^\//,"");Br(r,Je)||(Je="xl/_rels/workbook."+We+".rels");var bt,yt,it,St=to(La(r,Je,!0),Je.replace(/_rels.*/,"s5s"));1<=(x.metadata||[]).length&&(d.xlmeta=jc(zr(r,En(x.metadata[0])),x.metadata[0],d)),1<=(x.people||[]).length&&(d.people=(Ie=zr(r,En(x.people[0])),bt=d,it=!(yt=[]),Ie.replace(Fr,function(Tt){var jt=fs(Tt);switch(Tn(jt[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":yt.push({name:jt.displayname,id:jt.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":it=!0;break;case"</ext>":it=!1;break;default:if(!it&&bt.WTF)throw new Error("unrecognized "+jt[0]+" in threaded comments")}return Tt}),yt)),St=St&&s1(St,_.Sheets);var Ht=zr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(Z=0;Z!=R.Worksheets;++Z){var zt="sheet";if(St&&St[Z]?(Y="xl/"+St[Z][1].replace(/[\/]?xl\//,""),Br(r,Y)||(Y=St[Z][1]),Br(r,Y)||(Y=Je.replace(/_rels\/.*$/,"")+St[Z][1]),zt=St[Z][2]):Y=(Y="xl/worksheets/sheet"+(Z+1-Ht)+"."+We).replace(/sheet0\./,"sheet."),z=Y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),d&&d.sheets!=null)switch(typeof d.sheets){case"number":if(Z!=d.sheets)continue e;break;case"string":if(R.SheetNames[Z].toLowerCase()!=d.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(d.sheets)){for(var Lt=!1,Ot=0;Ot!=d.sheets.length;++Ot)typeof d.sheets[Ot]=="number"&&d.sheets[Ot]==Z&&(Lt=1),typeof d.sheets[Ot]=="string"&&d.sheets[Ot].toLowerCase()==R.SheetNames[Z].toLowerCase()&&(Lt=1);if(!Lt)continue e}}r1(r,Y,z,R.SheetNames[Z],Z,ae,h,zt,d,_,y,j)}return ee={Directory:x,Workbook:_,Props:R,Custprops:I,Deps:q,Sheets:h,SheetNames:R.SheetNames,Strings:gc,Styles:j,Themes:y,SSF:vs(W)},d&&d.bookFiles&&(r.files?(ee.keys=b,ee.files=r.files):(ee.keys=[],ee.files={},r.FullPaths.forEach(function(Tt,jt){Tt=Tt.replace(/^Root Entry[\/]/,""),ee.keys.push(Tt),ee.files[Tt]=r.FileIndex[jt]}))),d&&d.bookVBA&&(0<x.vba.length?ee.vbaraw=zr(r,En(x.vba[0]),!0):x.defaults&&x.defaults.bin===ia&&(ee.vbaraw=zr(r,"xl/vbaProject.bin",!0))),ee}function mr(r,d){var u,h=d||{},g="Workbook",b=es.find(r,g);try{if(g="/!DataSpaces/Version",!(b=es.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(x=b.content,(u={}).id=x.read_shift(0,"lpp4"),u.R=ri(x,4),u.U=ri(x,4),u.W=ri(x,4),g="/!DataSpaces/DataSpaceMap",!(b=es.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);var x=Ph(b.content);if(x.length!==1||x[0].comps.length!==1||x[0].comps[0].t!==0||x[0].name!=="StrongEncryptionDataSpace"||x[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+g);if(g="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(b=es.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(x=(function(y){var j=[];y.l+=4;for(var k=y.read_shift(4);0<k--;)j.push(y.read_shift(0,"lpp4"));return j})(b.content),x.length!=1||x[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+g);if(g="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(b=es.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);Bm(b.content)}catch{}if(g="/EncryptionInfo",!(b=es.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(d=zm(b.content),g="/EncryptedPackage",!(b=es.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],b.content,h.password||"",h);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],b.content,h.password||"",h);throw new Error("File is password-protected")}function _f(r,d){return(d.bookType=="ods"?al:d.bookType=="numbers"?Vd:d.bookType=="xlsb"?function(u,h){Al=1024,u&&!u.SSF&&(u.SSF=vs(W)),u&&u.SSF&&(Hl(),Io(u.SSF),h.revssf=ql(u.SSF),h.revssf[u.SSF[65535]]=0,h.ssf=u.SSF),h.rels={},h.wbrels={},h.Strings=[],h.Strings.Count=0,h.Strings.Unique=0,pc?h.revStrings=new Map:(h.revStrings={},h.revStrings.foo=[],delete h.revStrings.foo);var g=h.bookType=="xlsb"?"bin":"xml",b=-1<ya.indexOf(h.bookType),x=pl();Mu(h=h||{});var y=Yc(),j="",k=0;if(h.cellXfs=[],Ji(h.cellXfs,{},{revssf:{General:0}}),u.Props||(u.Props={}),xs(y,j="docProps/core.xml",ad(u.Props,h)),x.coreprops.push(j),rr(h.rels,2,j,ks.CORE_PROPS),j="docProps/app.xml",!u.Props||!u.Props.SheetNames)if(u.Workbook&&u.Workbook.Sheets){for(var E=[],T=0;T<u.SheetNames.length;++T)(u.Workbook.Sheets[T]||{}).Hidden!=2&&E.push(u.SheetNames[T]);u.Props.SheetNames=E}else u.Props.SheetNames=u.SheetNames;for(u.Props.Worksheets=u.Props.SheetNames.length,xs(y,j,D0(u.Props)),x.extprops.push(j),rr(h.rels,3,j,ks.EXT_PROPS),u.Custprops!==u.Props&&0<is(u.Custprops||{}).length&&(xs(y,j="docProps/custom.xml",yn(u.Custprops)),x.custprops.push(j),rr(h.rels,4,j,ks.CUST_PROPS)),k=1;k<=u.SheetNames.length;++k){var _,R,q,I={"!id":{}},ee=u.Sheets[u.SheetNames[k-1]];xs(y,j="xl/worksheets/sheet"+k+"."+g,(function(Y,z,Z,ae,ie){return(z.slice(-4)===".bin"?sr:fu)(Y,Z,ae,ie)})(k-1,j,h,u,I)),x.sheets.push(j),rr(h.wbrels,-1,"worksheets/sheet"+k+"."+g,ks.WS[0]),ee&&(_=ee["!comments"],R=!1,q="",_&&0<_.length&&(xs(y,q="xl/comments"+k+"."+g,(function(Y,z,Z){return(z.slice(-4)===".bin"?rf:ng)(Y)})(_,q)),x.comments.push(q),rr(I,-1,"../comments"+k+"."+g,ks.CMNT),R=!0),ee["!legacy"]&&R&&xs(y,"xl/drawings/vmlDrawing"+k+".vml",tf(k,ee["!comments"])),delete ee["!comments"],delete ee["!legacy"]),I["!id"].rId1&&xs(y,xl(j),Rn(I))}return h.Strings!=null&&0<h.Strings.length&&(xs(y,j="xl/sharedStrings."+g,(function(Y,z,Z){return(z.slice(-4)===".bin"?Qi:xd)(Y,Z)})(h.Strings,j,h)),x.strs.push(j),rr(h.wbrels,-1,"sharedStrings."+g,ks.SST)),xs(y,j="xl/workbook."+g,(function(Y,z,Z){return(z.slice(-4)===".bin"?nn:pu)(Y)})(u,j)),x.workbooks.push(j),rr(h.rels,1,j,ks.WB),xs(y,j="xl/theme/theme1.xml",su(u.Themes,h)),x.themes.push(j),rr(h.wbrels,-1,"theme/theme1.xml",ks.THEME),xs(y,j="xl/styles."+g,(function(Y,z,Z){return(z.slice(-4)===".bin"?Jm:Kh)(Y,Z)})(u,j,h)),x.styles.push(j),rr(h.wbrels,-1,"styles."+g,ks.STY),u.vbaraw&&b&&(xs(y,j="xl/vbaProject.bin",u.vbaraw),x.vba.push(j),rr(h.wbrels,-1,"vbaProject.bin",ks.VBA)),xs(y,j="xl/metadata."+g,(function(Y){return(Y.slice(-4)===".bin"?ru:ef)()})(j)),x.metadata.push(j),rr(h.wbrels,-1,"metadata."+g,ks.XLMETA),xs(y,"[Content_Types].xml",C0(x,h)),xs(y,"_rels/.rels",Rn(h.rels)),xs(y,"xl/_rels/workbook."+g+".rels",Rn(h.wbrels)),delete h.revssf,delete h.ssf,y}:ja)(r,d)}function ja(r,d){Al=1024,r&&!r.SSF&&(r.SSF=vs(W)),r&&r.SSF&&(Hl(),Io(r.SSF),d.revssf=ql(r.SSF),d.revssf[r.SSF[65535]]=0,d.ssf=r.SSF),d.rels={},d.wbrels={},d.Strings=[],d.Strings.Count=0,d.Strings.Unique=0,pc?d.revStrings=new Map:(d.revStrings={},d.revStrings.foo=[],delete d.revStrings.foo);var u="xml",h=-1<ya.indexOf(d.bookType),g=pl();Mu(d=d||{});var b=Yc(),x="",y=0;if(d.cellXfs=[],Ji(d.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),x="docProps/core.xml",xs(b,x,ad(r.Props,d)),g.coreprops.push(x),rr(d.rels,2,x,ks.CORE_PROPS),x="docProps/app.xml",!r.Props||!r.Props.SheetNames)if(r.Workbook&&r.Workbook.Sheets){for(var j=[],k=0;k<r.SheetNames.length;++k)(r.Workbook.Sheets[k]||{}).Hidden!=2&&j.push(r.SheetNames[k]);r.Props.SheetNames=j}else r.Props.SheetNames=r.SheetNames;r.Props.Worksheets=r.Props.SheetNames.length,xs(b,x,D0(r.Props)),g.extprops.push(x),rr(d.rels,3,x,ks.EXT_PROPS),r.Custprops!==r.Props&&0<is(r.Custprops||{}).length&&(xs(b,x="docProps/custom.xml",yn(r.Custprops)),g.custprops.push(x),rr(d.rels,4,x,ks.CUST_PROPS));var E,T=["SheetJ5"];for(d.tcid=0,y=1;y<=r.SheetNames.length;++y){var _,R,q,I,ee={"!id":{}},Y=r.Sheets[r.SheetNames[y-1]];xs(b,x="xl/worksheets/sheet"+y+"."+u,fu(y-1,d,r,ee)),g.sheets.push(x),rr(d.wbrels,-1,"worksheets/sheet"+y+"."+u,ks.WS[0]),Y&&(R=!1,q="",(_=Y["!comments"])&&0<_.length&&(I=!1,_.forEach(function(z){z[1].forEach(function(Z){Z.T==1&&(I=!0)})}),I&&(xs(b,q="xl/threadedComments/threadedComment"+y+"."+u,(function(z,Z,ae){var ie=[hr,Le("ThreadedComments",null,{xmlns:hs.TCMNT}).replace(/[\/]>/,">")];return z.forEach(function(Ee){var We="";(Ee[1]||[]).forEach(function(Ie,Je){var bt;Ie.T?(Ie.a&&Z.indexOf(Ie.a)==-1&&Z.push(Ie.a),bt={ref:Ee[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+ae.tcid++).slice(-12)+"}"},Je==0?We=bt.id:bt.parentId=We,Ie.ID=bt.id,Ie.a&&(bt.personId="{54EE7950-7262-4200-6969-"+("000000000000"+Z.indexOf(Ie.a)).slice(-12)+"}"),ie.push(Le("threadedComment",Ct("text",Ie.t||""),bt))):delete Ie.ID})}),ie.push("</ThreadedComments>"),ie.join("")})(_,T,d)),g.threadedcomments.push(q),rr(ee,-1,"../threadedComments/threadedComment"+y+"."+u,ks.TCMNT)),xs(b,q="xl/comments"+y+"."+u,ng(_)),g.comments.push(q),rr(ee,-1,"../comments"+y+"."+u,ks.CMNT),R=!0),Y["!legacy"]&&R&&xs(b,"xl/drawings/vmlDrawing"+y+".vml",tf(y,Y["!comments"])),delete Y["!comments"],delete Y["!legacy"]),ee["!id"].rId1&&xs(b,xl(x),Rn(ee))}return d.Strings!=null&&0<d.Strings.length&&(xs(b,x="xl/sharedStrings.xml",xd(d.Strings,d)),g.strs.push(x),rr(d.wbrels,-1,"sharedStrings.xml",ks.SST)),xs(b,x="xl/workbook.xml",pu(r)),g.workbooks.push(x),rr(d.rels,1,x,ks.WB),xs(b,x="xl/theme/theme1.xml",su(r.Themes,d)),g.themes.push(x),rr(d.wbrels,-1,"theme/theme1.xml",ks.THEME),xs(b,x="xl/styles.xml",Kh(r,d)),g.styles.push(x),rr(d.wbrels,-1,"styles.xml",ks.STY),r.vbaraw&&h&&(xs(b,x="xl/vbaProject.bin",r.vbaraw),g.vba.push(x),rr(d.wbrels,-1,"vbaProject.bin",ks.VBA)),xs(b,x="xl/metadata.xml",ef()),g.metadata.push(x),rr(d.wbrels,-1,"metadata.xml",ks.XLMETA),1<T.length&&(xs(b,x="xl/persons/person.xml",(h=T,E=[hr,Le("personList",null,{xmlns:hs.TCMNT,"xmlns:x":ta[0]}).replace(/[\/]>/,">")],h.forEach(function(z,Z){E.push(Le("person",null,{displayName:z,id:"{54EE7950-7262-4200-6969-"+("000000000000"+Z).slice(-12)+"}",userId:z,providerId:"None"}))}),E.push("</personList>"),E.join(""))),g.people.push(x),rr(d.wbrels,-1,"persons/person.xml",ks.PEOPLE)),xs(b,"[Content_Types].xml",C0(g,d)),xs(b,"_rels/.rels",Rn(d.rels)),xs(b,"xl/_rels/workbook.xml.rels",Rn(d.wbrels)),delete d.revssf,delete d.ssf,b}function Ff(r,d){var u="";switch((d||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":u=Ce(r.slice(0,12));break;case"binary":u=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(d&&d.type||"undefined"))}return[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3),u.charCodeAt(4),u.charCodeAt(5),u.charCodeAt(6),u.charCodeAt(7)]}function Mf(r,d){var u=0;e:for(;u<r.length;)switch(r.charCodeAt(u)){case 10:case 13:case 32:++u;break;case 60:return Qa(r.slice(u),d);default:break e}return Gi.to_workbook(r,d)}function Lf(r,d,u,h){return h?(u.type="string",Gi.to_workbook(r,u)):Gi.to_workbook(d,u)}function Sc(r,d){L();var u=d||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Sc(new Uint8Array(r),((u=vs(u)).type="array",u));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!u.type&&(u.type=typeof Deno<"u"?"buffer":"array");var h,g,b,x,y,j=r,k=!1;if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),Dl={},u.dateNF&&(Dl.dateNF=u.dateNF),u.type||(u.type=ge&&Buffer.isBuffer(r)?"buffer":"base64"),u.type=="file"&&(u.type=ge?"buffer":"binary",j=(function(T){if(Ua!==void 0)return Ua.readFileSync(T);if(typeof Deno<"u")return Deno.readFileSync(T);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var _=File(T);_.open("r"),_.encoding="binary";var R=_.read();return _.close(),R}catch(q){if(!q.message||!q.message.match(/onstruct/))throw q}throw new Error("Cannot access file "+T)})(r),typeof Uint8Array>"u"||ge||(u.type="array")),u.type=="string"&&(k=!0,u.type="binary",u.codepage=65001,j=(E=r).match(/[^\x00-\x7F]/)?Xe(E):E),u.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var E=new ArrayBuffer(3),E=new Uint8Array(E);if(E.foo="bar",!E.foo)return(u=vs(u)).type="array",Sc(oe(j),u)}switch((h=Ff(j,u))[0]){case 208:if(h[1]===207&&h[2]===17&&h[3]===224&&h[4]===161&&h[5]===177&&h[6]===26&&h[7]===225)return x=es.read(j,u),y=u,(es.find(x,"EncryptedPackage")?mr:Bd)(x,y);break;case 9:if(h[1]<=8)return Bd(j,u);break;case 60:return Qa(j,u);case 73:if(h[1]===73&&h[2]===42&&h[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(h[1]===68)return(function(T,_){var R=_||{},q=!!R.WTF;R.WTF=!0;try{var I=dd.to_workbook(T,R);return R.WTF=q,I}catch(ee){if(R.WTF=q,!ee.message.match(/SYLK bad record ID/)&&q)throw ee;return Gi.to_workbook(T,_)}})(j,u);break;case 84:if(h[1]===65&&h[2]===66&&h[3]===76)return Dh.to_workbook(j,u);break;case 80:return h[1]===75&&h[2]<9&&h[3]<9?(b=y=j,(g=(g=u)||{}).type||(g.type=ge&&Buffer.isBuffer(y)?"buffer":"base64"),Tf(tn(b,g),g)):Lf(r,j,u,k);case 239:return h[3]===60?Qa(j,u):Lf(r,j,u,k);case 255:if(h[1]===254)return b=j,(g=u).type=="base64"&&(b=Ce(b)),b=e.utils.decode(1200,b.slice(2),"str"),g.type="binary",Mf(b,g);if(h[1]===0&&h[2]===2&&h[3]===0)return da.to_workbook(j,u);break;case 0:if(h[1]===0&&(2<=h[2]&&h[3]===0||h[2]===0&&(h[3]===8||h[3]===9)))return da.to_workbook(j,u);break;case 3:case 131:case 139:case 140:return B0.to_workbook(j,u);case 123:if(h[1]===92&&h[2]===114&&h[3]===116)return X0.to_workbook(j,u);break;case 10:case 13:case 32:return(function(T,_){var R="",q=Ff(T,_);switch(_.type){case"base64":R=Ce(T);break;case"binary":R=T;break;case"buffer":R=T.toString("binary");break;case"array":R=Ha(T);break;default:throw new Error("Unrecognized type "+_.type)}return q[0]==239&&q[1]==187&&q[2]==191&&(R=Oe(R)),_.type="binary",Mf(R,_)})(j,u);case 137:if(h[1]===80&&h[2]===78&&h[3]===71)throw new Error("PNG Image File is not a spreadsheet")}return-1<oo.indexOf(h[0])&&h[2]<=12&&h[3]<=31?B0.to_workbook(j,u):Lf(r,j,u,k)}function Lu(r,d){return d=d||{},d.type="file",Sc(r,d)}function $d(r,d){switch(d.type){case"base64":case"binary":break;case"buffer":case"array":d.type="";break;case"file":return Wl(d.file,es.write(r,{type:ge?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+d.bookType+"' files");default:throw new Error("Unrecognized type "+d.type)}return es.write(r,d)}function Rf(r,d){var u={},h=ge?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(d.compression&&(u.compression="DEFLATE"),d.password)u.type=h;else switch(d.type){case"base64":u.type="base64";break;case"binary":u.type="string";break;case"string":throw new Error("'string' output type invalid for '"+d.bookType+"' files");case"buffer":case"file":u.type=h;break;default:throw new Error("Unrecognized type "+d.type)}if(r=r.FullPaths?es.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[u.type]||u.type,compression:!!d.compression}):r.generate(u),typeof Deno<"u"&&typeof r=="string"){if(d.type=="binary"||d.type=="base64")return r;r=new Uint8Array(ze(r))}return d.password&&typeof encrypt_agile<"u"?$d(encrypt_agile(r,d.password),d):d.type==="file"?Wl(d.file,r):d.type=="string"?Oe(r):r}function ii(r,d,u){var h=(u=u||"")+r;switch(d.type){case"base64":return se(Xe(h));case"binary":return Xe(h);case"string":return r;case"file":return Wl(d.file,h,"utf8");case"buffer":return ge?Ne(h,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(h):ii(h,{type:"binary"}).split("").map(function(g){return g.charCodeAt(0)})}throw new Error("Unrecognized type "+d.type)}function Ac(r,d){switch(d.type){case"string":case"base64":case"binary":for(var u="",h=0;h<r.length;++h)u+=String.fromCharCode(r[h]);return d.type=="base64"?se(u):d.type=="string"?Oe(u):u;case"file":return Wl(d.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+d.type)}}function qd(r,d){L(),rl(r);var u,h=vs(d||{});return h.cellStyles&&(h.cellNF=!0,h.sheetStubs=!0),h.type!="array"?(u=r,d=vs((d=h)||{}),Rf(ja(u,d),d)):(h.type="binary",r=qd(r,h),h.type="array",ze(r))}function Ru(r,d){L(),rl(r);var u=vs(d||{});if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),u.type=="array")return u.type="binary",d=Ru(r,u),u.type="array",ze(d);var h,g,b,x=0;if(u.sheet&&(x=typeof u.sheet=="number"?u.sheet:r.SheetNames.indexOf(u.sheet),!r.SheetNames[x]))throw new Error("Sheet not found: "+u.sheet+" : "+typeof u.sheet);switch(u.bookType||"xlsb"){case"xml":case"xlml":return ii(Ml(r,u),u);case"slk":case"sylk":return ii(dd.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"htm":case"html":return ii(Fg(r.Sheets[r.SheetNames[x]],u),u);case"txt":return(function(y,j){switch(j.type){case"base64":return se(y);case"binary":case"string":return y;case"file":return Wl(j.file,y,"binary");case"buffer":return ge?Ne(y,"binary"):y.split("").map(function(k){return k.charCodeAt(0)})}throw new Error("Unrecognized type "+j.type)})(Pf(r.Sheets[r.SheetNames[x]],u),u);case"csv":return ii(Iu(r.Sheets[r.SheetNames[x]],u),u,"\uFEFF");case"dif":return ii(Dh.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"dbf":return Ac(B0.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"prn":return ii(Gi.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"rtf":return ii(X0.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"eth":return ii(ac.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"fods":return ii(al(r,u),u);case"wk1":return Ac(da.sheet_to_wk1(r.Sheets[r.SheetNames[x]],u),u);case"wk3":return Ac(da.book_to_wk3(r,u),u);case"biff2":u.biff||(u.biff=2);case"biff3":u.biff||(u.biff=3);case"biff4":return u.biff||(u.biff=4),Ac(jf(r,u),u);case"biff5":u.biff||(u.biff=5);case"biff8":case"xla":case"xls":return u.biff||(u.biff=8),$d(Nu(r,b=(b=u)||{}),b);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return h=r,b=vs((g=u)||{}),Nd=new Ug(g),Rf(_f(h,b),b);default:throw new Error("Unrecognized bookType |"+u.bookType+"|")}}function Ou(r){var d;r.bookType||((d=r.file.slice(r.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(r.bookType=d.slice(1)),r.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[r.bookType]||r.bookType)}function Bg(r,d,u){return u=u||{},u.type="file",u.file=d,Ou(u),Ru(r,u)}function Of(r,d,u,h,g,b,x,y){var j=Ur(u),k=y.defval,E=y.raw||!Object.prototype.hasOwnProperty.call(y,"raw"),T=!0,_=g===1?[]:{};if(g!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:u,enumerable:!1})}catch{_.__rowNum__=u}else _.__rowNum__=u;if(!x||r[u])for(var R=d.s.c;R<=d.e.c;++R){var q=x?r[u][R]:r[h[R]+j];if(q!==void 0&&q.t!==void 0){var I=q.v;switch(q.t){case"z":if(I==null)break;continue;case"e":I=I==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+q.t)}if(b[R]!=null){if(I==null)if(q.t=="e"&&I===null)_[b[R]]=null;else if(k!==void 0)_[b[R]]=k;else{if(!E||I!==null)continue;_[b[R]]=null}else _[b[R]]=E&&(q.t!=="n"||q.t==="n"&&y.rawNumbers!==!1)?I:xi(q,I,y);I!=null&&(T=!1)}}else k!==void 0&&b[R]!=null&&(_[b[R]]=k)}return{row:_,isempty:T}}function Pu(r,d){if(r==null||r["!ref"]==null)return[];var u,h={t:"n",v:0},g=0,b=1,x=[],y="",j={s:{r:0,c:0},e:{r:0,c:0}},k=d||{},E=k.range!=null?k.range:r["!ref"];switch(k.header===1?g=1:k.header==="A"?g=2:Array.isArray(k.header)?g=3:k.header==null&&(g=0),typeof E){case"string":j=Fs(E);break;case"number":(j=Fs(r["!ref"])).s.r=E;break;default:j=E}0<g&&(b=0);var T=Ur(j.s.r),_=[],R=[],q=0,I=0,ee=Array.isArray(r),Y=j.s.r,z=0,Z={};ee&&!r[Y]&&(r[Y]=[]);for(var ae,ie=k.skipHidden&&r["!cols"]||[],Ee=k.skipHidden&&r["!rows"]||[],z=j.s.c;z<=j.e.c;++z)if(!(ie[z]||{}).hidden)switch(_[z]=Ar(z),h=ee?r[Y][z]:r[_[z]+T],g){case 1:x[z]=z-j.s.c;break;case 2:x[z]=_[z];break;case 3:x[z]=k.header[z-j.s.c];break;default:if(y=u=xi(h=h??{w:"__EMPTY",t:"s"},null,k),I=Z[u]||0){for(;y=u+"_"+I++,Z[y];);Z[u]=I,Z[y]=1}else Z[u]=1;x[z]=y}for(Y=j.s.r+b;Y<=j.e.r;++Y)(Ee[Y]||{}).hidden||(ae=Of(r,j,Y,_,g,x,ee,k)).isempty!==!1&&(g===1?k.blankrows===!1:!k.blankrows)||(R[q++]=ae.row);return R.length=q,R}var zg=/"/g;function ll(r,d,u,h,g,b,x,y){for(var j=!0,k=[],E="",T=Ur(u),_=d.s.c;_<=d.e.c;++_)if(h[_]){var R=y.dense?(r[u]||[])[_]:r[h[_]+T];if(R==null)E="";else if(R.v!=null){j=!1,E=""+(y.rawNumbers&&R.t=="n"?R.v:xi(R,null,y));for(var q,I=0;I!==E.length;++I)if((q=E.charCodeAt(I))===g||q===b||q===34||y.forceQuotes){E='"'+E.replace(zg,'""')+'"';break}E=="ID"&&(E='"ID"')}else R.f==null||R.F?E="":(j=!1,0<=(E="="+R.f).indexOf(",")&&(E='"'+E.replace(zg,'""')+'"'));k.push(E)}return y.blankrows===!1&&j?null:k.join(x)}function Iu(r,d){var u=[],h=d??{};if(r==null||r["!ref"]==null)return"";var g=Fs(r["!ref"]),b=h.FS!==void 0?h.FS:",",x=b.charCodeAt(0),y=h.RS!==void 0?h.RS:`
`,j=y.charCodeAt(0),k=new RegExp((b=="|"?"\\|":b)+"+$"),E="",T=[];h.dense=Array.isArray(r);for(var _=h.skipHidden&&r["!cols"]||[],R=h.skipHidden&&r["!rows"]||[],q=g.s.c;q<=g.e.c;++q)(_[q]||{}).hidden||(T[q]=Ar(q));for(var I=0,ee=g.s.r;ee<=g.e.r;++ee)(R[ee]||{}).hidden||(E=ll(r,g,ee,T,x,j,b,h))!=null&&(!(E=h.strip?E.replace(k,""):E)&&h.blankrows===!1||u.push((I++?y:"")+E));return delete h.dense,u.join("")}function Pf(r,d){return(d=d||{}).FS="	",d.RS=`
`,r=Iu(r,d),e===void 0||d.type=="string"?r:(r=e.utils.encode(1200,r,"str"),""+r)}function Bu(E,d,u){var h,g=u||{},b=+!g.skipHeader,x=E||{},y=0,j=0;x&&g.origin!=null&&(typeof g.origin=="number"?y=g.origin:(k=typeof g.origin=="string"?Hr(g.origin):g.origin,y=k.r,j=k.c));var k,E={s:{c:0,r:0},e:{c:j,r:y+d.length-1+b}};x["!ref"]?(k=Fs(x["!ref"]),E.e.c=Math.max(E.e.c,k.e.c),E.e.r=Math.max(E.e.r,k.e.r),y==-1&&(y=k.e.r+1,E.e.r=y+d.length-1+b)):y==-1&&(y=0,E.e.r=d.length-1+b);var T=g.header||[],_=0;d.forEach(function(q,I){is(q).forEach(function(ae){(_=T.indexOf(ae))==-1&&(T[_=T.length]=ae);var Y=q[ae],z="z",Z="",ae=bs({c:j+_,r:y+I+b});h=zu(x,ae),!Y||typeof Y!="object"||Y instanceof Date?(typeof Y=="number"?z="n":typeof Y=="boolean"?z="b":typeof Y=="string"?z="s":Y instanceof Date?(z="d",g.cellDates||(z="n",Y=qr(Y)),Z=g.dateNF||W[14]):Y===null&&g.nullError&&(z="e",Y=0),h?(h.t=z,h.v=Y,delete h.w,delete h.R,Z&&(h.z=Z)):x[ae]=h={t:z,v:Y},Z&&(h.z=Z)):x[ae]=Y})}),E.e.c=Math.max(E.e.c,j+T.length-1);var R=Ur(y);if(b)for(_=0;_<T.length;++_)x[Ar(_+j)+R]={t:"s",v:T[_]};return x["!ref"]=Cs(E),x}function zu(r,d,u){return typeof d!="string"?zu(r,bs(typeof d!="number"?d:{r:d,c:u||0})):Array.isArray(r)?(u=Hr(d),r[u.r]||(r[u.r]=[]),r[u.r][u.c]||(r[u.r][u.c]={t:"z"})):r[d]||(r[d]={t:"z"})}function If(){return{SheetNames:[],Sheets:{}}}function Uu(r,d,u,h){var g=1;if(!u)for(;g<=65535&&r.SheetNames.indexOf(u="Sheet"+g)!=-1;++g,u=void 0);if(!u||65535<=r.SheetNames.length)throw new Error("Too many worksheets");if(h&&0<=r.SheetNames.indexOf(u)){var h=u.match(/(^.*?)(\d+)$/),g=h&&+h[2]||0,b=h&&h[1]||u;for(++g;g<=65535&&r.SheetNames.indexOf(u=b+g)!=-1;++g);}if(Vr(u),0<=r.SheetNames.indexOf(u))throw new Error("Worksheet with name |"+u+"| already exists!");return r.SheetNames.push(u),r.Sheets[u]=d,u}function Hu(r,d,u){return d?(r.l={Target:d},u&&(r.l.Tooltip=u)):delete r.l,r}var Ec,Bf={encode_col:Ar,encode_row:Ur,encode_cell:bs,encode_range:Cs,decode_col:ml,decode_row:b0,split_cell:function(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Hr,decode_range:Ia,format_cell:xi,sheet_add_aoa:mh,sheet_add_json:Bu,sheet_add_dom:Cf,aoa_to_sheet:Ql,json_to_sheet:function(r,d){return Bu(null,r,d)},table_to_sheet:Mg,table_to_book:function(r,d){return Kn(Mg(r,d),d)},sheet_to_csv:Iu,sheet_to_txt:Pf,sheet_to_json:Pu,sheet_to_html:Fg,sheet_to_formulae:function(r){var d,u="",h="";if(r==null||r["!ref"]==null)return[];for(var g,b=Fs(r["!ref"]),x=[],y=[],j=Array.isArray(r),k=b.s.c;k<=b.e.c;++k)x[k]=Ar(k);for(var E=b.s.r;E<=b.e.r;++E)for(g=Ur(E),k=b.s.c;k<=b.e.c;++k)if(u=x[k]+g,h="",(d=j?(r[E]||[])[k]:r[u])!==void 0){if(d.F!=null){if(u=d.F,!d.f)continue;h=d.f,u.indexOf(":")==-1&&(u=u+":"+u)}if(d.f!=null)h=d.f;else{if(d.t=="z")continue;if(d.t=="n"&&d.v!=null)h=""+d.v;else if(d.t=="b")h=d.v?"TRUE":"FALSE";else if(d.w!==void 0)h="'"+d.w;else{if(d.v===void 0)continue;h=d.t=="s"?"'"+d.v:""+d.v}}y[y.length]=u+"="+h}return y},sheet_to_row_object_array:Pu,sheet_get_cell:zu,book_new:If,book_append_sheet:Uu,book_set_sheet_visibility:function(r,d,u){switch(r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]),d=(function(h,g){if(typeof g=="number"){if(0<=g&&h.SheetNames.length>g)return g;throw new Error("Cannot find sheet # "+g)}if(typeof g!="string")throw new Error("Cannot find sheet |"+g+"|");if(-1<(h=h.SheetNames.indexOf(g)))return h;throw new Error("Cannot find sheet name |"+g+"|")})(r,d),r.Workbook.Sheets[d]||(r.Workbook.Sheets[d]={}),u){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+u)}r.Workbook.Sheets[d].Hidden=u},cell_set_number_format:function(r,d){return r.z=d,r},cell_set_hyperlink:Hu,cell_set_internal_link:function(r,d,u){return Hu(r,"#"+d,u)},cell_add_comment:function(r,d,u){r.c||(r.c=[]),r.c.push({t:d,a:u||"SheetJS"})},sheet_set_array_formula:function(r,d,u,h){for(var g=typeof d!="string"?d:Fs(d),b=typeof d=="string"?d:Cs(d),x=g.s.r;x<=g.e.r;++x)for(var y=g.s.c;y<=g.e.c;++y){var j=zu(r,x,y);j.t="n",j.F=b,delete j.v,x==g.s.r&&y==g.s.c&&(j.f=u,h&&(j.D=!0))}return r},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Dn(r){Ec=r}var Ll={to_json:function(r,d){var u=Ec({objectMode:!0});if(r==null||r["!ref"]==null)return u.push(null),u;var h,g={t:"n",v:0},b=0,x=1,y=[],j="",k={s:{r:0,c:0},e:{r:0,c:0}},E=d||{},T=E.range!=null?E.range:r["!ref"];switch(E.header===1?b=1:E.header==="A"?b=2:Array.isArray(E.header)&&(b=3),typeof T){case"string":k=Fs(T);break;case"number":(k=Fs(r["!ref"])).s.r=T;break;default:k=T}0<b&&(x=0);var _=Ur(k.s.r),R=[],q=0,I=Array.isArray(r),ee=k.s.r,Y=0,z={};I&&!r[ee]&&(r[ee]=[]);for(var Z=E.skipHidden&&r["!cols"]||[],ae=E.skipHidden&&r["!rows"]||[],Y=k.s.c;Y<=k.e.c;++Y)if(!(Z[Y]||{}).hidden)switch(R[Y]=Ar(Y),g=I?r[ee][Y]:r[R[Y]+_],b){case 1:y[Y]=Y-k.s.c;break;case 2:y[Y]=R[Y];break;case 3:y[Y]=E.header[Y-k.s.c];break;default:if(j=h=xi(g=g??{w:"__EMPTY",t:"s"},null,E),q=z[h]||0){for(;j=h+"_"+q++,z[j];);z[h]=q,z[j]=1}else z[h]=1;y[Y]=j}return ee=k.s.r+x,u._read=function(){for(;ee<=k.e.r;)if(!(ae[ee-1]||{}).hidden){var ie=Of(r,k,ee,R,b,y,I,E);if(++ee,ie.isempty===!1||(b===1?E.blankrows!==!1:E.blankrows))return void u.push(ie.row)}return u.push(null)},u},to_html:function(r,g){var u=Ec(),h=g||{},g=h.header!=null?h.header:kf,b=h.footer!=null?h.footer:ar;u.push(g);var x=Ia(r["!ref"]);h.dense=Array.isArray(r),u.push(Cu(0,0,h));var y=x.s.r,j=!1;return u._read=function(){if(y>x.e.r)return j||(j=!0,u.push("</table>"+b)),u.push(null);for(;y<=x.e.r;){u.push(Nf(r,x,y,h)),++y;break}},u},to_csv:function(r,d){var u=Ec(),h=d??{};if(r==null||r["!ref"]==null)return u.push(null),u;var g=Fs(r["!ref"]),b=h.FS!==void 0?h.FS:",",x=b.charCodeAt(0),y=h.RS!==void 0?h.RS:`
`,j=y.charCodeAt(0),k=new RegExp((b=="|"?"\\|":b)+"+$"),E="",T=[];h.dense=Array.isArray(r);for(var _=h.skipHidden&&r["!cols"]||[],R=h.skipHidden&&r["!rows"]||[],q=g.s.c;q<=g.e.c;++q)(_[q]||{}).hidden||(T[q]=Ar(q));var I=g.s.r,ee=!1,Y=0;return u._read=function(){if(!ee)return ee=!0,u.push("\uFEFF");for(;I<=g.e.r;)if(++I,!(R[I-1]||{}).hidden&&(E=ll(r,g,I-1,T,x,j,b,h),E!=null&&((E=h.strip?E.replace(k,""):E)||h.blankrows!==!1)))return u.push((Y++?y:"")+E);return u.push(null)},u},set_readable:Dn},Ws=(function(){function r(d,u,h){return this instanceof r?(this.tagName=d,this._attributes=u||{},this._children=h||[],this._prefix="",this):new r(d,u,h)}return r.prototype.createElement=function(){return new r(arguments)},r.prototype.children=function(){return this._children},r.prototype.append=function(d){return this._children.push(d),this},r.prototype.prefix=function(d){return arguments.length==0?this._prefix:(this._prefix=d,this)},r.prototype.attr=function(d,u){if(u==null)return delete this._attributes[d],this;if(arguments.length==0)return this._attributes;if(typeof d=="string"&&arguments.length==1)return this._attributes.attr[d];if(typeof d=="object"&&arguments.length==1)for(var h in d)this._attributes[h]=d[h];else arguments.length==2&&typeof d=="string"&&(this._attributes[d]=u);return this},r.prototype.escapeAttributeValue=function(d){return'"'+d.replace(/\"/g,"&quot;")+'"'},r.prototype.toXml=function(d){var u=(d=d||this)._prefix;if(u+="<"+d.tagName,d._attributes)for(var h in d._attributes)u+=" "+h+"="+this.escapeAttributeValue(""+d._attributes[h]);if(d._children&&0<d._children.length){u+=">";for(var g=0;g<d._children.length;g++)u+=this.toXml(d._children[g]);u+="</"+d.tagName+">"}else u+="/>";return u},r})(),Ug=function(r){var d,u=164,h={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},g={};for(d in h)g[h[d]]=d;var b={};return{initialize:function(x){this.$fonts=Ws("fonts").attr("count",0).attr("x14ac:knownFonts","1"),this.$fills=Ws("fills").attr("count",0),this.$borders=Ws("borders").attr("count",0),this.$numFmts=Ws("numFmts").attr("count",0),this.$cellStyleXfs=Ws("cellStyleXfs"),this.$xf=Ws("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0),this.$cellXfs=Ws("cellXfs").attr("count",0),this.$cellStyles=Ws("cellStyles").append(Ws("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0)),this.$dxfs=Ws("dxfs").attr("count","0"),this.$tableStyles=Ws("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4"),this.$styles=Ws("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);var y=x.defaultCellStyle||{};return y.font||(y.font={name:"Calibri",sz:"11"}),y.font.name||(y.font.name="Calibri"),y.font.sz||(y.font.sz=11),y.fill||(y.fill={patternType:"none",fgColor:{}}),y.border||(y.border={}),y.numFmt||(y.numFmt=0),this.defaultStyle=y,x=JSON.parse(JSON.stringify(y)),x.fill={patternType:"gray125",fgColor:{}},this.addStyles([y,x]),this},addStyle:function(x){var y=JSON.stringify(x),j=b[y];return j==null?(j=this._addXf(x),b[y]=j):j=b[y],j},addStyles:function(x){var y=this;return x.map(function(j){return y.addStyle(j)})},_duckTypeStyle:function(x){return typeof x=="object"&&(x.patternFill||x.fgColor)?{fill:x}:x.font||x.numFmt||x.border||x.fill?x:this._getStyleCSS(x)},_getStyleCSS:function(x){return x},_addXf:function(x){var y=this._addFont(x.font),j=this._addFill(x.fill),k=this._addBorder(x.border),E=this._addNumFmt(x.numFmt),T=Ws("xf").attr("numFmtId",E).attr("fontId",y).attr("fillId",j).attr("borderId",k).attr("xfId","0");return 0<y&&T.attr("applyFont","1"),0<j&&T.attr("applyFill","1"),0<k&&T.attr("applyBorder","1"),0<E&&T.attr("applyNumberFormat","1"),x.alignment&&(E=Ws("alignment"),x.alignment.horizontal&&E.attr("horizontal",x.alignment.horizontal),x.alignment.vertical&&E.attr("vertical",x.alignment.vertical),x.alignment.indent&&E.attr("indent",x.alignment.indent),x.alignment.readingOrder&&E.attr("readingOrder",x.alignment.readingOrder),x.alignment.wrapText&&E.attr("wrapText",x.alignment.wrapText),x.alignment.textRotation!=null&&E.attr("textRotation",x.alignment.textRotation),T.append(E).attr("applyAlignment",1)),this.$cellXfs.append(T),T=+this.$cellXfs.children().length,this.$cellXfs.attr("count",T),T-1},_addFont:function(x){if(!x)return 0;var y=Ws("font").append(Ws("sz").attr("val",x.sz||this.defaultStyle.font.sz)).append(Ws("name").attr("val",x.name||this.defaultStyle.font.name));return x.bold&&y.append(Ws("b")),x.underline&&y.append(Ws("u")),x.italic&&y.append(Ws("i")),x.strike&&y.append(Ws("strike")),x.outline&&y.append(Ws("outline")),x.shadow&&y.append(Ws("shadow")),x.vertAlign&&y.append(Ws("vertAlign").attr("val",x.vertAlign)),x.color&&(x.color.theme?(y.append(Ws("color").attr("theme",x.color.theme)),x.color.tint&&y.append(Ws("tint").attr("theme",x.color.tint))):x.color.rgb&&y.append(Ws("color").attr("rgb",x.color.rgb))),this.$fonts.append(y),y=this.$fonts.children().length,this.$fonts.attr("count",y),y-1},_addNumFmt:function(x){if(!x)return 0;if(typeof x=="string"){var y=g[x];if(0<=y)return y}return/^[0-9]+$/.exec(x)?x:(x=x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),x=Ws("numFmt").attr("numFmtId",++u).attr("formatCode",x),this.$numFmts.append(x),x=this.$numFmts.children().length,this.$numFmts.attr("count",x),u)},_addFill:function(x){if(!x)return 0;var y,j=Ws("patternFill").attr("patternType",x.patternType||"solid");return x.fgColor&&(y=Ws("fgColor"),x.fgColor.rgb?(x.fgColor.rgb.length==6&&(x.fgColor.rgb="FF"+x.fgColor.rgb),y.attr("rgb",x.fgColor.rgb),j.append(y)):x.fgColor.theme&&(y.attr("theme",x.fgColor.theme),x.fgColor.tint&&y.attr("tint",x.fgColor.tint),j.append(y)),x.bgColor||(x.bgColor={indexed:"64"})),x.bgColor&&(x=Ws("bgColor").attr(x.bgColor),j.append(x)),j=Ws("fill").append(j),this.$fills.append(j),j=this.$fills.children().length,this.$fills.attr("count",j),j-1},_getSubBorder:function(x,y){var j=Ws(x);return y&&(j.attr("style",y.style||"medium"),y.color&&(x=Ws("color"),y.color.auto?x.attr("auto",y.color.auto):y.color.rgb?x.attr("rgb",y.color.rgb):(y.color.theme||y.color.tint)&&(x.attr("theme",y.color.theme||"1"),x.attr("tint",y.color.tint||"0")),j.append(x))),j},_addBorder:function(x){if(!x)return 0;var y=this,j=Ws("border").attr("diagonalUp",x.diagonalUp).attr("diagonalDown",x.diagonalDown);["left","right","top","bottom","diagonal"].forEach(function(E){j.append(y._getSubBorder(E,x[E]))}),this.$borders.append(j);var k=this.$borders.children().length;return this.$borders.attr("count",k),k-1},toXml:function(){return this.$styles.toXml()}}.initialize(r||{})};Bd!==void 0&&(s.parse_xlscfb=Bd),s.parse_zip=Tf,s.read=Sc,s.readFile=Lu,s.readFileSync=Lu,s.write=Ru,s.writeFile=Bg,s.writeFileSync=Bg,s.writeFileAsync=function(r,d,u,h){var g=u||{};return g.type="file",g.file=r,Ou(g),g.type="buffer",h instanceof Function||(h=u),Ua.writeFile(r,Ru(d,g),h)},s.utils=Bf,s.writeXLSX=qd,s.writeFileXLSX=function(r,d,u){return(u=u||{}).type="file",u.file=d,Ou(u),qd(r,u)},s.SSF=nh,Ll!==void 0&&(s.stream=Ll),es!==void 0&&(s.CFB=es),typeof mp>"u"||((Ll=I1)||{}).Readable&&Dn(Ll.Readable)}if(o(n),typeof window<"u"&&!window.XLSX)try{window.XLSX=a}catch{}})(ip,ip.exports)),ip.exports}var Qf=OC();function PC(){const{id:l}=di(),n=Dr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState(!1),[L,M]=B.useState({}),[F,O]=B.useState("day"),[P,K]=B.useState(null),[ne,se]=B.useState({isOpen:!1,metric:null,period:null,channel:null,section:null}),[Ce,ge]=B.useState([]),[Ne,J]=B.useState(!1),de=Mo.useRef(null),le=B.useMemo(()=>a?{call:a.channels?.coldCalling||!1,linkedin:a.channels?.linkedInOutreach||!1,email:a.channels?.coldEmail||!1}:{call:!1,linkedin:!1,email:!1},[a]);B.useEffect(()=>{if(!l)return;const H=de.current;H&&H.projectId===l?(o(H.project),e(H.activities),v(H.contacts),M(H.reportData||{}),N(!1)):ze()},[l]);const ze=async()=>{try{N(!0),K(null);const[H,X,je]=await Promise.all([Ut.get(`/projects/${l}`),Ut.get(`/activities/project/${l}?limit=10000`),Ut.get(`/projects/${l}/project-contacts?limit=10000`)]);let Q=a,we=s,Fe=m;H.data.success&&(Q=H.data.data,o(Q)),X.data.success&&(we=X.data.data||[],e(we)),je.data.success&&(Fe=je.data.data||[],v(Fe)),de.current={projectId:l,project:Q,activities:we,contacts:Fe,reportData:L}}catch(H){console.error("Error fetching data:",H),K(H.response?.data?.error||"Failed to load report data. Please try again.")}finally{N(!1)}},me=B.useCallback(H=>{const X=new Date(H),je=X.getDate(),Q=X.toLocaleString("default",{month:"short"}),we=X.getFullYear().toString().slice(-2);return`${je} ${Q} '${we}`},[]),oe=B.useCallback(H=>{const X=new Date(H),je=X.toLocaleString("default",{month:"short"}),Q=X.getFullYear().toString().slice(-2);return`${je} '${Q}`},[]),ce=B.useCallback(H=>new Date(H).toLocaleString("default",{month:"long"}),[]),ye=B.useMemo(()=>{if(F==="month"){const H=new Set;s.forEach(Q=>{const we=Q.callDate?new Date(Q.callDate):Q.emailDate?new Date(Q.emailDate):Q.linkedinDate?new Date(Q.linkedinDate):Q.createdAt?new Date(Q.createdAt):null;we&&!isNaN(we.getTime())&&H.add(oe(we))}),m.forEach(Q=>{Q.createdAt&&H.add(oe(new Date(Q.createdAt)))});const X=new Date;return H.add(oe(X)),[{month:null,periods:Array.from(H).sort((Q,we)=>{const[Fe,ue]=Q.split(" '"),[xe,tt]=we.split(" '"),Qe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ve=Qe.indexOf(Fe),xt=Qe.indexOf(xe);return ue!==tt?parseInt(ue)-parseInt(tt):Ve-xt})}]}else{const H={};s.forEach(ue=>{const xe=ue.callDate?new Date(ue.callDate):ue.emailDate?new Date(ue.emailDate):new Date(ue.createdAt);if(xe&&!isNaN(xe.getTime())){const tt=me(xe),Qe=oe(xe),Ve=ce(xe);H[Qe]||(H[Qe]={month:Ve,monthKey:Qe,periods:[]}),H[Qe].periods.includes(tt)||H[Qe].periods.push(tt)}}),m.forEach(ue=>{if(ue.createdAt){const xe=new Date(ue.createdAt),tt=me(xe),Qe=oe(xe),Ve=ce(xe);H[Qe]||(H[Qe]={month:Ve,monthKey:Qe,periods:[]}),H[Qe].periods.includes(tt)||H[Qe].periods.push(tt)}});const X=new Date,je=me(X),Q=oe(X),we=ce(X);return H[Q]||(H[Q]={month:we,monthKey:Q,periods:[]}),H[Q].periods.includes(je)||H[Q].periods.push(je),Object.keys(H).forEach(ue=>{H[ue].periods.sort((xe,tt)=>{const Qe=new Date(xe.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3")),Ve=new Date(tt.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3"));return Qe-Ve})}),Object.values(H).sort((ue,xe)=>{const[tt,Qe]=ue.monthKey.split(" '"),[Ve,xt]=xe.monthKey.split(" '"),nt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],$t=nt.indexOf(tt),Mt=nt.indexOf(Ve);return Qe!==xt?parseInt(Qe)-parseInt(xt):$t-Mt})}},[s,m,F,me,oe,ce]),ke=B.useMemo(()=>ye.flatMap(H=>H.periods),[ye]),fe=B.useCallback(()=>{if(s.length===0&&m.length===0){M({});return}D(!0);const X=setTimeout(()=>{const je={};ke.forEach(ue=>{je[ue]={dataAllocated:0,dataResearch:0,interested:0,notInterested:0,ring:0,busy:0,hangUp:0,callBack:0,switchOff:0,detailsShared:0,future:0,invalid:0,demoBooked:0,followUps:0,totalCalls:0,freshCalls:0,connectionRequestSent:0,connectionAccepted:0,firstMessageSent:0,followupMessagesSent:0,existingConnection:0,conversationsInProgress:0,meetingProposed:0,meetingScheduled:0,meetingCompleted:0,emailsSent:0,noReply:0,outOfOffice:0,wrongPerson:0,bounce:0,optOut:0,totalResponses:0,responseRate:0}}),m.forEach(ue=>{if(ue.createdAt){const xe=F==="day"?me(new Date(ue.createdAt)):oe(new Date(ue.createdAt));je[xe]&&(je[xe].dataAllocated++,je[xe].dataResearch++)}});const Q=le.call?s.filter(ue=>ue.type==="call"):[],we=le.linkedin?s.filter(ue=>ue.type==="linkedin"):[],Fe=le.email?s.filter(ue=>ue.type==="email"):[];if(le.call&&Q.length>0){const ue=new Map,xe={};Q.forEach(tt=>{const Qe=tt.callDate?new Date(tt.callDate):new Date(tt.createdAt);if(!Qe||isNaN(Qe.getTime()))return;const Ve=F==="day"?me(Qe):oe(Qe);if(!je[Ve])return;const xt=tt.contactId?.toString()||"unknown";tt.callNumber==="1st call"&&!ue.has(xt)&&ue.set(xt,Ve),xe[Ve]||(xe[Ve]={}),xe[Ve][xt]||(xe[Ve][xt]=[]),xe[Ve][xt].push(tt)}),Q.forEach(tt=>{const Qe=tt.callDate?new Date(tt.callDate):new Date(tt.createdAt);if(!Qe||isNaN(Qe.getTime()))return;const Ve=F==="day"?me(Qe):oe(Qe);if(je[Ve]){if(tt.callStatus)switch(tt.callStatus){case"Interested":je[Ve].interested++;break;case"Not Interested":je[Ve].notInterested++;break;case"Ring":je[Ve].ring++;break;case"Busy":je[Ve].busy++;break;case"Hang Up":je[Ve].hangUp++;break;case"Call Back":je[Ve].callBack++;break;case"Switch Off":je[Ve].switchOff++;break;case"Details Shared":je[Ve].detailsShared++;break;case"Future":je[Ve].future++;break;case"Invalid":je[Ve].invalid++;break;case"Demo Booked":je[Ve].demoBooked++;break}je[Ve].totalCalls++}}),Object.keys(xe).forEach(tt=>{const Qe=xe[tt];let Ve=0,xt=0;Object.keys(Qe).forEach(nt=>{const $t=Qe[nt],Mt=ue.get(nt);$t.forEach(Es=>{Es.callNumber==="1st call"||Mt===tt&&!Es.callNumber?Ve++:xt++})}),je[tt]&&(je[tt].freshCalls=Ve,je[tt].followUps=xt)})}if(le.linkedin&&we.length>0){const ue={};ke.forEach(xe=>{ue[xe]={connectionRequestSent:new Set,connectionAccepted:new Set,existingConnection:new Set,conversationsInProgress:new Set,meetingProposed:new Set,meetingScheduled:new Set,meetingCompleted:new Set,firstMessageSent:new Set,followupMessagesSent:new Set}}),we.forEach(xe=>{const tt=xe.linkedinDate?new Date(xe.linkedinDate):xe.createdAt?new Date(xe.createdAt):null;if(!tt)return;const Qe=xe.contactId?.toString()||"unknown",Ve=F==="day"?me(tt):oe(tt);if(!ue[Ve])return;const xt=xe.template?.trim()||"";(xe.lnRequestSent==="Yes"||xt==="introduction-message")&&ue[Ve].connectionRequestSent.add(Qe),xe.lnRequestSent==="Existing Connect"&&ue[Ve].existingConnection.add(Qe),xe.connected==="Yes"&&ue[Ve].connectionAccepted.add(Qe),xe.status==="CIP"?ue[Ve].conversationsInProgress.add(Qe):xe.status==="Meeting Proposed"?ue[Ve].meetingProposed.add(Qe):xe.status==="Meeting Scheduled"?ue[Ve].meetingScheduled.add(Qe):xe.status==="Meeting Completed"&&ue[Ve].meetingCompleted.add(Qe),xt==="introduction-message"?ue[Ve].firstMessageSent.add(Qe):xt==="follow-up-message"&&ue[Ve].followupMessagesSent.add(Qe)}),ke.forEach(xe=>{je[xe]&&ue[xe]&&(je[xe].connectionRequestSent=ue[xe].connectionRequestSent.size,je[xe].connectionAccepted=ue[xe].connectionAccepted.size,je[xe].existingConnection=ue[xe].existingConnection.size,je[xe].conversationsInProgress=ue[xe].conversationsInProgress.size,je[xe].meetingProposed=ue[xe].meetingProposed.size,je[xe].meetingScheduled=ue[xe].meetingScheduled.size,je[xe].meetingCompleted=ue[xe].meetingCompleted.size,je[xe].firstMessageSent=ue[xe].firstMessageSent.size,je[xe].followupMessagesSent=ue[xe].followupMessagesSent.size)})}le.email&&Fe.length>0&&(Fe.forEach(ue=>{if(!ue.createdAt)return;const xe=F==="day"?me(new Date(ue.createdAt)):oe(new Date(ue.createdAt));if(je[xe]){if(je[xe].emailsSent++,ue.status)switch(ue.status){case"No Reply":je[xe].noReply++;break;case"Out of Office":je[xe].outOfOffice++;break;case"Wrong Person":je[xe].wrongPerson++;break;case"Bounce":je[xe].bounce++;break;case"Opt Out":je[xe].optOut++;break}ue.status&&ue.status!=="No Reply"&&ue.status!=="Bounce"&&ue.status!=="Opt Out"&&je[xe].totalResponses++}}),ke.forEach(ue=>{je[ue]&&je[ue].emailsSent>0&&(je[ue].responseRate=parseFloat((je[ue].totalResponses/je[ue].emailsSent*100).toFixed(2)))})),M(je),D(!1)},0);return()=>clearTimeout(X)},[s,m,F,le,ke,me,oe]);B.useEffect(()=>{fe()},[fe]);const Se=B.useMemo(()=>{const H=[];return le.call&&!le.linkedin&&!le.email?H.push({key:"dataAllocated",label:"Data Allocated",section:"Cold Calling",bold:!1},{key:"interested",label:"Interested",section:"Cold Calling",bold:!0},{key:"notInterested",label:"Not Interested",section:"Cold Calling",bold:!0},{key:"ring",label:"Ring",section:"Cold Calling",bold:!1},{key:"busy",label:"Busy",section:"Cold Calling",bold:!1,highlight:!0},{key:"hangUp",label:"Hang Up",section:"Cold Calling",bold:!1},{key:"callBack",label:"Call Back",section:"Cold Calling",bold:!1},{key:"switchOff",label:"Switch Off",section:"Cold Calling",bold:!1},{key:"detailsShared",label:"Detailed Shared",section:"Cold Calling",bold:!0,highlight:!0},{key:"future",label:"Future",section:"Cold Calling",bold:!1},{key:"invalid",label:"Invalid",section:"Cold Calling",bold:!1},{key:"demoBooked",label:"Demo Booked",section:"Cold Calling",bold:!0,highlight:!0,highlightDark:!0},{key:"followUps",label:"Follow Ups",section:"Cold Calling",bold:!0},{key:"totalCalls",label:"Total Calls",section:"Cold Calling",bold:!0},{key:"freshCalls",label:"(Fresh Calls + FollowUpS)",section:"Cold Calling",bold:!1,isFormula:!0}):le.linkedin?(H.push({key:"dataResearch",label:"Data Research manually",section:"Linked IN",bold:!1},{key:"connectionRequestSent",label:"Connection Request Sent",section:"Linked IN",bold:!1},{key:"connectionAccepted",label:"Connection Accepted",section:"Linked IN",bold:!1},{key:"firstMessageSent",label:"First Message Sent",section:"Linked IN",bold:!1},{key:"followupMessagesSent",label:"Followup Messages sent",section:"Linked IN",bold:!1},{key:"existingConnection",label:"Existing Connection",section:"Linked IN",bold:!1},{key:"conversationsInProgress",label:"Conversations in Progress",section:"Linked IN",bold:!0,highlight:!0},{key:"meetingProposed",label:"Meeting Proposed",section:"Linked IN",bold:!1,highlight:!0},{key:"meetingScheduled",label:"Meeting Scheduled",section:"Linked IN",bold:!1,highlight:!0},{key:"meetingCompleted",label:"Meeting Completed",section:"Linked IN",bold:!1,highlight:!0}),le.call&&H.push({key:"dataAllocated",label:"Data Allocated",section:"Cold Calling",bold:!1},{key:"interested",label:"Interested",section:"Cold Calling",bold:!0},{key:"notInterested",label:"Not Interested",section:"Cold Calling",bold:!0},{key:"ring",label:"Ring",section:"Cold Calling",bold:!1},{key:"busy",label:"Busy",section:"Cold Calling",bold:!1,highlight:!0},{key:"hangUp",label:"Hang Up",section:"Cold Calling",bold:!1},{key:"callBack",label:"Call Back",section:"Cold Calling",bold:!1},{key:"switchOff",label:"Switch Off",section:"Cold Calling",bold:!1},{key:"detailsShared",label:"Detailed Shared",section:"Cold Calling",bold:!0,highlight:!0},{key:"future",label:"Future",section:"Cold Calling",bold:!1},{key:"invalid",label:"Invalid",section:"Cold Calling",bold:!1},{key:"demoBooked",label:"Demo Booked",section:"Cold Calling",bold:!0,highlight:!0,highlightDark:!0},{key:"followUps",label:"Follow Ups",section:"Cold Calling",bold:!0},{key:"totalCalls",label:"Total Calls",section:"Cold Calling",bold:!0}),le.email&&H.push({key:"emailsSent",label:"Emails Sent",section:"Email",bold:!1},{key:"noReply",label:"No Reply",section:"Email",bold:!1},{key:"outOfOffice",label:"Out of Office",section:"Email",bold:!1},{key:"wrongPerson",label:"Wrong Person",section:"Email",bold:!1},{key:"bounce",label:"Bounce",section:"Email",bold:!1},{key:"optOut",label:"Opt Out",section:"Email",bold:!1},{key:"totalResponses",label:"Total Responses",section:"Email",bold:!0},{key:"responseRate",label:"Response Rate (%)",section:"Email",bold:!1})):le.email&&H.push({key:"emailsSent",label:"Emails Sent",section:"Email",bold:!1},{key:"noReply",label:"No Reply",section:"Email",bold:!1},{key:"outOfOffice",label:"Out of Office",section:"Email",bold:!1},{key:"wrongPerson",label:"Wrong Person",section:"Email",bold:!1},{key:"bounce",label:"Bounce",section:"Email",bold:!1},{key:"optOut",label:"Opt Out",section:"Email",bold:!1},{key:"totalResponses",label:"Total Responses",section:"Email",bold:!0},{key:"responseRate",label:"Response Rate (%)",section:"Email",bold:!1}),H},[le]),Ye=B.useMemo(()=>{const H={};return Se.forEach(X=>{H[X.section]||(H[X.section]=[]),H[X.section].push(X)}),H},[Se]),te=B.useCallback(H=>H==="Cold Calling"?"call":H==="Linked IN"?"linkedin":H==="Email"?"email":null,[]),pe=B.useMemo(()=>{const H={byPeriodAndContact:new Map,byPeriodAndType:new Map,contactPeriods:new Map};return s.forEach(X=>{if((X.projectId?.toString?X.projectId.toString():X.projectId)!==l)return;const Q=X.callDate?new Date(X.callDate):X.emailDate?new Date(X.emailDate):X.linkedinDate?new Date(X.linkedinDate):X.createdAt?new Date(X.createdAt):null;if(!Q||isNaN(Q.getTime()))return;const we=F==="day"?me(Q):oe(Q),Fe=X.type;H.byPeriodAndContact.has(we)||H.byPeriodAndContact.set(we,new Map);const ue=H.byPeriodAndContact.get(we);if(X.contactId){const tt=X.contactId.toString?X.contactId.toString():X.contactId;ue.has(tt)||ue.set(tt,[]),ue.get(tt).push(X),H.contactPeriods.has(tt)||H.contactPeriods.set(tt,new Set),H.contactPeriods.get(tt).add(we)}H.byPeriodAndType.has(we)||H.byPeriodAndType.set(we,new Map);const xe=H.byPeriodAndType.get(we);xe.has(Fe)||xe.set(Fe,[]),xe.get(Fe).push(X)}),H},[s,l,F,me,oe]),V=B.useCallback((H,X,je)=>{if(!H||!X||!je)return[];const Q=Ce.length>0?Ce:m;if(s.filter(ue=>ue.type==="linkedin"),je==="all"&&H==="allForPeriod")return Q.filter(ue=>{const xe=(ue._id?.toString?ue._id.toString():ue._id)||"",tt=pe.contactPeriods.get(xe),Qe=tt?tt.has(X):!1;let Ve=!1;return ue.createdAt&&(Ve=(F==="day"?me(new Date(ue.createdAt)):oe(new Date(ue.createdAt)))===X),Qe||Ve});const we=pe.byPeriodAndType.get(X)?.get(je)||[],Fe=new Set;return we.forEach(ue=>{if(ue.contactId){const xe=ue.contactId.toString?ue.contactId.toString():ue.contactId;Fe.add(xe)}}),Q.filter(ue=>{const xe=(ue._id?.toString?ue._id.toString():ue._id)||"",Qe=(pe.byPeriodAndContact.get(X)?.get(xe)||[]).filter(Ve=>!(je==="call"&&Ve.type!=="call"||je==="linkedin"&&Ve.type!=="linkedin"||je==="email"&&Ve.type!=="email"));if(je==="call")switch(H){case"interested":return Qe.some(Ve=>Ve.callStatus==="Interested");case"notInterested":return Qe.some(Ve=>Ve.callStatus==="Not Interested");case"ring":return Qe.some(Ve=>Ve.callStatus==="Ring");case"busy":return Qe.some(Ve=>Ve.callStatus==="Busy");case"hangUp":return Qe.some(Ve=>Ve.callStatus==="Hang Up");case"callBack":return Qe.some(Ve=>Ve.callStatus==="Call Back");case"switchOff":return Qe.some(Ve=>Ve.callStatus==="Switch Off");case"detailsShared":return Qe.some(Ve=>Ve.callStatus==="Details Shared");case"future":return Qe.some(Ve=>Ve.callStatus==="Future");case"invalid":return Qe.some(Ve=>Ve.callStatus==="Invalid");case"demoBooked":return Qe.some(Ve=>Ve.callStatus==="Demo Booked");case"dataAllocated":return ue.createdAt?(F==="day"?me(new Date(ue.createdAt)):oe(new Date(ue.createdAt)))===X:!1;default:return!1}else if(je==="linkedin"){const Ve=Qe.filter(xt=>xt.createdAt?(F==="day"?me(new Date(xt.createdAt)):oe(new Date(xt.createdAt)))===X:!1);if(Ve.length===0)return!1;switch(H){case"dataResearch":return ue.createdAt?(F==="day"?me(new Date(ue.createdAt)):oe(new Date(ue.createdAt)))===X:!1;case"connectionRequestSent":return Ve.some(xt=>{const nt=xt.template?.trim()||"";return xt.lnRequestSent==="Yes"||nt==="introduction-message"});case"connectionAccepted":return Ve.some(xt=>xt.connected==="Yes");case"firstMessageSent":return Ve.some(xt=>(xt.template?.trim()||"")==="introduction-message");case"followupMessagesSent":return Ve.some(xt=>(xt.template?.trim()||"")==="follow-up-message");case"existingConnection":return Ve.some(xt=>xt.lnRequestSent==="Existing Connect");case"conversationsInProgress":return Ve.some(xt=>xt.status==="CIP");case"meetingProposed":return Ve.some(xt=>xt.status==="Meeting Proposed");case"meetingScheduled":return Ve.some(xt=>xt.status==="Meeting Scheduled");case"meetingCompleted":return Ve.some(xt=>xt.status==="Meeting Completed");default:return!1}}else if(je==="email")switch(H){case"emailsSent":return Qe.length>0;case"noReply":return Qe.some(Ve=>Ve.status==="No Reply");case"outOfOffice":return Qe.some(Ve=>Ve.status==="Out of Office");case"wrongPerson":return Qe.some(Ve=>Ve.status==="Wrong Person");case"bounce":return Qe.some(Ve=>Ve.status==="Bounce");case"optOut":return Qe.some(Ve=>Ve.status==="Opt Out");case"totalResponses":return Qe.some(Ve=>Ve.status&&Ve.status!=="No Reply"&&Ve.status!=="Bounce"&&Ve.status!=="Opt Out");default:return!1}return!1})},[Ce,m,pe,s,F,me,oe]);B.useEffect(()=>{ne.isOpen?(J(!0),m.length>0?(ge(m),J(!1),m.length<1e3&&Ut.get(`/projects/${l}/project-contacts?limit=10000`).then(H=>{H.data.success&&ge(H.data.data||[])}).catch(H=>{console.error("Error fetching contacts:",H)})):Ut.get(`/projects/${l}/project-contacts?limit=10000`).then(H=>{H.data.success&&ge(H.data.data||[])}).catch(H=>{console.error("Error fetching contacts:",H)}).finally(()=>{J(!1)})):ge([])},[ne.isOpen,l,m]);const be=B.useMemo(()=>{if(!ne.isOpen||!ne.metric||!ne.period||!ne.channel)return[];try{return V(ne.metric,ne.period,ne.channel)}catch(H){return console.error("Error filtering prospects:",H),[]}},[ne.isOpen,ne.metric,ne.period,ne.channel,V]),_e=B.useCallback((H,X,je)=>{const Q=te(je);!Q||(L[X]?.[H.key]||0)===0||H.isFormula||se({isOpen:!0,metric:H.key,period:X,channel:Q,section:je})},[L,te]),De=B.useCallback(H=>{const X=L[H];!X||Object.values(X).every(je=>!je||je===0)||se({isOpen:!0,metric:"allForPeriod",period:H,channel:"all",section:"All Channels"})},[L]),W=B.useCallback(()=>{if(ke.length===0||!L){alert("No data available to export");return}try{const H=Qf.utils.book_new(),X=[],je=[`Monthly Report - ${a?.companyName||"Report"}`];for(let $t=0;$t<ke.length;$t++)je.push("");X.push(je);const Q=[`${F==="day"?"Day":"Month"} View - Exported on ${new Date().toLocaleDateString()}`];for(let $t=0;$t<ke.length;$t++)Q.push("");X.push(Q),X.push(Array(ke.length+1).fill(""));const we=["Key Results",...ke];X.push(we);let Fe=0;const ue=[];ue[Fe]={cells:Array(je.length).fill({font:{bold:!0,sz:16,color:{rgb:"1E3A8A"}},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"left",vertical:"center"}}),merge:{s:{r:Fe,c:0},e:{r:Fe,c:ke.length}}},Fe++,ue[Fe]={cells:Array(Q.length).fill({font:{sz:10,color:{rgb:"6B7280"}},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"left",vertical:"center"}}),merge:{s:{r:Fe,c:0},e:{r:Fe,c:ke.length}}},Fe++,Fe++,ue[Fe]={cells:Array(we.length).fill({font:{bold:!0,color:{rgb:"1F2937"},sz:11},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},Fe++;const xe=Object.values(le).filter(Boolean).length,tt=Object.keys(Ye);xe>1?tt.forEach(($t,Mt)=>{Mt>0&&(X.push(Array(ke.length+1).fill("")),Fe++);const Es=[$t];for(let ms=0;ms<ke.length;ms++)Es.push("");X.push(Es),ue[Fe]={cells:Array(Es.length).fill({font:{bold:!0,sz:14,color:{rgb:"1E3A8A"}},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"left",vertical:"center"}}),merge:{s:{r:Fe,c:0},e:{r:Fe,c:ke.length}}},Fe++;const qs=["Key Results",...ke];X.push(qs),ue[Fe]={cells:Array(qs.length).fill({font:{bold:!0,color:{rgb:"1F2937"},sz:11},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},Fe++,ye.forEach((ms,ys)=>{if(F==="day"&&ms.month){const Re=[ms.month];for(let ht=0;ht<ke.length;ht++)Re.push("");X.push(Re),ue[Fe]={cells:Array(Re.length).fill({font:{bold:!0,sz:12,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFF9C4"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}}),merge:{s:{r:Fe,c:0},e:{r:Fe,c:ke.length}}},Fe++}if(ys===0||F==="day"&&ys>0&&ye[ys-1].monthKey!==ms.monthKey){const Re=[$t];for(let ht=0;ht<ke.length;ht++)Re.push("");X.push(Re),ue[Fe]={cells:Array(Re.length).fill({font:{bold:!0,sz:11,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFE082"}},alignment:{horizontal:"left",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},Fe++,Ye[$t].forEach(ht=>{const Ft=[ht.label];ke.forEach(jr=>{let $r="";ht.isFormula?$r=`(${L[jr]?.freshCalls||0} + ${L[jr]?.followUps||0})`:ht.key==="responseRate"?$r=`${L[jr]?.[ht.key]||0}%`:$r=L[jr]?.[ht.key]||0,Ft.push($r)}),X.push(Ft);const Is=ht.highlight?ht.highlightDark?"C8E6C9":"E8F5E9":"FFFFFF";ue[Fe]={cells:Ft.map((jr,$r)=>({font:{bold:ht.bold||$r===0,sz:10,color:{rgb:$r===0?"1F2937":"374151"}},fill:{fgColor:{rgb:Is}},alignment:{horizontal:$r===0?"left":"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}},numFmt:$r>0&&typeof jr=="number"?"0":void 0}))},Fe++})}})}):ye.forEach(($t,Mt)=>{if(F==="day"&&$t.month){const Es=[$t.month];for(let qs=0;qs<ke.length;qs++)Es.push("");X.push(Es),ue[Fe]={cells:Array(Es.length).fill({font:{bold:!0,sz:12,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFF9C4"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}}),merge:{s:{r:Fe,c:0},e:{r:Fe,c:ke.length}}},Fe++}(Mt===0||F==="day"&&Mt>0&&ye[Mt-1].monthKey!==$t.monthKey)&&Object.keys(Ye).forEach(Es=>{const qs=[Es];for(let ms=0;ms<ke.length;ms++)qs.push("");X.push(qs),ue[Fe]={cells:Array(qs.length).fill({font:{bold:!0,sz:11,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFE082"}},alignment:{horizontal:"left",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},Fe++,Ye[Es].forEach(ms=>{const ys=[ms.label];ke.forEach(ht=>{let Ft="";ms.isFormula?Ft=`(${L[ht]?.freshCalls||0} + ${L[ht]?.followUps||0})`:ms.key==="responseRate"?Ft=`${L[ht]?.[ms.key]||0}%`:Ft=L[ht]?.[ms.key]||0,ys.push(Ft)}),X.push(ys);const Re=ms.highlight?ms.highlightDark?"C8E6C9":"E8F5E9":"FFFFFF";ue[Fe]={cells:ys.map((ht,Ft)=>({font:{bold:ms.bold||Ft===0,sz:10,color:{rgb:Ft===0?"1F2937":"374151"}},fill:{fgColor:{rgb:Re}},alignment:{horizontal:Ft===0?"left":"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}},numFmt:Ft>0&&typeof ht=="number"?"0":void 0}))},Fe++})})});const Qe=Qf.utils.aoa_to_sheet(X);Object.keys(Qe).forEach($t=>{if($t.startsWith("!"))return;const Mt=Qf.utils.decode_cell($t),Es=ue[Mt.r];if(Es){Es.merge&&Mt.c===0&&(Qe["!merges"]||(Qe["!merges"]=[]),Qe["!merges"].push(Es.merge));const qs=Es.cells[Mt.c];qs&&(Qe[$t].s=qs)}});const Ve=[{wch:28}];ke.forEach(()=>{Ve.push({wch:14})}),Qe["!cols"]=Ve,Qe["!rows"]=[],ue.forEach(($t,Mt)=>{$t&&$t.merge?Qe["!rows"][Mt]={hpt:25}:Mt===0?Qe["!rows"][Mt]={hpt:22}:Qe["!rows"][Mt]={hpt:18}}),Qe["!freeze"]={xSplit:1,ySplit:4,topLeftCell:"B5",activePane:"bottomRight",state:"frozen"},Qf.utils.book_append_sheet(H,Qe,"Report");const xt=F==="day"?"Day":"Month",nt=`${a?.companyName||"Report"}_${xt}_View_${new Date().toISOString().split("T")[0]}.xlsx`;Qf.writeFile(H,nt)}catch(H){console.error("Error exporting to Excel:",H),alert("Failed to export report. Please try again.")}},[ke,L,ye,Ye,F,a]);return w?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-gray-200 border-t-indigo-600 mx-auto"}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"h-8 w-8 bg-indigo-600 rounded-full animate-pulse"})})]}),t.jsx("p",{className:"mt-6 text-lg font-semibold text-gray-700",children:"Loading Report Data"}),t.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Please wait while we fetch your analytics..."})]})}):P?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center p-6",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-8 max-w-md w-full text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error Loading Report"}),t.jsx("p",{className:"text-gray-600 mb-6",children:P}),t.jsxs("div",{className:"flex gap-3 justify-center",children:[t.jsx("button",{onClick:()=>n("/projects"),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Back to Projects"}),t.jsx("button",{onClick:ze,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium",children:"Retry"})]})]})}):a?t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-40 lg:top-0",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4 sm:py-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors duration-200 mb-4 group",children:[t.jsx("svg",{className:"w-4 h-4 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Monthly Report"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h2",{className:"text-xl font-semibold text-indigo-600",children:a.companyName}),a.website&&t.jsxs("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),a.website]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-xl p-1.5 border border-gray-200 shadow-inner",children:[t.jsx("button",{onClick:()=>O("day"),className:`px-5 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200 ${F==="day"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg shadow-indigo-200":"text-gray-700 hover:bg-white hover:text-gray-900"}`,children:"Day View"}),t.jsx("button",{onClick:()=>O("month"),className:`px-5 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200 ${F==="month"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg shadow-indigo-200":"text-gray-700 hover:bg-white hover:text-gray-900"}`,children:"Month View"})]}),t.jsxs("button",{onClick:W,disabled:ke.length===0||S,className:"px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 font-semibold text-sm flex items-center gap-2 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Excel"]})]})]})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8",children:[S&&t.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-center gap-3",children:[t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),t.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Calculating report metrics..."})]}),ke.length===0?t.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-12 text-center",children:[t.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Data Available"}),t.jsx("p",{className:"text-gray-500",children:"There is no data available for this period."})]}):(()=>{const H=Object.values(le).filter(Boolean).length,X=Object.keys(Ye);return H===1?t.jsx("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-blue-50",children:[t.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider border-r-2 border-gray-300 sticky left-0 bg-blue-50 z-20",children:"Key Results"}),ke.map(je=>t.jsx("th",{onClick:()=>De(je),className:"px-3 sm:px-4 py-3 text-center text-xs font-bold text-gray-900 uppercase tracking-wider border-r border-gray-300 last:border-r-0 bg-blue-50 cursor-pointer hover:underline",children:je},je))]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ye.map((je,Q)=>t.jsxs(Mo.Fragment,{children:[F==="day"&&je.month&&t.jsx("tr",{children:t.jsx("td",{colSpan:ke.length+1,className:"px-4 sm:px-6 py-2.5 bg-yellow-100 text-center font-bold text-sm text-gray-900 border-b-2 border-yellow-300",children:je.month})}),Q===0||F==="day"&&Q>0&&ye[Q-1].monthKey!==je.monthKey?Object.keys(Ye).map(we=>t.jsxs(Mo.Fragment,{children:[t.jsx("tr",{className:"bg-amber-50 border-y border-amber-200",children:t.jsx("td",{colSpan:ke.length+1,className:"px-4 sm:px-6 py-2.5 sticky left-0 bg-amber-50 z-20",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-1 h-5 bg-amber-500 rounded-full"}),t.jsx("span",{className:"text-xs font-bold text-gray-900",children:we})]})})}),Ye[we].map(Fe=>t.jsxs("tr",{className:`${Fe.highlight?Fe.highlightDark?"bg-green-100":"bg-green-50":"bg-white hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-4 sm:px-6 py-3 whitespace-nowrap text-sm border-r-2 border-gray-200 sticky left-0 z-20 ${Fe.highlight?Fe.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${Fe.bold?"font-bold text-gray-900":"font-medium text-gray-700"}`,children:Fe.label}),ke.map(ue=>{const xe=Fe.isFormula?`(${L[ue]?.freshCalls||0} + ${L[ue]?.followUps||0})`:Fe.key==="responseRate"?`${L[ue]?.[Fe.key]||0}%`:L[ue]?.[Fe.key]||0,tt=!Fe.isFormula&&xe!==0&&xe!=="0%";return t.jsx("td",{onClick:()=>tt&&_e(Fe,ue,we),className:`px-3 sm:px-4 py-3 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${Fe.highlight?Fe.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${Fe.bold?"font-bold text-gray-900":"font-medium text-gray-700"} ${tt?"cursor-pointer hover:bg-blue-50 hover:underline":""}`,children:xe},ue)})]},`${je.monthKey||Q}-${we}-${Fe.key}`))]},`${je.monthKey||Q}-${we}`)):null]},je.monthKey||Q))})]})})}):t.jsx("div",{className:"space-y-6",children:X.map(je=>t.jsx("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-blue-50",children:[t.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider border-r-2 border-gray-300 sticky left-0 bg-blue-50 z-20",children:"Key Results"}),ke.map(Q=>t.jsx("th",{onClick:()=>De(Q),className:"px-3 sm:px-4 py-3 text-center text-xs font-bold text-gray-900 uppercase tracking-wider border-r border-gray-300 last:border-r-0 bg-blue-50 cursor-pointer hover:underline",children:Q},Q))]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ye.map((Q,we)=>t.jsxs(Mo.Fragment,{children:[F==="day"&&Q.month&&t.jsx("tr",{children:t.jsx("td",{colSpan:ke.length+1,className:"px-4 sm:px-6 py-2.5 bg-yellow-100 text-center font-bold text-sm text-gray-900 border-b-2 border-yellow-300",children:Q.month})}),we===0||F==="day"&&we>0&&ye[we-1].monthKey!==Q.monthKey?t.jsxs(Mo.Fragment,{children:[t.jsx("tr",{className:"bg-amber-50 border-y border-amber-200",children:t.jsx("td",{colSpan:ke.length+1,className:"px-4 sm:px-6 py-2.5 sticky left-0 bg-amber-50 z-20",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-1 h-5 bg-amber-500 rounded-full"}),t.jsx("span",{className:"text-xs font-bold text-gray-900",children:je})]})})}),Ye[je].map(Fe=>t.jsxs("tr",{className:`${Fe.highlight?Fe.highlightDark?"bg-green-100":"bg-green-50":"bg-white hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-4 sm:px-6 py-3 whitespace-nowrap text-sm border-r-2 border-gray-200 sticky left-0 z-20 ${Fe.highlight?Fe.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${Fe.bold?"font-bold text-gray-900":"font-medium text-gray-700"}`,children:Fe.label}),ke.map(ue=>{const xe=Fe.isFormula?`(${L[ue]?.freshCalls||0} + ${L[ue]?.followUps||0})`:Fe.key==="responseRate"?`${L[ue]?.[Fe.key]||0}%`:L[ue]?.[Fe.key]||0,tt=!Fe.isFormula&&xe!==0&&xe!=="0%";return t.jsx("td",{onClick:()=>tt&&_e(Fe,ue,je),className:`px-3 sm:px-4 py-3 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${Fe.highlight?Fe.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${Fe.bold?"font-bold text-gray-900":"font-medium text-gray-700"} ${tt?"cursor-pointer hover:bg-blue-50 hover:underline":""}`,children:xe},ue)})]},`${Q.monthKey||we}-${je}-${Fe.key}`))]}):null]},Q.monthKey||we))})]})})},je))})})()]}),ne.isOpen&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:ne.metric?ne.metric==="allForPeriod"?`All Prospects - ${ne.section}`:`${Se.find(X=>X.key===ne.metric)?.label||ne.metric} - ${ne.section}`:""}),t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Period: ",ne.period]}),!Ne&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing ",V(ne.metric,ne.period,ne.channel).length," prospects"]})]}),t.jsx("button",{onClick:()=>se({isOpen:!1,metric:null,period:null,channel:null,section:null}),className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:Ne?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsx("p",{className:"text-sm font-medium",children:"Loading prospects..."})]}):be.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm font-medium",children:"No prospects found for this metric"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"CONTACT"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"COMPANY"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"DATE"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"STATUS"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:be.map(H=>{const X=(H._id?.toString?H._id.toString():H._id)||"",je=pe.byPeriodAndContact.get(ne.period)?.get(X)||[],Q=je.find(xe=>{if(ne.channel==="call"&&xe.type!=="call"||ne.channel==="linkedin"&&xe.type!=="linkedin"||ne.channel==="email"&&xe.type!=="email")return!1;if(ne.channel==="call"){const tt={interested:"Interested",notInterested:"Not Interested",ring:"Ring",busy:"Busy",hangUp:"Hang Up",callBack:"Call Back",switchOff:"Switch Off",detailsShared:"Details Shared",future:"Future",invalid:"Invalid",demoBooked:"Demo Booked"};return xe.callStatus===tt[ne.metric]}return!0})||je[0],we=Q?Q.callDate?new Date(Q.callDate):Q.emailDate?new Date(Q.emailDate):new Date(Q.createdAt):H.createdAt?new Date(H.createdAt):null,Fe=we?we.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",ue=Q?.callStatus||Q?.status||H.stage||"New";return t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:H.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:H.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:Fe}),t.jsx("td",{className:"px-4 py-3 text-sm",children:t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded-full border border-green-200",children:ue})})]},H._id||H.name)})})]})})})]})})]}):t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-8 text-center max-w-md",children:[t.jsx("p",{className:"text-gray-600 mb-4",children:"Project not found"}),t.jsx("button",{onClick:()=>n("/projects"),className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium",children:"Back to Projects"})]})})}function IC(){const l=Dr(),[n,a]=B.useState([]),[o,s]=B.useState(!0),[e,m]=B.useState(null),[v,w]=B.useState(""),[N,S]=B.useState(!1);B.useEffect(()=>{S(!0),D()},[v]);const D=async()=>{try{s(!0);const F={};v&&(F.search=v);const O=await Ut.get("/projects",{params:F});O.data.success&&a(O.data.data||[])}catch(F){console.error("Error fetching projects:",F),m("Failed to load projects")}finally{s(!1)}},L=F=>F?new Date(F).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",M=F=>{const O={active:{bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200",label:"Active",dot:"bg-emerald-500"},draft:{bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",label:"Draft",dot:"bg-amber-500"},completed:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-200",label:"Completed",dot:"bg-blue-500"},archived:{bg:"bg-slate-50",text:"text-slate-700",border:"border-slate-200",label:"Archived",dot:"bg-slate-500"}},P=O[F]||O.draft;return t.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-md border ${P.bg} ${P.text} ${P.border} transition-colors`,children:[t.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${P.dot}`}),P.label]})};return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[t.jsx("div",{className:`mb-10 transition-all duration-500 ${N?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-blue-600 to-indigo-600 rounded-full"}),t.jsx("h1",{className:"text-2xl font-semibold text-slate-900 tracking-tight",children:"Funnel Management"})]}),t.jsx("p",{className:"text-sm text-slate-500 ml-4",children:"Select a project to view detailed funnel metrics and analytics"})]})}),t.jsx("div",{className:`mb-8 transition-all duration-500 delay-75 ${N?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:t.jsxs("div",{className:"relative max-w-md",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"h-4 w-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",placeholder:"Search projects by name, company, or email...",value:v,onChange:F=>w(F.target.value),className:"block w-full pl-10 pr-10 py-2.5 border border-slate-200 rounded-md bg-white text-sm text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-slate-900 focus:border-slate-900 transition-all shadow-sm"}),v&&t.jsx("button",{onClick:()=>w(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 transition-colors",children:t.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e&&t.jsx("div",{className:"mb-6 rounded-lg bg-red-50 border border-red-200 p-4",children:t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("svg",{className:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("div",{className:"ml-3",children:t.jsx("p",{className:"text-sm font-medium text-red-800",children:e})})]})}),o?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[...Array(6)].map((F,O)=>t.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm p-6 animate-pulse",children:[t.jsxs("div",{className:"flex items-start justify-between mb-5",children:[t.jsxs("div",{className:"flex-1 space-y-2.5",children:[t.jsx("div",{className:"h-5 bg-slate-200 rounded w-3/4"}),t.jsx("div",{className:"h-3 bg-slate-200 rounded w-1/2"})]}),t.jsx("div",{className:"h-6 bg-slate-200 rounded-md w-16"})]}),t.jsxs("div",{className:"space-y-3 mb-5",children:[t.jsx("div",{className:"h-4 bg-slate-200 rounded"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded w-5/6"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded w-4/6"})]}),t.jsx("div",{className:"h-px bg-slate-200 mb-4"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded w-1/3"})]},O))}):n.length>0?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:n.map((F,O)=>t.jsx("div",{onClick:()=>l(`/projects/${F._id}`),className:`group relative bg-white rounded-lg border border-slate-200 shadow-sm hover:shadow hover:border-slate-300 cursor-pointer transition-all duration-150 flex flex-col ${N?"opacity-100":"opacity-0"}`,style:{animationDelay:`${O*30}ms`,minHeight:"240px"},children:t.jsxs("div",{className:"p-6 flex flex-col h-full",children:[t.jsxs("div",{className:"flex items-start justify-between mb-5 min-h-[56px]",children:[t.jsxs("div",{className:"flex-1 min-w-0 pr-3",children:[t.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1.5 truncate",children:F.companyName||"N/A"}),t.jsx("p",{className:"text-xs text-slate-500 min-h-[16px]",children:F.industry||""})]}),t.jsx("div",{className:"flex-shrink-0",children:M(F.status||"draft")})]}),t.jsxs("div",{className:"space-y-3 mb-5 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2.5 min-h-[20px]",children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0 text-slate-400",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:`truncate text-sm ${F.contactPerson?.fullName?"text-slate-600":"text-slate-400"}`,children:F.contactPerson?.fullName||"No contact name"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 min-h-[20px]",children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0 text-slate-400",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:`truncate text-sm ${F.contactPerson?.email?"text-slate-600":"text-slate-400"}`,children:F.contactPerson?.email||"No email"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 min-h-[20px]",children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0 text-slate-400",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-sm text-slate-600",children:L(F.createdAt)})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100",children:[t.jsx("span",{className:"text-xs font-medium text-slate-700 group-hover:text-blue-600 transition-colors",children:"View Funnel"}),t.jsx("svg",{className:"w-4 h-4 text-slate-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})},F._id))}):t.jsx("div",{className:`bg-white rounded-lg border border-slate-200 shadow-sm p-12 transition-all duration-500 ${N?"opacity-100":"opacity-0"}`,children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[t.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-lg flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),t.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-1",children:"No projects found"}),t.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Get started by creating your first project"}),t.jsxs("button",{onClick:()=>l("/projects/new"),className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-900 text-white text-sm font-medium rounded-lg hover:bg-slate-800 transition-colors",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Project"]})]})})]})})}function BC(){const{id:l}=di(),n=Dr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({prospectData:0,connectionSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0});B.useEffect(()=>{l&&L()},[l]),B.useEffect(()=>{(s.length>0||m.length>0)&&M()},[s,m]);const L=async()=>{try{N(!0);const O=await Ut.get(`/projects/${l}`);O.data.success&&o(O.data.data);const P=await Ut.get(`/projects/${l}/project-contacts`);P.data.success&&e(P.data.data||[]);const K=await Ut.get(`/activities/project/${l}?limit=10000`);if(K.data.success){const se=(K.data.data||[]).filter(Ce=>Ce.type==="linkedin");v(se)}}catch(O){console.error("Error fetching data:",O)}finally{N(!1)}},M=()=>{const O={prospectData:s.length,connectionSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0},P={};m.forEach(de=>{if(!de.contactId)return;const le=de.contactId.toString();P[le]||(P[le]=[]),P[le].push(de)});const K=new Set,ne=new Set,se=new Set,Ce=new Set,ge=new Set,Ne=new Set,J=new Set;m.forEach(de=>{const le=de.contactId?.toString();le&&((de.lnRequestSent==="Yes"||de.lnRequestSent===!0)&&K.add(le),(de.connected==="Yes"||de.connected===!0)&&ne.add(le),de.status==="CIP"&&se.add(le),de.status==="Meeting Proposed"&&Ce.add(le),de.status==="Meeting Scheduled"&&ge.add(le),de.status==="Meeting Completed"&&Ne.add(le),(de.status==="Meeting Completed"||de.status==="Interested")&&J.add(le))}),Object.keys(P).forEach(de=>{P[de].filter(me=>me.conversationNotes&&me.conversationNotes.trim()!=="").length>1&&O.followups++}),O.connectionSent=K.size,O.accepted=ne.size,O.cip=se.size,O.meetingProposed=Ce.size,O.scheduled=ge.size,O.completed=Ne.size,O.sql=J.size,D(O)},F=[{key:"prospectData",label:"Prospect Data",description:"Total prospects from this project"},{key:"connectionSent",label:"Connection Sent",description:"Connection requests sent"},{key:"accepted",label:"Accepted",description:"Connections accepted"},{key:"followups",label:"Followups",description:"Contacts with multiple messages"},{key:"cip",label:"CIP",description:"Conversations in Progress"},{key:"meetingProposed",label:"Meeting Proposed",description:"Meetings proposed"},{key:"scheduled",label:"Scheduled",description:"Meetings scheduled"},{key:"completed",label:"Completed",description:"Meetings completed"},{key:"sql",label:"SQL",description:"Sales Qualified Leads"}];return w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading funnel data..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 lg:px-6 py-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200 mb-6",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-indigo-500 to-indigo-700 rounded-full"}),t.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["LinkedIn Funnel - ",a?.companyName||"Project"]})]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-white to-gray-50 border border-gray-200 rounded-lg shadow-lg p-4 backdrop-blur-sm",children:[t.jsxs("div",{className:"mb-3 text-center",children:[t.jsx("h2",{className:"text-base font-bold text-gray-800 mb-0.5",children:"Sales Funnel Performance"}),t.jsx("p",{className:"text-[10px] text-gray-600",children:"Conversion metrics and pipeline health"})]}),t.jsx("div",{className:"flex flex-col items-center space-y-0.5",children:F.map((O,P)=>{const K=S[O.key]||0,ne=S.prospectData||1,se=ne>0?K/ne*100:0,ge=[96,88,78,68,58,48,38,28,20][P]||15;let Ne="",J="text-white",de="",le="",ze="";P===0?(Ne="from-blue-600 via-blue-500 to-indigo-500",de="border-blue-400",le="shadow-blue-500/30",ze="bg-blue-400/30"):P>=5?(Ne="from-indigo-600 via-indigo-500 to-purple-500",de="border-indigo-400",le="shadow-indigo-500/30",ze="bg-indigo-400/30"):(Ne="from-slate-600 via-slate-500 to-gray-500",de="border-slate-400",le="shadow-slate-500/30",ze="bg-slate-400/30");const me=["","","","","","","","",""];return t.jsxs("div",{className:"w-full flex flex-col items-center transition-all duration-700 ease-out",style:{animation:`fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) ${P*.08}s both`},children:[t.jsxs("div",{className:`relative bg-gradient-to-r ${Ne} ${de} border rounded-md shadow-md ${le} hover:shadow-lg transition-all duration-500 transform hover:scale-[1.01] hover:-translate-y-0.5 group overflow-hidden`,style:{width:`${ge}%`,minWidth:"150px",backdropFilter:"blur(10px)"},children:[t.jsxs("div",{className:"absolute inset-0 opacity-10",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent"}),t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1),transparent_50%)]"})]}),t.jsxs("div",{className:"relative px-3 py-1.5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:`${ze} backdrop-blur-sm rounded p-1 shadow-sm`,children:t.jsx("span",{className:"text-sm",children:me[P]})}),t.jsxs("div",{children:[t.jsx("span",{className:`${J} text-[10px] font-bold uppercase tracking-wide block leading-tight`,children:O.label}),t.jsx("span",{className:`${J} text-[9px] opacity-80 mt-0 block`,children:O.description})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:`${J} text-lg font-extrabold mb-0 drop-shadow-lg`,children:K.toLocaleString()}),P>0&&ne>0&&t.jsxs("div",{className:`${J} text-[9px] font-semibold bg-white/20 backdrop-blur-sm px-1.5 py-0.5 rounded-full border border-white/30`,children:[se.toFixed(1),"%"]})]})]}),P>0&&t.jsx("div",{className:"mt-1 h-0.5 bg-white/20 backdrop-blur-sm rounded-full overflow-hidden border border-white/20",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-white/80 to-white rounded-full transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min(se,100)}%`,animation:`progressFill 1.5s ease-out ${P*.1+.5}s both`}})})]}),t.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),P<F.length-1&&t.jsxs("div",{className:"relative my-0.5",children:[t.jsx("div",{className:"w-0.5 h-2 bg-gradient-to-b from-gray-400 via-gray-500 to-gray-400 rounded-full shadow-inner mx-auto"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-gray-500 rounded-full shadow-sm"})]})]},O.key)})})]}),t.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(30px) scale(0.95);
            }
            to {
              opacity: 1;
              transform: translateY(0) scale(1);
            }
          }
          
          @keyframes progressFill {
            from {
              width: 0%;
            }
          }
          
          .shadow-3xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
          }
        `}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 via-blue-500 to-indigo-500 rounded-xl p-4 shadow-xl hover:shadow-blue-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Total Prospects"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsx("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:S.prospectData.toLocaleString()}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Pipeline foundation"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-emerald-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Conversion Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.completed/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Meetings completed"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-indigo-600 via-indigo-500 to-purple-500 rounded-xl p-4 shadow-xl hover:shadow-indigo-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"SQL Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.sql/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Sales qualified leads"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]})]})]})})}function zC(){const{id:l}=di(),n=Dr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({prospectData:0,callsAttempted:0,callsConnected:0,decisionMakerReached:0,interested:0,detailsShared:0,demoBooked:0,demoCompleted:0,sql:0,won:0});B.useEffect(()=>{l&&L()},[l]),B.useEffect(()=>{l&&(s.length>0||m.length>0)?M():l&&s.length===0&&m.length===0&&D({prospectData:0,callsAttempted:0,callsConnected:0,decisionMakerReached:0,interested:0,detailsShared:0,demoBooked:0,demoCompleted:0,sql:0,won:0})},[l,s,m]);const L=async()=>{try{N(!0);const O=await Ut.get(`/projects/${l}`);O.data.success&&o(O.data.data);const P=await Ut.get(`/projects/${l}/project-contacts`);P.data.success&&e(P.data.data||[]);const K=await Ut.get(`/activities/project/${l}?limit=10000`);if(K.data.success){const se=(K.data.data||[]).filter(Ce=>Ce.type==="call");v(se)}}catch(O){console.error("Error fetching data:",O)}finally{N(!1)}},M=()=>{console.log("Calculating funnel data...",{contactsCount:s.length,activitiesCount:m.length});const O={prospectData:s.length,callsAttempted:0,callsConnected:0,decisionMakerReached:0,interested:0,detailsShared:0,demoBooked:0,demoCompleted:0,sql:0,won:0};if(m.length===0){console.log("No activities found, setting default data"),D(O);return}const P=new Set,K=new Set,ne=new Set,se=new Set,Ce=new Set,ge=new Set,Ne=new Set,J=new Set,de=new Set;m.forEach(le=>{const ze=le.contactId?.toString();if(!ze)return;le.callDate&&P.add(ze);const me=["Interested","Not Interested","Call Back","Future","Details Shared","Demo Booked","Demo Completed","Existing"];le.callStatus&&me.includes(le.callStatus)&&K.add(ze);const oe=["Interested","Details Shared","Demo Booked","Demo Completed"];le.callStatus&&oe.includes(le.callStatus)&&ne.add(ze),le.callStatus==="Interested"&&se.add(ze),le.callStatus==="Details Shared"&&Ce.add(ze),le.callStatus==="Demo Booked"&&ge.add(ze),le.callStatus==="Demo Completed"&&Ne.add(ze),(le.callStatus==="Demo Completed"||le.callStatus==="Interested"&&le.conversationNotes&&le.conversationNotes.length>50||le.status==="SQL")&&J.add(ze),le.status==="WON"&&de.add(ze)}),O.callsAttempted=P.size,O.callsConnected=K.size,O.decisionMakerReached=ne.size,O.interested=se.size,O.detailsShared=Ce.size,O.demoBooked=ge.size,O.demoCompleted=Ne.size,O.sql=J.size,O.won=de.size,console.log("Funnel data calculated:",O),console.log("Stage breakdown:",{callsAttempted:O.callsAttempted,callsConnected:O.callsConnected,decisionMakerReached:O.decisionMakerReached,interested:O.interested,detailsShared:O.detailsShared,demoBooked:O.demoBooked,demoCompleted:O.demoCompleted,sql:O.sql,won:O.won}),D(O)},F=[{key:"prospectData",label:"Prospect Data",description:"Total prospects from this project"},{key:"callsAttempted",label:"Calls Attempted",description:"Total calls made to prospects"},{key:"callsConnected",label:"Calls Connected",description:"Calls where contact answered"},{key:"decisionMakerReached",label:"Decision Maker Reached",description:"Reached decision maker"},{key:"interested",label:"Interested",description:"Prospects showing interest"},{key:"detailsShared",label:"Details Shared",description:"Product/service details shared"},{key:"demoBooked",label:"Demo Booked",description:"Demos scheduled"},{key:"demoCompleted",label:"Demo Completed",description:"Demos successfully completed"},{key:"sql",label:"SQL",description:"Sales Qualified Leads"},{key:"won",label:"WON",description:"Deals closed successfully"}];return B.useEffect(()=>{console.log("Funnel rows configured:",F.length,"stages"),console.log("Stage labels:",F.map(O=>O.label))},[]),w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading funnel data..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 lg:px-6 py-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200 mb-6",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-emerald-500 to-emerald-700 rounded-full"}),t.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["Cold Calling Funnel - ",a?.companyName||"Project"]})]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-white to-gray-50 border border-gray-200 rounded-lg shadow-lg p-4 backdrop-blur-sm",children:[t.jsxs("div",{className:"mb-3 text-center",children:[t.jsx("h2",{className:"text-base font-bold text-gray-800 mb-0.5",children:"Cold Calling Funnel Performance"}),t.jsx("p",{className:"text-[10px] text-gray-600",children:"Updated: 10-Stage Funnel  Conversion metrics and pipeline health"}),t.jsxs("div",{className:"mt-1 text-[9px] text-blue-600 font-semibold",children:["Stages: ",F.length," | Total Prospects: ",S.prospectData]}),S.prospectData===0&&t.jsx("p",{className:"text-xs text-amber-600 mt-2 font-medium",children:" No prospects found. Add contacts to see funnel data."})]}),t.jsx("div",{className:"flex flex-col items-center space-y-0.5",children:F.map((O,P)=>{const K=S[O.key]!==void 0?S[O.key]:0,ne=S.prospectData||1,se=ne>0?K/ne*100:0;P===0&&console.log(`Rendering stage ${P}: ${O.label} = ${K} (key: ${O.key})`);const ge=[96,88,80,72,64,56,48,40,32,24][P]||20;let Ne="",J="text-white",de="",le="",ze="";P===0?(Ne="from-blue-600 via-blue-500 to-cyan-500",de="border-blue-400",le="shadow-blue-500/30",ze="bg-blue-400/30"):P===1||P===2?(Ne="from-purple-600 via-purple-500 to-indigo-500",de="border-purple-400",le="shadow-purple-500/30",ze="bg-purple-400/30"):P===3||P===4?(Ne="from-orange-600 via-orange-500 to-amber-500",de="border-orange-400",le="shadow-orange-500/30",ze="bg-orange-400/30"):P===5||P===6?(Ne="from-yellow-600 via-yellow-500 to-amber-500",de="border-yellow-400",le="shadow-yellow-500/30",ze="bg-yellow-400/30"):P===7||P===8?(Ne="from-emerald-600 via-emerald-500 to-teal-500",de="border-emerald-400",le="shadow-emerald-500/30",ze="bg-emerald-400/30"):(Ne="from-amber-600 via-amber-500 to-yellow-500",de="border-amber-400",le="shadow-amber-500/30",ze="bg-amber-400/30");const me=["","","","","","","","","",""];return t.jsxs("div",{className:"w-full flex flex-col items-center transition-all duration-700 ease-out",style:{animation:`fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) ${P*.08}s both`},children:[t.jsxs("div",{className:`relative bg-gradient-to-r ${Ne} ${de} border rounded-md shadow-md ${le} hover:shadow-lg transition-all duration-500 transform hover:scale-[1.01] hover:-translate-y-0.5 group overflow-hidden`,style:{width:`${ge}%`,minWidth:"150px",backdropFilter:"blur(10px)"},children:[t.jsxs("div",{className:"absolute inset-0 opacity-10",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent"}),t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1),transparent_50%)]"})]}),t.jsxs("div",{className:"relative px-3 py-1.5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:`${ze} backdrop-blur-sm rounded p-1 shadow-sm`,children:t.jsx("span",{className:"text-sm",children:me[P]||""})}),t.jsxs("div",{children:[t.jsx("span",{className:`${J} text-[10px] font-bold uppercase tracking-wide block leading-tight`,children:O.label}),t.jsx("span",{className:`${J} text-[9px] opacity-80 mt-0 block`,children:O.description})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:`${J} text-lg font-extrabold mb-0 drop-shadow-lg`,children:K.toLocaleString()}),P>0&&ne>0&&t.jsxs("div",{className:`${J} text-[9px] font-semibold bg-white/20 backdrop-blur-sm px-1.5 py-0.5 rounded-full border border-white/30`,children:[se.toFixed(1),"%"]})]})]}),P>0&&t.jsx("div",{className:"mt-1 h-0.5 bg-white/20 backdrop-blur-sm rounded-full overflow-hidden border border-white/20",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-white/80 to-white rounded-full transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min(se,100)}%`,animation:`progressFill 1.5s ease-out ${P*.1+.5}s both`}})})]}),t.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),P<F.length-1&&t.jsxs("div",{className:"relative my-0.5",children:[t.jsx("div",{className:"w-0.5 h-2 bg-gradient-to-b from-gray-400 via-gray-500 to-gray-400 rounded-full shadow-inner mx-auto"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-gray-500 rounded-full shadow-sm"})]})]},O.key)})},`funnel-${F.length}`)]}),t.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(30px) scale(0.95);
            }
            to {
              opacity: 1;
              transform: translateY(0) scale(1);
            }
          }
          
          @keyframes progressFill {
            from {
              width: 0%;
            }
          }
          
          .shadow-3xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
          }
        `}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 via-blue-500 to-cyan-500 rounded-xl p-4 shadow-xl hover:shadow-blue-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Total Prospects"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsx("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:S.prospectData.toLocaleString()}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Pipeline foundation"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-emerald-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Conversion Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.demoCompleted/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Demos completed"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 rounded-xl p-4 shadow-xl hover:shadow-teal-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"SQL Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.sql/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Sales qualified leads"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]})]})]})})}function UC(){const{id:l}=di(),n=Dr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({prospectData:0,emailSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0});B.useEffect(()=>{l&&L()},[l]),B.useEffect(()=>{(s.length>0||m.length>0)&&M()},[s,m]);const L=async()=>{try{N(!0);const O=await Ut.get(`/projects/${l}`);O.data.success&&o(O.data.data);const P=await Ut.get(`/projects/${l}/project-contacts`);P.data.success&&e(P.data.data||[]);const K=await Ut.get(`/activities/project/${l}?limit=10000`);if(K.data.success){const se=(K.data.data||[]).filter(Ce=>Ce.type==="email");v(se)}}catch(O){console.error("Error fetching data:",O)}finally{N(!1)}},M=()=>{const O={prospectData:s.length,emailSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0},P={};m.forEach(de=>{if(!de.contactId)return;const le=de.contactId.toString();P[le]||(P[le]=[]),P[le].push(de)});const K=new Set,ne=new Set,se=new Set,Ce=new Set,ge=new Set,Ne=new Set,J=new Set;m.forEach(de=>{const le=de.contactId?.toString();le&&(de.emailDate&&K.add(le),(de.status==="Interested"||de.status==="Meeting Proposed"||de.status==="Meeting Scheduled")&&ne.add(le),(de.status==="Interested"||de.status==="Out of Office")&&se.add(le),de.status==="Meeting Proposed"&&Ce.add(le),(de.status==="Meeting Scheduled"||de.nextActionDate)&&ge.add(le),de.status==="Meeting Completed"&&Ne.add(le),(de.status==="Meeting Completed"||de.status==="Interested"&&de.conversationNotes&&de.conversationNotes.length>50)&&J.add(le))}),Object.keys(P).forEach(de=>{const le=P[de];(le.filter(me=>me.conversationNotes&&me.conversationNotes.trim()!=="").length>1||le.length>1)&&O.followups++}),O.emailSent=K.size,O.accepted=ne.size,O.cip=se.size,O.meetingProposed=Ce.size,O.scheduled=ge.size,O.completed=Ne.size,O.sql=J.size,D(O)},F=[{key:"prospectData",label:"Prospect Data",description:"Total prospects from this project"},{key:"emailSent",label:"Email Sent",description:"Emails sent to prospects"},{key:"accepted",label:"Accepted",description:"Emails accepted/responded"},{key:"followups",label:"Followups",description:"Contacts with multiple emails"},{key:"cip",label:"CIP",description:"Conversations in Progress"},{key:"meetingProposed",label:"Meeting Proposed",description:"Meetings proposed"},{key:"scheduled",label:"Scheduled",description:"Meetings scheduled"},{key:"completed",label:"Completed",description:"Meetings completed"},{key:"sql",label:"SQL",description:"Sales Qualified Leads"}];return w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading funnel data..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 lg:px-6 py-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200 mb-6",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-blue-500 to-blue-700 rounded-full"}),t.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["Email Funnel - ",a?.companyName||"Project"]})]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-white to-gray-50 border border-gray-200 rounded-lg shadow-lg p-4 backdrop-blur-sm",children:[t.jsxs("div",{className:"mb-3 text-center",children:[t.jsx("h2",{className:"text-base font-bold text-gray-800 mb-0.5",children:"Sales Funnel Performance"}),t.jsx("p",{className:"text-[10px] text-gray-600",children:"Conversion metrics and pipeline health"})]}),t.jsx("div",{className:"flex flex-col items-center space-y-0.5",children:F.map((O,P)=>{const K=S[O.key]||0,ne=S.prospectData||1,se=ne>0?K/ne*100:0,ge=[96,88,78,68,58,48,38,28,20][P]||15;let Ne="",J="text-white",de="",le="",ze="";P===0?(Ne="from-blue-600 via-blue-500 to-cyan-500",de="border-blue-400",le="shadow-blue-500/30",ze="bg-blue-400/30"):P>=5?(Ne="from-cyan-600 via-cyan-500 to-teal-500",de="border-cyan-400",le="shadow-cyan-500/30",ze="bg-cyan-400/30"):(Ne="from-slate-600 via-slate-500 to-gray-500",de="border-slate-400",le="shadow-slate-500/30",ze="bg-slate-400/30");const me=["","","","","","","","",""];return t.jsxs("div",{className:"w-full flex flex-col items-center transition-all duration-700 ease-out",style:{animation:`fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) ${P*.08}s both`},children:[t.jsxs("div",{className:`relative bg-gradient-to-r ${Ne} ${de} border rounded-md shadow-md ${le} hover:shadow-lg transition-all duration-500 transform hover:scale-[1.01] hover:-translate-y-0.5 group overflow-hidden`,style:{width:`${ge}%`,minWidth:"150px",backdropFilter:"blur(10px)"},children:[t.jsxs("div",{className:"absolute inset-0 opacity-10",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent"}),t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1),transparent_50%)]"})]}),t.jsxs("div",{className:"relative px-3 py-1.5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:`${ze} backdrop-blur-sm rounded p-1 shadow-sm`,children:t.jsx("span",{className:"text-sm",children:me[P]})}),t.jsxs("div",{children:[t.jsx("span",{className:`${J} text-[10px] font-bold uppercase tracking-wide block leading-tight`,children:O.label}),t.jsx("span",{className:`${J} text-[9px] opacity-80 mt-0 block`,children:O.description})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:`${J} text-lg font-extrabold mb-0 drop-shadow-lg`,children:K.toLocaleString()}),P>0&&ne>0&&t.jsxs("div",{className:`${J} text-[9px] font-semibold bg-white/20 backdrop-blur-sm px-1.5 py-0.5 rounded-full border border-white/30`,children:[se.toFixed(1),"%"]})]})]}),P>0&&t.jsx("div",{className:"mt-1 h-0.5 bg-white/20 backdrop-blur-sm rounded-full overflow-hidden border border-white/20",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-white/80 to-white rounded-full transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min(se,100)}%`,animation:`progressFill 1.5s ease-out ${P*.1+.5}s both`}})})]}),t.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),P<F.length-1&&t.jsxs("div",{className:"relative my-0.5",children:[t.jsx("div",{className:"w-0.5 h-2 bg-gradient-to-b from-gray-400 via-gray-500 to-gray-400 rounded-full shadow-inner mx-auto"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-gray-500 rounded-full shadow-sm"})]})]},O.key)})})]}),t.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(30px) scale(0.95);
            }
            to {
              opacity: 1;
              transform: translateY(0) scale(1);
            }
          }
          
          @keyframes progressFill {
            from {
              width: 0%;
            }
          }
          
          .shadow-3xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
          }
        `}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 via-blue-500 to-cyan-500 rounded-xl p-4 shadow-xl hover:shadow-blue-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Total Prospects"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsx("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:S.prospectData.toLocaleString()}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Pipeline foundation"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-emerald-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Conversion Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.completed/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Meetings completed"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-cyan-600 via-cyan-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-cyan-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"SQL Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.sql/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Sales qualified leads"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]})]})]})})}const Kr=({children:l})=>localStorage.getItem("token")?l:t.jsx(Jb,{to:"/",replace:!0});function HC(){return t.jsx(uw,{children:t.jsxs(z4,{children:[t.jsx(vr,{path:"/",element:t.jsx(a2,{})}),t.jsx(vr,{path:"/login",element:t.jsx(a2,{})}),t.jsx(vr,{path:"/reset-password",element:t.jsx(Z5,{})}),t.jsxs(vr,{element:t.jsx(jw,{}),children:[t.jsx(vr,{path:"/dashboard",element:t.jsx(Kr,{children:t.jsx(Hk,{})})}),t.jsx(vr,{path:"/master-dashboard",element:t.jsx(Kr,{children:t.jsx(hC,{})})}),t.jsx(vr,{path:"/employee-performance",element:t.jsx(Kr,{children:t.jsx(gC,{})})}),t.jsx(vr,{path:"/contacts",element:t.jsx(Kr,{children:t.jsx(Wk,{})})}),t.jsx(vr,{path:"/contacts/company/:companyName",element:t.jsx(Kr,{children:t.jsx(Yk,{})})}),t.jsx(vr,{path:"/contacts/:id/activities",element:t.jsx(Kr,{children:t.jsx(qk,{})})}),t.jsx(vr,{path:"/contacts/:id",element:t.jsx(Kr,{children:t.jsx($k,{})})}),t.jsx(vr,{path:"/contacts/new",element:t.jsx(Kr,{children:t.jsx(Kk,{})})}),t.jsx(vr,{path:"/import",element:t.jsx(Kr,{children:t.jsx(Gk,{})})}),t.jsx(vr,{path:"/projects",element:t.jsx(Kr,{children:t.jsx(Qk,{})})}),t.jsx(vr,{path:"/projects/dashboard",element:t.jsx(Kr,{children:t.jsx(aC,{})})}),t.jsx(vr,{path:"/prospects/dashboard",element:t.jsx(Kr,{children:t.jsx(cC,{})})}),t.jsx(vr,{path:"/projects/new",element:t.jsx(Kr,{children:t.jsx(Ab,{})})}),t.jsx(vr,{path:"/projects/:id/edit",element:t.jsx(Kr,{children:t.jsx(Ab,{})})}),t.jsx(vr,{path:"/projects/:id",element:t.jsx(Kr,{children:t.jsx(eC,{})})}),t.jsx(vr,{path:"/projects/:id/funnel",element:t.jsx(Kr,{children:t.jsx(pC,{})})}),t.jsx(vr,{path:"/projects/:id/linkedin-funnel",element:t.jsx(Kr,{children:t.jsx(DC,{})})}),t.jsx(vr,{path:"/projects/:id/cold-calling-funnel",element:t.jsx(Kr,{children:t.jsx(TC,{})})}),t.jsx(vr,{path:"/projects/:id/email-funnel",element:t.jsx(Kr,{children:t.jsx(_C,{})})}),t.jsx(vr,{path:"/projects/:id/report",element:t.jsx(Kr,{children:t.jsx(PC,{})})}),t.jsx(vr,{path:"/funnel",element:t.jsx(Kr,{children:t.jsx(IC,{})})}),t.jsx(vr,{path:"/funnel/:id/linkedin",element:t.jsx(Kr,{children:t.jsx(BC,{})})}),t.jsx(vr,{path:"/funnel/:id/cold-calling",element:t.jsx(Kr,{children:t.jsx(zC,{})})}),t.jsx(vr,{path:"/funnel/:id/email",element:t.jsx(Kr,{children:t.jsx(UC,{})})})]})]})})}zv.createRoot(document.getElementById("root")).render(t.jsx(Mo.StrictMode,{children:t.jsx(HC,{})}));
