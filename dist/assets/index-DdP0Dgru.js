(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const m of e.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function a(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerPolicy&&(e.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?e.credentials="include":s.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function o(s){if(s.ep)return;s.ep=!0;const e=a(s);fetch(s.href,e)}})();function Ob(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function Av(l){if(Object.prototype.hasOwnProperty.call(l,"__esModule"))return l;var n=l.default;if(typeof n=="function"){var a=function o(){var s=!1;try{s=this instanceof o}catch{}return s?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};a.prototype=n.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(l).forEach(function(o){var s=Object.getOwnPropertyDescriptor(l,o);Object.defineProperty(a,o,s.get?s:{enumerable:!0,get:function(){return l[o]}})}),a}var a1={exports:{}},Bf={};var Sx;function Ev(){if(Sx)return Bf;Sx=1;var l=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(o,s,e){var m=null;if(e!==void 0&&(m=""+e),s.key!==void 0&&(m=""+s.key),"key"in s){e={};for(var v in s)v!=="key"&&(e[v]=s[v])}else e=s;return s=e.ref,{$$typeof:l,type:o,key:m,ref:s!==void 0?s:null,props:e}}return Bf.Fragment=n,Bf.jsx=a,Bf.jsxs=a,Bf}var Ax;function Dv(){return Ax||(Ax=1,a1.exports=Ev()),a1.exports}var t=Dv(),n1={exports:{}},Es={};var Ex;function Tv(){if(Ex)return Es;Ex=1;var l=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),e=Symbol.for("react.consumer"),m=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),N=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),L=Symbol.iterator;function M(W){return W===null||typeof W!="object"?null:(W=L&&W[L]||W["@@iterator"],typeof W=="function"?W:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,P={};function G(W,pe,Le){this.props=W,this.context=pe,this.refs=P,this.updater=Le||F}G.prototype.isReactComponent={},G.prototype.setState=function(W,pe){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,pe,"setState")},G.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function ae(){}ae.prototype=G.prototype;function re(W,pe,Le){this.props=W,this.context=pe,this.refs=P,this.updater=Le||F}var ke=re.prototype=new ae;ke.constructor=re,O(ke,G.prototype),ke.isPureReactComponent=!0;var xe=Array.isArray;function je(){}var Z={H:null,A:null,T:null,S:null},ce=Object.prototype.hasOwnProperty;function ue(W,pe,Le){var Ae=Le.ref;return{$$typeof:l,type:W,key:pe,ref:Ae!==void 0?Ae:null,props:Le}}function Re(W,pe){return ue(W.type,pe,W.props)}function be(W){return typeof W=="object"&&W!==null&&W.$$typeof===l}function oe(W){var pe={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(Le){return pe[Le]})}var he=/\/+/g;function ye(W,pe){return typeof W=="object"&&W!==null&&W.key!=null?oe(""+W.key):pe.toString(36)}function Te(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(je,je):(W.status="pending",W.then(function(pe){W.status==="pending"&&(W.status="fulfilled",W.value=pe)},function(pe){W.status==="pending"&&(W.status="rejected",W.reason=pe)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function fe(W,pe,Le,Ae,V){var H=typeof W;(H==="undefined"||H==="boolean")&&(W=null);var Q=!1;if(W===null)Q=!0;else switch(H){case"bigint":case"string":case"number":Q=!0;break;case"object":switch(W.$$typeof){case l:case n:Q=!0;break;case S:return Q=W._init,fe(Q(W._payload),pe,Le,Ae,V)}}if(Q)return V=V(W),Q=Ae===""?"."+ye(W,0):Ae,xe(V)?(Le="",Q!=null&&(Le=Q.replace(he,"$&/")+"/"),fe(V,pe,Le,"",function(we){return we})):V!=null&&(be(V)&&(V=Re(V,Le+(V.key==null||W&&W.key===V.key?"":(""+V.key).replace(he,"$&/")+"/")+Q)),pe.push(V)),1;Q=0;var se=Ae===""?".":Ae+":";if(xe(W))for(var de=0;de<W.length;de++)Ae=W[de],H=se+ye(Ae,de),Q+=fe(Ae,pe,Le,H,V);else if(de=M(W),typeof de=="function")for(W=de.call(W),de=0;!(Ae=W.next()).done;)Ae=Ae.value,H=se+ye(Ae,de++),Q+=fe(Ae,pe,Le,H,V);else if(H==="object"){if(typeof W.then=="function")return fe(Te(W),pe,Le,Ae,V);throw pe=String(W),Error("Objects are not valid as a React child (found: "+(pe==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":pe)+"). If you meant to render a collection of children, use an array instead.")}return Q}function _e(W,pe,Le){if(W==null)return W;var Ae=[],V=0;return fe(W,Ae,"","",function(H){return pe.call(Le,H,V++)}),Ae}function We(W){if(W._status===-1){var pe=W._result;pe=pe(),pe.then(function(Le){(W._status===0||W._status===-1)&&(W._status=1,W._result=Le)},function(Le){(W._status===0||W._status===-1)&&(W._status=2,W._result=Le)}),W._status===-1&&(W._status=0,W._result=pe)}if(W._status===1)return W._result.default;throw W._result}var te=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var pe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(pe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)},me={map:_e,forEach:function(W,pe,Le){_e(W,function(){pe.apply(this,arguments)},Le)},count:function(W){var pe=0;return _e(W,function(){pe++}),pe},toArray:function(W){return _e(W,function(pe){return pe})||[]},only:function(W){if(!be(W))throw Error("React.Children.only expected to receive a single React element child.");return W}};return Es.Activity=D,Es.Children=me,Es.Component=G,Es.Fragment=a,Es.Profiler=s,Es.PureComponent=re,Es.StrictMode=o,Es.Suspense=w,Es.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Z,Es.__COMPILER_RUNTIME={__proto__:null,c:function(W){return Z.H.useMemoCache(W)}},Es.cache=function(W){return function(){return W.apply(null,arguments)}},Es.cacheSignal=function(){return null},Es.cloneElement=function(W,pe,Le){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var Ae=O({},W.props),V=W.key;if(pe!=null)for(H in pe.key!==void 0&&(V=""+pe.key),pe)!ce.call(pe,H)||H==="key"||H==="__self"||H==="__source"||H==="ref"&&pe.ref===void 0||(Ae[H]=pe[H]);var H=arguments.length-2;if(H===1)Ae.children=Le;else if(1<H){for(var Q=Array(H),se=0;se<H;se++)Q[se]=arguments[se+2];Ae.children=Q}return ue(W.type,V,Ae)},Es.createContext=function(W){return W={$$typeof:m,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:e,_context:W},W},Es.createElement=function(W,pe,Le){var Ae,V={},H=null;if(pe!=null)for(Ae in pe.key!==void 0&&(H=""+pe.key),pe)ce.call(pe,Ae)&&Ae!=="key"&&Ae!=="__self"&&Ae!=="__source"&&(V[Ae]=pe[Ae]);var Q=arguments.length-2;if(Q===1)V.children=Le;else if(1<Q){for(var se=Array(Q),de=0;de<Q;de++)se[de]=arguments[de+2];V.children=se}if(W&&W.defaultProps)for(Ae in Q=W.defaultProps,Q)V[Ae]===void 0&&(V[Ae]=Q[Ae]);return ue(W,H,V)},Es.createRef=function(){return{current:null}},Es.forwardRef=function(W){return{$$typeof:v,render:W}},Es.isValidElement=be,Es.lazy=function(W){return{$$typeof:S,_payload:{_status:-1,_result:W},_init:We}},Es.memo=function(W,pe){return{$$typeof:N,type:W,compare:pe===void 0?null:pe}},Es.startTransition=function(W){var pe=Z.T,Le={};Z.T=Le;try{var Ae=W(),V=Z.S;V!==null&&V(Le,Ae),typeof Ae=="object"&&Ae!==null&&typeof Ae.then=="function"&&Ae.then(je,te)}catch(H){te(H)}finally{pe!==null&&Le.types!==null&&(pe.types=Le.types),Z.T=pe}},Es.unstable_useCacheRefresh=function(){return Z.H.useCacheRefresh()},Es.use=function(W){return Z.H.use(W)},Es.useActionState=function(W,pe,Le){return Z.H.useActionState(W,pe,Le)},Es.useCallback=function(W,pe){return Z.H.useCallback(W,pe)},Es.useContext=function(W){return Z.H.useContext(W)},Es.useDebugValue=function(){},Es.useDeferredValue=function(W,pe){return Z.H.useDeferredValue(W,pe)},Es.useEffect=function(W,pe){return Z.H.useEffect(W,pe)},Es.useEffectEvent=function(W){return Z.H.useEffectEvent(W)},Es.useId=function(){return Z.H.useId()},Es.useImperativeHandle=function(W,pe,Le){return Z.H.useImperativeHandle(W,pe,Le)},Es.useInsertionEffect=function(W,pe){return Z.H.useInsertionEffect(W,pe)},Es.useLayoutEffect=function(W,pe){return Z.H.useLayoutEffect(W,pe)},Es.useMemo=function(W,pe){return Z.H.useMemo(W,pe)},Es.useOptimistic=function(W,pe){return Z.H.useOptimistic(W,pe)},Es.useReducer=function(W,pe,Le){return Z.H.useReducer(W,pe,Le)},Es.useRef=function(W){return Z.H.useRef(W)},Es.useState=function(W){return Z.H.useState(W)},Es.useSyncExternalStore=function(W,pe,Le){return Z.H.useSyncExternalStore(W,pe,Le)},Es.useTransition=function(){return Z.H.useTransition()},Es.version="19.2.3",Es}var Dx;function ex(){return Dx||(Dx=1,n1.exports=Tv()),n1.exports}var B=ex();const Mo=Ob(B);var i1={exports:{}},zf={},l1={exports:{}},o1={};var Tx;function _v(){return Tx||(Tx=1,(function(l){function n(fe,_e){var We=fe.length;fe.push(_e);e:for(;0<We;){var te=We-1>>>1,me=fe[te];if(0<s(me,_e))fe[te]=_e,fe[We]=me,We=te;else break e}}function a(fe){return fe.length===0?null:fe[0]}function o(fe){if(fe.length===0)return null;var _e=fe[0],We=fe.pop();if(We!==_e){fe[0]=We;e:for(var te=0,me=fe.length,W=me>>>1;te<W;){var pe=2*(te+1)-1,Le=fe[pe],Ae=pe+1,V=fe[Ae];if(0>s(Le,We))Ae<me&&0>s(V,Le)?(fe[te]=V,fe[Ae]=We,te=Ae):(fe[te]=Le,fe[pe]=We,te=pe);else if(Ae<me&&0>s(V,We))fe[te]=V,fe[Ae]=We,te=Ae;else break e}}return _e}function s(fe,_e){var We=fe.sortIndex-_e.sortIndex;return We!==0?We:fe.id-_e.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var e=performance;l.unstable_now=function(){return e.now()}}else{var m=Date,v=m.now();l.unstable_now=function(){return m.now()-v}}var w=[],N=[],S=1,D=null,L=3,M=!1,F=!1,O=!1,P=!1,G=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,re=typeof setImmediate<"u"?setImmediate:null;function ke(fe){for(var _e=a(N);_e!==null;){if(_e.callback===null)o(N);else if(_e.startTime<=fe)o(N),_e.sortIndex=_e.expirationTime,n(w,_e);else break;_e=a(N)}}function xe(fe){if(O=!1,ke(fe),!F)if(a(w)!==null)F=!0,je||(je=!0,oe());else{var _e=a(N);_e!==null&&Te(xe,_e.startTime-fe)}}var je=!1,Z=-1,ce=5,ue=-1;function Re(){return P?!0:!(l.unstable_now()-ue<ce)}function be(){if(P=!1,je){var fe=l.unstable_now();ue=fe;var _e=!0;try{e:{F=!1,O&&(O=!1,ae(Z),Z=-1),M=!0;var We=L;try{t:{for(ke(fe),D=a(w);D!==null&&!(D.expirationTime>fe&&Re());){var te=D.callback;if(typeof te=="function"){D.callback=null,L=D.priorityLevel;var me=te(D.expirationTime<=fe);if(fe=l.unstable_now(),typeof me=="function"){D.callback=me,ke(fe),_e=!0;break t}D===a(w)&&o(w),ke(fe)}else o(w);D=a(w)}if(D!==null)_e=!0;else{var W=a(N);W!==null&&Te(xe,W.startTime-fe),_e=!1}}break e}finally{D=null,L=We,M=!1}_e=void 0}}finally{_e?oe():je=!1}}}var oe;if(typeof re=="function")oe=function(){re(be)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,ye=he.port2;he.port1.onmessage=be,oe=function(){ye.postMessage(null)}}else oe=function(){G(be,0)};function Te(fe,_e){Z=G(function(){fe(l.unstable_now())},_e)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(fe){fe.callback=null},l.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ce=0<fe?Math.floor(1e3/fe):5},l.unstable_getCurrentPriorityLevel=function(){return L},l.unstable_next=function(fe){switch(L){case 1:case 2:case 3:var _e=3;break;default:_e=L}var We=L;L=_e;try{return fe()}finally{L=We}},l.unstable_requestPaint=function(){P=!0},l.unstable_runWithPriority=function(fe,_e){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var We=L;L=fe;try{return _e()}finally{L=We}},l.unstable_scheduleCallback=function(fe,_e,We){var te=l.unstable_now();switch(typeof We=="object"&&We!==null?(We=We.delay,We=typeof We=="number"&&0<We?te+We:te):We=te,fe){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=We+me,fe={id:S++,callback:_e,priorityLevel:fe,startTime:We,expirationTime:me,sortIndex:-1},We>te?(fe.sortIndex=We,n(N,fe),a(w)===null&&fe===a(N)&&(O?(ae(Z),Z=-1):O=!0,Te(xe,We-te))):(fe.sortIndex=me,n(w,fe),F||M||(F=!0,je||(je=!0,oe()))),fe},l.unstable_shouldYield=Re,l.unstable_wrapCallback=function(fe){var _e=L;return function(){var We=L;L=_e;try{return fe.apply(this,arguments)}finally{L=We}}}})(o1)),o1}var _x;function Fv(){return _x||(_x=1,l1.exports=_v()),l1.exports}var c1={exports:{}},Za={};var Fx;function Mv(){if(Fx)return Za;Fx=1;var l=ex();function n(w){var N="https://react.dev/errors/"+w;if(1<arguments.length){N+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)N+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+w+"; visit "+N+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var o={d:{f:a,r:function(){throw Error(n(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},s=Symbol.for("react.portal");function e(w,N,S){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:D==null?null:""+D,children:w,containerInfo:N,implementation:S}}var m=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function v(w,N){if(w==="font")return"";if(typeof N=="string")return N==="use-credentials"?N:""}return Za.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,Za.createPortal=function(w,N){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N||N.nodeType!==1&&N.nodeType!==9&&N.nodeType!==11)throw Error(n(299));return e(w,N,null,S)},Za.flushSync=function(w){var N=m.T,S=o.p;try{if(m.T=null,o.p=2,w)return w()}finally{m.T=N,o.p=S,o.d.f()}},Za.preconnect=function(w,N){typeof w=="string"&&(N?(N=N.crossOrigin,N=typeof N=="string"?N==="use-credentials"?N:"":void 0):N=null,o.d.C(w,N))},Za.prefetchDNS=function(w){typeof w=="string"&&o.d.D(w)},Za.preinit=function(w,N){if(typeof w=="string"&&N&&typeof N.as=="string"){var S=N.as,D=v(S,N.crossOrigin),L=typeof N.integrity=="string"?N.integrity:void 0,M=typeof N.fetchPriority=="string"?N.fetchPriority:void 0;S==="style"?o.d.S(w,typeof N.precedence=="string"?N.precedence:void 0,{crossOrigin:D,integrity:L,fetchPriority:M}):S==="script"&&o.d.X(w,{crossOrigin:D,integrity:L,fetchPriority:M,nonce:typeof N.nonce=="string"?N.nonce:void 0})}},Za.preinitModule=function(w,N){if(typeof w=="string")if(typeof N=="object"&&N!==null){if(N.as==null||N.as==="script"){var S=v(N.as,N.crossOrigin);o.d.M(w,{crossOrigin:S,integrity:typeof N.integrity=="string"?N.integrity:void 0,nonce:typeof N.nonce=="string"?N.nonce:void 0})}}else N==null&&o.d.M(w)},Za.preload=function(w,N){if(typeof w=="string"&&typeof N=="object"&&N!==null&&typeof N.as=="string"){var S=N.as,D=v(S,N.crossOrigin);o.d.L(w,S,{crossOrigin:D,integrity:typeof N.integrity=="string"?N.integrity:void 0,nonce:typeof N.nonce=="string"?N.nonce:void 0,type:typeof N.type=="string"?N.type:void 0,fetchPriority:typeof N.fetchPriority=="string"?N.fetchPriority:void 0,referrerPolicy:typeof N.referrerPolicy=="string"?N.referrerPolicy:void 0,imageSrcSet:typeof N.imageSrcSet=="string"?N.imageSrcSet:void 0,imageSizes:typeof N.imageSizes=="string"?N.imageSizes:void 0,media:typeof N.media=="string"?N.media:void 0})}},Za.preloadModule=function(w,N){if(typeof w=="string")if(N){var S=v(N.as,N.crossOrigin);o.d.m(w,{as:typeof N.as=="string"&&N.as!=="script"?N.as:void 0,crossOrigin:S,integrity:typeof N.integrity=="string"?N.integrity:void 0})}else o.d.m(w)},Za.requestFormReset=function(w){o.d.r(w)},Za.unstable_batchedUpdates=function(w,N){return w(N)},Za.useFormState=function(w,N,S){return m.H.useFormState(w,N,S)},Za.useFormStatus=function(){return m.H.useHostTransitionStatus()},Za.version="19.2.3",Za}var Mx;function Lv(){if(Mx)return c1.exports;Mx=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(n){console.error(n)}}return l(),c1.exports=Mv(),c1.exports}var Lx;function Rv(){if(Lx)return zf;Lx=1;var l=Fv(),n=ex(),a=Lv();function o(i){var c="https://react.dev/errors/"+i;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function e(i){var c=i,f=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(f=c.return),i=c.return;while(i)}return c.tag===3?f:null}function m(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function v(i){if(i.tag===31){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function w(i){if(e(i)!==i)throw Error(o(188))}function N(i){var c=i.alternate;if(!c){if(c=e(i),c===null)throw Error(o(188));return c!==i?null:i}for(var f=i,p=c;;){var C=f.return;if(C===null)break;var A=C.alternate;if(A===null){if(p=C.return,p!==null){f=p;continue}break}if(C.child===A.child){for(A=C.child;A;){if(A===f)return w(C),i;if(A===p)return w(C),c;A=A.sibling}throw Error(o(188))}if(f.return!==p.return)f=C,p=A;else{for(var U=!1,ee=C.child;ee;){if(ee===f){U=!0,f=C,p=A;break}if(ee===p){U=!0,p=C,f=A;break}ee=ee.sibling}if(!U){for(ee=A.child;ee;){if(ee===f){U=!0,f=A,p=C;break}if(ee===p){U=!0,p=A,f=C;break}ee=ee.sibling}if(!U)throw Error(o(189))}}if(f.alternate!==p)throw Error(o(190))}if(f.tag!==3)throw Error(o(188));return f.stateNode.current===f?i:c}function S(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i;for(i=i.child;i!==null;){if(c=S(i),c!==null)return c;i=i.sibling}return null}var D=Object.assign,L=Symbol.for("react.element"),M=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),ae=Symbol.for("react.consumer"),re=Symbol.for("react.context"),ke=Symbol.for("react.forward_ref"),xe=Symbol.for("react.suspense"),je=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),ce=Symbol.for("react.lazy"),ue=Symbol.for("react.activity"),Re=Symbol.for("react.memo_cache_sentinel"),be=Symbol.iterator;function oe(i){return i===null||typeof i!="object"?null:(i=be&&i[be]||i["@@iterator"],typeof i=="function"?i:null)}var he=Symbol.for("react.client.reference");function ye(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===he?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case O:return"Fragment";case G:return"Profiler";case P:return"StrictMode";case xe:return"Suspense";case je:return"SuspenseList";case ue:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case F:return"Portal";case re:return i.displayName||"Context";case ae:return(i._context.displayName||"Context")+".Consumer";case ke:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Z:return c=i.displayName||null,c!==null?c:ye(i.type)||"Memo";case ce:c=i._payload,i=i._init;try{return ye(i(c))}catch{}}return null}var Te=Array.isArray,fe=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,We={pending:!1,data:null,method:null,action:null},te=[],me=-1;function W(i){return{current:i}}function pe(i){0>me||(i.current=te[me],te[me]=null,me--)}function Le(i,c){me++,te[me]=i.current,i.current=c}var Ae=W(null),V=W(null),H=W(null),Q=W(null);function se(i,c){switch(Le(H,c),Le(V,i),Le(Ae,null),c.nodeType){case 9:case 11:i=(i=c.documentElement)&&(i=i.namespaceURI)?Lf(i):0;break;default:if(i=c.tagName,c=c.namespaceURI)c=Lf(c),i=ei(c,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}pe(Ae),Le(Ae,i)}function de(){pe(Ae),pe(V),pe(H)}function we(i){i.memoizedState!==null&&Le(Q,i);var c=Ae.current,f=ei(c,i.type);c!==f&&(Le(V,i),Le(Ae,f))}function Ce(i){V.current===i&&(pe(Ae),pe(V)),Q.current===i&&(pe(Q),$t._currentValue=We)}var ne,ve;function Ge(i){if(ne===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);ne=c&&c[1]||"",ve=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ne+i+ve}var vt=!1;function ze(i,c){if(!i||vt)return"";vt=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(c){var ft=function(){throw Error()};if(Object.defineProperty(ft.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ft,[])}catch(ot){var Je=ot}Reflect.construct(i,[],ft)}else{try{ft.call()}catch(ot){Je=ot}i.call(ft.prototype)}}else{try{throw Error()}catch(ot){Je=ot}(ft=i())&&typeof ft.catch=="function"&&ft.catch(function(){})}}catch(ot){if(ot&&Je&&typeof ot.stack=="string")return[ot.stack,Je.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=p.DetermineComponentFrameRoot(),U=A[0],ee=A[1];if(U&&ee){var Ne=U.split(`
`),qe=ee.split(`
`);for(C=p=0;p<Ne.length&&!Ne[p].includes("DetermineComponentFrameRoot");)p++;for(;C<qe.length&&!qe[C].includes("DetermineComponentFrameRoot");)C++;if(p===Ne.length||C===qe.length)for(p=Ne.length-1,C=qe.length-1;1<=p&&0<=C&&Ne[p]!==qe[C];)C--;for(;1<=p&&0<=C;p--,C--)if(Ne[p]!==qe[C]){if(p!==1||C!==1)do if(p--,C--,0>C||Ne[p]!==qe[C]){var ut=`
`+Ne[p].replace(" at new "," at ");return i.displayName&&ut.includes("<anonymous>")&&(ut=ut.replace("<anonymous>",i.displayName)),ut}while(1<=p&&0<=C);break}}}finally{vt=!1,Error.prepareStackTrace=f}return(f=i?i.displayName||i.name:"")?Ge(f):""}function jt(i,c){switch(i.tag){case 26:case 27:case 5:return Ge(i.type);case 16:return Ge("Lazy");case 13:return i.child!==c&&c!==null?Ge("Suspense Fallback"):Ge("Suspense");case 19:return Ge("SuspenseList");case 0:case 15:return ze(i.type,!1);case 11:return ze(i.type.render,!1);case 1:return ze(i.type,!0);case 31:return Ge("Activity");default:return""}}function rt(i){try{var c="",f=null;do c+=jt(i,f),f=i,i=i.return;while(i);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Kt=Object.prototype.hasOwnProperty,Lt=l.unstable_scheduleCallback,ks=l.unstable_cancelCallback,_s=l.unstable_shouldYield,ms=l.unstable_requestPaint,ws=l.unstable_now,Ie=l.unstable_getCurrentPriorityLevel,st=l.unstable_ImmediatePriority,Dt=l.unstable_UserBlockingPriority,xs=l.unstable_NormalPriority,Pa=l.unstable_LowPriority,dr=l.unstable_IdlePriority,Io=l.log,Qc=l.unstable_setDisableYieldValue,zn=null,Ga=null;function Kr(i){if(typeof Io=="function"&&Qc(i),Ga&&typeof Ga.setStrictMode=="function")try{Ga.setStrictMode(zn,i)}catch{}}var Or=Math.clz32?Math.clz32:zo,Bo=Math.log,ll=Math.LN2;function zo(i){return i>>>=0,i===0?32:31-(Bo(i)/ll|0)|0}var ol=256,Ci=262144,Ta=4194304;function Si(i){var c=i&42;if(c!==0)return c;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Tt(i,c,f){var p=i.pendingLanes;if(p===0)return 0;var C=0,A=i.suspendedLanes,U=i.pingedLanes;i=i.warmLanes;var ee=p&134217727;return ee!==0?(p=ee&~A,p!==0?C=Si(p):(U&=ee,U!==0?C=Si(U):f||(f=ee&~i,f!==0&&(C=Si(f))))):(ee=p&~A,ee!==0?C=Si(ee):U!==0?C=Si(U):f||(f=p&~i,f!==0&&(C=Si(f)))),C===0?0:c!==0&&c!==C&&(c&A)===0&&(A=C&-C,f=c&-c,A>=f||A===32&&(f&4194048)!==0)?c:C}function cl(i,c){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&c)===0}function Uo(i,c){switch(i){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wr(){var i=Ta;return Ta<<=1,(Ta&62914560)===0&&(Ta=4194304),i}function Ai(i){for(var c=[],f=0;31>f;f++)c.push(i);return c}function ni(i,c){i.pendingLanes|=c,c!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Ei(i,c,f,p,C,A){var U=i.pendingLanes;i.pendingLanes=f,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=f,i.entangledLanes&=f,i.errorRecoveryDisabledLanes&=f,i.shellSuspendCounter=0;var ee=i.entanglements,Ne=i.expirationTimes,qe=i.hiddenUpdates;for(f=U&~f;0<f;){var ut=31-Or(f),ft=1<<ut;ee[ut]=0,Ne[ut]=-1;var Je=qe[ut];if(Je!==null)for(qe[ut]=null,ut=0;ut<Je.length;ut++){var ot=Je[ut];ot!==null&&(ot.lane&=-536870913)}f&=~ft}p!==0&&dl(i,p,0),A!==0&&C===0&&i.tag!==0&&(i.suspendedLanes|=A&~(U&~c))}function dl(i,c,f){i.pendingLanes|=c,i.suspendedLanes&=~c;var p=31-Or(c);i.entangledLanes|=c,i.entanglements[p]=i.entanglements[p]|1073741824|f&261930}function Sr(i,c){var f=i.entangledLanes|=c;for(i=i.entanglements;f;){var p=31-Or(f),C=1<<p;C&c|i[p]&c&&(i[p]|=c),f&=~C}}function ii(i,c){var f=c&-c;return f=(f&42)!==0?1:Yl(f),(f&(i.suspendedLanes|c))!==0?0:f}function Yl(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Qr(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function wn(){var i=_e.p;return i!==0?i:(i=window.event,i===void 0?32:Se(i.type))}function Gl(i,c){var f=_e.p;try{return _e.p=i,c()}finally{_e.p=f}}var jn=Math.random().toString(36).slice(2),Xs="__reactFiber$"+jn,Cs="__reactProps$"+jn,_a="__reactContainer$"+jn,sr="__reactEvents$"+jn,ar="__reactListeners$"+jn,nn="__reactHandles$"+jn,Ho="__reactResources$"+jn,Xr="__reactMarker$"+jn;function li(i){delete i[Xs],delete i[Cs],delete i[sr],delete i[ar],delete i[nn]}function Nn(i){var c=i[Xs];if(c)return c;for(var f=i.parentNode;f;){if(c=f[_a]||f[Xs]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(i=zg(i);i!==null;){if(f=i[Xs])return f;i=zg(i)}return c}i=f,f=i.parentNode}return null}function Di(i){if(i=i[Xs]||i[_a]){var c=i.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return i}return null}function ul(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i.stateNode;throw Error(o(33))}function ca(i){var c=i[Ho];return c||(c=i[Ho]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Vr(i){i[Xr]=!0}var Pr=new Set,Ar={};function oi(i,c){us(i,c),us(i+"Capture",c)}function us(i,c){for(Ar[i]=c,i=0;i<c.length;i++)Pr.add(c[i])}var Ir=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),hl={},fl={};function jr(i){return Kt.call(fl,i)?!0:Kt.call(hl,i)?!1:Ir.test(i)?fl[i]=!0:(hl[i]=!0,!1)}function Vo(i,c,f){if(jr(c))if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":i.removeAttribute(c);return;case"boolean":var p=c.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(c);return}}i.setAttribute(c,""+f)}}function Jr(i,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttribute(c,""+f)}}function Un(i,c,f,p){if(p===null)i.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(f);return}i.setAttributeNS(c,f,""+p)}}function Ka(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function os(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function kn(i,c,f){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,c);if(!i.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var C=p.get,A=p.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return C.call(this)},set:function(U){f=""+U,A.call(this,U)}}),Object.defineProperty(i,c,{enumerable:p.enumerable}),{getValue:function(){return f},setValue:function(U){f=""+U},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function Wo(i){if(!i._valueTracker){var c=os(i)?"checked":"value";i._valueTracker=kn(i,c,""+i[c])}}function Hn(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var f=c.getValue(),p="";return i&&(p=os(i)?i.checked?"true":"false":i.value),i=p,i!==f?(c.setValue(i),!0):!1}function Ti(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var ml=/[\n"\\]/g;function ys(i){return i.replace(ml,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function gl(i,c,f,p,C,A,U,ee){i.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?i.type=U:i.removeAttribute("type"),c!=null?U==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+Ka(c)):i.value!==""+Ka(c)&&(i.value=""+Ka(c)):U!=="submit"&&U!=="reset"||i.removeAttribute("value"),c!=null?Ys(i,U,Ka(c)):f!=null?Ys(i,U,Ka(f)):p!=null&&i.removeAttribute("value"),C==null&&A!=null&&(i.defaultChecked=!!A),C!=null&&(i.checked=C&&typeof C!="function"&&typeof C!="symbol"),ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?i.name=""+Ka(ee):i.removeAttribute("name")}function Xc(i,c,f,p,C,A,U,ee){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.type=A),c!=null||f!=null){if(!(A!=="submit"&&A!=="reset"||c!=null)){Wo(i);return}f=f!=null?""+Ka(f):"",c=c!=null?""+Ka(c):f,ee||c===i.value||(i.value=c),i.defaultValue=c}p=p??C,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=ee?i.checked:!!p,i.defaultChecked=!!p,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(i.name=U),Wo(i)}function Ys(i,c,f){c==="number"&&Ti(i.ownerDocument)===i||i.defaultValue===""+f||(i.defaultValue=""+f)}function _i(i,c,f,p){if(i=i.options,c){c={};for(var C=0;C<f.length;C++)c["$"+f[C]]=!0;for(f=0;f<i.length;f++)C=c.hasOwnProperty("$"+i[f].value),i[f].selected!==C&&(i[f].selected=C),C&&p&&(i[f].defaultSelected=!0)}else{for(f=""+Ka(f),c=null,C=0;C<i.length;C++){if(i[C].value===f){i[C].selected=!0,p&&(i[C].defaultSelected=!0);return}c!==null||i[C].disabled||(c=i[C])}c!==null&&(c.selected=!0)}}function Jc(i,c,f){if(c!=null&&(c=""+Ka(c),c!==i.value&&(i.value=c),f==null)){i.defaultValue!==c&&(i.defaultValue=c);return}i.defaultValue=f!=null?""+Ka(f):""}function $o(i,c,f,p){if(c==null){if(p!=null){if(f!=null)throw Error(o(92));if(Te(p)){if(1<p.length)throw Error(o(93));p=p[0]}f=p}f==null&&(f=""),c=f}f=Ka(c),i.defaultValue=f,p=i.textContent,p===f&&p!==""&&p!==null&&(i.value=p),Wo(i)}function Fi(i,c){if(c){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=c;return}}i.textContent=c}var c0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function K(i,c,f){var p=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?p?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="":p?i.setProperty(c,f):typeof f!="number"||f===0||c0.has(c)?c==="float"?i.cssFloat=f:i[c]=(""+f).trim():i[c]=f+"px"}function Ve(i,c,f){if(c!=null&&typeof c!="object")throw Error(o(62));if(i=i.style,f!=null){for(var p in f)!f.hasOwnProperty(p)||c!=null&&c.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var C in c)p=c[C],c.hasOwnProperty(C)&&f[C]!==p&&K(i,C,p)}else for(var A in c)c.hasOwnProperty(A)&&K(i,A,c[A])}function nt(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ue=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),it=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Be(i){return it.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Ke(){}var Ze=null;function Fe(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var At=null,Rt=null;function It(i){var c=Di(i);if(c&&(i=c.stateNode)){var f=i[Cs]||null;e:switch(i=c.stateNode,c.type){case"input":if(gl(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+ys(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var p=f[c];if(p!==i&&p.form===i.form){var C=p[Cs]||null;if(!C)throw Error(o(90));gl(p,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name)}}for(c=0;c<f.length;c++)p=f[c],p.form===i.form&&Hn(p)}break e;case"textarea":Jc(i,f.value,f.defaultValue);break e;case"select":c=f.value,c!=null&&_i(i,!!f.multiple,c,!1)}}}var gt=!1;function Zt(i,c,f){if(gt)return i(c,f);gt=!0;try{var p=i(c);return p}finally{if(gt=!1,(At!==null||Rt!==null)&&(ju(),At&&(c=At,i=Rt,Rt=At=null,It(c),i)))for(c=0;c<i.length;c++)It(i[c])}}function js(i,c){var f=i.stateNode;if(f===null)return null;var p=f[Cs]||null;if(p===null)return null;f=p[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(o(231,c,typeof f));return f}var nr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Is=!1;if(nr)try{var Hs={};Object.defineProperty(Hs,"passive",{get:function(){Is=!0}}),window.addEventListener("test",Hs,Hs),window.removeEventListener("test",Hs,Hs)}catch{Is=!1}var Ia=null,Bt=null,qo=null;function d0(){if(qo)return qo;var i,c=Bt,f=c.length,p,C="value"in Ia?Ia.value:Ia.textContent,A=C.length;for(i=0;i<f&&c[i]===C[i];i++);var U=f-i;for(p=1;p<=U&&c[f-p]===C[A-p];p++);return qo=C.slice(i,1<p?1-p:void 0)}function pl(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function Wr(){return!0}function xl(){return!1}function Nr(i){function c(f,p,C,A,U){this._reactName=f,this._targetInst=C,this.type=p,this.nativeEvent=A,this.target=U,this.currentTarget=null;for(var ee in i)i.hasOwnProperty(ee)&&(f=i[ee],this[ee]=f?f(A):A[ee]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Wr:xl,this.isPropagationStopped=xl,this}return D(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Wr)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Wr)},persist:function(){},isPersistent:Wr}),c}var bl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zc=Nr(bl),Yo=D({},bl,{view:0,detail:0}),ym=Nr(Yo),u0,h0,Go,ed=D({},Yo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uh,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Go&&(Go&&i.type==="mousemove"?(u0=i.screenX-Go.screenX,h0=i.screenY-Go.screenY):h0=u0=0,Go=i),u0)},movementY:function(i){return"movementY"in i?i.movementY:h0}}),nh=Nr(ed),vm=D({},ed,{dataTransfer:0}),wm=Nr(vm),f0=D({},Yo,{relatedTarget:0}),m0=Nr(f0),Ko=D({},bl,{animationName:0,elapsedTime:0,pseudoElement:0}),ih=Nr(Ko),lh=D({},bl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),oh=Nr(lh),ch=D({},bl,{data:0}),g0=Nr(ch),p0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mi(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=Qo[i])?!!c[i]:!1}function uh(){return Mi}var ga=D({},Yo,{key:function(i){if(i.key){var c=p0[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=pl(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?dh[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uh,charCode:function(i){return i.type==="keypress"?pl(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?pl(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Kl=Nr(ga),zp=D({},ed,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xo=Nr(zp),Up=D({},Yo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uh}),Hp=Nr(Up),Vp=D({},bl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wp=Nr(Vp),jm=D({},ed,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Na=Nr(jm),Fa=D({},bl,{newState:0,oldState:0}),mt=Nr(Fa),Li=[9,13,27,32],Ma=nr&&"CompositionEvent"in window,yt=null;nr&&"documentMode"in document&&(yt=document.documentMode);var td=nr&&"TextEvent"in window&&!yt,hh=nr&&(!Ma||yt&&8<yt&&11>=yt),Jo=" ",x0=!1;function b0(i,c){switch(i){case"keyup":return Li.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Br(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var yl=!1;function Er(i,c){switch(i){case"compositionend":return Br(c);case"keypress":return c.which!==32?null:(x0=!0,Jo);case"textInput":return i=c.data,i===Jo&&x0?null:i;default:return null}}function zr(i,c){if(yl)return i==="compositionend"||!Ma&&b0(i,c)?(i=d0(),qo=Bt=Ia=null,yl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return hh&&c.locale!=="ko"?null:c.data;default:return null}}var bs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function La(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!bs[i.type]:c==="textarea"}function Ss(i,c,f,p){At?Rt?Rt.push(p):Rt=[p]:At=p,c=$d(c,"onChange"),0<c.length&&(f=new Zc("onChange","change",null,f,p),i.push({event:f,listeners:c}))}var Fs=null,sd=null;function ci(i){Og(i,0)}function Vn(i){var c=ul(i);if(Hn(c))return i}function fh(i,c){if(i==="change")return c}var Ql=!1;if(nr){var ln;if(nr){var pa="oninput"in document;if(!pa){var da=document.createElement("div");da.setAttribute("oninput","return;"),pa=typeof da.oninput=="function"}ln=pa}else ln=!1;Ql=ln&&(!document.documentMode||9<document.documentMode)}function y0(){Fs&&(Fs.detachEvent("onpropertychange",Nm),sd=Fs=null)}function Nm(i){if(i.propertyName==="value"&&Vn(sd)){var c=[];Ss(c,sd,i,Fe(i)),Zt(ci,c)}}function $p(i,c,f){i==="focusin"?(y0(),Fs=c,sd=f,Fs.attachEvent("onpropertychange",Nm)):i==="focusout"&&y0()}function Cn(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Vn(sd)}function Xl(i,c){if(i==="click")return Vn(c)}function Jl(i,c){if(i==="input"||i==="change")return Vn(c)}function Zl(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var on=typeof Object.is=="function"?Object.is:Zl;function Zo(i,c){if(on(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var f=Object.keys(i),p=Object.keys(c);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var C=f[p];if(!Kt.call(c,C)||!on(i[C],c[C]))return!1}return!0}function v0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function rd(i,c){var f=v0(i);i=0;for(var p;f;){if(f.nodeType===3){if(p=i+f.textContent.length,i<=c&&p>=c)return{node:f,offset:c-i};i=p}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=v0(f)}}function km(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?km(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function w0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var c=Ti(i.document);c instanceof i.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)i=c.contentWindow;else break;c=Ti(i.document)}return c}function ad(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}var mh=nr&&"documentMode"in document&&11>=document.documentMode,eo=null,j0=null,Wn=null,vl=!1;function ka(i,c,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;vl||eo==null||eo!==Ti(p)||(p=eo,"selectionStart"in p&&ad(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Wn&&Zo(Wn,p)||(Wn=p,p=$d(j0,"onSelect"),0<p.length&&(c=new Zc("onSelect","select",null,c,f),i.push({event:c,listeners:p}),c.target=eo)))}function Sn(i,c){var f={};return f[i.toLowerCase()]=c.toLowerCase(),f["Webkit"+i]="webkit"+c,f["Moz"+i]="moz"+c,f}var Ri={animationend:Sn("Animation","AnimationEnd"),animationiteration:Sn("Animation","AnimationIteration"),animationstart:Sn("Animation","AnimationStart"),transitionrun:Sn("Transition","TransitionRun"),transitionstart:Sn("Transition","TransitionStart"),transitioncancel:Sn("Transition","TransitionCancel"),transitionend:Sn("Transition","TransitionEnd")},N0={},k0={};nr&&(k0=document.createElement("div").style,"AnimationEvent"in window||(delete Ri.animationend.animation,delete Ri.animationiteration.animation,delete Ri.animationstart.animation),"TransitionEvent"in window||delete Ri.transitionend.transition);function ra(i){if(N0[i])return N0[i];if(!Ri[i])return i;var c=Ri[i],f;for(f in c)if(c.hasOwnProperty(f)&&f in k0)return N0[i]=c[f];return i}var gh=ra("animationend"),ph=ra("animationiteration"),Cm=ra("animationstart"),xh=ra("transitionrun"),bh=ra("transitionstart"),Sm=ra("transitioncancel"),Am=ra("transitionend"),ec=new Map,$n="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");$n.push("scrollEnd");function An(i,c){ec.set(i,c),oi(c,[i])}var tc=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ba=[],wl=0,C0=0;function Ns(){for(var i=wl,c=C0=wl=0;c<i;){var f=Ba[c];Ba[c++]=null;var p=Ba[c];Ba[c++]=null;var C=Ba[c];Ba[c++]=null;var A=Ba[c];if(Ba[c++]=null,p!==null&&C!==null){var U=p.pending;U===null?C.next=C:(C.next=U.next,U.next=C),p.pending=C}A!==0&&ir(f,C,A)}}function jl(i,c,f,p){Ba[wl++]=i,Ba[wl++]=c,Ba[wl++]=f,Ba[wl++]=p,C0|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function to(i,c,f,p){return jl(i,c,f,p),S0(i)}function En(i,c){return jl(i,null,null,c),S0(i)}function ir(i,c,f){i.lanes|=f;var p=i.alternate;p!==null&&(p.lanes|=f);for(var C=!1,A=i.return;A!==null;)A.childLanes|=f,p=A.alternate,p!==null&&(p.childLanes|=f),A.tag===22&&(i=A.stateNode,i===null||i._visibility&1||(C=!0)),i=A,A=A.return;return i.tag===3?(A=i.stateNode,C&&c!==null&&(C=31-Or(f),i=A.hiddenUpdates,p=i[C],p===null?i[C]=[c]:p.push(c),c.lane=f|536870912),A):null}function S0(i){if(50<Pd)throw Pd=0,Id=null,Error(o(185));for(var c=i.return;c!==null;)i=c,c=i.return;return i.tag===3?i.stateNode:null}var so={};function Em(i,c,f,p){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _r(i,c,f,p){return new Em(i,c,f,p)}function yh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function di(i,c){var f=i.alternate;return f===null?(f=_r(i.tag,c,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=c,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&65011712,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,c=i.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f.refCleanup=i.refCleanup,f}function A0(i,c){i.flags&=65011714;var f=i.alternate;return f===null?(i.childLanes=0,i.lanes=c,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=f.childLanes,i.lanes=f.lanes,i.child=f.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=f.memoizedProps,i.memoizedState=f.memoizedState,i.updateQueue=f.updateQueue,i.type=f.type,c=f.dependencies,i.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),i}function nd(i,c,f,p,C,A){var U=0;if(p=i,typeof i=="function")yh(i)&&(U=1);else if(typeof i=="string")U=Ht(i,f,Ae.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case ue:return i=_r(31,f,c,C),i.elementType=ue,i.lanes=A,i;case O:return cn(f.children,C,A,c);case P:U=8,C|=24;break;case G:return i=_r(12,f,c,C|2),i.elementType=G,i.lanes=A,i;case xe:return i=_r(13,f,c,C),i.elementType=xe,i.lanes=A,i;case je:return i=_r(19,f,c,C),i.elementType=je,i.lanes=A,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case re:U=10;break e;case ae:U=9;break e;case ke:U=11;break e;case Z:U=14;break e;case ce:U=16,p=null;break e}U=29,f=Error(o(130,i===null?"null":typeof i,"")),p=null}return c=_r(U,f,c,C),c.elementType=i,c.type=p,c.lanes=A,c}function cn(i,c,f,p){return i=_r(7,i,p,c),i.lanes=f,i}function E0(i,c,f){return i=_r(6,i,null,c),i.lanes=f,i}function vh(i){var c=_r(18,null,null,0);return c.stateNode=i,c}function D0(i,c,f){return c=_r(4,i.children!==null?i.children:[],i.key,c),c.lanes=f,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}var Dm=new WeakMap;function dn(i,c){if(typeof i=="object"&&i!==null){var f=Dm.get(i);return f!==void 0?f:(c={value:i,source:c,stack:rt(c)},Dm.set(i,c),c)}return{value:i,source:c,stack:rt(c)}}var ro=[],Nl=0,sc=null,rc=0,un=[],hn=0,Oi=null,ui=1,qn="";function hi(i,c){ro[Nl++]=rc,ro[Nl++]=sc,sc=i,rc=c}function id(i,c,f){un[hn++]=ui,un[hn++]=qn,un[hn++]=Oi,Oi=i;var p=ui;i=qn;var C=32-Or(p)-1;p&=~(1<<C),f+=1;var A=32-Or(c)+C;if(30<A){var U=C-C%5;A=(p&(1<<U)-1).toString(32),p>>=U,C-=U,ui=1<<32-Or(c)+C|f<<C|p,qn=A+i}else ui=1<<A|f<<C|p,qn=i}function T0(i){i.return!==null&&(hi(i,1),id(i,1,0))}function _0(i){for(;i===sc;)sc=ro[--Nl],ro[Nl]=null,rc=ro[--Nl],ro[Nl]=null;for(;i===Oi;)Oi=un[--hn],un[hn]=null,qn=un[--hn],un[hn]=null,ui=un[--hn],un[hn]=null}function wh(i,c){un[hn++]=ui,un[hn++]=qn,un[hn++]=Oi,ui=c.id,qn=c.overflow,Oi=i}var xa=null,kr=null,Vs=!1,za=null,Zs=!1,Ca=Error(o(519));function xr(i){var c=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ii(dn(c,i)),Ca}function fn(i){var c=i.stateNode,f=i.type,p=i.memoizedProps;switch(c[Xs]=i,c[Cs]=p,f){case"dialog":hs("cancel",c),hs("close",c);break;case"iframe":case"object":case"embed":hs("load",c);break;case"video":case"audio":for(f=0;f<So.length;f++)hs(So[f],c);break;case"source":hs("error",c);break;case"img":case"image":case"link":hs("error",c),hs("load",c);break;case"details":hs("toggle",c);break;case"input":hs("invalid",c),Xc(c,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":hs("invalid",c);break;case"textarea":hs("invalid",c),$o(c,p.value,p.defaultValue,p.children)}f=p.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||p.suppressHydrationWarning===!0||Df(c.textContent,f)?(p.popover!=null&&(hs("beforetoggle",c),hs("toggle",c)),p.onScroll!=null&&hs("scroll",c),p.onScrollEnd!=null&&hs("scrollend",c),p.onClick!=null&&(c.onclick=Ke),c=!0):c=!1,c||xr(i,!0)}function jh(i){for(xa=i.return;xa;)switch(xa.tag){case 5:case 31:case 13:Zs=!1;return;case 27:case 3:Zs=!0;return;default:xa=xa.return}}function ao(i){if(i!==xa)return!1;if(!Vs)return jh(i),Vs=!0,!1;var c=i.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=i.type,f=!(f!=="form"&&f!=="button")||Fc(i.type,i.memoizedProps)),f=!f),f&&kr&&xr(i),jh(i),c===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(o(317));kr=$s(i)}else if(c===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(o(317));kr=$s(i)}else c===27?(c=kr,rl(i.type)?(i=Bl,Bl=null,kr=i):kr=c):kr=xa?vn(i.stateNode.nextSibling):null;return!0}function Yn(){kr=xa=null,Vs=!1}function Pi(){var i=za;return i!==null&&(Xa===null?Xa=i:Xa.push.apply(Xa,i),za=null),i}function Ii(i){za===null?za=[i]:za.push(i)}var Bi=W(null),kl=null,zi=null;function Gn(i,c,f){Le(Bi,c._currentValue),c._currentValue=f}function fi(i){i._currentValue=Bi.current,pe(Bi)}function F0(i,c,f){for(;i!==null;){var p=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),i===f)break;i=i.return}}function M0(i,c,f,p){var C=i.child;for(C!==null&&(C.return=i);C!==null;){var A=C.dependencies;if(A!==null){var U=C.child;A=A.firstContext;e:for(;A!==null;){var ee=A;A=C;for(var Ne=0;Ne<c.length;Ne++)if(ee.context===c[Ne]){A.lanes|=f,ee=A.alternate,ee!==null&&(ee.lanes|=f),F0(A.return,f,i),p||(U=null);break e}A=ee.next}}else if(C.tag===18){if(U=C.return,U===null)throw Error(o(341));U.lanes|=f,A=U.alternate,A!==null&&(A.lanes|=f),F0(U,f,i),U=null}else U=C.child;if(U!==null)U.return=C;else for(U=C;U!==null;){if(U===i){U=null;break}if(C=U.sibling,C!==null){C.return=U.return,U=C;break}U=U.return}C=U}}function Ua(i,c,f,p){i=null;for(var C=c,A=!1;C!==null;){if(!A){if((C.flags&524288)!==0)A=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var U=C.alternate;if(U===null)throw Error(o(387));if(U=U.memoizedProps,U!==null){var ee=C.type;on(C.pendingProps.value,U.value)||(i!==null?i.push(ee):i=[ee])}}else if(C===Q.current){if(U=C.alternate,U===null)throw Error(o(387));U.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(i!==null?i.push($t):i=[$t])}C=C.return}i!==null&&M0(c,i,f,p),c.flags|=262144}function mi(i){for(i=i.firstContext;i!==null;){if(!on(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Cl(i){kl=i,zi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function aa(i){return Nh(kl,i)}function ld(i,c){return kl===null&&Cl(i),Nh(i,c)}function Nh(i,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},zi===null){if(i===null)throw Error(o(308));zi=c,i.dependencies={lanes:0,firstContext:c},i.flags|=524288}else zi=zi.next=c;return f}var qp=typeof AbortController<"u"?AbortController:function(){var i=[],c=this.signal={aborted:!1,addEventListener:function(f,p){i.push(p)}};this.abort=function(){c.aborted=!0,i.forEach(function(f){return f()})}},Tm=l.unstable_scheduleCallback,Ra=l.unstable_NormalPriority,na={$$typeof:re,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ac(){return{controller:new qp,data:new Map,refCount:0}}function no(i){i.refCount--,i.refCount===0&&Tm(Ra,function(){i.controller.abort()})}var od=null,L0=0,io=0,lo=null;function _m(i,c){if(od===null){var f=od=[];L0=0,io=Bs(),lo={status:"pending",value:void 0,then:function(p){f.push(p)}}}return L0++,c.then(kh,kh),c}function kh(){if(--L0===0&&od!==null){lo!==null&&(lo.status="fulfilled");var i=od;od=null,io=0,lo=null;for(var c=0;c<i.length;c++)(0,i[c])()}}function Fm(i,c){var f=[],p={status:"pending",value:null,reason:null,then:function(C){f.push(C)}};return i.then(function(){p.status="fulfilled",p.value=c;for(var C=0;C<f.length;C++)(0,f[C])(c)},function(C){for(p.status="rejected",p.reason=C,C=0;C<f.length;C++)(0,f[C])(void 0)}),p}var Mm=fe.S;fe.S=function(i,c){yg=ws(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&_m(i,c),Mm!==null&&Mm(i,c)};var Sl=W(null);function R0(){var i=Sl.current;return i!==null?i:br.pooledCache}function cd(i,c){c===null?Le(Sl,Sl.current):Le(Sl,c.pool)}function Lm(){var i=R0();return i===null?null:{parent:na._currentValue,pool:i}}var nc=Error(o(460)),O0=Error(o(474)),P0=Error(o(542)),I0={then:function(){}};function Ch(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Sh(i,c,f){switch(f=i[f],f===void 0?i.push(c):f!==c&&(c.then(Ke,Ke),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Ah(i),i;default:if(typeof c.status=="string")c.then(Ke,Ke);else{if(i=br,i!==null&&100<i.shellSuspendCounter)throw Error(o(482));i=c,i.status="pending",i.then(function(p){if(c.status==="pending"){var C=c;C.status="fulfilled",C.value=p}},function(p){if(c.status==="pending"){var C=c;C.status="rejected",C.reason=p}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Ah(i),i}throw oo=c,nc}}function gi(i){try{var c=i._init;return c(i._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(oo=f,nc):f}}var oo=null;function B0(){if(oo===null)throw Error(o(459));var i=oo;return oo=null,i}function Ah(i){if(i===nc||i===P0)throw Error(o(483))}var Ui=null,ic=0;function dd(i){var c=ic;return ic+=1,Ui===null&&(Ui=[]),Sh(Ui,i,c)}function lc(i,c){c=c.props.ref,i.ref=c!==void 0?c:null}function ud(i,c){throw c.$$typeof===L?Error(o(525)):(i=Object.prototype.toString.call(c),Error(o(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i)))}function hd(i){function c($e,Oe){if(i){var et=$e.deletions;et===null?($e.deletions=[Oe],$e.flags|=16):et.push(Oe)}}function f($e,Oe){if(!i)return null;for(;Oe!==null;)c($e,Oe),Oe=Oe.sibling;return null}function p($e){for(var Oe=new Map;$e!==null;)$e.key!==null?Oe.set($e.key,$e):Oe.set($e.index,$e),$e=$e.sibling;return Oe}function C($e,Oe){return $e=di($e,Oe),$e.index=0,$e.sibling=null,$e}function A($e,Oe,et){return $e.index=et,i?(et=$e.alternate,et!==null?(et=et.index,et<Oe?($e.flags|=67108866,Oe):et):($e.flags|=67108866,Oe)):($e.flags|=1048576,Oe)}function U($e){return i&&$e.alternate===null&&($e.flags|=67108866),$e}function ee($e,Oe,et,bt){return Oe===null||Oe.tag!==6?(Oe=E0(et,$e.mode,bt),Oe.return=$e,Oe):(Oe=C(Oe,et),Oe.return=$e,Oe)}function Ne($e,Oe,et,bt){var fs=et.type;return fs===O?ut($e,Oe,et.props.children,bt,et.key):Oe!==null&&(Oe.elementType===fs||typeof fs=="object"&&fs!==null&&fs.$$typeof===ce&&gi(fs)===Oe.type)?(Oe=C(Oe,et.props),lc(Oe,et),Oe.return=$e,Oe):(Oe=nd(et.type,et.key,et.props,null,$e.mode,bt),lc(Oe,et),Oe.return=$e,Oe)}function qe($e,Oe,et,bt){return Oe===null||Oe.tag!==4||Oe.stateNode.containerInfo!==et.containerInfo||Oe.stateNode.implementation!==et.implementation?(Oe=D0(et,$e.mode,bt),Oe.return=$e,Oe):(Oe=C(Oe,et.children||[]),Oe.return=$e,Oe)}function ut($e,Oe,et,bt,fs){return Oe===null||Oe.tag!==7?(Oe=cn(et,$e.mode,bt,fs),Oe.return=$e,Oe):(Oe=C(Oe,et),Oe.return=$e,Oe)}function ft($e,Oe,et){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Oe=E0(""+Oe,$e.mode,et),Oe.return=$e,Oe;if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case M:return et=nd(Oe.type,Oe.key,Oe.props,null,$e.mode,et),lc(et,Oe),et.return=$e,et;case F:return Oe=D0(Oe,$e.mode,et),Oe.return=$e,Oe;case ce:return Oe=gi(Oe),ft($e,Oe,et)}if(Te(Oe)||oe(Oe))return Oe=cn(Oe,$e.mode,et,null),Oe.return=$e,Oe;if(typeof Oe.then=="function")return ft($e,dd(Oe),et);if(Oe.$$typeof===re)return ft($e,ld($e,Oe),et);ud($e,Oe)}return null}function Je($e,Oe,et,bt){var fs=Oe!==null?Oe.key:null;if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return fs!==null?null:ee($e,Oe,""+et,bt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case M:return et.key===fs?Ne($e,Oe,et,bt):null;case F:return et.key===fs?qe($e,Oe,et,bt):null;case ce:return et=gi(et),Je($e,Oe,et,bt)}if(Te(et)||oe(et))return fs!==null?null:ut($e,Oe,et,bt,null);if(typeof et.then=="function")return Je($e,Oe,dd(et),bt);if(et.$$typeof===re)return Je($e,Oe,ld($e,et),bt);ud($e,et)}return null}function ot($e,Oe,et,bt,fs){if(typeof bt=="string"&&bt!==""||typeof bt=="number"||typeof bt=="bigint")return $e=$e.get(et)||null,ee(Oe,$e,""+bt,fs);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case M:return $e=$e.get(bt.key===null?et:bt.key)||null,Ne(Oe,$e,bt,fs);case F:return $e=$e.get(bt.key===null?et:bt.key)||null,qe(Oe,$e,bt,fs);case ce:return bt=gi(bt),ot($e,Oe,et,bt,fs)}if(Te(bt)||oe(bt))return $e=$e.get(et)||null,ut(Oe,$e,bt,fs,null);if(typeof bt.then=="function")return ot($e,Oe,et,dd(bt),fs);if(bt.$$typeof===re)return ot($e,Oe,et,ld(Oe,bt),fs);ud(Oe,bt)}return null}function ts($e,Oe,et,bt){for(var fs=null,or=null,ls=Oe,Ps=Oe=0,Ks=null;ls!==null&&Ps<et.length;Ps++){ls.index>Ps?(Ks=ls,ls=null):Ks=ls.sibling;var cr=Je($e,ls,et[Ps],bt);if(cr===null){ls===null&&(ls=Ks);break}i&&ls&&cr.alternate===null&&c($e,ls),Oe=A(cr,Oe,Ps),or===null?fs=cr:or.sibling=cr,or=cr,ls=Ks}if(Ps===et.length)return f($e,ls),Vs&&hi($e,Ps),fs;if(ls===null){for(;Ps<et.length;Ps++)ls=ft($e,et[Ps],bt),ls!==null&&(Oe=A(ls,Oe,Ps),or===null?fs=ls:or.sibling=ls,or=ls);return Vs&&hi($e,Ps),fs}for(ls=p(ls);Ps<et.length;Ps++)Ks=ot(ls,$e,Ps,et[Ps],bt),Ks!==null&&(i&&Ks.alternate!==null&&ls.delete(Ks.key===null?Ps:Ks.key),Oe=A(Ks,Oe,Ps),or===null?fs=Ks:or.sibling=Ks,or=Ks);return i&&ls.forEach(function(Lc){return c($e,Lc)}),Vs&&hi($e,Ps),fs}function ps($e,Oe,et,bt){if(et==null)throw Error(o(151));for(var fs=null,or=null,ls=Oe,Ps=Oe=0,Ks=null,cr=et.next();ls!==null&&!cr.done;Ps++,cr=et.next()){ls.index>Ps?(Ks=ls,ls=null):Ks=ls.sibling;var Lc=Je($e,ls,cr.value,bt);if(Lc===null){ls===null&&(ls=Ks);break}i&&ls&&Lc.alternate===null&&c($e,ls),Oe=A(Lc,Oe,Ps),or===null?fs=Lc:or.sibling=Lc,or=Lc,ls=Ks}if(cr.done)return f($e,ls),Vs&&hi($e,Ps),fs;if(ls===null){for(;!cr.done;Ps++,cr=et.next())cr=ft($e,cr.value,bt),cr!==null&&(Oe=A(cr,Oe,Ps),or===null?fs=cr:or.sibling=cr,or=cr);return Vs&&hi($e,Ps),fs}for(ls=p(ls);!cr.done;Ps++,cr=et.next())cr=ot(ls,$e,Ps,cr.value,bt),cr!==null&&(i&&cr.alternate!==null&&ls.delete(cr.key===null?Ps:cr.key),Oe=A(cr,Oe,Ps),or===null?fs=cr:or.sibling=cr,or=cr);return i&&ls.forEach(function(Sv){return c($e,Sv)}),Vs&&hi($e,Ps),fs}function Cr($e,Oe,et,bt){if(typeof et=="object"&&et!==null&&et.type===O&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case M:e:{for(var fs=et.key;Oe!==null;){if(Oe.key===fs){if(fs=et.type,fs===O){if(Oe.tag===7){f($e,Oe.sibling),bt=C(Oe,et.props.children),bt.return=$e,$e=bt;break e}}else if(Oe.elementType===fs||typeof fs=="object"&&fs!==null&&fs.$$typeof===ce&&gi(fs)===Oe.type){f($e,Oe.sibling),bt=C(Oe,et.props),lc(bt,et),bt.return=$e,$e=bt;break e}f($e,Oe);break}else c($e,Oe);Oe=Oe.sibling}et.type===O?(bt=cn(et.props.children,$e.mode,bt,et.key),bt.return=$e,$e=bt):(bt=nd(et.type,et.key,et.props,null,$e.mode,bt),lc(bt,et),bt.return=$e,$e=bt)}return U($e);case F:e:{for(fs=et.key;Oe!==null;){if(Oe.key===fs)if(Oe.tag===4&&Oe.stateNode.containerInfo===et.containerInfo&&Oe.stateNode.implementation===et.implementation){f($e,Oe.sibling),bt=C(Oe,et.children||[]),bt.return=$e,$e=bt;break e}else{f($e,Oe);break}else c($e,Oe);Oe=Oe.sibling}bt=D0(et,$e.mode,bt),bt.return=$e,$e=bt}return U($e);case ce:return et=gi(et),Cr($e,Oe,et,bt)}if(Te(et))return ts($e,Oe,et,bt);if(oe(et)){if(fs=oe(et),typeof fs!="function")throw Error(o(150));return et=fs.call(et),ps($e,Oe,et,bt)}if(typeof et.then=="function")return Cr($e,Oe,dd(et),bt);if(et.$$typeof===re)return Cr($e,Oe,ld($e,et),bt);ud($e,et)}return typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint"?(et=""+et,Oe!==null&&Oe.tag===6?(f($e,Oe.sibling),bt=C(Oe,et),bt.return=$e,$e=bt):(f($e,Oe),bt=E0(et,$e.mode,bt),bt.return=$e,$e=bt),U($e)):f($e,Oe)}return function($e,Oe,et,bt){try{ic=0;var fs=Cr($e,Oe,et,bt);return Ui=null,fs}catch(ls){if(ls===nc||ls===P0)throw ls;var or=_r(29,ls,null,$e.mode);return or.lanes=bt,or.return=$e,or}}}var Al=hd(!0),Eh=hd(!1),Kn=!1;function z0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function oc(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Sa(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Hi(i,c,f){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(rr&2)!==0){var C=p.pending;return C===null?c.next=c:(c.next=C.next,C.next=c),p.pending=c,c=S0(i),ir(i,null,f),c}return jl(i,p,c,f),S0(i)}function co(i,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var p=c.lanes;p&=i.pendingLanes,f|=p,c.lanes=f,Sr(i,f)}}function U0(i,c){var f=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var C=null,A=null;if(f=f.firstBaseUpdate,f!==null){do{var U={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};A===null?C=A=U:A=A.next=U,f=f.next}while(f!==null);A===null?C=A=c:A=A.next=c}else C=A=c;f={baseState:p.baseState,firstBaseUpdate:C,lastBaseUpdate:A,shared:p.shared,callbacks:p.callbacks},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=c:i.next=c,f.lastBaseUpdate=c}var H0=!1;function cc(){if(H0){var i=lo;if(i!==null)throw i}}function uo(i,c,f,p){H0=!1;var C=i.updateQueue;Kn=!1;var A=C.firstBaseUpdate,U=C.lastBaseUpdate,ee=C.shared.pending;if(ee!==null){C.shared.pending=null;var Ne=ee,qe=Ne.next;Ne.next=null,U===null?A=qe:U.next=qe,U=Ne;var ut=i.alternate;ut!==null&&(ut=ut.updateQueue,ee=ut.lastBaseUpdate,ee!==U&&(ee===null?ut.firstBaseUpdate=qe:ee.next=qe,ut.lastBaseUpdate=Ne))}if(A!==null){var ft=C.baseState;U=0,ut=qe=Ne=null,ee=A;do{var Je=ee.lane&-536870913,ot=Je!==ee.lane;if(ot?(Ws&Je)===Je:(p&Je)===Je){Je!==0&&Je===io&&(H0=!0),ut!==null&&(ut=ut.next={lane:0,tag:ee.tag,payload:ee.payload,callback:null,next:null});e:{var ts=i,ps=ee;Je=c;var Cr=f;switch(ps.tag){case 1:if(ts=ps.payload,typeof ts=="function"){ft=ts.call(Cr,ft,Je);break e}ft=ts;break e;case 3:ts.flags=ts.flags&-65537|128;case 0:if(ts=ps.payload,Je=typeof ts=="function"?ts.call(Cr,ft,Je):ts,Je==null)break e;ft=D({},ft,Je);break e;case 2:Kn=!0}}Je=ee.callback,Je!==null&&(i.flags|=64,ot&&(i.flags|=8192),ot=C.callbacks,ot===null?C.callbacks=[Je]:ot.push(Je))}else ot={lane:Je,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},ut===null?(qe=ut=ot,Ne=ft):ut=ut.next=ot,U|=Je;if(ee=ee.next,ee===null){if(ee=C.shared.pending,ee===null)break;ot=ee,ee=ot.next,ot.next=null,C.lastBaseUpdate=ot,C.shared.pending=null}}while(!0);ut===null&&(Ne=ft),C.baseState=Ne,C.firstBaseUpdate=qe,C.lastBaseUpdate=ut,A===null&&(C.shared.lanes=0),Zi|=U,i.lanes=U,i.memoizedState=ft}}function Dh(i,c){if(typeof i!="function")throw Error(o(191,i));i.call(c)}function V0(i,c){var f=i.callbacks;if(f!==null)for(i.callbacks=null,i=0;i<f.length;i++)Dh(f[i],c)}var Vi=W(null),Wi=W(0);function Th(i,c){i=Ji,Le(Wi,i),Le(Vi,c),Ji=i|c.baseLanes}function W0(){Le(Wi,Ji),Le(Vi,Vi.current)}function _h(){Ji=Wi.current,pe(Vi),pe(Wi)}var mn=W(null),gn=null;function Qn(i){var c=i.alternate;Le($r,$r.current&1),Le(mn,i),gn===null&&(c===null||Vi.current!==null||c.memoizedState!==null)&&(gn=i)}function fd(i){Le($r,$r.current),Le(mn,i),gn===null&&(gn=i)}function $0(i){i.tag===22?(Le($r,$r.current),Le(mn,i),gn===null&&(gn=i)):$i()}function $i(){Le($r,$r.current),Le(mn,mn.current)}function ua(i){pe(mn),gn===i&&(gn=null),pe($r)}var $r=W(0);function dc(i){for(var c=i;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Hu(f)||Mc(f)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Dn=0,As=null,Js=null,Fr=null,md=!1,ho=!1,El=!1,gd=0,uc=0,fo=null,Rm=0;function qr(){throw Error(o(321))}function Fh(i,c){if(c===null)return!1;for(var f=0;f<c.length&&f<i.length;f++)if(!on(i[f],c[f]))return!1;return!0}function q0(i,c,f,p,C,A){return Dn=A,As=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,fe.H=i===null||i.memoizedState===null?Jm:Qh,El=!1,A=f(p,C),El=!1,ho&&(A=Pm(c,f,p,C)),Om(i),A}function Om(i){fe.H=Sd;var c=Js!==null&&Js.next!==null;if(Dn=0,Fr=Js=As=null,md=!1,uc=0,fo=null,c)throw Error(o(300));i===null||ia||(i=i.dependencies,i!==null&&mi(i)&&(ia=!0))}function Pm(i,c,f,p){As=i;var C=0;do{if(ho&&(fo=null),uc=0,ho=!1,25<=C)throw Error(o(301));if(C+=1,Fr=Js=null,i.updateQueue!=null){var A=i.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}fe.H=Zm,A=c(f,p)}while(ho);return A}function Yp(){var i=fe.H,c=i.useState()[0];return c=typeof c.then=="function"?xd(c):c,i=i.useState()[0],(Js!==null?Js.memoizedState:null)!==i&&(As.flags|=1024),c}function Mh(){var i=gd!==0;return gd=0,i}function Lh(i,c,f){c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~f}function pd(i){if(md){for(i=i.memoizedState;i!==null;){var c=i.queue;c!==null&&(c.pending=null),i=i.next}md=!1}Dn=0,Fr=Js=As=null,ho=!1,uc=gd=0,fo=null}function Ha(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fr===null?As.memoizedState=Fr=i:Fr=Fr.next=i,Fr}function Zr(){if(Js===null){var i=As.alternate;i=i!==null?i.memoizedState:null}else i=Js.next;var c=Fr===null?As.memoizedState:Fr.next;if(c!==null)Fr=c,Js=i;else{if(i===null)throw As.alternate===null?Error(o(467)):Error(o(310));Js=i,i={memoizedState:Js.memoizedState,baseState:Js.baseState,baseQueue:Js.baseQueue,queue:Js.queue,next:null},Fr===null?As.memoizedState=Fr=i:Fr=Fr.next=i}return Fr}function Y0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function xd(i){var c=uc;return uc+=1,fo===null&&(fo=[]),i=Sh(fo,i,c),c=As,(Fr===null?c.memoizedState:Fr.next)===null&&(c=c.alternate,fe.H=c===null||c.memoizedState===null?Jm:Qh),i}function bd(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return xd(i);if(i.$$typeof===re)return aa(i)}throw Error(o(438,String(i)))}function Rh(i){var c=null,f=As.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var p=As.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(c={data:p.data.map(function(C){return C.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=Y0(),As.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(i),p=0;p<i;p++)f[p]=Re;return c.index++,f}function qi(i,c){return typeof c=="function"?c(i):c}function yd(i){var c=Zr();return Xn(c,Js,i)}function Xn(i,c,f){var p=i.queue;if(p===null)throw Error(o(311));p.lastRenderedReducer=f;var C=i.baseQueue,A=p.pending;if(A!==null){if(C!==null){var U=C.next;C.next=A.next,A.next=U}c.baseQueue=C=A,p.pending=null}if(A=i.baseState,C===null)i.memoizedState=A;else{c=C.next;var ee=U=null,Ne=null,qe=c,ut=!1;do{var ft=qe.lane&-536870913;if(ft!==qe.lane?(Ws&ft)===ft:(Dn&ft)===ft){var Je=qe.revertLane;if(Je===0)Ne!==null&&(Ne=Ne.next={lane:0,revertLane:0,gesture:null,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null}),ft===io&&(ut=!0);else if((Dn&Je)===Je){qe=qe.next,Je===io&&(ut=!0);continue}else ft={lane:0,revertLane:qe.revertLane,gesture:null,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null},Ne===null?(ee=Ne=ft,U=A):Ne=Ne.next=ft,As.lanes|=Je,Zi|=Je;ft=qe.action,El&&f(A,ft),A=qe.hasEagerState?qe.eagerState:f(A,ft)}else Je={lane:ft,revertLane:qe.revertLane,gesture:qe.gesture,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null},Ne===null?(ee=Ne=Je,U=A):Ne=Ne.next=Je,As.lanes|=ft,Zi|=ft;qe=qe.next}while(qe!==null&&qe!==c);if(Ne===null?U=A:Ne.next=ee,!on(A,i.memoizedState)&&(ia=!0,ut&&(f=lo,f!==null)))throw f;i.memoizedState=A,i.baseState=U,i.baseQueue=Ne,p.lastRenderedState=A}return C===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function Oh(i){var c=Zr(),f=c.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=i;var p=f.dispatch,C=f.pending,A=c.memoizedState;if(C!==null){f.pending=null;var U=C=C.next;do A=i(A,U.action),U=U.next;while(U!==C);on(A,c.memoizedState)||(ia=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),f.lastRenderedState=A}return[A,p]}function Im(i,c,f){var p=As,C=Zr(),A=Vs;if(A){if(f===void 0)throw Error(o(407));f=f()}else f=c();var U=!on((Js||C).memoizedState,f);if(U&&(C.memoizedState=f,ia=!0),C=C.queue,jd(Bm.bind(null,p,C,i),[i]),C.getSnapshot!==c||U||Fr!==null&&Fr.memoizedState.tag&1){if(p.flags|=2048,ea(9,{destroy:void 0},Ih.bind(null,p,C,f,c),null),br===null)throw Error(o(349));A||(Dn&127)!==0||Ph(p,c,f)}return f}function Ph(i,c,f){i.flags|=16384,i={getSnapshot:c,value:f},c=As.updateQueue,c===null?(c=Y0(),As.updateQueue=c,c.stores=[i]):(f=c.stores,f===null?c.stores=[i]:f.push(i))}function Ih(i,c,f,p){c.value=f,c.getSnapshot=p,G0(c)&&K0(i)}function Bm(i,c,f){return f(function(){G0(c)&&K0(i)})}function G0(i){var c=i.getSnapshot;i=i.value;try{var f=c();return!on(i,f)}catch{return!0}}function K0(i){var c=En(i,2);c!==null&&qa(c,i,2)}function Q0(i){var c=Ha();if(typeof i=="function"){var f=i;if(i=f(),El){Kr(!0);try{f()}finally{Kr(!1)}}}return c.memoizedState=c.baseState=i,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:i},c}function Bh(i,c,f,p){return i.baseState=f,Xn(i,Js,typeof p=="function"?p:qi)}function zm(i,c,f,p,C){if(tu(i))throw Error(o(485));if(i=c.action,i!==null){var A={payload:C,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){A.listeners.push(U)}};fe.T!==null?f(!0):A.isTransition=!1,p(A),f=c.pending,f===null?(A.next=c.pending=A,mo(c,A)):(A.next=f.next,c.pending=f.next=A)}}function mo(i,c){var f=c.action,p=c.payload,C=i.state;if(c.isTransition){var A=fe.T,U={};fe.T=U;try{var ee=f(C,p),Ne=fe.S;Ne!==null&&Ne(U,ee),Um(i,c,ee)}catch(qe){X0(i,c,qe)}finally{A!==null&&U.types!==null&&(A.types=U.types),fe.T=A}}else try{A=f(C,p),Um(i,c,A)}catch(qe){X0(i,c,qe)}}function Um(i,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(p){Hm(i,c,p)},function(p){return X0(i,c,p)}):Hm(i,c,f)}function Hm(i,c,f){c.status="fulfilled",c.value=f,zh(c),i.state=f,c=i.pending,c!==null&&(f=c.next,f===c?i.pending=null:(f=f.next,c.next=f,mo(i,f)))}function X0(i,c,f){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do c.status="rejected",c.reason=f,zh(c),c=c.next;while(c!==p)}i.action=null}function zh(i){i=i.listeners;for(var c=0;c<i.length;c++)(0,i[c])()}function vd(i,c){return c}function hc(i,c){if(Vs){var f=br.formState;if(f!==null){e:{var p=As;if(Vs){if(kr){t:{for(var C=kr,A=Zs;C.nodeType!==8;){if(!A){C=null;break t}if(C=vn(C.nextSibling),C===null){C=null;break t}}A=C.data,C=A==="F!"||A==="F"?C:null}if(C){kr=vn(C.nextSibling),p=C.data==="F!";break e}}xr(p)}p=!1}p&&(c=f[0])}}return f=Ha(),f.memoizedState=f.baseState=c,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vd,lastRenderedState:c},f.queue=p,f=pc.bind(null,As,p),p.dispatch=f,p=Q0(!1),A=Kh.bind(null,As,!1,p.queue),p=Ha(),C={state:c,dispatch:null,action:i,pending:null},p.queue=C,f=zm.bind(null,As,C,A,f),C.dispatch=f,p.memoizedState=i,[c,f,!1]}function wd(i){var c=Zr();return Uh(c,Js,i)}function Uh(i,c,f){if(c=Xn(i,c,vd)[0],i=yd(qi)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var p=xd(c)}catch(U){throw U===nc?P0:U}else p=c;c=Zr();var C=c.queue,A=C.dispatch;return f!==c.memoizedState&&(As.flags|=2048,ea(9,{destroy:void 0},Gp.bind(null,C,f),null)),[p,A,i]}function Gp(i,c){i.action=c}function Vm(i){var c=Zr(),f=Js;if(f!==null)return Uh(c,f,i);Zr(),c=c.memoizedState,f=Zr();var p=f.queue.dispatch;return f.memoizedState=i,[c,p,!1]}function ea(i,c,f,p){return i={tag:i,create:f,deps:p,inst:c,next:null},c=As.updateQueue,c===null&&(c=Y0(),As.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=i.next=i:(p=f.next,f.next=i,i.next=p,c.lastEffect=i),i}function fc(){return Zr().memoizedState}function Dl(i,c,f,p){var C=Ha();As.flags|=i,C.memoizedState=ea(1|c,{destroy:void 0},f,p===void 0?null:p)}function go(i,c,f,p){var C=Zr();p=p===void 0?null:p;var A=C.memoizedState.inst;Js!==null&&p!==null&&Fh(p,Js.memoizedState.deps)?C.memoizedState=ea(c,A,f,p):(As.flags|=i,C.memoizedState=ea(1|c,A,f,p))}function J0(i,c){Dl(8390656,8,i,c)}function jd(i,c){go(2048,8,i,c)}function Tl(i){As.flags|=4;var c=As.updateQueue;if(c===null)c=Y0(),As.updateQueue=c,c.events=[i];else{var f=c.events;f===null?c.events=[i]:f.push(i)}}function Hh(i){var c=Zr().memoizedState;return Tl({ref:c,nextImpl:i}),function(){if((rr&2)!==0)throw Error(o(440));return c.impl.apply(void 0,arguments)}}function mc(i,c){return go(4,2,i,c)}function po(i,c){return go(4,4,i,c)}function Wm(i,c){if(typeof c=="function"){i=i();var f=c(i);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function Nd(i,c,f){f=f!=null?f.concat([i]):null,go(4,4,Wm.bind(null,c,i),f)}function gc(){}function Vh(i,c){var f=Zr();c=c===void 0?null:c;var p=f.memoizedState;return c!==null&&Fh(c,p[1])?p[0]:(f.memoizedState=[i,c],i)}function Wh(i,c){var f=Zr();c=c===void 0?null:c;var p=f.memoizedState;if(c!==null&&Fh(c,p[1]))return p[0];if(p=i(),El){Kr(!0);try{i()}finally{Kr(!1)}}return f.memoizedState=[p,c],p}function Z0(i,c,f){return f===void 0||(Dn&1073741824)!==0&&(Ws&261930)===0?i.memoizedState=c:(i.memoizedState=f,i=vg(),As.lanes|=i,Zi|=i,f)}function $h(i,c,f,p){return on(f,c)?f:Vi.current!==null?(i=Z0(i,f,p),on(i,c)||(ia=!0),i):(Dn&42)===0||(Dn&1073741824)!==0&&(Ws&261930)===0?(ia=!0,i.memoizedState=f):(i=vg(),As.lanes|=i,Zi|=i,c)}function qh(i,c,f,p,C){var A=_e.p;_e.p=A!==0&&8>A?A:8;var U=fe.T,ee={};fe.T=ee,Kh(i,!1,c,f);try{var Ne=C(),qe=fe.S;if(qe!==null&&qe(ee,Ne),Ne!==null&&typeof Ne=="object"&&typeof Ne.then=="function"){var ut=Fm(Ne,p);Cd(i,c,ut,$a(i))}else Cd(i,c,p,$a(i))}catch(ft){Cd(i,c,{then:function(){},status:"rejected",reason:ft},$a())}finally{_e.p=A,U!==null&&ee.types!==null&&(U.types=ee.types),fe.T=U}}function kd(){}function Yh(i,c,f,p){if(i.tag!==5)throw Error(o(476));var C=Gh(i).queue;qh(i,C,c,We,f===null?kd:function(){return $m(i),f(p)})}function Gh(i){var c=i.memoizedState;if(c!==null)return c;c={memoizedState:We,baseState:We,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:We},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:f},next:null},i.memoizedState=c,i=i.alternate,i!==null&&(i.memoizedState=c),c}function $m(i){var c=Gh(i);c.next===null&&(c=i.alternate.memoizedState),Cd(i,c.next.queue,{},$a())}function eu(){return aa($t)}function qm(){return Zr().memoizedState}function Ym(){return Zr().memoizedState}function Gm(i){for(var c=i.return;c!==null;){switch(c.tag){case 24:case 3:var f=$a();i=Sa(f);var p=Hi(c,i,f);p!==null&&(qa(p,c,f),co(p,c,f)),c={cache:ac()},i.payload=c;return}c=c.return}}function Km(i,c,f){var p=$a();f={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},tu(i)?Qm(c,f):(f=to(i,c,f,p),f!==null&&(qa(f,i,p),Xm(f,c,p)))}function pc(i,c,f){var p=$a();Cd(i,c,f,p)}function Cd(i,c,f,p){var C={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(tu(i))Qm(c,C);else{var A=i.alternate;if(i.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var U=c.lastRenderedState,ee=A(U,f);if(C.hasEagerState=!0,C.eagerState=ee,on(ee,U))return jl(i,c,C,0),br===null&&Ns(),!1}catch{}if(f=to(i,c,C,p),f!==null)return qa(f,i,p),Xm(f,c,p),!0}return!1}function Kh(i,c,f,p){if(p={lane:2,revertLane:Bs(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},tu(i)){if(c)throw Error(o(479))}else c=to(i,f,p,2),c!==null&&qa(c,i,2)}function tu(i){var c=i.alternate;return i===As||c!==null&&c===As}function Qm(i,c){ho=md=!0;var f=i.pending;f===null?c.next=c:(c.next=f.next,f.next=c),i.pending=c}function Xm(i,c,f){if((f&4194048)!==0){var p=c.lanes;p&=i.pendingLanes,f|=p,c.lanes=f,Sr(i,f)}}var Sd={readContext:aa,use:bd,useCallback:qr,useContext:qr,useEffect:qr,useImperativeHandle:qr,useLayoutEffect:qr,useInsertionEffect:qr,useMemo:qr,useReducer:qr,useRef:qr,useState:qr,useDebugValue:qr,useDeferredValue:qr,useTransition:qr,useSyncExternalStore:qr,useId:qr,useHostTransitionStatus:qr,useFormState:qr,useActionState:qr,useOptimistic:qr,useMemoCache:qr,useCacheRefresh:qr};Sd.useEffectEvent=qr;var Jm={readContext:aa,use:bd,useCallback:function(i,c){return Ha().memoizedState=[i,c===void 0?null:c],i},useContext:aa,useEffect:J0,useImperativeHandle:function(i,c,f){f=f!=null?f.concat([i]):null,Dl(4194308,4,Wm.bind(null,c,i),f)},useLayoutEffect:function(i,c){return Dl(4194308,4,i,c)},useInsertionEffect:function(i,c){Dl(4,2,i,c)},useMemo:function(i,c){var f=Ha();c=c===void 0?null:c;var p=i();if(El){Kr(!0);try{i()}finally{Kr(!1)}}return f.memoizedState=[p,c],p},useReducer:function(i,c,f){var p=Ha();if(f!==void 0){var C=f(c);if(El){Kr(!0);try{f(c)}finally{Kr(!1)}}}else C=c;return p.memoizedState=p.baseState=C,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:C},p.queue=i,i=i.dispatch=Km.bind(null,As,i),[p.memoizedState,i]},useRef:function(i){var c=Ha();return i={current:i},c.memoizedState=i},useState:function(i){i=Q0(i);var c=i.queue,f=pc.bind(null,As,c);return c.dispatch=f,[i.memoizedState,f]},useDebugValue:gc,useDeferredValue:function(i,c){var f=Ha();return Z0(f,i,c)},useTransition:function(){var i=Q0(!1);return i=qh.bind(null,As,i.queue,!0,!1),Ha().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,c,f){var p=As,C=Ha();if(Vs){if(f===void 0)throw Error(o(407));f=f()}else{if(f=c(),br===null)throw Error(o(349));(Ws&127)!==0||Ph(p,c,f)}C.memoizedState=f;var A={value:f,getSnapshot:c};return C.queue=A,J0(Bm.bind(null,p,A,i),[i]),p.flags|=2048,ea(9,{destroy:void 0},Ih.bind(null,p,A,f,c),null),f},useId:function(){var i=Ha(),c=br.identifierPrefix;if(Vs){var f=qn,p=ui;f=(p&~(1<<32-Or(p)-1)).toString(32)+f,c="_"+c+"R_"+f,f=gd++,0<f&&(c+="H"+f.toString(32)),c+="_"}else f=Rm++,c="_"+c+"r_"+f.toString(32)+"_";return i.memoizedState=c},useHostTransitionStatus:eu,useFormState:hc,useActionState:hc,useOptimistic:function(i){var c=Ha();c.memoizedState=c.baseState=i;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=Kh.bind(null,As,!0,f),f.dispatch=c,[i,c]},useMemoCache:Rh,useCacheRefresh:function(){return Ha().memoizedState=Gm.bind(null,As)},useEffectEvent:function(i){var c=Ha(),f={impl:i};return c.memoizedState=f,function(){if((rr&2)!==0)throw Error(o(440));return f.impl.apply(void 0,arguments)}}},Qh={readContext:aa,use:bd,useCallback:Vh,useContext:aa,useEffect:jd,useImperativeHandle:Nd,useInsertionEffect:mc,useLayoutEffect:po,useMemo:Wh,useReducer:yd,useRef:fc,useState:function(){return yd(qi)},useDebugValue:gc,useDeferredValue:function(i,c){var f=Zr();return $h(f,Js.memoizedState,i,c)},useTransition:function(){var i=yd(qi)[0],c=Zr().memoizedState;return[typeof i=="boolean"?i:xd(i),c]},useSyncExternalStore:Im,useId:qm,useHostTransitionStatus:eu,useFormState:wd,useActionState:wd,useOptimistic:function(i,c){var f=Zr();return Bh(f,Js,i,c)},useMemoCache:Rh,useCacheRefresh:Ym};Qh.useEffectEvent=Hh;var Zm={readContext:aa,use:bd,useCallback:Vh,useContext:aa,useEffect:jd,useImperativeHandle:Nd,useInsertionEffect:mc,useLayoutEffect:po,useMemo:Wh,useReducer:Oh,useRef:fc,useState:function(){return Oh(qi)},useDebugValue:gc,useDeferredValue:function(i,c){var f=Zr();return Js===null?Z0(f,i,c):$h(f,Js.memoizedState,i,c)},useTransition:function(){var i=Oh(qi)[0],c=Zr().memoizedState;return[typeof i=="boolean"?i:xd(i),c]},useSyncExternalStore:Im,useId:qm,useHostTransitionStatus:eu,useFormState:Vm,useActionState:Vm,useOptimistic:function(i,c){var f=Zr();return Js!==null?Bh(f,Js,i,c):(f.baseState=i,[i,f.queue.dispatch])},useMemoCache:Rh,useCacheRefresh:Ym};Zm.useEffectEvent=Hh;function Xh(i,c,f,p){c=i.memoizedState,f=f(p,c),f=f==null?c:D({},c,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var Jh={enqueueSetState:function(i,c,f){i=i._reactInternals;var p=$a(),C=Sa(p);C.payload=c,f!=null&&(C.callback=f),c=Hi(i,C,p),c!==null&&(qa(c,i,p),co(c,i,p))},enqueueReplaceState:function(i,c,f){i=i._reactInternals;var p=$a(),C=Sa(p);C.tag=1,C.payload=c,f!=null&&(C.callback=f),c=Hi(i,C,p),c!==null&&(qa(c,i,p),co(c,i,p))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var f=$a(),p=Sa(f);p.tag=2,c!=null&&(p.callback=c),c=Hi(i,p,f),c!==null&&(qa(c,i,f),co(c,i,f))}};function eg(i,c,f,p,C,A,U){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,A,U):c.prototype&&c.prototype.isPureReactComponent?!Zo(f,p)||!Zo(C,A):!0}function tg(i,c,f,p){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,p),c.state!==i&&Jh.enqueueReplaceState(c,c.state,null)}function _l(i,c){var f=c;if("ref"in c){f={};for(var p in c)p!=="ref"&&(f[p]=c[p])}if(i=i.defaultProps){f===c&&(f=D({},f));for(var C in i)f[C]===void 0&&(f[C]=i[C])}return f}function su(i){tc(i)}function sg(i){console.error(i)}function rg(i){tc(i)}function ru(i,c){try{var f=i.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(p){setTimeout(function(){throw p})}}function Zh(i,c,f){try{var p=i.onCaughtError;p(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function Fl(i,c,f){return f=Sa(f),f.tag=3,f.payload={element:null},f.callback=function(){ru(i,c)},f}function ef(i){return i=Sa(i),i.tag=3,i}function tf(i,c,f,p){var C=f.type.getDerivedStateFromError;if(typeof C=="function"){var A=p.value;i.payload=function(){return C(A)},i.callback=function(){Zh(c,f,p)}}var U=f.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(i.callback=function(){Zh(c,f,p),typeof C!="function"&&(Ol===null?Ol=new Set([this]):Ol.add(this));var ee=p.stack;this.componentDidCatch(p.value,{componentStack:ee!==null?ee:""})})}function ag(i,c,f,p,C){if(f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(c=f.alternate,c!==null&&Ua(c,f,C,!0),f=mn.current,f!==null){switch(f.tag){case 31:case 13:return gn===null?Nu():f.alternate===null&&Ur===0&&(Ur=3),f.flags&=-257,f.flags|=65536,f.lanes=C,p===I0?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([p]):c.add(p),Cu(i,p,C)),!1;case 22:return f.flags|=65536,p===I0?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([p])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([p]):f.add(p)),Cu(i,p,C)),!1}throw Error(o(435,f.tag))}return Cu(i,p,C),Nu(),!1}if(Vs)return c=mn.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=C,p!==Ca&&(i=Error(o(422),{cause:p}),Ii(dn(i,f)))):(p!==Ca&&(c=Error(o(423),{cause:p}),Ii(dn(c,f))),i=i.current.alternate,i.flags|=65536,C&=-C,i.lanes|=C,p=dn(p,f),C=Fl(i.stateNode,p,C),U0(i,C),Ur!==4&&(Ur=2)),!1;var A=Error(o(520),{cause:p});if(A=dn(A,f),Od===null?Od=[A]:Od.push(A),Ur!==4&&(Ur=2),c===null)return!0;p=dn(p,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,i=C&-C,f.lanes|=i,i=Fl(f.stateNode,p,i),U0(f,i),!1;case 1:if(c=f.type,A=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ol===null||!Ol.has(A))))return f.flags|=65536,C&=-C,f.lanes|=C,C=ef(C),tf(C,i,f,p),U0(f,C),!1}f=f.return}while(f!==null);return!1}var sf=Error(o(461)),ia=!1;function ba(i,c,f,p){c.child=i===null?Eh(c,null,f,p):Al(c,i.child,f,p)}function au(i,c,f,p,C){f=f.render;var A=c.ref;if("ref"in p){var U={};for(var ee in p)ee!=="ref"&&(U[ee]=p[ee])}else U=p;return Cl(c),p=q0(i,c,f,U,A,C),ee=Mh(),i!==null&&!ia?(Lh(i,c,C),Yi(i,c,C)):(Vs&&ee&&T0(c),c.flags|=1,ba(i,c,p,C),c.child)}function rf(i,c,f,p,C){if(i===null){var A=f.type;return typeof A=="function"&&!yh(A)&&A.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=A,xo(i,c,A,p,C)):(i=nd(f.type,null,p,c,c.mode,C),i.ref=c.ref,i.return=c,c.child=i)}if(A=i.child,!yo(i,C)){var U=A.memoizedProps;if(f=f.compare,f=f!==null?f:Zo,f(U,p)&&i.ref===c.ref)return Yi(i,c,C)}return c.flags|=1,i=di(A,p),i.ref=c.ref,i.return=c,c.child=i}function xo(i,c,f,p,C){if(i!==null){var A=i.memoizedProps;if(Zo(A,p)&&i.ref===c.ref)if(ia=!1,c.pendingProps=p=A,yo(i,C))(i.flags&131072)!==0&&(ia=!0);else return c.lanes=i.lanes,Yi(i,c,C)}return iu(i,c,f,p,C)}function ng(i,c,f,p){var C=p.children,A=i!==null?i.memoizedState:null;if(i===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((c.flags&128)!==0){if(A=A!==null?A.baseLanes|f:f,i!==null){for(p=c.child=i.child,C=0;p!==null;)C=C|p.lanes|p.childLanes,p=p.sibling;p=C&~A}else p=0,c.child=null;return nu(i,c,A,f,p)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},i!==null&&cd(c,A!==null?A.cachePool:null),A!==null?Th(c,A):W0(),$0(c);else return p=c.lanes=536870912,nu(i,c,A!==null?A.baseLanes|f:f,f,p)}else A!==null?(cd(c,A.cachePool),Th(c,A),$i(),c.memoizedState=null):(i!==null&&cd(c,null),W0(),$i());return ba(i,c,C,f),c.child}function bo(i,c){return i!==null&&i.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function nu(i,c,f,p,C){var A=R0();return A=A===null?null:{parent:na._currentValue,pool:A},c.memoizedState={baseLanes:f,cachePool:A},i!==null&&cd(c,null),W0(),$0(c),i!==null&&Ua(i,c,p,!0),c.childLanes=C,null}function Ad(i,c){return c=Dd({mode:c.mode,children:c.children},i.mode),c.ref=i.ref,i.child=c,c.return=i,c}function af(i,c,f){return Al(c,i.child,null,f),i=Ad(c,c.pendingProps),i.flags|=2,ua(c),c.memoizedState=null,i}function la(i,c,f){var p=c.pendingProps,C=(c.flags&128)!==0;if(c.flags&=-129,i===null){if(Vs){if(p.mode==="hidden")return i=Ad(c,p),c.lanes=536870912,bo(null,i);if(fd(c),(i=kr)?(i=Uu(i,Zs),i=i!==null&&i.data==="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:Oi!==null?{id:ui,overflow:qn}:null,retryLane:536870912,hydrationErrors:null},f=vh(i),f.return=c,c.child=f,xa=c,kr=null)):i=null,i===null)throw xr(c);return c.lanes=536870912,null}return Ad(c,p)}var A=i.memoizedState;if(A!==null){var U=A.dehydrated;if(fd(c),C)if(c.flags&256)c.flags&=-257,c=af(i,c,f);else if(c.memoizedState!==null)c.child=i.child,c.flags|=128,c=null;else throw Error(o(558));else if(ia||Ua(i,c,f,!1),C=(f&i.childLanes)!==0,ia||C){if(p=br,p!==null&&(U=ii(p,f),U!==0&&U!==A.retryLane))throw A.retryLane=U,En(i,U),qa(p,i,U),sf;Nu(),c=af(i,c,f)}else i=A.treeContext,kr=vn(U.nextSibling),xa=c,Vs=!0,za=null,Zs=!1,i!==null&&wh(c,i),c=Ad(c,p),c.flags|=4096;return c}return i=di(i.child,{mode:p.mode,children:p.children}),i.ref=c.ref,c.child=i,i.return=c,i}function Jn(i,c){var f=c.ref;if(f===null)i!==null&&i.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(o(284));(i===null||i.ref!==f)&&(c.flags|=4194816)}}function iu(i,c,f,p,C){return Cl(c),f=q0(i,c,f,p,void 0,C),p=Mh(),i!==null&&!ia?(Lh(i,c,C),Yi(i,c,C)):(Vs&&p&&T0(c),c.flags|=1,ba(i,c,f,C),c.child)}function nf(i,c,f,p,C,A){return Cl(c),c.updateQueue=null,f=Pm(c,p,f,C),Om(i),p=Mh(),i!==null&&!ia?(Lh(i,c,A),Yi(i,c,A)):(Vs&&p&&T0(c),c.flags|=1,ba(i,c,f,A),c.child)}function lf(i,c,f,p,C){if(Cl(c),c.stateNode===null){var A=so,U=f.contextType;typeof U=="object"&&U!==null&&(A=aa(U)),A=new f(p,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=Jh,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=p,A.state=c.memoizedState,A.refs={},z0(c),U=f.contextType,A.context=typeof U=="object"&&U!==null?aa(U):so,A.state=c.memoizedState,U=f.getDerivedStateFromProps,typeof U=="function"&&(Xh(c,f,U,p),A.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(U=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),U!==A.state&&Jh.enqueueReplaceState(A,A.state,null),uo(c,p,A,C),cc(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),p=!0}else if(i===null){A=c.stateNode;var ee=c.memoizedProps,Ne=_l(f,ee);A.props=Ne;var qe=A.context,ut=f.contextType;U=so,typeof ut=="object"&&ut!==null&&(U=aa(ut));var ft=f.getDerivedStateFromProps;ut=typeof ft=="function"||typeof A.getSnapshotBeforeUpdate=="function",ee=c.pendingProps!==ee,ut||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(ee||qe!==U)&&tg(c,A,p,U),Kn=!1;var Je=c.memoizedState;A.state=Je,uo(c,p,A,C),cc(),qe=c.memoizedState,ee||Je!==qe||Kn?(typeof ft=="function"&&(Xh(c,f,ft,p),qe=c.memoizedState),(Ne=Kn||eg(c,f,Ne,p,Je,qe,U))?(ut||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=qe),A.props=p,A.state=qe,A.context=U,p=Ne):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{A=c.stateNode,oc(i,c),U=c.memoizedProps,ut=_l(f,U),A.props=ut,ft=c.pendingProps,Je=A.context,qe=f.contextType,Ne=so,typeof qe=="object"&&qe!==null&&(Ne=aa(qe)),ee=f.getDerivedStateFromProps,(qe=typeof ee=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==ft||Je!==Ne)&&tg(c,A,p,Ne),Kn=!1,Je=c.memoizedState,A.state=Je,uo(c,p,A,C),cc();var ot=c.memoizedState;U!==ft||Je!==ot||Kn||i!==null&&i.dependencies!==null&&mi(i.dependencies)?(typeof ee=="function"&&(Xh(c,f,ee,p),ot=c.memoizedState),(ut=Kn||eg(c,f,ut,p,Je,ot,Ne)||i!==null&&i.dependencies!==null&&mi(i.dependencies))?(qe||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(p,ot,Ne),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(p,ot,Ne)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||U===i.memoizedProps&&Je===i.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===i.memoizedProps&&Je===i.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=ot),A.props=p,A.state=ot,A.context=Ne,p=ut):(typeof A.componentDidUpdate!="function"||U===i.memoizedProps&&Je===i.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===i.memoizedProps&&Je===i.memoizedState||(c.flags|=1024),p=!1)}return A=p,Jn(i,c),p=(c.flags&128)!==0,A||p?(A=c.stateNode,f=p&&typeof f.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,i!==null&&p?(c.child=Al(c,i.child,null,C),c.child=Al(c,null,f,C)):ba(i,c,f,C),c.memoizedState=A.state,i=c.child):i=Yi(i,c,C),i}function ig(i,c,f,p){return Yn(),c.flags|=256,ba(i,c,f,p),c.child}var lu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ou(i){return{baseLanes:i,cachePool:Lm()}}function of(i,c,f){return i=i!==null?i.childLanes&~f:0,c&&(i|=xn),i}function xc(i,c,f){var p=c.pendingProps,C=!1,A=(c.flags&128)!==0,U;if((U=A)||(U=i!==null&&i.memoizedState===null?!1:($r.current&2)!==0),U&&(C=!0,c.flags&=-129),U=(c.flags&32)!==0,c.flags&=-33,i===null){if(Vs){if(C?Qn(c):$i(),(i=kr)?(i=Uu(i,Zs),i=i!==null&&i.data!=="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:Oi!==null?{id:ui,overflow:qn}:null,retryLane:536870912,hydrationErrors:null},f=vh(i),f.return=c,c.child=f,xa=c,kr=null)):i=null,i===null)throw xr(c);return Mc(i)?c.lanes=32:c.lanes=536870912,null}var ee=p.children;return p=p.fallback,C?($i(),C=c.mode,ee=Dd({mode:"hidden",children:ee},C),p=cn(p,C,f,null),ee.return=c,p.return=c,ee.sibling=p,c.child=ee,p=c.child,p.memoizedState=ou(f),p.childLanes=of(i,U,f),c.memoizedState=lu,bo(null,p)):(Qn(c),Ed(c,ee))}var Ne=i.memoizedState;if(Ne!==null&&(ee=Ne.dehydrated,ee!==null)){if(A)c.flags&256?(Qn(c),c.flags&=-257,c=cf(i,c,f)):c.memoizedState!==null?($i(),c.child=i.child,c.flags|=128,c=null):($i(),ee=p.fallback,C=c.mode,p=Dd({mode:"visible",children:p.children},C),ee=cn(ee,C,f,null),ee.flags|=2,p.return=c,ee.return=c,p.sibling=ee,c.child=p,Al(c,i.child,null,f),p=c.child,p.memoizedState=ou(f),p.childLanes=of(i,U,f),c.memoizedState=lu,c=bo(null,p));else if(Qn(c),Mc(ee)){if(U=ee.nextSibling&&ee.nextSibling.dataset,U)var qe=U.dgst;U=qe,p=Error(o(419)),p.stack="",p.digest=U,Ii({value:p,source:null,stack:null}),c=cf(i,c,f)}else if(ia||Ua(i,c,f,!1),U=(f&i.childLanes)!==0,ia||U){if(U=br,U!==null&&(p=ii(U,f),p!==0&&p!==Ne.retryLane))throw Ne.retryLane=p,En(i,p),qa(U,i,p),sf;Hu(ee)||Nu(),c=cf(i,c,f)}else Hu(ee)?(c.flags|=192,c.child=i.child,c=null):(i=Ne.treeContext,kr=vn(ee.nextSibling),xa=c,Vs=!0,za=null,Zs=!1,i!==null&&wh(c,i),c=Ed(c,p.children),c.flags|=4096);return c}return C?($i(),ee=p.fallback,C=c.mode,Ne=i.child,qe=Ne.sibling,p=di(Ne,{mode:"hidden",children:p.children}),p.subtreeFlags=Ne.subtreeFlags&65011712,qe!==null?ee=di(qe,ee):(ee=cn(ee,C,f,null),ee.flags|=2),ee.return=c,p.return=c,p.sibling=ee,c.child=p,bo(null,p),p=c.child,ee=i.child.memoizedState,ee===null?ee=ou(f):(C=ee.cachePool,C!==null?(Ne=na._currentValue,C=C.parent!==Ne?{parent:Ne,pool:Ne}:C):C=Lm(),ee={baseLanes:ee.baseLanes|f,cachePool:C}),p.memoizedState=ee,p.childLanes=of(i,U,f),c.memoizedState=lu,bo(i.child,p)):(Qn(c),f=i.child,i=f.sibling,f=di(f,{mode:"visible",children:p.children}),f.return=c,f.sibling=null,i!==null&&(U=c.deletions,U===null?(c.deletions=[i],c.flags|=16):U.push(i)),c.child=f,c.memoizedState=null,f)}function Ed(i,c){return c=Dd({mode:"visible",children:c},i.mode),c.return=i,i.child=c}function Dd(i,c){return i=_r(22,i,null,c),i.lanes=0,i}function cf(i,c,f){return Al(c,i.child,null,f),i=Ed(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function df(i,c,f){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c),F0(i.return,c,f)}function uf(i,c,f,p,C,A){var U=i.memoizedState;U===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:C,treeForkCount:A}:(U.isBackwards=c,U.rendering=null,U.renderingStartTime=0,U.last=p,U.tail=f,U.tailMode=C,U.treeForkCount=A)}function lg(i,c,f){var p=c.pendingProps,C=p.revealOrder,A=p.tail;p=p.children;var U=$r.current,ee=(U&2)!==0;if(ee?(U=U&1|2,c.flags|=128):U&=1,Le($r,U),ba(i,c,p,f),p=Vs?rc:0,!ee&&i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&df(i,f,c);else if(i.tag===19)df(i,f,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(C){case"forwards":for(f=c.child,C=null;f!==null;)i=f.alternate,i!==null&&dc(i)===null&&(C=f),f=f.sibling;f=C,f===null?(C=c.child,c.child=null):(C=f.sibling,f.sibling=null),uf(c,!1,C,f,A,p);break;case"backwards":case"unstable_legacy-backwards":for(f=null,C=c.child,c.child=null;C!==null;){if(i=C.alternate,i!==null&&dc(i)===null){c.child=C;break}i=C.sibling,C.sibling=f,f=C,C=i}uf(c,!0,f,null,A,p);break;case"together":uf(c,!1,null,null,void 0,p);break;default:c.memoizedState=null}return c.child}function Yi(i,c,f){if(i!==null&&(c.dependencies=i.dependencies),Zi|=c.lanes,(f&c.childLanes)===0)if(i!==null){if(Ua(i,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(i!==null&&c.child!==i.child)throw Error(o(153));if(c.child!==null){for(i=c.child,f=di(i,i.pendingProps),c.child=f,f.return=c;i.sibling!==null;)i=i.sibling,f=f.sibling=di(i,i.pendingProps),f.return=c;f.sibling=null}return c.child}function yo(i,c){return(i.lanes&c)!==0?!0:(i=i.dependencies,!!(i!==null&&mi(i)))}function Td(i,c,f){switch(c.tag){case 3:se(c,c.stateNode.containerInfo),Gn(c,na,i.memoizedState.cache),Yn();break;case 27:case 5:we(c);break;case 4:se(c,c.stateNode.containerInfo);break;case 10:Gn(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,fd(c),null;break;case 13:var p=c.memoizedState;if(p!==null)return p.dehydrated!==null?(Qn(c),c.flags|=128,null):(f&c.child.childLanes)!==0?xc(i,c,f):(Qn(c),i=Yi(i,c,f),i!==null?i.sibling:null);Qn(c);break;case 19:var C=(i.flags&128)!==0;if(p=(f&c.childLanes)!==0,p||(Ua(i,c,f,!1),p=(f&c.childLanes)!==0),C){if(p)return lg(i,c,f);c.flags|=128}if(C=c.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),Le($r,$r.current),p)break;return null;case 22:return c.lanes=0,ng(i,c,f,c.pendingProps);case 24:Gn(c,na,i.memoizedState.cache)}return Yi(i,c,f)}function og(i,c,f){if(i!==null)if(i.memoizedProps!==c.pendingProps)ia=!0;else{if(!yo(i,f)&&(c.flags&128)===0)return ia=!1,Td(i,c,f);ia=(i.flags&131072)!==0}else ia=!1,Vs&&(c.flags&1048576)!==0&&id(c,rc,c.index);switch(c.lanes=0,c.tag){case 16:e:{var p=c.pendingProps;if(i=gi(c.elementType),c.type=i,typeof i=="function")yh(i)?(p=_l(i,p),c.tag=1,c=lf(null,c,i,p,f)):(c.tag=0,c=iu(null,c,i,p,f));else{if(i!=null){var C=i.$$typeof;if(C===ke){c.tag=11,c=au(null,c,i,p,f);break e}else if(C===Z){c.tag=14,c=rf(null,c,i,p,f);break e}}throw c=ye(i)||i,Error(o(306,c,""))}}return c;case 0:return iu(i,c,c.type,c.pendingProps,f);case 1:return p=c.type,C=_l(p,c.pendingProps),lf(i,c,p,C,f);case 3:e:{if(se(c,c.stateNode.containerInfo),i===null)throw Error(o(387));p=c.pendingProps;var A=c.memoizedState;C=A.element,oc(i,c),uo(c,p,null,f);var U=c.memoizedState;if(p=U.cache,Gn(c,na,p),p!==A.cache&&M0(c,[na],f,!0),cc(),p=U.element,A.isDehydrated)if(A={element:p,isDehydrated:!1,cache:U.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=ig(i,c,p,f);break e}else if(p!==C){C=dn(Error(o(424)),c),Ii(C),c=ig(i,c,p,f);break e}else for(i=c.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,kr=vn(i.firstChild),xa=c,Vs=!0,za=null,Zs=!0,f=Eh(c,null,p,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Yn(),p===C){c=Yi(i,c,f);break e}ba(i,c,p,f)}c=c.child}return c;case 26:return Jn(i,c),i===null?(f=Y(c.type,null,c.pendingProps,null))?c.memoizedState=f:Vs||(f=c.type,i=c.pendingProps,p=qd(H.current).createElement(f),p[Xs]=c,p[Cs]=i,wa(p,f,i),Vr(p),c.stateNode=p):c.memoizedState=Y(c.type,i.memoizedProps,c.pendingProps,i.memoizedState),null;case 27:return we(c),i===null&&Vs&&(p=c.stateNode=r(c.type,c.pendingProps,H.current),xa=c,Zs=!0,C=kr,rl(c.type)?(Bl=C,kr=vn(p.firstChild)):kr=C),ba(i,c,c.pendingProps.children,f),Jn(i,c),i===null&&(c.flags|=4194304),c.child;case 5:return i===null&&Vs&&((C=p=kr)&&(p=zu(p,c.type,c.pendingProps,Zs),p!==null?(c.stateNode=p,xa=c,kr=vn(p.firstChild),Zs=!1,C=!0):C=!1),C||xr(c)),we(c),C=c.type,A=c.pendingProps,U=i!==null?i.memoizedProps:null,p=A.children,Fc(C,A)?p=null:U!==null&&Fc(C,U)&&(c.flags|=32),c.memoizedState!==null&&(C=q0(i,c,Yp,null,null,f),$t._currentValue=C),Jn(i,c),ba(i,c,p,f),c.child;case 6:return i===null&&Vs&&((i=f=kr)&&(f=Pf(f,c.pendingProps,Zs),f!==null?(c.stateNode=f,xa=c,kr=null,i=!0):i=!1),i||xr(c)),null;case 13:return xc(i,c,f);case 4:return se(c,c.stateNode.containerInfo),p=c.pendingProps,i===null?c.child=Al(c,null,p,f):ba(i,c,p,f),c.child;case 11:return au(i,c,c.type,c.pendingProps,f);case 7:return ba(i,c,c.pendingProps,f),c.child;case 8:return ba(i,c,c.pendingProps.children,f),c.child;case 12:return ba(i,c,c.pendingProps.children,f),c.child;case 10:return p=c.pendingProps,Gn(c,c.type,p.value),ba(i,c,p.children,f),c.child;case 9:return C=c.type._context,p=c.pendingProps.children,Cl(c),C=aa(C),p=p(C),c.flags|=1,ba(i,c,p,f),c.child;case 14:return rf(i,c,c.type,c.pendingProps,f);case 15:return xo(i,c,c.type,c.pendingProps,f);case 19:return lg(i,c,f);case 31:return la(i,c,f);case 22:return ng(i,c,f,c.pendingProps);case 24:return Cl(c),p=aa(na),i===null?(C=R0(),C===null&&(C=br,A=ac(),C.pooledCache=A,A.refCount++,A!==null&&(C.pooledCacheLanes|=f),C=A),c.memoizedState={parent:p,cache:C},z0(c),Gn(c,na,C)):((i.lanes&f)!==0&&(oc(i,c),uo(c,null,null,f),cc()),C=i.memoizedState,A=c.memoizedState,C.parent!==p?(C={parent:p,cache:p},c.memoizedState=C,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=C),Gn(c,na,p)):(p=A.cache,Gn(c,na,p),p!==C.cache&&M0(c,[na],f,!0))),ba(i,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(o(156,c.tag))}function pi(i){i.flags|=4}function cu(i,c,f,p,C){if((c=(i.mode&32)!==0)&&(c=!1),c){if(i.flags|=16777216,(C&335544128)===C)if(i.stateNode.complete)i.flags|=8192;else if(Ng())i.flags|=8192;else throw oo=I0,O0}else i.flags&=-16777217}function Oa(i,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Mt(c))if(Ng())i.flags|=8192;else throw oo=I0,O0}function bc(i,c){c!==null&&(i.flags|=4),i.flags&16384&&(c=i.tag!==22?wr():536870912,i.lanes|=c,Sc|=c)}function _d(i,c){if(!Vs)switch(i.tailMode){case"hidden":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function fr(i){var c=i.alternate!==null&&i.alternate.child===i.child,f=0,p=0;if(c)for(var C=i.child;C!==null;)f|=C.lanes|C.childLanes,p|=C.subtreeFlags&65011712,p|=C.flags&65011712,C.return=i,C=C.sibling;else for(C=i.child;C!==null;)f|=C.lanes|C.childLanes,p|=C.subtreeFlags,p|=C.flags,C.return=i,C=C.sibling;return i.subtreeFlags|=p,i.childLanes=f,c}function Kp(i,c,f){var p=c.pendingProps;switch(_0(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fr(c),null;case 1:return fr(c),null;case 3:return f=c.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),fi(na),de(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(ao(c)?pi(c):i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Pi())),fr(c),null;case 26:var C=c.type,A=c.memoizedState;return i===null?(pi(c),A!==null?(fr(c),Oa(c,A)):(fr(c),cu(c,C,null,p,f))):A?A!==i.memoizedState?(pi(c),fr(c),Oa(c,A)):(fr(c),c.flags&=-16777217):(i=i.memoizedProps,i!==p&&pi(c),fr(c),cu(c,C,i,p,f)),null;case 27:if(Ce(c),f=H.current,C=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&pi(c);else{if(!p){if(c.stateNode===null)throw Error(o(166));return fr(c),null}i=Ae.current,ao(c)?fn(c):(i=r(C,p,f),c.stateNode=i,pi(c))}return fr(c),null;case 5:if(Ce(c),C=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&pi(c);else{if(!p){if(c.stateNode===null)throw Error(o(166));return fr(c),null}if(A=Ae.current,ao(c))fn(c);else{var U=qd(H.current);switch(A){case 1:A=U.createElementNS("http://www.w3.org/2000/svg",C);break;case 2:A=U.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;default:switch(C){case"svg":A=U.createElementNS("http://www.w3.org/2000/svg",C);break;case"math":A=U.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;case"script":A=U.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof p.is=="string"?U.createElement("select",{is:p.is}):U.createElement("select"),p.multiple?A.multiple=!0:p.size&&(A.size=p.size);break;default:A=typeof p.is=="string"?U.createElement(C,{is:p.is}):U.createElement(C)}}A[Xs]=c,A[Cs]=p;e:for(U=c.child;U!==null;){if(U.tag===5||U.tag===6)A.appendChild(U.stateNode);else if(U.tag!==4&&U.tag!==27&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===c)break e;for(;U.sibling===null;){if(U.return===null||U.return===c)break e;U=U.return}U.sibling.return=U.return,U=U.sibling}c.stateNode=A;e:switch(wa(A,C,p),C){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&pi(c)}}return fr(c),cu(c,c.type,i===null?null:i.memoizedProps,c.pendingProps,f),null;case 6:if(i&&c.stateNode!=null)i.memoizedProps!==p&&pi(c);else{if(typeof p!="string"&&c.stateNode===null)throw Error(o(166));if(i=H.current,ao(c)){if(i=c.stateNode,f=c.memoizedProps,p=null,C=xa,C!==null)switch(C.tag){case 27:case 5:p=C.memoizedProps}i[Xs]=c,i=!!(i.nodeValue===f||p!==null&&p.suppressHydrationWarning===!0||Df(i.nodeValue,f)),i||xr(c,!0)}else i=qd(i).createTextNode(p),i[Xs]=c,c.stateNode=i}return fr(c),null;case 31:if(f=c.memoizedState,i===null||i.memoizedState!==null){if(p=ao(c),f!==null){if(i===null){if(!p)throw Error(o(318));if(i=c.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(o(557));i[Xs]=c}else Yn(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;fr(c),i=!1}else f=Pi(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=f),i=!0;if(!i)return c.flags&256?(ua(c),c):(ua(c),null);if((c.flags&128)!==0)throw Error(o(558))}return fr(c),null;case 13:if(p=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(C=ao(c),p!==null&&p.dehydrated!==null){if(i===null){if(!C)throw Error(o(318));if(C=c.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(o(317));C[Xs]=c}else Yn(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;fr(c),C=!1}else C=Pi(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=C),C=!0;if(!C)return c.flags&256?(ua(c),c):(ua(c),null)}return ua(c),(c.flags&128)!==0?(c.lanes=f,c):(f=p!==null,i=i!==null&&i.memoizedState!==null,f&&(p=c.child,C=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(C=p.alternate.memoizedState.cachePool.pool),A=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(A=p.memoizedState.cachePool.pool),A!==C&&(p.flags|=2048)),f!==i&&f&&(c.child.flags|=8192),bc(c,c.updateQueue),fr(c),null);case 4:return de(),i===null&&Af(c.stateNode.containerInfo),fr(c),null;case 10:return fi(c.type),fr(c),null;case 19:if(pe($r),p=c.memoizedState,p===null)return fr(c),null;if(C=(c.flags&128)!==0,A=p.rendering,A===null)if(C)_d(p,!1);else{if(Ur!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(A=dc(i),A!==null){for(c.flags|=128,_d(p,!1),i=A.updateQueue,c.updateQueue=i,bc(c,i),c.subtreeFlags=0,i=f,f=c.child;f!==null;)A0(f,i),f=f.sibling;return Le($r,$r.current&1|2),Vs&&hi(c,p.treeForkCount),c.child}i=i.sibling}p.tail!==null&&ws()>bu&&(c.flags|=128,C=!0,_d(p,!1),c.lanes=4194304)}else{if(!C)if(i=dc(A),i!==null){if(c.flags|=128,C=!0,i=i.updateQueue,c.updateQueue=i,bc(c,i),_d(p,!0),p.tail===null&&p.tailMode==="hidden"&&!A.alternate&&!Vs)return fr(c),null}else 2*ws()-p.renderingStartTime>bu&&f!==536870912&&(c.flags|=128,C=!0,_d(p,!1),c.lanes=4194304);p.isBackwards?(A.sibling=c.child,c.child=A):(i=p.last,i!==null?i.sibling=A:c.child=A,p.last=A)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=ws(),i.sibling=null,f=$r.current,Le($r,C?f&1|2:f&1),Vs&&hi(c,p.treeForkCount),i):(fr(c),null);case 22:case 23:return ua(c),_h(),p=c.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(c.flags|=8192):p&&(c.flags|=8192),p?(f&536870912)!==0&&(c.flags&128)===0&&(fr(c),c.subtreeFlags&6&&(c.flags|=8192)):fr(c),f=c.updateQueue,f!==null&&bc(c,f.retryQueue),f=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048),i!==null&&pe(Sl),null;case 24:return f=null,i!==null&&(f=i.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),fi(na),fr(c),null;case 25:return null;case 30:return null}throw Error(o(156,c.tag))}function du(i,c){switch(_0(c),c.tag){case 1:return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return fi(na),de(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 26:case 27:case 5:return Ce(c),null;case 31:if(c.memoizedState!==null){if(ua(c),c.alternate===null)throw Error(o(340));Yn()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 13:if(ua(c),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(o(340));Yn()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return pe($r),null;case 4:return de(),null;case 10:return fi(c.type),null;case 22:case 23:return ua(c),_h(),i!==null&&pe(Sl),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 24:return fi(na),null;case 25:return null;default:return null}}function cg(i,c){switch(_0(c),c.tag){case 3:fi(na),de();break;case 26:case 27:case 5:Ce(c);break;case 4:de();break;case 31:c.memoizedState!==null&&ua(c);break;case 13:ua(c);break;case 19:pe($r);break;case 10:fi(c.type);break;case 22:case 23:ua(c),_h(),i!==null&&pe(Sl);break;case 24:fi(na)}}function Fd(i,c){try{var f=c.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var C=p.next;f=C;do{if((f.tag&i)===i){p=void 0;var A=f.create,U=f.inst;p=A(),U.destroy=p}f=f.next}while(f!==C)}}catch(ee){lr(c,c.return,ee)}}function Ml(i,c,f){try{var p=c.updateQueue,C=p!==null?p.lastEffect:null;if(C!==null){var A=C.next;p=A;do{if((p.tag&i)===i){var U=p.inst,ee=U.destroy;if(ee!==void 0){U.destroy=void 0,C=c;var Ne=f,qe=ee;try{qe()}catch(ut){lr(C,Ne,ut)}}}p=p.next}while(p!==A)}}catch(ut){lr(c,c.return,ut)}}function hf(i){var c=i.updateQueue;if(c!==null){var f=i.stateNode;try{V0(c,f)}catch(p){lr(i,i.return,p)}}}function dg(i,c,f){f.props=_l(i.type,i.memoizedProps),f.state=i.memoizedState;try{f.componentWillUnmount()}catch(p){lr(i,c,p)}}function yc(i,c){try{var f=i.ref;if(f!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof f=="function"?i.refCleanup=f(p):f.current=p}}catch(C){lr(i,c,C)}}function Tn(i,c){var f=i.ref,p=i.refCleanup;if(f!==null)if(typeof p=="function")try{p()}catch(C){lr(i,c,C)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(C){lr(i,c,C)}else f.current=null}function vc(i){var c=i.type,f=i.memoizedProps,p=i.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&p.focus();break e;case"img":f.src?p.src=f.src:f.srcSet&&(p.srcset=f.srcSet)}}catch(C){lr(i,i.return,C)}}function Ll(i,c,f){try{var p=i.stateNode;_f(p,i.type,f,c),p[Cs]=c}catch(C){lr(i,i.return,C)}}function wc(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&rl(i.type)||i.tag===4}function Md(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||wc(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&rl(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function jc(i,c,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(i,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(i),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=Ke));else if(p!==4&&(p===27&&rl(i.type)&&(f=i.stateNode,c=null),i=i.child,i!==null))for(jc(i,c,f),i=i.sibling;i!==null;)jc(i,c,f),i=i.sibling}function xi(i,c,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?f.insertBefore(i,c):f.appendChild(i);else if(p!==4&&(p===27&&rl(i.type)&&(f=i.stateNode),i=i.child,i!==null))for(xi(i,c,f),i=i.sibling;i!==null;)xi(i,c,f),i=i.sibling}function Gi(i){var c=i.stateNode,f=i.memoizedProps;try{for(var p=i.type,C=c.attributes;C.length;)c.removeAttributeNode(C[0]);wa(c,p,f),c[Xs]=i,c[Cs]=f}catch(A){lr(i,i.return,A)}}var bi=!1,oa=!1,ff=!1,ug=typeof WeakSet=="function"?WeakSet:Set,ya=null;function Qp(i,c){if(i=i.containerInfo,_c=qs,i=w0(i),ad(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var C=p.anchorOffset,A=p.focusNode;p=p.focusOffset;try{f.nodeType,A.nodeType}catch{f=null;break e}var U=0,ee=-1,Ne=-1,qe=0,ut=0,ft=i,Je=null;t:for(;;){for(var ot;ft!==f||C!==0&&ft.nodeType!==3||(ee=U+C),ft!==A||p!==0&&ft.nodeType!==3||(Ne=U+p),ft.nodeType===3&&(U+=ft.nodeValue.length),(ot=ft.firstChild)!==null;)Je=ft,ft=ot;for(;;){if(ft===i)break t;if(Je===f&&++qe===C&&(ee=U),Je===A&&++ut===p&&(Ne=U),(ot=ft.nextSibling)!==null)break;ft=Je,Je=ft.parentNode}ft=ot}f=ee===-1||Ne===-1?null:{start:ee,end:Ne}}else f=null}f=f||{start:0,end:0}}else f=null;for(Lu={focusedElem:i,selectionRange:f},qs=!1,ya=c;ya!==null;)if(c=ya,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,ya=i;else for(;ya!==null;){switch(c=ya,A=c.alternate,i=c.flags,c.tag){case 0:if((i&4)!==0&&(i=c.updateQueue,i=i!==null?i.events:null,i!==null))for(f=0;f<i.length;f++)C=i[f],C.ref.impl=C.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&A!==null){i=void 0,f=c,C=A.memoizedProps,A=A.memoizedState,p=f.stateNode;try{var ts=_l(f.type,C);i=p.getSnapshotBeforeUpdate(ts,A),p.__reactInternalSnapshotBeforeUpdate=i}catch(ps){lr(f,f.return,ps)}}break;case 3:if((i&1024)!==0){if(i=c.stateNode.containerInfo,f=i.nodeType,f===9)Bu(i);else if(f===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Bu(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(o(163))}if(i=c.sibling,i!==null){i.return=c.return,ya=i;break}ya=c.return}}function hg(i,c,f){var p=f.flags;switch(f.tag){case 0:case 11:case 15:yi(i,f),p&4&&Fd(5,f);break;case 1:if(yi(i,f),p&4)if(i=f.stateNode,c===null)try{i.componentDidMount()}catch(U){lr(f,f.return,U)}else{var C=_l(f.type,c.memoizedProps);c=c.memoizedState;try{i.componentDidUpdate(C,c,i.__reactInternalSnapshotBeforeUpdate)}catch(U){lr(f,f.return,U)}}p&64&&hf(f),p&512&&yc(f,f.return);break;case 3:if(yi(i,f),p&64&&(i=f.updateQueue,i!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{V0(i,c)}catch(U){lr(f,f.return,U)}}break;case 27:c===null&&p&4&&Gi(f);case 26:case 5:yi(i,f),c===null&&p&4&&vc(f),p&512&&yc(f,f.return);break;case 12:yi(i,f);break;case 31:yi(i,f),p&4&&uu(i,f);break;case 13:yi(i,f),p&4&&gg(i,f),p&64&&(i=f.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(f=Fg.bind(null,f),If(i,f))));break;case 22:if(p=f.memoizedState!==null||bi,!p){c=c!==null&&c.memoizedState!==null||oa,C=bi;var A=oa;bi=p,(oa=c)&&!A?Qi(i,f,(f.subtreeFlags&8772)!==0):yi(i,f),bi=C,oa=A}break;case 30:break;default:yi(i,f)}}function fg(i){var c=i.alternate;c!==null&&(i.alternate=null,fg(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&li(c)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Dr=null,Qa=!1;function Ki(i,c,f){for(f=f.child;f!==null;)mg(i,c,f),f=f.sibling}function mg(i,c,f){if(Ga&&typeof Ga.onCommitFiberUnmount=="function")try{Ga.onCommitFiberUnmount(zn,f)}catch{}switch(f.tag){case 26:oa||Tn(f,c),Ki(i,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:oa||Tn(f,c);var p=Dr,C=Qa;rl(f.type)&&(Dr=f.stateNode,Qa=!1),Ki(i,c,f),d(f.stateNode),Dr=p,Qa=C;break;case 5:oa||Tn(f,c);case 6:if(p=Dr,C=Qa,Dr=null,Ki(i,c,f),Dr=p,Qa=C,Dr!==null)if(Qa)try{(Dr.nodeType===9?Dr.body:Dr.nodeName==="HTML"?Dr.ownerDocument.body:Dr).removeChild(f.stateNode)}catch(A){lr(f,c,A)}else try{Dr.removeChild(f.stateNode)}catch(A){lr(f,c,A)}break;case 18:Dr!==null&&(Qa?(i=Dr,Iu(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,f.stateNode),ns(i)):Iu(Dr,f.stateNode));break;case 4:p=Dr,C=Qa,Dr=f.stateNode.containerInfo,Qa=!0,Ki(i,c,f),Dr=p,Qa=C;break;case 0:case 11:case 14:case 15:Ml(2,f,c),oa||Ml(4,f,c),Ki(i,c,f);break;case 1:oa||(Tn(f,c),p=f.stateNode,typeof p.componentWillUnmount=="function"&&dg(f,c,p)),Ki(i,c,f);break;case 21:Ki(i,c,f);break;case 22:oa=(p=oa)||f.memoizedState!==null,Ki(i,c,f),oa=p;break;default:Ki(i,c,f)}}function uu(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{ns(i)}catch(f){lr(c,c.return,f)}}}function gg(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{ns(i)}catch(f){lr(c,c.return,f)}}function Xp(i){switch(i.tag){case 31:case 13:case 19:var c=i.stateNode;return c===null&&(c=i.stateNode=new ug),c;case 22:return i=i.stateNode,c=i._retryCache,c===null&&(c=i._retryCache=new ug),c;default:throw Error(o(435,i.tag))}}function hu(i,c){var f=Xp(i);c.forEach(function(p){if(!f.has(p)){f.add(p);var C=Mg.bind(null,i,p);p.then(C,C)}})}function Va(i,c){var f=c.deletions;if(f!==null)for(var p=0;p<f.length;p++){var C=f[p],A=i,U=c,ee=U;e:for(;ee!==null;){switch(ee.tag){case 27:if(rl(ee.type)){Dr=ee.stateNode,Qa=!1;break e}break;case 5:Dr=ee.stateNode,Qa=!1;break e;case 3:case 4:Dr=ee.stateNode.containerInfo,Qa=!0;break e}ee=ee.return}if(Dr===null)throw Error(o(160));mg(A,U,C),Dr=null,Qa=!1,A=C.alternate,A!==null&&(A.return=null),C.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)mf(c,i),c=c.sibling}var _n=null;function mf(i,c){var f=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Va(c,i),Wa(i),p&4&&(Ml(3,i,i.return),Fd(3,i),Ml(5,i,i.return));break;case 1:Va(c,i),Wa(i),p&512&&(oa||f===null||Tn(f,f.return)),p&64&&bi&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(f=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=f===null?p:f.concat(p))));break;case 26:var C=_n;if(Va(c,i),Wa(i),p&512&&(oa||f===null||Tn(f,f.return)),p&4){var A=f!==null?f.memoizedState:null;if(p=i.memoizedState,f===null)if(p===null)if(i.stateNode===null){e:{p=i.type,f=i.memoizedProps,C=C.ownerDocument||C;t:switch(p){case"title":A=C.getElementsByTagName("title")[0],(!A||A[Xr]||A[Xs]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=C.createElement(p),C.head.insertBefore(A,C.querySelector("head > title"))),wa(A,p,f),A[Xs]=i,Vr(A),p=A;break e;case"link":var U=kt("link","href",C).get(p+(f.href||""));if(U){for(var ee=0;ee<U.length;ee++)if(A=U[ee],A.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&A.getAttribute("rel")===(f.rel==null?null:f.rel)&&A.getAttribute("title")===(f.title==null?null:f.title)&&A.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){U.splice(ee,1);break t}}A=C.createElement(p),wa(A,p,f),C.head.appendChild(A);break;case"meta":if(U=kt("meta","content",C).get(p+(f.content||""))){for(ee=0;ee<U.length;ee++)if(A=U[ee],A.getAttribute("content")===(f.content==null?null:""+f.content)&&A.getAttribute("name")===(f.name==null?null:f.name)&&A.getAttribute("property")===(f.property==null?null:f.property)&&A.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&A.getAttribute("charset")===(f.charSet==null?null:f.charSet)){U.splice(ee,1);break t}}A=C.createElement(p),wa(A,p,f),C.head.appendChild(A);break;default:throw Error(o(468,p))}A[Xs]=i,Vr(A),p=A}i.stateNode=p}else Wt(C,i.type,i.stateNode);else i.stateNode=Pe(C,p,i.memoizedProps);else A!==p?(A===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):A.count--,p===null?Wt(C,i.type,i.stateNode):Pe(C,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Ll(i,i.memoizedProps,f.memoizedProps)}break;case 27:Va(c,i),Wa(i),p&512&&(oa||f===null||Tn(f,f.return)),f!==null&&p&4&&Ll(i,i.memoizedProps,f.memoizedProps);break;case 5:if(Va(c,i),Wa(i),p&512&&(oa||f===null||Tn(f,f.return)),i.flags&32){C=i.stateNode;try{Fi(C,"")}catch(ts){lr(i,i.return,ts)}}p&4&&i.stateNode!=null&&(C=i.memoizedProps,Ll(i,C,f!==null?f.memoizedProps:C)),p&1024&&(ff=!0);break;case 6:if(Va(c,i),Wa(i),p&4){if(i.stateNode===null)throw Error(o(162));p=i.memoizedProps,f=i.stateNode;try{f.nodeValue=p}catch(ts){lr(i,i.return,ts)}}break;case 3:if(at=null,C=_n,_n=g(c.containerInfo),Va(c,i),_n=C,Wa(i),p&4&&f!==null&&f.memoizedState.isDehydrated)try{ns(c.containerInfo)}catch(ts){lr(i,i.return,ts)}ff&&(ff=!1,gf(i));break;case 4:p=_n,_n=g(i.stateNode.containerInfo),Va(c,i),Wa(i),_n=p;break;case 12:Va(c,i),Wa(i);break;case 31:Va(c,i),Wa(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,hu(i,p)));break;case 13:Va(c,i),Wa(i),i.child.flags&8192&&i.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(xu=ws()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,hu(i,p)));break;case 22:C=i.memoizedState!==null;var Ne=f!==null&&f.memoizedState!==null,qe=bi,ut=oa;if(bi=qe||C,oa=ut||Ne,Va(c,i),oa=ut,bi=qe,Wa(i),p&8192)e:for(c=i.stateNode,c._visibility=C?c._visibility&-2:c._visibility|1,C&&(f===null||Ne||bi||oa||Rl(i)),f=null,c=i;;){if(c.tag===5||c.tag===26){if(f===null){Ne=f=c;try{if(A=Ne.stateNode,C)U=A.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{ee=Ne.stateNode;var ft=Ne.memoizedProps.style,Je=ft!=null&&ft.hasOwnProperty("display")?ft.display:null;ee.style.display=Je==null||typeof Je=="boolean"?"":(""+Je).trim()}}catch(ts){lr(Ne,Ne.return,ts)}}}else if(c.tag===6){if(f===null){Ne=c;try{Ne.stateNode.nodeValue=C?"":Ne.memoizedProps}catch(ts){lr(Ne,Ne.return,ts)}}}else if(c.tag===18){if(f===null){Ne=c;try{var ot=Ne.stateNode;C?Of(ot,!0):Of(Ne.stateNode,!1)}catch(ts){lr(Ne,Ne.return,ts)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===i)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break e;for(;c.sibling===null;){if(c.return===null||c.return===i)break e;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}p&4&&(p=i.updateQueue,p!==null&&(f=p.retryQueue,f!==null&&(p.retryQueue=null,hu(i,f))));break;case 19:Va(c,i),Wa(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,hu(i,p)));break;case 30:break;case 21:break;default:Va(c,i),Wa(i)}}function Wa(i){var c=i.flags;if(c&2){try{for(var f,p=i.return;p!==null;){if(wc(p)){f=p;break}p=p.return}if(f==null)throw Error(o(160));switch(f.tag){case 27:var C=f.stateNode,A=Md(i);xi(i,A,C);break;case 5:var U=f.stateNode;f.flags&32&&(Fi(U,""),f.flags&=-33);var ee=Md(i);xi(i,ee,U);break;case 3:case 4:var Ne=f.stateNode.containerInfo,qe=Md(i);jc(i,qe,Ne);break;default:throw Error(o(161))}}catch(ut){lr(i,i.return,ut)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function gf(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var c=i;gf(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),i=i.sibling}}function yi(i,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)hg(i,c.alternate,c),c=c.sibling}function Rl(i){for(i=i.child;i!==null;){var c=i;switch(c.tag){case 0:case 11:case 14:case 15:Ml(4,c,c.return),Rl(c);break;case 1:Tn(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&dg(c,c.return,f),Rl(c);break;case 27:d(c.stateNode);case 26:case 5:Tn(c,c.return),Rl(c);break;case 22:c.memoizedState===null&&Rl(c);break;case 30:Rl(c);break;default:Rl(c)}i=i.sibling}}function Qi(i,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var p=c.alternate,C=i,A=c,U=A.flags;switch(A.tag){case 0:case 11:case 15:Qi(C,A,f),Fd(4,A);break;case 1:if(Qi(C,A,f),p=A,C=p.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(qe){lr(p,p.return,qe)}if(p=A,C=p.updateQueue,C!==null){var ee=p.stateNode;try{var Ne=C.shared.hiddenCallbacks;if(Ne!==null)for(C.shared.hiddenCallbacks=null,C=0;C<Ne.length;C++)Dh(Ne[C],ee)}catch(qe){lr(p,p.return,qe)}}f&&U&64&&hf(A),yc(A,A.return);break;case 27:Gi(A);case 26:case 5:Qi(C,A,f),f&&p===null&&U&4&&vc(A),yc(A,A.return);break;case 12:Qi(C,A,f);break;case 31:Qi(C,A,f),f&&U&4&&uu(C,A);break;case 13:Qi(C,A,f),f&&U&4&&gg(C,A);break;case 22:A.memoizedState===null&&Qi(C,A,f),yc(A,A.return);break;case 30:break;default:Qi(C,A,f)}c=c.sibling}}function pf(i,c){var f=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),i=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(i=c.memoizedState.cachePool.pool),i!==f&&(i!=null&&i.refCount++,f!=null&&no(f))}function fu(i,c){i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&no(i))}function Zn(i,c,f,p){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Ld(i,c,f,p),c=c.sibling}function Ld(i,c,f,p){var C=c.flags;switch(c.tag){case 0:case 11:case 15:Zn(i,c,f,p),C&2048&&Fd(9,c);break;case 1:Zn(i,c,f,p);break;case 3:Zn(i,c,f,p),C&2048&&(i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&no(i)));break;case 12:if(C&2048){Zn(i,c,f,p),i=c.stateNode;try{var A=c.memoizedProps,U=A.id,ee=A.onPostCommit;typeof ee=="function"&&ee(U,c.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Ne){lr(c,c.return,Ne)}}else Zn(i,c,f,p);break;case 31:Zn(i,c,f,p);break;case 13:Zn(i,c,f,p);break;case 23:break;case 22:A=c.stateNode,U=c.alternate,c.memoizedState!==null?A._visibility&2?Zn(i,c,f,p):kc(i,c):A._visibility&2?Zn(i,c,f,p):(A._visibility|=2,Nc(i,c,f,p,(c.subtreeFlags&10256)!==0||!1)),C&2048&&pf(U,c);break;case 24:Zn(i,c,f,p),C&2048&&fu(c.alternate,c);break;default:Zn(i,c,f,p)}}function Nc(i,c,f,p,C){for(C=C&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var A=i,U=c,ee=f,Ne=p,qe=U.flags;switch(U.tag){case 0:case 11:case 15:Nc(A,U,ee,Ne,C),Fd(8,U);break;case 23:break;case 22:var ut=U.stateNode;U.memoizedState!==null?ut._visibility&2?Nc(A,U,ee,Ne,C):kc(A,U):(ut._visibility|=2,Nc(A,U,ee,Ne,C)),C&&qe&2048&&pf(U.alternate,U);break;case 24:Nc(A,U,ee,Ne,C),C&&qe&2048&&fu(U.alternate,U);break;default:Nc(A,U,ee,Ne,C)}c=c.sibling}}function kc(i,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=i,p=c,C=p.flags;switch(p.tag){case 22:kc(f,p),C&2048&&pf(p.alternate,p);break;case 24:kc(f,p),C&2048&&fu(p.alternate,p);break;default:kc(f,p)}c=c.sibling}}var vi=8192;function Cc(i,c,f){if(i.subtreeFlags&vi)for(i=i.child;i!==null;)xf(i,c,f),i=i.sibling}function xf(i,c,f){switch(i.tag){case 26:Cc(i,c,f),i.flags&vi&&i.memoizedState!==null&&Ot(f,_n,i.memoizedState,i.memoizedProps);break;case 5:Cc(i,c,f);break;case 3:case 4:var p=_n;_n=g(i.stateNode.containerInfo),Cc(i,c,f),_n=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=vi,vi=16777216,Cc(i,c,f),vi=p):Cc(i,c,f));break;default:Cc(i,c,f)}}function pg(i){var c=i.alternate;if(c!==null&&(i=c.child,i!==null)){c.child=null;do c=i.sibling,i.sibling=null,i=c;while(i!==null)}}function Rd(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];ya=p,bg(p,i)}pg(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)xg(i),i=i.sibling}function xg(i){switch(i.tag){case 0:case 11:case 15:Rd(i),i.flags&2048&&Ml(9,i,i.return);break;case 3:Rd(i);break;case 12:Rd(i);break;case 22:var c=i.stateNode;i.memoizedState!==null&&c._visibility&2&&(i.return===null||i.return.tag!==13)?(c._visibility&=-3,mu(i)):Rd(i);break;default:Rd(i)}}function mu(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];ya=p,bg(p,i)}pg(i)}for(i=i.child;i!==null;){switch(c=i,c.tag){case 0:case 11:case 15:Ml(8,c,c.return),mu(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,mu(c));break;default:mu(c)}i=i.sibling}}function bg(i,c){for(;ya!==null;){var f=ya;switch(f.tag){case 0:case 11:case 15:Ml(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var p=f.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:no(f.memoizedState.cache)}if(p=f.child,p!==null)p.return=f,ya=p;else e:for(f=i;ya!==null;){p=ya;var C=p.sibling,A=p.return;if(fg(p),p===f){ya=null;break e}if(C!==null){C.return=A,ya=C;break e}ya=A}}}var Jp={getCacheForType:function(i){var c=aa(na),f=c.data.get(i);return f===void 0&&(f=i(),c.data.set(i,f)),f},cacheSignal:function(){return aa(na).controller.signal}},Zp=typeof WeakMap=="function"?WeakMap:Map,rr=0,br=null,Rs=null,Ws=0,ur=0,pn=null,Xi=!1,vo=!1,gu=!1,Ji=0,Ur=0,Zi=0,wo=0,pu=0,xn=0,Sc=0,Od=null,Xa=null,bf=!1,xu=0,yg=0,bu=1/0,yu=null,Ol=null,ha=0,Pl=null,Ac=null,bn=0,vu=0,wu=null,Fn=null,Pd=0,Id=null;function $a(){return(rr&2)!==0&&Ws!==0?Ws&-Ws:fe.T!==null?Bs():wn()}function vg(){if(xn===0)if((Ws&536870912)===0||Vs){var i=Ci;Ci<<=1,(Ci&3932160)===0&&(Ci=262144),xn=i}else xn=536870912;return i=mn.current,i!==null&&(i.flags|=32),xn}function qa(i,c,f){(i===br&&(ur===2||ur===9)||i.cancelPendingCommit!==null)&&(Ya(i,0),Il(i,Ws,xn,!1)),ni(i,f),((rr&2)===0||i!==br)&&(i===br&&((rr&2)===0&&(wo|=f),Ur===4&&Il(i,Ws,xn,!1)),va(i))}function wg(i,c,f){if((rr&6)!==0)throw Error(o(327));var p=!f&&(c&127)===0&&(c&i.expiredLanes)===0||cl(i,c),C=p?zt(i,c):jo(i,c,!0),A=p;do{if(C===0){vo&&!p&&Il(i,c,0,!1);break}else{if(f=i.current.alternate,A&&!e1(f)){C=jo(i,c,!1),A=!1;continue}if(C===2){if(A=c,i.errorRecoveryDisabledLanes&A)var U=0;else U=i.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){c=U;e:{var ee=i;C=Od;var Ne=ee.current.memoizedState.isDehydrated;if(Ne&&(Ya(ee,U).flags|=256),U=jo(ee,U,!1),U!==2){if(gu&&!Ne){ee.errorRecoveryDisabledLanes|=A,wo|=A,C=4;break e}A=Xa,Xa=C,A!==null&&(Xa===null?Xa=A:Xa.push.apply(Xa,A))}C=U}if(A=!1,C!==2)continue}}if(C===1){Ya(i,0),Il(i,c,0,!0);break}e:{switch(p=i,A=C,A){case 0:case 1:throw Error(o(345));case 4:if((c&4194048)!==c)break;case 6:Il(p,c,xn,!Xi);break e;case 2:Xa=null;break;case 3:case 5:break;default:throw Error(o(329))}if((c&62914560)===c&&(C=xu+300-ws(),10<C)){if(Il(p,c,xn,!Xi),Tt(p,0,!0)!==0)break e;bn=c,p.timeoutHandle=Ou(jg.bind(null,p,f,Xa,yu,bf,c,xn,wo,Sc,Xi,A,"Throttled",-0,0),C);break e}jg(p,f,Xa,yu,bf,c,xn,wo,Sc,Xi,A,null,-0,0)}}break}while(!0);va(i)}function jg(i,c,f,p,C,A,U,ee,Ne,qe,ut,ft,Je,ot){if(i.timeoutHandle=-1,ft=c.subtreeFlags,ft&8192||(ft&16785408)===16785408){ft={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ke},xf(c,A,ft);var ts=(A&62914560)===A?xu-ws():(A&4194048)===A?yg-ws():0;if(ts=wt(ft,ts),ts!==null){bn=A,i.cancelPendingCommit=ts(Ag.bind(null,i,c,A,f,p,C,U,ee,Ne,ut,ft,null,Je,ot)),Il(i,A,U,!qe);return}}Ag(i,c,A,f,p,C,U,ee,Ne)}function e1(i){for(var c=i;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var p=0;p<f.length;p++){var C=f[p],A=C.getSnapshot;C=C.value;try{if(!on(A(),C))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Il(i,c,f,p){c&=~pu,c&=~wo,i.suspendedLanes|=c,i.pingedLanes&=~c,p&&(i.warmLanes|=c),p=i.expirationTimes;for(var C=c;0<C;){var A=31-Or(C),U=1<<A;p[A]=-1,C&=~U}f!==0&&dl(i,f,c)}function ju(){return(rr&6)===0?(ko(0),!1):!0}function yf(){if(Rs!==null){if(ur===0)var i=Rs.return;else i=Rs,zi=kl=null,pd(i),Ui=null,ic=0,i=Rs;for(;i!==null;)cg(i.alternate,i),i=i.return;Rs=null}}function Ya(i,c){var f=i.timeoutHandle;f!==-1&&(i.timeoutHandle=-1,Ig(f)),f=i.cancelPendingCommit,f!==null&&(i.cancelPendingCommit=null,f()),bn=0,yf(),br=i,Rs=f=di(i.current,null),Ws=c,ur=0,pn=null,Xi=!1,vo=cl(i,c),gu=!1,Sc=xn=pu=wo=Zi=Ur=0,Xa=Od=null,bf=!1,(c&8)!==0&&(c|=c&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=c;0<p;){var C=31-Or(p),A=1<<C;c|=i[C],p&=~A}return Ji=c,Ns(),f}function Bd(i,c){As=null,fe.H=Sd,c===nc||c===P0?(c=B0(),ur=3):c===O0?(c=B0(),ur=4):ur=c===sf?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,pn=c,Rs===null&&(Ur=1,ru(i,dn(c,i.current)))}function Ng(){var i=mn.current;return i===null?!0:(Ws&4194048)===Ws?gn===null:(Ws&62914560)===Ws||(Ws&536870912)!==0?i===gn:!1}function Ec(){var i=fe.H;return fe.H=Sd,i===null?Sd:i}function zd(){var i=fe.A;return fe.A=Jp,i}function Nu(){Ur=4,Xi||(Ws&4194048)!==Ws&&mn.current!==null||(vo=!0),(Zi&134217727)===0&&(wo&134217727)===0||br===null||Il(br,Ws,xn,!1)}function jo(i,c,f){var p=rr;rr|=2;var C=Ec(),A=zd();(br!==i||Ws!==c)&&(yu=null,Ya(i,c)),c=!1;var U=Ur;e:do try{if(ur!==0&&Rs!==null){var ee=Rs,Ne=pn;switch(ur){case 8:yf(),U=6;break e;case 3:case 2:case 9:case 6:mn.current===null&&(c=!0);var qe=ur;if(ur=0,pn=null,Dc(i,ee,Ne,qe),f&&vo){U=0;break e}break;default:qe=ur,ur=0,pn=null,Dc(i,ee,Ne,qe)}}vf(),U=Ur;break}catch(ut){Bd(i,ut)}while(!0);return c&&i.shellSuspendCounter++,zi=kl=null,rr=p,fe.H=C,fe.A=A,Rs===null&&(br=null,Ws=0,Ns()),U}function vf(){for(;Rs!==null;)kg(Rs)}function zt(i,c){var f=rr;rr|=2;var p=Ec(),C=zd();br!==i||Ws!==c?(yu=null,bu=ws()+500,Ya(i,c)):vo=cl(i,c);e:do try{if(ur!==0&&Rs!==null){c=Rs;var A=pn;t:switch(ur){case 1:ur=0,pn=null,Dc(i,c,A,1);break;case 2:case 9:if(Ch(A)){ur=0,pn=null,Cg(c);break}c=function(){ur!==2&&ur!==9||br!==i||(ur=7),va(i)},A.then(c,c);break e;case 3:ur=7;break e;case 4:ur=5;break e;case 7:Ch(A)?(ur=0,pn=null,Cg(c)):(ur=0,pn=null,Dc(i,c,A,7));break;case 5:var U=null;switch(Rs.tag){case 26:U=Rs.memoizedState;case 5:case 27:var ee=Rs;if(U?Mt(U):ee.stateNode.complete){ur=0,pn=null;var Ne=ee.sibling;if(Ne!==null)Rs=Ne;else{var qe=ee.return;qe!==null?(Rs=qe,ku(qe)):Rs=null}break t}}ur=0,pn=null,Dc(i,c,A,5);break;case 6:ur=0,pn=null,Dc(i,c,A,6);break;case 8:yf(),Ur=6;break e;default:throw Error(o(462))}}Ud();break}catch(ut){Bd(i,ut)}while(!0);return zi=kl=null,fe.H=p,fe.A=C,rr=f,Rs!==null?0:(br=null,Ws=0,Ns(),Ur)}function Ud(){for(;Rs!==null&&!_s();)kg(Rs)}function kg(i){var c=og(i.alternate,i,Ji);i.memoizedProps=i.pendingProps,c===null?ku(i):Rs=c}function Cg(i){var c=i,f=c.alternate;switch(c.tag){case 15:case 0:c=nf(f,c,c.pendingProps,c.type,void 0,Ws);break;case 11:c=nf(f,c,c.pendingProps,c.type.render,c.ref,Ws);break;case 5:pd(c);default:cg(f,c),c=Rs=A0(c,Ji),c=og(f,c,Ji)}i.memoizedProps=i.pendingProps,c===null?ku(i):Rs=c}function Dc(i,c,f,p){zi=kl=null,pd(c),Ui=null,ic=0;var C=c.return;try{if(ag(i,C,c,f,Ws)){Ur=1,ru(i,dn(f,i.current)),Rs=null;return}}catch(A){if(C!==null)throw Rs=C,A;Ur=1,ru(i,dn(f,i.current)),Rs=null;return}c.flags&32768?(Vs||p===1?i=!0:vo||(Ws&536870912)!==0?i=!1:(Xi=i=!0,(p===2||p===9||p===3||p===6)&&(p=mn.current,p!==null&&p.tag===13&&(p.flags|=16384))),Sg(c,i)):ku(c)}function ku(i){var c=i;do{if((c.flags&32768)!==0){Sg(c,Xi);return}i=c.return;var f=Kp(c.alternate,c,Ji);if(f!==null){Rs=f;return}if(c=c.sibling,c!==null){Rs=c;return}Rs=c=i}while(c!==null);Ur===0&&(Ur=5)}function Sg(i,c){do{var f=du(i.alternate,i);if(f!==null){f.flags&=32767,Rs=f;return}if(f=i.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(i=i.sibling,i!==null)){Rs=i;return}Rs=i=f}while(i!==null);Ur=6,Rs=null}function Ag(i,c,f,p,C,A,U,ee,Ne){i.cancelPendingCommit=null;do Hd();while(ha!==0);if((rr&6)!==0)throw Error(o(327));if(c!==null){if(c===i.current)throw Error(o(177));if(A=c.lanes|c.childLanes,A|=C0,Ei(i,f,A,U,ee,Ne),i===br&&(Rs=br=null,Ws=0),Ac=c,Pl=i,bn=f,vu=A,wu=C,Fn=p,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Lg(xs,function(){return jf(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||p){p=fe.T,fe.T=null,C=_e.p,_e.p=2,U=rr,rr|=4;try{Qp(i,c,f)}finally{rr=U,_e.p=C,fe.T=p}}ha=1,Eg(),Dg(),Tg()}}function Eg(){if(ha===1){ha=0;var i=Pl,c=Ac,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=fe.T,fe.T=null;var p=_e.p;_e.p=2;var C=rr;rr|=4;try{mf(c,i);var A=Lu,U=w0(i.containerInfo),ee=A.focusedElem,Ne=A.selectionRange;if(U!==ee&&ee&&ee.ownerDocument&&km(ee.ownerDocument.documentElement,ee)){if(Ne!==null&&ad(ee)){var qe=Ne.start,ut=Ne.end;if(ut===void 0&&(ut=qe),"selectionStart"in ee)ee.selectionStart=qe,ee.selectionEnd=Math.min(ut,ee.value.length);else{var ft=ee.ownerDocument||document,Je=ft&&ft.defaultView||window;if(Je.getSelection){var ot=Je.getSelection(),ts=ee.textContent.length,ps=Math.min(Ne.start,ts),Cr=Ne.end===void 0?ps:Math.min(Ne.end,ts);!ot.extend&&ps>Cr&&(U=Cr,Cr=ps,ps=U);var $e=rd(ee,ps),Oe=rd(ee,Cr);if($e&&Oe&&(ot.rangeCount!==1||ot.anchorNode!==$e.node||ot.anchorOffset!==$e.offset||ot.focusNode!==Oe.node||ot.focusOffset!==Oe.offset)){var et=ft.createRange();et.setStart($e.node,$e.offset),ot.removeAllRanges(),ps>Cr?(ot.addRange(et),ot.extend(Oe.node,Oe.offset)):(et.setEnd(Oe.node,Oe.offset),ot.addRange(et))}}}}for(ft=[],ot=ee;ot=ot.parentNode;)ot.nodeType===1&&ft.push({element:ot,left:ot.scrollLeft,top:ot.scrollTop});for(typeof ee.focus=="function"&&ee.focus(),ee=0;ee<ft.length;ee++){var bt=ft[ee];bt.element.scrollLeft=bt.left,bt.element.scrollTop=bt.top}}qs=!!_c,Lu=_c=null}finally{rr=C,_e.p=p,fe.T=f}}i.current=c,ha=2}}function Dg(){if(ha===2){ha=0;var i=Pl,c=Ac,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=fe.T,fe.T=null;var p=_e.p;_e.p=2;var C=rr;rr|=4;try{hg(i,c.alternate,c)}finally{rr=C,_e.p=p,fe.T=f}}ha=3}}function Tg(){if(ha===4||ha===3){ha=0,ms();var i=Pl,c=Ac,f=bn,p=Fn;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?ha=5:(ha=0,Ac=Pl=null,wf(i,i.pendingLanes));var C=i.pendingLanes;if(C===0&&(Ol=null),Qr(f),c=c.stateNode,Ga&&typeof Ga.onCommitFiberRoot=="function")try{Ga.onCommitFiberRoot(zn,c,void 0,(c.current.flags&128)===128)}catch{}if(p!==null){c=fe.T,C=_e.p,_e.p=2,fe.T=null;try{for(var A=i.onRecoverableError,U=0;U<p.length;U++){var ee=p[U];A(ee.value,{componentStack:ee.stack})}}finally{fe.T=c,_e.p=C}}(bn&3)!==0&&Hd(),va(i),C=i.pendingLanes,(f&261930)!==0&&(C&42)!==0?i===Id?Pd++:(Pd=0,Id=i):Pd=0,ko(0)}}function wf(i,c){(i.pooledCacheLanes&=c)===0&&(c=i.pooledCache,c!=null&&(i.pooledCache=null,no(c)))}function Hd(){return Eg(),Dg(),Tg(),jf()}function jf(){if(ha!==5)return!1;var i=Pl,c=vu;vu=0;var f=Qr(bn),p=fe.T,C=_e.p;try{_e.p=32>f?32:f,fe.T=null,f=wu,wu=null;var A=Pl,U=bn;if(ha=0,Ac=Pl=null,bn=0,(rr&6)!==0)throw Error(o(331));var ee=rr;if(rr|=4,xg(A.current),Ld(A,A.current,U,f),rr=ee,ko(0,!1),Ga&&typeof Ga.onPostCommitFiberRoot=="function")try{Ga.onPostCommitFiberRoot(zn,A)}catch{}return!0}finally{_e.p=C,fe.T=p,wf(i,c)}}function Nf(i,c,f){c=dn(f,c),c=Fl(i.stateNode,c,2),i=Hi(i,c,2),i!==null&&(ni(i,2),va(i))}function lr(i,c,f){if(i.tag===3)Nf(i,i,f);else for(;c!==null;){if(c.tag===3){Nf(c,i,f);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Ol===null||!Ol.has(p))){i=dn(f,i),f=ef(2),p=Hi(c,f,2),p!==null&&(tf(f,p,c,i),ni(p,2),va(p));break}}c=c.return}}function Cu(i,c,f){var p=i.pingCache;if(p===null){p=i.pingCache=new Zp;var C=new Set;p.set(c,C)}else C=p.get(c),C===void 0&&(C=new Set,p.set(c,C));C.has(f)||(gu=!0,C.add(f),i=_g.bind(null,i,c,f),c.then(i,i))}function _g(i,c,f){var p=i.pingCache;p!==null&&p.delete(c),i.pingedLanes|=i.suspendedLanes&f,i.warmLanes&=~f,br===i&&(Ws&f)===f&&(Ur===4||Ur===3&&(Ws&62914560)===Ws&&300>ws()-xu?(rr&2)===0&&Ya(i,0):pu|=f,Sc===Ws&&(Sc=0)),va(i)}function kf(i,c){c===0&&(c=wr()),i=En(i,c),i!==null&&(ni(i,c),va(i))}function Fg(i){var c=i.memoizedState,f=0;c!==null&&(f=c.retryLane),kf(i,f)}function Mg(i,c){var f=0;switch(i.tag){case 31:case 13:var p=i.stateNode,C=i.memoizedState;C!==null&&(f=C.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(o(314))}p!==null&&p.delete(c),kf(i,f)}function Lg(i,c){return Lt(i,c)}var Vd=null,No=null,Su=!1,Au=!1,Eu=!1,el=0;function va(i){i!==No&&i.next===null&&(No===null?Vd=No=i:No=No.next=i),Au=!0,Su||(Su=!0,Mr())}function ko(i,c){if(!Eu&&Au){Eu=!0;do for(var f=!1,p=Vd;p!==null;){if(i!==0){var C=p.pendingLanes;if(C===0)var A=0;else{var U=p.suspendedLanes,ee=p.pingedLanes;A=(1<<31-Or(42|i)+1)-1,A&=C&~(U&~ee),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(f=!0,Gs(p,A))}else A=Ws,A=Tt(p,p===br?A:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(A&3)===0||cl(p,A)||(f=!0,Gs(p,A));p=p.next}while(f);Eu=!1}}function Rg(){tl()}function tl(){Au=Su=!1;var i=0;el!==0&&Ru()&&(i=el);for(var c=ws(),f=null,p=Vd;p!==null;){var C=p.next,A=Cf(p,c);A===0?(p.next=null,f===null?Vd=C:f.next=C,C===null&&(No=f)):(f=p,(i!==0||(A&3)!==0)&&(Au=!0)),p=C}ha!==0&&ha!==5||ko(i),el!==0&&(el=0)}function Cf(i,c){for(var f=i.suspendedLanes,p=i.pingedLanes,C=i.expirationTimes,A=i.pendingLanes&-62914561;0<A;){var U=31-Or(A),ee=1<<U,Ne=C[U];Ne===-1?((ee&f)===0||(ee&p)!==0)&&(C[U]=Uo(ee,c)):Ne<=c&&(i.expiredLanes|=ee),A&=~ee}if(c=br,f=Ws,f=Tt(i,i===c?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,f===0||i===c&&(ur===2||ur===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&ks(p),i.callbackNode=null,i.callbackPriority=0;if((f&3)===0||cl(i,f)){if(c=f&-f,c===i.callbackPriority)return c;switch(p!==null&&ks(p),Qr(f)){case 2:case 8:f=Dt;break;case 32:f=xs;break;case 268435456:f=dr;break;default:f=xs}return p=Tc.bind(null,i),f=Lt(f,p),i.callbackPriority=c,i.callbackNode=f,c}return p!==null&&p!==null&&ks(p),i.callbackPriority=2,i.callbackNode=null,2}function Tc(i,c){if(ha!==0&&ha!==5)return i.callbackNode=null,i.callbackPriority=0,null;var f=i.callbackNode;if(Hd()&&i.callbackNode!==f)return null;var p=Ws;return p=Tt(i,i===br?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(wg(i,p,c),Cf(i,ws()),i.callbackNode!=null&&i.callbackNode===f?Tc.bind(null,i):null)}function Gs(i,c){if(Hd())return null;wg(i,c,!0)}function Mr(){Pu(function(){(rr&6)!==0?Lt(st,Rg):tl()})}function Bs(){if(el===0){var i=io;i===0&&(i=ol,ol<<=1,(ol&261888)===0&&(ol=256)),el=i}return el}function Lr(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Be(""+i)}function Du(i,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,i.id&&f.setAttribute("form",i.id),c.parentNode.insertBefore(f,c),i=new FormData(i),f.parentNode.removeChild(f),i}function Mn(i,c,f,p,C){if(c==="submit"&&f&&f.stateNode===C){var A=Lr((C[Cs]||null).action),U=p.submitter;U&&(c=(c=U[Cs]||null)?Lr(c.formAction):U.getAttribute("formAction"),c!==null&&(A=c,U=null));var ee=new Zc("action","action",null,p,C);i.push({event:ee,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(el!==0){var Ne=U?Du(C,U):new FormData(C);Yh(f,{pending:!0,data:Ne,method:C.method,action:A},null,Ne)}}else typeof A=="function"&&(ee.preventDefault(),Ne=U?Du(C,U):new FormData(C),Yh(f,{pending:!0,data:Ne,method:C.method,action:A},A,Ne))},currentTarget:C}]})}}for(var sl=0;sl<$n.length;sl++){var Ja=$n[sl],Co=Ja.toLowerCase(),t1=Ja[0].toUpperCase()+Ja.slice(1);An(Co,"on"+t1)}An(gh,"onAnimationEnd"),An(ph,"onAnimationIteration"),An(Cm,"onAnimationStart"),An("dblclick","onDoubleClick"),An("focusin","onFocus"),An("focusout","onBlur"),An(xh,"onTransitionRun"),An(bh,"onTransitionStart"),An(Sm,"onTransitionCancel"),An(Am,"onTransitionEnd"),us("onMouseEnter",["mouseout","mouseover"]),us("onMouseLeave",["mouseout","mouseover"]),us("onPointerEnter",["pointerout","pointerover"]),us("onPointerLeave",["pointerout","pointerover"]),oi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),oi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),oi("onBeforeInput",["compositionend","keypress","textInput","paste"]),oi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),oi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),oi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var So="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sf=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(So));function Og(i,c){c=(c&4)!==0;for(var f=0;f<i.length;f++){var p=i[f],C=p.event;p=p.listeners;e:{var A=void 0;if(c)for(var U=p.length-1;0<=U;U--){var ee=p[U],Ne=ee.instance,qe=ee.currentTarget;if(ee=ee.listener,Ne!==A&&C.isPropagationStopped())break e;A=ee,C.currentTarget=qe;try{A(C)}catch(ut){tc(ut)}C.currentTarget=null,A=Ne}else for(U=0;U<p.length;U++){if(ee=p[U],Ne=ee.instance,qe=ee.currentTarget,ee=ee.listener,Ne!==A&&C.isPropagationStopped())break e;A=ee,C.currentTarget=qe;try{A(C)}catch(ut){tc(ut)}C.currentTarget=null,A=Ne}}}}function hs(i,c){var f=c[sr];f===void 0&&(f=c[sr]=new Set);var p=i+"__bubble";f.has(p)||(Pg(c,i,2,!1),f.add(p))}function Tu(i,c,f){var p=0;c&&(p|=4),Pg(f,i,p,c)}var _u="_reactListening"+Math.random().toString(36).slice(2);function Af(i){if(!i[_u]){i[_u]=!0,Pr.forEach(function(f){f!=="selectionchange"&&(Sf.has(f)||Tu(f,!1,i),Tu(f,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[_u]||(c[_u]=!0,Tu("selectionchange",!1,c))}}function Pg(i,c,f,p){switch(Se(c)){case 2:var C=fa;break;case 8:C=Ln;break;default:C=ge}f=C.bind(null,c,f,i),C=void 0,!Is||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(C=!0),p?C!==void 0?i.addEventListener(c,f,{capture:!0,passive:C}):i.addEventListener(c,f,!0):C!==void 0?i.addEventListener(c,f,{passive:C}):i.addEventListener(c,f,!1)}function Fu(i,c,f,p,C){var A=p;if((c&1)===0&&(c&2)===0&&p!==null)e:for(;;){if(p===null)return;var U=p.tag;if(U===3||U===4){var ee=p.stateNode.containerInfo;if(ee===C)break;if(U===4)for(U=p.return;U!==null;){var Ne=U.tag;if((Ne===3||Ne===4)&&U.stateNode.containerInfo===C)return;U=U.return}for(;ee!==null;){if(U=Nn(ee),U===null)return;if(Ne=U.tag,Ne===5||Ne===6||Ne===26||Ne===27){p=A=U;continue e}ee=ee.parentNode}}p=p.return}Zt(function(){var qe=A,ut=Fe(f),ft=[];e:{var Je=ec.get(i);if(Je!==void 0){var ot=Zc,ts=i;switch(i){case"keypress":if(pl(f)===0)break e;case"keydown":case"keyup":ot=Kl;break;case"focusin":ts="focus",ot=m0;break;case"focusout":ts="blur",ot=m0;break;case"beforeblur":case"afterblur":ot=m0;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=nh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=wm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=Hp;break;case gh:case ph:case Cm:ot=ih;break;case Am:ot=Wp;break;case"scroll":case"scrollend":ot=ym;break;case"wheel":ot=Na;break;case"copy":case"cut":case"paste":ot=oh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=Xo;break;case"toggle":case"beforetoggle":ot=mt}var ps=(c&4)!==0,Cr=!ps&&(i==="scroll"||i==="scrollend"),$e=ps?Je!==null?Je+"Capture":null:Je;ps=[];for(var Oe=qe,et;Oe!==null;){var bt=Oe;if(et=bt.stateNode,bt=bt.tag,bt!==5&&bt!==26&&bt!==27||et===null||$e===null||(bt=js(Oe,$e),bt!=null&&ps.push(Wd(Oe,bt,et))),Cr)break;Oe=Oe.return}0<ps.length&&(Je=new ot(Je,ts,null,f,ut),ft.push({event:Je,listeners:ps}))}}if((c&7)===0){e:{if(Je=i==="mouseover"||i==="pointerover",ot=i==="mouseout"||i==="pointerout",Je&&f!==Ze&&(ts=f.relatedTarget||f.fromElement)&&(Nn(ts)||ts[_a]))break e;if((ot||Je)&&(Je=ut.window===ut?ut:(Je=ut.ownerDocument)?Je.defaultView||Je.parentWindow:window,ot?(ts=f.relatedTarget||f.toElement,ot=qe,ts=ts?Nn(ts):null,ts!==null&&(Cr=e(ts),ps=ts.tag,ts!==Cr||ps!==5&&ps!==27&&ps!==6)&&(ts=null)):(ot=null,ts=qe),ot!==ts)){if(ps=nh,bt="onMouseLeave",$e="onMouseEnter",Oe="mouse",(i==="pointerout"||i==="pointerover")&&(ps=Xo,bt="onPointerLeave",$e="onPointerEnter",Oe="pointer"),Cr=ot==null?Je:ul(ot),et=ts==null?Je:ul(ts),Je=new ps(bt,Oe+"leave",ot,f,ut),Je.target=Cr,Je.relatedTarget=et,bt=null,Nn(ut)===qe&&(ps=new ps($e,Oe+"enter",ts,f,ut),ps.target=et,ps.relatedTarget=Cr,bt=ps),Cr=bt,ot&&ts)t:{for(ps=Ef,$e=ot,Oe=ts,et=0,bt=$e;bt;bt=ps(bt))et++;bt=0;for(var fs=Oe;fs;fs=ps(fs))bt++;for(;0<et-bt;)$e=ps($e),et--;for(;0<bt-et;)Oe=ps(Oe),bt--;for(;et--;){if($e===Oe||Oe!==null&&$e===Oe.alternate){ps=$e;break t}$e=ps($e),Oe=ps(Oe)}ps=null}else ps=null;ot!==null&&Mu(ft,Je,ot,ps,!1),ts!==null&&Cr!==null&&Mu(ft,Cr,ts,ps,!0)}}e:{if(Je=qe?ul(qe):window,ot=Je.nodeName&&Je.nodeName.toLowerCase(),ot==="select"||ot==="input"&&Je.type==="file")var or=fh;else if(La(Je))if(Ql)or=Jl;else{or=Cn;var ls=$p}else ot=Je.nodeName,!ot||ot.toLowerCase()!=="input"||Je.type!=="checkbox"&&Je.type!=="radio"?qe&&nt(qe.elementType)&&(or=fh):or=Xl;if(or&&(or=or(i,qe))){Ss(ft,or,f,ut);break e}ls&&ls(i,Je,qe),i==="focusout"&&qe&&Je.type==="number"&&qe.memoizedProps.value!=null&&Ys(Je,"number",Je.value)}switch(ls=qe?ul(qe):window,i){case"focusin":(La(ls)||ls.contentEditable==="true")&&(eo=ls,j0=qe,Wn=null);break;case"focusout":Wn=j0=eo=null;break;case"mousedown":vl=!0;break;case"contextmenu":case"mouseup":case"dragend":vl=!1,ka(ft,f,ut);break;case"selectionchange":if(mh)break;case"keydown":case"keyup":ka(ft,f,ut)}var Ps;if(Ma)e:{switch(i){case"compositionstart":var Ks="onCompositionStart";break e;case"compositionend":Ks="onCompositionEnd";break e;case"compositionupdate":Ks="onCompositionUpdate";break e}Ks=void 0}else yl?b0(i,f)&&(Ks="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(Ks="onCompositionStart");Ks&&(hh&&f.locale!=="ko"&&(yl||Ks!=="onCompositionStart"?Ks==="onCompositionEnd"&&yl&&(Ps=d0()):(Ia=ut,Bt="value"in Ia?Ia.value:Ia.textContent,yl=!0)),ls=$d(qe,Ks),0<ls.length&&(Ks=new g0(Ks,i,null,f,ut),ft.push({event:Ks,listeners:ls}),Ps?Ks.data=Ps:(Ps=Br(f),Ps!==null&&(Ks.data=Ps)))),(Ps=td?Er(i,f):zr(i,f))&&(Ks=$d(qe,"onBeforeInput"),0<Ks.length&&(ls=new g0("onBeforeInput","beforeinput",null,f,ut),ft.push({event:ls,listeners:Ks}),ls.data=Ps)),Mn(ft,i,qe,f,ut)}Og(ft,c)})}function Wd(i,c,f){return{instance:i,listener:c,currentTarget:f}}function $d(i,c){for(var f=c+"Capture",p=[];i!==null;){var C=i,A=C.stateNode;if(C=C.tag,C!==5&&C!==26&&C!==27||A===null||(C=js(i,f),C!=null&&p.unshift(Wd(i,C,A)),C=js(i,c),C!=null&&p.push(Wd(i,C,A))),i.tag===3)return p;i=i.return}return[]}function Ef(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Mu(i,c,f,p,C){for(var A=c._reactName,U=[];f!==null&&f!==p;){var ee=f,Ne=ee.alternate,qe=ee.stateNode;if(ee=ee.tag,Ne!==null&&Ne===p)break;ee!==5&&ee!==26&&ee!==27||qe===null||(Ne=qe,C?(qe=js(f,A),qe!=null&&U.unshift(Wd(f,qe,Ne))):C||(qe=js(f,A),qe!=null&&U.push(Wd(f,qe,Ne)))),f=f.return}U.length!==0&&i.push({event:c,listeners:U})}var s1=/\r\n?/g,r1=/\u0000|\uFFFD/g;function yn(i){return(typeof i=="string"?i:""+i).replace(s1,`
`).replace(r1,"")}function Df(i,c){return c=yn(c),yn(i)===c}function mr(i,c,f,p,C,A){switch(f){case"children":typeof p=="string"?c==="body"||c==="textarea"&&p===""||Fi(i,p):(typeof p=="number"||typeof p=="bigint")&&c!=="body"&&Fi(i,""+p);break;case"className":Jr(i,"class",p);break;case"tabIndex":Jr(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Jr(i,f,p);break;case"style":Ve(i,p,A);break;case"data":if(c!=="object"){Jr(i,"data",p);break}case"src":case"href":if(p===""&&(c!=="a"||f!=="href")){i.removeAttribute(f);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=Be(""+p),i.setAttribute(f,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(f==="formAction"?(c!=="input"&&mr(i,c,"name",C.name,C,null),mr(i,c,"formEncType",C.formEncType,C,null),mr(i,c,"formMethod",C.formMethod,C,null),mr(i,c,"formTarget",C.formTarget,C,null)):(mr(i,c,"encType",C.encType,C,null),mr(i,c,"method",C.method,C,null),mr(i,c,"target",C.target,C,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=Be(""+p),i.setAttribute(f,p);break;case"onClick":p!=null&&(i.onclick=Ke);break;case"onScroll":p!=null&&hs("scroll",i);break;case"onScrollEnd":p!=null&&hs("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(o(61));if(f=p.__html,f!=null){if(C.children!=null)throw Error(o(60));i.innerHTML=f}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}f=Be(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""+p):i.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""):i.removeAttribute(f);break;case"capture":case"download":p===!0?i.setAttribute(f,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,p):i.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(f,p):i.removeAttribute(f);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(f):i.setAttribute(f,p);break;case"popover":hs("beforetoggle",i),hs("toggle",i),Vo(i,"popover",p);break;case"xlinkActuate":Un(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Un(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Un(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Un(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Un(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Un(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Un(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Un(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Un(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Vo(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Ue.get(f)||f,Vo(i,f,p))}}function Tf(i,c,f,p,C,A){switch(f){case"style":Ve(i,p,A);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(o(61));if(f=p.__html,f!=null){if(C.children!=null)throw Error(o(60));i.innerHTML=f}}break;case"children":typeof p=="string"?Fi(i,p):(typeof p=="number"||typeof p=="bigint")&&Fi(i,""+p);break;case"onScroll":p!=null&&hs("scroll",i);break;case"onScrollEnd":p!=null&&hs("scrollend",i);break;case"onClick":p!=null&&(i.onclick=Ke);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ar.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(C=f.endsWith("Capture"),c=f.slice(2,C?f.length-7:void 0),A=i[Cs]||null,A=A!=null?A[f]:null,typeof A=="function"&&i.removeEventListener(c,A,C),typeof p=="function")){typeof A!="function"&&A!==null&&(f in i?i[f]=null:i.hasAttribute(f)&&i.removeAttribute(f)),i.addEventListener(c,p,C);break e}f in i?i[f]=p:p===!0?i.setAttribute(f,""):Vo(i,f,p)}}}function wa(i,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":hs("error",i),hs("load",i);var p=!1,C=!1,A;for(A in f)if(f.hasOwnProperty(A)){var U=f[A];if(U!=null)switch(A){case"src":p=!0;break;case"srcSet":C=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,c));default:mr(i,c,A,U,f,null)}}C&&mr(i,c,"srcSet",f.srcSet,f,null),p&&mr(i,c,"src",f.src,f,null);return;case"input":hs("invalid",i);var ee=A=U=C=null,Ne=null,qe=null;for(p in f)if(f.hasOwnProperty(p)){var ut=f[p];if(ut!=null)switch(p){case"name":C=ut;break;case"type":U=ut;break;case"checked":Ne=ut;break;case"defaultChecked":qe=ut;break;case"value":A=ut;break;case"defaultValue":ee=ut;break;case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(o(137,c));break;default:mr(i,c,p,ut,f,null)}}Xc(i,A,ee,Ne,qe,U,C,!1);return;case"select":hs("invalid",i),p=U=A=null;for(C in f)if(f.hasOwnProperty(C)&&(ee=f[C],ee!=null))switch(C){case"value":A=ee;break;case"defaultValue":U=ee;break;case"multiple":p=ee;default:mr(i,c,C,ee,f,null)}c=A,f=U,i.multiple=!!p,c!=null?_i(i,!!p,c,!1):f!=null&&_i(i,!!p,f,!0);return;case"textarea":hs("invalid",i),A=C=p=null;for(U in f)if(f.hasOwnProperty(U)&&(ee=f[U],ee!=null))switch(U){case"value":p=ee;break;case"defaultValue":C=ee;break;case"children":A=ee;break;case"dangerouslySetInnerHTML":if(ee!=null)throw Error(o(91));break;default:mr(i,c,U,ee,f,null)}$o(i,p,C,A);return;case"option":for(Ne in f)f.hasOwnProperty(Ne)&&(p=f[Ne],p!=null)&&(Ne==="selected"?i.selected=p&&typeof p!="function"&&typeof p!="symbol":mr(i,c,Ne,p,f,null));return;case"dialog":hs("beforetoggle",i),hs("toggle",i),hs("cancel",i),hs("close",i);break;case"iframe":case"object":hs("load",i);break;case"video":case"audio":for(p=0;p<So.length;p++)hs(So[p],i);break;case"image":hs("error",i),hs("load",i);break;case"details":hs("toggle",i);break;case"embed":case"source":case"link":hs("error",i),hs("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(qe in f)if(f.hasOwnProperty(qe)&&(p=f[qe],p!=null))switch(qe){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,c));default:mr(i,c,qe,p,f,null)}return;default:if(nt(c)){for(ut in f)f.hasOwnProperty(ut)&&(p=f[ut],p!==void 0&&Tf(i,c,ut,p,f,void 0));return}}for(ee in f)f.hasOwnProperty(ee)&&(p=f[ee],p!=null&&mr(i,c,ee,p,f,null))}function _f(i,c,f,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var C=null,A=null,U=null,ee=null,Ne=null,qe=null,ut=null;for(ot in f){var ft=f[ot];if(f.hasOwnProperty(ot)&&ft!=null)switch(ot){case"checked":break;case"value":break;case"defaultValue":Ne=ft;default:p.hasOwnProperty(ot)||mr(i,c,ot,null,p,ft)}}for(var Je in p){var ot=p[Je];if(ft=f[Je],p.hasOwnProperty(Je)&&(ot!=null||ft!=null))switch(Je){case"type":A=ot;break;case"name":C=ot;break;case"checked":qe=ot;break;case"defaultChecked":ut=ot;break;case"value":U=ot;break;case"defaultValue":ee=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(o(137,c));break;default:ot!==ft&&mr(i,c,Je,ot,p,ft)}}gl(i,U,ee,Ne,qe,ut,A,C);return;case"select":ot=U=ee=Je=null;for(A in f)if(Ne=f[A],f.hasOwnProperty(A)&&Ne!=null)switch(A){case"value":break;case"multiple":ot=Ne;default:p.hasOwnProperty(A)||mr(i,c,A,null,p,Ne)}for(C in p)if(A=p[C],Ne=f[C],p.hasOwnProperty(C)&&(A!=null||Ne!=null))switch(C){case"value":Je=A;break;case"defaultValue":ee=A;break;case"multiple":U=A;default:A!==Ne&&mr(i,c,C,A,p,Ne)}c=ee,f=U,p=ot,Je!=null?_i(i,!!f,Je,!1):!!p!=!!f&&(c!=null?_i(i,!!f,c,!0):_i(i,!!f,f?[]:"",!1));return;case"textarea":ot=Je=null;for(ee in f)if(C=f[ee],f.hasOwnProperty(ee)&&C!=null&&!p.hasOwnProperty(ee))switch(ee){case"value":break;case"children":break;default:mr(i,c,ee,null,p,C)}for(U in p)if(C=p[U],A=f[U],p.hasOwnProperty(U)&&(C!=null||A!=null))switch(U){case"value":Je=C;break;case"defaultValue":ot=C;break;case"children":break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(o(91));break;default:C!==A&&mr(i,c,U,C,p,A)}Jc(i,Je,ot);return;case"option":for(var ts in f)Je=f[ts],f.hasOwnProperty(ts)&&Je!=null&&!p.hasOwnProperty(ts)&&(ts==="selected"?i.selected=!1:mr(i,c,ts,null,p,Je));for(Ne in p)Je=p[Ne],ot=f[Ne],p.hasOwnProperty(Ne)&&Je!==ot&&(Je!=null||ot!=null)&&(Ne==="selected"?i.selected=Je&&typeof Je!="function"&&typeof Je!="symbol":mr(i,c,Ne,Je,p,ot));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ps in f)Je=f[ps],f.hasOwnProperty(ps)&&Je!=null&&!p.hasOwnProperty(ps)&&mr(i,c,ps,null,p,Je);for(qe in p)if(Je=p[qe],ot=f[qe],p.hasOwnProperty(qe)&&Je!==ot&&(Je!=null||ot!=null))switch(qe){case"children":case"dangerouslySetInnerHTML":if(Je!=null)throw Error(o(137,c));break;default:mr(i,c,qe,Je,p,ot)}return;default:if(nt(c)){for(var Cr in f)Je=f[Cr],f.hasOwnProperty(Cr)&&Je!==void 0&&!p.hasOwnProperty(Cr)&&Tf(i,c,Cr,void 0,p,Je);for(ut in p)Je=p[ut],ot=f[ut],!p.hasOwnProperty(ut)||Je===ot||Je===void 0&&ot===void 0||Tf(i,c,ut,Je,p,ot);return}}for(var $e in f)Je=f[$e],f.hasOwnProperty($e)&&Je!=null&&!p.hasOwnProperty($e)&&mr(i,c,$e,null,p,Je);for(ft in p)Je=p[ft],ot=f[ft],!p.hasOwnProperty(ft)||Je===ot||Je==null&&ot==null||mr(i,c,ft,Je,p,ot)}function Ff(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Mf(){if(typeof performance.getEntriesByType=="function"){for(var i=0,c=0,f=performance.getEntriesByType("resource"),p=0;p<f.length;p++){var C=f[p],A=C.transferSize,U=C.initiatorType,ee=C.duration;if(A&&ee&&Ff(U)){for(U=0,ee=C.responseEnd,p+=1;p<f.length;p++){var Ne=f[p],qe=Ne.startTime;if(qe>ee)break;var ut=Ne.transferSize,ft=Ne.initiatorType;ut&&Ff(ft)&&(Ne=Ne.responseEnd,U+=ut*(Ne<ee?1:(ee-qe)/(Ne-qe)))}if(--p,c+=8*(A+U)/(C.duration/1e3),i++,10<i)break}}if(0<i)return c/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var _c=null,Lu=null;function qd(i){return i.nodeType===9?i:i.ownerDocument}function Lf(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ei(i,c){if(i===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&c==="foreignObject"?0:i}function Fc(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Yd=null;function Ru(){var i=window.event;return i&&i.type==="popstate"?i===Yd?!1:(Yd=i,!0):(Yd=null,!1)}var Ou=typeof setTimeout=="function"?setTimeout:void 0,Ig=typeof clearTimeout=="function"?clearTimeout:void 0,Rf=typeof Promise=="function"?Promise:void 0,Pu=typeof queueMicrotask=="function"?queueMicrotask:typeof Rf<"u"?function(i){return Rf.resolve(null).then(i).catch(Bg)}:Ou;function Bg(i){setTimeout(function(){throw i})}function rl(i){return i==="head"}function Iu(i,c){var f=c,p=0;do{var C=f.nextSibling;if(i.removeChild(f),C&&C.nodeType===8)if(f=C.data,f==="/$"||f==="/&"){if(p===0){i.removeChild(C),ns(c);return}p--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")p++;else if(f==="html")d(i.ownerDocument.documentElement);else if(f==="head"){f=i.ownerDocument.head,d(f);for(var A=f.firstChild;A;){var U=A.nextSibling,ee=A.nodeName;A[Xr]||ee==="SCRIPT"||ee==="STYLE"||ee==="LINK"&&A.rel.toLowerCase()==="stylesheet"||f.removeChild(A),A=U}}else f==="body"&&d(i.ownerDocument.body);f=C}while(f);ns(c)}function Of(i,c){var f=i;i=0;do{var p=f.nextSibling;if(f.nodeType===1?c?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(c?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),p&&p.nodeType===8)if(f=p.data,f==="/$"){if(i===0)break;i--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||i++;f=p}while(f)}function Bu(i){var c=i.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Bu(f),li(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}i.removeChild(f)}}function zu(i,c,f,p){for(;i.nodeType===1;){var C=f;if(i.nodeName.toLowerCase()!==c.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Xr])switch(c){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(A=i.getAttribute("rel"),A==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(A!==C.rel||i.getAttribute("href")!==(C.href==null||C.href===""?null:C.href)||i.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin)||i.getAttribute("title")!==(C.title==null?null:C.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(A=i.getAttribute("src"),(A!==(C.src==null?null:C.src)||i.getAttribute("type")!==(C.type==null?null:C.type)||i.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin))&&A&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(c==="input"&&i.type==="hidden"){var A=C.name==null?null:""+C.name;if(C.type==="hidden"&&i.getAttribute("name")===A)return i}else return i;if(i=vn(i.nextSibling),i===null)break}return null}function Pf(i,c,f){if(c==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!f||(i=vn(i.nextSibling),i===null))return null;return i}function Uu(i,c){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=vn(i.nextSibling),i===null))return null;return i}function Hu(i){return i.data==="$?"||i.data==="$~"}function Mc(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function If(i,c){var f=i.ownerDocument;if(i.data==="$~")i._reactRetry=c;else if(i.data!=="$?"||f.readyState!=="loading")c();else{var p=function(){c(),f.removeEventListener("DOMContentLoaded",p)};f.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function vn(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return i}var Bl=null;function $s(i){i=i.nextSibling;for(var c=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"||f==="/&"){if(c===0)return vn(i.nextSibling);c--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||c++}i=i.nextSibling}return null}function zg(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(c===0)return i;c--}else f!=="/$"&&f!=="/&"||c++}i=i.previousSibling}return null}function r(i,c,f){switch(c=qd(f),i){case"html":if(i=c.documentElement,!i)throw Error(o(452));return i;case"head":if(i=c.head,!i)throw Error(o(453));return i;case"body":if(i=c.body,!i)throw Error(o(454));return i;default:throw Error(o(451))}}function d(i){for(var c=i.attributes;c.length;)i.removeAttributeNode(c[0]);li(i)}var u=new Map,h=new Set;function g(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var b=_e.d;_e.d={f:x,r:y,D:E,C:T,L:_,m:R,X:I,S:q,M:J};function x(){var i=b.f(),c=ju();return i||c}function y(i){var c=Di(i);c!==null&&c.tag===5&&c.type==="form"?$m(c):b.r(i)}var j=typeof document>"u"?null:document;function k(i,c,f){var p=j;if(p&&typeof c=="string"&&c){var C=ys(c);C='link[rel="'+i+'"][href="'+C+'"]',typeof f=="string"&&(C+='[crossorigin="'+f+'"]'),h.has(C)||(h.add(C),i={rel:i,crossOrigin:f,href:c},p.querySelector(C)===null&&(c=p.createElement("link"),wa(c,"link",i),Vr(c),p.head.appendChild(c)))}}function E(i){b.D(i),k("dns-prefetch",i,null)}function T(i,c){b.C(i,c),k("preconnect",i,c)}function _(i,c,f){b.L(i,c,f);var p=j;if(p&&i&&c){var C='link[rel="preload"][as="'+ys(c)+'"]';c==="image"&&f&&f.imageSrcSet?(C+='[imagesrcset="'+ys(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(C+='[imagesizes="'+ys(f.imageSizes)+'"]')):C+='[href="'+ys(i)+'"]';var A=C;switch(c){case"style":A=z(i);break;case"script":A=Ee(i)}u.has(A)||(i=D({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:i,as:c},f),u.set(A,i),p.querySelector(C)!==null||c==="style"&&p.querySelector(X(A))||c==="script"&&p.querySelector(He(A))||(c=p.createElement("link"),wa(c,"link",i),Vr(c),p.head.appendChild(c)))}}function R(i,c){b.m(i,c);var f=j;if(f&&i){var p=c&&typeof c.as=="string"?c.as:"script",C='link[rel="modulepreload"][as="'+ys(p)+'"][href="'+ys(i)+'"]',A=C;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Ee(i)}if(!u.has(A)&&(i=D({rel:"modulepreload",href:i},c),u.set(A,i),f.querySelector(C)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(He(A)))return}p=f.createElement("link"),wa(p,"link",i),Vr(p),f.head.appendChild(p)}}}function q(i,c,f){b.S(i,c,f);var p=j;if(p&&i){var C=ca(p).hoistableStyles,A=z(i);c=c||"default";var U=C.get(A);if(!U){var ee={loading:0,preload:null};if(U=p.querySelector(X(A)))ee.loading=5;else{i=D({rel:"stylesheet",href:i,"data-precedence":c},f),(f=u.get(A))&&pt(i,f);var Ne=U=p.createElement("link");Vr(Ne),wa(Ne,"link",i),Ne._p=new Promise(function(qe,ut){Ne.onload=qe,Ne.onerror=ut}),Ne.addEventListener("load",function(){ee.loading|=1}),Ne.addEventListener("error",function(){ee.loading|=2}),ee.loading|=4,Qe(U,c,p)}U={type:"stylesheet",instance:U,count:1,state:ee},C.set(A,U)}}}function I(i,c){b.X(i,c);var f=j;if(f&&i){var p=ca(f).hoistableScripts,C=Ee(i),A=p.get(C);A||(A=f.querySelector(He(C)),A||(i=D({src:i,async:!0},c),(c=u.get(C))&&xt(i,c),A=f.createElement("script"),Vr(A),wa(A,"link",i),f.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(C,A))}}function J(i,c){b.M(i,c);var f=j;if(f&&i){var p=ca(f).hoistableScripts,C=Ee(i),A=p.get(C);A||(A=f.querySelector(He(C)),A||(i=D({src:i,async:!0,type:"module"},c),(c=u.get(C))&&xt(i,c),A=f.createElement("script"),Vr(A),wa(A,"link",i),f.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(C,A))}}function Y(i,c,f,p){var C=(C=H.current)?g(C):null;if(!C)throw Error(o(446));switch(i){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=z(f.href),f=ca(C).hoistableStyles,p=f.get(c),p||(p={type:"style",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){i=z(f.href);var A=ca(C).hoistableStyles,U=A.get(i);if(U||(C=C.ownerDocument||C,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(i,U),(A=C.querySelector(X(i)))&&!A._p&&(U.instance=A,U.state.loading=5),u.has(i)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},u.set(i,f),A||le(C,i,f,U.state))),c&&p===null)throw Error(o(528,""));return U}if(c&&p!==null)throw Error(o(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Ee(f),f=ca(C).hoistableScripts,p=f.get(c),p||(p={type:"script",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,i))}}function z(i){return'href="'+ys(i)+'"'}function X(i){return'link[rel="stylesheet"]['+i+"]"}function ie(i){return D({},i,{"data-precedence":i.precedence,precedence:null})}function le(i,c,f,p){i.querySelector('link[rel="preload"][as="style"]['+c+"]")?p.loading=1:(c=i.createElement("link"),p.preload=c,c.addEventListener("load",function(){return p.loading|=1}),c.addEventListener("error",function(){return p.loading|=2}),wa(c,"link",f),Vr(c),i.head.appendChild(c))}function Ee(i){return'[src="'+ys(i)+'"]'}function He(i){return"script[async]"+i}function Pe(i,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var p=i.querySelector('style[data-href~="'+ys(f.href)+'"]');if(p)return c.instance=p,Vr(p),p;var C=D({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Vr(p),wa(p,"style",C),Qe(p,f.precedence,i),c.instance=p;case"stylesheet":C=z(f.href);var A=i.querySelector(X(C));if(A)return c.state.loading|=4,c.instance=A,Vr(A),A;p=ie(f),(C=u.get(C))&&pt(p,C),A=(i.ownerDocument||i).createElement("link"),Vr(A);var U=A;return U._p=new Promise(function(ee,Ne){U.onload=ee,U.onerror=Ne}),wa(A,"link",p),c.state.loading|=4,Qe(A,f.precedence,i),c.instance=A;case"script":return A=Ee(f.src),(C=i.querySelector(He(A)))?(c.instance=C,Vr(C),C):(p=f,(C=u.get(A))&&(p=D({},f),xt(p,C)),i=i.ownerDocument||i,C=i.createElement("script"),Vr(C),wa(C,"link",p),i.head.appendChild(C),c.instance=C);case"void":return null;default:throw Error(o(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(p=c.instance,c.state.loading|=4,Qe(p,f.precedence,i));return c.instance}function Qe(i,c,f){for(var p=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),C=p.length?p[p.length-1]:null,A=C,U=0;U<p.length;U++){var ee=p[U];if(ee.dataset.precedence===c)A=ee;else if(A!==C)break}A?A.parentNode.insertBefore(i,A.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(i,c.firstChild))}function pt(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.title==null&&(i.title=c.title)}function xt(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.integrity==null&&(i.integrity=c.integrity)}var at=null;function kt(i,c,f){if(at===null){var p=new Map,C=at=new Map;C.set(f,p)}else C=at,p=C.get(f),p||(p=new Map,C.set(f,p));if(p.has(i))return p;for(p.set(i,null),f=f.getElementsByTagName(i),C=0;C<f.length;C++){var A=f[C];if(!(A[Xr]||A[Xs]||i==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var U=A.getAttribute(c)||"";U=i+U;var ee=p.get(U);ee?ee.push(A):p.set(U,[A])}}return p}function Wt(i,c,f){i=i.ownerDocument||i,i.head.insertBefore(f,c==="title"?i.querySelector("head > title"):null)}function Ht(i,c,f){if(f===1||c.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(i=c.disabled,typeof c.precedence=="string"&&i==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Mt(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Ot(i,c,f,p){if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var C=z(p.href),A=c.querySelector(X(C));if(A){c=A._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(i.count++,i=Yt.bind(i),c.then(i,i)),f.state.loading|=4,f.instance=A,Vr(A);return}A=c.ownerDocument||c,p=ie(p),(C=u.get(C))&&pt(p,C),A=A.createElement("link"),Vr(A);var U=A;U._p=new Promise(function(ee,Ne){U.onload=ee,U.onerror=Ne}),wa(A,"link",p),f.instance=A}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(i.count++,f=Yt.bind(i),c.addEventListener("load",f),c.addEventListener("error",f))}}var _t=0;function wt(i,c){return i.stylesheets&&i.count===0&&is(i,i.stylesheets),0<i.count||0<i.imgCount?function(f){var p=setTimeout(function(){if(i.stylesheets&&is(i,i.stylesheets),i.unsuspend){var A=i.unsuspend;i.unsuspend=null,A()}},6e4+c);0<i.imgBytes&&_t===0&&(_t=62500*Mf());var C=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&is(i,i.stylesheets),i.unsuspend)){var A=i.unsuspend;i.unsuspend=null,A()}},(i.imgBytes>_t?50:800)+c);return i.unsuspend=f,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(C)}}:null}function Yt(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)is(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Jt=null;function is(i,c){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Jt=new Map,c.forEach(Ds,i),Jt=null,Yt.call(i))}function Ds(i,c){if(!(c.state.loading&4)){var f=Jt.get(i);if(f)var p=f.get(null);else{f=new Map,Jt.set(i,f);for(var C=i.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<C.length;A++){var U=C[A];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(f.set(U.dataset.precedence,U),p=U)}p&&f.set(null,p)}C=c.instance,U=C.getAttribute("data-precedence"),A=f.get(U)||p,A===p&&f.set(null,C),f.set(U,C),this.count++,p=Yt.bind(this),C.addEventListener("load",p),C.addEventListener("error",p),A?A.parentNode.insertBefore(C,A.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(C,i.firstChild)),c.state.loading|=4}}var $t={$$typeof:re,Provider:null,Consumer:null,_currentValue:We,_currentValue2:We,_threadCount:0};function Ct(i,c,f,p,C,A,U,ee,Ne){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ai(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ai(0),this.hiddenUpdates=Ai(null),this.identifierPrefix=p,this.onUncaughtError=C,this.onCaughtError=A,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ne,this.incompleteTransitions=new Map}function gs(i,c,f,p,C,A,U,ee,Ne,qe,ut,ft){return i=new Ct(i,c,f,U,Ne,qe,ut,ft,ee),c=1,A===!0&&(c|=24),A=_r(3,null,null,c),i.current=A,A.stateNode=i,c=ac(),c.refCount++,i.pooledCache=c,c.refCount++,A.memoizedState={element:p,isDehydrated:f,cache:c},z0(A),i}function Us(i){return i?(i=so,i):so}function Os(i,c,f,p,C,A){C=Us(C),p.context===null?p.context=C:p.pendingContext=C,p=Sa(c),p.payload={element:f},A=A===void 0?null:A,A!==null&&(p.callback=A),f=Hi(i,p,c),f!==null&&(qa(f,i,c),co(f,i,c))}function er(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<c?f:c}}function Rr(i,c){er(i,c),(i=i.alternate)&&er(i,c)}function Me(i){if(i.tag===13||i.tag===31){var c=En(i,67108864);c!==null&&qa(c,i,67108864),Rr(i,67108864)}}function tr(i){if(i.tag===13||i.tag===31){var c=$a();c=Yl(c);var f=En(i,c);f!==null&&qa(f,i,c),Rr(i,c)}}var qs=!0;function fa(i,c,f,p){var C=fe.T;fe.T=null;var A=_e.p;try{_e.p=2,ge(i,c,f,p)}finally{_e.p=A,fe.T=C}}function Ln(i,c,f,p){var C=fe.T;fe.T=null;var A=_e.p;try{_e.p=8,ge(i,c,f,p)}finally{_e.p=A,fe.T=C}}function ge(i,c,f,p){if(qs){var C=lt(p);if(C===null)Fu(i,c,p,De,f),Ut(i,p);else if(rs(C,i,c,f,p))p.stopPropagation();else if(Ut(i,p),c&4&&-1<Gt.indexOf(i)){for(;C!==null;){var A=Di(C);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var U=Si(A.pendingLanes);if(U!==0){var ee=A;for(ee.pendingLanes|=2,ee.entangledLanes|=2;U;){var Ne=1<<31-Or(U);ee.entanglements[1]|=Ne,U&=~Ne}va(A),(rr&6)===0&&(bu=ws()+500,ko(0))}}break;case 31:case 13:ee=En(A,2),ee!==null&&qa(ee,A,2),ju(),Rr(A,2)}if(A=lt(p),A===null&&Fu(i,c,p,De,f),A===C)break;C=A}C!==null&&p.stopPropagation()}else Fu(i,c,p,null,f)}}function lt(i){return i=Fe(i),tt(i)}var De=null;function tt(i){if(De=null,i=Nn(i),i!==null){var c=e(i);if(c===null)i=null;else{var f=c.tag;if(f===13){if(i=m(c),i!==null)return i;i=null}else if(f===31){if(i=v(c),i!==null)return i;i=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null)}}return De=i,null}function Se(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ie()){case st:return 2;case Dt:return 8;case xs:case Pa:return 32;case dr:return 268435456;default:return 32}default:return 32}}var Nt=!1,Xe=null,ct=null,Ye=null,ht=new Map,St=new Map,Qt=[],Gt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ut(i,c){switch(i){case"focusin":case"focusout":Xe=null;break;case"dragenter":case"dragleave":ct=null;break;case"mouseover":case"mouseout":Ye=null;break;case"pointerover":case"pointerout":ht.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":St.delete(c.pointerId)}}function Xt(i,c,f,p,C,A){return i===null||i.nativeEvent!==A?(i={blockedOn:c,domEventName:f,eventSystemFlags:p,nativeEvent:A,targetContainers:[C]},c!==null&&(c=Di(c),c!==null&&Me(c)),i):(i.eventSystemFlags|=p,c=i.targetContainers,C!==null&&c.indexOf(C)===-1&&c.push(C),i)}function rs(i,c,f,p,C){switch(c){case"focusin":return Xe=Xt(Xe,i,c,f,p,C),!0;case"dragenter":return ct=Xt(ct,i,c,f,p,C),!0;case"mouseover":return Ye=Xt(Ye,i,c,f,p,C),!0;case"pointerover":var A=C.pointerId;return ht.set(A,Xt(ht.get(A)||null,i,c,f,p,C)),!0;case"gotpointercapture":return A=C.pointerId,St.set(A,Xt(St.get(A)||null,i,c,f,p,C)),!0}return!1}function ss(i){var c=Nn(i.target);if(c!==null){var f=e(c);if(f!==null){if(c=f.tag,c===13){if(c=m(f),c!==null){i.blockedOn=c,Gl(i.priority,function(){tr(f)});return}}else if(c===31){if(c=v(f),c!==null){i.blockedOn=c,Gl(i.priority,function(){tr(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Pt(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var f=lt(i.nativeEvent);if(f===null){f=i.nativeEvent;var p=new f.constructor(f.type,f);Ze=p,f.target.dispatchEvent(p),Ze=null}else return c=Di(f),c!==null&&Me(c),i.blockedOn=f,!1;c.shift()}return!0}function Et(i,c,f){Pt(i)&&f.delete(c)}function as(){Nt=!1,Xe!==null&&Pt(Xe)&&(Xe=null),ct!==null&&Pt(ct)&&(ct=null),Ye!==null&&Pt(Ye)&&(Ye=null),ht.forEach(Et),St.forEach(Et)}function qt(i,c){i.blockedOn===c&&(i.blockedOn=null,Nt||(Nt=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,as)))}var Ft=null;function cs(i){Ft!==i&&(Ft=i,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){Ft===i&&(Ft=null);for(var c=0;c<i.length;c+=3){var f=i[c],p=i[c+1],C=i[c+2];if(typeof p!="function"){if(tt(p||f)===null)continue;break}var A=Di(f);A!==null&&(i.splice(c,3),c-=3,Yh(A,{pending:!0,data:C,method:f.method,action:p},p,C))}}))}function ns(i){function c(Ne){return qt(Ne,i)}Xe!==null&&qt(Xe,i),ct!==null&&qt(ct,i),Ye!==null&&qt(Ye,i),ht.forEach(c),St.forEach(c);for(var f=0;f<Qt.length;f++){var p=Qt[f];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Qt.length&&(f=Qt[0],f.blockedOn===null);)ss(f),f.blockedOn===null&&Qt.shift();if(f=(i.ownerDocument||i).$$reactFormReplay,f!=null)for(p=0;p<f.length;p+=3){var C=f[p],A=f[p+1],U=C[Cs]||null;if(typeof A=="function")U||cs(f);else if(U){var ee=null;if(A&&A.hasAttribute("formAction")){if(C=A,U=A[Cs]||null)ee=U.formAction;else if(tt(C)!==null)continue}else ee=U.action;typeof ee=="function"?f[p+1]=ee:(f.splice(p,3),p-=3),cs(f)}}}function gr(){function i(A){A.canIntercept&&A.info==="react-transition"&&A.intercept({handler:function(){return new Promise(function(U){return C=U})},focusReset:"manual",scroll:"manual"})}function c(){C!==null&&(C(),C=null),p||setTimeout(f,20)}function f(){if(!p&&!navigation.transition){var A=navigation.currentEntry;A&&A.url!=null&&navigation.navigate(A.url,{state:A.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,C=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(f,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),C!==null&&(C(),C=null)}}}function ds(i){this._internalRoot=i}vs.prototype.render=ds.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(o(409));var f=c.current,p=$a();Os(f,p,i,c,null,null)},vs.prototype.unmount=ds.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;Os(i.current,2,null,i,null,null),ju(),c[_a]=null}};function vs(i){this._internalRoot=i}vs.prototype.unstable_scheduleHydration=function(i){if(i){var c=wn();i={blockedOn:null,target:i,priority:c};for(var f=0;f<Qt.length&&c!==0&&c<Qt[f].priority;f++);Qt.splice(f,0,i),f===0&&ss(i)}};var es=n.version;if(es!=="19.2.3")throw Error(o(527,es,"19.2.3"));_e.findDOMNode=function(i){var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(o(188)):(i=Object.keys(i).join(","),Error(o(268,i)));return i=N(c),i=i!==null?S(i):null,i=i===null?null:i.stateNode,i};var zs={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:fe,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ms=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ms.isDisabled&&Ms.supportsFiber)try{zn=Ms.inject(zs),Ga=Ms}catch{}}return zf.createRoot=function(i,c){if(!s(i))throw Error(o(299));var f=!1,p="",C=su,A=sg,U=rg;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(C=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError)),c=gs(i,1,!1,null,null,f,p,null,C,A,U,gr),i[_a]=c.current,Af(i),new ds(c)},zf.hydrateRoot=function(i,c,f){if(!s(i))throw Error(o(299));var p=!1,C="",A=su,U=sg,ee=rg,Ne=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(C=f.identifierPrefix),f.onUncaughtError!==void 0&&(A=f.onUncaughtError),f.onCaughtError!==void 0&&(U=f.onCaughtError),f.onRecoverableError!==void 0&&(ee=f.onRecoverableError),f.formState!==void 0&&(Ne=f.formState)),c=gs(i,1,!0,c,f??null,p,C,Ne,A,U,ee,gr),c.context=Us(null),f=c.current,p=$a(),p=Yl(p),C=Sa(p),C.callback=null,Hi(f,C,p),f=p,c.current.lanes=f,ni(c,f),va(c),i[_a]=c.current,Af(i),new vs(c)},zf.version="19.2.3",zf}var Rx;function Ov(){if(Rx)return i1.exports;Rx=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(n){console.error(n)}}return l(),i1.exports=Rv(),i1.exports}var Pv=Ov();const Iv=Ob(Pv);var Ox="popstate";function Bv(l={}){function n(o,s){let{pathname:e,search:m,hash:v}=o.location;return B1("",{pathname:e,search:m,hash:v},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(o,s){return typeof s=="string"?s:rm(s)}return Uv(n,a,null,l)}function Gr(l,n){if(l===!1||l===null||typeof l>"u")throw new Error(n)}function si(l,n){if(!l){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function zv(){return Math.random().toString(36).substring(2,10)}function Px(l,n){return{usr:l.state,key:l.key,idx:n}}function B1(l,n,a=null,o){return{pathname:typeof l=="string"?l:l.pathname,search:"",hash:"",...typeof n=="string"?Zu(n):n,state:a,key:n&&n.key||o||zv()}}function rm({pathname:l="/",search:n="",hash:a=""}){return n&&n!=="?"&&(l+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(l+=a.charAt(0)==="#"?a:"#"+a),l}function Zu(l){let n={};if(l){let a=l.indexOf("#");a>=0&&(n.hash=l.substring(a),l=l.substring(0,a));let o=l.indexOf("?");o>=0&&(n.search=l.substring(o),l=l.substring(0,o)),l&&(n.pathname=l)}return n}function Uv(l,n,a,o={}){let{window:s=document.defaultView,v5Compat:e=!1}=o,m=s.history,v="POP",w=null,N=S();N==null&&(N=0,m.replaceState({...m.state,idx:N},""));function S(){return(m.state||{idx:null}).idx}function D(){v="POP";let P=S(),G=P==null?null:P-N;N=P,w&&w({action:v,location:O.location,delta:G})}function L(P,G){v="PUSH";let ae=B1(O.location,P,G);N=S()+1;let re=Px(ae,N),ke=O.createHref(ae);try{m.pushState(re,"",ke)}catch(xe){if(xe instanceof DOMException&&xe.name==="DataCloneError")throw xe;s.location.assign(ke)}e&&w&&w({action:v,location:O.location,delta:1})}function M(P,G){v="REPLACE";let ae=B1(O.location,P,G);N=S();let re=Px(ae,N),ke=O.createHref(ae);m.replaceState(re,"",ke),e&&w&&w({action:v,location:O.location,delta:0})}function F(P){return Hv(P)}let O={get action(){return v},get location(){return l(s,m)},listen(P){if(w)throw new Error("A history only accepts one active listener");return s.addEventListener(Ox,D),w=P,()=>{s.removeEventListener(Ox,D),w=null}},createHref(P){return n(s,P)},createURL:F,encodeLocation(P){let G=F(P);return{pathname:G.pathname,search:G.search,hash:G.hash}},push:L,replace:M,go(P){return m.go(P)}};return O}function Hv(l,n=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),Gr(a,"No window.location.(origin|href) available to create URL");let o=typeof l=="string"?l:rm(l);return o=o.replace(/ $/,"%20"),!n&&o.startsWith("//")&&(o=a+o),new URL(o,a)}function Pb(l,n,a="/"){return Vv(l,n,a,!1)}function Vv(l,n,a,o){let s=typeof n=="string"?Zu(n):n,e=Oo(s.pathname||"/",a);if(e==null)return null;let m=Ib(l);Wv(m);let v=null;for(let w=0;v==null&&w<m.length;++w){let N=t4(e);v=Zv(m[w],N,o)}return v}function Ib(l,n=[],a=[],o="",s=!1){let e=(m,v,w=s,N)=>{let S={relativePath:N===void 0?m.path||"":N,caseSensitive:m.caseSensitive===!0,childrenIndex:v,route:m};if(S.relativePath.startsWith("/")){if(!S.relativePath.startsWith(o)&&w)return;Gr(S.relativePath.startsWith(o),`Absolute route path "${S.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),S.relativePath=S.relativePath.slice(o.length)}let D=Ro([o,S.relativePath]),L=a.concat(S);m.children&&m.children.length>0&&(Gr(m.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${D}".`),Ib(m.children,n,L,D,w)),!(m.path==null&&!m.index)&&n.push({path:D,score:Xv(D,m.index),routesMeta:L})};return l.forEach((m,v)=>{if(m.path===""||!m.path?.includes("?"))e(m,v);else for(let w of Bb(m.path))e(m,v,!0,w)}),n}function Bb(l){let n=l.split("/");if(n.length===0)return[];let[a,...o]=n,s=a.endsWith("?"),e=a.replace(/\?$/,"");if(o.length===0)return s?[e,""]:[e];let m=Bb(o.join("/")),v=[];return v.push(...m.map(w=>w===""?e:[e,w].join("/"))),s&&v.push(...m),v.map(w=>l.startsWith("/")&&w===""?"/":w)}function Wv(l){l.sort((n,a)=>n.score!==a.score?a.score-n.score:Jv(n.routesMeta.map(o=>o.childrenIndex),a.routesMeta.map(o=>o.childrenIndex)))}var $v=/^:[\w-]+$/,qv=3,Yv=2,Gv=1,Kv=10,Qv=-2,Ix=l=>l==="*";function Xv(l,n){let a=l.split("/"),o=a.length;return a.some(Ix)&&(o+=Qv),n&&(o+=Yv),a.filter(s=>!Ix(s)).reduce((s,e)=>s+($v.test(e)?qv:e===""?Gv:Kv),o)}function Jv(l,n){return l.length===n.length&&l.slice(0,-1).every((o,s)=>o===n[s])?l[l.length-1]-n[n.length-1]:0}function Zv(l,n,a=!1){let{routesMeta:o}=l,s={},e="/",m=[];for(let v=0;v<o.length;++v){let w=o[v],N=v===o.length-1,S=e==="/"?n:n.slice(e.length)||"/",D=gp({path:w.relativePath,caseSensitive:w.caseSensitive,end:N},S),L=w.route;if(!D&&N&&a&&!o[o.length-1].route.index&&(D=gp({path:w.relativePath,caseSensitive:w.caseSensitive,end:!1},S)),!D)return null;Object.assign(s,D.params),m.push({params:s,pathname:Ro([e,D.pathname]),pathnameBase:n4(Ro([e,D.pathnameBase])),route:L}),D.pathnameBase!=="/"&&(e=Ro([e,D.pathnameBase]))}return m}function gp(l,n){typeof l=="string"&&(l={path:l,caseSensitive:!1,end:!0});let[a,o]=e4(l.path,l.caseSensitive,l.end),s=n.match(a);if(!s)return null;let e=s[0],m=e.replace(/(.)\/+$/,"$1"),v=s.slice(1);return{params:o.reduce((N,{paramName:S,isOptional:D},L)=>{if(S==="*"){let F=v[L]||"";m=e.slice(0,e.length-F.length).replace(/(.)\/+$/,"$1")}const M=v[L];return D&&!M?N[S]=void 0:N[S]=(M||"").replace(/%2F/g,"/"),N},{}),pathname:e,pathnameBase:m,pattern:l}}function e4(l,n=!1,a=!0){si(l==="*"||!l.endsWith("*")||l.endsWith("/*"),`Route path "${l}" will be treated as if it were "${l.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${l.replace(/\*$/,"/*")}".`);let o=[],s="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(m,v,w)=>(o.push({paramName:v,isOptional:w!=null}),w?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return l.endsWith("*")?(o.push({paramName:"*"}),s+=l==="*"||l==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":l!==""&&l!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,n?void 0:"i"),o]}function t4(l){try{return l.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return si(!1,`The URL path "${l}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),l}}function Oo(l,n){if(n==="/")return l;if(!l.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,o=l.charAt(a);return o&&o!=="/"?null:l.slice(a)||"/"}var zb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,s4=l=>zb.test(l);function r4(l,n="/"){let{pathname:a,search:o="",hash:s=""}=typeof l=="string"?Zu(l):l,e;if(a)if(s4(a))e=a;else{if(a.includes("//")){let m=a;a=a.replace(/\/\/+/g,"/"),si(!1,`Pathnames cannot have embedded double slashes - normalizing ${m} -> ${a}`)}a.startsWith("/")?e=Bx(a.substring(1),"/"):e=Bx(a,n)}else e=n;return{pathname:e,search:i4(o),hash:l4(s)}}function Bx(l,n){let a=n.replace(/\/+$/,"").split("/");return l.split("/").forEach(s=>{s===".."?a.length>1&&a.pop():s!=="."&&a.push(s)}),a.length>1?a.join("/"):"/"}function d1(l,n,a,o){return`Cannot include a '${l}' character in a manually specified \`to.${n}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function a4(l){return l.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function tx(l){let n=a4(l);return n.map((a,o)=>o===n.length-1?a.pathname:a.pathnameBase)}function sx(l,n,a,o=!1){let s;typeof l=="string"?s=Zu(l):(s={...l},Gr(!s.pathname||!s.pathname.includes("?"),d1("?","pathname","search",s)),Gr(!s.pathname||!s.pathname.includes("#"),d1("#","pathname","hash",s)),Gr(!s.search||!s.search.includes("#"),d1("#","search","hash",s)));let e=l===""||s.pathname==="",m=e?"/":s.pathname,v;if(m==null)v=a;else{let D=n.length-1;if(!o&&m.startsWith("..")){let L=m.split("/");for(;L[0]==="..";)L.shift(),D-=1;s.pathname=L.join("/")}v=D>=0?n[D]:"/"}let w=r4(s,v),N=m&&m!=="/"&&m.endsWith("/"),S=(e||m===".")&&a.endsWith("/");return!w.pathname.endsWith("/")&&(N||S)&&(w.pathname+="/"),w}var Ro=l=>l.join("/").replace(/\/\/+/g,"/"),n4=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),i4=l=>!l||l==="?"?"":l.startsWith("?")?l:"?"+l,l4=l=>!l||l==="#"?"":l.startsWith("#")?l:"#"+l,o4=class{constructor(l,n,a,o=!1){this.status=l,this.statusText=n||"",this.internal=o,a instanceof Error?(this.data=a.toString(),this.error=a):this.data=a}};function c4(l){return l!=null&&typeof l.status=="number"&&typeof l.statusText=="string"&&typeof l.internal=="boolean"&&"data"in l}function d4(l){return l.map(n=>n.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Ub=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Hb(l,n){let a=l;if(typeof a!="string"||!zb.test(a))return{absoluteURL:void 0,isExternal:!1,to:a};let o=a,s=!1;if(Ub)try{let e=new URL(window.location.href),m=a.startsWith("//")?new URL(e.protocol+a):new URL(a),v=Oo(m.pathname,n);m.origin===e.origin&&v!=null?a=v+m.search+m.hash:s=!0}catch{si(!1,`<Link to="${a}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:o,isExternal:s,to:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Vb=["POST","PUT","PATCH","DELETE"];new Set(Vb);var u4=["GET",...Vb];new Set(u4);var eh=B.createContext(null);eh.displayName="DataRouter";var Cp=B.createContext(null);Cp.displayName="DataRouterState";var h4=B.createContext(!1),Wb=B.createContext({isTransitioning:!1});Wb.displayName="ViewTransition";var f4=B.createContext(new Map);f4.displayName="Fetchers";var m4=B.createContext(null);m4.displayName="Await";var ri=B.createContext(null);ri.displayName="Navigation";var um=B.createContext(null);um.displayName="Location";var ki=B.createContext({outlet:null,matches:[],isDataRoute:!1});ki.displayName="Route";var rx=B.createContext(null);rx.displayName="RouteError";var $b="REACT_ROUTER_ERROR",g4="REDIRECT",p4="ROUTE_ERROR_RESPONSE";function x4(l){if(l.startsWith(`${$b}:${g4}:{`))try{let n=JSON.parse(l.slice(28));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.location=="string"&&typeof n.reloadDocument=="boolean"&&typeof n.replace=="boolean")return n}catch{}}function b4(l){if(l.startsWith(`${$b}:${p4}:{`))try{let n=JSON.parse(l.slice(40));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string")return new o4(n.status,n.statusText,n.data)}catch{}}function y4(l,{relative:n}={}){Gr(th(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:o}=B.useContext(ri),{hash:s,pathname:e,search:m}=hm(l,{relative:n}),v=e;return a!=="/"&&(v=e==="/"?a:Ro([a,e])),o.createHref({pathname:v,search:m,hash:s})}function th(){return B.useContext(um)!=null}function ql(){return Gr(th(),"useLocation() may be used only in the context of a <Router> component."),B.useContext(um).location}var qb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Yb(l){B.useContext(ri).static||B.useLayoutEffect(l)}function Tr(){let{isDataRoute:l}=B.useContext(ki);return l?L4():v4()}function v4(){Gr(th(),"useNavigate() may be used only in the context of a <Router> component.");let l=B.useContext(eh),{basename:n,navigator:a}=B.useContext(ri),{matches:o}=B.useContext(ki),{pathname:s}=ql(),e=JSON.stringify(tx(o)),m=B.useRef(!1);return Yb(()=>{m.current=!0}),B.useCallback((w,N={})=>{if(si(m.current,qb),!m.current)return;if(typeof w=="number"){a.go(w);return}let S=sx(w,JSON.parse(e),s,N.relative==="path");l==null&&n!=="/"&&(S.pathname=S.pathname==="/"?n:Ro([n,S.pathname])),(N.replace?a.replace:a.push)(S,N.state,N)},[n,a,e,s,l])}var w4=B.createContext(null);function j4(l){let n=B.useContext(ki).outlet;return B.useMemo(()=>n&&B.createElement(w4.Provider,{value:l},n),[n,l])}function ai(){let{matches:l}=B.useContext(ki),n=l[l.length-1];return n?n.params:{}}function hm(l,{relative:n}={}){let{matches:a}=B.useContext(ki),{pathname:o}=ql(),s=JSON.stringify(tx(a));return B.useMemo(()=>sx(l,JSON.parse(s),o,n==="path"),[l,s,o,n])}function N4(l,n){return Gb(l,n)}function Gb(l,n,a,o,s){Gr(th(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:e}=B.useContext(ri),{matches:m}=B.useContext(ki),v=m[m.length-1],w=v?v.params:{},N=v?v.pathname:"/",S=v?v.pathnameBase:"/",D=v&&v.route;{let ae=D&&D.path||"";Qb(N,!D||ae.endsWith("*")||ae.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${N}" (under <Route path="${ae}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ae}"> to <Route path="${ae==="/"?"*":`${ae}/*`}">.`)}let L=ql(),M;if(n){let ae=typeof n=="string"?Zu(n):n;Gr(S==="/"||ae.pathname?.startsWith(S),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${S}" but pathname "${ae.pathname}" was given in the \`location\` prop.`),M=ae}else M=L;let F=M.pathname||"/",O=F;if(S!=="/"){let ae=S.replace(/^\//,"").split("/");O="/"+F.replace(/^\//,"").split("/").slice(ae.length).join("/")}let P=Pb(l,{pathname:O});si(D||P!=null,`No routes matched location "${M.pathname}${M.search}${M.hash}" `),si(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${M.pathname}${M.search}${M.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let G=E4(P&&P.map(ae=>Object.assign({},ae,{params:Object.assign({},w,ae.params),pathname:Ro([S,e.encodeLocation?e.encodeLocation(ae.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ae.pathname]),pathnameBase:ae.pathnameBase==="/"?S:Ro([S,e.encodeLocation?e.encodeLocation(ae.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ae.pathnameBase])})),m,a,o,s);return n&&G?B.createElement(um.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...M},navigationType:"POP"}},G):G}function k4(){let l=M4(),n=c4(l)?`${l.status} ${l.statusText}`:l instanceof Error?l.message:JSON.stringify(l),a=l instanceof Error?l.stack:null,o="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:o},e={padding:"2px 4px",backgroundColor:o},m=null;return console.error("Error handled by React Router default ErrorBoundary:",l),m=B.createElement(B.Fragment,null,B.createElement("p",null," Hey developer "),B.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",B.createElement("code",{style:e},"ErrorBoundary")," or"," ",B.createElement("code",{style:e},"errorElement")," prop on your route.")),B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},n),a?B.createElement("pre",{style:s},a):null,m)}var C4=B.createElement(k4,null),Kb=class extends B.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,n){return n.location!==l.location||n.revalidation!=="idle"&&l.revalidation==="idle"?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:l.error!==void 0?l.error:n.error,location:n.location,revalidation:l.revalidation||n.revalidation}}componentDidCatch(l,n){this.props.onError?this.props.onError(l,n):console.error("React Router caught the following error during render",l)}render(){let l=this.state.error;if(this.context&&typeof l=="object"&&l&&"digest"in l&&typeof l.digest=="string"){const a=b4(l.digest);a&&(l=a)}let n=l!==void 0?B.createElement(ki.Provider,{value:this.props.routeContext},B.createElement(rx.Provider,{value:l,children:this.props.component})):this.props.children;return this.context?B.createElement(S4,{error:l},n):n}};Kb.contextType=h4;var u1=new WeakMap;function S4({children:l,error:n}){let{basename:a}=B.useContext(ri);if(typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){let o=x4(n.digest);if(o){let s=u1.get(n);if(s)throw s;let e=Hb(o.location,a);if(Ub&&!u1.get(n))if(e.isExternal||o.reloadDocument)window.location.href=e.absoluteURL||e.to;else{const m=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(e.to,{replace:o.replace}));throw u1.set(n,m),m}return B.createElement("meta",{httpEquiv:"refresh",content:`0;url=${e.absoluteURL||e.to}`})}}return l}function A4({routeContext:l,match:n,children:a}){let o=B.useContext(eh);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),B.createElement(ki.Provider,{value:l},a)}function E4(l,n=[],a=null,o=null,s=null){if(l==null){if(!a)return null;if(a.errors)l=a.matches;else if(n.length===0&&!a.initialized&&a.matches.length>0)l=a.matches;else return null}let e=l,m=a?.errors;if(m!=null){let S=e.findIndex(D=>D.route.id&&m?.[D.route.id]!==void 0);Gr(S>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(m).join(",")}`),e=e.slice(0,Math.min(e.length,S+1))}let v=!1,w=-1;if(a)for(let S=0;S<e.length;S++){let D=e[S];if((D.route.HydrateFallback||D.route.hydrateFallbackElement)&&(w=S),D.route.id){let{loaderData:L,errors:M}=a,F=D.route.loader&&!L.hasOwnProperty(D.route.id)&&(!M||M[D.route.id]===void 0);if(D.route.lazy||F){v=!0,w>=0?e=e.slice(0,w+1):e=[e[0]];break}}}let N=a&&o?(S,D)=>{o(S,{location:a.location,params:a.matches?.[0]?.params??{},unstable_pattern:d4(a.matches),errorInfo:D})}:void 0;return e.reduceRight((S,D,L)=>{let M,F=!1,O=null,P=null;a&&(M=m&&D.route.id?m[D.route.id]:void 0,O=D.route.errorElement||C4,v&&(w<0&&L===0?(Qb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),F=!0,P=null):w===L&&(F=!0,P=D.route.hydrateFallbackElement||null)));let G=n.concat(e.slice(0,L+1)),ae=()=>{let re;return M?re=O:F?re=P:D.route.Component?re=B.createElement(D.route.Component,null):D.route.element?re=D.route.element:re=S,B.createElement(A4,{match:D,routeContext:{outlet:S,matches:G,isDataRoute:a!=null},children:re})};return a&&(D.route.ErrorBoundary||D.route.errorElement||L===0)?B.createElement(Kb,{location:a.location,revalidation:a.revalidation,component:O,error:M,children:ae(),routeContext:{outlet:null,matches:G,isDataRoute:!0},onError:N}):ae()},null)}function ax(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function D4(l){let n=B.useContext(eh);return Gr(n,ax(l)),n}function T4(l){let n=B.useContext(Cp);return Gr(n,ax(l)),n}function _4(l){let n=B.useContext(ki);return Gr(n,ax(l)),n}function nx(l){let n=_4(l),a=n.matches[n.matches.length-1];return Gr(a.route.id,`${l} can only be used on routes that contain a unique "id"`),a.route.id}function F4(){return nx("useRouteId")}function M4(){let l=B.useContext(rx),n=T4("useRouteError"),a=nx("useRouteError");return l!==void 0?l:n.errors?.[a]}function L4(){let{router:l}=D4("useNavigate"),n=nx("useNavigate"),a=B.useRef(!1);return Yb(()=>{a.current=!0}),B.useCallback(async(s,e={})=>{si(a.current,qb),a.current&&(typeof s=="number"?await l.navigate(s):await l.navigate(s,{fromRouteId:n,...e}))},[l,n])}var zx={};function Qb(l,n,a){!n&&!zx[l]&&(zx[l]=!0,si(!1,a))}B.memo(R4);function R4({routes:l,future:n,state:a,onError:o}){return Gb(l,void 0,a,o,n)}function pp({to:l,replace:n,state:a,relative:o}){Gr(th(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=B.useContext(ri);si(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:e}=B.useContext(ki),{pathname:m}=ql(),v=Tr(),w=sx(l,tx(e),m,o==="path"),N=JSON.stringify(w);return B.useEffect(()=>{v(JSON.parse(N),{replace:n,state:a,relative:o})},[v,N,o,n,a]),null}function O4(l){return j4(l.context)}function yr(l){Gr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function P4({basename:l="/",children:n=null,location:a,navigationType:o="POP",navigator:s,static:e=!1,unstable_useTransitions:m}){Gr(!th(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let v=l.replace(/^\/*/,"/"),w=B.useMemo(()=>({basename:v,navigator:s,static:e,unstable_useTransitions:m,future:{}}),[v,s,e,m]);typeof a=="string"&&(a=Zu(a));let{pathname:N="/",search:S="",hash:D="",state:L=null,key:M="default"}=a,F=B.useMemo(()=>{let O=Oo(N,v);return O==null?null:{location:{pathname:O,search:S,hash:D,state:L,key:M},navigationType:o}},[v,N,S,D,L,M,o]);return si(F!=null,`<Router basename="${v}"> is not able to match the URL "${N}${S}${D}" because it does not start with the basename, so the <Router> won't render anything.`),F==null?null:B.createElement(ri.Provider,{value:w},B.createElement(um.Provider,{children:n,value:F}))}function I4({children:l,location:n}){return N4(z1(l),n)}function z1(l,n=[]){let a=[];return B.Children.forEach(l,(o,s)=>{if(!B.isValidElement(o))return;let e=[...n,s];if(o.type===B.Fragment){a.push.apply(a,z1(o.props.children,e));return}Gr(o.type===yr,`[${typeof o.type=="string"?o.type:o.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gr(!o.props.index||!o.props.children,"An index route cannot have child routes.");let m={id:o.props.id||e.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,middleware:o.props.middleware,loader:o.props.loader,action:o.props.action,hydrateFallbackElement:o.props.hydrateFallbackElement,HydrateFallback:o.props.HydrateFallback,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.hasErrorBoundary===!0||o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(m.children=z1(o.props.children,e)),a.push(m)}),a}var ip="get",lp="application/x-www-form-urlencoded";function Sp(l){return typeof HTMLElement<"u"&&l instanceof HTMLElement}function B4(l){return Sp(l)&&l.tagName.toLowerCase()==="button"}function z4(l){return Sp(l)&&l.tagName.toLowerCase()==="form"}function U4(l){return Sp(l)&&l.tagName.toLowerCase()==="input"}function H4(l){return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}function V4(l,n){return l.button===0&&(!n||n==="_self")&&!H4(l)}function U1(l=""){return new URLSearchParams(typeof l=="string"||Array.isArray(l)||l instanceof URLSearchParams?l:Object.keys(l).reduce((n,a)=>{let o=l[a];return n.concat(Array.isArray(o)?o.map(s=>[a,s]):[[a,o]])},[]))}function W4(l,n){let a=U1(l);return n&&n.forEach((o,s)=>{a.has(s)||n.getAll(s).forEach(e=>{a.append(s,e)})}),a}var Ug=null;function $4(){if(Ug===null)try{new FormData(document.createElement("form"),0),Ug=!1}catch{Ug=!0}return Ug}var q4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function h1(l){return l!=null&&!q4.has(l)?(si(!1,`"${l}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${lp}"`),null):l}function Y4(l,n){let a,o,s,e,m;if(z4(l)){let v=l.getAttribute("action");o=v?Oo(v,n):null,a=l.getAttribute("method")||ip,s=h1(l.getAttribute("enctype"))||lp,e=new FormData(l)}else if(B4(l)||U4(l)&&(l.type==="submit"||l.type==="image")){let v=l.form;if(v==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let w=l.getAttribute("formaction")||v.getAttribute("action");if(o=w?Oo(w,n):null,a=l.getAttribute("formmethod")||v.getAttribute("method")||ip,s=h1(l.getAttribute("formenctype"))||h1(v.getAttribute("enctype"))||lp,e=new FormData(v,l),!$4()){let{name:N,type:S,value:D}=l;if(S==="image"){let L=N?`${N}.`:"";e.append(`${L}x`,"0"),e.append(`${L}y`,"0")}else N&&e.append(N,D)}}else{if(Sp(l))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=ip,o=null,s=lp,m=l}return e&&s==="text/plain"&&(m=e,e=void 0),{action:o,method:a.toLowerCase(),encType:s,formData:e,body:m}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ix(l,n){if(l===!1||l===null||typeof l>"u")throw new Error(n)}function G4(l,n,a){let o=typeof l=="string"?new URL(l,typeof window>"u"?"server://singlefetch/":window.location.origin):l;return o.pathname==="/"?o.pathname=`_root.${a}`:n&&Oo(o.pathname,n)==="/"?o.pathname=`${n.replace(/\/$/,"")}/_root.${a}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${a}`,o}async function K4(l,n){if(l.id in n)return n[l.id];try{let a=await import(l.module);return n[l.id]=a,a}catch(a){return console.error(`Error loading route module \`${l.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Q4(l){return l==null?!1:l.href==null?l.rel==="preload"&&typeof l.imageSrcSet=="string"&&typeof l.imageSizes=="string":typeof l.rel=="string"&&typeof l.href=="string"}async function X4(l,n,a){let o=await Promise.all(l.map(async s=>{let e=n.routes[s.route.id];if(e){let m=await K4(e,a);return m.links?m.links():[]}return[]}));return tw(o.flat(1).filter(Q4).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Ux(l,n,a,o,s,e){let m=(w,N)=>a[N]?w.route.id!==a[N].route.id:!0,v=(w,N)=>a[N].pathname!==w.pathname||a[N].route.path?.endsWith("*")&&a[N].params["*"]!==w.params["*"];return e==="assets"?n.filter((w,N)=>m(w,N)||v(w,N)):e==="data"?n.filter((w,N)=>{let S=o.routes[w.route.id];if(!S||!S.hasLoader)return!1;if(m(w,N)||v(w,N))return!0;if(w.route.shouldRevalidate){let D=w.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:a[0]?.params||{},nextUrl:new URL(l,window.origin),nextParams:w.params,defaultShouldRevalidate:!0});if(typeof D=="boolean")return D}return!0}):[]}function J4(l,n,{includeHydrateFallback:a}={}){return Z4(l.map(o=>{let s=n.routes[o.route.id];if(!s)return[];let e=[s.module];return s.clientActionModule&&(e=e.concat(s.clientActionModule)),s.clientLoaderModule&&(e=e.concat(s.clientLoaderModule)),a&&s.hydrateFallbackModule&&(e=e.concat(s.hydrateFallbackModule)),s.imports&&(e=e.concat(s.imports)),e}).flat(1))}function Z4(l){return[...new Set(l)]}function ew(l){let n={},a=Object.keys(l).sort();for(let o of a)n[o]=l[o];return n}function tw(l,n){let a=new Set;return new Set(n),l.reduce((o,s)=>{let e=JSON.stringify(ew(s));return a.has(e)||(a.add(e),o.push({key:e,link:s})),o},[])}function Xb(){let l=B.useContext(eh);return ix(l,"You must render this element inside a <DataRouterContext.Provider> element"),l}function sw(){let l=B.useContext(Cp);return ix(l,"You must render this element inside a <DataRouterStateContext.Provider> element"),l}var lx=B.createContext(void 0);lx.displayName="FrameworkContext";function Jb(){let l=B.useContext(lx);return ix(l,"You must render this element inside a <HydratedRouter> element"),l}function rw(l,n){let a=B.useContext(lx),[o,s]=B.useState(!1),[e,m]=B.useState(!1),{onFocus:v,onBlur:w,onMouseEnter:N,onMouseLeave:S,onTouchStart:D}=n,L=B.useRef(null);B.useEffect(()=>{if(l==="render"&&m(!0),l==="viewport"){let O=G=>{G.forEach(ae=>{m(ae.isIntersecting)})},P=new IntersectionObserver(O,{threshold:.5});return L.current&&P.observe(L.current),()=>{P.disconnect()}}},[l]),B.useEffect(()=>{if(o){let O=setTimeout(()=>{m(!0)},100);return()=>{clearTimeout(O)}}},[o]);let M=()=>{s(!0)},F=()=>{s(!1),m(!1)};return a?l!=="intent"?[e,L,{}]:[e,L,{onFocus:Uf(v,M),onBlur:Uf(w,F),onMouseEnter:Uf(N,M),onMouseLeave:Uf(S,F),onTouchStart:Uf(D,M)}]:[!1,L,{}]}function Uf(l,n){return a=>{l&&l(a),a.defaultPrevented||n(a)}}function aw({page:l,...n}){let{router:a}=Xb(),o=B.useMemo(()=>Pb(a.routes,l,a.basename),[a.routes,l,a.basename]);return o?B.createElement(iw,{page:l,matches:o,...n}):null}function nw(l){let{manifest:n,routeModules:a}=Jb(),[o,s]=B.useState([]);return B.useEffect(()=>{let e=!1;return X4(l,n,a).then(m=>{e||s(m)}),()=>{e=!0}},[l,n,a]),o}function iw({page:l,matches:n,...a}){let o=ql(),{manifest:s,routeModules:e}=Jb(),{basename:m}=Xb(),{loaderData:v,matches:w}=sw(),N=B.useMemo(()=>Ux(l,n,w,s,o,"data"),[l,n,w,s,o]),S=B.useMemo(()=>Ux(l,n,w,s,o,"assets"),[l,n,w,s,o]),D=B.useMemo(()=>{if(l===o.pathname+o.search+o.hash)return[];let F=new Set,O=!1;if(n.forEach(G=>{let ae=s.routes[G.route.id];!ae||!ae.hasLoader||(!N.some(re=>re.route.id===G.route.id)&&G.route.id in v&&e[G.route.id]?.shouldRevalidate||ae.hasClientLoader?O=!0:F.add(G.route.id))}),F.size===0)return[];let P=G4(l,m,"data");return O&&F.size>0&&P.searchParams.set("_routes",n.filter(G=>F.has(G.route.id)).map(G=>G.route.id).join(",")),[P.pathname+P.search]},[m,v,o,s,N,n,l,e]),L=B.useMemo(()=>J4(S,s),[S,s]),M=nw(S);return B.createElement(B.Fragment,null,D.map(F=>B.createElement("link",{key:F,rel:"prefetch",as:"fetch",href:F,...a})),L.map(F=>B.createElement("link",{key:F,rel:"modulepreload",href:F,...a})),M.map(({key:F,link:O})=>B.createElement("link",{key:F,nonce:a.nonce,...O})))}function lw(...l){return n=>{l.forEach(a=>{typeof a=="function"?a(n):a!=null&&(a.current=n)})}}var ow=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ow&&(window.__reactRouterVersion="7.11.0")}catch{}function cw({basename:l,children:n,unstable_useTransitions:a,window:o}){let s=B.useRef();s.current==null&&(s.current=Bv({window:o,v5Compat:!0}));let e=s.current,[m,v]=B.useState({action:e.action,location:e.location}),w=B.useCallback(N=>{a===!1?v(N):B.startTransition(()=>v(N))},[a]);return B.useLayoutEffect(()=>e.listen(w),[e,w]),B.createElement(P4,{basename:l,children:n,location:m.location,navigationType:m.action,navigator:e,unstable_useTransitions:a})}var Zb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ey=B.forwardRef(function({onClick:n,discover:a="render",prefetch:o="none",relative:s,reloadDocument:e,replace:m,state:v,target:w,to:N,preventScrollReset:S,viewTransition:D,unstable_defaultShouldRevalidate:L,...M},F){let{basename:O,unstable_useTransitions:P}=B.useContext(ri),G=typeof N=="string"&&Zb.test(N),ae=Hb(N,O);N=ae.to;let re=y4(N,{relative:s}),[ke,xe,je]=rw(o,M),Z=fw(N,{replace:m,state:v,target:w,preventScrollReset:S,relative:s,viewTransition:D,unstable_defaultShouldRevalidate:L,unstable_useTransitions:P});function ce(Re){n&&n(Re),Re.defaultPrevented||Z(Re)}let ue=B.createElement("a",{...M,...je,href:ae.absoluteURL||re,onClick:ae.isExternal||e?n:ce,ref:lw(F,xe),target:w,"data-discover":!G&&a==="render"?"true":void 0});return ke&&!G?B.createElement(B.Fragment,null,ue,B.createElement(aw,{page:re})):ue});ey.displayName="Link";var dw=B.forwardRef(function({"aria-current":n="page",caseSensitive:a=!1,className:o="",end:s=!1,style:e,to:m,viewTransition:v,children:w,...N},S){let D=hm(m,{relative:N.relative}),L=ql(),M=B.useContext(Cp),{navigator:F,basename:O}=B.useContext(ri),P=M!=null&&bw(D)&&v===!0,G=F.encodeLocation?F.encodeLocation(D).pathname:D.pathname,ae=L.pathname,re=M&&M.navigation&&M.navigation.location?M.navigation.location.pathname:null;a||(ae=ae.toLowerCase(),re=re?re.toLowerCase():null,G=G.toLowerCase()),re&&O&&(re=Oo(re,O)||re);const ke=G!=="/"&&G.endsWith("/")?G.length-1:G.length;let xe=ae===G||!s&&ae.startsWith(G)&&ae.charAt(ke)==="/",je=re!=null&&(re===G||!s&&re.startsWith(G)&&re.charAt(G.length)==="/"),Z={isActive:xe,isPending:je,isTransitioning:P},ce=xe?n:void 0,ue;typeof o=="function"?ue=o(Z):ue=[o,xe?"active":null,je?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let Re=typeof e=="function"?e(Z):e;return B.createElement(ey,{...N,"aria-current":ce,className:ue,ref:S,style:Re,to:m,viewTransition:v},typeof w=="function"?w(Z):w)});dw.displayName="NavLink";var uw=B.forwardRef(({discover:l="render",fetcherKey:n,navigate:a,reloadDocument:o,replace:s,state:e,method:m=ip,action:v,onSubmit:w,relative:N,preventScrollReset:S,viewTransition:D,unstable_defaultShouldRevalidate:L,...M},F)=>{let{unstable_useTransitions:O}=B.useContext(ri),P=pw(),G=xw(v,{relative:N}),ae=m.toLowerCase()==="get"?"get":"post",re=typeof v=="string"&&Zb.test(v),ke=xe=>{if(w&&w(xe),xe.defaultPrevented)return;xe.preventDefault();let je=xe.nativeEvent.submitter,Z=je?.getAttribute("formmethod")||m,ce=()=>P(je||xe.currentTarget,{fetcherKey:n,method:Z,navigate:a,replace:s,state:e,relative:N,preventScrollReset:S,viewTransition:D,unstable_defaultShouldRevalidate:L});O&&a!==!1?B.startTransition(()=>ce()):ce()};return B.createElement("form",{ref:F,method:ae,action:G,onSubmit:o?w:ke,...M,"data-discover":!re&&l==="render"?"true":void 0})});uw.displayName="Form";function hw(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ty(l){let n=B.useContext(eh);return Gr(n,hw(l)),n}function fw(l,{target:n,replace:a,state:o,preventScrollReset:s,relative:e,viewTransition:m,unstable_defaultShouldRevalidate:v,unstable_useTransitions:w}={}){let N=Tr(),S=ql(),D=hm(l,{relative:e});return B.useCallback(L=>{if(V4(L,n)){L.preventDefault();let M=a!==void 0?a:rm(S)===rm(D),F=()=>N(l,{replace:M,state:o,preventScrollReset:s,relative:e,viewTransition:m,unstable_defaultShouldRevalidate:v});w?B.startTransition(()=>F()):F()}},[S,N,D,a,o,n,l,s,e,m,v,w])}function l0(l){si(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let n=B.useRef(U1(l)),a=B.useRef(!1),o=ql(),s=B.useMemo(()=>W4(o.search,a.current?null:n.current),[o.search]),e=Tr(),m=B.useCallback((v,w)=>{const N=U1(typeof v=="function"?v(new URLSearchParams(s)):v);a.current=!0,e("?"+N,w)},[e,s]);return[s,m]}var mw=0,gw=()=>`__${String(++mw)}__`;function pw(){let{router:l}=ty("useSubmit"),{basename:n}=B.useContext(ri),a=F4(),o=l.fetch,s=l.navigate;return B.useCallback(async(e,m={})=>{let{action:v,method:w,encType:N,formData:S,body:D}=Y4(e,n);if(m.navigate===!1){let L=m.fetcherKey||gw();await o(L,a,m.action||v,{unstable_defaultShouldRevalidate:m.unstable_defaultShouldRevalidate,preventScrollReset:m.preventScrollReset,formData:S,body:D,formMethod:m.method||w,formEncType:m.encType||N,flushSync:m.flushSync})}else await s(m.action||v,{unstable_defaultShouldRevalidate:m.unstable_defaultShouldRevalidate,preventScrollReset:m.preventScrollReset,formData:S,body:D,formMethod:m.method||w,formEncType:m.encType||N,replace:m.replace,state:m.state,fromRouteId:a,flushSync:m.flushSync,viewTransition:m.viewTransition})},[o,s,n,a])}function xw(l,{relative:n}={}){let{basename:a}=B.useContext(ri),o=B.useContext(ki);Gr(o,"useFormAction must be used inside a RouteContext");let[s]=o.matches.slice(-1),e={...hm(l||".",{relative:n})},m=ql();if(l==null){e.search=m.search;let v=new URLSearchParams(e.search),w=v.getAll("index");if(w.some(S=>S==="")){v.delete("index"),w.filter(D=>D).forEach(D=>v.append("index",D));let S=v.toString();e.search=S?`?${S}`:""}}return(!l||l===".")&&s.route.index&&(e.search=e.search?e.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(e.pathname=e.pathname==="/"?a:Ro([a,e.pathname])),rm(e)}function bw(l,{relative:n}={}){let a=B.useContext(Wb);Gr(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=ty("useViewTransitionState"),s=hm(l,{relative:n});if(!a.isTransitioning)return!1;let e=Oo(a.currentLocation.pathname,o)||a.currentLocation.pathname,m=Oo(a.nextLocation.pathname,o)||a.nextLocation.pathname;return gp(s.pathname,m)!=null||gp(s.pathname,e)!=null}const f1=[{id:"analytical-dashboard",label:"Dashboard",path:"/projects/dashboard",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{id:"project-management",label:"Project Management",path:"/projects",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}];function yw({isOpen:l=!1,onClose:n}){const a=ql(),o=Tr(),s=[{id:"dashboard",label:"Dashboard",path:"/dashboard",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})},{id:"contacts",label:"Contacts",path:"/contacts",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})},{id:"import",label:"Import",path:"/import",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}],e={label:"Master Dashboard",path:"/master-dashboard",icon:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},m=F=>F==="/dashboard"||F==="/"?a.pathname==="/dashboard"||a.pathname==="/":F==="/master-dashboard"?a.pathname==="/master-dashboard":F==="/projects/dashboard"?a.pathname==="/projects/dashboard":F==="/projects"?a.pathname==="/projects"||a.pathname.startsWith("/projects/")&&a.pathname!=="/projects/dashboard"&&!a.pathname.startsWith("/projects/dashboard/"):a.pathname.startsWith(F),v=s.some(F=>m(F.path)),[w,N]=B.useState(v),S=f1.some(F=>m(F.path)),[D,L]=B.useState(S);B.useEffect(()=>{s.some(O=>m(O.path))&&N(!0)},[a.pathname]),B.useEffect(()=>{f1.some(O=>m(O.path))&&L(!0)},[a.pathname]);const M=F=>{o(F),n&&n()};return t.jsxs("div",{className:`
      w-64 bg-white border-r border-gray-200 h-screen flex flex-col fixed left-0 top-0 z-50
      transform transition-transform duration-300 ease-in-out
      lg:translate-x-0
      ${l?"translate-x-0":"-translate-x-full"}
    `,children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded flex items-center justify-center flex-shrink-0",children:t.jsx("div",{className:"w-5 h-5 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-2.5 h-2.5 bg-blue-600 rounded-full"})})}),t.jsx("span",{className:"text-base font-semibold text-gray-900",children:"Outbound SaaS"})]}),t.jsx("button",{onClick:n,className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-600 hover:bg-gray-100","aria-label":"Close menu",children:t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("nav",{className:"flex-1 px-4 py-4 overflow-y-auto",children:t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>N(!w),className:"w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),t.jsx("span",{className:"text-sm font-medium",children:"Databank"})]}),t.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${w?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),w&&t.jsx("div",{className:"ml-4 mt-1 space-y-1 border-l-2 border-gray-200 pl-2",children:s.map(F=>{const O=m(F.path);return t.jsxs("button",{onClick:()=>M(F.path==="/dashboard"?"/":F.path),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${O?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:O?"text-blue-600":"text-gray-500",children:F.icon}),t.jsx("span",{className:`text-sm font-medium ${O?"text-blue-600":"text-gray-700"}`,children:F.label})]},F.id)})})]}),t.jsxs("div",{className:"mt-2",children:[t.jsxs("button",{onClick:()=>L(!D),className:"w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),t.jsx("span",{className:"text-sm font-medium",children:"Projects"})]}),t.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${D?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),D&&t.jsx("div",{className:"ml-4 mt-1 space-y-1 border-l-2 border-gray-200 pl-2",children:f1.map(F=>{const O=m(F.path);return t.jsxs("button",{onClick:()=>M(F.path),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${O?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:O?"text-blue-600":"text-gray-500",children:F.icon}),t.jsx("span",{className:`text-sm font-medium ${O?"text-blue-600":"text-gray-700"}`,children:F.label})]},F.id)})})]}),t.jsx("div",{className:"mt-2",children:t.jsxs("button",{onClick:()=>M(e.path),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${m(e.path)?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:m(e.path)?"text-blue-600":"text-gray-500",children:e.icon}),t.jsx("span",{className:`text-sm font-medium ${m(e.path)?"text-blue-600":"text-gray-700"}`,children:e.label})]})}),t.jsx("div",{className:"mt-2",children:t.jsxs("button",{onClick:()=>M("/employee-performance"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${m("/employee-performance")?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[t.jsx("span",{className:m("/employee-performance")?"text-blue-600":"text-gray-500",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),t.jsx("span",{className:`text-sm font-medium ${m("/employee-performance")?"text-blue-600":"text-gray-700"}`,children:"Employee Performance"})]})})]})}),t.jsxs("div",{className:"px-4 py-4 border-t border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-sm font-semibold text-blue-700",children:(()=>{const F=JSON.parse(localStorage.getItem("user")||"{}");return F.name?F.name.charAt(0).toUpperCase():"U"})()})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:(()=>{const F=JSON.parse(localStorage.getItem("user")||"{}");return F.name||F.email||"User"})()}),t.jsx("p",{className:"text-xs text-gray-500 truncate",children:JSON.parse(localStorage.getItem("user")||"{}").email||""})]})]}),t.jsxs("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),o("/login")},className:"w-full flex items-center gap-2 px-3 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})]})}function vw(){const l=localStorage.getItem("token"),[n,a]=B.useState(!1);return l?t.jsxs("div",{className:"flex h-screen bg-gray-50",children:[n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:()=>a(!1)}),t.jsx(yw,{isOpen:n,onClose:()=>a(!1)}),t.jsxs("main",{className:"flex-1 lg:ml-64 overflow-y-auto",children:[t.jsxs("div",{className:"lg:hidden sticky top-0 z-30 bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>a(!n),className:"p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500","aria-label":"Toggle menu",children:t.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded flex items-center justify-center flex-shrink-0",children:t.jsx("div",{className:"w-5 h-5 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-2.5 h-2.5 bg-blue-600 rounded-full"})})}),t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Outbound SaaS"})]})]}),t.jsx(O4,{context:{setSidebarOpen:a}})]})]}):t.jsx(pp,{to:"/login",replace:!0})}function sy(l,n){return function(){return l.apply(n,arguments)}}const{toString:ww}=Object.prototype,{getPrototypeOf:ox}=Object,{iterator:Ap,toStringTag:ry}=Symbol,Ep=(l=>n=>{const a=ww.call(n);return l[a]||(l[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),al=l=>(l=l.toLowerCase(),n=>Ep(n)===l),Dp=l=>n=>typeof n===l,{isArray:sh}=Array,Ku=Dp("undefined");function fm(l){return l!==null&&!Ku(l)&&l.constructor!==null&&!Ku(l.constructor)&&In(l.constructor.isBuffer)&&l.constructor.isBuffer(l)}const ay=al("ArrayBuffer");function jw(l){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(l):n=l&&l.buffer&&ay(l.buffer),n}const Nw=Dp("string"),In=Dp("function"),ny=Dp("number"),mm=l=>l!==null&&typeof l=="object",kw=l=>l===!0||l===!1,op=l=>{if(Ep(l)!=="object")return!1;const n=ox(l);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(ry in l)&&!(Ap in l)},Cw=l=>{if(!mm(l)||fm(l))return!1;try{return Object.keys(l).length===0&&Object.getPrototypeOf(l)===Object.prototype}catch{return!1}},Sw=al("Date"),Aw=al("File"),Ew=al("Blob"),Dw=al("FileList"),Tw=l=>mm(l)&&In(l.pipe),_w=l=>{let n;return l&&(typeof FormData=="function"&&l instanceof FormData||In(l.append)&&((n=Ep(l))==="formdata"||n==="object"&&In(l.toString)&&l.toString()==="[object FormData]"))},Fw=al("URLSearchParams"),[Mw,Lw,Rw,Ow]=["ReadableStream","Request","Response","Headers"].map(al),Pw=l=>l.trim?l.trim():l.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function gm(l,n,{allOwnKeys:a=!1}={}){if(l===null||typeof l>"u")return;let o,s;if(typeof l!="object"&&(l=[l]),sh(l))for(o=0,s=l.length;o<s;o++)n.call(null,l[o],o,l);else{if(fm(l))return;const e=a?Object.getOwnPropertyNames(l):Object.keys(l),m=e.length;let v;for(o=0;o<m;o++)v=e[o],n.call(null,l[v],v,l)}}function iy(l,n){if(fm(l))return null;n=n.toLowerCase();const a=Object.keys(l);let o=a.length,s;for(;o-- >0;)if(s=a[o],n===s.toLowerCase())return s;return null}const Zd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ly=l=>!Ku(l)&&l!==Zd;function H1(){const{caseless:l,skipUndefined:n}=ly(this)&&this||{},a={},o=(s,e)=>{const m=l&&iy(a,e)||e;op(a[m])&&op(s)?a[m]=H1(a[m],s):op(s)?a[m]=H1({},s):sh(s)?a[m]=s.slice():(!n||!Ku(s))&&(a[m]=s)};for(let s=0,e=arguments.length;s<e;s++)arguments[s]&&gm(arguments[s],o);return a}const Iw=(l,n,a,{allOwnKeys:o}={})=>(gm(n,(s,e)=>{a&&In(s)?l[e]=sy(s,a):l[e]=s},{allOwnKeys:o}),l),Bw=l=>(l.charCodeAt(0)===65279&&(l=l.slice(1)),l),zw=(l,n,a,o)=>{l.prototype=Object.create(n.prototype,o),l.prototype.constructor=l,Object.defineProperty(l,"super",{value:n.prototype}),a&&Object.assign(l.prototype,a)},Uw=(l,n,a,o)=>{let s,e,m;const v={};if(n=n||{},l==null)return n;do{for(s=Object.getOwnPropertyNames(l),e=s.length;e-- >0;)m=s[e],(!o||o(m,l,n))&&!v[m]&&(n[m]=l[m],v[m]=!0);l=a!==!1&&ox(l)}while(l&&(!a||a(l,n))&&l!==Object.prototype);return n},Hw=(l,n,a)=>{l=String(l),(a===void 0||a>l.length)&&(a=l.length),a-=n.length;const o=l.indexOf(n,a);return o!==-1&&o===a},Vw=l=>{if(!l)return null;if(sh(l))return l;let n=l.length;if(!ny(n))return null;const a=new Array(n);for(;n-- >0;)a[n]=l[n];return a},Ww=(l=>n=>l&&n instanceof l)(typeof Uint8Array<"u"&&ox(Uint8Array)),$w=(l,n)=>{const o=(l&&l[Ap]).call(l);let s;for(;(s=o.next())&&!s.done;){const e=s.value;n.call(l,e[0],e[1])}},qw=(l,n)=>{let a;const o=[];for(;(a=l.exec(n))!==null;)o.push(a);return o},Yw=al("HTMLFormElement"),Gw=l=>l.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,o,s){return o.toUpperCase()+s}),Hx=(({hasOwnProperty:l})=>(n,a)=>l.call(n,a))(Object.prototype),Kw=al("RegExp"),oy=(l,n)=>{const a=Object.getOwnPropertyDescriptors(l),o={};gm(a,(s,e)=>{let m;(m=n(s,e,l))!==!1&&(o[e]=m||s)}),Object.defineProperties(l,o)},Qw=l=>{oy(l,(n,a)=>{if(In(l)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const o=l[a];if(In(o)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},Xw=(l,n)=>{const a={},o=s=>{s.forEach(e=>{a[e]=!0})};return sh(l)?o(l):o(String(l).split(n)),a},Jw=()=>{},Zw=(l,n)=>l!=null&&Number.isFinite(l=+l)?l:n;function e5(l){return!!(l&&In(l.append)&&l[ry]==="FormData"&&l[Ap])}const t5=l=>{const n=new Array(10),a=(o,s)=>{if(mm(o)){if(n.indexOf(o)>=0)return;if(fm(o))return o;if(!("toJSON"in o)){n[s]=o;const e=sh(o)?[]:{};return gm(o,(m,v)=>{const w=a(m,s+1);!Ku(w)&&(e[v]=w)}),n[s]=void 0,e}}return o};return a(l,0)},s5=al("AsyncFunction"),r5=l=>l&&(mm(l)||In(l))&&In(l.then)&&In(l.catch),cy=((l,n)=>l?setImmediate:n?((a,o)=>(Zd.addEventListener("message",({source:s,data:e})=>{s===Zd&&e===a&&o.length&&o.shift()()},!1),s=>{o.push(s),Zd.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",In(Zd.postMessage)),a5=typeof queueMicrotask<"u"?queueMicrotask.bind(Zd):typeof process<"u"&&process.nextTick||cy,n5=l=>l!=null&&In(l[Ap]),dt={isArray:sh,isArrayBuffer:ay,isBuffer:fm,isFormData:_w,isArrayBufferView:jw,isString:Nw,isNumber:ny,isBoolean:kw,isObject:mm,isPlainObject:op,isEmptyObject:Cw,isReadableStream:Mw,isRequest:Lw,isResponse:Rw,isHeaders:Ow,isUndefined:Ku,isDate:Sw,isFile:Aw,isBlob:Ew,isRegExp:Kw,isFunction:In,isStream:Tw,isURLSearchParams:Fw,isTypedArray:Ww,isFileList:Dw,forEach:gm,merge:H1,extend:Iw,trim:Pw,stripBOM:Bw,inherits:zw,toFlatObject:Uw,kindOf:Ep,kindOfTest:al,endsWith:Hw,toArray:Vw,forEachEntry:$w,matchAll:qw,isHTMLForm:Yw,hasOwnProperty:Hx,hasOwnProp:Hx,reduceDescriptors:oy,freezeMethods:Qw,toObjectSet:Xw,toCamelCase:Gw,noop:Jw,toFiniteNumber:Zw,findKey:iy,global:Zd,isContextDefined:ly,isSpecCompliantForm:e5,toJSONObject:t5,isAsyncFn:s5,isThenable:r5,setImmediate:cy,asap:a5,isIterable:n5};function Ls(l,n,a,o,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=l,this.name="AxiosError",n&&(this.code=n),a&&(this.config=a),o&&(this.request=o),s&&(this.response=s,this.status=s.status?s.status:null)}dt.inherits(Ls,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:dt.toJSONObject(this.config),code:this.code,status:this.status}}});const dy=Ls.prototype,uy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(l=>{uy[l]={value:l}});Object.defineProperties(Ls,uy);Object.defineProperty(dy,"isAxiosError",{value:!0});Ls.from=(l,n,a,o,s,e)=>{const m=Object.create(dy);dt.toFlatObject(l,m,function(S){return S!==Error.prototype},N=>N!=="isAxiosError");const v=l&&l.message?l.message:"Error",w=n==null&&l?l.code:n;return Ls.call(m,v,w,a,o,s),l&&m.cause==null&&Object.defineProperty(m,"cause",{value:l,configurable:!0}),m.name=l&&l.name||"Error",e&&Object.assign(m,e),m};const i5=null;function V1(l){return dt.isPlainObject(l)||dt.isArray(l)}function hy(l){return dt.endsWith(l,"[]")?l.slice(0,-2):l}function Vx(l,n,a){return l?l.concat(n).map(function(s,e){return s=hy(s),!a&&e?"["+s+"]":s}).join(a?".":""):n}function l5(l){return dt.isArray(l)&&!l.some(V1)}const o5=dt.toFlatObject(dt,{},null,function(n){return/^is[A-Z]/.test(n)});function Tp(l,n,a){if(!dt.isObject(l))throw new TypeError("target must be an object");n=n||new FormData,a=dt.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(O,P){return!dt.isUndefined(P[O])});const o=a.metaTokens,s=a.visitor||S,e=a.dots,m=a.indexes,w=(a.Blob||typeof Blob<"u"&&Blob)&&dt.isSpecCompliantForm(n);if(!dt.isFunction(s))throw new TypeError("visitor must be a function");function N(F){if(F===null)return"";if(dt.isDate(F))return F.toISOString();if(dt.isBoolean(F))return F.toString();if(!w&&dt.isBlob(F))throw new Ls("Blob is not supported. Use a Buffer instead.");return dt.isArrayBuffer(F)||dt.isTypedArray(F)?w&&typeof Blob=="function"?new Blob([F]):Buffer.from(F):F}function S(F,O,P){let G=F;if(F&&!P&&typeof F=="object"){if(dt.endsWith(O,"{}"))O=o?O:O.slice(0,-2),F=JSON.stringify(F);else if(dt.isArray(F)&&l5(F)||(dt.isFileList(F)||dt.endsWith(O,"[]"))&&(G=dt.toArray(F)))return O=hy(O),G.forEach(function(re,ke){!(dt.isUndefined(re)||re===null)&&n.append(m===!0?Vx([O],ke,e):m===null?O:O+"[]",N(re))}),!1}return V1(F)?!0:(n.append(Vx(P,O,e),N(F)),!1)}const D=[],L=Object.assign(o5,{defaultVisitor:S,convertValue:N,isVisitable:V1});function M(F,O){if(!dt.isUndefined(F)){if(D.indexOf(F)!==-1)throw Error("Circular reference detected in "+O.join("."));D.push(F),dt.forEach(F,function(G,ae){(!(dt.isUndefined(G)||G===null)&&s.call(n,G,dt.isString(ae)?ae.trim():ae,O,L))===!0&&M(G,O?O.concat(ae):[ae])}),D.pop()}}if(!dt.isObject(l))throw new TypeError("data must be an object");return M(l),n}function Wx(l){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(l).replace(/[!'()~]|%20|%00/g,function(o){return n[o]})}function cx(l,n){this._pairs=[],l&&Tp(l,this,n)}const fy=cx.prototype;fy.append=function(n,a){this._pairs.push([n,a])};fy.toString=function(n){const a=n?function(o){return n.call(this,o,Wx)}:Wx;return this._pairs.map(function(s){return a(s[0])+"="+a(s[1])},"").join("&")};function c5(l){return encodeURIComponent(l).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function my(l,n,a){if(!n)return l;const o=a&&a.encode||c5;dt.isFunction(a)&&(a={serialize:a});const s=a&&a.serialize;let e;if(s?e=s(n,a):e=dt.isURLSearchParams(n)?n.toString():new cx(n,a).toString(o),e){const m=l.indexOf("#");m!==-1&&(l=l.slice(0,m)),l+=(l.indexOf("?")===-1?"?":"&")+e}return l}class $x{constructor(){this.handlers=[]}use(n,a,o){return this.handlers.push({fulfilled:n,rejected:a,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){dt.forEach(this.handlers,function(o){o!==null&&n(o)})}}const gy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},d5=typeof URLSearchParams<"u"?URLSearchParams:cx,u5=typeof FormData<"u"?FormData:null,h5=typeof Blob<"u"?Blob:null,f5={isBrowser:!0,classes:{URLSearchParams:d5,FormData:u5,Blob:h5},protocols:["http","https","file","blob","url","data"]},dx=typeof window<"u"&&typeof document<"u",W1=typeof navigator=="object"&&navigator||void 0,m5=dx&&(!W1||["ReactNative","NativeScript","NS"].indexOf(W1.product)<0),g5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",p5=dx&&window.location.href||"http://localhost",x5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:dx,hasStandardBrowserEnv:m5,hasStandardBrowserWebWorkerEnv:g5,navigator:W1,origin:p5},Symbol.toStringTag,{value:"Module"})),tn={...x5,...f5};function b5(l,n){return Tp(l,new tn.classes.URLSearchParams,{visitor:function(a,o,s,e){return tn.isNode&&dt.isBuffer(a)?(this.append(o,a.toString("base64")),!1):e.defaultVisitor.apply(this,arguments)},...n})}function y5(l){return dt.matchAll(/\w+|\[(\w*)]/g,l).map(n=>n[0]==="[]"?"":n[1]||n[0])}function v5(l){const n={},a=Object.keys(l);let o;const s=a.length;let e;for(o=0;o<s;o++)e=a[o],n[e]=l[e];return n}function py(l){function n(a,o,s,e){let m=a[e++];if(m==="__proto__")return!0;const v=Number.isFinite(+m),w=e>=a.length;return m=!m&&dt.isArray(s)?s.length:m,w?(dt.hasOwnProp(s,m)?s[m]=[s[m],o]:s[m]=o,!v):((!s[m]||!dt.isObject(s[m]))&&(s[m]=[]),n(a,o,s[m],e)&&dt.isArray(s[m])&&(s[m]=v5(s[m])),!v)}if(dt.isFormData(l)&&dt.isFunction(l.entries)){const a={};return dt.forEachEntry(l,(o,s)=>{n(y5(o),s,a,0)}),a}return null}function w5(l,n,a){if(dt.isString(l))try{return(n||JSON.parse)(l),dt.trim(l)}catch(o){if(o.name!=="SyntaxError")throw o}return(a||JSON.stringify)(l)}const pm={transitional:gy,adapter:["xhr","http","fetch"],transformRequest:[function(n,a){const o=a.getContentType()||"",s=o.indexOf("application/json")>-1,e=dt.isObject(n);if(e&&dt.isHTMLForm(n)&&(n=new FormData(n)),dt.isFormData(n))return s?JSON.stringify(py(n)):n;if(dt.isArrayBuffer(n)||dt.isBuffer(n)||dt.isStream(n)||dt.isFile(n)||dt.isBlob(n)||dt.isReadableStream(n))return n;if(dt.isArrayBufferView(n))return n.buffer;if(dt.isURLSearchParams(n))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let v;if(e){if(o.indexOf("application/x-www-form-urlencoded")>-1)return b5(n,this.formSerializer).toString();if((v=dt.isFileList(n))||o.indexOf("multipart/form-data")>-1){const w=this.env&&this.env.FormData;return Tp(v?{"files[]":n}:n,w&&new w,this.formSerializer)}}return e||s?(a.setContentType("application/json",!1),w5(n)):n}],transformResponse:[function(n){const a=this.transitional||pm.transitional,o=a&&a.forcedJSONParsing,s=this.responseType==="json";if(dt.isResponse(n)||dt.isReadableStream(n))return n;if(n&&dt.isString(n)&&(o&&!this.responseType||s)){const m=!(a&&a.silentJSONParsing)&&s;try{return JSON.parse(n,this.parseReviver)}catch(v){if(m)throw v.name==="SyntaxError"?Ls.from(v,Ls.ERR_BAD_RESPONSE,this,null,this.response):v}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tn.classes.FormData,Blob:tn.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};dt.forEach(["delete","get","head","post","put","patch"],l=>{pm.headers[l]={}});const j5=dt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),N5=l=>{const n={};let a,o,s;return l&&l.split(`
`).forEach(function(m){s=m.indexOf(":"),a=m.substring(0,s).trim().toLowerCase(),o=m.substring(s+1).trim(),!(!a||n[a]&&j5[a])&&(a==="set-cookie"?n[a]?n[a].push(o):n[a]=[o]:n[a]=n[a]?n[a]+", "+o:o)}),n},qx=Symbol("internals");function Hf(l){return l&&String(l).trim().toLowerCase()}function cp(l){return l===!1||l==null?l:dt.isArray(l)?l.map(cp):String(l)}function k5(l){const n=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=a.exec(l);)n[o[1]]=o[2];return n}const C5=l=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(l.trim());function m1(l,n,a,o,s){if(dt.isFunction(o))return o.call(this,n,a);if(s&&(n=a),!!dt.isString(n)){if(dt.isString(o))return n.indexOf(o)!==-1;if(dt.isRegExp(o))return o.test(n)}}function S5(l){return l.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,a,o)=>a.toUpperCase()+o)}function A5(l,n){const a=dt.toCamelCase(" "+n);["get","set","has"].forEach(o=>{Object.defineProperty(l,o+a,{value:function(s,e,m){return this[o].call(this,n,s,e,m)},configurable:!0})})}let Bn=class{constructor(n){n&&this.set(n)}set(n,a,o){const s=this;function e(v,w,N){const S=Hf(w);if(!S)throw new Error("header name must be a non-empty string");const D=dt.findKey(s,S);(!D||s[D]===void 0||N===!0||N===void 0&&s[D]!==!1)&&(s[D||w]=cp(v))}const m=(v,w)=>dt.forEach(v,(N,S)=>e(N,S,w));if(dt.isPlainObject(n)||n instanceof this.constructor)m(n,a);else if(dt.isString(n)&&(n=n.trim())&&!C5(n))m(N5(n),a);else if(dt.isObject(n)&&dt.isIterable(n)){let v={},w,N;for(const S of n){if(!dt.isArray(S))throw TypeError("Object iterator must return a key-value pair");v[N=S[0]]=(w=v[N])?dt.isArray(w)?[...w,S[1]]:[w,S[1]]:S[1]}m(v,a)}else n!=null&&e(a,n,o);return this}get(n,a){if(n=Hf(n),n){const o=dt.findKey(this,n);if(o){const s=this[o];if(!a)return s;if(a===!0)return k5(s);if(dt.isFunction(a))return a.call(this,s,o);if(dt.isRegExp(a))return a.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,a){if(n=Hf(n),n){const o=dt.findKey(this,n);return!!(o&&this[o]!==void 0&&(!a||m1(this,this[o],o,a)))}return!1}delete(n,a){const o=this;let s=!1;function e(m){if(m=Hf(m),m){const v=dt.findKey(o,m);v&&(!a||m1(o,o[v],v,a))&&(delete o[v],s=!0)}}return dt.isArray(n)?n.forEach(e):e(n),s}clear(n){const a=Object.keys(this);let o=a.length,s=!1;for(;o--;){const e=a[o];(!n||m1(this,this[e],e,n,!0))&&(delete this[e],s=!0)}return s}normalize(n){const a=this,o={};return dt.forEach(this,(s,e)=>{const m=dt.findKey(o,e);if(m){a[m]=cp(s),delete a[e];return}const v=n?S5(e):String(e).trim();v!==e&&delete a[e],a[v]=cp(s),o[v]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const a=Object.create(null);return dt.forEach(this,(o,s)=>{o!=null&&o!==!1&&(a[s]=n&&dt.isArray(o)?o.join(", "):o)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,a])=>n+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...a){const o=new this(n);return a.forEach(s=>o.set(s)),o}static accessor(n){const o=(this[qx]=this[qx]={accessors:{}}).accessors,s=this.prototype;function e(m){const v=Hf(m);o[v]||(A5(s,m),o[v]=!0)}return dt.isArray(n)?n.forEach(e):e(n),this}};Bn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);dt.reduceDescriptors(Bn.prototype,({value:l},n)=>{let a=n[0].toUpperCase()+n.slice(1);return{get:()=>l,set(o){this[a]=o}}});dt.freezeMethods(Bn);function g1(l,n){const a=this||pm,o=n||a,s=Bn.from(o.headers);let e=o.data;return dt.forEach(l,function(v){e=v.call(a,e,s.normalize(),n?n.status:void 0)}),s.normalize(),e}function xy(l){return!!(l&&l.__CANCEL__)}function rh(l,n,a){Ls.call(this,l??"canceled",Ls.ERR_CANCELED,n,a),this.name="CanceledError"}dt.inherits(rh,Ls,{__CANCEL__:!0});function by(l,n,a){const o=a.config.validateStatus;!a.status||!o||o(a.status)?l(a):n(new Ls("Request failed with status code "+a.status,[Ls.ERR_BAD_REQUEST,Ls.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function E5(l){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(l);return n&&n[1]||""}function D5(l,n){l=l||10;const a=new Array(l),o=new Array(l);let s=0,e=0,m;return n=n!==void 0?n:1e3,function(w){const N=Date.now(),S=o[e];m||(m=N),a[s]=w,o[s]=N;let D=e,L=0;for(;D!==s;)L+=a[D++],D=D%l;if(s=(s+1)%l,s===e&&(e=(e+1)%l),N-m<n)return;const M=S&&N-S;return M?Math.round(L*1e3/M):void 0}}function T5(l,n){let a=0,o=1e3/n,s,e;const m=(N,S=Date.now())=>{a=S,s=null,e&&(clearTimeout(e),e=null),l(...N)};return[(...N)=>{const S=Date.now(),D=S-a;D>=o?m(N,S):(s=N,e||(e=setTimeout(()=>{e=null,m(s)},o-D)))},()=>s&&m(s)]}const xp=(l,n,a=3)=>{let o=0;const s=D5(50,250);return T5(e=>{const m=e.loaded,v=e.lengthComputable?e.total:void 0,w=m-o,N=s(w),S=m<=v;o=m;const D={loaded:m,total:v,progress:v?m/v:void 0,bytes:w,rate:N||void 0,estimated:N&&v&&S?(v-m)/N:void 0,event:e,lengthComputable:v!=null,[n?"download":"upload"]:!0};l(D)},a)},Yx=(l,n)=>{const a=l!=null;return[o=>n[0]({lengthComputable:a,total:l,loaded:o}),n[1]]},Gx=l=>(...n)=>dt.asap(()=>l(...n)),_5=tn.hasStandardBrowserEnv?((l,n)=>a=>(a=new URL(a,tn.origin),l.protocol===a.protocol&&l.host===a.host&&(n||l.port===a.port)))(new URL(tn.origin),tn.navigator&&/(msie|trident)/i.test(tn.navigator.userAgent)):()=>!0,F5=tn.hasStandardBrowserEnv?{write(l,n,a,o,s,e,m){if(typeof document>"u")return;const v=[`${l}=${encodeURIComponent(n)}`];dt.isNumber(a)&&v.push(`expires=${new Date(a).toUTCString()}`),dt.isString(o)&&v.push(`path=${o}`),dt.isString(s)&&v.push(`domain=${s}`),e===!0&&v.push("secure"),dt.isString(m)&&v.push(`SameSite=${m}`),document.cookie=v.join("; ")},read(l){if(typeof document>"u")return null;const n=document.cookie.match(new RegExp("(?:^|; )"+l+"=([^;]*)"));return n?decodeURIComponent(n[1]):null},remove(l){this.write(l,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function M5(l){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(l)}function L5(l,n){return n?l.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):l}function yy(l,n,a){let o=!M5(n);return l&&(o||a==!1)?L5(l,n):n}const Kx=l=>l instanceof Bn?{...l}:l;function r0(l,n){n=n||{};const a={};function o(N,S,D,L){return dt.isPlainObject(N)&&dt.isPlainObject(S)?dt.merge.call({caseless:L},N,S):dt.isPlainObject(S)?dt.merge({},S):dt.isArray(S)?S.slice():S}function s(N,S,D,L){if(dt.isUndefined(S)){if(!dt.isUndefined(N))return o(void 0,N,D,L)}else return o(N,S,D,L)}function e(N,S){if(!dt.isUndefined(S))return o(void 0,S)}function m(N,S){if(dt.isUndefined(S)){if(!dt.isUndefined(N))return o(void 0,N)}else return o(void 0,S)}function v(N,S,D){if(D in n)return o(N,S);if(D in l)return o(void 0,N)}const w={url:e,method:e,data:e,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:v,headers:(N,S,D)=>s(Kx(N),Kx(S),D,!0)};return dt.forEach(Object.keys({...l,...n}),function(S){const D=w[S]||s,L=D(l[S],n[S],S);dt.isUndefined(L)&&D!==v||(a[S]=L)}),a}const vy=l=>{const n=r0({},l);let{data:a,withXSRFToken:o,xsrfHeaderName:s,xsrfCookieName:e,headers:m,auth:v}=n;if(n.headers=m=Bn.from(m),n.url=my(yy(n.baseURL,n.url,n.allowAbsoluteUrls),l.params,l.paramsSerializer),v&&m.set("Authorization","Basic "+btoa((v.username||"")+":"+(v.password?unescape(encodeURIComponent(v.password)):""))),dt.isFormData(a)){if(tn.hasStandardBrowserEnv||tn.hasStandardBrowserWebWorkerEnv)m.setContentType(void 0);else if(dt.isFunction(a.getHeaders)){const w=a.getHeaders(),N=["content-type","content-length"];Object.entries(w).forEach(([S,D])=>{N.includes(S.toLowerCase())&&m.set(S,D)})}}if(tn.hasStandardBrowserEnv&&(o&&dt.isFunction(o)&&(o=o(n)),o||o!==!1&&_5(n.url))){const w=s&&e&&F5.read(e);w&&m.set(s,w)}return n},R5=typeof XMLHttpRequest<"u",O5=R5&&function(l){return new Promise(function(a,o){const s=vy(l);let e=s.data;const m=Bn.from(s.headers).normalize();let{responseType:v,onUploadProgress:w,onDownloadProgress:N}=s,S,D,L,M,F;function O(){M&&M(),F&&F(),s.cancelToken&&s.cancelToken.unsubscribe(S),s.signal&&s.signal.removeEventListener("abort",S)}let P=new XMLHttpRequest;P.open(s.method.toUpperCase(),s.url,!0),P.timeout=s.timeout;function G(){if(!P)return;const re=Bn.from("getAllResponseHeaders"in P&&P.getAllResponseHeaders()),xe={data:!v||v==="text"||v==="json"?P.responseText:P.response,status:P.status,statusText:P.statusText,headers:re,config:l,request:P};by(function(Z){a(Z),O()},function(Z){o(Z),O()},xe),P=null}"onloadend"in P?P.onloadend=G:P.onreadystatechange=function(){!P||P.readyState!==4||P.status===0&&!(P.responseURL&&P.responseURL.indexOf("file:")===0)||setTimeout(G)},P.onabort=function(){P&&(o(new Ls("Request aborted",Ls.ECONNABORTED,l,P)),P=null)},P.onerror=function(ke){const xe=ke&&ke.message?ke.message:"Network Error",je=new Ls(xe,Ls.ERR_NETWORK,l,P);je.event=ke||null,o(je),P=null},P.ontimeout=function(){let ke=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const xe=s.transitional||gy;s.timeoutErrorMessage&&(ke=s.timeoutErrorMessage),o(new Ls(ke,xe.clarifyTimeoutError?Ls.ETIMEDOUT:Ls.ECONNABORTED,l,P)),P=null},e===void 0&&m.setContentType(null),"setRequestHeader"in P&&dt.forEach(m.toJSON(),function(ke,xe){P.setRequestHeader(xe,ke)}),dt.isUndefined(s.withCredentials)||(P.withCredentials=!!s.withCredentials),v&&v!=="json"&&(P.responseType=s.responseType),N&&([L,F]=xp(N,!0),P.addEventListener("progress",L)),w&&P.upload&&([D,M]=xp(w),P.upload.addEventListener("progress",D),P.upload.addEventListener("loadend",M)),(s.cancelToken||s.signal)&&(S=re=>{P&&(o(!re||re.type?new rh(null,l,P):re),P.abort(),P=null)},s.cancelToken&&s.cancelToken.subscribe(S),s.signal&&(s.signal.aborted?S():s.signal.addEventListener("abort",S)));const ae=E5(s.url);if(ae&&tn.protocols.indexOf(ae)===-1){o(new Ls("Unsupported protocol "+ae+":",Ls.ERR_BAD_REQUEST,l));return}P.send(e||null)})},P5=(l,n)=>{const{length:a}=l=l?l.filter(Boolean):[];if(n||a){let o=new AbortController,s;const e=function(N){if(!s){s=!0,v();const S=N instanceof Error?N:this.reason;o.abort(S instanceof Ls?S:new rh(S instanceof Error?S.message:S))}};let m=n&&setTimeout(()=>{m=null,e(new Ls(`timeout ${n} of ms exceeded`,Ls.ETIMEDOUT))},n);const v=()=>{l&&(m&&clearTimeout(m),m=null,l.forEach(N=>{N.unsubscribe?N.unsubscribe(e):N.removeEventListener("abort",e)}),l=null)};l.forEach(N=>N.addEventListener("abort",e));const{signal:w}=o;return w.unsubscribe=()=>dt.asap(v),w}},I5=function*(l,n){let a=l.byteLength;if(a<n){yield l;return}let o=0,s;for(;o<a;)s=o+n,yield l.slice(o,s),o=s},B5=async function*(l,n){for await(const a of z5(l))yield*I5(a,n)},z5=async function*(l){if(l[Symbol.asyncIterator]){yield*l;return}const n=l.getReader();try{for(;;){const{done:a,value:o}=await n.read();if(a)break;yield o}}finally{await n.cancel()}},Qx=(l,n,a,o)=>{const s=B5(l,n);let e=0,m,v=w=>{m||(m=!0,o&&o(w))};return new ReadableStream({async pull(w){try{const{done:N,value:S}=await s.next();if(N){v(),w.close();return}let D=S.byteLength;if(a){let L=e+=D;a(L)}w.enqueue(new Uint8Array(S))}catch(N){throw v(N),N}},cancel(w){return v(w),s.return()}},{highWaterMark:2})},Xx=64*1024,{isFunction:Hg}=dt,U5=(({Request:l,Response:n})=>({Request:l,Response:n}))(dt.global),{ReadableStream:Jx,TextEncoder:Zx}=dt.global,e2=(l,...n)=>{try{return!!l(...n)}catch{return!1}},H5=l=>{l=dt.merge.call({skipUndefined:!0},U5,l);const{fetch:n,Request:a,Response:o}=l,s=n?Hg(n):typeof fetch=="function",e=Hg(a),m=Hg(o);if(!s)return!1;const v=s&&Hg(Jx),w=s&&(typeof Zx=="function"?(F=>O=>F.encode(O))(new Zx):async F=>new Uint8Array(await new a(F).arrayBuffer())),N=e&&v&&e2(()=>{let F=!1;const O=new a(tn.origin,{body:new Jx,method:"POST",get duplex(){return F=!0,"half"}}).headers.has("Content-Type");return F&&!O}),S=m&&v&&e2(()=>dt.isReadableStream(new o("").body)),D={stream:S&&(F=>F.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(F=>{!D[F]&&(D[F]=(O,P)=>{let G=O&&O[F];if(G)return G.call(O);throw new Ls(`Response type '${F}' is not supported`,Ls.ERR_NOT_SUPPORT,P)})});const L=async F=>{if(F==null)return 0;if(dt.isBlob(F))return F.size;if(dt.isSpecCompliantForm(F))return(await new a(tn.origin,{method:"POST",body:F}).arrayBuffer()).byteLength;if(dt.isArrayBufferView(F)||dt.isArrayBuffer(F))return F.byteLength;if(dt.isURLSearchParams(F)&&(F=F+""),dt.isString(F))return(await w(F)).byteLength},M=async(F,O)=>{const P=dt.toFiniteNumber(F.getContentLength());return P??L(O)};return async F=>{let{url:O,method:P,data:G,signal:ae,cancelToken:re,timeout:ke,onDownloadProgress:xe,onUploadProgress:je,responseType:Z,headers:ce,withCredentials:ue="same-origin",fetchOptions:Re}=vy(F),be=n||fetch;Z=Z?(Z+"").toLowerCase():"text";let oe=P5([ae,re&&re.toAbortSignal()],ke),he=null;const ye=oe&&oe.unsubscribe&&(()=>{oe.unsubscribe()});let Te;try{if(je&&N&&P!=="get"&&P!=="head"&&(Te=await M(ce,G))!==0){let W=new a(O,{method:"POST",body:G,duplex:"half"}),pe;if(dt.isFormData(G)&&(pe=W.headers.get("content-type"))&&ce.setContentType(pe),W.body){const[Le,Ae]=Yx(Te,xp(Gx(je)));G=Qx(W.body,Xx,Le,Ae)}}dt.isString(ue)||(ue=ue?"include":"omit");const fe=e&&"credentials"in a.prototype,_e={...Re,signal:oe,method:P.toUpperCase(),headers:ce.normalize().toJSON(),body:G,duplex:"half",credentials:fe?ue:void 0};he=e&&new a(O,_e);let We=await(e?be(he,Re):be(O,_e));const te=S&&(Z==="stream"||Z==="response");if(S&&(xe||te&&ye)){const W={};["status","statusText","headers"].forEach(V=>{W[V]=We[V]});const pe=dt.toFiniteNumber(We.headers.get("content-length")),[Le,Ae]=xe&&Yx(pe,xp(Gx(xe),!0))||[];We=new o(Qx(We.body,Xx,Le,()=>{Ae&&Ae(),ye&&ye()}),W)}Z=Z||"text";let me=await D[dt.findKey(D,Z)||"text"](We,F);return!te&&ye&&ye(),await new Promise((W,pe)=>{by(W,pe,{data:me,headers:Bn.from(We.headers),status:We.status,statusText:We.statusText,config:F,request:he})})}catch(fe){throw ye&&ye(),fe&&fe.name==="TypeError"&&/Load failed|fetch/i.test(fe.message)?Object.assign(new Ls("Network Error",Ls.ERR_NETWORK,F,he),{cause:fe.cause||fe}):Ls.from(fe,fe&&fe.code,F,he)}}},V5=new Map,wy=l=>{let n=l&&l.env||{};const{fetch:a,Request:o,Response:s}=n,e=[o,s,a];let m=e.length,v=m,w,N,S=V5;for(;v--;)w=e[v],N=S.get(w),N===void 0&&S.set(w,N=v?new Map:H5(n)),S=N;return N};wy();const ux={http:i5,xhr:O5,fetch:{get:wy}};dt.forEach(ux,(l,n)=>{if(l){try{Object.defineProperty(l,"name",{value:n})}catch{}Object.defineProperty(l,"adapterName",{value:n})}});const t2=l=>`- ${l}`,W5=l=>dt.isFunction(l)||l===null||l===!1;function $5(l,n){l=dt.isArray(l)?l:[l];const{length:a}=l;let o,s;const e={};for(let m=0;m<a;m++){o=l[m];let v;if(s=o,!W5(o)&&(s=ux[(v=String(o)).toLowerCase()],s===void 0))throw new Ls(`Unknown adapter '${v}'`);if(s&&(dt.isFunction(s)||(s=s.get(n))))break;e[v||"#"+m]=s}if(!s){const m=Object.entries(e).map(([w,N])=>`adapter ${w} `+(N===!1?"is not supported by the environment":"is not available in the build"));let v=a?m.length>1?`since :
`+m.map(t2).join(`
`):" "+t2(m[0]):"as no adapter specified";throw new Ls("There is no suitable adapter to dispatch the request "+v,"ERR_NOT_SUPPORT")}return s}const jy={getAdapter:$5,adapters:ux};function p1(l){if(l.cancelToken&&l.cancelToken.throwIfRequested(),l.signal&&l.signal.aborted)throw new rh(null,l)}function s2(l){return p1(l),l.headers=Bn.from(l.headers),l.data=g1.call(l,l.transformRequest),["post","put","patch"].indexOf(l.method)!==-1&&l.headers.setContentType("application/x-www-form-urlencoded",!1),jy.getAdapter(l.adapter||pm.adapter,l)(l).then(function(o){return p1(l),o.data=g1.call(l,l.transformResponse,o),o.headers=Bn.from(o.headers),o},function(o){return xy(o)||(p1(l),o&&o.response&&(o.response.data=g1.call(l,l.transformResponse,o.response),o.response.headers=Bn.from(o.response.headers))),Promise.reject(o)})}const Ny="1.13.2",_p={};["object","boolean","number","function","string","symbol"].forEach((l,n)=>{_p[l]=function(o){return typeof o===l||"a"+(n<1?"n ":" ")+l}});const r2={};_p.transitional=function(n,a,o){function s(e,m){return"[Axios v"+Ny+"] Transitional option '"+e+"'"+m+(o?". "+o:"")}return(e,m,v)=>{if(n===!1)throw new Ls(s(m," has been removed"+(a?" in "+a:"")),Ls.ERR_DEPRECATED);return a&&!r2[m]&&(r2[m]=!0,console.warn(s(m," has been deprecated since v"+a+" and will be removed in the near future"))),n?n(e,m,v):!0}};_p.spelling=function(n){return(a,o)=>(console.warn(`${o} is likely a misspelling of ${n}`),!0)};function q5(l,n,a){if(typeof l!="object")throw new Ls("options must be an object",Ls.ERR_BAD_OPTION_VALUE);const o=Object.keys(l);let s=o.length;for(;s-- >0;){const e=o[s],m=n[e];if(m){const v=l[e],w=v===void 0||m(v,e,l);if(w!==!0)throw new Ls("option "+e+" must be "+w,Ls.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new Ls("Unknown option "+e,Ls.ERR_BAD_OPTION)}}const dp={assertOptions:q5,validators:_p},zl=dp.validators;let t0=class{constructor(n){this.defaults=n||{},this.interceptors={request:new $x,response:new $x}}async request(n,a){try{return await this._request(n,a)}catch(o){if(o instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const e=s.stack?s.stack.replace(/^.+\n/,""):"";try{o.stack?e&&!String(o.stack).endsWith(e.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+e):o.stack=e}catch{}}throw o}}_request(n,a){typeof n=="string"?(a=a||{},a.url=n):a=n||{},a=r0(this.defaults,a);const{transitional:o,paramsSerializer:s,headers:e}=a;o!==void 0&&dp.assertOptions(o,{silentJSONParsing:zl.transitional(zl.boolean),forcedJSONParsing:zl.transitional(zl.boolean),clarifyTimeoutError:zl.transitional(zl.boolean)},!1),s!=null&&(dt.isFunction(s)?a.paramsSerializer={serialize:s}:dp.assertOptions(s,{encode:zl.function,serialize:zl.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),dp.assertOptions(a,{baseUrl:zl.spelling("baseURL"),withXsrfToken:zl.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let m=e&&dt.merge(e.common,e[a.method]);e&&dt.forEach(["delete","get","head","post","put","patch","common"],F=>{delete e[F]}),a.headers=Bn.concat(m,e);const v=[];let w=!0;this.interceptors.request.forEach(function(O){typeof O.runWhen=="function"&&O.runWhen(a)===!1||(w=w&&O.synchronous,v.unshift(O.fulfilled,O.rejected))});const N=[];this.interceptors.response.forEach(function(O){N.push(O.fulfilled,O.rejected)});let S,D=0,L;if(!w){const F=[s2.bind(this),void 0];for(F.unshift(...v),F.push(...N),L=F.length,S=Promise.resolve(a);D<L;)S=S.then(F[D++],F[D++]);return S}L=v.length;let M=a;for(;D<L;){const F=v[D++],O=v[D++];try{M=F(M)}catch(P){O.call(this,P);break}}try{S=s2.call(this,M)}catch(F){return Promise.reject(F)}for(D=0,L=N.length;D<L;)S=S.then(N[D++],N[D++]);return S}getUri(n){n=r0(this.defaults,n);const a=yy(n.baseURL,n.url,n.allowAbsoluteUrls);return my(a,n.params,n.paramsSerializer)}};dt.forEach(["delete","get","head","options"],function(n){t0.prototype[n]=function(a,o){return this.request(r0(o||{},{method:n,url:a,data:(o||{}).data}))}});dt.forEach(["post","put","patch"],function(n){function a(o){return function(e,m,v){return this.request(r0(v||{},{method:n,headers:o?{"Content-Type":"multipart/form-data"}:{},url:e,data:m}))}}t0.prototype[n]=a(),t0.prototype[n+"Form"]=a(!0)});let Y5=class ky{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(e){a=e});const o=this;this.promise.then(s=>{if(!o._listeners)return;let e=o._listeners.length;for(;e-- >0;)o._listeners[e](s);o._listeners=null}),this.promise.then=s=>{let e;const m=new Promise(v=>{o.subscribe(v),e=v}).then(s);return m.cancel=function(){o.unsubscribe(e)},m},n(function(e,m,v){o.reason||(o.reason=new rh(e,m,v),a(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const a=this._listeners.indexOf(n);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const n=new AbortController,a=o=>{n.abort(o)};return this.subscribe(a),n.signal.unsubscribe=()=>this.unsubscribe(a),n.signal}static source(){let n;return{token:new ky(function(s){n=s}),cancel:n}}};function G5(l){return function(a){return l.apply(null,a)}}function K5(l){return dt.isObject(l)&&l.isAxiosError===!0}const $1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries($1).forEach(([l,n])=>{$1[n]=l});function Cy(l){const n=new t0(l),a=sy(t0.prototype.request,n);return dt.extend(a,t0.prototype,n,{allOwnKeys:!0}),dt.extend(a,n,null,{allOwnKeys:!0}),a.create=function(s){return Cy(r0(l,s))},a}const sa=Cy(pm);sa.Axios=t0;sa.CanceledError=rh;sa.CancelToken=Y5;sa.isCancel=xy;sa.VERSION=Ny;sa.toFormData=Tp;sa.AxiosError=Ls;sa.Cancel=sa.CanceledError;sa.all=function(n){return Promise.all(n)};sa.spread=G5;sa.isAxiosError=K5;sa.mergeConfig=r0;sa.AxiosHeaders=Bn;sa.formToJSON=l=>py(dt.isHTMLForm(l)?new FormData(l):l);sa.getAdapter=jy.getAdapter;sa.HttpStatusCode=$1;sa.default=sa;const{Axios:$7,AxiosError:q7,CanceledError:Y7,isCancel:G7,CancelToken:K7,VERSION:Q7,all:X7,Cancel:J7,isAxiosError:Z7,spread:eC,toFormData:tC,AxiosHeaders:sC,HttpStatusCode:rC,formToJSON:aC,getAdapter:nC,mergeConfig:iC}=sa,Q5=()=>{const n="http://localhost:5000/api".replace(/\/$/,"");return n.endsWith("/api")?n:`${n}/api`},Vt=sa.create({baseURL:Q5()});Vt.interceptors.request.use(l=>{const n=localStorage.getItem("token");return n&&(l.headers.Authorization=`Bearer ${n}`),l});Vt.interceptors.response.use(l=>l,l=>(sa.isCancel&&sa.isCancel(l)||l.name==="CanceledError"||l.message==="canceled"||l.code==="ERR_CANCELED"||l.config&&l.config.signal&&l.config.signal.aborted||(l.response?(console.error("API Error Response:",l.response.status,l.response.statusText),console.error("Error Details:",JSON.stringify(l.response.data,null,2)),console.error("Request URL:",l.config?.baseURL+l.config?.url),console.error("Request Method:",l.config?.method?.toUpperCase())):l.request?(console.error("API Network Error - No response received"),console.error("Error Message:",l.message),console.error("Error Code:",l.code),console.error("Request URL:",l.config?.baseURL+l.config?.url)):console.error("API Request Setup Error:",l.message)),Promise.reject(l)));function X5(){const l=Tr();B.useEffect(()=>{localStorage.getItem("token")&&l("/dashboard",{replace:!0})},[l]);const[n,a]=B.useState(!0),[o,s]=B.useState({email:"",password:"",name:""}),[e,m]=B.useState(!1),[v,w]=B.useState(""),N=L=>{s({...o,[L.target.name]:L.target.value}),w("")},S=()=>{s({email:"",password:"",name:""}),w("")},D=async L=>{if(L.preventDefault(),w(""),!o.email.trim()){w("Email is required");return}if(!o.password.trim()){w("Password is required");return}if(o.password.length<6){w("Password must be at least 6 characters long");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email.trim())){w("Please enter a valid email address");return}m(!0);try{const F=n?"/auth/login":"/auth/register",O=n?{email:o.email.trim(),password:o.password}:{email:o.email.trim(),password:o.password,...o.name&&o.name.trim()&&{name:o.name.trim()}},P=await Vt.post(F,O);P.data.success&&(localStorage.setItem("token",P.data.data.token),localStorage.setItem("user",JSON.stringify(P.data.data.user)),l("/dashboard"))}catch(F){F.code==="ERR_NETWORK"||F.message==="Network Error"||!F.response?w("Cannot connect to server. Please make sure the backend server is running on http://localhost:5000"):w(F.response?.data?.error||F.message||(n?"Login failed. Please check your credentials.":"Registration failed. Please try again."))}finally{m(!1)}};return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4",children:t.jsxs("div",{className:"w-full max-w-md",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-2xl mb-4 shadow-lg",children:t.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full"})})}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Outbound SaaS"}),t.jsx("p",{className:"text-gray-600",children:n?"Welcome back":"Let's get you started"})]}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[t.jsxs("div",{className:"flex gap-2 mb-6 p-1 bg-gray-100 rounded-lg",children:[t.jsx("button",{type:"button",onClick:()=>{a(!0),S()},className:`flex-1 py-2 px-4 rounded-md text-sm font-semibold transition-all ${n?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Login"}),t.jsx("button",{type:"button",onClick:()=>{a(!1),S()},className:`flex-1 py-2 px-4 rounded-md text-sm font-semibold transition-all ${n?"text-gray-600 hover:text-gray-900":"bg-white text-blue-600 shadow-sm"}`,children:"Register"})]}),v&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:v}),t.jsxs("form",{onSubmit:D,className:"space-y-4",children:[!n&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),t.jsx("input",{type:"text",name:"name",value:o.name,onChange:N,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:"Your name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),t.jsx("input",{type:"email",name:"email",value:o.email,onChange:N,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:"your@email.com"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),n&&t.jsx("button",{type:"button",onClick:()=>l("/reset-password"),className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Forgot Password?"})]}),t.jsx("input",{type:"password",name:"password",value:o.password,onChange:N,required:!0,minLength:6,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:""}),!n&&t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters"})]}),t.jsx("button",{type:"submit",disabled:e,className:"w-full py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:e?t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n?"Logging in...":"Creating account..."]}):n?"Login":"Create Account"})]})]}),t.jsx("p",{className:"text-center text-sm text-gray-500 mt-6",children:n?t.jsxs(t.Fragment,{children:["Don't have an account?"," ",t.jsx("button",{onClick:()=>{a(!1),S()},className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Sign up"})]}):t.jsxs(t.Fragment,{children:["Already have an account?"," ",t.jsx("button",{onClick:()=>{a(!0),S()},className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Sign in"})]})})]})})}function J5(){const l=Tr(),[n,a]=B.useState({email:"",newPassword:"",confirmPassword:""}),[o,s]=B.useState(!1),[e,m]=B.useState(""),[v,w]=B.useState(""),N=D=>{a({...n,[D.target.name]:D.target.value}),m(""),w("")},S=async D=>{if(D.preventDefault(),m(""),w(""),!n.email.trim()){m("Email is required");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email.trim())){m("Please enter a valid email address");return}if(!n.newPassword.trim()){m("New password is required");return}if(n.newPassword.length<6){m("Password must be at least 6 characters long");return}if(n.newPassword!==n.confirmPassword){m("Passwords do not match");return}s(!0);try{(await Vt.post("/auth/reset-password",{email:n.email.trim(),newPassword:n.newPassword})).data.success&&(w("Password reset successfully! Redirecting to login..."),setTimeout(()=>{l("/login")},2e3))}catch(M){M.code==="ERR_NETWORK"||M.message==="Network Error"||!M.response?m("Cannot connect to server. Please make sure the backend server is running."):m(M.response?.data?.error||M.message||"Failed to reset password")}finally{s(!1)}};return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 flex items-center justify-center px-4",children:t.jsxs("div",{className:"w-full max-w-md",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-2xl mb-4 shadow-lg",children:t.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center",children:t.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full"})})}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reset Password"}),t.jsx("p",{className:"text-gray-600",children:"Enter your email and new password to reset"})]}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[e&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:e}),v&&t.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 text-green-700 rounded-lg text-sm",children:v}),t.jsxs("form",{onSubmit:S,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),t.jsx("input",{type:"password",name:"newPassword",value:n.newPassword,onChange:N,required:!0,minLength:6,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:""}),t.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),t.jsx("input",{type:"password",name:"confirmPassword",value:n.confirmPassword,onChange:N,required:!0,minLength:6,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),t.jsx("input",{type:"email",name:"email",value:n.email,onChange:N,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition",placeholder:"your@email.com"})]}),t.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:o?t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Resetting..."]}):"Reset Password"})]})]}),t.jsxs("p",{className:"text-center text-sm text-gray-500 mt-6",children:["Remember your password?"," ",t.jsx("button",{onClick:()=>l("/login"),className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Sign in"})]})]})})}const Z5="modulepreload",e3=function(l){return"/"+l},a2={},Ea=function(n,a,o){let s=Promise.resolve();if(a&&a.length>0){let N=function(S){return Promise.all(S.map(D=>Promise.resolve(D).then(L=>({status:"fulfilled",value:L}),L=>({status:"rejected",reason:L}))))};var m=N;document.getElementsByTagName("link");const v=document.querySelector("meta[property=csp-nonce]"),w=v?.nonce||v?.getAttribute("nonce");s=N(a.map(S=>{if(S=e3(S),S in a2)return;a2[S]=!0;const D=S.endsWith(".css"),L=D?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${L}`))return;const M=document.createElement("link");if(M.rel=D?"stylesheet":Z5,D||(M.as="script"),M.crossOrigin="",M.href=S,w&&M.setAttribute("nonce",w),document.head.appendChild(M),D)return new Promise((F,O)=>{M.addEventListener("load",F),M.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${S}`)))})}))}function e(v){const w=new Event("vite:preloadError",{cancelable:!0});if(w.payload=v,window.dispatchEvent(w),!w.defaultPrevented)throw v}return s.then(v=>{for(const w of v||[])w.status==="rejected"&&e(w.reason);return n().catch(e)})};function xm(l){return l+.5|0}const Rc=(l,n,a)=>Math.max(Math.min(l,a),n);function Qf(l){return Rc(xm(l*2.55),0,255)}function Ic(l){return Rc(xm(l*255),0,255)}function Fo(l){return Rc(xm(l/2.55)/100,0,1)}function n2(l){return Rc(xm(l*100),0,100)}const wi={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},q1=[..."0123456789ABCDEF"],t3=l=>q1[l&15],s3=l=>q1[(l&240)>>4]+q1[l&15],Vg=l=>(l&240)>>4===(l&15),r3=l=>Vg(l.r)&&Vg(l.g)&&Vg(l.b)&&Vg(l.a);function a3(l){var n=l.length,a;return l[0]==="#"&&(n===4||n===5?a={r:255&wi[l[1]]*17,g:255&wi[l[2]]*17,b:255&wi[l[3]]*17,a:n===5?wi[l[4]]*17:255}:(n===7||n===9)&&(a={r:wi[l[1]]<<4|wi[l[2]],g:wi[l[3]]<<4|wi[l[4]],b:wi[l[5]]<<4|wi[l[6]],a:n===9?wi[l[7]]<<4|wi[l[8]]:255})),a}const n3=(l,n)=>l<255?n(l):"";function i3(l){var n=r3(l)?t3:s3;return l?"#"+n(l.r)+n(l.g)+n(l.b)+n3(l.a,n):void 0}const l3=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Sy(l,n,a){const o=n*Math.min(a,1-a),s=(e,m=(e+l/30)%12)=>a-o*Math.max(Math.min(m-3,9-m,1),-1);return[s(0),s(8),s(4)]}function o3(l,n,a){const o=(s,e=(s+l/60)%6)=>a-a*n*Math.max(Math.min(e,4-e,1),0);return[o(5),o(3),o(1)]}function c3(l,n,a){const o=Sy(l,1,.5);let s;for(n+a>1&&(s=1/(n+a),n*=s,a*=s),s=0;s<3;s++)o[s]*=1-n-a,o[s]+=n;return o}function d3(l,n,a,o,s){return l===s?(n-a)/o+(n<a?6:0):n===s?(a-l)/o+2:(l-n)/o+4}function hx(l){const a=l.r/255,o=l.g/255,s=l.b/255,e=Math.max(a,o,s),m=Math.min(a,o,s),v=(e+m)/2;let w,N,S;return e!==m&&(S=e-m,N=v>.5?S/(2-e-m):S/(e+m),w=d3(a,o,s,S,e),w=w*60+.5),[w|0,N||0,v]}function fx(l,n,a,o){return(Array.isArray(n)?l(n[0],n[1],n[2]):l(n,a,o)).map(Ic)}function mx(l,n,a){return fx(Sy,l,n,a)}function u3(l,n,a){return fx(c3,l,n,a)}function h3(l,n,a){return fx(o3,l,n,a)}function Ay(l){return(l%360+360)%360}function f3(l){const n=l3.exec(l);let a=255,o;if(!n)return;n[5]!==o&&(a=n[6]?Qf(+n[5]):Ic(+n[5]));const s=Ay(+n[2]),e=+n[3]/100,m=+n[4]/100;return n[1]==="hwb"?o=u3(s,e,m):n[1]==="hsv"?o=h3(s,e,m):o=mx(s,e,m),{r:o[0],g:o[1],b:o[2],a}}function m3(l,n){var a=hx(l);a[0]=Ay(a[0]+n),a=mx(a),l.r=a[0],l.g=a[1],l.b=a[2]}function g3(l){if(!l)return;const n=hx(l),a=n[0],o=n2(n[1]),s=n2(n[2]);return l.a<255?`hsla(${a}, ${o}%, ${s}%, ${Fo(l.a)})`:`hsl(${a}, ${o}%, ${s}%)`}const i2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},l2={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function p3(){const l={},n=Object.keys(l2),a=Object.keys(i2);let o,s,e,m,v;for(o=0;o<n.length;o++){for(m=v=n[o],s=0;s<a.length;s++)e=a[s],v=v.replace(e,i2[e]);e=parseInt(l2[m],16),l[v]=[e>>16&255,e>>8&255,e&255]}return l}let Wg;function x3(l){Wg||(Wg=p3(),Wg.transparent=[0,0,0,0]);const n=Wg[l.toLowerCase()];return n&&{r:n[0],g:n[1],b:n[2],a:n.length===4?n[3]:255}}const b3=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function y3(l){const n=b3.exec(l);let a=255,o,s,e;if(n){if(n[7]!==o){const m=+n[7];a=n[8]?Qf(m):Rc(m*255,0,255)}return o=+n[1],s=+n[3],e=+n[5],o=255&(n[2]?Qf(o):Rc(o,0,255)),s=255&(n[4]?Qf(s):Rc(s,0,255)),e=255&(n[6]?Qf(e):Rc(e,0,255)),{r:o,g:s,b:e,a}}}function v3(l){return l&&(l.a<255?`rgba(${l.r}, ${l.g}, ${l.b}, ${Fo(l.a)})`:`rgb(${l.r}, ${l.g}, ${l.b})`)}const x1=l=>l<=.0031308?l*12.92:Math.pow(l,1/2.4)*1.055-.055,Vu=l=>l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4);function w3(l,n,a){const o=Vu(Fo(l.r)),s=Vu(Fo(l.g)),e=Vu(Fo(l.b));return{r:Ic(x1(o+a*(Vu(Fo(n.r))-o))),g:Ic(x1(s+a*(Vu(Fo(n.g))-s))),b:Ic(x1(e+a*(Vu(Fo(n.b))-e))),a:l.a+a*(n.a-l.a)}}function $g(l,n,a){if(l){let o=hx(l);o[n]=Math.max(0,Math.min(o[n]+o[n]*a,n===0?360:1)),o=mx(o),l.r=o[0],l.g=o[1],l.b=o[2]}}function Ey(l,n){return l&&Object.assign(n||{},l)}function o2(l){var n={r:0,g:0,b:0,a:255};return Array.isArray(l)?l.length>=3&&(n={r:l[0],g:l[1],b:l[2],a:255},l.length>3&&(n.a=Ic(l[3]))):(n=Ey(l,{r:0,g:0,b:0,a:1}),n.a=Ic(n.a)),n}function j3(l){return l.charAt(0)==="r"?y3(l):f3(l)}class am{constructor(n){if(n instanceof am)return n;const a=typeof n;let o;a==="object"?o=o2(n):a==="string"&&(o=a3(n)||x3(n)||j3(n)),this._rgb=o,this._valid=!!o}get valid(){return this._valid}get rgb(){var n=Ey(this._rgb);return n&&(n.a=Fo(n.a)),n}set rgb(n){this._rgb=o2(n)}rgbString(){return this._valid?v3(this._rgb):void 0}hexString(){return this._valid?i3(this._rgb):void 0}hslString(){return this._valid?g3(this._rgb):void 0}mix(n,a){if(n){const o=this.rgb,s=n.rgb;let e;const m=a===e?.5:a,v=2*m-1,w=o.a-s.a,N=((v*w===-1?v:(v+w)/(1+v*w))+1)/2;e=1-N,o.r=255&N*o.r+e*s.r+.5,o.g=255&N*o.g+e*s.g+.5,o.b=255&N*o.b+e*s.b+.5,o.a=m*o.a+(1-m)*s.a,this.rgb=o}return this}interpolate(n,a){return n&&(this._rgb=w3(this._rgb,n._rgb,a)),this}clone(){return new am(this.rgb)}alpha(n){return this._rgb.a=Ic(n),this}clearer(n){const a=this._rgb;return a.a*=1-n,this}greyscale(){const n=this._rgb,a=xm(n.r*.3+n.g*.59+n.b*.11);return n.r=n.g=n.b=a,this}opaquer(n){const a=this._rgb;return a.a*=1+n,this}negate(){const n=this._rgb;return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,this}lighten(n){return $g(this._rgb,2,n),this}darken(n){return $g(this._rgb,2,-n),this}saturate(n){return $g(this._rgb,1,n),this}desaturate(n){return $g(this._rgb,1,-n),this}rotate(n){return m3(this._rgb,n),this}}function Ao(){}const N3=(()=>{let l=0;return()=>l++})();function hr(l){return l==null}function ja(l){if(Array.isArray&&Array.isArray(l))return!0;const n=Object.prototype.toString.call(l);return n.slice(0,7)==="[object"&&n.slice(-6)==="Array]"}function Qs(l){return l!==null&&Object.prototype.toString.call(l)==="[object Object]"}function an(l){return(typeof l=="number"||l instanceof Number)&&isFinite(+l)}function Ul(l,n){return an(l)?l:n}function Ts(l,n){return typeof l>"u"?n:l}const k3=(l,n)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100:+l/n,Dy=(l,n)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100*n:+l;function Hr(l,n,a){if(l&&typeof l.call=="function")return l.apply(a,n)}function vr(l,n,a,o){let s,e,m;if(ja(l))for(e=l.length,s=0;s<e;s++)n.call(a,l[s],s);else if(Qs(l))for(m=Object.keys(l),e=m.length,s=0;s<e;s++)n.call(a,l[m[s]],m[s])}function bp(l,n){let a,o,s,e;if(!l||!n||l.length!==n.length)return!1;for(a=0,o=l.length;a<o;++a)if(s=l[a],e=n[a],s.datasetIndex!==e.datasetIndex||s.index!==e.index)return!1;return!0}function yp(l){if(ja(l))return l.map(yp);if(Qs(l)){const n=Object.create(null),a=Object.keys(l),o=a.length;let s=0;for(;s<o;++s)n[a[s]]=yp(l[a[s]]);return n}return l}function Ty(l){return["__proto__","prototype","constructor"].indexOf(l)===-1}function C3(l,n,a,o){if(!Ty(l))return;const s=n[l],e=a[l];Qs(s)&&Qs(e)?nm(s,e,o):n[l]=yp(e)}function nm(l,n,a){const o=ja(n)?n:[n],s=o.length;if(!Qs(l))return l;a=a||{};const e=a.merger||C3;let m;for(let v=0;v<s;++v){if(m=o[v],!Qs(m))continue;const w=Object.keys(m);for(let N=0,S=w.length;N<S;++N)e(w[N],l,m,a)}return l}function Zf(l,n){return nm(l,n,{merger:S3})}function S3(l,n,a){if(!Ty(l))return;const o=n[l],s=a[l];Qs(o)&&Qs(s)?Zf(o,s):Object.prototype.hasOwnProperty.call(n,l)||(n[l]=yp(s))}const c2={"":l=>l,x:l=>l.x,y:l=>l.y};function A3(l){const n=l.split("."),a=[];let o="";for(const s of n)o+=s,o.endsWith("\\")?o=o.slice(0,-1)+".":(a.push(o),o="");return a}function E3(l){const n=A3(l);return a=>{for(const o of n){if(o==="")break;a=a&&a[o]}return a}}function Bc(l,n){return(c2[n]||(c2[n]=E3(n)))(l)}function gx(l){return l.charAt(0).toUpperCase()+l.slice(1)}const im=l=>typeof l<"u",zc=l=>typeof l=="function",d2=(l,n)=>{if(l.size!==n.size)return!1;for(const a of l)if(!n.has(a))return!1;return!0};function D3(l){return l.type==="mouseup"||l.type==="click"||l.type==="contextmenu"}const pr=Math.PI,ta=2*pr,T3=ta+pr,vp=Number.POSITIVE_INFINITY,_3=pr/180,Aa=pr/2,Gd=pr/4,u2=pr*2/3,_y=Math.log10,$l=Math.sign;function em(l,n,a){return Math.abs(l-n)<a}function h2(l){const n=Math.round(l);l=em(l,n,l/1e3)?n:l;const a=Math.pow(10,Math.floor(_y(l))),o=l/a;return(o<=1?1:o<=2?2:o<=5?5:10)*a}function F3(l){const n=[],a=Math.sqrt(l);let o;for(o=1;o<a;o++)l%o===0&&(n.push(o),n.push(l/o));return a===(a|0)&&n.push(a),n.sort((s,e)=>s-e).pop(),n}function M3(l){return typeof l=="symbol"||typeof l=="object"&&l!==null&&!(Symbol.toPrimitive in l||"toString"in l||"valueOf"in l)}function Qu(l){return!M3(l)&&!isNaN(parseFloat(l))&&isFinite(l)}function L3(l,n){const a=Math.round(l);return a-n<=l&&a+n>=l}function R3(l,n,a){let o,s,e;for(o=0,s=l.length;o<s;o++)e=l[o][a],isNaN(e)||(n.min=Math.min(n.min,e),n.max=Math.max(n.max,e))}function Wl(l){return l*(pr/180)}function O3(l){return l*(180/pr)}function f2(l){if(!an(l))return;let n=1,a=0;for(;Math.round(l*n)/n!==l;)n*=10,a++;return a}function Fy(l,n){const a=n.x-l.x,o=n.y-l.y,s=Math.sqrt(a*a+o*o);let e=Math.atan2(o,a);return e<-.5*pr&&(e+=ta),{angle:e,distance:s}}function Y1(l,n){return Math.sqrt(Math.pow(n.x-l.x,2)+Math.pow(n.y-l.y,2))}function P3(l,n){return(l-n+T3)%ta-pr}function ti(l){return(l%ta+ta)%ta}function lm(l,n,a,o){const s=ti(l),e=ti(n),m=ti(a),v=ti(e-s),w=ti(m-s),N=ti(s-e),S=ti(s-m);return s===e||s===m||o&&e===m||v>w&&N<S}function sn(l,n,a){return Math.max(n,Math.min(a,l))}function I3(l){return sn(l,-32768,32767)}function Lo(l,n,a,o=1e-6){return l>=Math.min(n,a)-o&&l<=Math.max(n,a)+o}function px(l,n,a){a=a||(m=>l[m]<n);let o=l.length-1,s=0,e;for(;o-s>1;)e=s+o>>1,a(e)?s=e:o=e;return{lo:s,hi:o}}const e0=(l,n,a,o)=>px(l,a,o?s=>{const e=l[s][n];return e<a||e===a&&l[s+1][n]===a}:s=>l[s][n]<a),B3=(l,n,a)=>px(l,a,o=>l[o][n]>=a);function z3(l,n,a){let o=0,s=l.length;for(;o<s&&l[o]<n;)o++;for(;s>o&&l[s-1]>a;)s--;return o>0||s<l.length?l.slice(o,s):l}const My=["push","pop","shift","splice","unshift"];function U3(l,n){if(l._chartjs){l._chartjs.listeners.push(n);return}Object.defineProperty(l,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[n]}}),My.forEach(a=>{const o="_onData"+gx(a),s=l[a];Object.defineProperty(l,a,{configurable:!0,enumerable:!1,value(...e){const m=s.apply(this,e);return l._chartjs.listeners.forEach(v=>{typeof v[o]=="function"&&v[o](...e)}),m}})})}function m2(l,n){const a=l._chartjs;if(!a)return;const o=a.listeners,s=o.indexOf(n);s!==-1&&o.splice(s,1),!(o.length>0)&&(My.forEach(e=>{delete l[e]}),delete l._chartjs)}function Ly(l){const n=new Set(l);return n.size===l.length?l:Array.from(n)}const Ry=(function(){return typeof window>"u"?function(l){return l()}:window.requestAnimationFrame})();function Oy(l,n){let a=[],o=!1;return function(...s){a=s,o||(o=!0,Ry.call(window,()=>{o=!1,l.apply(n,a)}))}}function H3(l,n){let a;return function(...o){return n?(clearTimeout(a),a=setTimeout(l,n,o)):l.apply(this,o),n}}const xx=l=>l==="start"?"left":l==="end"?"right":"center",en=(l,n,a)=>l==="start"?n:l==="end"?a:(n+a)/2,V3=(l,n,a,o)=>l===(o?"left":"right")?a:l==="center"?(n+a)/2:n;function Py(l,n,a){const o=n.length;let s=0,e=o;if(l._sorted){const{iScale:m,vScale:v,_parsed:w}=l,N=l.dataset&&l.dataset.options?l.dataset.options.spanGaps:null,S=m.axis,{min:D,max:L,minDefined:M,maxDefined:F}=m.getUserBounds();if(M){if(s=Math.min(e0(w,S,D).lo,a?o:e0(n,S,m.getPixelForValue(D)).lo),N){const O=w.slice(0,s+1).reverse().findIndex(P=>!hr(P[v.axis]));s-=Math.max(0,O)}s=sn(s,0,o-1)}if(F){let O=Math.max(e0(w,m.axis,L,!0).hi+1,a?0:e0(n,S,m.getPixelForValue(L),!0).hi+1);if(N){const P=w.slice(O-1).findIndex(G=>!hr(G[v.axis]));O+=Math.max(0,P)}e=sn(O,s,o)-s}else e=o-s}return{start:s,count:e}}function Iy(l){const{xScale:n,yScale:a,_scaleRanges:o}=l,s={xmin:n.min,xmax:n.max,ymin:a.min,ymax:a.max};if(!o)return l._scaleRanges=s,!0;const e=o.xmin!==n.min||o.xmax!==n.max||o.ymin!==a.min||o.ymax!==a.max;return Object.assign(o,s),e}const qg=l=>l===0||l===1,g2=(l,n,a)=>-(Math.pow(2,10*(l-=1))*Math.sin((l-n)*ta/a)),p2=(l,n,a)=>Math.pow(2,-10*l)*Math.sin((l-n)*ta/a)+1,tm={linear:l=>l,easeInQuad:l=>l*l,easeOutQuad:l=>-l*(l-2),easeInOutQuad:l=>(l/=.5)<1?.5*l*l:-.5*(--l*(l-2)-1),easeInCubic:l=>l*l*l,easeOutCubic:l=>(l-=1)*l*l+1,easeInOutCubic:l=>(l/=.5)<1?.5*l*l*l:.5*((l-=2)*l*l+2),easeInQuart:l=>l*l*l*l,easeOutQuart:l=>-((l-=1)*l*l*l-1),easeInOutQuart:l=>(l/=.5)<1?.5*l*l*l*l:-.5*((l-=2)*l*l*l-2),easeInQuint:l=>l*l*l*l*l,easeOutQuint:l=>(l-=1)*l*l*l*l+1,easeInOutQuint:l=>(l/=.5)<1?.5*l*l*l*l*l:.5*((l-=2)*l*l*l*l+2),easeInSine:l=>-Math.cos(l*Aa)+1,easeOutSine:l=>Math.sin(l*Aa),easeInOutSine:l=>-.5*(Math.cos(pr*l)-1),easeInExpo:l=>l===0?0:Math.pow(2,10*(l-1)),easeOutExpo:l=>l===1?1:-Math.pow(2,-10*l)+1,easeInOutExpo:l=>qg(l)?l:l<.5?.5*Math.pow(2,10*(l*2-1)):.5*(-Math.pow(2,-10*(l*2-1))+2),easeInCirc:l=>l>=1?l:-(Math.sqrt(1-l*l)-1),easeOutCirc:l=>Math.sqrt(1-(l-=1)*l),easeInOutCirc:l=>(l/=.5)<1?-.5*(Math.sqrt(1-l*l)-1):.5*(Math.sqrt(1-(l-=2)*l)+1),easeInElastic:l=>qg(l)?l:g2(l,.075,.3),easeOutElastic:l=>qg(l)?l:p2(l,.075,.3),easeInOutElastic(l){return qg(l)?l:l<.5?.5*g2(l*2,.1125,.45):.5+.5*p2(l*2-1,.1125,.45)},easeInBack(l){return l*l*((1.70158+1)*l-1.70158)},easeOutBack(l){return(l-=1)*l*((1.70158+1)*l+1.70158)+1},easeInOutBack(l){let n=1.70158;return(l/=.5)<1?.5*(l*l*(((n*=1.525)+1)*l-n)):.5*((l-=2)*l*(((n*=1.525)+1)*l+n)+2)},easeInBounce:l=>1-tm.easeOutBounce(1-l),easeOutBounce(l){return l<1/2.75?7.5625*l*l:l<2/2.75?7.5625*(l-=1.5/2.75)*l+.75:l<2.5/2.75?7.5625*(l-=2.25/2.75)*l+.9375:7.5625*(l-=2.625/2.75)*l+.984375},easeInOutBounce:l=>l<.5?tm.easeInBounce(l*2)*.5:tm.easeOutBounce(l*2-1)*.5+.5};function bx(l){if(l&&typeof l=="object"){const n=l.toString();return n==="[object CanvasPattern]"||n==="[object CanvasGradient]"}return!1}function x2(l){return bx(l)?l:new am(l)}function b1(l){return bx(l)?l:new am(l).saturate(.5).darken(.1).hexString()}const W3=["x","y","borderWidth","radius","tension"],$3=["color","borderColor","backgroundColor"];function q3(l){l.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),l.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:n=>n!=="onProgress"&&n!=="onComplete"&&n!=="fn"}),l.set("animations",{colors:{type:"color",properties:$3},numbers:{type:"number",properties:W3}}),l.describe("animations",{_fallback:"animation"}),l.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:n=>n|0}}}})}function Y3(l){l.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const b2=new Map;function G3(l,n){n=n||{};const a=l+JSON.stringify(n);let o=b2.get(a);return o||(o=new Intl.NumberFormat(l,n),b2.set(a,o)),o}function Fp(l,n,a){return G3(n,a).format(l)}const K3={values(l){return ja(l)?l:""+l},numeric(l,n,a){if(l===0)return"0";const o=this.chart.options.locale;let s,e=l;if(a.length>1){const N=Math.max(Math.abs(a[0].value),Math.abs(a[a.length-1].value));(N<1e-4||N>1e15)&&(s="scientific"),e=Q3(l,a)}const m=_y(Math.abs(e)),v=isNaN(m)?1:Math.max(Math.min(-1*Math.floor(m),20),0),w={notation:s,minimumFractionDigits:v,maximumFractionDigits:v};return Object.assign(w,this.options.ticks.format),Fp(l,o,w)}};function Q3(l,n){let a=n.length>3?n[2].value-n[1].value:n[1].value-n[0].value;return Math.abs(a)>=1&&l!==Math.floor(l)&&(a=l-Math.floor(l)),a}var By={formatters:K3};function X3(l){l.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(n,a)=>a.lineWidth,tickColor:(n,a)=>a.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:By.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),l.route("scale.ticks","color","","color"),l.route("scale.grid","color","","borderColor"),l.route("scale.border","color","","borderColor"),l.route("scale.title","color","","color"),l.describe("scale",{_fallback:!1,_scriptable:n=>!n.startsWith("before")&&!n.startsWith("after")&&n!=="callback"&&n!=="parser",_indexable:n=>n!=="borderDash"&&n!=="tickBorderDash"&&n!=="dash"}),l.describe("scales",{_fallback:"scale"}),l.describe("scale.ticks",{_scriptable:n=>n!=="backdropPadding"&&n!=="callback",_indexable:n=>n!=="backdropPadding"})}const a0=Object.create(null),G1=Object.create(null);function sm(l,n){if(!n)return l;const a=n.split(".");for(let o=0,s=a.length;o<s;++o){const e=a[o];l=l[e]||(l[e]=Object.create(null))}return l}function y1(l,n,a){return typeof n=="string"?nm(sm(l,n),a):nm(sm(l,""),n)}class J3{constructor(n,a){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,s)=>b1(s.backgroundColor),this.hoverBorderColor=(o,s)=>b1(s.borderColor),this.hoverColor=(o,s)=>b1(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(n),this.apply(a)}set(n,a){return y1(this,n,a)}get(n){return sm(this,n)}describe(n,a){return y1(G1,n,a)}override(n,a){return y1(a0,n,a)}route(n,a,o,s){const e=sm(this,n),m=sm(this,o),v="_"+a;Object.defineProperties(e,{[v]:{value:e[a],writable:!0},[a]:{enumerable:!0,get(){const w=this[v],N=m[s];return Qs(w)?Object.assign({},N,w):Ts(w,N)},set(w){this[v]=w}}})}apply(n){n.forEach(a=>a(this))}}var ma=new J3({_scriptable:l=>!l.startsWith("on"),_indexable:l=>l!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[q3,Y3,X3]);function Z3(l){return!l||hr(l.size)||hr(l.family)?null:(l.style?l.style+" ":"")+(l.weight?l.weight+" ":"")+l.size+"px "+l.family}function y2(l,n,a,o,s){let e=n[s];return e||(e=n[s]=l.measureText(s).width,a.push(s)),e>o&&(o=e),o}function Kd(l,n,a){const o=l.currentDevicePixelRatio,s=a!==0?Math.max(a/2,.5):0;return Math.round((n-s)*o)/o+s}function v2(l,n){!n&&!l||(n=n||l.getContext("2d"),n.save(),n.resetTransform(),n.clearRect(0,0,l.width,l.height),n.restore())}function K1(l,n,a,o){zy(l,n,a,o,null)}function zy(l,n,a,o,s){let e,m,v,w,N,S,D,L;const M=n.pointStyle,F=n.rotation,O=n.radius;let P=(F||0)*_3;if(M&&typeof M=="object"&&(e=M.toString(),e==="[object HTMLImageElement]"||e==="[object HTMLCanvasElement]")){l.save(),l.translate(a,o),l.rotate(P),l.drawImage(M,-M.width/2,-M.height/2,M.width,M.height),l.restore();return}if(!(isNaN(O)||O<=0)){switch(l.beginPath(),M){default:s?l.ellipse(a,o,s/2,O,0,0,ta):l.arc(a,o,O,0,ta),l.closePath();break;case"triangle":S=s?s/2:O,l.moveTo(a+Math.sin(P)*S,o-Math.cos(P)*O),P+=u2,l.lineTo(a+Math.sin(P)*S,o-Math.cos(P)*O),P+=u2,l.lineTo(a+Math.sin(P)*S,o-Math.cos(P)*O),l.closePath();break;case"rectRounded":N=O*.516,w=O-N,m=Math.cos(P+Gd)*w,D=Math.cos(P+Gd)*(s?s/2-N:w),v=Math.sin(P+Gd)*w,L=Math.sin(P+Gd)*(s?s/2-N:w),l.arc(a-D,o-v,N,P-pr,P-Aa),l.arc(a+L,o-m,N,P-Aa,P),l.arc(a+D,o+v,N,P,P+Aa),l.arc(a-L,o+m,N,P+Aa,P+pr),l.closePath();break;case"rect":if(!F){w=Math.SQRT1_2*O,S=s?s/2:w,l.rect(a-S,o-w,2*S,2*w);break}P+=Gd;case"rectRot":D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+L,o-m),l.lineTo(a+D,o+v),l.lineTo(a-L,o+m),l.closePath();break;case"crossRot":P+=Gd;case"cross":D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+D,o+v),l.moveTo(a+L,o-m),l.lineTo(a-L,o+m);break;case"star":D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+D,o+v),l.moveTo(a+L,o-m),l.lineTo(a-L,o+m),P+=Gd,D=Math.cos(P)*(s?s/2:O),m=Math.cos(P)*O,v=Math.sin(P)*O,L=Math.sin(P)*(s?s/2:O),l.moveTo(a-D,o-v),l.lineTo(a+D,o+v),l.moveTo(a+L,o-m),l.lineTo(a-L,o+m);break;case"line":m=s?s/2:Math.cos(P)*O,v=Math.sin(P)*O,l.moveTo(a-m,o-v),l.lineTo(a+m,o+v);break;case"dash":l.moveTo(a,o),l.lineTo(a+Math.cos(P)*(s?s/2:O),o+Math.sin(P)*O);break;case!1:l.closePath();break}l.fill(),n.borderWidth>0&&l.stroke()}}function om(l,n,a){return a=a||.5,!n||l&&l.x>n.left-a&&l.x<n.right+a&&l.y>n.top-a&&l.y<n.bottom+a}function Mp(l,n){l.save(),l.beginPath(),l.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),l.clip()}function Lp(l){l.restore()}function ej(l,n,a,o,s){if(!n)return l.lineTo(a.x,a.y);if(s==="middle"){const e=(n.x+a.x)/2;l.lineTo(e,n.y),l.lineTo(e,a.y)}else s==="after"!=!!o?l.lineTo(n.x,a.y):l.lineTo(a.x,n.y);l.lineTo(a.x,a.y)}function tj(l,n,a,o){if(!n)return l.lineTo(a.x,a.y);l.bezierCurveTo(o?n.cp1x:n.cp2x,o?n.cp1y:n.cp2y,o?a.cp2x:a.cp1x,o?a.cp2y:a.cp1y,a.x,a.y)}function sj(l,n){n.translation&&l.translate(n.translation[0],n.translation[1]),hr(n.rotation)||l.rotate(n.rotation),n.color&&(l.fillStyle=n.color),n.textAlign&&(l.textAlign=n.textAlign),n.textBaseline&&(l.textBaseline=n.textBaseline)}function rj(l,n,a,o,s){if(s.strikethrough||s.underline){const e=l.measureText(o),m=n-e.actualBoundingBoxLeft,v=n+e.actualBoundingBoxRight,w=a-e.actualBoundingBoxAscent,N=a+e.actualBoundingBoxDescent,S=s.strikethrough?(w+N)/2:N;l.strokeStyle=l.fillStyle,l.beginPath(),l.lineWidth=s.decorationWidth||2,l.moveTo(m,S),l.lineTo(v,S),l.stroke()}}function aj(l,n){const a=l.fillStyle;l.fillStyle=n.color,l.fillRect(n.left,n.top,n.width,n.height),l.fillStyle=a}function cm(l,n,a,o,s,e={}){const m=ja(n)?n:[n],v=e.strokeWidth>0&&e.strokeColor!=="";let w,N;for(l.save(),l.font=s.string,sj(l,e),w=0;w<m.length;++w)N=m[w],e.backdrop&&aj(l,e.backdrop),v&&(e.strokeColor&&(l.strokeStyle=e.strokeColor),hr(e.strokeWidth)||(l.lineWidth=e.strokeWidth),l.strokeText(N,a,o,e.maxWidth)),l.fillText(N,a,o,e.maxWidth),rj(l,a,o,N,e),o+=Number(s.lineHeight);l.restore()}function wp(l,n){const{x:a,y:o,w:s,h:e,radius:m}=n;l.arc(a+m.topLeft,o+m.topLeft,m.topLeft,1.5*pr,pr,!0),l.lineTo(a,o+e-m.bottomLeft),l.arc(a+m.bottomLeft,o+e-m.bottomLeft,m.bottomLeft,pr,Aa,!0),l.lineTo(a+s-m.bottomRight,o+e),l.arc(a+s-m.bottomRight,o+e-m.bottomRight,m.bottomRight,Aa,0,!0),l.lineTo(a+s,o+m.topRight),l.arc(a+s-m.topRight,o+m.topRight,m.topRight,0,-Aa,!0),l.lineTo(a+m.topLeft,o)}const nj=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,ij=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function lj(l,n){const a=(""+l).match(nj);if(!a||a[1]==="normal")return n*1.2;switch(l=+a[2],a[3]){case"px":return l;case"%":l/=100;break}return n*l}const oj=l=>+l||0;function yx(l,n){const a={},o=Qs(n),s=o?Object.keys(n):n,e=Qs(l)?o?m=>Ts(l[m],l[n[m]]):m=>l[m]:()=>l;for(const m of s)a[m]=oj(e(m));return a}function Uy(l){return yx(l,{top:"y",right:"x",bottom:"y",left:"x"})}function Yu(l){return yx(l,["topLeft","topRight","bottomLeft","bottomRight"])}function Ni(l){const n=Uy(l);return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function rn(l,n){l=l||{},n=n||ma.font;let a=Ts(l.size,n.size);typeof a=="string"&&(a=parseInt(a,10));let o=Ts(l.style,n.style);o&&!(""+o).match(ij)&&(console.warn('Invalid font style specified: "'+o+'"'),o=void 0);const s={family:Ts(l.family,n.family),lineHeight:lj(Ts(l.lineHeight,n.lineHeight),a),size:a,style:o,weight:Ts(l.weight,n.weight),string:""};return s.string=Z3(s),s}function Yg(l,n,a,o){let s,e,m;for(s=0,e=l.length;s<e;++s)if(m=l[s],m!==void 0&&m!==void 0)return m}function cj(l,n,a){const{min:o,max:s}=l,e=Dy(n,(s-o)/2),m=(v,w)=>a&&v===0?0:v+w;return{min:m(o,-Math.abs(e)),max:m(s,e)}}function o0(l,n){return Object.assign(Object.create(l),n)}function vx(l,n=[""],a,o,s=()=>l[0]){const e=a||l;typeof o>"u"&&(o=$y("_fallback",l));const m={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:l,_rootScopes:e,_fallback:o,_getTarget:s,override:v=>vx([v,...l],n,e,o)};return new Proxy(m,{deleteProperty(v,w){return delete v[w],delete v._keys,delete l[0][w],!0},get(v,w){return Vy(v,w,()=>xj(w,n,l,v))},getOwnPropertyDescriptor(v,w){return Reflect.getOwnPropertyDescriptor(v._scopes[0],w)},getPrototypeOf(){return Reflect.getPrototypeOf(l[0])},has(v,w){return j2(v).includes(w)},ownKeys(v){return j2(v)},set(v,w,N){const S=v._storage||(v._storage=s());return v[w]=S[w]=N,delete v._keys,!0}})}function Xu(l,n,a,o){const s={_cacheable:!1,_proxy:l,_context:n,_subProxy:a,_stack:new Set,_descriptors:Hy(l,o),setContext:e=>Xu(l,e,a,o),override:e=>Xu(l.override(e),n,a,o)};return new Proxy(s,{deleteProperty(e,m){return delete e[m],delete l[m],!0},get(e,m,v){return Vy(e,m,()=>uj(e,m,v))},getOwnPropertyDescriptor(e,m){return e._descriptors.allKeys?Reflect.has(l,m)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(l,m)},getPrototypeOf(){return Reflect.getPrototypeOf(l)},has(e,m){return Reflect.has(l,m)},ownKeys(){return Reflect.ownKeys(l)},set(e,m,v){return l[m]=v,delete e[m],!0}})}function Hy(l,n={scriptable:!0,indexable:!0}){const{_scriptable:a=n.scriptable,_indexable:o=n.indexable,_allKeys:s=n.allKeys}=l;return{allKeys:s,scriptable:a,indexable:o,isScriptable:zc(a)?a:()=>a,isIndexable:zc(o)?o:()=>o}}const dj=(l,n)=>l?l+gx(n):n,wx=(l,n)=>Qs(n)&&l!=="adapters"&&(Object.getPrototypeOf(n)===null||n.constructor===Object);function Vy(l,n,a){if(Object.prototype.hasOwnProperty.call(l,n)||n==="constructor")return l[n];const o=a();return l[n]=o,o}function uj(l,n,a){const{_proxy:o,_context:s,_subProxy:e,_descriptors:m}=l;let v=o[n];return zc(v)&&m.isScriptable(n)&&(v=hj(n,v,l,a)),ja(v)&&v.length&&(v=fj(n,v,l,m.isIndexable)),wx(n,v)&&(v=Xu(v,s,e&&e[n],m)),v}function hj(l,n,a,o){const{_proxy:s,_context:e,_subProxy:m,_stack:v}=a;if(v.has(l))throw new Error("Recursion detected: "+Array.from(v).join("->")+"->"+l);v.add(l);let w=n(e,m||o);return v.delete(l),wx(l,w)&&(w=jx(s._scopes,s,l,w)),w}function fj(l,n,a,o){const{_proxy:s,_context:e,_subProxy:m,_descriptors:v}=a;if(typeof e.index<"u"&&o(l))return n[e.index%n.length];if(Qs(n[0])){const w=n,N=s._scopes.filter(S=>S!==w);n=[];for(const S of w){const D=jx(N,s,l,S);n.push(Xu(D,e,m&&m[l],v))}}return n}function Wy(l,n,a){return zc(l)?l(n,a):l}const mj=(l,n)=>l===!0?n:typeof l=="string"?Bc(n,l):void 0;function gj(l,n,a,o,s){for(const e of n){const m=mj(a,e);if(m){l.add(m);const v=Wy(m._fallback,a,s);if(typeof v<"u"&&v!==a&&v!==o)return v}else if(m===!1&&typeof o<"u"&&a!==o)return null}return!1}function jx(l,n,a,o){const s=n._rootScopes,e=Wy(n._fallback,a,o),m=[...l,...s],v=new Set;v.add(o);let w=w2(v,m,a,e||a,o);return w===null||typeof e<"u"&&e!==a&&(w=w2(v,m,e,w,o),w===null)?!1:vx(Array.from(v),[""],s,e,()=>pj(n,a,o))}function w2(l,n,a,o,s){for(;a;)a=gj(l,n,a,o,s);return a}function pj(l,n,a){const o=l._getTarget();n in o||(o[n]={});const s=o[n];return ja(s)&&Qs(a)?a:s||{}}function xj(l,n,a,o){let s;for(const e of n)if(s=$y(dj(e,l),a),typeof s<"u")return wx(l,s)?jx(a,o,l,s):s}function $y(l,n){for(const a of n){if(!a)continue;const o=a[l];if(typeof o<"u")return o}}function j2(l){let n=l._keys;return n||(n=l._keys=bj(l._scopes)),n}function bj(l){const n=new Set;for(const a of l)for(const o of Object.keys(a).filter(s=>!s.startsWith("_")))n.add(o);return Array.from(n)}function qy(l,n,a,o){const{iScale:s}=l,{key:e="r"}=this._parsing,m=new Array(o);let v,w,N,S;for(v=0,w=o;v<w;++v)N=v+a,S=n[N],m[v]={r:s.parse(Bc(S,e),N)};return m}const yj=Number.EPSILON||1e-14,Ju=(l,n)=>n<l.length&&!l[n].skip&&l[n],Yy=l=>l==="x"?"y":"x";function vj(l,n,a,o){const s=l.skip?n:l,e=n,m=a.skip?n:a,v=Y1(e,s),w=Y1(m,e);let N=v/(v+w),S=w/(v+w);N=isNaN(N)?0:N,S=isNaN(S)?0:S;const D=o*N,L=o*S;return{previous:{x:e.x-D*(m.x-s.x),y:e.y-D*(m.y-s.y)},next:{x:e.x+L*(m.x-s.x),y:e.y+L*(m.y-s.y)}}}function wj(l,n,a){const o=l.length;let s,e,m,v,w,N=Ju(l,0);for(let S=0;S<o-1;++S)if(w=N,N=Ju(l,S+1),!(!w||!N)){if(em(n[S],0,yj)){a[S]=a[S+1]=0;continue}s=a[S]/n[S],e=a[S+1]/n[S],v=Math.pow(s,2)+Math.pow(e,2),!(v<=9)&&(m=3/Math.sqrt(v),a[S]=s*m*n[S],a[S+1]=e*m*n[S])}}function jj(l,n,a="x"){const o=Yy(a),s=l.length;let e,m,v,w=Ju(l,0);for(let N=0;N<s;++N){if(m=v,v=w,w=Ju(l,N+1),!v)continue;const S=v[a],D=v[o];m&&(e=(S-m[a])/3,v[`cp1${a}`]=S-e,v[`cp1${o}`]=D-e*n[N]),w&&(e=(w[a]-S)/3,v[`cp2${a}`]=S+e,v[`cp2${o}`]=D+e*n[N])}}function Nj(l,n="x"){const a=Yy(n),o=l.length,s=Array(o).fill(0),e=Array(o);let m,v,w,N=Ju(l,0);for(m=0;m<o;++m)if(v=w,w=N,N=Ju(l,m+1),!!w){if(N){const S=N[n]-w[n];s[m]=S!==0?(N[a]-w[a])/S:0}e[m]=v?N?$l(s[m-1])!==$l(s[m])?0:(s[m-1]+s[m])/2:s[m-1]:s[m]}wj(l,s,e),jj(l,e,n)}function Gg(l,n,a){return Math.max(Math.min(l,a),n)}function kj(l,n){let a,o,s,e,m,v=om(l[0],n);for(a=0,o=l.length;a<o;++a)m=e,e=v,v=a<o-1&&om(l[a+1],n),e&&(s=l[a],m&&(s.cp1x=Gg(s.cp1x,n.left,n.right),s.cp1y=Gg(s.cp1y,n.top,n.bottom)),v&&(s.cp2x=Gg(s.cp2x,n.left,n.right),s.cp2y=Gg(s.cp2y,n.top,n.bottom)))}function Cj(l,n,a,o,s){let e,m,v,w;if(n.spanGaps&&(l=l.filter(N=>!N.skip)),n.cubicInterpolationMode==="monotone")Nj(l,s);else{let N=o?l[l.length-1]:l[0];for(e=0,m=l.length;e<m;++e)v=l[e],w=vj(N,v,l[Math.min(e+1,m-(o?0:1))%m],n.tension),v.cp1x=w.previous.x,v.cp1y=w.previous.y,v.cp2x=w.next.x,v.cp2y=w.next.y,N=v}n.capBezierPoints&&kj(l,a)}function Nx(){return typeof window<"u"&&typeof document<"u"}function kx(l){let n=l.parentNode;return n&&n.toString()==="[object ShadowRoot]"&&(n=n.host),n}function jp(l,n,a){let o;return typeof l=="string"?(o=parseInt(l,10),l.indexOf("%")!==-1&&(o=o/100*n.parentNode[a])):o=l,o}const Rp=l=>l.ownerDocument.defaultView.getComputedStyle(l,null);function Sj(l,n){return Rp(l).getPropertyValue(n)}const Aj=["top","right","bottom","left"];function s0(l,n,a){const o={};a=a?"-"+a:"";for(let s=0;s<4;s++){const e=Aj[s];o[e]=parseFloat(l[n+"-"+e+a])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const Ej=(l,n,a)=>(l>0||n>0)&&(!a||!a.shadowRoot);function Dj(l,n){const a=l.touches,o=a&&a.length?a[0]:l,{offsetX:s,offsetY:e}=o;let m=!1,v,w;if(Ej(s,e,l.target))v=s,w=e;else{const N=n.getBoundingClientRect();v=o.clientX-N.left,w=o.clientY-N.top,m=!0}return{x:v,y:w,box:m}}function Xd(l,n){if("native"in l)return l;const{canvas:a,currentDevicePixelRatio:o}=n,s=Rp(a),e=s.boxSizing==="border-box",m=s0(s,"padding"),v=s0(s,"border","width"),{x:w,y:N,box:S}=Dj(l,a),D=m.left+(S&&v.left),L=m.top+(S&&v.top);let{width:M,height:F}=n;return e&&(M-=m.width+v.width,F-=m.height+v.height),{x:Math.round((w-D)/M*a.width/o),y:Math.round((N-L)/F*a.height/o)}}function Tj(l,n,a){let o,s;if(n===void 0||a===void 0){const e=l&&kx(l);if(!e)n=l.clientWidth,a=l.clientHeight;else{const m=e.getBoundingClientRect(),v=Rp(e),w=s0(v,"border","width"),N=s0(v,"padding");n=m.width-N.width-w.width,a=m.height-N.height-w.height,o=jp(v.maxWidth,e,"clientWidth"),s=jp(v.maxHeight,e,"clientHeight")}}return{width:n,height:a,maxWidth:o||vp,maxHeight:s||vp}}const Oc=l=>Math.round(l*10)/10;function _j(l,n,a,o){const s=Rp(l),e=s0(s,"margin"),m=jp(s.maxWidth,l,"clientWidth")||vp,v=jp(s.maxHeight,l,"clientHeight")||vp,w=Tj(l,n,a);let{width:N,height:S}=w;if(s.boxSizing==="content-box"){const L=s0(s,"border","width"),M=s0(s,"padding");N-=M.width+L.width,S-=M.height+L.height}return N=Math.max(0,N-e.width),S=Math.max(0,o?N/o:S-e.height),N=Oc(Math.min(N,m,w.maxWidth)),S=Oc(Math.min(S,v,w.maxHeight)),N&&!S&&(S=Oc(N/2)),(n!==void 0||a!==void 0)&&o&&w.height&&S>w.height&&(S=w.height,N=Oc(Math.floor(S*o))),{width:N,height:S}}function N2(l,n,a){const o=n||1,s=Oc(l.height*o),e=Oc(l.width*o);l.height=Oc(l.height),l.width=Oc(l.width);const m=l.canvas;return m.style&&(a||!m.style.height&&!m.style.width)&&(m.style.height=`${l.height}px`,m.style.width=`${l.width}px`),l.currentDevicePixelRatio!==o||m.height!==s||m.width!==e?(l.currentDevicePixelRatio=o,m.height=s,m.width=e,l.ctx.setTransform(o,0,0,o,0,0),!0):!1}const Fj=(function(){let l=!1;try{const n={get passive(){return l=!0,!1}};Nx()&&(window.addEventListener("test",null,n),window.removeEventListener("test",null,n))}catch{}return l})();function k2(l,n){const a=Sj(l,n),o=a&&a.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:void 0}function Jd(l,n,a,o){return{x:l.x+a*(n.x-l.x),y:l.y+a*(n.y-l.y)}}function Mj(l,n,a,o){return{x:l.x+a*(n.x-l.x),y:o==="middle"?a<.5?l.y:n.y:o==="after"?a<1?l.y:n.y:a>0?n.y:l.y}}function Lj(l,n,a,o){const s={x:l.cp2x,y:l.cp2y},e={x:n.cp1x,y:n.cp1y},m=Jd(l,s,a),v=Jd(s,e,a),w=Jd(e,n,a),N=Jd(m,v,a),S=Jd(v,w,a);return Jd(N,S,a)}const Rj=function(l,n){return{x(a){return l+l+n-a},setWidth(a){n=a},textAlign(a){return a==="center"?a:a==="right"?"left":"right"},xPlus(a,o){return a-o},leftForLtr(a,o){return a-o}}},Oj=function(){return{x(l){return l},setWidth(l){},textAlign(l){return l},xPlus(l,n){return l+n},leftForLtr(l,n){return l}}};function Gu(l,n,a){return l?Rj(n,a):Oj()}function Gy(l,n){let a,o;(n==="ltr"||n==="rtl")&&(a=l.canvas.style,o=[a.getPropertyValue("direction"),a.getPropertyPriority("direction")],a.setProperty("direction",n,"important"),l.prevTextDirection=o)}function Ky(l,n){n!==void 0&&(delete l.prevTextDirection,l.canvas.style.setProperty("direction",n[0],n[1]))}function Qy(l){return l==="angle"?{between:lm,compare:P3,normalize:ti}:{between:Lo,compare:(n,a)=>n-a,normalize:n=>n}}function C2({start:l,end:n,count:a,loop:o,style:s}){return{start:l%a,end:n%a,loop:o&&(n-l+1)%a===0,style:s}}function Pj(l,n,a){const{property:o,start:s,end:e}=a,{between:m,normalize:v}=Qy(o),w=n.length;let{start:N,end:S,loop:D}=l,L,M;if(D){for(N+=w,S+=w,L=0,M=w;L<M&&m(v(n[N%w][o]),s,e);++L)N--,S--;N%=w,S%=w}return S<N&&(S+=w),{start:N,end:S,loop:D,style:l.style}}function Xy(l,n,a){if(!a)return[l];const{property:o,start:s,end:e}=a,m=n.length,{compare:v,between:w,normalize:N}=Qy(o),{start:S,end:D,loop:L,style:M}=Pj(l,n,a),F=[];let O=!1,P=null,G,ae,re;const ke=()=>w(s,re,G)&&v(s,re)!==0,xe=()=>v(e,G)===0||w(e,re,G),je=()=>O||ke(),Z=()=>!O||xe();for(let ce=S,ue=S;ce<=D;++ce)ae=n[ce%m],!ae.skip&&(G=N(ae[o]),G!==re&&(O=w(G,s,e),P===null&&je()&&(P=v(G,s)===0?ce:ue),P!==null&&Z()&&(F.push(C2({start:P,end:ce,loop:L,count:m,style:M})),P=null),ue=ce,re=G));return P!==null&&F.push(C2({start:P,end:D,loop:L,count:m,style:M})),F}function Jy(l,n){const a=[],o=l.segments;for(let s=0;s<o.length;s++){const e=Xy(o[s],l.points,n);e.length&&a.push(...e)}return a}function Ij(l,n,a,o){let s=0,e=n-1;if(a&&!o)for(;s<n&&!l[s].skip;)s++;for(;s<n&&l[s].skip;)s++;for(s%=n,a&&(e+=s);e>s&&l[e%n].skip;)e--;return e%=n,{start:s,end:e}}function Bj(l,n,a,o){const s=l.length,e=[];let m=n,v=l[n],w;for(w=n+1;w<=a;++w){const N=l[w%s];N.skip||N.stop?v.skip||(o=!1,e.push({start:n%s,end:(w-1)%s,loop:o}),n=m=N.stop?w:null):(m=w,v.skip&&(n=w)),v=N}return m!==null&&e.push({start:n%s,end:m%s,loop:o}),e}function zj(l,n){const a=l.points,o=l.options.spanGaps,s=a.length;if(!s)return[];const e=!!l._loop,{start:m,end:v}=Ij(a,s,e,o);if(o===!0)return S2(l,[{start:m,end:v,loop:e}],a,n);const w=v<m?v+s:v,N=!!l._fullLoop&&m===0&&v===s-1;return S2(l,Bj(a,m,w,N),a,n)}function S2(l,n,a,o){return!o||!o.setContext||!a?n:Uj(l,n,a,o)}function Uj(l,n,a,o){const s=l._chart.getContext(),e=A2(l.options),{_datasetIndex:m,options:{spanGaps:v}}=l,w=a.length,N=[];let S=e,D=n[0].start,L=D;function M(F,O,P,G){const ae=v?-1:1;if(F!==O){for(F+=w;a[F%w].skip;)F-=ae;for(;a[O%w].skip;)O+=ae;F%w!==O%w&&(N.push({start:F%w,end:O%w,loop:P,style:G}),S=G,D=O%w)}}for(const F of n){D=v?D:F.start;let O=a[D%w],P;for(L=D+1;L<=F.end;L++){const G=a[L%w];P=A2(o.setContext(o0(s,{type:"segment",p0:O,p1:G,p0DataIndex:(L-1)%w,p1DataIndex:L%w,datasetIndex:m}))),Hj(P,S)&&M(D,L-1,F.loop,S),O=G,S=P}D<L-1&&M(D,L-1,F.loop,S)}return N}function A2(l){return{backgroundColor:l.backgroundColor,borderCapStyle:l.borderCapStyle,borderDash:l.borderDash,borderDashOffset:l.borderDashOffset,borderJoinStyle:l.borderJoinStyle,borderWidth:l.borderWidth,borderColor:l.borderColor}}function Hj(l,n){if(!n)return!1;const a=[],o=function(s,e){return bx(e)?(a.includes(e)||a.push(e),a.indexOf(e)):e};return JSON.stringify(l,o)!==JSON.stringify(n,o)}function Kg(l,n,a){return l.options.clip?l[a]:n[a]}function Vj(l,n){const{xScale:a,yScale:o}=l;return a&&o?{left:Kg(a,n,"left"),right:Kg(a,n,"right"),top:Kg(o,n,"top"),bottom:Kg(o,n,"bottom")}:n}function Zy(l,n){const a=n._clip;if(a.disabled)return!1;const o=Vj(n,l.chartArea);return{left:a.left===!1?0:o.left-(a.left===!0?0:a.left),right:a.right===!1?l.width:o.right+(a.right===!0?0:a.right),top:a.top===!1?0:o.top-(a.top===!0?0:a.top),bottom:a.bottom===!1?l.height:o.bottom+(a.bottom===!0?0:a.bottom)}}class Wj{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(n,a,o,s){const e=a.listeners[s],m=a.duration;e.forEach(v=>v({chart:n,initial:a.initial,numSteps:m,currentStep:Math.min(o-a.start,m)}))}_refresh(){this._request||(this._running=!0,this._request=Ry.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(n=Date.now()){let a=0;this._charts.forEach((o,s)=>{if(!o.running||!o.items.length)return;const e=o.items;let m=e.length-1,v=!1,w;for(;m>=0;--m)w=e[m],w._active?(w._total>o.duration&&(o.duration=w._total),w.tick(n),v=!0):(e[m]=e[e.length-1],e.pop());v&&(s.draw(),this._notify(s,o,n,"progress")),e.length||(o.running=!1,this._notify(s,o,n,"complete"),o.initial=!1),a+=e.length}),this._lastDate=n,a===0&&(this._running=!1)}_getAnims(n){const a=this._charts;let o=a.get(n);return o||(o={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},a.set(n,o)),o}listen(n,a,o){this._getAnims(n).listeners[a].push(o)}add(n,a){!a||!a.length||this._getAnims(n).items.push(...a)}has(n){return this._getAnims(n).items.length>0}start(n){const a=this._charts.get(n);a&&(a.running=!0,a.start=Date.now(),a.duration=a.items.reduce((o,s)=>Math.max(o,s._duration),0),this._refresh())}running(n){if(!this._running)return!1;const a=this._charts.get(n);return!(!a||!a.running||!a.items.length)}stop(n){const a=this._charts.get(n);if(!a||!a.items.length)return;const o=a.items;let s=o.length-1;for(;s>=0;--s)o[s].cancel();a.items=[],this._notify(n,a,Date.now(),"complete")}remove(n){return this._charts.delete(n)}}var To=new Wj;const E2="transparent",$j={boolean(l,n,a){return a>.5?n:l},color(l,n,a){const o=x2(l||E2),s=o.valid&&x2(n||E2);return s&&s.valid?s.mix(o,a).hexString():n},number(l,n,a){return l+(n-l)*a}};class qj{constructor(n,a,o,s){const e=a[o];s=Yg([n.to,s,e,n.from]);const m=Yg([n.from,e,s]);this._active=!0,this._fn=n.fn||$j[n.type||typeof m],this._easing=tm[n.easing]||tm.linear,this._start=Math.floor(Date.now()+(n.delay||0)),this._duration=this._total=Math.floor(n.duration),this._loop=!!n.loop,this._target=a,this._prop=o,this._from=m,this._to=s,this._promises=void 0}active(){return this._active}update(n,a,o){if(this._active){this._notify(!1);const s=this._target[this._prop],e=o-this._start,m=this._duration-e;this._start=o,this._duration=Math.floor(Math.max(m,n.duration)),this._total+=e,this._loop=!!n.loop,this._to=Yg([n.to,a,s,n.from]),this._from=Yg([n.from,s,a])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(n){const a=n-this._start,o=this._duration,s=this._prop,e=this._from,m=this._loop,v=this._to;let w;if(this._active=e!==v&&(m||a<o),!this._active){this._target[s]=v,this._notify(!0);return}if(a<0){this._target[s]=e;return}w=a/o%2,w=m&&w>1?2-w:w,w=this._easing(Math.min(1,Math.max(0,w))),this._target[s]=this._fn(e,v,w)}wait(){const n=this._promises||(this._promises=[]);return new Promise((a,o)=>{n.push({res:a,rej:o})})}_notify(n){const a=n?"res":"rej",o=this._promises||[];for(let s=0;s<o.length;s++)o[s][a]()}}class ev{constructor(n,a){this._chart=n,this._properties=new Map,this.configure(a)}configure(n){if(!Qs(n))return;const a=Object.keys(ma.animation),o=this._properties;Object.getOwnPropertyNames(n).forEach(s=>{const e=n[s];if(!Qs(e))return;const m={};for(const v of a)m[v]=e[v];(ja(e.properties)&&e.properties||[s]).forEach(v=>{(v===s||!o.has(v))&&o.set(v,m)})})}_animateOptions(n,a){const o=a.options,s=Gj(n,o);if(!s)return[];const e=this._createAnimations(s,o);return o.$shared&&Yj(n.options.$animations,o).then(()=>{n.options=o},()=>{}),e}_createAnimations(n,a){const o=this._properties,s=[],e=n.$animations||(n.$animations={}),m=Object.keys(a),v=Date.now();let w;for(w=m.length-1;w>=0;--w){const N=m[w];if(N.charAt(0)==="$")continue;if(N==="options"){s.push(...this._animateOptions(n,a));continue}const S=a[N];let D=e[N];const L=o.get(N);if(D)if(L&&D.active()){D.update(L,S,v);continue}else D.cancel();if(!L||!L.duration){n[N]=S;continue}e[N]=D=new qj(L,n,N,S),s.push(D)}return s}update(n,a){if(this._properties.size===0){Object.assign(n,a);return}const o=this._createAnimations(n,a);if(o.length)return To.add(this._chart,o),!0}}function Yj(l,n){const a=[],o=Object.keys(n);for(let s=0;s<o.length;s++){const e=l[o[s]];e&&e.active()&&a.push(e.wait())}return Promise.all(a)}function Gj(l,n){if(!n)return;let a=l.options;if(!a){l.options=n;return}return a.$shared&&(l.options=a=Object.assign({},a,{$shared:!1,$animations:{}})),a}function D2(l,n){const a=l&&l.options||{},o=a.reverse,s=a.min===void 0?n:0,e=a.max===void 0?n:0;return{start:o?e:s,end:o?s:e}}function Kj(l,n,a){if(a===!1)return!1;const o=D2(l,a),s=D2(n,a);return{top:s.end,right:o.end,bottom:s.start,left:o.start}}function Qj(l){let n,a,o,s;return Qs(l)?(n=l.top,a=l.right,o=l.bottom,s=l.left):n=a=o=s=l,{top:n,right:a,bottom:o,left:s,disabled:l===!1}}function tv(l,n){const a=[],o=l._getSortedDatasetMetas(n);let s,e;for(s=0,e=o.length;s<e;++s)a.push(o[s].index);return a}function T2(l,n,a,o={}){const s=l.keys,e=o.mode==="single";let m,v,w,N;if(n===null)return;let S=!1;for(m=0,v=s.length;m<v;++m){if(w=+s[m],w===a){if(S=!0,o.all)continue;break}N=l.values[w],an(N)&&(e||n===0||$l(n)===$l(N))&&(n+=N)}return!S&&!o.all?0:n}function Xj(l,n){const{iScale:a,vScale:o}=n,s=a.axis==="x"?"x":"y",e=o.axis==="x"?"x":"y",m=Object.keys(l),v=new Array(m.length);let w,N,S;for(w=0,N=m.length;w<N;++w)S=m[w],v[w]={[s]:S,[e]:l[S]};return v}function v1(l,n){const a=l&&l.options.stacked;return a||a===void 0&&n.stack!==void 0}function Jj(l,n,a){return`${l.id}.${n.id}.${a.stack||a.type}`}function Zj(l){const{min:n,max:a,minDefined:o,maxDefined:s}=l.getUserBounds();return{min:o?n:Number.NEGATIVE_INFINITY,max:s?a:Number.POSITIVE_INFINITY}}function e6(l,n,a){const o=l[n]||(l[n]={});return o[a]||(o[a]={})}function _2(l,n,a,o){for(const s of n.getMatchingVisibleMetas(o).reverse()){const e=l[s.index];if(a&&e>0||!a&&e<0)return s.index}return null}function F2(l,n){const{chart:a,_cachedMeta:o}=l,s=a._stacks||(a._stacks={}),{iScale:e,vScale:m,index:v}=o,w=e.axis,N=m.axis,S=Jj(e,m,o),D=n.length;let L;for(let M=0;M<D;++M){const F=n[M],{[w]:O,[N]:P}=F,G=F._stacks||(F._stacks={});L=G[N]=e6(s,S,O),L[v]=P,L._top=_2(L,m,!0,o.type),L._bottom=_2(L,m,!1,o.type);const ae=L._visualValues||(L._visualValues={});ae[v]=P}}function w1(l,n){const a=l.scales;return Object.keys(a).filter(o=>a[o].axis===n).shift()}function t6(l,n){return o0(l,{active:!1,dataset:void 0,datasetIndex:n,index:n,mode:"default",type:"dataset"})}function s6(l,n,a){return o0(l,{active:!1,dataIndex:n,parsed:void 0,raw:void 0,element:a,index:n,mode:"default",type:"data"})}function Vf(l,n){const a=l.controller.index,o=l.vScale&&l.vScale.axis;if(o){n=n||l._parsed;for(const s of n){const e=s._stacks;if(!e||e[o]===void 0||e[o][a]===void 0)return;delete e[o][a],e[o]._visualValues!==void 0&&e[o]._visualValues[a]!==void 0&&delete e[o]._visualValues[a]}}}const j1=l=>l==="reset"||l==="none",M2=(l,n)=>n?l:Object.assign({},l),r6=(l,n,a)=>l&&!n.hidden&&n._stacked&&{keys:tv(a,!0),values:null};class Uc{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(n,a){this.chart=n,this._ctx=n.ctx,this.index=a,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const n=this._cachedMeta;this.configure(),this.linkScales(),n._stacked=v1(n.vScale,n),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(n){this.index!==n&&Vf(this._cachedMeta),this.index=n}linkScales(){const n=this.chart,a=this._cachedMeta,o=this.getDataset(),s=(D,L,M,F)=>D==="x"?L:D==="r"?F:M,e=a.xAxisID=Ts(o.xAxisID,w1(n,"x")),m=a.yAxisID=Ts(o.yAxisID,w1(n,"y")),v=a.rAxisID=Ts(o.rAxisID,w1(n,"r")),w=a.indexAxis,N=a.iAxisID=s(w,e,m,v),S=a.vAxisID=s(w,m,e,v);a.xScale=this.getScaleForId(e),a.yScale=this.getScaleForId(m),a.rScale=this.getScaleForId(v),a.iScale=this.getScaleForId(N),a.vScale=this.getScaleForId(S)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(n){return this.chart.scales[n]}_getOtherScale(n){const a=this._cachedMeta;return n===a.iScale?a.vScale:a.iScale}reset(){this._update("reset")}_destroy(){const n=this._cachedMeta;this._data&&m2(this._data,this),n._stacked&&Vf(n)}_dataCheck(){const n=this.getDataset(),a=n.data||(n.data=[]),o=this._data;if(Qs(a)){const s=this._cachedMeta;this._data=Xj(a,s)}else if(o!==a){if(o){m2(o,this);const s=this._cachedMeta;Vf(s),s._parsed=[]}a&&Object.isExtensible(a)&&U3(a,this),this._syncList=[],this._data=a}}addElements(){const n=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(n.dataset=new this.datasetElementType)}buildOrUpdateElements(n){const a=this._cachedMeta,o=this.getDataset();let s=!1;this._dataCheck();const e=a._stacked;a._stacked=v1(a.vScale,a),a.stack!==o.stack&&(s=!0,Vf(a),a.stack=o.stack),this._resyncElements(n),(s||e!==a._stacked)&&(F2(this,a._parsed),a._stacked=v1(a.vScale,a))}configure(){const n=this.chart.config,a=n.datasetScopeKeys(this._type),o=n.getOptionScopes(this.getDataset(),a,!0);this.options=n.createResolver(o,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(n,a){const{_cachedMeta:o,_data:s}=this,{iScale:e,_stacked:m}=o,v=e.axis;let w=n===0&&a===s.length?!0:o._sorted,N=n>0&&o._parsed[n-1],S,D,L;if(this._parsing===!1)o._parsed=s,o._sorted=!0,L=s;else{ja(s[n])?L=this.parseArrayData(o,s,n,a):Qs(s[n])?L=this.parseObjectData(o,s,n,a):L=this.parsePrimitiveData(o,s,n,a);const M=()=>D[v]===null||N&&D[v]<N[v];for(S=0;S<a;++S)o._parsed[S+n]=D=L[S],w&&(M()&&(w=!1),N=D);o._sorted=w}m&&F2(this,L)}parsePrimitiveData(n,a,o,s){const{iScale:e,vScale:m}=n,v=e.axis,w=m.axis,N=e.getLabels(),S=e===m,D=new Array(s);let L,M,F;for(L=0,M=s;L<M;++L)F=L+o,D[L]={[v]:S||e.parse(N[F],F),[w]:m.parse(a[F],F)};return D}parseArrayData(n,a,o,s){const{xScale:e,yScale:m}=n,v=new Array(s);let w,N,S,D;for(w=0,N=s;w<N;++w)S=w+o,D=a[S],v[w]={x:e.parse(D[0],S),y:m.parse(D[1],S)};return v}parseObjectData(n,a,o,s){const{xScale:e,yScale:m}=n,{xAxisKey:v="x",yAxisKey:w="y"}=this._parsing,N=new Array(s);let S,D,L,M;for(S=0,D=s;S<D;++S)L=S+o,M=a[L],N[S]={x:e.parse(Bc(M,v),L),y:m.parse(Bc(M,w),L)};return N}getParsed(n){return this._cachedMeta._parsed[n]}getDataElement(n){return this._cachedMeta.data[n]}applyStack(n,a,o){const s=this.chart,e=this._cachedMeta,m=a[n.axis],v={keys:tv(s,!0),values:a._stacks[n.axis]._visualValues};return T2(v,m,e.index,{mode:o})}updateRangeFromParsed(n,a,o,s){const e=o[a.axis];let m=e===null?NaN:e;const v=s&&o._stacks[a.axis];s&&v&&(s.values=v,m=T2(s,e,this._cachedMeta.index)),n.min=Math.min(n.min,m),n.max=Math.max(n.max,m)}getMinMax(n,a){const o=this._cachedMeta,s=o._parsed,e=o._sorted&&n===o.iScale,m=s.length,v=this._getOtherScale(n),w=r6(a,o,this.chart),N={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:S,max:D}=Zj(v);let L,M;function F(){M=s[L];const O=M[v.axis];return!an(M[n.axis])||S>O||D<O}for(L=0;L<m&&!(!F()&&(this.updateRangeFromParsed(N,n,M,w),e));++L);if(e){for(L=m-1;L>=0;--L)if(!F()){this.updateRangeFromParsed(N,n,M,w);break}}return N}getAllParsedValues(n){const a=this._cachedMeta._parsed,o=[];let s,e,m;for(s=0,e=a.length;s<e;++s)m=a[s][n.axis],an(m)&&o.push(m);return o}getMaxOverflow(){return!1}getLabelAndValue(n){const a=this._cachedMeta,o=a.iScale,s=a.vScale,e=this.getParsed(n);return{label:o?""+o.getLabelForValue(e[o.axis]):"",value:s?""+s.getLabelForValue(e[s.axis]):""}}_update(n){const a=this._cachedMeta;this.update(n||"default"),a._clip=Qj(Ts(this.options.clip,Kj(a.xScale,a.yScale,this.getMaxOverflow())))}update(n){}draw(){const n=this._ctx,a=this.chart,o=this._cachedMeta,s=o.data||[],e=a.chartArea,m=[],v=this._drawStart||0,w=this._drawCount||s.length-v,N=this.options.drawActiveElementsOnTop;let S;for(o.dataset&&o.dataset.draw(n,e,v,w),S=v;S<v+w;++S){const D=s[S];D.hidden||(D.active&&N?m.push(D):D.draw(n,e))}for(S=0;S<m.length;++S)m[S].draw(n,e)}getStyle(n,a){const o=a?"active":"default";return n===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(o):this.resolveDataElementOptions(n||0,o)}getContext(n,a,o){const s=this.getDataset();let e;if(n>=0&&n<this._cachedMeta.data.length){const m=this._cachedMeta.data[n];e=m.$context||(m.$context=s6(this.getContext(),n,m)),e.parsed=this.getParsed(n),e.raw=s.data[n],e.index=e.dataIndex=n}else e=this.$context||(this.$context=t6(this.chart.getContext(),this.index)),e.dataset=s,e.index=e.datasetIndex=this.index;return e.active=!!a,e.mode=o,e}resolveDatasetElementOptions(n){return this._resolveElementOptions(this.datasetElementType.id,n)}resolveDataElementOptions(n,a){return this._resolveElementOptions(this.dataElementType.id,a,n)}_resolveElementOptions(n,a="default",o){const s=a==="active",e=this._cachedDataOpts,m=n+"-"+a,v=e[m],w=this.enableOptionSharing&&im(o);if(v)return M2(v,w);const N=this.chart.config,S=N.datasetElementScopeKeys(this._type,n),D=s?[`${n}Hover`,"hover",n,""]:[n,""],L=N.getOptionScopes(this.getDataset(),S),M=Object.keys(ma.elements[n]),F=()=>this.getContext(o,s,a),O=N.resolveNamedOptions(L,M,F,D);return O.$shared&&(O.$shared=w,e[m]=Object.freeze(M2(O,w))),O}_resolveAnimations(n,a,o){const s=this.chart,e=this._cachedDataOpts,m=`animation-${a}`,v=e[m];if(v)return v;let w;if(s.options.animation!==!1){const S=this.chart.config,D=S.datasetAnimationScopeKeys(this._type,a),L=S.getOptionScopes(this.getDataset(),D);w=S.createResolver(L,this.getContext(n,o,a))}const N=new ev(s,w&&w.animations);return w&&w._cacheable&&(e[m]=Object.freeze(N)),N}getSharedOptions(n){if(n.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},n))}includeOptions(n,a){return!a||j1(n)||this.chart._animationsDisabled}_getSharedOptions(n,a){const o=this.resolveDataElementOptions(n,a),s=this._sharedOptions,e=this.getSharedOptions(o),m=this.includeOptions(a,e)||e!==s;return this.updateSharedOptions(e,a,o),{sharedOptions:e,includeOptions:m}}updateElement(n,a,o,s){j1(s)?Object.assign(n,o):this._resolveAnimations(a,s).update(n,o)}updateSharedOptions(n,a,o){n&&!j1(a)&&this._resolveAnimations(void 0,a).update(n,o)}_setStyle(n,a,o,s){n.active=s;const e=this.getStyle(a,s);this._resolveAnimations(a,o,s).update(n,{options:!s&&this.getSharedOptions(e)||e})}removeHoverStyle(n,a,o){this._setStyle(n,o,"active",!1)}setHoverStyle(n,a,o){this._setStyle(n,o,"active",!0)}_removeDatasetHoverStyle(){const n=this._cachedMeta.dataset;n&&this._setStyle(n,void 0,"active",!1)}_setDatasetHoverStyle(){const n=this._cachedMeta.dataset;n&&this._setStyle(n,void 0,"active",!0)}_resyncElements(n){const a=this._data,o=this._cachedMeta.data;for(const[v,w,N]of this._syncList)this[v](w,N);this._syncList=[];const s=o.length,e=a.length,m=Math.min(e,s);m&&this.parse(0,m),e>s?this._insertElements(s,e-s,n):e<s&&this._removeElements(e,s-e)}_insertElements(n,a,o=!0){const s=this._cachedMeta,e=s.data,m=n+a;let v;const w=N=>{for(N.length+=a,v=N.length-1;v>=m;v--)N[v]=N[v-a]};for(w(e),v=n;v<m;++v)e[v]=new this.dataElementType;this._parsing&&w(s._parsed),this.parse(n,a),o&&this.updateElements(e,n,a,"reset")}updateElements(n,a,o,s){}_removeElements(n,a){const o=this._cachedMeta;if(this._parsing){const s=o._parsed.splice(n,a);o._stacked&&Vf(o,s)}o.data.splice(n,a)}_sync(n){if(this._parsing)this._syncList.push(n);else{const[a,o,s]=n;this[a](o,s)}this.chart._dataChanges.push([this.index,...n])}_onDataPush(){const n=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-n,n])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(n,a){a&&this._sync(["_removeElements",n,a]);const o=arguments.length-2;o&&this._sync(["_insertElements",n,o])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function a6(l,n){if(!l._cache.$bar){const a=l.getMatchingVisibleMetas(n);let o=[];for(let s=0,e=a.length;s<e;s++)o=o.concat(a[s].controller.getAllParsedValues(l));l._cache.$bar=Ly(o.sort((s,e)=>s-e))}return l._cache.$bar}function n6(l){const n=l.iScale,a=a6(n,l.type);let o=n._length,s,e,m,v;const w=()=>{m===32767||m===-32768||(im(v)&&(o=Math.min(o,Math.abs(m-v)||o)),v=m)};for(s=0,e=a.length;s<e;++s)m=n.getPixelForValue(a[s]),w();for(v=void 0,s=0,e=n.ticks.length;s<e;++s)m=n.getPixelForTick(s),w();return o}function i6(l,n,a,o){const s=a.barThickness;let e,m;return hr(s)?(e=n.min*a.categoryPercentage,m=a.barPercentage):(e=s*o,m=1),{chunk:e/o,ratio:m,start:n.pixels[l]-e/2}}function l6(l,n,a,o){const s=n.pixels,e=s[l];let m=l>0?s[l-1]:null,v=l<s.length-1?s[l+1]:null;const w=a.categoryPercentage;m===null&&(m=e-(v===null?n.end-n.start:v-e)),v===null&&(v=e+e-m);const N=e-(e-Math.min(m,v))/2*w;return{chunk:Math.abs(v-m)/2*w/o,ratio:a.barPercentage,start:N}}function o6(l,n,a,o){const s=a.parse(l[0],o),e=a.parse(l[1],o),m=Math.min(s,e),v=Math.max(s,e);let w=m,N=v;Math.abs(m)>Math.abs(v)&&(w=v,N=m),n[a.axis]=N,n._custom={barStart:w,barEnd:N,start:s,end:e,min:m,max:v}}function sv(l,n,a,o){return ja(l)?o6(l,n,a,o):n[a.axis]=a.parse(l,o),n}function L2(l,n,a,o){const s=l.iScale,e=l.vScale,m=s.getLabels(),v=s===e,w=[];let N,S,D,L;for(N=a,S=a+o;N<S;++N)L=n[N],D={},D[s.axis]=v||s.parse(m[N],N),w.push(sv(L,D,e,N));return w}function N1(l){return l&&l.barStart!==void 0&&l.barEnd!==void 0}function c6(l,n,a){return l!==0?$l(l):(n.isHorizontal()?1:-1)*(n.min>=a?1:-1)}function d6(l){let n,a,o,s,e;return l.horizontal?(n=l.base>l.x,a="left",o="right"):(n=l.base<l.y,a="bottom",o="top"),n?(s="end",e="start"):(s="start",e="end"),{start:a,end:o,reverse:n,top:s,bottom:e}}function u6(l,n,a,o){let s=n.borderSkipped;const e={};if(!s){l.borderSkipped=e;return}if(s===!0){l.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:m,end:v,reverse:w,top:N,bottom:S}=d6(l);s==="middle"&&a&&(l.enableBorderRadius=!0,(a._top||0)===o?s=N:(a._bottom||0)===o?s=S:(e[R2(S,m,v,w)]=!0,s=N)),e[R2(s,m,v,w)]=!0,l.borderSkipped=e}function R2(l,n,a,o){return o?(l=h6(l,n,a),l=O2(l,a,n)):l=O2(l,n,a),l}function h6(l,n,a){return l===n?a:l===a?n:l}function O2(l,n,a){return l==="start"?n:l==="end"?a:l}function f6(l,{inflateAmount:n},a){l.inflateAmount=n==="auto"?a===1?.33:0:n}class m6 extends Uc{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(n,a,o,s){return L2(n,a,o,s)}parseArrayData(n,a,o,s){return L2(n,a,o,s)}parseObjectData(n,a,o,s){const{iScale:e,vScale:m}=n,{xAxisKey:v="x",yAxisKey:w="y"}=this._parsing,N=e.axis==="x"?v:w,S=m.axis==="x"?v:w,D=[];let L,M,F,O;for(L=o,M=o+s;L<M;++L)O=a[L],F={},F[e.axis]=e.parse(Bc(O,N),L),D.push(sv(Bc(O,S),F,m,L));return D}updateRangeFromParsed(n,a,o,s){super.updateRangeFromParsed(n,a,o,s);const e=o._custom;e&&a===this._cachedMeta.vScale&&(n.min=Math.min(n.min,e.min),n.max=Math.max(n.max,e.max))}getMaxOverflow(){return 0}getLabelAndValue(n){const a=this._cachedMeta,{iScale:o,vScale:s}=a,e=this.getParsed(n),m=e._custom,v=N1(m)?"["+m.start+", "+m.end+"]":""+s.getLabelForValue(e[s.axis]);return{label:""+o.getLabelForValue(e[o.axis]),value:v}}initialize(){this.enableOptionSharing=!0,super.initialize();const n=this._cachedMeta;n.stack=this.getDataset().stack}update(n){const a=this._cachedMeta;this.updateElements(a.data,0,a.data.length,n)}updateElements(n,a,o,s){const e=s==="reset",{index:m,_cachedMeta:{vScale:v}}=this,w=v.getBasePixel(),N=v.isHorizontal(),S=this._getRuler(),{sharedOptions:D,includeOptions:L}=this._getSharedOptions(a,s);for(let M=a;M<a+o;M++){const F=this.getParsed(M),O=e||hr(F[v.axis])?{base:w,head:w}:this._calculateBarValuePixels(M),P=this._calculateBarIndexPixels(M,S),G=(F._stacks||{})[v.axis],ae={horizontal:N,base:O.base,enableBorderRadius:!G||N1(F._custom)||m===G._top||m===G._bottom,x:N?O.head:P.center,y:N?P.center:O.head,height:N?P.size:Math.abs(O.size),width:N?Math.abs(O.size):P.size};L&&(ae.options=D||this.resolveDataElementOptions(M,n[M].active?"active":s));const re=ae.options||n[M].options;u6(ae,re,G,m),f6(ae,re,S.ratio),this.updateElement(n[M],M,ae,s)}}_getStacks(n,a){const{iScale:o}=this._cachedMeta,s=o.getMatchingVisibleMetas(this._type).filter(S=>S.controller.options.grouped),e=o.options.stacked,m=[],v=this._cachedMeta.controller.getParsed(a),w=v&&v[o.axis],N=S=>{const D=S._parsed.find(M=>M[o.axis]===w),L=D&&D[S.vScale.axis];if(hr(L)||isNaN(L))return!0};for(const S of s)if(!(a!==void 0&&N(S))&&((e===!1||m.indexOf(S.stack)===-1||e===void 0&&S.stack===void 0)&&m.push(S.stack),S.index===n))break;return m.length||m.push(void 0),m}_getStackCount(n){return this._getStacks(void 0,n).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const n=this.chart.scales,a=this.chart.options.indexAxis;return Object.keys(n).filter(o=>n[o].axis===a).shift()}_getAxis(){const n={},a=this.getFirstScaleIdForIndexAxis();for(const o of this.chart.data.datasets)n[Ts(this.chart.options.indexAxis==="x"?o.xAxisID:o.yAxisID,a)]=!0;return Object.keys(n)}_getStackIndex(n,a,o){const s=this._getStacks(n,o),e=a!==void 0?s.indexOf(a):-1;return e===-1?s.length-1:e}_getRuler(){const n=this.options,a=this._cachedMeta,o=a.iScale,s=[];let e,m;for(e=0,m=a.data.length;e<m;++e)s.push(o.getPixelForValue(this.getParsed(e)[o.axis],e));const v=n.barThickness;return{min:v||n6(a),pixels:s,start:o._startPixel,end:o._endPixel,stackCount:this._getStackCount(),scale:o,grouped:n.grouped,ratio:v?1:n.categoryPercentage*n.barPercentage}}_calculateBarValuePixels(n){const{_cachedMeta:{vScale:a,_stacked:o,index:s},options:{base:e,minBarLength:m}}=this,v=e||0,w=this.getParsed(n),N=w._custom,S=N1(N);let D=w[a.axis],L=0,M=o?this.applyStack(a,w,o):D,F,O;M!==D&&(L=M-D,M=D),S&&(D=N.barStart,M=N.barEnd-N.barStart,D!==0&&$l(D)!==$l(N.barEnd)&&(L=0),L+=D);const P=!hr(e)&&!S?e:L;let G=a.getPixelForValue(P);if(this.chart.getDataVisibility(n)?F=a.getPixelForValue(L+M):F=G,O=F-G,Math.abs(O)<m){O=c6(O,a,v)*m,D===v&&(G-=O/2);const ae=a.getPixelForDecimal(0),re=a.getPixelForDecimal(1),ke=Math.min(ae,re),xe=Math.max(ae,re);G=Math.max(Math.min(G,xe),ke),F=G+O,o&&!S&&(w._stacks[a.axis]._visualValues[s]=a.getValueForPixel(F)-a.getValueForPixel(G))}if(G===a.getPixelForValue(v)){const ae=$l(O)*a.getLineWidthForValue(v)/2;G+=ae,O-=ae}return{size:O,base:G,head:F,center:F+O/2}}_calculateBarIndexPixels(n,a){const o=a.scale,s=this.options,e=s.skipNull,m=Ts(s.maxBarThickness,1/0);let v,w;const N=this._getAxisCount();if(a.grouped){const S=e?this._getStackCount(n):a.stackCount,D=s.barThickness==="flex"?l6(n,a,s,S*N):i6(n,a,s,S*N),L=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,M=this._getAxis().indexOf(Ts(L,this.getFirstScaleIdForIndexAxis())),F=this._getStackIndex(this.index,this._cachedMeta.stack,e?n:void 0)+M;v=D.start+D.chunk*F+D.chunk/2,w=Math.min(m,D.chunk*D.ratio)}else v=o.getPixelForValue(this.getParsed(n)[o.axis],n),w=Math.min(m,a.min*a.ratio);return{base:v-w/2,head:v+w/2,center:v,size:w}}draw(){const n=this._cachedMeta,a=n.vScale,o=n.data,s=o.length;let e=0;for(;e<s;++e)this.getParsed(e)[a.axis]!==null&&!o[e].hidden&&o[e].draw(this._ctx)}}class g6 extends Uc{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(n,a,o,s){const e=super.parsePrimitiveData(n,a,o,s);for(let m=0;m<e.length;m++)e[m]._custom=this.resolveDataElementOptions(m+o).radius;return e}parseArrayData(n,a,o,s){const e=super.parseArrayData(n,a,o,s);for(let m=0;m<e.length;m++){const v=a[o+m];e[m]._custom=Ts(v[2],this.resolveDataElementOptions(m+o).radius)}return e}parseObjectData(n,a,o,s){const e=super.parseObjectData(n,a,o,s);for(let m=0;m<e.length;m++){const v=a[o+m];e[m]._custom=Ts(v&&v.r&&+v.r,this.resolveDataElementOptions(m+o).radius)}return e}getMaxOverflow(){const n=this._cachedMeta.data;let a=0;for(let o=n.length-1;o>=0;--o)a=Math.max(a,n[o].size(this.resolveDataElementOptions(o))/2);return a>0&&a}getLabelAndValue(n){const a=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:e}=a,m=this.getParsed(n),v=s.getLabelForValue(m.x),w=e.getLabelForValue(m.y),N=m._custom;return{label:o[n]||"",value:"("+v+", "+w+(N?", "+N:"")+")"}}update(n){const a=this._cachedMeta.data;this.updateElements(a,0,a.length,n)}updateElements(n,a,o,s){const e=s==="reset",{iScale:m,vScale:v}=this._cachedMeta,{sharedOptions:w,includeOptions:N}=this._getSharedOptions(a,s),S=m.axis,D=v.axis;for(let L=a;L<a+o;L++){const M=n[L],F=!e&&this.getParsed(L),O={},P=O[S]=e?m.getPixelForDecimal(.5):m.getPixelForValue(F[S]),G=O[D]=e?v.getBasePixel():v.getPixelForValue(F[D]);O.skip=isNaN(P)||isNaN(G),N&&(O.options=w||this.resolveDataElementOptions(L,M.active?"active":s),e&&(O.options.radius=0)),this.updateElement(M,L,O,s)}}resolveDataElementOptions(n,a){const o=this.getParsed(n);let s=super.resolveDataElementOptions(n,a);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const e=s.radius;return a!=="active"&&(s.radius=0),s.radius+=Ts(o&&o._custom,e),s}}function p6(l,n,a){let o=1,s=1,e=0,m=0;if(n<ta){const v=l,w=v+n,N=Math.cos(v),S=Math.sin(v),D=Math.cos(w),L=Math.sin(w),M=(re,ke,xe)=>lm(re,v,w,!0)?1:Math.max(ke,ke*a,xe,xe*a),F=(re,ke,xe)=>lm(re,v,w,!0)?-1:Math.min(ke,ke*a,xe,xe*a),O=M(0,N,D),P=M(Aa,S,L),G=F(pr,N,D),ae=F(pr+Aa,S,L);o=(O-G)/2,s=(P-ae)/2,e=-(O+G)/2,m=-(P+ae)/2}return{ratioX:o,ratioY:s,offsetX:e,offsetY:m}}class rv extends Uc{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:n=>n!=="spacing",_indexable:n=>n!=="spacing"&&!n.startsWith("borderDash")&&!n.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const a=n.data,{labels:{pointStyle:o,textAlign:s,color:e,useBorderRadius:m,borderRadius:v}}=n.legend.options;return a.labels.length&&a.datasets.length?a.labels.map((w,N)=>{const D=n.getDatasetMeta(0).controller.getStyle(N);return{text:w,fillStyle:D.backgroundColor,fontColor:e,hidden:!n.getDataVisibility(N),lineDash:D.borderDash,lineDashOffset:D.borderDashOffset,lineJoin:D.borderJoinStyle,lineWidth:D.borderWidth,strokeStyle:D.borderColor,textAlign:s,pointStyle:o,borderRadius:m&&(v||D.borderRadius),index:N}}):[]}},onClick(n,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}}};constructor(n,a){super(n,a),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(n,a){const o=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=o;else{let e=w=>+o[w];if(Qs(o[n])){const{key:w="value"}=this._parsing;e=N=>+Bc(o[N],w)}let m,v;for(m=n,v=n+a;m<v;++m)s._parsed[m]=e(m)}}_getRotation(){return Wl(this.options.rotation-90)}_getCircumference(){return Wl(this.options.circumference)}_getRotationExtents(){let n=ta,a=-ta;for(let o=0;o<this.chart.data.datasets.length;++o)if(this.chart.isDatasetVisible(o)&&this.chart.getDatasetMeta(o).type===this._type){const s=this.chart.getDatasetMeta(o).controller,e=s._getRotation(),m=s._getCircumference();n=Math.min(n,e),a=Math.max(a,e+m)}return{rotation:n,circumference:a-n}}update(n){const a=this.chart,{chartArea:o}=a,s=this._cachedMeta,e=s.data,m=this.getMaxBorderWidth()+this.getMaxOffset(e)+this.options.spacing,v=Math.max((Math.min(o.width,o.height)-m)/2,0),w=Math.min(k3(this.options.cutout,v),1),N=this._getRingWeight(this.index),{circumference:S,rotation:D}=this._getRotationExtents(),{ratioX:L,ratioY:M,offsetX:F,offsetY:O}=p6(D,S,w),P=(o.width-m)/L,G=(o.height-m)/M,ae=Math.max(Math.min(P,G)/2,0),re=Dy(this.options.radius,ae),ke=Math.max(re*w,0),xe=(re-ke)/this._getVisibleDatasetWeightTotal();this.offsetX=F*re,this.offsetY=O*re,s.total=this.calculateTotal(),this.outerRadius=re-xe*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-xe*N,0),this.updateElements(e,0,e.length,n)}_circumference(n,a){const o=this.options,s=this._cachedMeta,e=this._getCircumference();return a&&o.animation.animateRotate||!this.chart.getDataVisibility(n)||s._parsed[n]===null||s.data[n].hidden?0:this.calculateCircumference(s._parsed[n]*e/ta)}updateElements(n,a,o,s){const e=s==="reset",m=this.chart,v=m.chartArea,N=m.options.animation,S=(v.left+v.right)/2,D=(v.top+v.bottom)/2,L=e&&N.animateScale,M=L?0:this.innerRadius,F=L?0:this.outerRadius,{sharedOptions:O,includeOptions:P}=this._getSharedOptions(a,s);let G=this._getRotation(),ae;for(ae=0;ae<a;++ae)G+=this._circumference(ae,e);for(ae=a;ae<a+o;++ae){const re=this._circumference(ae,e),ke=n[ae],xe={x:S+this.offsetX,y:D+this.offsetY,startAngle:G,endAngle:G+re,circumference:re,outerRadius:F,innerRadius:M};P&&(xe.options=O||this.resolveDataElementOptions(ae,ke.active?"active":s)),G+=re,this.updateElement(ke,ae,xe,s)}}calculateTotal(){const n=this._cachedMeta,a=n.data;let o=0,s;for(s=0;s<a.length;s++){const e=n._parsed[s];e!==null&&!isNaN(e)&&this.chart.getDataVisibility(s)&&!a[s].hidden&&(o+=Math.abs(e))}return o}calculateCircumference(n){const a=this._cachedMeta.total;return a>0&&!isNaN(n)?ta*(Math.abs(n)/a):0}getLabelAndValue(n){const a=this._cachedMeta,o=this.chart,s=o.data.labels||[],e=Fp(a._parsed[n],o.options.locale);return{label:s[n]||"",value:e}}getMaxBorderWidth(n){let a=0;const o=this.chart;let s,e,m,v,w;if(!n){for(s=0,e=o.data.datasets.length;s<e;++s)if(o.isDatasetVisible(s)){m=o.getDatasetMeta(s),n=m.data,v=m.controller;break}}if(!n)return 0;for(s=0,e=n.length;s<e;++s)w=v.resolveDataElementOptions(s),w.borderAlign!=="inner"&&(a=Math.max(a,w.borderWidth||0,w.hoverBorderWidth||0));return a}getMaxOffset(n){let a=0;for(let o=0,s=n.length;o<s;++o){const e=this.resolveDataElementOptions(o);a=Math.max(a,e.offset||0,e.hoverOffset||0)}return a}_getRingWeightOffset(n){let a=0;for(let o=0;o<n;++o)this.chart.isDatasetVisible(o)&&(a+=this._getRingWeight(o));return a}_getRingWeight(n){return Math.max(Ts(this.chart.data.datasets[n].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class x6 extends Uc{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(n){const a=this._cachedMeta,{dataset:o,data:s=[],_dataset:e}=a,m=this.chart._animationsDisabled;let{start:v,count:w}=Py(a,s,m);this._drawStart=v,this._drawCount=w,Iy(a)&&(v=0,w=s.length),o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!e._decimated,o.points=s;const N=this.resolveDatasetElementOptions(n);this.options.showLine||(N.borderWidth=0),N.segment=this.options.segment,this.updateElement(o,void 0,{animated:!m,options:N},n),this.updateElements(s,v,w,n)}updateElements(n,a,o,s){const e=s==="reset",{iScale:m,vScale:v,_stacked:w,_dataset:N}=this._cachedMeta,{sharedOptions:S,includeOptions:D}=this._getSharedOptions(a,s),L=m.axis,M=v.axis,{spanGaps:F,segment:O}=this.options,P=Qu(F)?F:Number.POSITIVE_INFINITY,G=this.chart._animationsDisabled||e||s==="none",ae=a+o,re=n.length;let ke=a>0&&this.getParsed(a-1);for(let xe=0;xe<re;++xe){const je=n[xe],Z=G?je:{};if(xe<a||xe>=ae){Z.skip=!0;continue}const ce=this.getParsed(xe),ue=hr(ce[M]),Re=Z[L]=m.getPixelForValue(ce[L],xe),be=Z[M]=e||ue?v.getBasePixel():v.getPixelForValue(w?this.applyStack(v,ce,w):ce[M],xe);Z.skip=isNaN(Re)||isNaN(be)||ue,Z.stop=xe>0&&Math.abs(ce[L]-ke[L])>P,O&&(Z.parsed=ce,Z.raw=N.data[xe]),D&&(Z.options=S||this.resolveDataElementOptions(xe,je.active?"active":s)),G||this.updateElement(je,xe,Z,s),ke=ce}}getMaxOverflow(){const n=this._cachedMeta,a=n.dataset,o=a.options&&a.options.borderWidth||0,s=n.data||[];if(!s.length)return o;const e=s[0].size(this.resolveDataElementOptions(0)),m=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(o,e,m)/2}draw(){const n=this._cachedMeta;n.dataset.updateControlPoints(this.chart.chartArea,n.iScale.axis),super.draw()}}class b6 extends Uc{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const a=n.data;if(a.labels.length&&a.datasets.length){const{labels:{pointStyle:o,color:s}}=n.legend.options;return a.labels.map((e,m)=>{const w=n.getDatasetMeta(0).controller.getStyle(m);return{text:e,fillStyle:w.backgroundColor,strokeStyle:w.borderColor,fontColor:s,lineWidth:w.borderWidth,pointStyle:o,hidden:!n.getDataVisibility(m),index:m}})}return[]}},onClick(n,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(n,a){super(n,a),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(n){const a=this._cachedMeta,o=this.chart,s=o.data.labels||[],e=Fp(a._parsed[n].r,o.options.locale);return{label:s[n]||"",value:e}}parseObjectData(n,a,o,s){return qy.bind(this)(n,a,o,s)}update(n){const a=this._cachedMeta.data;this._updateRadius(),this.updateElements(a,0,a.length,n)}getMinMax(){const n=this._cachedMeta,a={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return n.data.forEach((o,s)=>{const e=this.getParsed(s).r;!isNaN(e)&&this.chart.getDataVisibility(s)&&(e<a.min&&(a.min=e),e>a.max&&(a.max=e))}),a}_updateRadius(){const n=this.chart,a=n.chartArea,o=n.options,s=Math.min(a.right-a.left,a.bottom-a.top),e=Math.max(s/2,0),m=Math.max(o.cutoutPercentage?e/100*o.cutoutPercentage:1,0),v=(e-m)/n.getVisibleDatasetCount();this.outerRadius=e-v*this.index,this.innerRadius=this.outerRadius-v}updateElements(n,a,o,s){const e=s==="reset",m=this.chart,w=m.options.animation,N=this._cachedMeta.rScale,S=N.xCenter,D=N.yCenter,L=N.getIndexAngle(0)-.5*pr;let M=L,F;const O=360/this.countVisibleElements();for(F=0;F<a;++F)M+=this._computeAngle(F,s,O);for(F=a;F<a+o;F++){const P=n[F];let G=M,ae=M+this._computeAngle(F,s,O),re=m.getDataVisibility(F)?N.getDistanceFromCenterForValue(this.getParsed(F).r):0;M=ae,e&&(w.animateScale&&(re=0),w.animateRotate&&(G=ae=L));const ke={x:S,y:D,innerRadius:0,outerRadius:re,startAngle:G,endAngle:ae,options:this.resolveDataElementOptions(F,P.active?"active":s)};this.updateElement(P,F,ke,s)}}countVisibleElements(){const n=this._cachedMeta;let a=0;return n.data.forEach((o,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&a++}),a}_computeAngle(n,a,o){return this.chart.getDataVisibility(n)?Wl(this.resolveDataElementOptions(n,a).angle||o):0}}class y6 extends rv{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class v6 extends Uc{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(n){const a=this._cachedMeta.vScale,o=this.getParsed(n);return{label:a.getLabels()[n],value:""+a.getLabelForValue(o[a.axis])}}parseObjectData(n,a,o,s){return qy.bind(this)(n,a,o,s)}update(n){const a=this._cachedMeta,o=a.dataset,s=a.data||[],e=a.iScale.getLabels();if(o.points=s,n!=="resize"){const m=this.resolveDatasetElementOptions(n);this.options.showLine||(m.borderWidth=0);const v={_loop:!0,_fullLoop:e.length===s.length,options:m};this.updateElement(o,void 0,v,n)}this.updateElements(s,0,s.length,n)}updateElements(n,a,o,s){const e=this._cachedMeta.rScale,m=s==="reset";for(let v=a;v<a+o;v++){const w=n[v],N=this.resolveDataElementOptions(v,w.active?"active":s),S=e.getPointPositionForValue(v,this.getParsed(v).r),D=m?e.xCenter:S.x,L=m?e.yCenter:S.y,M={x:D,y:L,angle:S.angle,skip:isNaN(D)||isNaN(L),options:N};this.updateElement(w,v,M,s)}}}class w6 extends Uc{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(n){const a=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:e}=a,m=this.getParsed(n),v=s.getLabelForValue(m.x),w=e.getLabelForValue(m.y);return{label:o[n]||"",value:"("+v+", "+w+")"}}update(n){const a=this._cachedMeta,{data:o=[]}=a,s=this.chart._animationsDisabled;let{start:e,count:m}=Py(a,o,s);if(this._drawStart=e,this._drawCount=m,Iy(a)&&(e=0,m=o.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:v,_dataset:w}=a;v._chart=this.chart,v._datasetIndex=this.index,v._decimated=!!w._decimated,v.points=o;const N=this.resolveDatasetElementOptions(n);N.segment=this.options.segment,this.updateElement(v,void 0,{animated:!s,options:N},n)}else this.datasetElementType&&(delete a.dataset,this.datasetElementType=!1);this.updateElements(o,e,m,n)}addElements(){const{showLine:n}=this.options;!this.datasetElementType&&n&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(n,a,o,s){const e=s==="reset",{iScale:m,vScale:v,_stacked:w,_dataset:N}=this._cachedMeta,S=this.resolveDataElementOptions(a,s),D=this.getSharedOptions(S),L=this.includeOptions(s,D),M=m.axis,F=v.axis,{spanGaps:O,segment:P}=this.options,G=Qu(O)?O:Number.POSITIVE_INFINITY,ae=this.chart._animationsDisabled||e||s==="none";let re=a>0&&this.getParsed(a-1);for(let ke=a;ke<a+o;++ke){const xe=n[ke],je=this.getParsed(ke),Z=ae?xe:{},ce=hr(je[F]),ue=Z[M]=m.getPixelForValue(je[M],ke),Re=Z[F]=e||ce?v.getBasePixel():v.getPixelForValue(w?this.applyStack(v,je,w):je[F],ke);Z.skip=isNaN(ue)||isNaN(Re)||ce,Z.stop=ke>0&&Math.abs(je[M]-re[M])>G,P&&(Z.parsed=je,Z.raw=N.data[ke]),L&&(Z.options=D||this.resolveDataElementOptions(ke,xe.active?"active":s)),ae||this.updateElement(xe,ke,Z,s),re=je}this.updateSharedOptions(D,s,S)}getMaxOverflow(){const n=this._cachedMeta,a=n.data||[];if(!this.options.showLine){let v=0;for(let w=a.length-1;w>=0;--w)v=Math.max(v,a[w].size(this.resolveDataElementOptions(w))/2);return v>0&&v}const o=n.dataset,s=o.options&&o.options.borderWidth||0;if(!a.length)return s;const e=a[0].size(this.resolveDataElementOptions(0)),m=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(s,e,m)/2}}function Qd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Cx{static override(n){Object.assign(Cx.prototype,n)}options;constructor(n){this.options=n||{}}init(){}formats(){return Qd()}parse(){return Qd()}format(){return Qd()}add(){return Qd()}diff(){return Qd()}startOf(){return Qd()}endOf(){return Qd()}}var j6={_date:Cx};function N6(l,n,a,o){const{controller:s,data:e,_sorted:m}=l,v=s._cachedMeta.iScale,w=l.dataset&&l.dataset.options?l.dataset.options.spanGaps:null;if(v&&n===v.axis&&n!=="r"&&m&&e.length){const N=v._reversePixels?B3:e0;if(o){if(s._sharedOptions){const S=e[0],D=typeof S.getRange=="function"&&S.getRange(n);if(D){const L=N(e,n,a-D),M=N(e,n,a+D);return{lo:L.lo,hi:M.hi}}}}else{const S=N(e,n,a);if(w){const{vScale:D}=s._cachedMeta,{_parsed:L}=l,M=L.slice(0,S.lo+1).reverse().findIndex(O=>!hr(O[D.axis]));S.lo-=Math.max(0,M);const F=L.slice(S.hi).findIndex(O=>!hr(O[D.axis]));S.hi+=Math.max(0,F)}return S}}return{lo:0,hi:e.length-1}}function Op(l,n,a,o,s){const e=l.getSortedVisibleDatasetMetas(),m=a[n];for(let v=0,w=e.length;v<w;++v){const{index:N,data:S}=e[v],{lo:D,hi:L}=N6(e[v],n,m,s);for(let M=D;M<=L;++M){const F=S[M];F.skip||o(F,N,M)}}}function k6(l){const n=l.indexOf("x")!==-1,a=l.indexOf("y")!==-1;return function(o,s){const e=n?Math.abs(o.x-s.x):0,m=a?Math.abs(o.y-s.y):0;return Math.sqrt(Math.pow(e,2)+Math.pow(m,2))}}function k1(l,n,a,o,s){const e=[];return!s&&!l.isPointInArea(n)||Op(l,a,n,function(v,w,N){!s&&!om(v,l.chartArea,0)||v.inRange(n.x,n.y,o)&&e.push({element:v,datasetIndex:w,index:N})},!0),e}function C6(l,n,a,o){let s=[];function e(m,v,w){const{startAngle:N,endAngle:S}=m.getProps(["startAngle","endAngle"],o),{angle:D}=Fy(m,{x:n.x,y:n.y});lm(D,N,S)&&s.push({element:m,datasetIndex:v,index:w})}return Op(l,a,n,e),s}function S6(l,n,a,o,s,e){let m=[];const v=k6(a);let w=Number.POSITIVE_INFINITY;function N(S,D,L){const M=S.inRange(n.x,n.y,s);if(o&&!M)return;const F=S.getCenterPoint(s);if(!(!!e||l.isPointInArea(F))&&!M)return;const P=v(n,F);P<w?(m=[{element:S,datasetIndex:D,index:L}],w=P):P===w&&m.push({element:S,datasetIndex:D,index:L})}return Op(l,a,n,N),m}function C1(l,n,a,o,s,e){return!e&&!l.isPointInArea(n)?[]:a==="r"&&!o?C6(l,n,a,s):S6(l,n,a,o,s,e)}function P2(l,n,a,o,s){const e=[],m=a==="x"?"inXRange":"inYRange";let v=!1;return Op(l,a,n,(w,N,S)=>{w[m]&&w[m](n[a],s)&&(e.push({element:w,datasetIndex:N,index:S}),v=v||w.inRange(n.x,n.y,s))}),o&&!v?[]:e}var A6={modes:{index(l,n,a,o){const s=Xd(n,l),e=a.axis||"x",m=a.includeInvisible||!1,v=a.intersect?k1(l,s,e,o,m):C1(l,s,e,!1,o,m),w=[];return v.length?(l.getSortedVisibleDatasetMetas().forEach(N=>{const S=v[0].index,D=N.data[S];D&&!D.skip&&w.push({element:D,datasetIndex:N.index,index:S})}),w):[]},dataset(l,n,a,o){const s=Xd(n,l),e=a.axis||"xy",m=a.includeInvisible||!1;let v=a.intersect?k1(l,s,e,o,m):C1(l,s,e,!1,o,m);if(v.length>0){const w=v[0].datasetIndex,N=l.getDatasetMeta(w).data;v=[];for(let S=0;S<N.length;++S)v.push({element:N[S],datasetIndex:w,index:S})}return v},point(l,n,a,o){const s=Xd(n,l),e=a.axis||"xy",m=a.includeInvisible||!1;return k1(l,s,e,o,m)},nearest(l,n,a,o){const s=Xd(n,l),e=a.axis||"xy",m=a.includeInvisible||!1;return C1(l,s,e,a.intersect,o,m)},x(l,n,a,o){const s=Xd(n,l);return P2(l,s,"x",a.intersect,o)},y(l,n,a,o){const s=Xd(n,l);return P2(l,s,"y",a.intersect,o)}}};const av=["left","top","right","bottom"];function Wf(l,n){return l.filter(a=>a.pos===n)}function I2(l,n){return l.filter(a=>av.indexOf(a.pos)===-1&&a.box.axis===n)}function $f(l,n){return l.sort((a,o)=>{const s=n?o:a,e=n?a:o;return s.weight===e.weight?s.index-e.index:s.weight-e.weight})}function E6(l){const n=[];let a,o,s,e,m,v;for(a=0,o=(l||[]).length;a<o;++a)s=l[a],{position:e,options:{stack:m,stackWeight:v=1}}=s,n.push({index:a,box:s,pos:e,horizontal:s.isHorizontal(),weight:s.weight,stack:m&&e+m,stackWeight:v});return n}function D6(l){const n={};for(const a of l){const{stack:o,pos:s,stackWeight:e}=a;if(!o||!av.includes(s))continue;const m=n[o]||(n[o]={count:0,placed:0,weight:0,size:0});m.count++,m.weight+=e}return n}function T6(l,n){const a=D6(l),{vBoxMaxWidth:o,hBoxMaxHeight:s}=n;let e,m,v;for(e=0,m=l.length;e<m;++e){v=l[e];const{fullSize:w}=v.box,N=a[v.stack],S=N&&v.stackWeight/N.weight;v.horizontal?(v.width=S?S*o:w&&n.availableWidth,v.height=s):(v.width=o,v.height=S?S*s:w&&n.availableHeight)}return a}function _6(l){const n=E6(l),a=$f(n.filter(N=>N.box.fullSize),!0),o=$f(Wf(n,"left"),!0),s=$f(Wf(n,"right")),e=$f(Wf(n,"top"),!0),m=$f(Wf(n,"bottom")),v=I2(n,"x"),w=I2(n,"y");return{fullSize:a,leftAndTop:o.concat(e),rightAndBottom:s.concat(w).concat(m).concat(v),chartArea:Wf(n,"chartArea"),vertical:o.concat(s).concat(w),horizontal:e.concat(m).concat(v)}}function B2(l,n,a,o){return Math.max(l[a],n[a])+Math.max(l[o],n[o])}function nv(l,n){l.top=Math.max(l.top,n.top),l.left=Math.max(l.left,n.left),l.bottom=Math.max(l.bottom,n.bottom),l.right=Math.max(l.right,n.right)}function F6(l,n,a,o){const{pos:s,box:e}=a,m=l.maxPadding;if(!Qs(s)){a.size&&(l[s]-=a.size);const D=o[a.stack]||{size:0,count:1};D.size=Math.max(D.size,a.horizontal?e.height:e.width),a.size=D.size/D.count,l[s]+=a.size}e.getPadding&&nv(m,e.getPadding());const v=Math.max(0,n.outerWidth-B2(m,l,"left","right")),w=Math.max(0,n.outerHeight-B2(m,l,"top","bottom")),N=v!==l.w,S=w!==l.h;return l.w=v,l.h=w,a.horizontal?{same:N,other:S}:{same:S,other:N}}function M6(l){const n=l.maxPadding;function a(o){const s=Math.max(n[o]-l[o],0);return l[o]+=s,s}l.y+=a("top"),l.x+=a("left"),a("right"),a("bottom")}function L6(l,n){const a=n.maxPadding;function o(s){const e={left:0,top:0,right:0,bottom:0};return s.forEach(m=>{e[m]=Math.max(n[m],a[m])}),e}return o(l?["left","right"]:["top","bottom"])}function Xf(l,n,a,o){const s=[];let e,m,v,w,N,S;for(e=0,m=l.length,N=0;e<m;++e){v=l[e],w=v.box,w.update(v.width||n.w,v.height||n.h,L6(v.horizontal,n));const{same:D,other:L}=F6(n,a,v,o);N|=D&&s.length,S=S||L,w.fullSize||s.push(v)}return N&&Xf(s,n,a,o)||S}function Qg(l,n,a,o,s){l.top=a,l.left=n,l.right=n+o,l.bottom=a+s,l.width=o,l.height=s}function z2(l,n,a,o){const s=a.padding;let{x:e,y:m}=n;for(const v of l){const w=v.box,N=o[v.stack]||{placed:0,weight:1},S=v.stackWeight/N.weight||1;if(v.horizontal){const D=n.w*S,L=N.size||w.height;im(N.start)&&(m=N.start),w.fullSize?Qg(w,s.left,m,a.outerWidth-s.right-s.left,L):Qg(w,n.left+N.placed,m,D,L),N.start=m,N.placed+=D,m=w.bottom}else{const D=n.h*S,L=N.size||w.width;im(N.start)&&(e=N.start),w.fullSize?Qg(w,e,s.top,L,a.outerHeight-s.bottom-s.top):Qg(w,e,n.top+N.placed,L,D),N.start=e,N.placed+=D,e=w.right}}n.x=e,n.y=m}var ji={addBox(l,n){l.boxes||(l.boxes=[]),n.fullSize=n.fullSize||!1,n.position=n.position||"top",n.weight=n.weight||0,n._layers=n._layers||function(){return[{z:0,draw(a){n.draw(a)}}]},l.boxes.push(n)},removeBox(l,n){const a=l.boxes?l.boxes.indexOf(n):-1;a!==-1&&l.boxes.splice(a,1)},configure(l,n,a){n.fullSize=a.fullSize,n.position=a.position,n.weight=a.weight},update(l,n,a,o){if(!l)return;const s=Ni(l.options.layout.padding),e=Math.max(n-s.width,0),m=Math.max(a-s.height,0),v=_6(l.boxes),w=v.vertical,N=v.horizontal;vr(l.boxes,O=>{typeof O.beforeLayout=="function"&&O.beforeLayout()});const S=w.reduce((O,P)=>P.box.options&&P.box.options.display===!1?O:O+1,0)||1,D=Object.freeze({outerWidth:n,outerHeight:a,padding:s,availableWidth:e,availableHeight:m,vBoxMaxWidth:e/2/S,hBoxMaxHeight:m/2}),L=Object.assign({},s);nv(L,Ni(o));const M=Object.assign({maxPadding:L,w:e,h:m,x:s.left,y:s.top},s),F=T6(w.concat(N),D);Xf(v.fullSize,M,D,F),Xf(w,M,D,F),Xf(N,M,D,F)&&Xf(w,M,D,F),M6(M),z2(v.leftAndTop,M,D,F),M.x+=M.w,M.y+=M.h,z2(v.rightAndBottom,M,D,F),l.chartArea={left:M.left,top:M.top,right:M.left+M.w,bottom:M.top+M.h,height:M.h,width:M.w},vr(v.chartArea,O=>{const P=O.box;Object.assign(P,l.chartArea),P.update(M.w,M.h,{left:0,top:0,right:0,bottom:0})})}};class iv{acquireContext(n,a){}releaseContext(n){return!1}addEventListener(n,a,o){}removeEventListener(n,a,o){}getDevicePixelRatio(){return 1}getMaximumSize(n,a,o,s){return a=Math.max(0,a||n.width),o=o||n.height,{width:a,height:Math.max(0,s?Math.floor(a/s):o)}}isAttached(n){return!0}updateConfig(n){}}class R6 extends iv{acquireContext(n){return n&&n.getContext&&n.getContext("2d")||null}updateConfig(n){n.options.animation=!1}}const up="$chartjs",O6={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},U2=l=>l===null||l==="";function P6(l,n){const a=l.style,o=l.getAttribute("height"),s=l.getAttribute("width");if(l[up]={initial:{height:o,width:s,style:{display:a.display,height:a.height,width:a.width}}},a.display=a.display||"block",a.boxSizing=a.boxSizing||"border-box",U2(s)){const e=k2(l,"width");e!==void 0&&(l.width=e)}if(U2(o))if(l.style.height==="")l.height=l.width/(n||2);else{const e=k2(l,"height");e!==void 0&&(l.height=e)}return l}const lv=Fj?{passive:!0}:!1;function I6(l,n,a){l&&l.addEventListener(n,a,lv)}function B6(l,n,a){l&&l.canvas&&l.canvas.removeEventListener(n,a,lv)}function z6(l,n){const a=O6[l.type]||l.type,{x:o,y:s}=Xd(l,n);return{type:a,chart:n,native:l,x:o!==void 0?o:null,y:s!==void 0?s:null}}function Np(l,n){for(const a of l)if(a===n||a.contains(n))return!0}function U6(l,n,a){const o=l.canvas,s=new MutationObserver(e=>{let m=!1;for(const v of e)m=m||Np(v.addedNodes,o),m=m&&!Np(v.removedNodes,o);m&&a()});return s.observe(document,{childList:!0,subtree:!0}),s}function H6(l,n,a){const o=l.canvas,s=new MutationObserver(e=>{let m=!1;for(const v of e)m=m||Np(v.removedNodes,o),m=m&&!Np(v.addedNodes,o);m&&a()});return s.observe(document,{childList:!0,subtree:!0}),s}const dm=new Map;let H2=0;function ov(){const l=window.devicePixelRatio;l!==H2&&(H2=l,dm.forEach((n,a)=>{a.currentDevicePixelRatio!==l&&n()}))}function V6(l,n){dm.size||window.addEventListener("resize",ov),dm.set(l,n)}function W6(l){dm.delete(l),dm.size||window.removeEventListener("resize",ov)}function $6(l,n,a){const o=l.canvas,s=o&&kx(o);if(!s)return;const e=Oy((v,w)=>{const N=s.clientWidth;a(v,w),N<s.clientWidth&&a()},window),m=new ResizeObserver(v=>{const w=v[0],N=w.contentRect.width,S=w.contentRect.height;N===0&&S===0||e(N,S)});return m.observe(s),V6(l,e),m}function S1(l,n,a){a&&a.disconnect(),n==="resize"&&W6(l)}function q6(l,n,a){const o=l.canvas,s=Oy(e=>{l.ctx!==null&&a(z6(e,l))},l);return I6(o,n,s),s}class Y6 extends iv{acquireContext(n,a){const o=n&&n.getContext&&n.getContext("2d");return o&&o.canvas===n?(P6(n,a),o):null}releaseContext(n){const a=n.canvas;if(!a[up])return!1;const o=a[up].initial;["height","width"].forEach(e=>{const m=o[e];hr(m)?a.removeAttribute(e):a.setAttribute(e,m)});const s=o.style||{};return Object.keys(s).forEach(e=>{a.style[e]=s[e]}),a.width=a.width,delete a[up],!0}addEventListener(n,a,o){this.removeEventListener(n,a);const s=n.$proxies||(n.$proxies={}),m={attach:U6,detach:H6,resize:$6}[a]||q6;s[a]=m(n,a,o)}removeEventListener(n,a){const o=n.$proxies||(n.$proxies={}),s=o[a];if(!s)return;({attach:S1,detach:S1,resize:S1}[a]||B6)(n,a,s),o[a]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(n,a,o,s){return _j(n,a,o,s)}isAttached(n){const a=n&&kx(n);return!!(a&&a.isConnected)}}function G6(l){return!Nx()||typeof OffscreenCanvas<"u"&&l instanceof OffscreenCanvas?R6:Y6}class Po{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(n){const{x:a,y:o}=this.getProps(["x","y"],n);return{x:a,y:o}}hasValue(){return Qu(this.x)&&Qu(this.y)}getProps(n,a){const o=this.$animations;if(!a||!o)return this;const s={};return n.forEach(e=>{s[e]=o[e]&&o[e].active()?o[e]._to:this[e]}),s}}function K6(l,n){const a=l.options.ticks,o=Q6(l),s=Math.min(a.maxTicksLimit||o,o),e=a.major.enabled?J6(n):[],m=e.length,v=e[0],w=e[m-1],N=[];if(m>s)return Z6(n,N,e,m/s),N;const S=X6(e,n,s);if(m>0){let D,L;const M=m>1?Math.round((w-v)/(m-1)):null;for(Xg(n,N,S,hr(M)?0:v-M,v),D=0,L=m-1;D<L;D++)Xg(n,N,S,e[D],e[D+1]);return Xg(n,N,S,w,hr(M)?n.length:w+M),N}return Xg(n,N,S),N}function Q6(l){const n=l.options.offset,a=l._tickSize(),o=l._length/a+(n?0:1),s=l._maxLength/a;return Math.floor(Math.min(o,s))}function X6(l,n,a){const o=eN(l),s=n.length/a;if(!o)return Math.max(s,1);const e=F3(o);for(let m=0,v=e.length-1;m<v;m++){const w=e[m];if(w>s)return w}return Math.max(s,1)}function J6(l){const n=[];let a,o;for(a=0,o=l.length;a<o;a++)l[a].major&&n.push(a);return n}function Z6(l,n,a,o){let s=0,e=a[0],m;for(o=Math.ceil(o),m=0;m<l.length;m++)m===e&&(n.push(l[m]),s++,e=a[s*o])}function Xg(l,n,a,o,s){const e=Ts(o,0),m=Math.min(Ts(s,l.length),l.length);let v=0,w,N,S;for(a=Math.ceil(a),s&&(w=s-o,a=w/Math.floor(w/a)),S=e;S<0;)v++,S=Math.round(e+v*a);for(N=Math.max(e,0);N<m;N++)N===S&&(n.push(l[N]),v++,S=Math.round(e+v*a))}function eN(l){const n=l.length;let a,o;if(n<2)return!1;for(o=l[0],a=1;a<n;++a)if(l[a]-l[a-1]!==o)return!1;return o}const tN=l=>l==="left"?"right":l==="right"?"left":l,V2=(l,n,a)=>n==="top"||n==="left"?l[n]+a:l[n]-a,W2=(l,n)=>Math.min(n||l,l);function $2(l,n){const a=[],o=l.length/n,s=l.length;let e=0;for(;e<s;e+=o)a.push(l[Math.floor(e)]);return a}function sN(l,n,a){const o=l.ticks.length,s=Math.min(n,o-1),e=l._startPixel,m=l._endPixel,v=1e-6;let w=l.getPixelForTick(s),N;if(!(a&&(o===1?N=Math.max(w-e,m-w):n===0?N=(l.getPixelForTick(1)-w)/2:N=(w-l.getPixelForTick(s-1))/2,w+=s<n?N:-N,w<e-v||w>m+v)))return w}function rN(l,n){vr(l,a=>{const o=a.gc,s=o.length/2;let e;if(s>n){for(e=0;e<s;++e)delete a.data[o[e]];o.splice(0,s)}})}function qf(l){return l.drawTicks?l.tickLength:0}function q2(l,n){if(!l.display)return 0;const a=rn(l.font,n),o=Ni(l.padding);return(ja(l.text)?l.text.length:1)*a.lineHeight+o.height}function aN(l,n){return o0(l,{scale:n,type:"scale"})}function nN(l,n,a){return o0(l,{tick:a,index:n,type:"tick"})}function iN(l,n,a){let o=xx(l);return(a&&n!=="right"||!a&&n==="right")&&(o=tN(o)),o}function lN(l,n,a,o){const{top:s,left:e,bottom:m,right:v,chart:w}=l,{chartArea:N,scales:S}=w;let D=0,L,M,F;const O=m-s,P=v-e;if(l.isHorizontal()){if(M=en(o,e,v),Qs(a)){const G=Object.keys(a)[0],ae=a[G];F=S[G].getPixelForValue(ae)+O-n}else a==="center"?F=(N.bottom+N.top)/2+O-n:F=V2(l,a,n);L=v-e}else{if(Qs(a)){const G=Object.keys(a)[0],ae=a[G];M=S[G].getPixelForValue(ae)-P+n}else a==="center"?M=(N.left+N.right)/2-P+n:M=V2(l,a,n);F=en(o,m,s),D=a==="left"?-Aa:Aa}return{titleX:M,titleY:F,maxWidth:L,rotation:D}}class ah extends Po{constructor(n){super(),this.id=n.id,this.type=n.type,this.options=void 0,this.ctx=n.ctx,this.chart=n.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(n){this.options=n.setContext(this.getContext()),this.axis=n.axis,this._userMin=this.parse(n.min),this._userMax=this.parse(n.max),this._suggestedMin=this.parse(n.suggestedMin),this._suggestedMax=this.parse(n.suggestedMax)}parse(n,a){return n}getUserBounds(){let{_userMin:n,_userMax:a,_suggestedMin:o,_suggestedMax:s}=this;return n=Ul(n,Number.POSITIVE_INFINITY),a=Ul(a,Number.NEGATIVE_INFINITY),o=Ul(o,Number.POSITIVE_INFINITY),s=Ul(s,Number.NEGATIVE_INFINITY),{min:Ul(n,o),max:Ul(a,s),minDefined:an(n),maxDefined:an(a)}}getMinMax(n){let{min:a,max:o,minDefined:s,maxDefined:e}=this.getUserBounds(),m;if(s&&e)return{min:a,max:o};const v=this.getMatchingVisibleMetas();for(let w=0,N=v.length;w<N;++w)m=v[w].controller.getMinMax(this,n),s||(a=Math.min(a,m.min)),e||(o=Math.max(o,m.max));return a=e&&a>o?o:a,o=s&&a>o?a:o,{min:Ul(a,Ul(o,a)),max:Ul(o,Ul(a,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const n=this.chart.data;return this.options.labels||(this.isHorizontal()?n.xLabels:n.yLabels)||n.labels||[]}getLabelItems(n=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(n))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Hr(this.options.beforeUpdate,[this])}update(n,a,o){const{beginAtZero:s,grace:e,ticks:m}=this.options,v=m.sampleSize;this.beforeUpdate(),this.maxWidth=n,this.maxHeight=a,this._margins=o=Object.assign({left:0,right:0,top:0,bottom:0},o),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+o.left+o.right:this.height+o.top+o.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=cj(this,e,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const w=v<this.ticks.length;this._convertTicksToLabels(w?$2(this.ticks,v):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),m.display&&(m.autoSkip||m.source==="auto")&&(this.ticks=K6(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),w&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let n=this.options.reverse,a,o;this.isHorizontal()?(a=this.left,o=this.right):(a=this.top,o=this.bottom,n=!n),this._startPixel=a,this._endPixel=o,this._reversePixels=n,this._length=o-a,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Hr(this.options.afterUpdate,[this])}beforeSetDimensions(){Hr(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Hr(this.options.afterSetDimensions,[this])}_callHooks(n){this.chart.notifyPlugins(n,this.getContext()),Hr(this.options[n],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Hr(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(n){const a=this.options.ticks;let o,s,e;for(o=0,s=n.length;o<s;o++)e=n[o],e.label=Hr(a.callback,[e.value,o,n],this)}afterTickToLabelConversion(){Hr(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Hr(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const n=this.options,a=n.ticks,o=W2(this.ticks.length,n.ticks.maxTicksLimit),s=a.minRotation||0,e=a.maxRotation;let m=s,v,w,N;if(!this._isVisible()||!a.display||s>=e||o<=1||!this.isHorizontal()){this.labelRotation=s;return}const S=this._getLabelSizes(),D=S.widest.width,L=S.highest.height,M=sn(this.chart.width-D,0,this.maxWidth);v=n.offset?this.maxWidth/o:M/(o-1),D+6>v&&(v=M/(o-(n.offset?.5:1)),w=this.maxHeight-qf(n.grid)-a.padding-q2(n.title,this.chart.options.font),N=Math.sqrt(D*D+L*L),m=O3(Math.min(Math.asin(sn((S.highest.height+6)/v,-1,1)),Math.asin(sn(w/N,-1,1))-Math.asin(sn(L/N,-1,1)))),m=Math.max(s,Math.min(e,m))),this.labelRotation=m}afterCalculateLabelRotation(){Hr(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Hr(this.options.beforeFit,[this])}fit(){const n={width:0,height:0},{chart:a,options:{ticks:o,title:s,grid:e}}=this,m=this._isVisible(),v=this.isHorizontal();if(m){const w=q2(s,a.options.font);if(v?(n.width=this.maxWidth,n.height=qf(e)+w):(n.height=this.maxHeight,n.width=qf(e)+w),o.display&&this.ticks.length){const{first:N,last:S,widest:D,highest:L}=this._getLabelSizes(),M=o.padding*2,F=Wl(this.labelRotation),O=Math.cos(F),P=Math.sin(F);if(v){const G=o.mirror?0:P*D.width+O*L.height;n.height=Math.min(this.maxHeight,n.height+G+M)}else{const G=o.mirror?0:O*D.width+P*L.height;n.width=Math.min(this.maxWidth,n.width+G+M)}this._calculatePadding(N,S,P,O)}}this._handleMargins(),v?(this.width=this._length=a.width-this._margins.left-this._margins.right,this.height=n.height):(this.width=n.width,this.height=this._length=a.height-this._margins.top-this._margins.bottom)}_calculatePadding(n,a,o,s){const{ticks:{align:e,padding:m},position:v}=this.options,w=this.labelRotation!==0,N=v!=="top"&&this.axis==="x";if(this.isHorizontal()){const S=this.getPixelForTick(0)-this.left,D=this.right-this.getPixelForTick(this.ticks.length-1);let L=0,M=0;w?N?(L=s*n.width,M=o*a.height):(L=o*n.height,M=s*a.width):e==="start"?M=a.width:e==="end"?L=n.width:e!=="inner"&&(L=n.width/2,M=a.width/2),this.paddingLeft=Math.max((L-S+m)*this.width/(this.width-S),0),this.paddingRight=Math.max((M-D+m)*this.width/(this.width-D),0)}else{let S=a.height/2,D=n.height/2;e==="start"?(S=0,D=n.height):e==="end"&&(S=a.height,D=0),this.paddingTop=S+m,this.paddingBottom=D+m}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Hr(this.options.afterFit,[this])}isHorizontal(){const{axis:n,position:a}=this.options;return a==="top"||a==="bottom"||n==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(n){this.beforeTickToLabelConversion(),this.generateTickLabels(n);let a,o;for(a=0,o=n.length;a<o;a++)hr(n[a].label)&&(n.splice(a,1),o--,a--);this.afterTickToLabelConversion()}_getLabelSizes(){let n=this._labelSizes;if(!n){const a=this.options.ticks.sampleSize;let o=this.ticks;a<o.length&&(o=$2(o,a)),this._labelSizes=n=this._computeLabelSizes(o,o.length,this.options.ticks.maxTicksLimit)}return n}_computeLabelSizes(n,a,o){const{ctx:s,_longestTextCache:e}=this,m=[],v=[],w=Math.floor(a/W2(a,o));let N=0,S=0,D,L,M,F,O,P,G,ae,re,ke,xe;for(D=0;D<a;D+=w){if(F=n[D].label,O=this._resolveTickFontOptions(D),s.font=P=O.string,G=e[P]=e[P]||{data:{},gc:[]},ae=O.lineHeight,re=ke=0,!hr(F)&&!ja(F))re=y2(s,G.data,G.gc,re,F),ke=ae;else if(ja(F))for(L=0,M=F.length;L<M;++L)xe=F[L],!hr(xe)&&!ja(xe)&&(re=y2(s,G.data,G.gc,re,xe),ke+=ae);m.push(re),v.push(ke),N=Math.max(re,N),S=Math.max(ke,S)}rN(e,a);const je=m.indexOf(N),Z=v.indexOf(S),ce=ue=>({width:m[ue]||0,height:v[ue]||0});return{first:ce(0),last:ce(a-1),widest:ce(je),highest:ce(Z),widths:m,heights:v}}getLabelForValue(n){return n}getPixelForValue(n,a){return NaN}getValueForPixel(n){}getPixelForTick(n){const a=this.ticks;return n<0||n>a.length-1?null:this.getPixelForValue(a[n].value)}getPixelForDecimal(n){this._reversePixels&&(n=1-n);const a=this._startPixel+n*this._length;return I3(this._alignToPixels?Kd(this.chart,a,0):a)}getDecimalForPixel(n){const a=(n-this._startPixel)/this._length;return this._reversePixels?1-a:a}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:n,max:a}=this;return n<0&&a<0?a:n>0&&a>0?n:0}getContext(n){const a=this.ticks||[];if(n>=0&&n<a.length){const o=a[n];return o.$context||(o.$context=nN(this.getContext(),n,o))}return this.$context||(this.$context=aN(this.chart.getContext(),this))}_tickSize(){const n=this.options.ticks,a=Wl(this.labelRotation),o=Math.abs(Math.cos(a)),s=Math.abs(Math.sin(a)),e=this._getLabelSizes(),m=n.autoSkipPadding||0,v=e?e.widest.width+m:0,w=e?e.highest.height+m:0;return this.isHorizontal()?w*o>v*s?v/o:w/s:w*s<v*o?w/o:v/s}_isVisible(){const n=this.options.display;return n!=="auto"?!!n:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(n){const a=this.axis,o=this.chart,s=this.options,{grid:e,position:m,border:v}=s,w=e.offset,N=this.isHorizontal(),D=this.ticks.length+(w?1:0),L=qf(e),M=[],F=v.setContext(this.getContext()),O=F.display?F.width:0,P=O/2,G=function(fe){return Kd(o,fe,O)};let ae,re,ke,xe,je,Z,ce,ue,Re,be,oe,he;if(m==="top")ae=G(this.bottom),Z=this.bottom-L,ue=ae-P,be=G(n.top)+P,he=n.bottom;else if(m==="bottom")ae=G(this.top),be=n.top,he=G(n.bottom)-P,Z=ae+P,ue=this.top+L;else if(m==="left")ae=G(this.right),je=this.right-L,ce=ae-P,Re=G(n.left)+P,oe=n.right;else if(m==="right")ae=G(this.left),Re=n.left,oe=G(n.right)-P,je=ae+P,ce=this.left+L;else if(a==="x"){if(m==="center")ae=G((n.top+n.bottom)/2+.5);else if(Qs(m)){const fe=Object.keys(m)[0],_e=m[fe];ae=G(this.chart.scales[fe].getPixelForValue(_e))}be=n.top,he=n.bottom,Z=ae+P,ue=Z+L}else if(a==="y"){if(m==="center")ae=G((n.left+n.right)/2);else if(Qs(m)){const fe=Object.keys(m)[0],_e=m[fe];ae=G(this.chart.scales[fe].getPixelForValue(_e))}je=ae-P,ce=je-L,Re=n.left,oe=n.right}const ye=Ts(s.ticks.maxTicksLimit,D),Te=Math.max(1,Math.ceil(D/ye));for(re=0;re<D;re+=Te){const fe=this.getContext(re),_e=e.setContext(fe),We=v.setContext(fe),te=_e.lineWidth,me=_e.color,W=We.dash||[],pe=We.dashOffset,Le=_e.tickWidth,Ae=_e.tickColor,V=_e.tickBorderDash||[],H=_e.tickBorderDashOffset;ke=sN(this,re,w),ke!==void 0&&(xe=Kd(o,ke,te),N?je=ce=Re=oe=xe:Z=ue=be=he=xe,M.push({tx1:je,ty1:Z,tx2:ce,ty2:ue,x1:Re,y1:be,x2:oe,y2:he,width:te,color:me,borderDash:W,borderDashOffset:pe,tickWidth:Le,tickColor:Ae,tickBorderDash:V,tickBorderDashOffset:H}))}return this._ticksLength=D,this._borderValue=ae,M}_computeLabelItems(n){const a=this.axis,o=this.options,{position:s,ticks:e}=o,m=this.isHorizontal(),v=this.ticks,{align:w,crossAlign:N,padding:S,mirror:D}=e,L=qf(o.grid),M=L+S,F=D?-S:M,O=-Wl(this.labelRotation),P=[];let G,ae,re,ke,xe,je,Z,ce,ue,Re,be,oe,he="middle";if(s==="top")je=this.bottom-F,Z=this._getXAxisLabelAlignment();else if(s==="bottom")je=this.top+F,Z=this._getXAxisLabelAlignment();else if(s==="left"){const Te=this._getYAxisLabelAlignment(L);Z=Te.textAlign,xe=Te.x}else if(s==="right"){const Te=this._getYAxisLabelAlignment(L);Z=Te.textAlign,xe=Te.x}else if(a==="x"){if(s==="center")je=(n.top+n.bottom)/2+M;else if(Qs(s)){const Te=Object.keys(s)[0],fe=s[Te];je=this.chart.scales[Te].getPixelForValue(fe)+M}Z=this._getXAxisLabelAlignment()}else if(a==="y"){if(s==="center")xe=(n.left+n.right)/2-M;else if(Qs(s)){const Te=Object.keys(s)[0],fe=s[Te];xe=this.chart.scales[Te].getPixelForValue(fe)}Z=this._getYAxisLabelAlignment(L).textAlign}a==="y"&&(w==="start"?he="top":w==="end"&&(he="bottom"));const ye=this._getLabelSizes();for(G=0,ae=v.length;G<ae;++G){re=v[G],ke=re.label;const Te=e.setContext(this.getContext(G));ce=this.getPixelForTick(G)+e.labelOffset,ue=this._resolveTickFontOptions(G),Re=ue.lineHeight,be=ja(ke)?ke.length:1;const fe=be/2,_e=Te.color,We=Te.textStrokeColor,te=Te.textStrokeWidth;let me=Z;m?(xe=ce,Z==="inner"&&(G===ae-1?me=this.options.reverse?"left":"right":G===0?me=this.options.reverse?"right":"left":me="center"),s==="top"?N==="near"||O!==0?oe=-be*Re+Re/2:N==="center"?oe=-ye.highest.height/2-fe*Re+Re:oe=-ye.highest.height+Re/2:N==="near"||O!==0?oe=Re/2:N==="center"?oe=ye.highest.height/2-fe*Re:oe=ye.highest.height-be*Re,D&&(oe*=-1),O!==0&&!Te.showLabelBackdrop&&(xe+=Re/2*Math.sin(O))):(je=ce,oe=(1-be)*Re/2);let W;if(Te.showLabelBackdrop){const pe=Ni(Te.backdropPadding),Le=ye.heights[G],Ae=ye.widths[G];let V=oe-pe.top,H=0-pe.left;switch(he){case"middle":V-=Le/2;break;case"bottom":V-=Le;break}switch(Z){case"center":H-=Ae/2;break;case"right":H-=Ae;break;case"inner":G===ae-1?H-=Ae:G>0&&(H-=Ae/2);break}W={left:H,top:V,width:Ae+pe.width,height:Le+pe.height,color:Te.backdropColor}}P.push({label:ke,font:ue,textOffset:oe,options:{rotation:O,color:_e,strokeColor:We,strokeWidth:te,textAlign:me,textBaseline:he,translation:[xe,je],backdrop:W}})}return P}_getXAxisLabelAlignment(){const{position:n,ticks:a}=this.options;if(-Wl(this.labelRotation))return n==="top"?"left":"right";let s="center";return a.align==="start"?s="left":a.align==="end"?s="right":a.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(n){const{position:a,ticks:{crossAlign:o,mirror:s,padding:e}}=this.options,m=this._getLabelSizes(),v=n+e,w=m.widest.width;let N,S;return a==="left"?s?(S=this.right+e,o==="near"?N="left":o==="center"?(N="center",S+=w/2):(N="right",S+=w)):(S=this.right-v,o==="near"?N="right":o==="center"?(N="center",S-=w/2):(N="left",S=this.left)):a==="right"?s?(S=this.left+e,o==="near"?N="right":o==="center"?(N="center",S-=w/2):(N="left",S-=w)):(S=this.left+v,o==="near"?N="left":o==="center"?(N="center",S+=w/2):(N="right",S=this.right)):N="right",{textAlign:N,x:S}}_computeLabelArea(){if(this.options.ticks.mirror)return;const n=this.chart,a=this.options.position;if(a==="left"||a==="right")return{top:0,left:this.left,bottom:n.height,right:this.right};if(a==="top"||a==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:n.width}}drawBackground(){const{ctx:n,options:{backgroundColor:a},left:o,top:s,width:e,height:m}=this;a&&(n.save(),n.fillStyle=a,n.fillRect(o,s,e,m),n.restore())}getLineWidthForValue(n){const a=this.options.grid;if(!this._isVisible()||!a.display)return 0;const s=this.ticks.findIndex(e=>e.value===n);return s>=0?a.setContext(this.getContext(s)).lineWidth:0}drawGrid(n){const a=this.options.grid,o=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(n));let e,m;const v=(w,N,S)=>{!S.width||!S.color||(o.save(),o.lineWidth=S.width,o.strokeStyle=S.color,o.setLineDash(S.borderDash||[]),o.lineDashOffset=S.borderDashOffset,o.beginPath(),o.moveTo(w.x,w.y),o.lineTo(N.x,N.y),o.stroke(),o.restore())};if(a.display)for(e=0,m=s.length;e<m;++e){const w=s[e];a.drawOnChartArea&&v({x:w.x1,y:w.y1},{x:w.x2,y:w.y2},w),a.drawTicks&&v({x:w.tx1,y:w.ty1},{x:w.tx2,y:w.ty2},{color:w.tickColor,width:w.tickWidth,borderDash:w.tickBorderDash,borderDashOffset:w.tickBorderDashOffset})}}drawBorder(){const{chart:n,ctx:a,options:{border:o,grid:s}}=this,e=o.setContext(this.getContext()),m=o.display?e.width:0;if(!m)return;const v=s.setContext(this.getContext(0)).lineWidth,w=this._borderValue;let N,S,D,L;this.isHorizontal()?(N=Kd(n,this.left,m)-m/2,S=Kd(n,this.right,v)+v/2,D=L=w):(D=Kd(n,this.top,m)-m/2,L=Kd(n,this.bottom,v)+v/2,N=S=w),a.save(),a.lineWidth=e.width,a.strokeStyle=e.color,a.beginPath(),a.moveTo(N,D),a.lineTo(S,L),a.stroke(),a.restore()}drawLabels(n){if(!this.options.ticks.display)return;const o=this.ctx,s=this._computeLabelArea();s&&Mp(o,s);const e=this.getLabelItems(n);for(const m of e){const v=m.options,w=m.font,N=m.label,S=m.textOffset;cm(o,N,0,S,w,v)}s&&Lp(o)}drawTitle(){const{ctx:n,options:{position:a,title:o,reverse:s}}=this;if(!o.display)return;const e=rn(o.font),m=Ni(o.padding),v=o.align;let w=e.lineHeight/2;a==="bottom"||a==="center"||Qs(a)?(w+=m.bottom,ja(o.text)&&(w+=e.lineHeight*(o.text.length-1))):w+=m.top;const{titleX:N,titleY:S,maxWidth:D,rotation:L}=lN(this,w,a,v);cm(n,o.text,0,0,e,{color:o.color,maxWidth:D,rotation:L,textAlign:iN(v,a,s),textBaseline:"middle",translation:[N,S]})}draw(n){this._isVisible()&&(this.drawBackground(),this.drawGrid(n),this.drawBorder(),this.drawTitle(),this.drawLabels(n))}_layers(){const n=this.options,a=n.ticks&&n.ticks.z||0,o=Ts(n.grid&&n.grid.z,-1),s=Ts(n.border&&n.border.z,0);return!this._isVisible()||this.draw!==ah.prototype.draw?[{z:a,draw:e=>{this.draw(e)}}]:[{z:o,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:a,draw:e=>{this.drawLabels(e)}}]}getMatchingVisibleMetas(n){const a=this.chart.getSortedVisibleDatasetMetas(),o=this.axis+"AxisID",s=[];let e,m;for(e=0,m=a.length;e<m;++e){const v=a[e];v[o]===this.id&&(!n||v.type===n)&&s.push(v)}return s}_resolveTickFontOptions(n){const a=this.options.ticks.setContext(this.getContext(n));return rn(a.font)}_maxDigits(){const n=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/n}}class Jg{constructor(n,a,o){this.type=n,this.scope=a,this.override=o,this.items=Object.create(null)}isForType(n){return Object.prototype.isPrototypeOf.call(this.type.prototype,n.prototype)}register(n){const a=Object.getPrototypeOf(n);let o;dN(a)&&(o=this.register(a));const s=this.items,e=n.id,m=this.scope+"."+e;if(!e)throw new Error("class does not have id: "+n);return e in s||(s[e]=n,oN(n,m,o),this.override&&ma.override(n.id,n.overrides)),m}get(n){return this.items[n]}unregister(n){const a=this.items,o=n.id,s=this.scope;o in a&&delete a[o],s&&o in ma[s]&&(delete ma[s][o],this.override&&delete a0[o])}}function oN(l,n,a){const o=nm(Object.create(null),[a?ma.get(a):{},ma.get(n),l.defaults]);ma.set(n,o),l.defaultRoutes&&cN(n,l.defaultRoutes),l.descriptors&&ma.describe(n,l.descriptors)}function cN(l,n){Object.keys(n).forEach(a=>{const o=a.split("."),s=o.pop(),e=[l].concat(o).join("."),m=n[a].split("."),v=m.pop(),w=m.join(".");ma.route(e,s,w,v)})}function dN(l){return"id"in l&&"defaults"in l}class uN{constructor(){this.controllers=new Jg(Uc,"datasets",!0),this.elements=new Jg(Po,"elements"),this.plugins=new Jg(Object,"plugins"),this.scales=new Jg(ah,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...n){this._each("register",n)}remove(...n){this._each("unregister",n)}addControllers(...n){this._each("register",n,this.controllers)}addElements(...n){this._each("register",n,this.elements)}addPlugins(...n){this._each("register",n,this.plugins)}addScales(...n){this._each("register",n,this.scales)}getController(n){return this._get(n,this.controllers,"controller")}getElement(n){return this._get(n,this.elements,"element")}getPlugin(n){return this._get(n,this.plugins,"plugin")}getScale(n){return this._get(n,this.scales,"scale")}removeControllers(...n){this._each("unregister",n,this.controllers)}removeElements(...n){this._each("unregister",n,this.elements)}removePlugins(...n){this._each("unregister",n,this.plugins)}removeScales(...n){this._each("unregister",n,this.scales)}_each(n,a,o){[...a].forEach(s=>{const e=o||this._getRegistryForType(s);o||e.isForType(s)||e===this.plugins&&s.id?this._exec(n,e,s):vr(s,m=>{const v=o||this._getRegistryForType(m);this._exec(n,v,m)})})}_exec(n,a,o){const s=gx(n);Hr(o["before"+s],[],o),a[n](o),Hr(o["after"+s],[],o)}_getRegistryForType(n){for(let a=0;a<this._typedRegistries.length;a++){const o=this._typedRegistries[a];if(o.isForType(n))return o}return this.plugins}_get(n,a,o){const s=a.get(n);if(s===void 0)throw new Error('"'+n+'" is not a registered '+o+".");return s}}var Vl=new uN;class hN{constructor(){this._init=void 0}notify(n,a,o,s){if(a==="beforeInit"&&(this._init=this._createDescriptors(n,!0),this._notify(this._init,n,"install")),this._init===void 0)return;const e=s?this._descriptors(n).filter(s):this._descriptors(n),m=this._notify(e,n,a,o);return a==="afterDestroy"&&(this._notify(e,n,"stop"),this._notify(this._init,n,"uninstall"),this._init=void 0),m}_notify(n,a,o,s){s=s||{};for(const e of n){const m=e.plugin,v=m[o],w=[a,s,e.options];if(Hr(v,w,m)===!1&&s.cancelable)return!1}return!0}invalidate(){hr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(n){if(this._cache)return this._cache;const a=this._cache=this._createDescriptors(n);return this._notifyStateChanges(n),a}_createDescriptors(n,a){const o=n&&n.config,s=Ts(o.options&&o.options.plugins,{}),e=fN(o);return s===!1&&!a?[]:gN(n,e,s,a)}_notifyStateChanges(n){const a=this._oldCache||[],o=this._cache,s=(e,m)=>e.filter(v=>!m.some(w=>v.plugin.id===w.plugin.id));this._notify(s(a,o),n,"stop"),this._notify(s(o,a),n,"start")}}function fN(l){const n={},a=[],o=Object.keys(Vl.plugins.items);for(let e=0;e<o.length;e++)a.push(Vl.getPlugin(o[e]));const s=l.plugins||[];for(let e=0;e<s.length;e++){const m=s[e];a.indexOf(m)===-1&&(a.push(m),n[m.id]=!0)}return{plugins:a,localIds:n}}function mN(l,n){return!n&&l===!1?null:l===!0?{}:l}function gN(l,{plugins:n,localIds:a},o,s){const e=[],m=l.getContext();for(const v of n){const w=v.id,N=mN(o[w],s);N!==null&&e.push({plugin:v,options:pN(l.config,{plugin:v,local:a[w]},N,m)})}return e}function pN(l,{plugin:n,local:a},o,s){const e=l.pluginScopeKeys(n),m=l.getOptionScopes(o,e);return a&&n.defaults&&m.push(n.defaults),l.createResolver(m,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Q1(l,n){const a=ma.datasets[l]||{};return((n.datasets||{})[l]||{}).indexAxis||n.indexAxis||a.indexAxis||"x"}function xN(l,n){let a=l;return l==="_index_"?a=n:l==="_value_"&&(a=n==="x"?"y":"x"),a}function bN(l,n){return l===n?"_index_":"_value_"}function Y2(l){if(l==="x"||l==="y"||l==="r")return l}function yN(l){if(l==="top"||l==="bottom")return"x";if(l==="left"||l==="right")return"y"}function X1(l,...n){if(Y2(l))return l;for(const a of n){const o=a.axis||yN(a.position)||l.length>1&&Y2(l[0].toLowerCase());if(o)return o}throw new Error(`Cannot determine type of '${l}' axis. Please provide 'axis' or 'position' option.`)}function G2(l,n,a){if(a[n+"AxisID"]===l)return{axis:n}}function vN(l,n){if(n.data&&n.data.datasets){const a=n.data.datasets.filter(o=>o.xAxisID===l||o.yAxisID===l);if(a.length)return G2(l,"x",a[0])||G2(l,"y",a[0])}return{}}function wN(l,n){const a=a0[l.type]||{scales:{}},o=n.scales||{},s=Q1(l.type,n),e=Object.create(null);return Object.keys(o).forEach(m=>{const v=o[m];if(!Qs(v))return console.error(`Invalid scale configuration for scale: ${m}`);if(v._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${m}`);const w=X1(m,v,vN(m,l),ma.scales[v.type]),N=bN(w,s),S=a.scales||{};e[m]=Zf(Object.create(null),[{axis:w},v,S[w],S[N]])}),l.data.datasets.forEach(m=>{const v=m.type||l.type,w=m.indexAxis||Q1(v,n),S=(a0[v]||{}).scales||{};Object.keys(S).forEach(D=>{const L=xN(D,w),M=m[L+"AxisID"]||L;e[M]=e[M]||Object.create(null),Zf(e[M],[{axis:L},o[M],S[D]])})}),Object.keys(e).forEach(m=>{const v=e[m];Zf(v,[ma.scales[v.type],ma.scale])}),e}function cv(l){const n=l.options||(l.options={});n.plugins=Ts(n.plugins,{}),n.scales=wN(l,n)}function dv(l){return l=l||{},l.datasets=l.datasets||[],l.labels=l.labels||[],l}function jN(l){return l=l||{},l.data=dv(l.data),cv(l),l}const K2=new Map,uv=new Set;function Zg(l,n){let a=K2.get(l);return a||(a=n(),K2.set(l,a),uv.add(a)),a}const Yf=(l,n,a)=>{const o=Bc(n,a);o!==void 0&&l.add(o)};class NN{constructor(n){this._config=jN(n),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(n){this._config.type=n}get data(){return this._config.data}set data(n){this._config.data=dv(n)}get options(){return this._config.options}set options(n){this._config.options=n}get plugins(){return this._config.plugins}update(){const n=this._config;this.clearCache(),cv(n)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(n){return Zg(n,()=>[[`datasets.${n}`,""]])}datasetAnimationScopeKeys(n,a){return Zg(`${n}.transition.${a}`,()=>[[`datasets.${n}.transitions.${a}`,`transitions.${a}`],[`datasets.${n}`,""]])}datasetElementScopeKeys(n,a){return Zg(`${n}-${a}`,()=>[[`datasets.${n}.elements.${a}`,`datasets.${n}`,`elements.${a}`,""]])}pluginScopeKeys(n){const a=n.id,o=this.type;return Zg(`${o}-plugin-${a}`,()=>[[`plugins.${a}`,...n.additionalOptionScopes||[]]])}_cachedScopes(n,a){const o=this._scopeCache;let s=o.get(n);return(!s||a)&&(s=new Map,o.set(n,s)),s}getOptionScopes(n,a,o){const{options:s,type:e}=this,m=this._cachedScopes(n,o),v=m.get(a);if(v)return v;const w=new Set;a.forEach(S=>{n&&(w.add(n),S.forEach(D=>Yf(w,n,D))),S.forEach(D=>Yf(w,s,D)),S.forEach(D=>Yf(w,a0[e]||{},D)),S.forEach(D=>Yf(w,ma,D)),S.forEach(D=>Yf(w,G1,D))});const N=Array.from(w);return N.length===0&&N.push(Object.create(null)),uv.has(a)&&m.set(a,N),N}chartOptionScopes(){const{options:n,type:a}=this;return[n,a0[a]||{},ma.datasets[a]||{},{type:a},ma,G1]}resolveNamedOptions(n,a,o,s=[""]){const e={$shared:!0},{resolver:m,subPrefixes:v}=Q2(this._resolverCache,n,s);let w=m;if(CN(m,a)){e.$shared=!1,o=zc(o)?o():o;const N=this.createResolver(n,o,v);w=Xu(m,o,N)}for(const N of a)e[N]=w[N];return e}createResolver(n,a,o=[""],s){const{resolver:e}=Q2(this._resolverCache,n,o);return Qs(a)?Xu(e,a,void 0,s):e}}function Q2(l,n,a){let o=l.get(n);o||(o=new Map,l.set(n,o));const s=a.join();let e=o.get(s);return e||(e={resolver:vx(n,a),subPrefixes:a.filter(v=>!v.toLowerCase().includes("hover"))},o.set(s,e)),e}const kN=l=>Qs(l)&&Object.getOwnPropertyNames(l).some(n=>zc(l[n]));function CN(l,n){const{isScriptable:a,isIndexable:o}=Hy(l);for(const s of n){const e=a(s),m=o(s),v=(m||e)&&l[s];if(e&&(zc(v)||kN(v))||m&&ja(v))return!0}return!1}var SN="4.5.1";const AN=["top","bottom","left","right","chartArea"];function X2(l,n){return l==="top"||l==="bottom"||AN.indexOf(l)===-1&&n==="x"}function J2(l,n){return function(a,o){return a[l]===o[l]?a[n]-o[n]:a[l]-o[l]}}function Z2(l){const n=l.chart,a=n.options.animation;n.notifyPlugins("afterRender"),Hr(a&&a.onComplete,[l],n)}function EN(l){const n=l.chart,a=n.options.animation;Hr(a&&a.onProgress,[l],n)}function hv(l){return Nx()&&typeof l=="string"?l=document.getElementById(l):l&&l.length&&(l=l[0]),l&&l.canvas&&(l=l.canvas),l}const hp={},eb=l=>{const n=hv(l);return Object.values(hp).filter(a=>a.canvas===n).pop()};function DN(l,n,a){const o=Object.keys(l);for(const s of o){const e=+s;if(e>=n){const m=l[s];delete l[s],(a>0||e>n)&&(l[e+a]=m)}}}function TN(l,n,a,o){return!a||l.type==="mouseout"?null:o?n:l}let nl=class{static defaults=ma;static instances=hp;static overrides=a0;static registry=Vl;static version=SN;static getChart=eb;static register(...n){Vl.add(...n),tb()}static unregister(...n){Vl.remove(...n),tb()}constructor(n,a){const o=this.config=new NN(a),s=hv(n),e=eb(s);if(e)throw new Error("Canvas is already in use. Chart with ID '"+e.id+"' must be destroyed before the canvas with ID '"+e.canvas.id+"' can be reused.");const m=o.createResolver(o.chartOptionScopes(),this.getContext());this.platform=new(o.platform||G6(s)),this.platform.updateConfig(o);const v=this.platform.acquireContext(s,m.aspectRatio),w=v&&v.canvas,N=w&&w.height,S=w&&w.width;if(this.id=N3(),this.ctx=v,this.canvas=w,this.width=S,this.height=N,this._options=m,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new hN,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=H3(D=>this.update(D),m.resizeDelay||0),this._dataChanges=[],hp[this.id]=this,!v||!w){console.error("Failed to create chart: can't acquire context from the given item");return}To.listen(this,"complete",Z2),To.listen(this,"progress",EN),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:n,maintainAspectRatio:a},width:o,height:s,_aspectRatio:e}=this;return hr(n)?a&&e?e:s?o/s:null:n}get data(){return this.config.data}set data(n){this.config.data=n}get options(){return this._options}set options(n){this.config.options=n}get registry(){return Vl}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():N2(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return v2(this.canvas,this.ctx),this}stop(){return To.stop(this),this}resize(n,a){To.running(this)?this._resizeBeforeDraw={width:n,height:a}:this._resize(n,a)}_resize(n,a){const o=this.options,s=this.canvas,e=o.maintainAspectRatio&&this.aspectRatio,m=this.platform.getMaximumSize(s,n,a,e),v=o.devicePixelRatio||this.platform.getDevicePixelRatio(),w=this.width?"resize":"attach";this.width=m.width,this.height=m.height,this._aspectRatio=this.aspectRatio,N2(this,v,!0)&&(this.notifyPlugins("resize",{size:m}),Hr(o.onResize,[this,m],this),this.attached&&this._doResize(w)&&this.render())}ensureScalesHaveIDs(){const a=this.options.scales||{};vr(a,(o,s)=>{o.id=s})}buildOrUpdateScales(){const n=this.options,a=n.scales,o=this.scales,s=Object.keys(o).reduce((m,v)=>(m[v]=!1,m),{});let e=[];a&&(e=e.concat(Object.keys(a).map(m=>{const v=a[m],w=X1(m,v),N=w==="r",S=w==="x";return{options:v,dposition:N?"chartArea":S?"bottom":"left",dtype:N?"radialLinear":S?"category":"linear"}}))),vr(e,m=>{const v=m.options,w=v.id,N=X1(w,v),S=Ts(v.type,m.dtype);(v.position===void 0||X2(v.position,N)!==X2(m.dposition))&&(v.position=m.dposition),s[w]=!0;let D=null;if(w in o&&o[w].type===S)D=o[w];else{const L=Vl.getScale(S);D=new L({id:w,type:S,ctx:this.ctx,chart:this}),o[D.id]=D}D.init(v,n)}),vr(s,(m,v)=>{m||delete o[v]}),vr(o,m=>{ji.configure(this,m,m.options),ji.addBox(this,m)})}_updateMetasets(){const n=this._metasets,a=this.data.datasets.length,o=n.length;if(n.sort((s,e)=>s.index-e.index),o>a){for(let s=a;s<o;++s)this._destroyDatasetMeta(s);n.splice(a,o-a)}this._sortedMetasets=n.slice(0).sort(J2("order","index"))}_removeUnreferencedMetasets(){const{_metasets:n,data:{datasets:a}}=this;n.length>a.length&&delete this._stacks,n.forEach((o,s)=>{a.filter(e=>e===o._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const n=[],a=this.data.datasets;let o,s;for(this._removeUnreferencedMetasets(),o=0,s=a.length;o<s;o++){const e=a[o];let m=this.getDatasetMeta(o);const v=e.type||this.config.type;if(m.type&&m.type!==v&&(this._destroyDatasetMeta(o),m=this.getDatasetMeta(o)),m.type=v,m.indexAxis=e.indexAxis||Q1(v,this.options),m.order=e.order||0,m.index=o,m.label=""+e.label,m.visible=this.isDatasetVisible(o),m.controller)m.controller.updateIndex(o),m.controller.linkScales();else{const w=Vl.getController(v),{datasetElementType:N,dataElementType:S}=ma.datasets[v];Object.assign(w,{dataElementType:Vl.getElement(S),datasetElementType:N&&Vl.getElement(N)}),m.controller=new w(this,o),n.push(m.controller)}}return this._updateMetasets(),n}_resetElements(){vr(this.data.datasets,(n,a)=>{this.getDatasetMeta(a).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(n){const a=this.config;a.update();const o=this._options=a.createResolver(a.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!o.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:n,cancelable:!0})===!1)return;const e=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let m=0;for(let N=0,S=this.data.datasets.length;N<S;N++){const{controller:D}=this.getDatasetMeta(N),L=!s&&e.indexOf(D)===-1;D.buildOrUpdateElements(L),m=Math.max(+D.getMaxOverflow(),m)}m=this._minPadding=o.layout.autoPadding?m:0,this._updateLayout(m),s||vr(e,N=>{N.reset()}),this._updateDatasets(n),this.notifyPlugins("afterUpdate",{mode:n}),this._layers.sort(J2("z","_idx"));const{_active:v,_lastEvent:w}=this;w?this._eventHandler(w,!0):v.length&&this._updateHoverStyles(v,v,!0),this.render()}_updateScales(){vr(this.scales,n=>{ji.removeBox(this,n)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const n=this.options,a=new Set(Object.keys(this._listeners)),o=new Set(n.events);(!d2(a,o)||!!this._responsiveListeners!==n.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:n}=this,a=this._getUniformDataChanges()||[];for(const{method:o,start:s,count:e}of a){const m=o==="_removeElements"?-e:e;DN(n,s,m)}}_getUniformDataChanges(){const n=this._dataChanges;if(!n||!n.length)return;this._dataChanges=[];const a=this.data.datasets.length,o=e=>new Set(n.filter(m=>m[0]===e).map((m,v)=>v+","+m.splice(1).join(","))),s=o(0);for(let e=1;e<a;e++)if(!d2(s,o(e)))return;return Array.from(s).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(n){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ji.update(this,this.width,this.height,n);const a=this.chartArea,o=a.width<=0||a.height<=0;this._layers=[],vr(this.boxes,s=>{o&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,e)=>{s._idx=e}),this.notifyPlugins("afterLayout")}_updateDatasets(n){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:n,cancelable:!0})!==!1){for(let a=0,o=this.data.datasets.length;a<o;++a)this.getDatasetMeta(a).controller.configure();for(let a=0,o=this.data.datasets.length;a<o;++a)this._updateDataset(a,zc(n)?n({datasetIndex:a}):n);this.notifyPlugins("afterDatasetsUpdate",{mode:n})}}_updateDataset(n,a){const o=this.getDatasetMeta(n),s={meta:o,index:n,mode:a,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(o.controller._update(a),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(To.has(this)?this.attached&&!To.running(this)&&To.start(this):(this.draw(),Z2({chart:this})))}draw(){let n;if(this._resizeBeforeDraw){const{width:o,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(o,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const a=this._layers;for(n=0;n<a.length&&a[n].z<=0;++n)a[n].draw(this.chartArea);for(this._drawDatasets();n<a.length;++n)a[n].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(n){const a=this._sortedMetasets,o=[];let s,e;for(s=0,e=a.length;s<e;++s){const m=a[s];(!n||m.visible)&&o.push(m)}return o}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const n=this.getSortedVisibleDatasetMetas();for(let a=n.length-1;a>=0;--a)this._drawDataset(n[a]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(n){const a=this.ctx,o={meta:n,index:n.index,cancelable:!0},s=Zy(this,n);this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(s&&Mp(a,s),n.controller.draw(),s&&Lp(a),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(n){return om(n,this.chartArea,this._minPadding)}getElementsAtEventForMode(n,a,o,s){const e=A6.modes[a];return typeof e=="function"?e(this,n,o,s):[]}getDatasetMeta(n){const a=this.data.datasets[n],o=this._metasets;let s=o.filter(e=>e&&e._dataset===a).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:a&&a.order||0,index:n,_dataset:a,_parsed:[],_sorted:!1},o.push(s)),s}getContext(){return this.$context||(this.$context=o0(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(n){const a=this.data.datasets[n];if(!a)return!1;const o=this.getDatasetMeta(n);return typeof o.hidden=="boolean"?!o.hidden:!a.hidden}setDatasetVisibility(n,a){const o=this.getDatasetMeta(n);o.hidden=!a}toggleDataVisibility(n){this._hiddenIndices[n]=!this._hiddenIndices[n]}getDataVisibility(n){return!this._hiddenIndices[n]}_updateVisibility(n,a,o){const s=o?"show":"hide",e=this.getDatasetMeta(n),m=e.controller._resolveAnimations(void 0,s);im(a)?(e.data[a].hidden=!o,this.update()):(this.setDatasetVisibility(n,o),m.update(e,{visible:o}),this.update(v=>v.datasetIndex===n?s:void 0))}hide(n,a){this._updateVisibility(n,a,!1)}show(n,a){this._updateVisibility(n,a,!0)}_destroyDatasetMeta(n){const a=this._metasets[n];a&&a.controller&&a.controller._destroy(),delete this._metasets[n]}_stop(){let n,a;for(this.stop(),To.remove(this),n=0,a=this.data.datasets.length;n<a;++n)this._destroyDatasetMeta(n)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:n,ctx:a}=this;this._stop(),this.config.clearCache(),n&&(this.unbindEvents(),v2(n,a),this.platform.releaseContext(a),this.canvas=null,this.ctx=null),delete hp[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...n){return this.canvas.toDataURL(...n)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const n=this._listeners,a=this.platform,o=(e,m)=>{a.addEventListener(this,e,m),n[e]=m},s=(e,m,v)=>{e.offsetX=m,e.offsetY=v,this._eventHandler(e)};vr(this.options.events,e=>o(e,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const n=this._responsiveListeners,a=this.platform,o=(w,N)=>{a.addEventListener(this,w,N),n[w]=N},s=(w,N)=>{n[w]&&(a.removeEventListener(this,w,N),delete n[w])},e=(w,N)=>{this.canvas&&this.resize(w,N)};let m;const v=()=>{s("attach",v),this.attached=!0,this.resize(),o("resize",e),o("detach",m)};m=()=>{this.attached=!1,s("resize",e),this._stop(),this._resize(0,0),o("attach",v)},a.isAttached(this.canvas)?v():m()}unbindEvents(){vr(this._listeners,(n,a)=>{this.platform.removeEventListener(this,a,n)}),this._listeners={},vr(this._responsiveListeners,(n,a)=>{this.platform.removeEventListener(this,a,n)}),this._responsiveListeners=void 0}updateHoverStyle(n,a,o){const s=o?"set":"remove";let e,m,v,w;for(a==="dataset"&&(e=this.getDatasetMeta(n[0].datasetIndex),e.controller["_"+s+"DatasetHoverStyle"]()),v=0,w=n.length;v<w;++v){m=n[v];const N=m&&this.getDatasetMeta(m.datasetIndex).controller;N&&N[s+"HoverStyle"](m.element,m.datasetIndex,m.index)}}getActiveElements(){return this._active||[]}setActiveElements(n){const a=this._active||[],o=n.map(({datasetIndex:e,index:m})=>{const v=this.getDatasetMeta(e);if(!v)throw new Error("No dataset found at index "+e);return{datasetIndex:e,element:v.data[m],index:m}});!bp(o,a)&&(this._active=o,this._lastEvent=null,this._updateHoverStyles(o,a))}notifyPlugins(n,a,o){return this._plugins.notify(this,n,a,o)}isPluginEnabled(n){return this._plugins._cache.filter(a=>a.plugin.id===n).length===1}_updateHoverStyles(n,a,o){const s=this.options.hover,e=(w,N)=>w.filter(S=>!N.some(D=>S.datasetIndex===D.datasetIndex&&S.index===D.index)),m=e(a,n),v=o?n:e(n,a);m.length&&this.updateHoverStyle(m,s.mode,!1),v.length&&s.mode&&this.updateHoverStyle(v,s.mode,!0)}_eventHandler(n,a){const o={event:n,replay:a,cancelable:!0,inChartArea:this.isPointInArea(n)},s=m=>(m.options.events||this.options.events).includes(n.native.type);if(this.notifyPlugins("beforeEvent",o,s)===!1)return;const e=this._handleEvent(n,a,o.inChartArea);return o.cancelable=!1,this.notifyPlugins("afterEvent",o,s),(e||o.changed)&&this.render(),this}_handleEvent(n,a,o){const{_active:s=[],options:e}=this,m=a,v=this._getActiveElements(n,s,o,m),w=D3(n),N=TN(n,this._lastEvent,o,w);o&&(this._lastEvent=null,Hr(e.onHover,[n,v,this],this),w&&Hr(e.onClick,[n,v,this],this));const S=!bp(v,s);return(S||a)&&(this._active=v,this._updateHoverStyles(v,s,a)),this._lastEvent=N,S}_getActiveElements(n,a,o,s){if(n.type==="mouseout")return[];if(!o)return a;const e=this.options.hover;return this.getElementsAtEventForMode(n,e.mode,e,s)}};function tb(){return vr(nl.instances,l=>l._plugins.invalidate())}function _N(l,n,a){const{startAngle:o,x:s,y:e,outerRadius:m,innerRadius:v,options:w}=n,{borderWidth:N,borderJoinStyle:S}=w,D=Math.min(N/m,ti(o-a));if(l.beginPath(),l.arc(s,e,m-N/2,o+D/2,a-D/2),v>0){const L=Math.min(N/v,ti(o-a));l.arc(s,e,v+N/2,a-L/2,o+L/2,!0)}else{const L=Math.min(N/2,m*ti(o-a));if(S==="round")l.arc(s,e,L,a-pr/2,o+pr/2,!0);else if(S==="bevel"){const M=2*L*L,F=-M*Math.cos(a+pr/2)+s,O=-M*Math.sin(a+pr/2)+e,P=M*Math.cos(o+pr/2)+s,G=M*Math.sin(o+pr/2)+e;l.lineTo(F,O),l.lineTo(P,G)}}l.closePath(),l.moveTo(0,0),l.rect(0,0,l.canvas.width,l.canvas.height),l.clip("evenodd")}function FN(l,n,a){const{startAngle:o,pixelMargin:s,x:e,y:m,outerRadius:v,innerRadius:w}=n;let N=s/v;l.beginPath(),l.arc(e,m,v,o-N,a+N),w>s?(N=s/w,l.arc(e,m,w,a+N,o-N,!0)):l.arc(e,m,s,a+Aa,o-Aa),l.closePath(),l.clip()}function MN(l){return yx(l,["outerStart","outerEnd","innerStart","innerEnd"])}function LN(l,n,a,o){const s=MN(l.options.borderRadius),e=(a-n)/2,m=Math.min(e,o*n/2),v=w=>{const N=(a-Math.min(e,w))*o/2;return sn(w,0,Math.min(e,N))};return{outerStart:v(s.outerStart),outerEnd:v(s.outerEnd),innerStart:sn(s.innerStart,0,m),innerEnd:sn(s.innerEnd,0,m)}}function Wu(l,n,a,o){return{x:a+l*Math.cos(n),y:o+l*Math.sin(n)}}function kp(l,n,a,o,s,e){const{x:m,y:v,startAngle:w,pixelMargin:N,innerRadius:S}=n,D=Math.max(n.outerRadius+o+a-N,0),L=S>0?S+o+a+N:0;let M=0;const F=s-w;if(o){const Te=S>0?S-o:0,fe=D>0?D-o:0,_e=(Te+fe)/2,We=_e!==0?F*_e/(_e+o):F;M=(F-We)/2}const O=Math.max(.001,F*D-a/pr)/D,P=(F-O)/2,G=w+P+M,ae=s-P-M,{outerStart:re,outerEnd:ke,innerStart:xe,innerEnd:je}=LN(n,L,D,ae-G),Z=D-re,ce=D-ke,ue=G+re/Z,Re=ae-ke/ce,be=L+xe,oe=L+je,he=G+xe/be,ye=ae-je/oe;if(l.beginPath(),e){const Te=(ue+Re)/2;if(l.arc(m,v,D,ue,Te),l.arc(m,v,D,Te,Re),ke>0){const te=Wu(ce,Re,m,v);l.arc(te.x,te.y,ke,Re,ae+Aa)}const fe=Wu(oe,ae,m,v);if(l.lineTo(fe.x,fe.y),je>0){const te=Wu(oe,ye,m,v);l.arc(te.x,te.y,je,ae+Aa,ye+Math.PI)}const _e=(ae-je/L+(G+xe/L))/2;if(l.arc(m,v,L,ae-je/L,_e,!0),l.arc(m,v,L,_e,G+xe/L,!0),xe>0){const te=Wu(be,he,m,v);l.arc(te.x,te.y,xe,he+Math.PI,G-Aa)}const We=Wu(Z,G,m,v);if(l.lineTo(We.x,We.y),re>0){const te=Wu(Z,ue,m,v);l.arc(te.x,te.y,re,G-Aa,ue)}}else{l.moveTo(m,v);const Te=Math.cos(ue)*D+m,fe=Math.sin(ue)*D+v;l.lineTo(Te,fe);const _e=Math.cos(Re)*D+m,We=Math.sin(Re)*D+v;l.lineTo(_e,We)}l.closePath()}function RN(l,n,a,o,s){const{fullCircles:e,startAngle:m,circumference:v}=n;let w=n.endAngle;if(e){kp(l,n,a,o,w,s);for(let N=0;N<e;++N)l.fill();isNaN(v)||(w=m+(v%ta||ta))}return kp(l,n,a,o,w,s),l.fill(),w}function ON(l,n,a,o,s){const{fullCircles:e,startAngle:m,circumference:v,options:w}=n,{borderWidth:N,borderJoinStyle:S,borderDash:D,borderDashOffset:L,borderRadius:M}=w,F=w.borderAlign==="inner";if(!N)return;l.setLineDash(D||[]),l.lineDashOffset=L,F?(l.lineWidth=N*2,l.lineJoin=S||"round"):(l.lineWidth=N,l.lineJoin=S||"bevel");let O=n.endAngle;if(e){kp(l,n,a,o,O,s);for(let P=0;P<e;++P)l.stroke();isNaN(v)||(O=m+(v%ta||ta))}F&&FN(l,n,O),w.selfJoin&&O-m>=pr&&M===0&&S!=="miter"&&_N(l,n,O),e||(kp(l,n,a,o,O,s),l.stroke())}class bm extends Po{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:n=>n!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(n){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,a,o){const s=this.getProps(["x","y"],o),{angle:e,distance:m}=Fy(s,{x:n,y:a}),{startAngle:v,endAngle:w,innerRadius:N,outerRadius:S,circumference:D}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],o),L=(this.options.spacing+this.options.borderWidth)/2,M=Ts(D,w-v),F=lm(e,v,w)&&v!==w,O=M>=ta||F,P=Lo(m,N+L,S+L);return O&&P}getCenterPoint(n){const{x:a,y:o,startAngle:s,endAngle:e,innerRadius:m,outerRadius:v}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:w,spacing:N}=this.options,S=(s+e)/2,D=(m+v+N+w)/2;return{x:a+Math.cos(S)*D,y:o+Math.sin(S)*D}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:a,circumference:o}=this,s=(a.offset||0)/4,e=(a.spacing||0)/2,m=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=o>ta?Math.floor(o/ta):0,o===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const v=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(v)*s,Math.sin(v)*s);const w=1-Math.sin(Math.min(pr,o||0)),N=s*w;n.fillStyle=a.backgroundColor,n.strokeStyle=a.borderColor,RN(n,this,N,e,m),ON(n,this,N,e,m),n.restore()}}function fv(l,n,a=n){l.lineCap=Ts(a.borderCapStyle,n.borderCapStyle),l.setLineDash(Ts(a.borderDash,n.borderDash)),l.lineDashOffset=Ts(a.borderDashOffset,n.borderDashOffset),l.lineJoin=Ts(a.borderJoinStyle,n.borderJoinStyle),l.lineWidth=Ts(a.borderWidth,n.borderWidth),l.strokeStyle=Ts(a.borderColor,n.borderColor)}function PN(l,n,a){l.lineTo(a.x,a.y)}function IN(l){return l.stepped?ej:l.tension||l.cubicInterpolationMode==="monotone"?tj:PN}function mv(l,n,a={}){const o=l.length,{start:s=0,end:e=o-1}=a,{start:m,end:v}=n,w=Math.max(s,m),N=Math.min(e,v),S=s<m&&e<m||s>v&&e>v;return{count:o,start:w,loop:n.loop,ilen:N<w&&!S?o+N-w:N-w}}function BN(l,n,a,o){const{points:s,options:e}=n,{count:m,start:v,loop:w,ilen:N}=mv(s,a,o),S=IN(e);let{move:D=!0,reverse:L}=o||{},M,F,O;for(M=0;M<=N;++M)F=s[(v+(L?N-M:M))%m],!F.skip&&(D?(l.moveTo(F.x,F.y),D=!1):S(l,O,F,L,e.stepped),O=F);return w&&(F=s[(v+(L?N:0))%m],S(l,O,F,L,e.stepped)),!!w}function zN(l,n,a,o){const s=n.points,{count:e,start:m,ilen:v}=mv(s,a,o),{move:w=!0,reverse:N}=o||{};let S=0,D=0,L,M,F,O,P,G;const ae=ke=>(m+(N?v-ke:ke))%e,re=()=>{O!==P&&(l.lineTo(S,P),l.lineTo(S,O),l.lineTo(S,G))};for(w&&(M=s[ae(0)],l.moveTo(M.x,M.y)),L=0;L<=v;++L){if(M=s[ae(L)],M.skip)continue;const ke=M.x,xe=M.y,je=ke|0;je===F?(xe<O?O=xe:xe>P&&(P=xe),S=(D*S+ke)/++D):(re(),l.lineTo(ke,xe),F=je,D=0,O=P=xe),G=xe}re()}function J1(l){const n=l.options,a=n.borderDash&&n.borderDash.length;return!l._decimated&&!l._loop&&!n.tension&&n.cubicInterpolationMode!=="monotone"&&!n.stepped&&!a?zN:BN}function UN(l){return l.stepped?Mj:l.tension||l.cubicInterpolationMode==="monotone"?Lj:Jd}function HN(l,n,a,o){let s=n._path;s||(s=n._path=new Path2D,n.path(s,a,o)&&s.closePath()),fv(l,n.options),l.stroke(s)}function VN(l,n,a,o){const{segments:s,options:e}=n,m=J1(n);for(const v of s)fv(l,e,v.style),l.beginPath(),m(l,n,v,{start:a,end:a+o-1})&&l.closePath(),l.stroke()}const WN=typeof Path2D=="function";function $N(l,n,a,o){WN&&!n.options.segment?HN(l,n,a,o):VN(l,n,a,o)}class il extends Po{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:n=>n!=="borderDash"&&n!=="fill"};constructor(n){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,n&&Object.assign(this,n)}updateControlPoints(n,a){const o=this.options;if((o.tension||o.cubicInterpolationMode==="monotone")&&!o.stepped&&!this._pointsUpdated){const s=o.spanGaps?this._loop:this._fullLoop;Cj(this._points,o,n,s,a),this._pointsUpdated=!0}}set points(n){this._points=n,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=zj(this,this.options.segment))}first(){const n=this.segments,a=this.points;return n.length&&a[n[0].start]}last(){const n=this.segments,a=this.points,o=n.length;return o&&a[n[o-1].end]}interpolate(n,a){const o=this.options,s=n[a],e=this.points,m=Jy(this,{property:a,start:s,end:s});if(!m.length)return;const v=[],w=UN(o);let N,S;for(N=0,S=m.length;N<S;++N){const{start:D,end:L}=m[N],M=e[D],F=e[L];if(M===F){v.push(M);continue}const O=Math.abs((s-M[a])/(F[a]-M[a])),P=w(M,F,O,o.stepped);P[a]=n[a],v.push(P)}return v.length===1?v[0]:v}pathSegment(n,a,o){return J1(this)(n,this,a,o)}path(n,a,o){const s=this.segments,e=J1(this);let m=this._loop;a=a||0,o=o||this.points.length-a;for(const v of s)m&=e(n,this,v,{start:a,end:a+o-1});return!!m}draw(n,a,o,s){const e=this.options||{};(this.points||[]).length&&e.borderWidth&&(n.save(),$N(n,this,o,s),n.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function sb(l,n,a,o){const s=l.options,{[a]:e}=l.getProps([a],o);return Math.abs(n-e)<s.radius+s.hitRadius}class Hc extends Po{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(n){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,a,o){const s=this.options,{x:e,y:m}=this.getProps(["x","y"],o);return Math.pow(n-e,2)+Math.pow(a-m,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(n,a){return sb(this,n,"x",a)}inYRange(n,a){return sb(this,n,"y",a)}getCenterPoint(n){const{x:a,y:o}=this.getProps(["x","y"],n);return{x:a,y:o}}size(n){n=n||this.options||{};let a=n.radius||0;a=Math.max(a,a&&n.hoverRadius||0);const o=a&&n.borderWidth||0;return(a+o)*2}draw(n,a){const o=this.options;this.skip||o.radius<.1||!om(this,a,this.size(o)/2)||(n.strokeStyle=o.borderColor,n.lineWidth=o.borderWidth,n.fillStyle=o.backgroundColor,K1(n,o,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}function gv(l,n){const{x:a,y:o,base:s,width:e,height:m}=l.getProps(["x","y","base","width","height"],n);let v,w,N,S,D;return l.horizontal?(D=m/2,v=Math.min(a,s),w=Math.max(a,s),N=o-D,S=o+D):(D=e/2,v=a-D,w=a+D,N=Math.min(o,s),S=Math.max(o,s)),{left:v,top:N,right:w,bottom:S}}function Pc(l,n,a,o){return l?0:sn(n,a,o)}function qN(l,n,a){const o=l.options.borderWidth,s=l.borderSkipped,e=Uy(o);return{t:Pc(s.top,e.top,0,a),r:Pc(s.right,e.right,0,n),b:Pc(s.bottom,e.bottom,0,a),l:Pc(s.left,e.left,0,n)}}function YN(l,n,a){const{enableBorderRadius:o}=l.getProps(["enableBorderRadius"]),s=l.options.borderRadius,e=Yu(s),m=Math.min(n,a),v=l.borderSkipped,w=o||Qs(s);return{topLeft:Pc(!w||v.top||v.left,e.topLeft,0,m),topRight:Pc(!w||v.top||v.right,e.topRight,0,m),bottomLeft:Pc(!w||v.bottom||v.left,e.bottomLeft,0,m),bottomRight:Pc(!w||v.bottom||v.right,e.bottomRight,0,m)}}function GN(l){const n=gv(l),a=n.right-n.left,o=n.bottom-n.top,s=qN(l,a/2,o/2),e=YN(l,a/2,o/2);return{outer:{x:n.left,y:n.top,w:a,h:o,radius:e},inner:{x:n.left+s.l,y:n.top+s.t,w:a-s.l-s.r,h:o-s.t-s.b,radius:{topLeft:Math.max(0,e.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,e.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,e.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,e.bottomRight-Math.max(s.b,s.r))}}}}function A1(l,n,a,o){const s=n===null,e=a===null,v=l&&!(s&&e)&&gv(l,o);return v&&(s||Lo(n,v.left,v.right))&&(e||Lo(a,v.top,v.bottom))}function KN(l){return l.topLeft||l.topRight||l.bottomLeft||l.bottomRight}function QN(l,n){l.rect(n.x,n.y,n.w,n.h)}function E1(l,n,a={}){const o=l.x!==a.x?-n:0,s=l.y!==a.y?-n:0,e=(l.x+l.w!==a.x+a.w?n:0)-o,m=(l.y+l.h!==a.y+a.h?n:0)-s;return{x:l.x+o,y:l.y+s,w:l.w+e,h:l.h+m,radius:l.radius}}class Vc extends Po{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(n){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,n&&Object.assign(this,n)}draw(n){const{inflateAmount:a,options:{borderColor:o,backgroundColor:s}}=this,{inner:e,outer:m}=GN(this),v=KN(m.radius)?wp:QN;n.save(),(m.w!==e.w||m.h!==e.h)&&(n.beginPath(),v(n,E1(m,a,e)),n.clip(),v(n,E1(e,-a,m)),n.fillStyle=o,n.fill("evenodd")),n.beginPath(),v(n,E1(e,a)),n.fillStyle=s,n.fill(),n.restore()}inRange(n,a,o){return A1(this,n,a,o)}inXRange(n,a){return A1(this,n,null,a)}inYRange(n,a){return A1(this,null,n,a)}getCenterPoint(n){const{x:a,y:o,base:s,horizontal:e}=this.getProps(["x","y","base","horizontal"],n);return{x:e?(a+s)/2:a,y:e?o:(o+s)/2}}getRange(n){return n==="x"?this.width/2:this.height/2}}function XN(l,n,a){const o=l.segments,s=l.points,e=n.points,m=[];for(const v of o){let{start:w,end:N}=v;N=Pp(w,N,s);const S=Z1(a,s[w],s[N],v.loop);if(!n.segments){m.push({source:v,target:S,start:s[w],end:s[N]});continue}const D=Jy(n,S);for(const L of D){const M=Z1(a,e[L.start],e[L.end],L.loop),F=Xy(v,s,M);for(const O of F)m.push({source:O,target:L,start:{[a]:rb(S,M,"start",Math.max)},end:{[a]:rb(S,M,"end",Math.min)}})}}return m}function Z1(l,n,a,o){if(o)return;let s=n[l],e=a[l];return l==="angle"&&(s=ti(s),e=ti(e)),{property:l,start:s,end:e}}function JN(l,n){const{x:a=null,y:o=null}=l||{},s=n.points,e=[];return n.segments.forEach(({start:m,end:v})=>{v=Pp(m,v,s);const w=s[m],N=s[v];o!==null?(e.push({x:w.x,y:o}),e.push({x:N.x,y:o})):a!==null&&(e.push({x:a,y:w.y}),e.push({x:a,y:N.y}))}),e}function Pp(l,n,a){for(;n>l;n--){const o=a[n];if(!isNaN(o.x)&&!isNaN(o.y))break}return n}function rb(l,n,a,o){return l&&n?o(l[a],n[a]):l?l[a]:n?n[a]:0}function pv(l,n){let a=[],o=!1;return ja(l)?(o=!0,a=l):a=JN(l,n),a.length?new il({points:a,options:{tension:0},_loop:o,_fullLoop:o}):null}function ab(l){return l&&l.fill!==!1}function ZN(l,n,a){let s=l[n].fill;const e=[n];let m;if(!a)return s;for(;s!==!1&&e.indexOf(s)===-1;){if(!an(s))return s;if(m=l[s],!m)return!1;if(m.visible)return s;e.push(s),s=m.fill}return!1}function ek(l,n,a){const o=ak(l);if(Qs(o))return isNaN(o.value)?!1:o;let s=parseFloat(o);return an(s)&&Math.floor(s)===s?tk(o[0],n,s,a):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}function tk(l,n,a,o){return(l==="-"||l==="+")&&(a=n+a),a===n||a<0||a>=o?!1:a}function sk(l,n){let a=null;return l==="start"?a=n.bottom:l==="end"?a=n.top:Qs(l)?a=n.getPixelForValue(l.value):n.getBasePixel&&(a=n.getBasePixel()),a}function rk(l,n,a){let o;return l==="start"?o=a:l==="end"?o=n.options.reverse?n.min:n.max:Qs(l)?o=l.value:o=n.getBaseValue(),o}function ak(l){const n=l.options,a=n.fill;let o=Ts(a&&a.target,a);return o===void 0&&(o=!!n.backgroundColor),o===!1||o===null?!1:o===!0?"origin":o}function nk(l){const{scale:n,index:a,line:o}=l,s=[],e=o.segments,m=o.points,v=ik(n,a);v.push(pv({x:null,y:n.bottom},o));for(let w=0;w<e.length;w++){const N=e[w];for(let S=N.start;S<=N.end;S++)lk(s,m[S],v)}return new il({points:s,options:{}})}function ik(l,n){const a=[],o=l.getMatchingVisibleMetas("line");for(let s=0;s<o.length;s++){const e=o[s];if(e.index===n)break;e.hidden||a.unshift(e.dataset)}return a}function lk(l,n,a){const o=[];for(let s=0;s<a.length;s++){const e=a[s],{first:m,last:v,point:w}=ok(e,n,"x");if(!(!w||m&&v)){if(m)o.unshift(w);else if(l.push(w),!v)break}}l.push(...o)}function ok(l,n,a){const o=l.interpolate(n,a);if(!o)return{};const s=o[a],e=l.segments,m=l.points;let v=!1,w=!1;for(let N=0;N<e.length;N++){const S=e[N],D=m[S.start][a],L=m[S.end][a];if(Lo(s,D,L)){v=s===D,w=s===L;break}}return{first:v,last:w,point:o}}class xv{constructor(n){this.x=n.x,this.y=n.y,this.radius=n.radius}pathSegment(n,a,o){const{x:s,y:e,radius:m}=this;return a=a||{start:0,end:ta},n.arc(s,e,m,a.end,a.start,!0),!o.bounds}interpolate(n){const{x:a,y:o,radius:s}=this,e=n.angle;return{x:a+Math.cos(e)*s,y:o+Math.sin(e)*s,angle:e}}}function ck(l){const{chart:n,fill:a,line:o}=l;if(an(a))return dk(n,a);if(a==="stack")return nk(l);if(a==="shape")return!0;const s=uk(l);return s instanceof xv?s:pv(s,o)}function dk(l,n){const a=l.getDatasetMeta(n);return a&&l.isDatasetVisible(n)?a.dataset:null}function uk(l){return(l.scale||{}).getPointPositionForValue?fk(l):hk(l)}function hk(l){const{scale:n={},fill:a}=l,o=sk(a,n);if(an(o)){const s=n.isHorizontal();return{x:s?o:null,y:s?null:o}}return null}function fk(l){const{scale:n,fill:a}=l,o=n.options,s=n.getLabels().length,e=o.reverse?n.max:n.min,m=rk(a,n,e),v=[];if(o.grid.circular){const w=n.getPointPositionForValue(0,e);return new xv({x:w.x,y:w.y,radius:n.getDistanceFromCenterForValue(m)})}for(let w=0;w<s;++w)v.push(n.getPointPositionForValue(w,m));return v}function D1(l,n,a){const o=ck(n),{chart:s,index:e,line:m,scale:v,axis:w}=n,N=m.options,S=N.fill,D=N.backgroundColor,{above:L=D,below:M=D}=S||{},F=s.getDatasetMeta(e),O=Zy(s,F);o&&m.points.length&&(Mp(l,a),mk(l,{line:m,target:o,above:L,below:M,area:a,scale:v,axis:w,clip:O}),Lp(l))}function mk(l,n){const{line:a,target:o,above:s,below:e,area:m,scale:v,clip:w}=n,N=a._loop?"angle":n.axis;l.save();let S=e;e!==s&&(N==="x"?(nb(l,o,m.top),T1(l,{line:a,target:o,color:s,scale:v,property:N,clip:w}),l.restore(),l.save(),nb(l,o,m.bottom)):N==="y"&&(ib(l,o,m.left),T1(l,{line:a,target:o,color:e,scale:v,property:N,clip:w}),l.restore(),l.save(),ib(l,o,m.right),S=s)),T1(l,{line:a,target:o,color:S,scale:v,property:N,clip:w}),l.restore()}function nb(l,n,a){const{segments:o,points:s}=n;let e=!0,m=!1;l.beginPath();for(const v of o){const{start:w,end:N}=v,S=s[w],D=s[Pp(w,N,s)];e?(l.moveTo(S.x,S.y),e=!1):(l.lineTo(S.x,a),l.lineTo(S.x,S.y)),m=!!n.pathSegment(l,v,{move:m}),m?l.closePath():l.lineTo(D.x,a)}l.lineTo(n.first().x,a),l.closePath(),l.clip()}function ib(l,n,a){const{segments:o,points:s}=n;let e=!0,m=!1;l.beginPath();for(const v of o){const{start:w,end:N}=v,S=s[w],D=s[Pp(w,N,s)];e?(l.moveTo(S.x,S.y),e=!1):(l.lineTo(a,S.y),l.lineTo(S.x,S.y)),m=!!n.pathSegment(l,v,{move:m}),m?l.closePath():l.lineTo(a,D.y)}l.lineTo(a,n.first().y),l.closePath(),l.clip()}function T1(l,n){const{line:a,target:o,property:s,color:e,scale:m,clip:v}=n,w=XN(a,o,s);for(const{source:N,target:S,start:D,end:L}of w){const{style:{backgroundColor:M=e}={}}=N,F=o!==!0;l.save(),l.fillStyle=M,gk(l,m,v,F&&Z1(s,D,L)),l.beginPath();const O=!!a.pathSegment(l,N);let P;if(F){O?l.closePath():lb(l,o,L,s);const G=!!o.pathSegment(l,S,{move:O,reverse:!0});P=O&&G,P||lb(l,o,D,s)}l.closePath(),l.fill(P?"evenodd":"nonzero"),l.restore()}}function gk(l,n,a,o){const s=n.chart.chartArea,{property:e,start:m,end:v}=o||{};if(e==="x"||e==="y"){let w,N,S,D;e==="x"?(w=m,N=s.top,S=v,D=s.bottom):(w=s.left,N=m,S=s.right,D=v),l.beginPath(),a&&(w=Math.max(w,a.left),S=Math.min(S,a.right),N=Math.max(N,a.top),D=Math.min(D,a.bottom)),l.rect(w,N,S-w,D-N),l.clip()}}function lb(l,n,a,o){const s=n.interpolate(a,o);s&&l.lineTo(s.x,s.y)}var Ip={id:"filler",afterDatasetsUpdate(l,n,a){const o=(l.data.datasets||[]).length,s=[];let e,m,v,w;for(m=0;m<o;++m)e=l.getDatasetMeta(m),v=e.dataset,w=null,v&&v.options&&v instanceof il&&(w={visible:l.isDatasetVisible(m),index:m,fill:ek(v,m,o),chart:l,axis:e.controller.options.indexAxis,scale:e.vScale,line:v}),e.$filler=w,s.push(w);for(m=0;m<o;++m)w=s[m],!(!w||w.fill===!1)&&(w.fill=ZN(s,m,a.propagate))},beforeDraw(l,n,a){const o=a.drawTime==="beforeDraw",s=l.getSortedVisibleDatasetMetas(),e=l.chartArea;for(let m=s.length-1;m>=0;--m){const v=s[m].$filler;v&&(v.line.updateControlPoints(e,v.axis),o&&v.fill&&D1(l.ctx,v,e))}},beforeDatasetsDraw(l,n,a){if(a.drawTime!=="beforeDatasetsDraw")return;const o=l.getSortedVisibleDatasetMetas();for(let s=o.length-1;s>=0;--s){const e=o[s].$filler;ab(e)&&D1(l.ctx,e,l.chartArea)}},beforeDatasetDraw(l,n,a){const o=n.meta.$filler;!ab(o)||a.drawTime!=="beforeDatasetDraw"||D1(l.ctx,o,l.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const ob=(l,n)=>{let{boxHeight:a=n,boxWidth:o=n}=l;return l.usePointStyle&&(a=Math.min(a,n),o=l.pointStyleWidth||Math.min(o,n)),{boxWidth:o,boxHeight:a,itemHeight:Math.max(n,a)}},pk=(l,n)=>l!==null&&n!==null&&l.datasetIndex===n.datasetIndex&&l.index===n.index;class cb extends Po{constructor(n){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,a,o){this.maxWidth=n,this.maxHeight=a,this._margins=o,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const n=this.options.labels||{};let a=Hr(n.generateLabels,[this.chart],this)||[];n.filter&&(a=a.filter(o=>n.filter(o,this.chart.data))),n.sort&&(a=a.sort((o,s)=>n.sort(o,s,this.chart.data))),this.options.reverse&&a.reverse(),this.legendItems=a}fit(){const{options:n,ctx:a}=this;if(!n.display){this.width=this.height=0;return}const o=n.labels,s=rn(o.font),e=s.size,m=this._computeTitleHeight(),{boxWidth:v,itemHeight:w}=ob(o,e);let N,S;a.font=s.string,this.isHorizontal()?(N=this.maxWidth,S=this._fitRows(m,e,v,w)+10):(S=this.maxHeight,N=this._fitCols(m,s,v,w)+10),this.width=Math.min(N,n.maxWidth||this.maxWidth),this.height=Math.min(S,n.maxHeight||this.maxHeight)}_fitRows(n,a,o,s){const{ctx:e,maxWidth:m,options:{labels:{padding:v}}}=this,w=this.legendHitBoxes=[],N=this.lineWidths=[0],S=s+v;let D=n;e.textAlign="left",e.textBaseline="middle";let L=-1,M=-S;return this.legendItems.forEach((F,O)=>{const P=o+a/2+e.measureText(F.text).width;(O===0||N[N.length-1]+P+2*v>m)&&(D+=S,N[N.length-(O>0?0:1)]=0,M+=S,L++),w[O]={left:0,top:M,row:L,width:P,height:s},N[N.length-1]+=P+v}),D}_fitCols(n,a,o,s){const{ctx:e,maxHeight:m,options:{labels:{padding:v}}}=this,w=this.legendHitBoxes=[],N=this.columnSizes=[],S=m-n;let D=v,L=0,M=0,F=0,O=0;return this.legendItems.forEach((P,G)=>{const{itemWidth:ae,itemHeight:re}=xk(o,a,e,P,s);G>0&&M+re+2*v>S&&(D+=L+v,N.push({width:L,height:M}),F+=L+v,O++,L=M=0),w[G]={left:F,top:M,col:O,width:ae,height:re},L=Math.max(L,ae),M+=re+v}),D+=L,N.push({width:L,height:M}),D}adjustHitBoxes(){if(!this.options.display)return;const n=this._computeTitleHeight(),{legendHitBoxes:a,options:{align:o,labels:{padding:s},rtl:e}}=this,m=Gu(e,this.left,this.width);if(this.isHorizontal()){let v=0,w=en(o,this.left+s,this.right-this.lineWidths[v]);for(const N of a)v!==N.row&&(v=N.row,w=en(o,this.left+s,this.right-this.lineWidths[v])),N.top+=this.top+n+s,N.left=m.leftForLtr(m.x(w),N.width),w+=N.width+s}else{let v=0,w=en(o,this.top+n+s,this.bottom-this.columnSizes[v].height);for(const N of a)N.col!==v&&(v=N.col,w=en(o,this.top+n+s,this.bottom-this.columnSizes[v].height)),N.top=w,N.left+=this.left+s,N.left=m.leftForLtr(m.x(N.left),N.width),w+=N.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const n=this.ctx;Mp(n,this),this._draw(),Lp(n)}}_draw(){const{options:n,columnSizes:a,lineWidths:o,ctx:s}=this,{align:e,labels:m}=n,v=ma.color,w=Gu(n.rtl,this.left,this.width),N=rn(m.font),{padding:S}=m,D=N.size,L=D/2;let M;this.drawTitle(),s.textAlign=w.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=N.string;const{boxWidth:F,boxHeight:O,itemHeight:P}=ob(m,D),G=function(je,Z,ce){if(isNaN(F)||F<=0||isNaN(O)||O<0)return;s.save();const ue=Ts(ce.lineWidth,1);if(s.fillStyle=Ts(ce.fillStyle,v),s.lineCap=Ts(ce.lineCap,"butt"),s.lineDashOffset=Ts(ce.lineDashOffset,0),s.lineJoin=Ts(ce.lineJoin,"miter"),s.lineWidth=ue,s.strokeStyle=Ts(ce.strokeStyle,v),s.setLineDash(Ts(ce.lineDash,[])),m.usePointStyle){const Re={radius:O*Math.SQRT2/2,pointStyle:ce.pointStyle,rotation:ce.rotation,borderWidth:ue},be=w.xPlus(je,F/2),oe=Z+L;zy(s,Re,be,oe,m.pointStyleWidth&&F)}else{const Re=Z+Math.max((D-O)/2,0),be=w.leftForLtr(je,F),oe=Yu(ce.borderRadius);s.beginPath(),Object.values(oe).some(he=>he!==0)?wp(s,{x:be,y:Re,w:F,h:O,radius:oe}):s.rect(be,Re,F,O),s.fill(),ue!==0&&s.stroke()}s.restore()},ae=function(je,Z,ce){cm(s,ce.text,je,Z+P/2,N,{strikethrough:ce.hidden,textAlign:w.textAlign(ce.textAlign)})},re=this.isHorizontal(),ke=this._computeTitleHeight();re?M={x:en(e,this.left+S,this.right-o[0]),y:this.top+S+ke,line:0}:M={x:this.left+S,y:en(e,this.top+ke+S,this.bottom-a[0].height),line:0},Gy(this.ctx,n.textDirection);const xe=P+S;this.legendItems.forEach((je,Z)=>{s.strokeStyle=je.fontColor,s.fillStyle=je.fontColor;const ce=s.measureText(je.text).width,ue=w.textAlign(je.textAlign||(je.textAlign=m.textAlign)),Re=F+L+ce;let be=M.x,oe=M.y;w.setWidth(this.width),re?Z>0&&be+Re+S>this.right&&(oe=M.y+=xe,M.line++,be=M.x=en(e,this.left+S,this.right-o[M.line])):Z>0&&oe+xe>this.bottom&&(be=M.x=be+a[M.line].width+S,M.line++,oe=M.y=en(e,this.top+ke+S,this.bottom-a[M.line].height));const he=w.x(be);if(G(he,oe,je),be=V3(ue,be+F+L,re?be+Re:this.right,n.rtl),ae(w.x(be),oe,je),re)M.x+=Re+S;else if(typeof je.text!="string"){const ye=N.lineHeight;M.y+=bv(je,ye)+S}else M.y+=xe}),Ky(this.ctx,n.textDirection)}drawTitle(){const n=this.options,a=n.title,o=rn(a.font),s=Ni(a.padding);if(!a.display)return;const e=Gu(n.rtl,this.left,this.width),m=this.ctx,v=a.position,w=o.size/2,N=s.top+w;let S,D=this.left,L=this.width;if(this.isHorizontal())L=Math.max(...this.lineWidths),S=this.top+N,D=en(n.align,D,this.right-L);else{const F=this.columnSizes.reduce((O,P)=>Math.max(O,P.height),0);S=N+en(n.align,this.top,this.bottom-F-n.labels.padding-this._computeTitleHeight())}const M=en(v,D,D+L);m.textAlign=e.textAlign(xx(v)),m.textBaseline="middle",m.strokeStyle=a.color,m.fillStyle=a.color,m.font=o.string,cm(m,a.text,M,S,o)}_computeTitleHeight(){const n=this.options.title,a=rn(n.font),o=Ni(n.padding);return n.display?a.lineHeight+o.height:0}_getLegendItemAt(n,a){let o,s,e;if(Lo(n,this.left,this.right)&&Lo(a,this.top,this.bottom)){for(e=this.legendHitBoxes,o=0;o<e.length;++o)if(s=e[o],Lo(n,s.left,s.left+s.width)&&Lo(a,s.top,s.top+s.height))return this.legendItems[o]}return null}handleEvent(n){const a=this.options;if(!vk(n.type,a))return;const o=this._getLegendItemAt(n.x,n.y);if(n.type==="mousemove"||n.type==="mouseout"){const s=this._hoveredItem,e=pk(s,o);s&&!e&&Hr(a.onLeave,[n,s,this],this),this._hoveredItem=o,o&&!e&&Hr(a.onHover,[n,o,this],this)}else o&&Hr(a.onClick,[n,o,this],this)}}function xk(l,n,a,o,s){const e=bk(o,l,n,a),m=yk(s,o,n.lineHeight);return{itemWidth:e,itemHeight:m}}function bk(l,n,a,o){let s=l.text;return s&&typeof s!="string"&&(s=s.reduce((e,m)=>e.length>m.length?e:m)),n+a.size/2+o.measureText(s).width}function yk(l,n,a){let o=l;return typeof n.text!="string"&&(o=bv(n,a)),o}function bv(l,n){const a=l.text?l.text.length:0;return n*a}function vk(l,n){return!!((l==="mousemove"||l==="mouseout")&&(n.onHover||n.onLeave)||n.onClick&&(l==="click"||l==="mouseup"))}var Wc={id:"legend",_element:cb,start(l,n,a){const o=l.legend=new cb({ctx:l.ctx,options:a,chart:l});ji.configure(l,o,a),ji.addBox(l,o)},stop(l){ji.removeBox(l,l.legend),delete l.legend},beforeUpdate(l,n,a){const o=l.legend;ji.configure(l,o,a),o.options=a},afterUpdate(l){const n=l.legend;n.buildLabels(),n.adjustHitBoxes()},afterEvent(l,n){n.replay||l.legend.handleEvent(n.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(l,n,a){const o=n.datasetIndex,s=a.chart;s.isDatasetVisible(o)?(s.hide(o),n.hidden=!0):(s.show(o),n.hidden=!1)},onHover:null,onLeave:null,labels:{color:l=>l.chart.options.color,boxWidth:40,padding:10,generateLabels(l){const n=l.data.datasets,{labels:{usePointStyle:a,pointStyle:o,textAlign:s,color:e,useBorderRadius:m,borderRadius:v}}=l.legend.options;return l._getSortedDatasetMetas().map(w=>{const N=w.controller.getStyle(a?0:void 0),S=Ni(N.borderWidth);return{text:n[w.index].label,fillStyle:N.backgroundColor,fontColor:e,hidden:!w.visible,lineCap:N.borderCapStyle,lineDash:N.borderDash,lineDashOffset:N.borderDashOffset,lineJoin:N.borderJoinStyle,lineWidth:(S.width+S.height)/4,strokeStyle:N.borderColor,pointStyle:o||N.pointStyle,rotation:N.rotation,textAlign:s||N.textAlign,borderRadius:m&&(v||N.borderRadius),datasetIndex:w.index}},this)}},title:{color:l=>l.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:l=>!l.startsWith("on"),labels:{_scriptable:l=>!["generateLabels","filter","sort"].includes(l)}}};class yv extends Po{constructor(n){super(),this.chart=n.chart,this.options=n.options,this.ctx=n.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(n,a){const o=this.options;if(this.left=0,this.top=0,!o.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=n,this.height=this.bottom=a;const s=ja(o.text)?o.text.length:1;this._padding=Ni(o.padding);const e=s*rn(o.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=e:this.width=e}isHorizontal(){const n=this.options.position;return n==="top"||n==="bottom"}_drawArgs(n){const{top:a,left:o,bottom:s,right:e,options:m}=this,v=m.align;let w=0,N,S,D;return this.isHorizontal()?(S=en(v,o,e),D=a+n,N=e-o):(m.position==="left"?(S=o+n,D=en(v,s,a),w=pr*-.5):(S=e-n,D=en(v,a,s),w=pr*.5),N=s-a),{titleX:S,titleY:D,maxWidth:N,rotation:w}}draw(){const n=this.ctx,a=this.options;if(!a.display)return;const o=rn(a.font),e=o.lineHeight/2+this._padding.top,{titleX:m,titleY:v,maxWidth:w,rotation:N}=this._drawArgs(e);cm(n,a.text,0,0,o,{color:a.color,maxWidth:w,rotation:N,textAlign:xx(a.align),textBaseline:"middle",translation:[m,v]})}}function wk(l,n){const a=new yv({ctx:l.ctx,options:n,chart:l});ji.configure(l,a,n),ji.addBox(l,a),l.titleBlock=a}var $c={id:"title",_element:yv,start(l,n,a){wk(l,a)},stop(l){const n=l.titleBlock;ji.removeBox(l,n),delete l.titleBlock},beforeUpdate(l,n,a){const o=l.titleBlock;ji.configure(l,o,a),o.options=a},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Jf={average(l){if(!l.length)return!1;let n,a,o=new Set,s=0,e=0;for(n=0,a=l.length;n<a;++n){const v=l[n].element;if(v&&v.hasValue()){const w=v.tooltipPosition();o.add(w.x),s+=w.y,++e}}return e===0||o.size===0?!1:{x:[...o].reduce((v,w)=>v+w)/o.size,y:s/e}},nearest(l,n){if(!l.length)return!1;let a=n.x,o=n.y,s=Number.POSITIVE_INFINITY,e,m,v;for(e=0,m=l.length;e<m;++e){const w=l[e].element;if(w&&w.hasValue()){const N=w.getCenterPoint(),S=Y1(n,N);S<s&&(s=S,v=w)}}if(v){const w=v.tooltipPosition();a=w.x,o=w.y}return{x:a,y:o}}};function Hl(l,n){return n&&(ja(n)?Array.prototype.push.apply(l,n):l.push(n)),l}function _o(l){return(typeof l=="string"||l instanceof String)&&l.indexOf(`
`)>-1?l.split(`
`):l}function jk(l,n){const{element:a,datasetIndex:o,index:s}=n,e=l.getDatasetMeta(o).controller,{label:m,value:v}=e.getLabelAndValue(s);return{chart:l,label:m,parsed:e.getParsed(s),raw:l.data.datasets[o].data[s],formattedValue:v,dataset:e.getDataset(),dataIndex:s,datasetIndex:o,element:a}}function db(l,n){const a=l.chart.ctx,{body:o,footer:s,title:e}=l,{boxWidth:m,boxHeight:v}=n,w=rn(n.bodyFont),N=rn(n.titleFont),S=rn(n.footerFont),D=e.length,L=s.length,M=o.length,F=Ni(n.padding);let O=F.height,P=0,G=o.reduce((ke,xe)=>ke+xe.before.length+xe.lines.length+xe.after.length,0);if(G+=l.beforeBody.length+l.afterBody.length,D&&(O+=D*N.lineHeight+(D-1)*n.titleSpacing+n.titleMarginBottom),G){const ke=n.displayColors?Math.max(v,w.lineHeight):w.lineHeight;O+=M*ke+(G-M)*w.lineHeight+(G-1)*n.bodySpacing}L&&(O+=n.footerMarginTop+L*S.lineHeight+(L-1)*n.footerSpacing);let ae=0;const re=function(ke){P=Math.max(P,a.measureText(ke).width+ae)};return a.save(),a.font=N.string,vr(l.title,re),a.font=w.string,vr(l.beforeBody.concat(l.afterBody),re),ae=n.displayColors?m+2+n.boxPadding:0,vr(o,ke=>{vr(ke.before,re),vr(ke.lines,re),vr(ke.after,re)}),ae=0,a.font=S.string,vr(l.footer,re),a.restore(),P+=F.width,{width:P,height:O}}function Nk(l,n){const{y:a,height:o}=n;return a<o/2?"top":a>l.height-o/2?"bottom":"center"}function kk(l,n,a,o){const{x:s,width:e}=o,m=a.caretSize+a.caretPadding;if(l==="left"&&s+e+m>n.width||l==="right"&&s-e-m<0)return!0}function Ck(l,n,a,o){const{x:s,width:e}=a,{width:m,chartArea:{left:v,right:w}}=l;let N="center";return o==="center"?N=s<=(v+w)/2?"left":"right":s<=e/2?N="left":s>=m-e/2&&(N="right"),kk(N,l,n,a)&&(N="center"),N}function ub(l,n,a){const o=a.yAlign||n.yAlign||Nk(l,a);return{xAlign:a.xAlign||n.xAlign||Ck(l,n,a,o),yAlign:o}}function Sk(l,n){let{x:a,width:o}=l;return n==="right"?a-=o:n==="center"&&(a-=o/2),a}function Ak(l,n,a){let{y:o,height:s}=l;return n==="top"?o+=a:n==="bottom"?o-=s+a:o-=s/2,o}function hb(l,n,a,o){const{caretSize:s,caretPadding:e,cornerRadius:m}=l,{xAlign:v,yAlign:w}=a,N=s+e,{topLeft:S,topRight:D,bottomLeft:L,bottomRight:M}=Yu(m);let F=Sk(n,v);const O=Ak(n,w,N);return w==="center"?v==="left"?F+=N:v==="right"&&(F-=N):v==="left"?F-=Math.max(S,L)+s:v==="right"&&(F+=Math.max(D,M)+s),{x:sn(F,0,o.width-n.width),y:sn(O,0,o.height-n.height)}}function ep(l,n,a){const o=Ni(a.padding);return n==="center"?l.x+l.width/2:n==="right"?l.x+l.width-o.right:l.x+o.left}function fb(l){return Hl([],_o(l))}function Ek(l,n,a){return o0(l,{tooltip:n,tooltipItems:a,type:"tooltip"})}function mb(l,n){const a=n&&n.dataset&&n.dataset.tooltip&&n.dataset.tooltip.callbacks;return a?l.override(a):l}const vv={beforeTitle:Ao,title(l){if(l.length>0){const n=l[0],a=n.chart.data.labels,o=a?a.length:0;if(this&&this.options&&this.options.mode==="dataset")return n.dataset.label||"";if(n.label)return n.label;if(o>0&&n.dataIndex<o)return a[n.dataIndex]}return""},afterTitle:Ao,beforeBody:Ao,beforeLabel:Ao,label(l){if(this&&this.options&&this.options.mode==="dataset")return l.label+": "+l.formattedValue||l.formattedValue;let n=l.dataset.label||"";n&&(n+=": ");const a=l.formattedValue;return hr(a)||(n+=a),n},labelColor(l){const a=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{borderColor:a.borderColor,backgroundColor:a.backgroundColor,borderWidth:a.borderWidth,borderDash:a.borderDash,borderDashOffset:a.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(l){const a=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{pointStyle:a.pointStyle,rotation:a.rotation}},afterLabel:Ao,afterBody:Ao,beforeFooter:Ao,footer:Ao,afterFooter:Ao};function Rn(l,n,a,o){const s=l[n].call(a,o);return typeof s>"u"?vv[n].call(a,o):s}class gb extends Po{static positioners=Jf;constructor(n){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=n.chart,this.options=n.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(n){this.options=n,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const n=this._cachedAnimations;if(n)return n;const a=this.chart,o=this.options.setContext(this.getContext()),s=o.enabled&&a.options.animation&&o.animations,e=new ev(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(e)),e}getContext(){return this.$context||(this.$context=Ek(this.chart.getContext(),this,this._tooltipItems))}getTitle(n,a){const{callbacks:o}=a,s=Rn(o,"beforeTitle",this,n),e=Rn(o,"title",this,n),m=Rn(o,"afterTitle",this,n);let v=[];return v=Hl(v,_o(s)),v=Hl(v,_o(e)),v=Hl(v,_o(m)),v}getBeforeBody(n,a){return fb(Rn(a.callbacks,"beforeBody",this,n))}getBody(n,a){const{callbacks:o}=a,s=[];return vr(n,e=>{const m={before:[],lines:[],after:[]},v=mb(o,e);Hl(m.before,_o(Rn(v,"beforeLabel",this,e))),Hl(m.lines,Rn(v,"label",this,e)),Hl(m.after,_o(Rn(v,"afterLabel",this,e))),s.push(m)}),s}getAfterBody(n,a){return fb(Rn(a.callbacks,"afterBody",this,n))}getFooter(n,a){const{callbacks:o}=a,s=Rn(o,"beforeFooter",this,n),e=Rn(o,"footer",this,n),m=Rn(o,"afterFooter",this,n);let v=[];return v=Hl(v,_o(s)),v=Hl(v,_o(e)),v=Hl(v,_o(m)),v}_createItems(n){const a=this._active,o=this.chart.data,s=[],e=[],m=[];let v=[],w,N;for(w=0,N=a.length;w<N;++w)v.push(jk(this.chart,a[w]));return n.filter&&(v=v.filter((S,D,L)=>n.filter(S,D,L,o))),n.itemSort&&(v=v.sort((S,D)=>n.itemSort(S,D,o))),vr(v,S=>{const D=mb(n.callbacks,S);s.push(Rn(D,"labelColor",this,S)),e.push(Rn(D,"labelPointStyle",this,S)),m.push(Rn(D,"labelTextColor",this,S))}),this.labelColors=s,this.labelPointStyles=e,this.labelTextColors=m,this.dataPoints=v,v}update(n,a){const o=this.options.setContext(this.getContext()),s=this._active;let e,m=[];if(!s.length)this.opacity!==0&&(e={opacity:0});else{const v=Jf[o.position].call(this,s,this._eventPosition);m=this._createItems(o),this.title=this.getTitle(m,o),this.beforeBody=this.getBeforeBody(m,o),this.body=this.getBody(m,o),this.afterBody=this.getAfterBody(m,o),this.footer=this.getFooter(m,o);const w=this._size=db(this,o),N=Object.assign({},v,w),S=ub(this.chart,o,N),D=hb(o,N,S,this.chart);this.xAlign=S.xAlign,this.yAlign=S.yAlign,e={opacity:1,x:D.x,y:D.y,width:w.width,height:w.height,caretX:v.x,caretY:v.y}}this._tooltipItems=m,this.$context=void 0,e&&this._resolveAnimations().update(this,e),n&&o.external&&o.external.call(this,{chart:this.chart,tooltip:this,replay:a})}drawCaret(n,a,o,s){const e=this.getCaretPosition(n,o,s);a.lineTo(e.x1,e.y1),a.lineTo(e.x2,e.y2),a.lineTo(e.x3,e.y3)}getCaretPosition(n,a,o){const{xAlign:s,yAlign:e}=this,{caretSize:m,cornerRadius:v}=o,{topLeft:w,topRight:N,bottomLeft:S,bottomRight:D}=Yu(v),{x:L,y:M}=n,{width:F,height:O}=a;let P,G,ae,re,ke,xe;return e==="center"?(ke=M+O/2,s==="left"?(P=L,G=P-m,re=ke+m,xe=ke-m):(P=L+F,G=P+m,re=ke-m,xe=ke+m),ae=P):(s==="left"?G=L+Math.max(w,S)+m:s==="right"?G=L+F-Math.max(N,D)-m:G=this.caretX,e==="top"?(re=M,ke=re-m,P=G-m,ae=G+m):(re=M+O,ke=re+m,P=G+m,ae=G-m),xe=re),{x1:P,x2:G,x3:ae,y1:re,y2:ke,y3:xe}}drawTitle(n,a,o){const s=this.title,e=s.length;let m,v,w;if(e){const N=Gu(o.rtl,this.x,this.width);for(n.x=ep(this,o.titleAlign,o),a.textAlign=N.textAlign(o.titleAlign),a.textBaseline="middle",m=rn(o.titleFont),v=o.titleSpacing,a.fillStyle=o.titleColor,a.font=m.string,w=0;w<e;++w)a.fillText(s[w],N.x(n.x),n.y+m.lineHeight/2),n.y+=m.lineHeight+v,w+1===e&&(n.y+=o.titleMarginBottom-v)}}_drawColorBox(n,a,o,s,e){const m=this.labelColors[o],v=this.labelPointStyles[o],{boxHeight:w,boxWidth:N}=e,S=rn(e.bodyFont),D=ep(this,"left",e),L=s.x(D),M=w<S.lineHeight?(S.lineHeight-w)/2:0,F=a.y+M;if(e.usePointStyle){const O={radius:Math.min(N,w)/2,pointStyle:v.pointStyle,rotation:v.rotation,borderWidth:1},P=s.leftForLtr(L,N)+N/2,G=F+w/2;n.strokeStyle=e.multiKeyBackground,n.fillStyle=e.multiKeyBackground,K1(n,O,P,G),n.strokeStyle=m.borderColor,n.fillStyle=m.backgroundColor,K1(n,O,P,G)}else{n.lineWidth=Qs(m.borderWidth)?Math.max(...Object.values(m.borderWidth)):m.borderWidth||1,n.strokeStyle=m.borderColor,n.setLineDash(m.borderDash||[]),n.lineDashOffset=m.borderDashOffset||0;const O=s.leftForLtr(L,N),P=s.leftForLtr(s.xPlus(L,1),N-2),G=Yu(m.borderRadius);Object.values(G).some(ae=>ae!==0)?(n.beginPath(),n.fillStyle=e.multiKeyBackground,wp(n,{x:O,y:F,w:N,h:w,radius:G}),n.fill(),n.stroke(),n.fillStyle=m.backgroundColor,n.beginPath(),wp(n,{x:P,y:F+1,w:N-2,h:w-2,radius:G}),n.fill()):(n.fillStyle=e.multiKeyBackground,n.fillRect(O,F,N,w),n.strokeRect(O,F,N,w),n.fillStyle=m.backgroundColor,n.fillRect(P,F+1,N-2,w-2))}n.fillStyle=this.labelTextColors[o]}drawBody(n,a,o){const{body:s}=this,{bodySpacing:e,bodyAlign:m,displayColors:v,boxHeight:w,boxWidth:N,boxPadding:S}=o,D=rn(o.bodyFont);let L=D.lineHeight,M=0;const F=Gu(o.rtl,this.x,this.width),O=function(ce){a.fillText(ce,F.x(n.x+M),n.y+L/2),n.y+=L+e},P=F.textAlign(m);let G,ae,re,ke,xe,je,Z;for(a.textAlign=m,a.textBaseline="middle",a.font=D.string,n.x=ep(this,P,o),a.fillStyle=o.bodyColor,vr(this.beforeBody,O),M=v&&P!=="right"?m==="center"?N/2+S:N+2+S:0,ke=0,je=s.length;ke<je;++ke){for(G=s[ke],ae=this.labelTextColors[ke],a.fillStyle=ae,vr(G.before,O),re=G.lines,v&&re.length&&(this._drawColorBox(a,n,ke,F,o),L=Math.max(D.lineHeight,w)),xe=0,Z=re.length;xe<Z;++xe)O(re[xe]),L=D.lineHeight;vr(G.after,O)}M=0,L=D.lineHeight,vr(this.afterBody,O),n.y-=e}drawFooter(n,a,o){const s=this.footer,e=s.length;let m,v;if(e){const w=Gu(o.rtl,this.x,this.width);for(n.x=ep(this,o.footerAlign,o),n.y+=o.footerMarginTop,a.textAlign=w.textAlign(o.footerAlign),a.textBaseline="middle",m=rn(o.footerFont),a.fillStyle=o.footerColor,a.font=m.string,v=0;v<e;++v)a.fillText(s[v],w.x(n.x),n.y+m.lineHeight/2),n.y+=m.lineHeight+o.footerSpacing}}drawBackground(n,a,o,s){const{xAlign:e,yAlign:m}=this,{x:v,y:w}=n,{width:N,height:S}=o,{topLeft:D,topRight:L,bottomLeft:M,bottomRight:F}=Yu(s.cornerRadius);a.fillStyle=s.backgroundColor,a.strokeStyle=s.borderColor,a.lineWidth=s.borderWidth,a.beginPath(),a.moveTo(v+D,w),m==="top"&&this.drawCaret(n,a,o,s),a.lineTo(v+N-L,w),a.quadraticCurveTo(v+N,w,v+N,w+L),m==="center"&&e==="right"&&this.drawCaret(n,a,o,s),a.lineTo(v+N,w+S-F),a.quadraticCurveTo(v+N,w+S,v+N-F,w+S),m==="bottom"&&this.drawCaret(n,a,o,s),a.lineTo(v+M,w+S),a.quadraticCurveTo(v,w+S,v,w+S-M),m==="center"&&e==="left"&&this.drawCaret(n,a,o,s),a.lineTo(v,w+D),a.quadraticCurveTo(v,w,v+D,w),a.closePath(),a.fill(),s.borderWidth>0&&a.stroke()}_updateAnimationTarget(n){const a=this.chart,o=this.$animations,s=o&&o.x,e=o&&o.y;if(s||e){const m=Jf[n.position].call(this,this._active,this._eventPosition);if(!m)return;const v=this._size=db(this,n),w=Object.assign({},m,this._size),N=ub(a,n,w),S=hb(n,w,N,a);(s._to!==S.x||e._to!==S.y)&&(this.xAlign=N.xAlign,this.yAlign=N.yAlign,this.width=v.width,this.height=v.height,this.caretX=m.x,this.caretY=m.y,this._resolveAnimations().update(this,S))}}_willRender(){return!!this.opacity}draw(n){const a=this.options.setContext(this.getContext());let o=this.opacity;if(!o)return;this._updateAnimationTarget(a);const s={width:this.width,height:this.height},e={x:this.x,y:this.y};o=Math.abs(o)<.001?0:o;const m=Ni(a.padding),v=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;a.enabled&&v&&(n.save(),n.globalAlpha=o,this.drawBackground(e,n,s,a),Gy(n,a.textDirection),e.y+=m.top,this.drawTitle(e,n,a),this.drawBody(e,n,a),this.drawFooter(e,n,a),Ky(n,a.textDirection),n.restore())}getActiveElements(){return this._active||[]}setActiveElements(n,a){const o=this._active,s=n.map(({datasetIndex:v,index:w})=>{const N=this.chart.getDatasetMeta(v);if(!N)throw new Error("Cannot find a dataset at index "+v);return{datasetIndex:v,element:N.data[w],index:w}}),e=!bp(o,s),m=this._positionChanged(s,a);(e||m)&&(this._active=s,this._eventPosition=a,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(n,a,o=!0){if(a&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,e=this._active||[],m=this._getActiveElements(n,e,a,o),v=this._positionChanged(m,n),w=a||!bp(m,e)||v;return w&&(this._active=m,(s.enabled||s.external)&&(this._eventPosition={x:n.x,y:n.y},this.update(!0,a))),w}_getActiveElements(n,a,o,s){const e=this.options;if(n.type==="mouseout")return[];if(!s)return a.filter(v=>this.chart.data.datasets[v.datasetIndex]&&this.chart.getDatasetMeta(v.datasetIndex).controller.getParsed(v.index)!==void 0);const m=this.chart.getElementsAtEventForMode(n,e.mode,e,o);return e.reverse&&m.reverse(),m}_positionChanged(n,a){const{caretX:o,caretY:s,options:e}=this,m=Jf[e.position].call(this,n,a);return m!==!1&&(o!==m.x||s!==m.y)}}var qc={id:"tooltip",_element:gb,positioners:Jf,afterInit(l,n,a){a&&(l.tooltip=new gb({chart:l,options:a}))},beforeUpdate(l,n,a){l.tooltip&&l.tooltip.initialize(a)},reset(l,n,a){l.tooltip&&l.tooltip.initialize(a)},afterDraw(l){const n=l.tooltip;if(n&&n._willRender()){const a={tooltip:n};if(l.notifyPlugins("beforeTooltipDraw",{...a,cancelable:!0})===!1)return;n.draw(l.ctx),l.notifyPlugins("afterTooltipDraw",a)}},afterEvent(l,n){if(l.tooltip){const a=n.replay;l.tooltip.handleEvent(n.event,a,n.inChartArea)&&(n.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(l,n)=>n.bodyFont.size,boxWidth:(l,n)=>n.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:vv},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:l=>l!=="filter"&&l!=="itemSort"&&l!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Dk=(l,n,a,o)=>(typeof n=="string"?(a=l.push(n)-1,o.unshift({index:a,label:n})):isNaN(n)&&(a=null),a);function Tk(l,n,a,o){const s=l.indexOf(n);if(s===-1)return Dk(l,n,a,o);const e=l.lastIndexOf(n);return s!==e?a:s}const _k=(l,n)=>l===null?null:sn(Math.round(l),0,n);function pb(l){const n=this.getLabels();return l>=0&&l<n.length?n[l]:l}class Yc extends ah{static id="category";static defaults={ticks:{callback:pb}};constructor(n){super(n),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(n){const a=this._addedLabels;if(a.length){const o=this.getLabels();for(const{index:s,label:e}of a)o[s]===e&&o.splice(s,1);this._addedLabels=[]}super.init(n)}parse(n,a){if(hr(n))return null;const o=this.getLabels();return a=isFinite(a)&&o[a]===n?a:Tk(o,n,Ts(a,n),this._addedLabels),_k(a,o.length-1)}determineDataLimits(){const{minDefined:n,maxDefined:a}=this.getUserBounds();let{min:o,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(n||(o=0),a||(s=this.getLabels().length-1)),this.min=o,this.max=s}buildTicks(){const n=this.min,a=this.max,o=this.options.offset,s=[];let e=this.getLabels();e=n===0&&a===e.length-1?e:e.slice(n,a+1),this._valueRange=Math.max(e.length-(o?0:1),1),this._startValue=this.min-(o?.5:0);for(let m=n;m<=a;m++)s.push({value:m});return s}getLabelForValue(n){return pb.call(this,n)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(n){return typeof n!="number"&&(n=this.parse(n)),n===null?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getPixelForTick(n){const a=this.ticks;return n<0||n>a.length-1?null:this.getPixelForValue(a[n].value)}getValueForPixel(n){return Math.round(this._startValue+this.getDecimalForPixel(n)*this._valueRange)}getBasePixel(){return this.bottom}}function Fk(l,n){const a=[],{bounds:s,step:e,min:m,max:v,precision:w,count:N,maxTicks:S,maxDigits:D,includeBounds:L}=l,M=e||1,F=S-1,{min:O,max:P}=n,G=!hr(m),ae=!hr(v),re=!hr(N),ke=(P-O)/(D+1);let xe=h2((P-O)/F/M)*M,je,Z,ce,ue;if(xe<1e-14&&!G&&!ae)return[{value:O},{value:P}];ue=Math.ceil(P/xe)-Math.floor(O/xe),ue>F&&(xe=h2(ue*xe/F/M)*M),hr(w)||(je=Math.pow(10,w),xe=Math.ceil(xe*je)/je),s==="ticks"?(Z=Math.floor(O/xe)*xe,ce=Math.ceil(P/xe)*xe):(Z=O,ce=P),G&&ae&&e&&L3((v-m)/e,xe/1e3)?(ue=Math.round(Math.min((v-m)/xe,S)),xe=(v-m)/ue,Z=m,ce=v):re?(Z=G?m:Z,ce=ae?v:ce,ue=N-1,xe=(ce-Z)/ue):(ue=(ce-Z)/xe,em(ue,Math.round(ue),xe/1e3)?ue=Math.round(ue):ue=Math.ceil(ue));const Re=Math.max(f2(xe),f2(Z));je=Math.pow(10,hr(w)?Re:w),Z=Math.round(Z*je)/je,ce=Math.round(ce*je)/je;let be=0;for(G&&(L&&Z!==m?(a.push({value:m}),Z<m&&be++,em(Math.round((Z+be*xe)*je)/je,m,xb(m,ke,l))&&be++):Z<m&&be++);be<ue;++be){const oe=Math.round((Z+be*xe)*je)/je;if(ae&&oe>v)break;a.push({value:oe})}return ae&&L&&ce!==v?a.length&&em(a[a.length-1].value,v,xb(v,ke,l))?a[a.length-1].value=v:a.push({value:v}):(!ae||ce===v)&&a.push({value:ce}),a}function xb(l,n,{horizontal:a,minRotation:o}){const s=Wl(o),e=(a?Math.sin(s):Math.cos(s))||.001,m=.75*n*(""+l).length;return Math.min(n/e,m)}class Mk extends ah{constructor(n){super(n),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(n,a){return hr(n)||(typeof n=="number"||n instanceof Number)&&!isFinite(+n)?null:+n}handleTickRangeOptions(){const{beginAtZero:n}=this.options,{minDefined:a,maxDefined:o}=this.getUserBounds();let{min:s,max:e}=this;const m=w=>s=a?s:w,v=w=>e=o?e:w;if(n){const w=$l(s),N=$l(e);w<0&&N<0?v(0):w>0&&N>0&&m(0)}if(s===e){let w=e===0?1:Math.abs(e*.05);v(e+w),n||m(s-w)}this.min=s,this.max=e}getTickLimit(){const n=this.options.ticks;let{maxTicksLimit:a,stepSize:o}=n,s;return o?(s=Math.ceil(this.max/o)-Math.floor(this.min/o)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${o} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),a=a||11),a&&(s=Math.min(a,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const n=this.options,a=n.ticks;let o=this.getTickLimit();o=Math.max(2,o);const s={maxTicks:o,bounds:n.bounds,min:n.min,max:n.max,precision:a.precision,step:a.stepSize,count:a.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:a.minRotation||0,includeBounds:a.includeBounds!==!1},e=this._range||this,m=Fk(s,e);return n.bounds==="ticks"&&R3(m,this,"value"),n.reverse?(m.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),m}configure(){const n=this.ticks;let a=this.min,o=this.max;if(super.configure(),this.options.offset&&n.length){const s=(o-a)/Math.max(n.length-1,1)/2;a-=s,o+=s}this._startValue=a,this._endValue=o,this._valueRange=o-a}getLabelForValue(n){return Fp(n,this.chart.options.locale,this.options.ticks.format)}}class Gc extends Mk{static id="linear";static defaults={ticks:{callback:By.formatters.numeric}};determineDataLimits(){const{min:n,max:a}=this.getMinMax(!0);this.min=an(n)?n:0,this.max=an(a)?a:1,this.handleTickRangeOptions()}computeTickLimit(){const n=this.isHorizontal(),a=n?this.width:this.height,o=Wl(this.options.ticks.minRotation),s=(n?Math.sin(o):Math.cos(o))||.001,e=this._resolveTickFontOptions(0);return Math.ceil(a/Math.min(40,e.lineHeight/s))}getPixelForValue(n){return n===null?NaN:this.getPixelForDecimal((n-this._startValue)/this._valueRange)}getValueForPixel(n){return this._startValue+this.getDecimalForPixel(n)*this._valueRange}}const Bp={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Pn=Object.keys(Bp);function bb(l,n){return l-n}function yb(l,n){if(hr(n))return null;const a=l._adapter,{parser:o,round:s,isoWeekday:e}=l._parseOpts;let m=n;return typeof o=="function"&&(m=o(m)),an(m)||(m=typeof o=="string"?a.parse(m,o):a.parse(m)),m===null?null:(s&&(m=s==="week"&&(Qu(e)||e===!0)?a.startOf(m,"isoWeek",e):a.startOf(m,s)),+m)}function vb(l,n,a,o){const s=Pn.length;for(let e=Pn.indexOf(l);e<s-1;++e){const m=Bp[Pn[e]],v=m.steps?m.steps:Number.MAX_SAFE_INTEGER;if(m.common&&Math.ceil((a-n)/(v*m.size))<=o)return Pn[e]}return Pn[s-1]}function Lk(l,n,a,o,s){for(let e=Pn.length-1;e>=Pn.indexOf(a);e--){const m=Pn[e];if(Bp[m].common&&l._adapter.diff(s,o,m)>=n-1)return m}return Pn[a?Pn.indexOf(a):0]}function Rk(l){for(let n=Pn.indexOf(l)+1,a=Pn.length;n<a;++n)if(Bp[Pn[n]].common)return Pn[n]}function wb(l,n,a){if(!a)l[n]=!0;else if(a.length){const{lo:o,hi:s}=px(a,n),e=a[o]>=n?a[o]:a[s];l[e]=!0}}function Ok(l,n,a,o){const s=l._adapter,e=+s.startOf(n[0].value,o),m=n[n.length-1].value;let v,w;for(v=e;v<=m;v=+s.add(v,1,o))w=a[v],w>=0&&(n[w].major=!0);return n}function jb(l,n,a){const o=[],s={},e=n.length;let m,v;for(m=0;m<e;++m)v=n[m],s[v]=m,o.push({value:v,major:!1});return e===0||!a?o:Ok(l,o,s,a)}class Nb extends ah{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(n){super(n),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(n,a={}){const o=n.time||(n.time={}),s=this._adapter=new j6._date(n.adapters.date);s.init(a),Zf(o.displayFormats,s.formats()),this._parseOpts={parser:o.parser,round:o.round,isoWeekday:o.isoWeekday},super.init(n),this._normalized=a.normalized}parse(n,a){return n===void 0?null:yb(this,n)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const n=this.options,a=this._adapter,o=n.time.unit||"day";let{min:s,max:e,minDefined:m,maxDefined:v}=this.getUserBounds();function w(N){!m&&!isNaN(N.min)&&(s=Math.min(s,N.min)),!v&&!isNaN(N.max)&&(e=Math.max(e,N.max))}(!m||!v)&&(w(this._getLabelBounds()),(n.bounds!=="ticks"||n.ticks.source!=="labels")&&w(this.getMinMax(!1))),s=an(s)&&!isNaN(s)?s:+a.startOf(Date.now(),o),e=an(e)&&!isNaN(e)?e:+a.endOf(Date.now(),o)+1,this.min=Math.min(s,e-1),this.max=Math.max(s+1,e)}_getLabelBounds(){const n=this.getLabelTimestamps();let a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return n.length&&(a=n[0],o=n[n.length-1]),{min:a,max:o}}buildTicks(){const n=this.options,a=n.time,o=n.ticks,s=o.source==="labels"?this.getLabelTimestamps():this._generate();n.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const e=this.min,m=this.max,v=z3(s,e,m);return this._unit=a.unit||(o.autoSkip?vb(a.minUnit,this.min,this.max,this._getLabelCapacity(e)):Lk(this,v.length,a.minUnit,this.min,this.max)),this._majorUnit=!o.major.enabled||this._unit==="year"?void 0:Rk(this._unit),this.initOffsets(s),n.reverse&&v.reverse(),jb(this,v,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(n=>+n.value))}initOffsets(n=[]){let a=0,o=0,s,e;this.options.offset&&n.length&&(s=this.getDecimalForValue(n[0]),n.length===1?a=1-s:a=(this.getDecimalForValue(n[1])-s)/2,e=this.getDecimalForValue(n[n.length-1]),n.length===1?o=e:o=(e-this.getDecimalForValue(n[n.length-2]))/2);const m=n.length<3?.5:.25;a=sn(a,0,m),o=sn(o,0,m),this._offsets={start:a,end:o,factor:1/(a+1+o)}}_generate(){const n=this._adapter,a=this.min,o=this.max,s=this.options,e=s.time,m=e.unit||vb(e.minUnit,a,o,this._getLabelCapacity(a)),v=Ts(s.ticks.stepSize,1),w=m==="week"?e.isoWeekday:!1,N=Qu(w)||w===!0,S={};let D=a,L,M;if(N&&(D=+n.startOf(D,"isoWeek",w)),D=+n.startOf(D,N?"day":m),n.diff(o,a,m)>1e5*v)throw new Error(a+" and "+o+" are too far apart with stepSize of "+v+" "+m);const F=s.ticks.source==="data"&&this.getDataTimestamps();for(L=D,M=0;L<o;L=+n.add(L,v,m),M++)wb(S,L,F);return(L===o||s.bounds==="ticks"||M===1)&&wb(S,L,F),Object.keys(S).sort(bb).map(O=>+O)}getLabelForValue(n){const a=this._adapter,o=this.options.time;return o.tooltipFormat?a.format(n,o.tooltipFormat):a.format(n,o.displayFormats.datetime)}format(n,a){const s=this.options.time.displayFormats,e=this._unit,m=a||s[e];return this._adapter.format(n,m)}_tickFormatFunction(n,a,o,s){const e=this.options,m=e.ticks.callback;if(m)return Hr(m,[n,a,o],this);const v=e.time.displayFormats,w=this._unit,N=this._majorUnit,S=w&&v[w],D=N&&v[N],L=o[a],M=N&&D&&L&&L.major;return this._adapter.format(n,s||(M?D:S))}generateTickLabels(n){let a,o,s;for(a=0,o=n.length;a<o;++a)s=n[a],s.label=this._tickFormatFunction(s.value,a,n)}getDecimalForValue(n){return n===null?NaN:(n-this.min)/(this.max-this.min)}getPixelForValue(n){const a=this._offsets,o=this.getDecimalForValue(n);return this.getPixelForDecimal((a.start+o)*a.factor)}getValueForPixel(n){const a=this._offsets,o=this.getDecimalForPixel(n)/a.factor-a.end;return this.min+o*(this.max-this.min)}_getLabelSize(n){const a=this.options.ticks,o=this.ctx.measureText(n).width,s=Wl(this.isHorizontal()?a.maxRotation:a.minRotation),e=Math.cos(s),m=Math.sin(s),v=this._resolveTickFontOptions(0).size;return{w:o*e+v*m,h:o*m+v*e}}_getLabelCapacity(n){const a=this.options.time,o=a.displayFormats,s=o[a.unit]||o.millisecond,e=this._tickFormatFunction(n,0,jb(this,[n],this._majorUnit),s),m=this._getLabelSize(e),v=Math.floor(this.isHorizontal()?this.width/m.w:this.height/m.h)-1;return v>0?v:1}getDataTimestamps(){let n=this._cache.data||[],a,o;if(n.length)return n;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(a=0,o=s.length;a<o;++a)n=n.concat(s[a].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const n=this._cache.labels||[];let a,o;if(n.length)return n;const s=this.getLabels();for(a=0,o=s.length;a<o;++a)n.push(yb(this,s[a]));return this._cache.labels=this._normalized?n:this.normalize(n)}normalize(n){return Ly(n.sort(bb))}}function tp(l,n,a){let o=0,s=l.length-1,e,m,v,w;a?(n>=l[o].pos&&n<=l[s].pos&&({lo:o,hi:s}=e0(l,"pos",n)),{pos:e,time:v}=l[o],{pos:m,time:w}=l[s]):(n>=l[o].time&&n<=l[s].time&&({lo:o,hi:s}=e0(l,"time",n)),{time:e,pos:v}=l[o],{time:m,pos:w}=l[s]);const N=m-e;return N?v+(w-v)*(n-e)/N:v}class oC extends Nb{static id="timeseries";static defaults=Nb.defaults;constructor(n){super(n),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const n=this._getTimestampsForTable(),a=this._table=this.buildLookupTable(n);this._minPos=tp(a,this.min),this._tableRange=tp(a,this.max)-this._minPos,super.initOffsets(n)}buildLookupTable(n){const{min:a,max:o}=this,s=[],e=[];let m,v,w,N,S;for(m=0,v=n.length;m<v;++m)N=n[m],N>=a&&N<=o&&s.push(N);if(s.length<2)return[{time:a,pos:0},{time:o,pos:1}];for(m=0,v=s.length;m<v;++m)S=s[m+1],w=s[m-1],N=s[m],Math.round((S+w)/2)!==N&&e.push({time:N,pos:m/(v-1)});return e}_generate(){const n=this.min,a=this.max;let o=super.getDataTimestamps();return(!o.includes(n)||!o.length)&&o.splice(0,0,n),(!o.includes(a)||o.length===1)&&o.push(a),o.sort((s,e)=>s-e)}_getTimestampsForTable(){let n=this._cache.all||[];if(n.length)return n;const a=this.getDataTimestamps(),o=this.getLabelTimestamps();return a.length&&o.length?n=this.normalize(a.concat(o)):n=a.length?a:o,n=this._cache.all=n,n}getDecimalForValue(n){return(tp(this._table,n)-this._minPos)/this._tableRange}getValueForPixel(n){const a=this._offsets,o=this.getDecimalForPixel(n)/a.factor-a.end;return tp(this._table,o*this._tableRange+this._minPos,!0)}}const Pk=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),[]).then(l=>({default:l.Line}))),_1=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Bar}))),Ik=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Doughnut}))),Bk=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Pie})));nl.register(Yc,Gc,Hc,il,Vc,bm,$c,qc,Wc);let F1=null,kb=0;const zk=60*1e3;function Uk(){const[l,n]=B.useState(null),[a,o]=B.useState(!0),[s,e]=B.useState("overview");Tr(),B.useEffect(()=>{let D=!0;const L=new AbortController,M=async(F=!0)=>{try{const O=Date.now();if(F&&F1&&O-kb<zk){D&&(n(F1),o(!1));return}o(!0);const P=await Vt.get("/dashboard/stats",{signal:L.signal,timeout:3e4,headers:{"Cache-Control":"max-age=300"}}),G=P.data?.data||P.data;D&&(n(G),F1=G,kb=Date.now())}catch(O){!(O.name==="CanceledError"||O.message==="canceled"||O.code==="ERR_CANCELED"||O.config&&O.config.signal&&O.config.signal.aborted)&&D&&(console.error("Error fetching dashboard stats:",O),O.code==="ECONNABORTED"&&console.error("Request timeout - dashboard data is taking too long to load"))}finally{D&&o(!1)}};return M(!0),M(!1),()=>{D=!1,L.signal.aborted||L.abort()}},[]);const m=[{id:"overview",label:"Overview",icon:"grid"},{id:"industry",label:"Industry",icon:"building"},{id:"geography",label:"Geography",icon:"globe"},{id:"designation",label:"Designation & Persona",icon:"briefcase"},{id:"data-quality",label:"Data Quality",icon:"shield"},{id:"ownership",label:"Ownership & Team",icon:"users"}],v=B.useMemo(()=>{if(!l)return{overallScore:0,completeness:0,deduplication:100,freshness:0};const D=l.totalContacts||0,L=D>0?Math.round(((l.emailValidity?.valid||0)/D*.3+(l.outreachReady?.value||0)/D*.3+(l.enrichmentCoverage?.value||0)/D*.2+(1-(l.duplicateRecords?.value||0)/D)*.2)*100):0,M=D>0?Math.round((l.outreachReady?.value||0)/D*100):0,F=D>0?Math.round((1-(l.duplicateRecords?.value||0)/D)*100):100,O=l.enrichmentCoverage?.percent?Math.round(l.enrichmentCoverage.percent):0;return{overallScore:L,completeness:M,deduplication:F,freshness:O}},[l?.totalContacts,l?.emailValidity?.valid,l?.outreachReady?.value,l?.enrichmentCoverage?.value,l?.duplicateRecords?.value,l?.enrichmentCoverage?.percent]),w=B.useMemo(()=>{if(!l?.topIndustries||l.topIndustries.length===0)return null;const D=l.topIndustries.slice(0,5),L=D.reduce((G,ae)=>G+(ae.count||0),0),M=l.topIndustries.reduce((G,ae)=>G+(ae.count||0),0),F=M-L,O=D.map(G=>({label:G.name,value:G.count||0,percentage:M>0?Math.round((G.count||0)/M*100):0}));F>0&&O.push({label:"Others",value:F,percentage:Math.round(F/M*100)});const P=["rgb(59, 130, 246)","rgb(34, 197, 94)","rgb(249, 115, 22)","rgb(239, 68, 68)","rgb(168, 85, 247)","rgb(156, 163, 175)"];return{labels:O.map(G=>`${G.label}: ${G.percentage}%`),data:O.map(G=>G.value),colors:P.slice(0,O.length)}},[l?.topIndustries]),N=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2 mb-2"}),t.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]});if(a)return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-4 animate-pulse"}),t.jsx("div",{className:"h-10 bg-gray-200 rounded w-full animate-pulse"})]})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((D,L)=>t.jsx(N,{},L))})})]});if(!l)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsx("div",{className:"text-center",children:t.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data"})})});const S=B.memo(({title:D,value:L,trend:M,trendDirection:F,icon:O,subtitle:P,percent:G})=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:D}),t.jsx("div",{className:"flex items-baseline gap-2",children:t.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:[typeof L=="number"?L.toLocaleString():L,G&&t.jsxs("span",{className:"text-lg text-gray-500 ml-1",children:["(",G,"%)"]})]})}),P&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:P})]}),t.jsxs("div",{className:"text-gray-400",children:[O==="people"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),O==="building"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),O==="plus"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),O==="check"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),O==="sparkle"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),O==="clock"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),O==="envelope"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),O==="exclamation"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),O==="ban"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})}),O==="duplicate"&&t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})]})]}),M&&t.jsxs("div",{className:`flex items-center gap-1 text-sm ${F==="up"?"text-green-600":"text-red-600"}`,children:[t.jsx("svg",{className:`w-4 h-4 ${F==="down"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),t.jsx("span",{children:M})]})]}));return B.memo(({type:D,title:L,description:M,action:F,actionLabel:O})=>{const P={success:{bg:"bg-green-50",border:"border-green-200",icon:"text-green-600",text:"text-green-800"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:"text-yellow-600",text:"text-yellow-800"},error:{bg:"bg-red-50",border:"border-red-200",icon:"text-red-600",text:"text-red-800"}},G=P[D]||P.success;return t.jsx("div",{className:`${G.bg} border ${G.border} rounded-lg p-6`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsxs("div",{className:`${G.icon} flex-shrink-0`,children:[D==="success"&&t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),D==="warning"&&t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),D==="error"&&t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:`font-semibold ${G.text} mb-2`,children:L}),t.jsx("p",{className:`text-sm ${G.text} mb-4`,children:M}),F&&t.jsxs("button",{onClick:F,className:"text-blue-600 hover:text-blue-800 font-medium text-sm flex items-center gap-1",children:[O,t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})})}),t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Monitor your contact and account data performance"})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:m.map(D=>t.jsxs("button",{onClick:()=>e(D.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${s===D.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[D.icon==="grid"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),D.icon==="building"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),D.icon==="globe"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 002 2h2.945M15 6.055V5a2 2 0 012-2h3.055M21 12.055V19a2 2 0 01-2 2h-3.055M9 3.055V5a2 2 0 012-2h2.945M9 20.945V19a2 2 0 012-2h2.945M21 3.055V5a2 2 0 00-2 2h-3.055M9 20.945V19a2 2 0 00-2-2H3.055"})}),D.icon==="briefcase"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),D.icon==="shield"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),D.icon==="users"&&t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),D.label]},D.id))})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsx(S,{title:"Total Contacts",value:l.totalContacts?.value||0,trend:l.totalContacts?.trend,trendDirection:l.totalContacts?.trendDirection,icon:"people"}),t.jsx(S,{title:"Total Accounts",value:l.totalAccounts?.value||0,trend:l.totalAccounts?.trend,trendDirection:l.totalAccounts?.trendDirection,icon:"building"}),t.jsx(S,{title:"New Contacts",value:l.newContacts?.value||0,trend:l.newContacts?.trend,trendDirection:l.newContacts?.trendDirection,icon:"plus",subtitle:"This month"}),t.jsx(S,{title:"Outreach Ready",value:l.outreachReady?.value||0,percent:l.outreachReady?.percent,trend:l.outreachReady?.trend,trendDirection:l.outreachReady?.trendDirection,icon:"check"}),t.jsx(S,{title:"Enrichment Coverage",value:l.enrichmentCoverage?.percent||0,subtitle:`${l.enrichmentCoverage?.value||0} contacts enriched`,trend:l.enrichmentCoverage?.trend,trendDirection:l.enrichmentCoverage?.trendDirection,icon:"sparkle"}),t.jsx(S,{title:"Stale Enrichment",value:l.staleEnrichment?.value||0,subtitle:">90 days old",trend:l.staleEnrichment?.trend,trendDirection:l.staleEnrichment?.trendDirection,icon:"clock"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(S,{title:"Email Validity",value:l.emailValidity?.percent||0,subtitle:`${l.emailValidity?.valid||0} valid`,trend:l.emailValidity?.trend,trendDirection:l.emailValidity?.trendDirection,icon:"envelope"}),t.jsx(S,{title:"Missing Titles",value:l.missingTitles?.value||0,percent:l.missingTitles?.percent,trend:l.missingTitles?.trend,trendDirection:l.missingTitles?.trendDirection,icon:"exclamation"}),t.jsx(S,{title:"DNC Contacts",value:l.dncContacts?.value||0,percent:l.dncContacts?.percent,trend:l.dncContacts?.trend,trendDirection:l.dncContacts?.trendDirection,icon:"ban"}),t.jsx(S,{title:"Duplicate Records",value:l.duplicateRecords?.value||0,trend:l.duplicateRecords?.trend,trendDirection:l.duplicateRecords?.trendDirection,icon:"duplicate"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact & Account Growth"}),l.monthlyGrowth&&Array.isArray(l.monthlyGrowth)&&l.monthlyGrowth.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Pk,{data:{labels:l.monthlyGrowth.map(D=>D.month||""),datasets:[{label:"Contacts",data:l.monthlyGrowth.map(D=>D.contacts||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!1},{label:"Accounts",data:l.monthlyGrowth.map(D=>D.accounts||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,ticks:{precision:0}}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No growth data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Enrichment Status Distribution"}),l.enrichmentStatus?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Ik,{data:{labels:["Fully Enriched","Partially Enriched","Not Enriched"],datasets:[{data:[l.enrichmentStatus.fullyEnriched?.count||0,l.enrichmentStatus.partiallyEnriched?.count||0,l.enrichmentStatus.notEnriched?.count||0],backgroundColor:["rgb(34, 197, 94)","rgb(249, 115, 22)","rgb(239, 68, 68)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No enrichment data available"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Outreach Readiness Funnel"}),t.jsx("div",{className:"space-y-4",children:l.outreachFunnel&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Total Contacts"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.totalContacts?.toLocaleString()||0," (100%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-gray-400 h-2 rounded-full",style:{width:"100%"}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Has Email"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.hasEmail?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.hasEmail/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.hasEmail/l.outreachFunnel.totalContacts*100:0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Valid Email"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.validEmail?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.validEmail/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.validEmail/l.outreachFunnel.totalContacts*100:0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Has Title"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.hasTitle?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.hasTitle/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.hasTitle/l.outreachFunnel.totalContacts*100:0}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Ready for Outreach"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[l.outreachFunnel.readyForOutreach?.toLocaleString()||0," (",l.outreachFunnel.totalContacts>0?(l.outreachFunnel.readyForOutreach/l.outreachFunnel.totalContacts*100).toFixed(1):0,"%)"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${l.outreachFunnel.totalContacts>0?l.outreachFunnel.readyForOutreach/l.outreachFunnel.totalContacts*100:0}%`}})})]})]})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Segments"}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top Industries"}),t.jsx("div",{className:"space-y-2",children:l.topIndustries&&l.topIndustries.length>0?l.topIndustries.map((D,L)=>t.jsxs("div",{className:"flex items-center justify-between py-1",children:[t.jsx("span",{className:"text-sm text-gray-600",children:D.name}),t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:D.count.toLocaleString()})]},L)):t.jsx("p",{className:"text-xs text-gray-500",children:"No industry data available"})})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Top States"}),t.jsx("div",{className:"space-y-2",children:l.topStates&&l.topStates.length>0?l.topStates.map((D,L)=>t.jsxs("div",{className:"flex items-center justify-between py-1",children:[t.jsx("span",{className:"text-sm text-gray-600",children:D.name}),t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:D.count.toLocaleString()})]},L)):t.jsx("p",{className:"text-xs text-gray-500",children:"No geography data available"})})]})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Data Health Score"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:v.overallScore}),t.jsx("p",{className:"text-sm text-gray-600",children:"Overall Score"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:v.completeness}),t.jsx("p",{className:"text-sm text-gray-600",children:"Completeness"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:v.deduplication}),t.jsx("p",{className:"text-sm text-gray-600",children:"Deduplication"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:v.freshness}),t.jsx("p",{className:"text-sm text-gray-600",children:"Freshness"})]})]})]})]}),s==="industry"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Industry Distribution"}),l.topIndustries&&l.topIndustries.length>0?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(_1,{data:{labels:l.topIndustries.map(D=>D.name),datasets:[{label:"Contacts",data:l.topIndustries.map(D=>D.count||0),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0,ticks:{precision:0},grid:{color:"rgba(0, 0, 0, 0.05)",lineWidth:1}},y:{ticks:{maxRotation:45,minRotation:45},grid:{display:!1}}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No industry data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top 5 Industries by Contact Volume"}),w?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Bk,{data:{labels:w.labels,datasets:[{data:w.data,backgroundColor:w.colors,borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{usePointStyle:!0,padding:15,font:{size:12},generateLabels:function(D){const L=D.data;return L.labels.length&&L.datasets.length?L.labels.map((M,F)=>{L.datasets[0].data[F];const O=L.datasets[0].backgroundColor[F];return{text:M,fillStyle:O,hidden:!1,index:F}}):[]}}},tooltip:{callbacks:{label:function(D){const L=D.label||"",M=D.parsed||0;return`${L} - ${M.toLocaleString()} contacts`}}}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No industry data available"})})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Industry Insights"}),l.industryInsights?t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Fastest Growing"}),t.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:l.industryInsights.fastestGrowing?.industry||"N/A"}),t.jsx("p",{className:"text-sm font-semibold text-green-600",children:l.industryInsights.fastestGrowing?`+${l.industryInsights.fastestGrowing.growth.toFixed(0)}% this quarter`:"No data"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Highest Enrichment"}),t.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:l.industryInsights.highestEnrichment?.industry||"N/A"}),t.jsx("p",{className:"text-sm font-semibold text-green-600",children:l.industryInsights.highestEnrichment?`${l.industryInsights.highestEnrichment.enrichment.toFixed(0)}% enriched`:"No data"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Needs Attention"}),t.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:l.industryInsights.needsAttention?.industry||"N/A"}),t.jsx("p",{className:"text-sm font-semibold text-orange-600",children:l.industryInsights.needsAttention?`${l.industryInsights.needsAttention.enrichment.toFixed(0)}% enriched`:"No data"})]})]}):t.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No industry insights available"})]})]}),s==="geography"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Geographic Distribution"}),l.topStates&&l.topStates.length>0?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(_1,{data:{labels:l.topStates.map(D=>D.name),datasets:[{label:"Contacts",data:l.topStates.map(D=>D.count||0),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0,ticks:{precision:0,stepSize:750,font:{size:11},color:"#6B7280"},grid:{color:"rgba(0, 0, 0, 0.08)",lineWidth:1,borderDash:[5,5],drawBorder:!1}},y:{ticks:{font:{size:12},color:"#374151"},grid:{display:!1}}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No geographic data available"})})]})}),s==="data-quality"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Quality Metrics"}),l.dataQualityMetrics?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(_1,{data:{labels:["Email Valid","Phone Valid","Complete Profile","LinkedIn Connected","Recent Activity"],datasets:[{label:"Count",data:[l.dataQualityMetrics.emailValid||0,l.dataQualityMetrics.phoneValid||0,l.dataQualityMetrics.completeProfile||0,l.dataQualityMetrics.linkedinConnected||0,l.dataQualityMetrics.recentActivity||0],backgroundColor:"rgba(59, 130, 246, 0.8)"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No data quality metrics available"})})]})})]})]})}function Hk({category:l,searchParam:n,onApplyFilters:a,onClearFilters:o}){const[s]=l0(),[e,m]=B.useState(!1),v=B.useRef(null),w=s.get("filterKeywords")||"",N=s.get("filterCity")||"",S=s.get("filterState")||"",D=s.get("filterCountry")||"",L=s.get("filterHasLinkedIn")||"",M=s.get("filterHasEmail")||"",F=s.get("filterHasPhone")||"",[O,P]=B.useState({keywords:"",city:"",state:"",country:"",hasLinkedIn:"",hasEmail:"",hasPhone:""});B.useEffect(()=>{P({keywords:w,city:N,state:S,country:D,hasLinkedIn:L,hasEmail:M,hasPhone:F})},[w,N,S,D,L,M,F]),B.useEffect(()=>{const je=Z=>{v.current&&!v.current.contains(Z.target)&&m(!1)};return e&&document.addEventListener("mousedown",je),()=>{document.removeEventListener("mousedown",je)}},[e]);const G=(je,Z)=>{const ce=typeof Z=="string"?Z.trim():Z;P(ue=>({...ue,[je]:ce}))},ae=()=>!!(w||N||S||D||L||M||F),re=()=>{const je={keywords:O.keywords?.trim()||"",city:O.city?.trim()||"",state:O.state?.trim()||"",country:O.country?.trim()||"",hasLinkedIn:O.hasLinkedIn||"",hasEmail:O.hasEmail||"",hasPhone:O.hasPhone||""};a(je),m(!1)},ke=()=>{P({keywords:"",city:"",state:"",country:"",hasLinkedIn:"",hasEmail:"",hasPhone:""}),o(),m(!1)},xe=()=>[w,N,S,D,L,M,F].filter(je=>je!==""&&je!==null&&je!==void 0).length;return t.jsxs("div",{className:"relative",ref:v,children:[t.jsxs("button",{onClick:()=>m(!e),className:`inline-flex items-center justify-center gap-2 px-5 py-3 rounded-lg transition-all duration-200 font-semibold text-sm shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 ${ae()?"bg-blue-50 border-2 border-blue-500 text-blue-700 hover:bg-blue-100":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400 active:bg-gray-100"}`,title:"Filter contacts",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Filter"}),ae()&&t.jsx("span",{className:"ml-1 px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full font-semibold",children:xe()})]}),e&&t.jsx("div",{className:"absolute right-0 mt-2 w-96 bg-white border border-gray-200 rounded-lg shadow-xl z-50 animate-fade-in-down",children:t.jsxs("div",{className:"p-5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),t.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Keyword",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(searches in keywords field)"})]}),t.jsx("input",{type:"text",value:O.keywords,onChange:je=>G("keywords",je.target.value),placeholder:"Enter keyword...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:je=>{je.key==="Enter"&&(je.preventDefault(),re())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["City",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(case-insensitive)"})]}),t.jsx("input",{type:"text",value:O.city,onChange:je=>G("city",je.target.value),placeholder:"Enter city name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:je=>{je.key==="Enter"&&(je.preventDefault(),re())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["State",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(case-insensitive)"})]}),t.jsx("input",{type:"text",value:O.state,onChange:je=>G("state",je.target.value),placeholder:"Enter state name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:je=>{je.key==="Enter"&&(je.preventDefault(),re())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Country",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(case-insensitive)"})]}),t.jsx("input",{type:"text",value:O.country,onChange:je=>G("country",je.target.value),placeholder:"Enter country name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onKeyDown:je=>{je.key==="Enter"&&(je.preventDefault(),re())}})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Has Email",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(valid email format)"})]}),t.jsxs("select",{value:O.hasEmail,onChange:je=>G("hasEmail",je.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"All Contacts"}),t.jsx("option",{value:"yes",children:"Has Valid Email"}),t.jsx("option",{value:"no",children:"No Valid Email"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Has LinkedIn",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(person or company)"})]}),t.jsxs("select",{value:O.hasLinkedIn,onChange:je=>G("hasLinkedIn",je.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"All Contacts"}),t.jsx("option",{value:"yes",children:"Has LinkedIn URL"}),t.jsx("option",{value:"no",children:"No LinkedIn URL"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Has Phone",t.jsx("span",{className:"text-gray-400 font-normal ml-1",children:"(phone number available)"})]}),t.jsxs("select",{value:O.hasPhone,onChange:je=>G("hasPhone",je.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"All Contacts"}),t.jsx("option",{value:"yes",children:"Has Phone Number"}),t.jsx("option",{value:"no",children:"No Phone Number"})]})]})]}),t.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t border-gray-200",children:[t.jsx("button",{onClick:ke,disabled:!ae(),className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${ae()?"text-gray-700 bg-gray-100 hover:bg-gray-200 cursor-pointer":"text-gray-400 bg-gray-50 cursor-not-allowed"}`,children:"Clear All"}),t.jsx("button",{onClick:re,className:"flex-1 px-4 py-2 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 active:bg-blue-800 rounded-lg transition-colors shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Apply Filters"})]}),ae()&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Active filters:"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[w&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Keyword: ",w]}),N&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["City: ",N]}),S&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["State: ",S]}),D&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Country: ",D]}),M&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Email: ",M==="yes"?"Yes":"No"]}),L&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["LinkedIn: ",L==="yes"?"Yes":"No"]}),F&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md border border-blue-200",children:["Phone: ",F==="yes"?"Yes":"No"]})]})]})]})})]})}function Vk(){const[l,n]=B.useState([]),[a,o]=B.useState(!0),[s,e]=B.useState(null),[m,v]=l0(),[w,N]=B.useState([]),[S,D]=B.useState("name"),[L,M]=B.useState("asc"),[F,O]=B.useState({page:1,limit:50,total:0,totalPages:0}),[P,G]=B.useState(""),[ae,re]=B.useState(new Set),[ke,xe]=B.useState("details"),[je,Z]=B.useState(new Set),[ce,ue]=B.useState([]),[Re,be]=B.useState(!1),oe=Tr(),he=m.get("category")||"All",ye=parseInt(m.get("page")||"1",10),Te=m.get("search")||"",fe=m.get("filterKeywords")||"",_e=m.get("filterCity")||"",We=m.get("filterState")||"",te=m.get("filterCountry")||"",me=m.get("filterHasLinkedIn")||"",W=m.get("filterHasEmail")||"",pe=m.get("filterHasPhone")||"",[Le,Ae]=B.useState(["All"]),V=async()=>{try{const st=(await Vt.get("/categories")).data?.data||[];Ae(["All",...st])}catch(Ie){console.error("Error fetching categories:",Ie),Ae(["All","IND-IT & Service","Accounting & Book keeping","Web Design & Development","Enterprise Software","Finance Services - IND","E-commerce","CRM","Middle East","International","USA Chicago","IT Company - USA","IT Company - Chicago","Weam.ai Mumbai Data","ERP Software","ERP NEXT- Manufacturing-Automotive Components & Spares","Salon & Spa - Chicago","SPA & SALON AHMEDABAD","kology"])}};B.useEffect(()=>{V()},[]),B.useEffect(()=>{const Ie=()=>{document.hidden||V()};return document.addEventListener("visibilitychange",Ie),()=>{document.removeEventListener("visibilitychange",Ie)}},[]),B.useEffect(()=>{O(Ie=>({...Ie,page:ye}))},[ye]),B.useEffect(()=>{G(Te)},[Te]),B.useEffect(()=>{ke==="company"&&H()},[ke,he,Te,fe,_e,We,te,me,W,pe]),B.useEffect(()=>{Q()},[he,ye,Te,fe,_e,We,te,me,W,pe]);const H=async()=>{try{be(!0);const Ie={};he&&he!=="All"&&(Ie.category=he),Te&&Te.trim()&&(Ie.search=Te.trim()),fe&&(Ie.filterKeywords=fe),_e&&(Ie.filterCity=_e),We&&(Ie.filterState=We),te&&(Ie.filterCountry=te),me&&(Ie.filterHasLinkedIn=me),W&&(Ie.filterHasEmail=W),pe&&(Ie.filterHasPhone=pe);const Dt=(await Vt.get("/contacts/companies",{params:Ie}))?.data?.data||[];ue(Dt)}catch(Ie){console.error("Error fetching companies:",Ie),ue([])}finally{be(!1)}},Q=async()=>{try{o(!0);const Ie={page:ye,limit:50};he&&he!=="All"&&(Ie.category=he),Te&&Te.trim()&&(Ie.search=Te.trim()),fe&&(Ie.filterKeywords=fe),_e&&(Ie.filterCity=_e),We&&(Ie.filterState=We),te&&(Ie.filterCountry=te),me&&(Ie.filterHasLinkedIn=me),W&&(Ie.filterHasEmail=W),pe&&(Ie.filterHasPhone=pe);const st=await Vt.get("/contacts",{params:Ie}),Dt=st?.data?.data||st?.data||[];n(Array.isArray(Dt)?Dt:[]),st?.data&&O({page:st.data.page||ye,limit:st.data.limit||50,total:st.data.total||0,totalPages:st.data.totalPages||0}),e(null)}catch(Ie){e("Failed to fetch contacts. Please try again."),console.error("=== Error fetching contacts ==="),console.error("Error details:",Ie),console.error("Error response:",Ie?.response?.data),console.error("Error status:",Ie?.response?.status),console.error("==============================")}finally{o(!1)}},se=Ie=>{const st=he!=="All"?`?category=${encodeURIComponent(he)}`:"";oe(`/contacts/${Ie}${st}`)},de=Ie=>{Ie.target.checked?N(l.map(st=>st._id)):N([])},we=Ie=>{N(st=>st.includes(Ie)?st.filter(Dt=>Dt!==Ie):[...st,Ie])},Ce=async()=>{if(w.length===0)return;const Ie=w.length===1?"Are you sure you want to delete this contact?":`Are you sure you want to delete ${w.length} contacts?`;if(window.confirm(Ie))try{o(!0);const st=w.map(Dt=>Vt.delete(`/contacts/${Dt}`));await Promise.all(st),N([]),await Q()}catch(st){console.error("Error deleting contacts:",st),alert(st.response?.data?.error||"Failed to delete contacts")}finally{o(!1)}},ne=Ie=>{S===Ie?M(L==="asc"?"desc":"asc"):(D(Ie),M("asc"))},ve=(Ie,st)=>{st.stopPropagation(),Ie.email&&(window.location.href=`mailto:${Ie.email}`)},Ge=Ie=>{Ie.preventDefault();const st=P.trim(),Dt={page:"1"};he!=="All"&&(Dt.category=he),st&&(Dt.search=st),fe&&(Dt.filterKeywords=fe),_e&&(Dt.filterCity=_e),We&&(Dt.filterState=We),te&&(Dt.filterCountry=te),me&&(Dt.filterHasLinkedIn=me),W&&(Dt.filterHasEmail=W),pe&&(Dt.filterHasPhone=pe),v(Dt,{replace:!0})},vt=()=>{G("");const Ie={page:"1"};he!=="All"&&(Ie.category=he),fe&&(Ie.filterKeywords=fe),_e&&(Ie.filterCity=_e),We&&(Ie.filterState=We),te&&(Ie.filterCountry=te),me&&(Ie.filterHasLinkedIn=me),W&&(Ie.filterHasEmail=W),pe&&(Ie.filterHasPhone=pe),v(Ie,{replace:!0})},ze=Ie=>{const st={page:"1"};he!=="All"&&(st.category=he),Te&&Te.trim()&&(st.search=Te.trim()),Ie.keywords&&Ie.keywords.trim()&&(st.filterKeywords=Ie.keywords.trim()),Ie.city&&Ie.city.trim()&&(st.filterCity=Ie.city.trim()),Ie.state&&Ie.state.trim()&&(st.filterState=Ie.state.trim()),Ie.country&&Ie.country.trim()&&(st.filterCountry=Ie.country.trim()),Ie.hasLinkedIn&&Ie.hasLinkedIn!==""&&(st.filterHasLinkedIn=Ie.hasLinkedIn),Ie.hasEmail&&Ie.hasEmail!==""&&(st.filterHasEmail=Ie.hasEmail),Ie.hasPhone&&Ie.hasPhone!==""&&(st.filterHasPhone=Ie.hasPhone),v(st,{replace:!0})},jt=()=>!!(fe||_e||We||te||me||W||pe),rt=()=>{const Ie={page:"1"};he!=="All"&&(Ie.category=he),Te&&(Ie.search=Te),v(Ie,{replace:!0})},Kt=[...l].sort((Ie,st)=>{let Dt=Ie[S]||"",xs=st[S]||"";return typeof Dt=="string"&&(Dt=Dt.toLowerCase(),xs=xs.toLowerCase()),L==="asc"?Dt>xs?1:Dt<xs?-1:0:Dt<xs?1:Dt>xs?-1:0}),Lt=Ie=>{if(!Ie)return"?";const st=Ie.trim().split(/\s+/);return st.length>=2?(st[0][0]+st[1][0]).toUpperCase():Ie.substring(0,2).toUpperCase()},ks=Ie=>{re(st=>{const Dt=new Set(st);return Dt.has(Ie)?Dt.delete(Ie):Dt.add(Ie),Dt})},_s=Ie=>{if(!Ie.keywords)return"-";const st=Ie.keywords.split(",").map(xs=>xs.trim()).filter(xs=>xs),Dt=ae.has(Ie._id);return st.length<=3||Dt?st.join(", "):st.slice(0,3).join(", ")+"..."},ms=Ie=>{Z(st=>{const Dt=new Set(st);return Dt.has(Ie)?Dt.delete(Ie):Dt.add(Ie),Dt})},ws=Ie=>{const st=he!=="All"?`?category=${encodeURIComponent(he)}`:"",Dt=encodeURIComponent(Ie);oe(`/contacts/company/${Dt}${st}`)};return a?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse"}),t.jsx("div",{className:"relative animate-spin rounded-full h-14 w-14 border-2 border-gray-200 border-t-gray-900 mx-auto"})]}),t.jsx("p",{className:"tracking-wide text-sm uppercase text-gray-500 font-medium",children:"Loading contacts..."})]})}):t.jsx("div",{className:"min-h-screen bg-white py-4 sm:py-8",children:t.jsxs("div",{className:"max-w-full mx-auto px-3 sm:px-4 lg:px-8",children:[t.jsxs("div",{className:"mb-8 animate-fade-in-down",children:[t.jsx("div",{className:"mb-6",children:t.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 tracking-tight",children:"Contacts"}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1 self-start sm:self-auto",children:[t.jsx("button",{onClick:()=>xe("details"),className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-all duration-200 ${ke==="details"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"View individual contacts",children:"Details"}),t.jsx("button",{onClick:()=>xe("company"),className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-all duration-200 ${ke==="company"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"View companies grouped by name",children:"Company"})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-gray-50 text-gray-700 border border-gray-200 shadow-sm",children:[F.total.toLocaleString()," ",F.total===1?"contact":"contacts"]}),F.totalPages>1&&t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200 shadow-sm",children:["Page ",ye," of ",F.totalPages]}),t.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t.jsx("span",{className:"text-xs sm:text-sm text-gray-500 font-medium hidden sm:inline",children:"Category:"}),t.jsx("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200 shadow-sm truncate max-w-[150px] sm:max-w-none",children:he})]}),ke==="company"&&ce.length>0&&t.jsxs("span",{className:"inline-flex items-center px-2 sm:px-4 py-1 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold bg-emerald-50 text-emerald-700 border border-emerald-200 shadow-sm",children:[ce.length," ",ce.length===1?"company":"companies"]}),jt()&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 sm:px-3 py-1 sm:py-1.5 rounded-lg text-xs font-semibold bg-yellow-50 text-yellow-700 border border-yellow-200 shadow-sm",children:[t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Filters Active"}),t.jsx("span",{className:"sm:hidden",children:"Filters"})]})]})]})})}),t.jsx("div",{className:"bg-gray-50 rounded-xl p-3 sm:p-5 border border-gray-200 shadow-sm mb-4 sm:mb-6",children:t.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 sm:gap-4 items-stretch lg:items-end",children:[t.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-2 sm:gap-3 w-full",children:[t.jsxs("form",{onSubmit:Ge,className:"flex-1 flex gap-2",children:[t.jsxs("div",{className:"relative flex-1 group",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:t.jsx("svg",{className:"w-5 h-5 text-gray-400 group-focus-within:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",value:P,onChange:Ie=>G(Ie.target.value),onKeyDown:Ie=>{Ie.key==="Enter"&&Ge(Ie)},placeholder:"Search by name, email, company, title...",className:"pl-11 pr-11 py-3 w-full border border-gray-300 rounded-lg text-sm text-gray-900 placeholder-gray-400 bg-white shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 hover:border-gray-400"}),P&&t.jsx("button",{type:"button",onClick:vt,className:"absolute inset-y-0 right-0 flex items-center pr-4 text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-all duration-200 font-semibold text-sm whitespace-nowrap shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Search"})]}),t.jsxs("div",{className:"relative group w-full sm:w-64",children:[t.jsx("select",{value:he,onChange:Ie=>{const st=Ie.target.value,Dt={page:"1"};st!=="All"&&(Dt.category=st),Te&&(Dt.search=Te),fe&&(Dt.filterKeywords=fe),_e&&(Dt.filterCity=_e),We&&(Dt.filterState=We),te&&(Dt.filterCountry=te),me&&(Dt.filterHasLinkedIn=me),W&&(Dt.filterHasEmail=W),pe&&(Dt.filterHasPhone=pe),v(Dt,{replace:!0})},className:"appearance-none bg-white border border-gray-300 rounded-lg px-3 sm:px-4 py-2 sm:py-3 pr-8 sm:pr-10 w-full text-xs sm:text-sm font-medium text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer shadow-sm hover:border-gray-400 hover:shadow-md",children:Le.map(Ie=>t.jsx("option",{value:Ie,children:Ie},Ie))}),t.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 sm:pr-3 pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-500 group-hover:text-gray-700 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),t.jsx(Hk,{category:he,searchParam:Te,onApplyFilters:ze,onClearFilters:rt})]}),t.jsxs("div",{className:"flex gap-2 sm:gap-3 w-full sm:w-auto flex-wrap sm:flex-nowrap",children:[w.length>0&&t.jsxs("button",{onClick:Ce,disabled:a,className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 active:bg-red-800 transition-all duration-200 font-semibold text-sm shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transform hover:scale-105 active:scale-100 flex-1 sm:flex-none disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),t.jsxs("span",{className:"hidden sm:inline",children:["Remove ",w.length>1?`(${w.length})`:""]}),t.jsx("span",{className:"sm:hidden",children:"Remove"})]}),t.jsxs("button",{onClick:()=>oe("/import"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 hover:border-gray-400 active:bg-gray-100 transition-all duration-200 font-semibold text-sm shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 flex-1 sm:flex-none",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),t.jsx("span",{className:"hidden sm:inline",children:"Import"})]}),t.jsxs("button",{onClick:()=>oe("/contacts/new"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gray-900 text-white rounded-lg hover:bg-gray-800 active:bg-gray-950 transition-all duration-200 font-semibold text-sm shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transform hover:scale-105 active:scale-100 flex-1 sm:flex-none",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),t.jsx("span",{className:"hidden sm:inline",children:"Add Contact"}),t.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]})})]}),s&&t.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 text-red-700 px-5 py-4 rounded-lg shadow-md animate-shake",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),t.jsx("span",{className:"font-medium",children:s})]})}),l.length===0?t.jsxs("div",{className:"text-center py-16 bg-white rounded-lg shadow-sm border border-gray-200 animate-fade-in",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gray-100 mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No contacts found"}),t.jsx("p",{className:"text-gray-600 mb-2",children:he==="All"?"No contacts found in the database.":t.jsxs(t.Fragment,{children:["No contacts found for category: ",t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200",children:he})]})}),t.jsx("p",{className:"text-sm text-gray-500 mb-8",children:he==="All"?"Try using the search or filters to find contacts, or import contacts to get started.":"Switch to a different category using the dropdown above, or import/add contacts for this category."}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx("button",{onClick:()=>oe("/import"),className:"inline-flex items-center px-5 py-3 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-900 bg-white hover:bg-gray-50 transition-all duration-200 hover:shadow-md",children:"Import CSV/Excel"}),t.jsx("button",{onClick:()=>oe("/contacts/new"),className:"inline-flex items-center px-5 py-3 border border-transparent shadow-md text-sm font-medium rounded-lg text-white bg-gray-900 hover:bg-gray-800 transition-all duration-200 hover:shadow-lg transform hover:scale-105",children:"Add Contact"})]})]}):ke==="company"?t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden animate-fade-in",children:Re?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading companies..."})]})}):ce.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gray-100 mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No companies found"}),t.jsx("p",{className:"text-gray-600 mb-2",children:jt()?"No companies match the current filters. Try adjusting your search or filter criteria.":he==="All"?"No companies found in the database.":t.jsxs(t.Fragment,{children:["No companies found for category: ",t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200",children:he})]})}),t.jsx("p",{className:"text-sm text-gray-500 mb-8",children:jt()?"Clear filters or try a different search term.":"Try using the search or filters to find companies, or import contacts to get started."}),jt()&&t.jsx("button",{onClick:rt,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:"Clear All Filters"})]}):t.jsx("div",{className:"overflow-y-auto",style:{maxHeight:"calc(100vh - 300px)",overscrollBehavior:"contain"},children:t.jsx("div",{className:"divide-y divide-gray-200",children:ce.map(Ie=>{const st=Ie.name,Dt=je.has(st);return t.jsxs("div",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("div",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4 flex-1 cursor-pointer",onClick:()=>ws(st),children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-lg font-bold text-blue-700",children:Lt(st)})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:st}),t.jsxs("p",{className:"text-sm text-gray-500",children:[Ie.count," ",Ie.count===1?"person":"people"]})]})]}),t.jsx("button",{onClick:xs=>{xs.stopPropagation(),ms(st)},className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:`w-5 h-5 transition-transform ${Dt?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),Dt&&t.jsx("div",{className:"bg-gray-50 border-t border-gray-200",children:t.jsxs("div",{className:"px-6 py-4 text-center",children:[t.jsxs("p",{className:"text-gray-600 mb-4",children:["Click on the company name above to view all ",Ie.count," ",Ie.count===1?"contact":"contacts"]}),t.jsx("button",{onClick:()=>ws(st),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"View All Contacts"})]})})]},st)})})})}):t.jsxs("div",{className:"bg-white border border-gray-200 overflow-hidden animate-fade-in",children:[t.jsxs("div",{className:"overflow-x-auto overflow-y-auto",style:{maxHeight:"calc(100vh - 300px)",overscrollBehavior:"contain",scrollBehavior:"auto"},children:[t.jsx("div",{className:"hidden md:block",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"w-12 px-4 py-3 whitespace-nowrap",children:t.jsx("input",{type:"checkbox",checked:w.length===l.length&&l.length>0,onChange:de,className:"h-4 w-4 text-gray-900 focus:ring-gray-900 border-gray-300 rounded cursor-pointer"})}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors whitespace-nowrap",style:{minWidth:"150px"},onClick:()=>ne("name"),children:t.jsxs("div",{className:"flex items-center gap-2",children:["NAME",t.jsx("svg",{className:`w-4 h-4 flex-shrink-0 ${S==="name"?"text-gray-900":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"140px"},children:"JOB TITLE"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"180px"},children:"COMPANY"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"130px"},children:"CONTACT NUMBER"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"180px"},children:"EMAIL"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"110px"},children:"LINKEDIN"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",style:{minWidth:"140px"},children:"INDUSTRY"}),t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",style:{minWidth:"180px"},children:"KEYWORDS"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Kt.map(Ie=>t.jsxs("tr",{onClick:()=>se(Ie._id),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",onClick:st=>st.stopPropagation(),children:t.jsx("input",{type:"checkbox",checked:w.includes(Ie._id),onChange:()=>we(Ie._id),className:"h-4 w-4 text-gray-900 focus:ring-gray-900 border-gray-300 rounded cursor-pointer"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm font-medium text-gray-900 underline hover:text-gray-700",children:Ie.name||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Ie.title||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 bg-gray-200 flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-xs font-semibold text-gray-700",children:Lt(Ie.company)})}),t.jsx("div",{className:"text-sm text-gray-900",children:Ie.company||"-"})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Ie.firstPhone?t.jsx("a",{href:`tel:${Ie.firstPhone}`,onClick:st=>st.stopPropagation(),className:"hover:text-gray-700 hover:underline",children:Ie.firstPhone}):"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Ie.email?t.jsx("a",{href:`mailto:${Ie.email}`,onClick:st=>{st.stopPropagation(),ve(Ie,st)},className:"hover:text-gray-700 hover:underline",children:Ie.email}):"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ie.personLinkedinUrl||Ie.companyLinkedinUrl?t.jsxs("a",{href:Ie.personLinkedinUrl||Ie.companyLinkedinUrl,onClick:st=>st.stopPropagation(),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium bg-blue-50 text-blue-700 hover:bg-blue-100 border border-blue-200 transition-colors whitespace-nowrap",children:[t.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("span",{children:"LinkedIn"})]}):t.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"text-sm text-gray-900",children:Ie.industry||"-"})}),t.jsx("td",{className:"px-6 py-4",children:Ie.keywords?t.jsx("div",{className:"text-sm text-gray-900 cursor-pointer hover:text-blue-600 transition-colors",onClick:st=>{st.stopPropagation(),Ie.keywords.split(",").map(xs=>xs.trim()).filter(xs=>xs).length>3&&ks(Ie._id)},title:Ie.keywords,children:_s(Ie)}):t.jsx("div",{className:"text-sm text-gray-400",children:"-"})})]},Ie._id))})]})}),t.jsx("div",{className:"md:hidden space-y-3 p-3",children:Kt.map(Ie=>t.jsxs("div",{onClick:()=>se(Ie._id),className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[t.jsx("div",{className:"flex items-start justify-between mb-3",children:t.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t.jsx("input",{type:"checkbox",checked:w.includes(Ie._id),onChange:st=>{st.stopPropagation(),we(Ie._id)},className:"h-4 w-4 text-gray-900 focus:ring-gray-900 border-gray-300 rounded cursor-pointer flex-shrink-0 mt-1"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:Ie.name||"-"}),t.jsx("p",{className:"text-xs text-gray-500 truncate",children:Ie.title||"-"})]})]})}),t.jsxs("div",{className:"space-y-2 text-xs",children:[Ie.company&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),t.jsx("span",{className:"text-gray-700 truncate",children:Ie.company})]}),Ie.email&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("a",{href:`mailto:${Ie.email}`,onClick:st=>st.stopPropagation(),className:"text-blue-600 hover:underline truncate",children:Ie.email})]}),Ie.firstPhone&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("a",{href:`tel:${Ie.firstPhone}`,onClick:st=>st.stopPropagation(),className:"text-blue-600 hover:underline",children:Ie.firstPhone})]}),(Ie.personLinkedinUrl||Ie.companyLinkedinUrl)&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("a",{href:Ie.personLinkedinUrl||Ie.companyLinkedinUrl,onClick:st=>st.stopPropagation(),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-xs",children:"LinkedIn Profile"})]}),Ie.industry&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-gray-400 text-xs",children:"Industry:"}),t.jsx("span",{className:"text-gray-700",children:Ie.industry})]}),Ie.keywords&&t.jsxs("div",{className:"pt-2 border-t border-gray-100",children:[t.jsx("span",{className:"text-gray-400 text-xs",children:"Keywords: "}),t.jsx("span",{className:"text-gray-700 text-xs",children:_s(Ie)})]})]})]},Ie._id))})]}),F.totalPages>1&&t.jsxs("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-t border-gray-200 bg-gray-50 flex flex-col sm:flex-row items-center justify-between gap-3",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("span",{className:"text-xs sm:text-sm text-gray-700",children:["Showing ",(ye-1)*F.limit+1," to ",Math.min(ye*F.limit,F.total)," of ",F.total.toLocaleString()," contacts"]})}),t.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t.jsxs("button",{onClick:()=>{if(ye>1){const st={page:(ye-1).toString()};he!=="All"&&(st.category=he),Te&&(st.search=Te),v(st,{replace:!0})}},disabled:ye===1,className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[t.jsx("span",{className:"hidden sm:inline",children:"Previous"}),t.jsx("span",{className:"sm:hidden",children:"Prev"})]}),t.jsx("div",{className:"flex items-center gap-0.5 sm:gap-1",children:Array.from({length:Math.min(5,F.totalPages)},(Ie,st)=>{let Dt;return F.totalPages<=5||ye<=3?Dt=st+1:ye>=F.totalPages-2?Dt=F.totalPages-4+st:Dt=ye-2+st,t.jsx("button",{onClick:()=>{const xs={page:Dt.toString()};he!=="All"&&(xs.category=he),Te&&(xs.search=Te),v(xs,{replace:!0})},className:`px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium rounded transition-colors ${ye===Dt?"bg-gray-900 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:Dt},Dt)})}),t.jsx("button",{onClick:()=>{if(ye<F.totalPages){const st={page:(ye+1).toString()};he!=="All"&&(st.category=he),Te&&(st.search=Te),v(st,{replace:!0})}},disabled:ye>=F.totalPages,className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]})]})]})})}function Wk(){const{id:l}=ai(),n=Tr(),[a]=l0(),o=a.get("category"),s=a.get("returnTo"),[e,m]=B.useState(null),[v,w]=B.useState(!0),[N,S]=B.useState(!1),[D,L]=B.useState(null),[M,F]=B.useState(!1),[O,P]=B.useState(!1),[G,ae]=B.useState("about"),re=B.useRef(!1);B.useEffect(()=>{ke()},[l]);const ke=async()=>{try{w(!0);const be=await Vt.get(`/contacts/${l}`);m(be.data?.data||be.data),L(null)}catch(be){L("Failed to fetch contact details."),console.error("Error fetching contact:",be)}finally{w(!1)}},xe=async(be=!1)=>{if(!(!e||!(be&&e.companyLinkedinUrl?e.companyLinkedinUrl:e.personLinkedinUrl||e.companyLinkedinUrl)))try{S(!0);const he=be?`/linkedin/fetch/${l}?type=company`:`/linkedin/fetch/${l}`,ye=await Vt.get(he),Te=ye.data?.data?.contact||ye.data?.contact;Te&&m(Te)}catch(he){console.error("Error fetching LinkedIn data:",he)}finally{S(!1)}};B.useEffect(()=>{e&&(e.personLinkedinUrl||e.companyLinkedinUrl)&&!re.current&&(re.current=!0,xe())},[e]);const je=be=>{if(!be)return"?";const oe=be.trim().split(/\s+/);return oe.length>=2?(oe[0][0]+oe[oe.length-1][0]).toUpperCase():be.substring(0,2).toUpperCase()},Z=be=>{if(!be)return"?";const oe=be.trim().split(/\s+/);return oe.length>=2?(oe[0][0]+oe[1][0]).toUpperCase():be.substring(0,2).toUpperCase()},ce=()=>{if(!e?.company)return;const be=o||e.category||"",oe=be?`?category=${encodeURIComponent(be)}`:"";n(`/contacts/company/${encodeURIComponent(e.company)}${oe}`)};if(v)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[t.jsxs("div",{className:"relative inline-block",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse opacity-30"}),t.jsx("div",{className:"relative animate-spin rounded-full h-16 w-16 border-4 border-gray-200 border-t-blue-600"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wider",children:"Loading Contact"}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Please wait..."})]})]})});if(!e)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[t.jsx("div",{className:"w-20 h-20 mx-auto bg-red-100 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-10 h-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contact Not Found"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"The contact you're looking for doesn't exist or has been removed."}),t.jsxs("button",{onClick:()=>{if(s)n(s);else{const be=o?`?category=${encodeURIComponent(o)}`:"";n(`/contacts${be}`)}},className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),s?"Back":"Back to Contacts"]})]})]})});e.linkedinData;const ue=[e.city,e.state,e.country].filter(Boolean).join(", ")||"Not specified",Re=e.title&&e.company?`${e.title} at ${e.company}`:e.title||e.company||"";return t.jsxs("div",{className:"min-h-screen bg-white",children:[t.jsx("div",{className:"bg-white border-b border-gray-200",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:[t.jsx("nav",{className:"mb-4 sm:mb-6 animate-fade-in-down",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-gray-600 overflow-x-auto",children:[t.jsxs("button",{onClick:()=>{if(s)n(s);else{const be=o||e?.category||"",oe=be?`?category=${encodeURIComponent(be)}`:"";n(`/contacts${oe}`)}},className:"hover:text-gray-900 transition-colors duration-200 flex items-center gap-1 whitespace-nowrap",children:[t.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),t.jsx("span",{className:"hidden sm:inline",children:s?"Back":"Contacts"}),t.jsx("span",{className:"sm:hidden",children:"Back"})]}),t.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),t.jsx("span",{className:"text-gray-900 font-medium truncate",children:e.name})]})}),t.jsx("div",{className:"bg-white rounded-lg sm:rounded-xl border border-gray-200 shadow-sm p-4 sm:p-6 animate-fade-in-up",children:t.jsxs("div",{className:"flex flex-col items-center sm:items-start sm:flex-row gap-4 sm:gap-6",children:[t.jsx("div",{className:"relative flex-shrink-0",children:t.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-xl sm:text-2xl font-bold text-white shadow-lg ring-2 sm:ring-4 ring-blue-50",children:je(e.name)})}),t.jsxs("div",{className:"flex-1 min-w-0 w-full sm:w-auto text-center sm:text-left",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-center sm:items-start gap-2 sm:gap-3 mb-2",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 break-words",children:e.name}),e.category&&t.jsx("span",{className:"px-2 sm:px-3 py-1 bg-blue-50 text-blue-700 text-xs font-semibold rounded-full border border-blue-200 whitespace-nowrap",children:e.category})]}),Re&&t.jsx("p",{className:"text-gray-600 text-base sm:text-lg mb-2 sm:mb-3 font-medium break-words",children:Re}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-center sm:items-center gap-3 sm:gap-6 text-gray-600 text-xs sm:text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),t.jsx("span",{className:"break-words",children:ue})]}),e.industry&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),t.jsx("span",{className:"break-words",children:e.industry})]})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto",children:[(e.personLinkedinUrl||e.companyLinkedinUrl)&&t.jsxs("a",{href:e.personLinkedinUrl||e.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center gap-2 px-4 sm:px-5 py-2 sm:py-2.5 bg-blue-600 text-white font-semibold text-sm rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md w-full sm:w-auto",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("span",{className:"hidden sm:inline",children:"LinkedIn Profile"}),t.jsx("span",{className:"sm:hidden",children:"LinkedIn"})]}),e.email&&t.jsxs("a",{href:`mailto:${e.email}`,className:"inline-flex items-center justify-center gap-2 px-4 sm:px-5 py-2 sm:py-2.5 bg-white text-gray-700 font-semibold text-sm rounded-lg hover:bg-gray-50 transition-all duration-200 border border-gray-300 shadow-sm hover:shadow-md w-full sm:w-auto",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Send Email"}),t.jsx("span",{className:"sm:hidden",children:"Email"})]})]})]})})]})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8 bg-white",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden animate-fade-in-up hover:shadow-md transition-shadow duration-300",children:[t.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 bg-white border-b border-gray-200 flex items-center justify-between cursor-pointer hover:bg-gray-50 transition-colors duration-200",onClick:()=>F(!M),children:[t.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),t.jsx("span",{className:"hidden sm:inline",children:"Contact Information"}),t.jsx("span",{className:"sm:hidden",children:"Contact Info"})]}),t.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0",children:t.jsx("svg",{className:`w-5 h-5 transition-transform duration-300 ${M?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!M&&t.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-6 space-y-4 sm:space-y-5 animate-fade-in bg-white",children:[e.email&&t.jsxs("div",{className:"group",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Email"}),t.jsxs("a",{href:`mailto:${e.email}`,className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-50 rounded-lg hover:bg-blue-50 transition-all duration-200 border border-transparent hover:border-blue-200",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 flex-1 truncate min-w-0",children:e.email}),t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 group-hover:text-blue-600 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),e.firstPhone&&t.jsxs("div",{className:"group",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Phone"}),t.jsxs("a",{href:`tel:${e.firstPhone}`,className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 border border-transparent hover:border-gray-200",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 flex-1 break-all",children:e.firstPhone}),t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 group-hover:text-gray-600 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),e.companyPhone&&e.companyPhone!==e.firstPhone&&t.jsxs("div",{className:"group",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Company Phone"}),t.jsxs("a",{href:`tel:${e.companyPhone}`,className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all duration-200 border border-transparent hover:border-gray-200",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 flex-1 break-all",children:e.companyPhone}),t.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 group-hover:text-gray-600 transition-colors flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden animate-fade-in-up hover:shadow-md transition-shadow duration-300",children:[t.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 bg-white border-b border-gray-200 flex items-center justify-between",children:[t.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),t.jsx("span",{className:"hidden sm:inline",children:"Company Insights"}),t.jsx("span",{className:"sm:hidden",children:"Company"})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("button",{className:"p-1.5 sm:p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all duration-200 flex-shrink-0",onClick:()=>P(!O),children:t.jsx("svg",{className:`w-5 h-5 transition-transform duration-300 ${O?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})})]}),!O&&t.jsxs("div",{className:"animate-fade-in",children:[t.jsx("div",{className:"px-4 sm:px-6 pt-3 sm:pt-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex gap-4 sm:gap-6 overflow-x-auto scrollbar-hide",children:[t.jsxs("button",{onClick:()=>ae("about"),className:`pb-2 sm:pb-3 px-1 text-xs sm:text-sm font-semibold transition-all duration-200 whitespace-nowrap relative flex-shrink-0 ${G==="about"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["About",G==="about"&&t.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-full animate-slide-in"})]}),t.jsxs("button",{onClick:()=>ae("employees"),className:`pb-2 sm:pb-3 px-1 text-xs sm:text-sm font-semibold transition-all duration-200 whitespace-nowrap relative flex-shrink-0 ${G==="employees"?"text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["Employees ",e.employees&&t.jsxs("span",{className:"text-gray-400",children:["(",e.employees,")"]}),G==="employees"&&t.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 rounded-full animate-slide-in"})]})]})}),t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:e.company&&t.jsxs("div",{className:"mb-4 sm:mb-6",children:[t.jsxs("button",{type:"button",onClick:ce,className:"w-full flex items-center gap-3 sm:gap-4 mb-4 sm:mb-6 p-3 sm:p-4 bg-gray-50 rounded-lg border border-gray-200 text-left hover:bg-blue-50 hover:border-blue-200 transition-colors duration-200",children:[t.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-base sm:text-lg shadow-sm flex-shrink-0",children:Z(e.company)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-1 break-words",children:e.company}),t.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"View company profile & insights"})]}),t.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),G==="about"&&t.jsxs("div",{className:"space-y-4 sm:space-y-6 animate-fade-in",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.industry&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Industry"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:e.industry})]}),e.category&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Category"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:e.category})]}),t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Location"}),t.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 break-words",children:[e.companyCity,e.companyState,e.companyCountry].filter(Boolean).join(", ")||[e.city,e.state,e.country].filter(Boolean).join(", ")||"Not specified"})]}),e.website&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Website"}),t.jsxs("a",{href:e.website.startsWith("http")?e.website:`https://${e.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs sm:text-sm font-medium text-blue-600 hover:text-blue-700 hover:underline inline-flex items-center gap-1 break-all",children:[e.website,t.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]}),e.companyAddress&&t.jsxs("div",{className:"p-3 sm:p-4 bg-white rounded-lg border border-gray-200",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Address"}),t.jsx("p",{className:"text-xs sm:text-sm text-gray-700 break-words",children:e.companyAddress})]}),e.keywords&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 sm:mb-3 block",children:"Keywords"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:e.keywords.split(",").map((be,oe)=>t.jsx("span",{className:"px-2 sm:px-3 py-1 sm:py-1.5 bg-gray-50 text-gray-700 text-xs sm:text-sm font-medium rounded-lg border border-gray-200 hover:bg-gray-100 transition-all duration-200 cursor-default",children:be.trim()},oe))})]})]}),G==="employees"&&t.jsx("div",{className:"animate-fade-in",children:e.employees?t.jsx("div",{className:"p-4 sm:p-6 bg-white rounded-lg border border-gray-200",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:t.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Number of Employees"}),t.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:e.employees})]})}):t.jsxs("div",{className:"text-center py-8 sm:py-12 bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:t.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("p",{className:"text-gray-500 text-xs sm:text-sm",children:"No employees data available"})]})})]})})]})]})})]})})]})}function wv({isOpen:l,onClose:n,type:a,contactName:o,companyName:s,projectId:e,contactId:m,phoneNumber:v,email:w,linkedInProfileUrl:N,activityId:S,editMode:D=!1,lastActivity:L=null}){const[M,F]=B.useState({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),[O,P]=B.useState({}),[G,ae]=B.useState(!1),[re,ke]=B.useState(!1),[xe,je]=B.useState({phone:!1,email:!1,linkedin:!1}),[Z,ce]=B.useState({phone:null,email:null,linkedin:null}),[ue,Re]=B.useState(!1),[be,oe]=B.useState([]),[he,ye]=B.useState(""),[Te,fe]=B.useState(!1),_e=B.useRef(!1);B.useEffect(()=>{const de=localStorage.getItem("linkedInAccounts");if(de)try{oe(JSON.parse(de))}catch(we){console.error("Error parsing LinkedIn accounts:",we),oe([])}else oe([])},[]);const We=()=>{if(he.trim()&&!be.includes(he.trim())){const de=[...be,he.trim()];oe(de),localStorage.setItem("linkedInAccounts",JSON.stringify(de)),F(we=>({...we,linkedInAccountName:he.trim()})),ye(""),fe(!1)}},te=async()=>{try{const de=await Vt.get(`/activities/${S}`);if(de.data.success){const we=de.data.data;F({template:we.template||"",outcome:we.outcome||"",conversationNotes:we.conversationNotes||"",nextAction:we.nextAction||"",nextActionDate:we.nextActionDate?new Date(we.nextActionDate).toISOString().split("T")[0]:"",phoneNumber:we.phoneNumber||v||"",email:we.email||w||"",linkedInUrl:we.linkedInUrl||N||"",status:we.status||"",linkedInAccountName:we.linkedInAccountName||"",lnRequestSent:we.lnRequestSent||"",connected:we.connected||"",callNumber:we.callNumber||"",callStatus:we.callStatus||"",callDate:we.callDate?new Date(we.callDate).toISOString().split("T")[0]:"",emailDate:we.emailDate?new Date(we.emailDate).toISOString().split("T")[0]:we.createdAt?new Date(we.createdAt).toISOString().split("T")[0]:"",linkedinDate:we.linkedinDate?new Date(we.linkedinDate).toISOString().split("T")[0]:we.createdAt?new Date(we.createdAt).toISOString().split("T")[0]:""}),ce({phone:we.phoneNumber||v||null,email:we.email||w||null,linkedin:we.linkedInUrl||N||null})}}catch(de){console.error("Error fetching activity data:",de),P({submit:"Couldn't load the activity details. Try refreshing."})}},me=async()=>{if(!m||!a)return null;try{const de=await Vt.get(`/activities/contact/${m}`);if(de.data.success&&de.data.data){const Ce=de.data.data.filter(ne=>ne.type===a);if(Ce.length>0)return Ce.sort((ne,ve)=>new Date(ve.createdAt)-new Date(ne.createdAt)),Ce[0]}}catch(de){console.error("Error fetching last activity by type:",de)}return null};if(B.useEffect(()=>{if(l&&!_e.current){setTimeout(()=>ke(!0),10);const de=new Date().toISOString().split("T")[0];if(_e.current=!0,D&&S)te();else if(L){const we=L;F({template:we.template||"",outcome:we.outcome||"",conversationNotes:we.conversationNotes||"",nextAction:we.nextAction||"",nextActionDate:we.nextActionDate?new Date(we.nextActionDate).toISOString().split("T")[0]:"",phoneNumber:we.phoneNumber||v||"",email:we.email||w||"",linkedInUrl:we.linkedInUrl||N||"",status:we.status||"",linkedInAccountName:we.linkedInAccountName||"",lnRequestSent:we.lnRequestSent||"",connected:we.connected||"",callNumber:we.callNumber||"",callStatus:we.callStatus||"",callDate:we.callDate?new Date(we.callDate).toISOString().split("T")[0]:we.type==="call"?de:"",emailDate:we.emailDate?new Date(we.emailDate).toISOString().split("T")[0]:we.type==="email"?de:"",linkedinDate:we.linkedinDate?new Date(we.linkedinDate).toISOString().split("T")[0]:we.type==="linkedin"?de:""}),ce({phone:we.phoneNumber||v||null,email:we.email||w||null,linkedin:we.linkedInUrl||N||null}),we.type!==a&&me().then(Ce=>{Ce&&F(ne=>{const ve={...ne};return a==="call"&&Ce.callDate?ve.callDate=new Date(Ce.callDate).toISOString().split("T")[0]:a==="email"&&Ce.emailDate?ve.emailDate=new Date(Ce.emailDate).toISOString().split("T")[0]:a==="linkedin"&&Ce.linkedinDate&&(ve.linkedinDate=new Date(Ce.linkedinDate).toISOString().split("T")[0]),ve})})}else F(we=>({...we,phoneNumber:v||"",email:w||"",linkedInUrl:N||"",callDate:a==="call"?de:"",emailDate:a==="email"?de:"",linkedinDate:a==="linkedin"?de:""})),ce({phone:v||null,email:w||null,linkedin:N||null}),me().then(we=>{we&&F(Ce=>{const ne={...Ce};return a==="call"&&we.callDate?ne.callDate=new Date(we.callDate).toISOString().split("T")[0]:a==="email"&&we.emailDate?ne.emailDate=new Date(we.emailDate).toISOString().split("T")[0]:a==="linkedin"&&we.linkedinDate&&(ne.linkedinDate=new Date(we.linkedinDate).toISOString().split("T")[0]),ne})})}else l||(ke(!1),_e.current=!1)},[l,D,S,a,v,w,N,m||null,L?._id]),!l)return null;const W=()=>{const de="w-5 h-5";switch(a){case"call":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${de} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${de} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${de} text-white`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},pe=()=>{if(D)switch(a){case"call":return"Edit Call Activity";case"email":return"Edit Email Activity";case"linkedin":return"Edit LinkedIn Activity";default:return"Edit Activity"}switch(a){case"call":return"Log Call Activity";case"email":return"Log Email Activity";case"linkedin":return"Log LinkedIn Activity";default:return"Log Activity"}},Le=()=>{switch(a){case"call":return"from-green-50 to-emerald-50";case"email":return"from-blue-50 to-cyan-50";case"linkedin":return"from-blue-50 to-indigo-50";default:return"from-gray-50 to-gray-100"}},Ae=(de,we)=>{F(Ce=>({...Ce,[de]:we})),O[de]&&P(Ce=>({...Ce,[de]:""}))},V=()=>{const de={};if(M.nextAction&&!M.nextActionDate&&(de.nextActionDate="Next action date is required when next action is specified"),M.nextActionDate){const we=new Date(M.nextActionDate),Ce=new Date,ne=new Date(Ce);ne.setDate(ne.getDate()+7),we>ne&&(de.nextActionDate="Next action must be scheduled within 7 days")}return P(de),Object.keys(de).length===0},H=async de=>{if(de.preventDefault(),!!V()){ae(!0);try{const we=M.conversationNotes.trim()||"";let Ce;const ne=M.callDate&&M.callDate.trim()?M.callDate.trim():null,ve=M.emailDate&&M.emailDate.trim()?M.emailDate.trim():null,Ge=M.linkedinDate&&M.linkedinDate.trim()?M.linkedinDate.trim():null;if(D&&S?Ce=await Vt.put(`/activities/${S}`,{template:M.template,conversationNotes:we,nextAction:M.nextAction,nextActionDate:M.nextActionDate,phoneNumber:M.phoneNumber||v||null,email:M.email||w||null,linkedInUrl:M.linkedInUrl||N||null,status:M.status||null,linkedInAccountName:M.linkedInAccountName||null,lnRequestSent:M.lnRequestSent||null,connected:M.connected||null,callNumber:M.callNumber||null,callStatus:M.callStatus||null,callDate:ne,emailDate:ve,linkedinDate:Ge}):Ce=await Vt.post("/activities",{projectId:e,contactId:m||null,type:a,template:M.template,outcome:null,conversationNotes:we,nextAction:M.nextAction,nextActionDate:M.nextActionDate,phoneNumber:M.phoneNumber||v||null,email:M.email||w||null,linkedInUrl:M.linkedInUrl||N||null,status:M.status||null,linkedInAccountName:M.linkedInAccountName||null,lnRequestSent:M.lnRequestSent||null,connected:M.connected||null,callNumber:M.callNumber||null,callStatus:M.callStatus||null,callDate:ne,emailDate:ve,linkedinDate:Ge}),Ce.data.success&&M.status&&m&&e)try{await Vt.put(`/projects/${e}/project-contacts/${m}`,{stage:M.status})}catch(vt){console.error("Error updating contact status:",vt)}Ce.data.success?(F({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:v||"",email:w||"",linkedInUrl:N||"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),n(!0)):P({submit:Ce.data.error||"Couldn't save that activity. Give it another try."})}catch(we){console.error("Error saving activity:",we);const Ce=we.response?.data?.error||we.message||"Something went wrong saving the activity. Try again.";P({submit:Ce})}finally{ae(!1)}}},Q=()=>{F({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),P({}),ce({phone:null,email:null,linkedin:null}),je({phone:!1,email:!1,linkedin:!1}),Re(!1),n()},se=async(de,we,Ce)=>{if(m){je(ne=>({...ne,[de]:!0}));try{const ne={[Ce]:we||""};await Vt.put(`/contacts/${m}`,ne),ce(ve=>({...ve,[de]:we||null})),de==="phone"?F(ve=>({...ve,phoneNumber:we||""})):de==="email"?F(ve=>({...ve,email:we||""})):de==="linkedin"&&F(ve=>({...ve,linkedInUrl:we||""}))}catch(ne){console.error(`Error saving ${de}:`,ne),P({submit:`Couldn't save ${de}. Give it another shot.`})}finally{je(ne=>({...ne,[de]:!1}))}}};return t.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${re?"opacity-100":"opacity-0"}`,onClick:Q,children:t.jsxs("div",{className:`bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col transform transition-all duration-300 ${re?"scale-100 translate-y-0":"scale-95 translate-y-4"}`,onClick:de=>de.stopPropagation(),children:[t.jsx("div",{className:`bg-gradient-to-r ${Le()} border-b border-gray-200 p-4 flex-shrink-0`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[ue&&t.jsx("button",{onClick:()=>Re(!1),className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-600 hover:text-gray-900 hover:bg-white/50 transition-all duration-200 group",title:"Back to form",children:t.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("div",{className:"animate-pulse-once",children:W()}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-0.5",children:ue&&a==="linkedin"?"LinkedIn Message Variations":ue&&a==="email"?"Email Variations":pe()}),!ue&&t.jsxs("p",{className:"text-xs text-gray-600 font-medium",children:[o," - ",s]})]})]}),t.jsx("button",{onClick:Q,className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-400 hover:text-gray-600 hover:bg-white/50 transition-all duration-200 group",children:t.jsx("svg",{className:"w-5 h-5 group-hover:rotate-90 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),ue&&a==="linkedin"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Existing"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm usually in touch with teams managing residential projects and leasing, so I was just curious how you manage bookings, rentals, and property maintenance across your units."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I mostly connect with people working in residential and leasing rolesit keeps me close to how things really move on a day-to-day basis."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"The world today feels like one connected marketplace, and being part of the real estate ecosystem, I enjoy connecting with people who are building and managing things on the ground. Looking forward to connecting and exchanging perspectives."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I've noticed that no two property teams manage bookings, rentals, and maintenance the same way. I'm always interested in hearing how others handle it in practice."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Always open to exchanging thoughts and learning how things are shaping up on your side. Would be great to stay connected."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We work closely with property teams to simplify how day-to-day operations are managed  from rentals and billing to maintenance  so things feel more connected and easier to handle."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Everyday operational conversations around properties quietly offer the most value in understanding how things really work."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Enjoy grounded conversations around real work and real challenges. Happy to stay connected and exchange insights whenever it makes sense."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We believe real value often comes from reducing small operational frictions and giving teams better visibility into what's happening across their properties."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm always interested in seeing how teams optimize their workflowsdo you have any strategies that make managing bookings and maintenance simpler?"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I value thoughtful conversations with people close to the work. Whenever it feels right, I'd enjoy exchanging insights as things evolve on your side."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"No worries if you didn't catch my earlier message. Just checking if you're up for a chat about possible ways we can team up and grow together."})]})]})]})})})}):ue&&a==="email"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300 w-[15%]",children:"Email"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 4"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I work closely with people involved in residential projects and leasing, and I enjoy staying connected with those who are close to the day-to-day side of property work."}),t.jsx("p",{children:"At Terabits, we focus on making everyday property operations a little easier by keeping rentals, billing, and maintenance in one place."}),t.jsx("p",{children:"Happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working close to residential projects and leasing. I've found those conversations tend to be the most honest and practical."}),t.jsx("p",{children:"I'm part of the Terabits team, where we focus on making everyday property operations easier to manage."}),t.jsx("p",{children:"Nice to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"font-semibold",children:"Subject: Exchanging notes on leasing & residential work"}),t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working on residential projects and leasing. I've found these conversations to be the most practical."}),t.jsx("p",{children:'When it comes to daily management, where do you usually find the most friction or "extra work" in your current process?'})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I tend to reach out to people in residential leasing because the conversations are usually more practical."}),t.jsx("p",{children:`I'm curiouswhen it comes to your daily management, where do things usually get stuck or feel like a "headache" for your team?`}),t.jsx("p",{children:"Nice to connect,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just wanted to follow up on my last note."}),t.jsx("p",{children:"We usually speak with property teams who want a bit more clarity in their daily workflows without changing how they already operate."}),t.jsx("p",{children:"Always good to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just sharing a short follow-up."}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing without adding extra complexity to daily work."}),t.jsx("p",{children:"Happy to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing."}),t.jsx("p",{children:"This is where Terabits usually steps inwe focus on making those everyday operations feel less like a chore so you can focus on the bigger picture."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"That's usually where we come in. At Terabits, we focus on making those messy partslike rentals, maintenance, and billingfeel a lot more manageable."}),t.jsx("p",{children:"We try to keep the tech simple so it actually helps the team instead of adding more work to their day."}),t.jsx("p",{children:"Happy to stay in touch,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing we often notice is that small improvements in visibility can make day-to-day property work feel much more manageable."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that even small clarity in systems can make a big difference in day-to-day property operations."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that small clarity in systems makes a big difference."}),t.jsx("p",{children:"Specifically, we help by automating the repetitive stufflike tracking maintenance requests or streamlining billing workflowswithout adding extra complexity to your day-to-day work."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I've noticed is that just adding a bit of clarity to maintenance tracking or billing can save a lot of hours."}),t.jsx("p",{children:"We mostly help by automating those repetitive tasks so they just happen in the background. It's a small change that usually makes the day-to-day much smoother."}),t.jsx("p",{children:"Thought I'd share that."})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here for now."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Wishing you a great week ahead."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Take care."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here as I don't want to crowd your inbox."}),t.jsx("p",{children:"If you ever want to swap notes on how to make property workflows easier, I'm always happy to chat."}),t.jsx("p",{children:"Wishing you the best,"})]})})]})]})]})})})}):t.jsx("form",{onSubmit:H,className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsxs("div",{className:"space-y-4",children:[a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Phone Number ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("input",{type:"tel",value:M.phoneNumber,onChange:de=>Ae("phoneNumber",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:Z.phone||v?"":"Add phone number (e.g., +1 234-567-8900)"})]}),m&&t.jsx("button",{type:"button",onClick:()=>se("phone",M.phoneNumber,"firstPhone"),disabled:xe.phone,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database",children:xe.phone?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),(Z.phone||v)&&t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Z.phone?`Saved in database: ${Z.phone}`:`Fetched from database: ${v}`]})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Address ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("input",{type:"email",value:M.email,onChange:de=>Ae("email",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:Z.email||w?"":"Add email address (e.g., contact@example.com)"})]}),m&&t.jsx("button",{type:"button",onClick:()=>se("email",M.email,"email"),disabled:xe.email,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database",children:xe.email?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),(Z.email||w)&&t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Z.email?`Saved in database: ${Z.email}`:`Fetched from database: ${w}`]})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:M.emailDate,onChange:de=>Ae("emailDate",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:"Select email date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the email was sent"]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Profile URL ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("input",{type:"url",value:M.linkedInUrl,onChange:de=>Ae("linkedInUrl",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:Z.linkedin||N?"":"Add LinkedIn profile URL (e.g., https://linkedin.com/in/username)"})]}),m&&t.jsx("button",{type:"button",onClick:()=>se("linkedin",M.linkedInUrl,"personLinkedinUrl"),disabled:xe.linkedin,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database",children:xe.linkedin?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),(Z.linkedin||N)&&t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Z.linkedin?t.jsxs(t.Fragment,{children:["Saved in database: ",t.jsx("a",{href:Z.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:Z.linkedin})]}):t.jsxs(t.Fragment,{children:["Fetched from database: ",t.jsx("a",{href:N,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:N})]})]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:M.linkedinDate,onChange:de=>Ae("linkedinDate",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:"Select LinkedIn date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the LinkedIn activity occurred"]})]}),a!=="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700",children:"Select Template (Optional)"}),(a==="linkedin"||a==="email")&&t.jsxs("button",{type:"button",onClick:()=>Re(!0),className:"px-3 py-1.5 text-xs font-semibold text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-all duration-200 flex items-center gap-1.5",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a==="email"?"View Email Variations":"View Message Variations"]})]}),t.jsxs("select",{value:M.template,onChange:de=>Ae("template",de.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"no-template",children:"No Template"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"introduction-email",children:"Introduction Email"}),t.jsx("option",{value:"follow-up-email",children:"Follow-up Email"}),t.jsx("option",{value:"value-proposition-email",children:"Value Proposition Email"})]}):a==="linkedin"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"connection-request-message",children:"Connection Request Message"}),t.jsx("option",{value:"introduction-message",children:"Introduction Message"}),t.jsx("option",{value:"follow-up-message",children:"Follow-up Message"})]}):null]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Use a pre-defined template for consistency"]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Account Used ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsxs("select",{value:M.linkedInAccountName,onChange:de=>Ae("linkedInAccountName",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select LinkedIn account"}),be.map((de,we)=>t.jsx("option",{value:de,children:de},we))]})]}),t.jsx("button",{type:"button",onClick:()=>fe(!Te),className:"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors whitespace-nowrap",children:Te?"Cancel":"+ Add"})]}),Te&&t.jsxs("div",{className:"mt-3 flex gap-2",children:[t.jsx("input",{type:"text",value:he,onChange:de=>ye(de.target.value),onKeyPress:de=>{de.key==="Enter"&&(de.preventDefault(),We())},className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter new LinkedIn account name"}),t.jsx("button",{type:"button",onClick:We,disabled:!he.trim()||be.includes(he.trim()),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Add"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select or add a LinkedIn account that sent the connection request"]})]}),a==="linkedin"&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Ln Request Sent ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.lnRequestSent,onChange:de=>Ae("lnRequestSent",de.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"}),t.jsx("option",{value:"Existing Connect",children:"Existing Connect"}),t.jsx("option",{value:"Inactive Profile",children:"Inactive Profile"}),t.jsx("option",{value:"Irrelevant Profile",children:"Irrelevant Profile"}),t.jsx("option",{value:"Open to Work",children:"Open to Work"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status of the LinkedIn connection request"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Connected ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.connected,onChange:de=>Ae("connected",de.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Whether the connection was established"]})]})]}),(a==="email"||a==="linkedin")&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.status,onChange:de=>Ae("status",de.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 ${O.status?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select status"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Out of Office",children:"Out of Office"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Wrong Person",children:"Wrong Person"}),t.jsx("option",{value:"Bounce",children:"Bounce"}),t.jsx("option",{value:"Opt-Out",children:"Opt-Out"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"})]}):t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"CIP",children:"CIP"}),t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"In-Person Meeting",children:"In-Person Meeting"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"}),t.jsx("option",{value:"SQL",children:"SQL"}),t.jsx("option",{value:"Tech Discussion",children:"Tech Discussion"}),t.jsx("option",{value:"WON",children:"WON"}),t.jsx("option",{value:"Lost",children:"Lost"}),t.jsx("option",{value:"Low Potential - Open",children:"Low Potential - Open"}),t.jsx("option",{value:"Potential Future",children:"Potential Future"})]})]}),O.status&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),O.status]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a==="email"?"Update the contact status based on this email interaction":"Update the contact status based on this interaction"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Call ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsx("div",{children:t.jsxs("select",{value:M.callNumber,onChange:de=>Ae("callNumber",de.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select call number"}),t.jsx("option",{value:"1st call",children:"1st call"}),t.jsx("option",{value:"2nd call",children:"2nd call"}),t.jsx("option",{value:"3rd call",children:"3rd call"}),t.jsx("option",{value:"4th call",children:"4th call"}),t.jsx("option",{value:"5th call",children:"5th call"}),t.jsx("option",{value:"6th call",children:"6th call"}),t.jsx("option",{value:"7th call",children:"7th call"}),t.jsx("option",{value:"8th call",children:"8th call"}),t.jsx("option",{value:"9th call",children:"9th call"}),t.jsx("option",{value:"10th call",children:"10th call"})]})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:M.callDate,onChange:de=>Ae("callDate",de.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",placeholder:"Select call date"})]})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select which call attempt this is and the date when the call was made"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.callStatus,onChange:de=>Ae("callStatus",de.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400",children:[t.jsx("option",{value:"",children:"Select status"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Ring",children:"Ring"}),t.jsx("option",{value:"Busy",children:"Busy"}),t.jsx("option",{value:"Call Back",children:"Call Back"}),t.jsx("option",{value:"Hang Up",children:"Hang Up"}),t.jsx("option",{value:"Switch Off",children:"Switch Off"}),t.jsx("option",{value:"Future",children:"Future"}),t.jsx("option",{value:"Details Shared",children:"Details Shared"}),t.jsx("option",{value:"Demo Booked",children:"Demo Booked"}),t.jsx("option",{value:"Invalid",children:"Invalid"}),t.jsx("option",{value:"Existing",children:"Existing"}),t.jsx("option",{value:"Demo Completed",children:"Demo Completed"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the status of this call"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Conversation Notes ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(optional, but helpful)"})]}),t.jsx("textarea",{value:M.conversationNotes,onChange:de=>Ae("conversationNotes",de.target.value),rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 resize-y font-sans hover:border-gray-400",placeholder:"Document key points, objections, interests, and next steps discussed... (Optional)"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:M.nextAction,onChange:de=>Ae("nextAction",de.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 ${O.nextAction?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"follow-up-call",children:"Follow-up Call"}),t.jsx("option",{value:"send-proposal",children:"Send Proposal"}),t.jsx("option",{value:"schedule-meeting",children:"Schedule Meeting"}),t.jsx("option",{value:"send-email",children:"Send Email"}),t.jsx("option",{value:"connect-linkedin",children:"Connect on LinkedIn"})]}),O.nextAction&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),O.nextAction]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"What should happen next?"})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action Date ",t.jsx("span",{className:M.nextAction?"text-red-500":"text-gray-400 text-xs font-normal",children:M.nextAction?"*":"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",value:M.nextActionDate,onChange:de=>Ae("nextActionDate",de.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 ${O.nextActionDate?"border-red-300 bg-red-50":"border-gray-300"}`}),t.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]}),O.nextActionDate&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),O.nextActionDate]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"When should this happen?"})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-4 shadow-sm hover:shadow-md transition-all duration-200",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-lg flex items-center justify-center flex-shrink-0 animate-pulse",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-xs font-bold text-blue-900 mb-2",children:"Quality Check Requirements:"}),t.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),t.jsx("span",{children:"Add notes to keep track of what happened during this interaction"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),t.jsx("span",{children:"Next action must be scheduled within 7 days"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 mt-0.5",children:""}),t.jsx("span",{children:"Next Action and Next Action Date are optional"})]})]})]})]})}),O.submit&&t.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-3 animate-shake",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-medium text-red-700",children:O.submit})]})}),t.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-200",children:[t.jsx("button",{type:"button",onClick:Q,className:"px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 shadow-sm hover:shadow-md",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:G,className:"px-4 py-2 text-xs font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:hover:scale-100",children:G?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Activity"]})})]})]})})]})})}const Gf=l=>l.type==="call"&&l.callDate?new Date(l.callDate):l.type==="email"&&l.emailDate?new Date(l.emailDate):l.type==="linkedin"&&l.linkedinDate?new Date(l.linkedinDate):new Date(l.createdAt);function $k(){const{id:l}=ai(),n=Tr(),[a]=l0(),o=a.get("projectId"),s=a.get("returnTo")||"/projects",[e,m]=B.useState(null),[v,w]=B.useState([]),[N,S]=B.useState(!0),[D,L]=B.useState(null),[M,F]=B.useState("all"),[O,P]=B.useState(!1),[G,ae]=B.useState({name:"",email:"",firstPhone:"",personLinkedinUrl:"",company:""}),[re,ke]=B.useState(!1),[xe,je]=B.useState({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,activityId:null,editMode:!1});B.useEffect(()=>{l&&(Z(),oe())},[l]);const Z=async()=>{try{const V=await Vt.get(`/contacts/${l}`),H=V.data?.data||V.data;m(H),ae({name:H?.name||"",email:H?.email||"",firstPhone:H?.firstPhone||"",personLinkedinUrl:H?.personLinkedinUrl||H?.companyLinkedinUrl||"",company:H?.company||""})}catch(V){console.error("Error fetching contact:",V),L("Couldn't load the contact details. Try refreshing the page.")}},ce=()=>{P(!0)},ue=()=>{P(!1),e&&ae({name:e.name||"",email:e.email||"",firstPhone:e.firstPhone||"",personLinkedinUrl:e.personLinkedinUrl||e.companyLinkedinUrl||"",company:e.company||""})},Re=async()=>{if(l){ke(!0);try{const V={name:G.name.trim(),email:G.email.trim(),firstPhone:G.firstPhone.trim(),personLinkedinUrl:G.personLinkedinUrl.trim(),company:G.company.trim()},H=await Vt.put(`/contacts/${l}`,V);H.data.success&&(m(H.data.data),P(!1),oe())}catch(V){console.error("Error updating contact:",V),alert(V.response?.data?.error||"Couldn't save those changes. Give it another try.")}finally{ke(!1)}}},be=(V,H)=>{ae(Q=>({...Q,[V]:H}))},oe=async()=>{try{S(!0);const V=await Vt.get(`/activities/contact/${l}`);V.data.success&&w(V.data.data||[]),L(null)}catch(V){console.error("Error fetching activities:",V),L("Having trouble loading the activity history. Refresh the page and try again.")}finally{S(!1)}},he=(V,H=null)=>{e&&je({isOpen:!0,type:H?H.type:V,contactName:e.name||"N/A",companyName:e.company||"",projectId:H?H.projectId?._id||H.projectId:o||null,contactId:l,phoneNumber:e.firstPhone||null,email:e.email||null,linkedInProfileUrl:e.personLinkedinUrl||e.companyLinkedinUrl||null,activityId:H?H._id:null,editMode:!!H})},ye=(V=!1)=>{je({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,activityId:null,editMode:!1}),V&&s?setTimeout(()=>{n(s)},100):oe()},Te=V=>{if(!V)return"?";const H=V.trim().split(/\s+/);return H.length>=2?(H[0][0]+H[H.length-1][0]).toUpperCase():V.substring(0,2).toUpperCase()},fe=V=>{if(!V)return"N/A";const H=V instanceof Date?V:new Date(V);return isNaN(H.getTime())?"N/A":H.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},_e=V=>{if(!V)return"N/A";const H=V instanceof Date?V:new Date(V);return isNaN(H.getTime())?"N/A":H.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},We=V=>{switch(V){case"call":return t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-md",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-md",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center shadow-md",children:t.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},te=V=>{switch(V){case"call":return"Call";case"email":return"Email";case"linkedin":return"LinkedIn";default:return"Activity"}},me=v.filter(V=>M==="all"?!0:V.type===M).sort((V,H)=>Gf(H)-Gf(V)),W=v.filter(V=>V.type==="call"),pe=v.filter(V=>V.type==="email"),Le=v.filter(V=>V.type==="linkedin"),Ae=V=>{const Q={"connected-had-conversation":{bg:"bg-green-100",text:"text-green-800",label:"Connected"},"left-voicemail":{bg:"bg-blue-100",text:"text-blue-800",label:"Voicemail"},"no-answer":{bg:"bg-gray-100",text:"text-gray-800",label:"No Answer"},"email-sent-successfully":{bg:"bg-green-100",text:"text-green-800",label:"Sent"},"received-reply":{bg:"bg-purple-100",text:"text-purple-800",label:"Reply Received"},"connection-request-sent":{bg:"bg-blue-100",text:"text-blue-800",label:"Request Sent"},"message-sent":{bg:"bg-green-100",text:"text-green-800",label:"Message Sent"}}[V]||{bg:"bg-gray-100",text:"text-gray-800",label:V};return t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Q.bg} ${Q.text}`,children:Q.label})};return N?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse"}),t.jsx("div",{className:"relative animate-spin rounded-full h-14 w-14 border-2 border-gray-200 border-t-gray-900 mx-auto"})]}),t.jsx("p",{className:"tracking-wide text-sm uppercase text-gray-500 font-medium",children:"Loading activity history..."})]})}):D&&!e?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6 animate-fade-in",children:[t.jsx("div",{className:"w-20 h-20 mx-auto bg-red-100 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-10 h-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Contact"}),t.jsx("p",{className:"text-gray-600 mb-6",children:D}),t.jsxs("button",{onClick:()=>n(s),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})]})]})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8",children:[t.jsx("nav",{className:"mb-6 animate-fade-in-down",children:t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[t.jsxs("button",{onClick:()=>n(s),className:"hover:text-gray-900 transition-colors duration-200 flex items-center gap-1.5 font-medium",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),t.jsx("span",{children:"Back"})]}),t.jsx("svg",{className:"w-4 h-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),t.jsx("span",{className:"text-gray-700 font-semibold",children:"Activity History"})]})}),t.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-2xl border border-gray-200 shadow-lg p-6 lg:p-8 animate-fade-in-up",children:t.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:items-start gap-6 lg:gap-8",children:[t.jsxs("div",{className:"relative flex-shrink-0",children:[t.jsx("div",{className:"w-20 h-20 lg:w-24 lg:h-24 bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center text-2xl lg:text-3xl font-bold text-white shadow-xl ring-4 ring-blue-50 transform hover:scale-105 transition-transform duration-200",children:e?Te(e.name):"?"}),t.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-4 border-white shadow-md"})]}),t.jsx("div",{className:"flex-1 min-w-0 w-full lg:w-auto text-center lg:text-left",children:O?t.jsxs("div",{className:"space-y-4 w-full max-w-2xl",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),t.jsx("input",{type:"text",value:G.name,onChange:V=>be("name",V.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Contact name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),t.jsx("input",{type:"text",value:G.company,onChange:V=>be("company",V.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Company name"})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),t.jsx("input",{type:"email",value:G.email,onChange:V=>be("email",V.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"email@example.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),t.jsx("input",{type:"tel",value:G.firstPhone,onChange:V=>be("firstPhone",V.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+1234567890"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"LinkedIn URL"}),t.jsx("input",{type:"url",value:G.personLinkedinUrl,onChange:V=>be("personLinkedinUrl",V.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://linkedin.com/in/..."})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:Re,disabled:re,className:"px-6 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:re?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})}),t.jsx("button",{onClick:ue,disabled:re,className:"px-6 py-2 bg-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-300 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-2 tracking-tight",children:e?.name||"Contact"}),e?.company&&t.jsx("p",{className:"text-gray-600 text-lg lg:text-xl font-medium",children:e.company})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-center sm:items-center justify-center lg:justify-start gap-4 text-gray-600 text-sm",children:[e?.email&&t.jsxs("a",{href:`mailto:${e.email}`,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-50 hover:bg-blue-50 rounded-lg transition-colors duration-200 border border-gray-200 hover:border-blue-200 group",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{className:"font-medium",children:e.email})]}),e?.firstPhone&&t.jsxs("a",{href:`tel:${e.firstPhone}`,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-50 hover:bg-green-50 rounded-lg transition-colors duration-200 border border-gray-200 hover:border-green-200 group",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-green-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{className:"font-medium",children:e.firstPhone})]}),e?.personLinkedinUrl&&t.jsxs("a",{href:e.personLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-1.5 bg-gray-50 hover:bg-blue-50 rounded-lg transition-colors duration-200 border border-gray-200 hover:border-blue-200 group",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("span",{className:"font-medium",children:"LinkedIn"})]})]})]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full lg:w-auto",children:[!O&&t.jsxs("button",{onClick:ce,className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white font-semibold text-sm rounded-xl hover:from-gray-700 hover:to-gray-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),t.jsx("span",{children:"Edit Contact"})]}),!O&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>he("call"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white font-semibold text-sm rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{children:"Log Call"})]}),t.jsxs("button",{onClick:()=>he("email"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold text-sm rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{children:"Log Email"})]}),t.jsxs("button",{onClick:()=>he("linkedin"),className:"inline-flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-700 to-indigo-700 text-white font-semibold text-sm rounded-xl hover:from-blue-800 hover:to-indigo-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-100 w-full sm:w-auto",children:[t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("span",{children:"Log LinkedIn"})]})]})]})]})})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-10",children:[D&&t.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 text-red-700 px-5 py-4 rounded-xl shadow-md animate-shake",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),t.jsx("span",{className:"font-medium",children:D})]})}),v.length>0&&t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-8",children:[t.jsx("div",{onClick:()=>F("all"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="all"?"from-blue-500 to-blue-600 border-blue-400 text-white":"from-white to-blue-50 border-blue-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="all"?"text-blue-100":"text-gray-600"}`,children:"Total Activities"}),t.jsx("p",{className:`text-3xl font-bold ${M==="all"?"text-white":"text-gray-900"}`,children:v.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="all"?"text-blue-100":"text-gray-500"}`,children:"All interactions"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="all"?"bg-white bg-opacity-20":"bg-gradient-to-br from-blue-500 to-blue-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})]})}),t.jsx("div",{onClick:()=>F("call"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="call"?"from-green-500 to-green-600 border-green-400 text-white":"from-white to-green-50 border-green-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="call"?"text-green-100":"text-gray-600"}`,children:"Calls"}),t.jsx("p",{className:`text-3xl font-bold ${M==="call"?"text-white":"text-gray-900"}`,children:W.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="call"?"text-green-100":"text-gray-500"}`,children:"Phone interactions"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="call"?"bg-white bg-opacity-20":"bg-gradient-to-br from-green-500 to-green-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]})}),t.jsx("div",{onClick:()=>F("email"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="email"?"from-blue-500 to-blue-600 border-blue-400 text-white":"from-white to-blue-50 border-blue-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="email"?"text-blue-100":"text-gray-600"}`,children:"Emails"}),t.jsx("p",{className:`text-3xl font-bold ${M==="email"?"text-white":"text-gray-900"}`,children:pe.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="email"?"text-blue-100":"text-gray-500"}`,children:"Email outreach"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="email"?"bg-white bg-opacity-20":"bg-gradient-to-br from-blue-500 to-blue-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]})}),t.jsx("div",{onClick:()=>F("linkedin"),className:`bg-gradient-to-br rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-all duration-200 cursor-pointer transform hover:scale-105 ${M==="linkedin"?"from-indigo-500 to-indigo-600 border-indigo-400 text-white":"from-white to-indigo-50 border-indigo-100"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:`text-sm font-semibold uppercase tracking-wide mb-1 ${M==="linkedin"?"text-indigo-100":"text-gray-600"}`,children:"LinkedIn"}),t.jsx("p",{className:`text-3xl font-bold ${M==="linkedin"?"text-white":"text-gray-900"}`,children:Le.length}),t.jsx("p",{className:`text-xs mt-1 ${M==="linkedin"?"text-indigo-100":"text-gray-500"}`,children:"LinkedIn activities"})]}),t.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${M==="linkedin"?"bg-white bg-opacity-20":"bg-gradient-to-br from-indigo-500 to-indigo-600"}`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})})]})}),(()=>{const V=v.filter(we=>we.type==="linkedin"&&we.status),H=V.length>0?V.sort((we,Ce)=>Gf(Ce)-Gf(we))[0].status:null;if(!H)return null;const Q=we=>{switch(we){case"CIP":return"from-white to-blue-50 border-blue-200";case"No Reply":return"from-white to-gray-50 border-gray-200";case"Not Interested":return"from-white to-red-50 border-red-200";case"Meeting Proposed":return"from-white to-yellow-50 border-yellow-200";case"Meeting Scheduled":return"from-white to-cyan-50 border-cyan-200";case"In-Person Meeting":return"from-white to-indigo-50 border-indigo-200";case"Meeting Completed":return"from-white to-green-50 border-green-200";case"SQL":return"from-white to-emerald-50 border-emerald-200";case"Tech Discussion":return"from-white to-purple-50 border-purple-200";case"WON":return"from-white to-green-100 border-green-400 border-2";case"Lost":return"from-white to-red-100 border-red-400 border-2";case"Low Potential - Open":return"from-white to-orange-50 border-orange-200";case"Potential Future":return"from-white to-teal-50 border-teal-200";default:return"from-white to-gray-50 border-gray-200"}},se=we=>{switch(we){case"CIP":return"text-blue-800";case"No Reply":return"text-gray-800";case"Not Interested":return"text-red-800";case"Meeting Proposed":return"text-yellow-800";case"Meeting Scheduled":return"text-cyan-800";case"In-Person Meeting":return"text-indigo-800";case"Meeting Completed":return"text-green-800";case"SQL":return"text-emerald-800";case"Tech Discussion":return"text-purple-800";case"WON":return"text-green-900";case"Lost":return"text-red-900";case"Low Potential - Open":return"text-orange-800";case"Potential Future":return"text-teal-800";default:return"text-gray-800"}},de=we=>{switch(we){case"CIP":return"bg-blue-100 border-blue-200";case"No Reply":return"bg-gray-100 border-gray-200";case"Not Interested":return"bg-red-100 border-red-200";case"Meeting Proposed":return"bg-yellow-100 border-yellow-200";case"Meeting Scheduled":return"bg-cyan-100 border-cyan-200";case"In-Person Meeting":return"bg-indigo-100 border-indigo-200";case"Meeting Completed":return"bg-green-100 border-green-200";case"SQL":return"bg-emerald-100 border-emerald-200";case"Tech Discussion":return"bg-purple-100 border-purple-200";case"WON":return"bg-green-200 border-green-400 border-2";case"Lost":return"bg-red-200 border-red-400 border-2";case"Low Potential - Open":return"bg-orange-100 border-orange-200";case"Potential Future":return"bg-teal-100 border-teal-200";default:return"bg-gray-100 border-gray-200"}};return t.jsx("div",{className:`bg-gradient-to-br ${Q(H)} rounded-2xl border shadow-lg p-6 hover:shadow-xl transition-shadow duration-200`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-semibold uppercase tracking-wide mb-1",children:"Current Status"}),t.jsx("p",{className:`text-2xl font-bold ${se(H)} mb-1`,children:H}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Latest LinkedIn activity"})]}),t.jsx("div",{className:`w-14 h-14 ${de(H)} rounded-xl flex items-center justify-center shadow-lg`,children:t.jsx("svg",{className:"w-7 h-7 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})})]})})})()]}),v.length>0&&t.jsx("div",{className:"mb-6 bg-white rounded-2xl border border-gray-200 shadow-lg p-2",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs("button",{onClick:()=>F("all"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="all"?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"All (",v.length,")"]}),t.jsxs("button",{onClick:()=>F("call"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="call"?"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Calls (",W.length,")"]}),t.jsxs("button",{onClick:()=>F("email"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="email"?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Emails (",pe.length,")"]}),t.jsxs("button",{onClick:()=>F("linkedin"),className:`px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${M==="linkedin"?"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white shadow-lg transform scale-105":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),"LinkedIn (",Le.length,")"]})]})}),v.length===0?t.jsxs("div",{className:"text-center py-20 bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-lg border border-gray-200 animate-fade-in",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-2xl bg-gradient-to-br from-gray-100 to-gray-200 mb-6 shadow-inner",children:t.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),t.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No activities yet"}),t.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto text-lg",children:"Start logging activities to track your interactions with this contact and build a comprehensive engagement history."}),t.jsx("div",{className:"flex justify-center gap-3",children:t.jsxs("button",{onClick:()=>he("call"),className:"inline-flex items-center gap-2 px-6 py-3.5 bg-gradient-to-r from-green-600 to-green-700 text-white font-semibold rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-100",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Log First Activity"]})})]}):t.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-lg overflow-hidden",children:[t.jsx("div",{className:"px-6 lg:px-8 py-5 bg-gradient-to-r from-gray-50 to-white border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Activity Timeline"}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Complete interaction history with ",e?.name]})]}),t.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-3 py-1.5 bg-blue-50 rounded-lg border border-blue-100",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("span",{className:"text-xs font-semibold text-blue-700",children:[v.length," ",v.length===1?"activity":"activities"]})]})]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:me.length===0?t.jsxs("div",{className:"text-center py-16",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gray-100 mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:["No ",M==="all"?"":M," activities found"]}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Try selecting a different filter or log a new activity."}),t.jsxs("button",{onClick:()=>{he({call:"call",email:"email",linkedin:"linkedin"}[M]||"call")},className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Log ",M==="all"?"Activity":M.charAt(0).toUpperCase()+M.slice(1)]})]}):me.map((V,H)=>t.jsx("div",{className:"p-6 lg:p-8 hover:bg-gradient-to-r hover:from-gray-50 hover:to-white transition-all duration-200 group",children:t.jsxs("div",{className:"flex gap-5 lg:gap-6",children:[t.jsxs("div",{className:"flex-shrink-0 relative",children:[We(V.type),H<v.length-1&&t.jsx("div",{className:"absolute top-12 left-1/2 transform -translate-x-1/2 w-0.5 h-full bg-gradient-to-b from-gray-200 to-transparent"})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"flex items-start justify-between gap-4 mb-3",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:te(V.type)}),Ae(V.outcome),V.status&&(V.type==="linkedin"||V.type==="email")&&t.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${V.status==="CIP"?"bg-blue-100 text-blue-800":V.status==="No Reply"?"bg-gray-100 text-gray-800":V.status==="Not Interested"?"bg-red-100 text-red-800":V.status==="Meeting Proposed"?"bg-yellow-100 text-yellow-800":V.status==="Meeting Scheduled"?"bg-cyan-100 text-cyan-800":V.status==="In-Person Meeting"?"bg-indigo-100 text-indigo-800":V.status==="Meeting Completed"?"bg-green-100 text-green-800":V.status==="SQL"?"bg-emerald-100 text-emerald-800":V.status==="Tech Discussion"?"bg-purple-100 text-purple-800":V.status==="WON"?"bg-green-200 text-green-900 border-2 border-green-400":V.status==="Lost"?"bg-red-200 text-red-900 border-2 border-red-400":V.status==="Low Potential - Open"?"bg-orange-100 text-orange-800":V.status==="Potential Future"?"bg-teal-100 text-teal-800":V.status==="Interested"?"bg-green-100 text-green-800":V.status==="Wrong Person"?"bg-orange-100 text-orange-800":V.status==="Bounce"?"bg-red-100 text-red-800":V.status==="Opt-Out"?"bg-gray-100 text-gray-800":V.status==="Out of Office"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:V.status})]}),t.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("span",{className:"font-medium",children:_e(Gf(V))})]}),V.projectId?.companyName&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-gray-300",children:""}),t.jsx("span",{className:"px-2.5 py-1 bg-gray-100 text-gray-700 rounded-md text-xs font-medium",children:V.projectId.companyName})]})]})]})}),V.type==="call"&&(V.callNumber||V.callDate||V.callStatus)&&t.jsx("div",{className:"mb-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm",children:t.jsxs("div",{className:"flex flex-wrap gap-4",children:[V.callNumber&&t.jsxs("div",{className:"flex-1 min-w-[120px]",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Call"})]}),t.jsx("p",{className:"text-sm font-medium text-green-800",children:V.callNumber})]}),V.callDate&&t.jsxs("div",{className:"flex-1 min-w-[120px]",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Call Date"})]}),t.jsx("p",{className:"text-sm font-medium text-green-800",children:new Date(V.callDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),V.callStatus&&t.jsxs("div",{className:"flex-1 min-w-[120px]",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Status"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${V.callStatus==="Interested"?"bg-green-100 text-green-800":V.callStatus==="Not Interested"?"bg-red-100 text-red-800":V.callStatus==="Ring"?"bg-gray-100 text-gray-800":V.callStatus==="Busy"?"bg-blue-100 text-blue-800":V.callStatus==="Call Back"?"bg-purple-100 text-purple-800":V.callStatus==="Hang Up"?"bg-pink-100 text-pink-800":V.callStatus==="Switch Off"?"bg-amber-100 text-amber-800":V.callStatus==="Future"?"bg-indigo-100 text-indigo-800":V.callStatus==="Details Shared"?"bg-yellow-100 text-yellow-800":V.callStatus==="Demo Booked"?"bg-cyan-100 text-cyan-800":V.callStatus==="Invalid"?"bg-gray-100 text-gray-800":V.callStatus==="Existing"?"bg-orange-100 text-orange-800":(V.callStatus==="Demo Completed","bg-gray-100 text-gray-800")}`,children:V.callStatus})]})]})}),V.type==="linkedin"&&V.linkedInAccountName&&t.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wide",children:"LinkedIn Account Used"})]}),t.jsx("p",{className:"text-sm font-medium text-blue-800",children:V.linkedInAccountName})]}),V.type==="email"&&V.status&&t.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("p",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wide",children:"Status"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${V.status==="No Reply"?"bg-gray-100 text-gray-800":V.status==="Not Interested"?"bg-red-100 text-red-800":V.status==="Meeting Proposed"?"bg-yellow-100 text-yellow-800":V.status==="Meeting Scheduled"?"bg-cyan-100 text-cyan-800":V.status==="Meeting Completed"||V.status==="Interested"?"bg-green-100 text-green-800":V.status==="Wrong Person"?"bg-orange-100 text-orange-800":V.status==="Bounce"?"bg-red-100 text-red-800":V.status==="Opt-Out"?"bg-gray-100 text-gray-800":V.status==="Out of Office"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:V.status})]}),V.type==="linkedin"&&(V.lnRequestSent||V.connected)&&t.jsxs("div",{className:"mb-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[V.lnRequestSent&&t.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-semibold text-purple-900 uppercase tracking-wide",children:"Ln Request Sent"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${V.lnRequestSent==="Yes"?"bg-green-100 text-green-800":V.lnRequestSent==="No"?"bg-red-100 text-red-800":V.lnRequestSent==="Existing Connect"?"bg-blue-100 text-blue-800":V.lnRequestSent==="Inactive Profile"?"bg-gray-100 text-gray-800":V.lnRequestSent==="Irrelevant Profile"?"bg-orange-100 text-orange-800":V.lnRequestSent==="Open to Work"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:V.lnRequestSent})]}),V.connected&&t.jsxs("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-semibold text-green-900 uppercase tracking-wide",children:"Connected"})]}),t.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${V.connected==="Yes"?"bg-green-100 text-green-800":V.connected==="No"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:V.connected})]})]}),V.conversationNotes&&(()=>{const se=V.conversationNotes.replace(/\[Contact:.*?\|.*?Email:.*?\|.*?Phone:.*?\|.*?LinkedIn:.*?\]/g,"").trim().replace(/\[Contact:.*?\]/g,"").trim();return se?t.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-xl border border-gray-100",children:t.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap leading-relaxed",children:se})}):null})(),V.nextAction&&t.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm",children:[t.jsx("div",{className:"flex-shrink-0 mt-0.5",children:t.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-semibold text-blue-900 mb-1",children:["Next Action: ",t.jsx("span",{className:"font-bold",children:V.nextAction})]}),V.nextActionDate&&t.jsxs("p",{className:"text-xs text-blue-700 font-medium",children:["Scheduled for ",fe(V.nextActionDate)]})]})]}),t.jsx("div",{className:"mt-4 flex justify-end",children:t.jsxs("button",{onClick:()=>he(null,V),className:`inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg hover:bg-opacity-90 transition-all duration-200 ${V.type==="call"?"text-green-700 bg-green-50 border border-green-200 hover:bg-green-100 hover:border-green-300":V.type==="email"?"text-blue-700 bg-blue-50 border border-blue-200 hover:bg-blue-100 hover:border-blue-300":"text-indigo-700 bg-indigo-50 border border-indigo-200 hover:bg-indigo-100 hover:border-indigo-300"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]})})]})]})},V._id||H))})]})]}),t.jsx(wv,{isOpen:xe.isOpen,onClose:ye,type:xe.type,contactName:xe.contactName,companyName:xe.companyName,projectId:xe.projectId,contactId:xe.contactId,phoneNumber:xe.phoneNumber,email:xe.email,linkedInProfileUrl:xe.linkedInProfileUrl,activityId:xe.activityId,editMode:xe.editMode})]})}function qk(){const{companyName:l}=ai(),n=Tr(),[a]=l0(),o=a.get("category")||"IND-IT & Service",[s,e]=B.useState([]),[m,v]=B.useState(!0),[w,N]=B.useState(null),[S,D]=B.useState(null),[L,M]=B.useState(!1),[F,O]=B.useState(null),P=decodeURIComponent(l);B.useEffect(()=>{G()},[P,o]);const G=async()=>{try{v(!0);const ce={category:o,page:1,limit:1e3},ue=await Vt.get("/contacts",{params:ce}),Re=ue?.data?.data||ue?.data||[],be=Array.isArray(Re)?Re.filter(oe=>(oe.company||"No Company")===P):[];e(be),N(null)}catch(ce){N("Failed to fetch company contacts. Please try again."),console.error("Error fetching contacts:",ce)}finally{v(!1)}},ae=ce=>{if(!ce)return"?";const ue=ce.trim().split(/\s+/);return ue.length>=2?(ue[0][0]+ue[1][0]).toUpperCase():ce.substring(0,2).toUpperCase()},re=ce=>ce?(ce=ce.replace(/^#{1,6}\s+/gm,""),ce=ce.replace(/\*\*([^*]+)\*\*/g,"$1"),ce=ce.replace(/__([^_]+)__/g,"$1"),ce=ce.replace(/\*([^*]+)\*/g,"$1"),ce=ce.replace(/_([^_]+)_/g,"$1"),ce=ce.replace(/^[\s]*[-*+]\s+/gm," "),ce=ce.replace(/^\d+\.\s+/gm,""),ce=ce.replace(/\n{3,}/g,`

`),ce=ce.trim(),ce):"",ke=ce=>{const ue=`?category=${encodeURIComponent(o)}`;n(`/contacts/${ce}${ue}`)},xe=()=>{const ce=`?category=${encodeURIComponent(o)}`;n(`/contacts${ce}`)},je=async()=>{if(!Z?.website){O("Website URL is required for analysis");return}try{M(!0),O(null);const ce=await Vt.post("/company-analysis/analyze",{companyName:P,website:Z.website});ce.data.success?D(ce.data.data):O(ce.data.error||"Failed to analyze company")}catch(ce){console.error("Error analyzing company:",ce),console.error("Error response:",ce?.response),console.error("Error status:",ce?.response?.status),console.error("Error data:",ce?.response?.data);let ue="Failed to analyze company website. Please try again.";ce?.response?.status===429?ue=ce?.response?.data?.error||"OpenAI API quota exceeded. Please check your OpenAI account billing and add credits.":ce?.response?.status===500?ue=ce?.response?.data?.error||"Server error. Please check if OpenAI API key is configured.":ce?.response?.status===401?ue=ce?.response?.data?.error||"OpenAI API key is invalid. Please check your configuration.":ce?.response?.status===400?ue=ce?.response?.data?.error||"Invalid request. Please check the company website URL.":ce?.code==="ECONNREFUSED"||ce?.message?.includes("Network Error")?ue="Cannot connect to server. Please make sure the backend is running.":ce?.response?.data?.error&&(ue=ce.response.data.error),O(ue)}finally{M(!1)}};if(m)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-4 animate-fade-in",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 rounded-full bg-gray-200 blur-xl animate-pulse"}),t.jsx("div",{className:"relative animate-spin rounded-full h-14 w-14 border-2 border-gray-200 border-t-gray-900 mx-auto"})]}),t.jsx("p",{className:"tracking-wide text-sm uppercase text-gray-500 font-medium",children:"Loading company details..."})]})});if(w)return t.jsx("div",{className:"min-h-screen bg-white py-8",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 text-red-700 px-5 py-4 rounded-lg shadow-md",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),t.jsx("span",{className:"font-medium",children:w})]})})})});const Z=s.length>0?s[0]:null;return t.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsxs("button",{onClick:xe,className:"mb-6 flex items-center gap-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Contacts"]}),Z?.website&&t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-white text-slate-900 shadow-lg border border-slate-100",children:[t.jsx("div",{className:"absolute inset-0 opacity-60 bg-[radial-gradient(circle_at_20%_20%,_#e0f2ff,_transparent_30%),_radial-gradient(circle_at_85%_15%,_#ede9fe,_transparent_28%)]"}),t.jsxs("div",{className:"relative p-6 lg:p-8 flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm uppercase tracking-wide font-semibold text-blue-700",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Groq AI Insight"]}),t.jsx("h2",{className:"text-3xl font-bold text-slate-900",children:P}),t.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-slate-700",children:[Z.website&&t.jsxs("a",{href:Z.website.startsWith("http")?Z.website:`https://${Z.website}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-50 border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition",children:[t.jsxs("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4a8 8 0 100 16 8 8 0 000-16z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2 12h20M12 2c2.5 2.5 4 6 4 10s-1.5 7.5-4 10c-2.5-2.5-4-6-4-10s1.5-7.5 4-10z"})]}),Z.website]}),Z.companyLinkedinUrl&&t.jsxs("a",{href:Z.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-50 border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"LinkedIn"]}),Z.email&&t.jsxs("a",{href:`mailto:${Z.email}`,className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-50 border border-slate-200 hover:border-blue-300 hover:bg-blue-50 transition",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),Z.email]})]})]}),t.jsx("div",{className:"flex-shrink-0",children:t.jsx("button",{onClick:je,disabled:L,className:"group inline-flex items-center gap-2 px-5 py-3 bg-blue-600 text-white text-sm font-semibold rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-60 disabled:hover:translate-y-0",children:L?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Summarizing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4 text-white group-hover:translate-x-0.5 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Summarize"]})})})]})]}),F&&t.jsx("div",{className:"mt-3 bg-red-50 border border-red-100 text-red-700 px-4 py-3 rounded-xl shadow-sm animate-fade-in",children:t.jsx("p",{className:"text-sm",children:F})}),S&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mt-6 animate-fade-in space-y-6",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-blue-50/30 rounded-2xl border border-slate-200 shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-100/20 rounded-full -mr-16 -mt-16 blur-2xl"}),t.jsxs("div",{className:"relative p-6 h-full flex flex-col",children:[t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("span",{className:"text-xl font-bold text-white",children:"1"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-xs uppercase tracking-wider text-blue-600 font-bold mb-1",children:"Company Overview"}),t.jsx("p",{className:"text-base text-gray-900 font-semibold",children:"Position & Story"})]})]}),t.jsx("div",{className:"flex-1 text-sm text-gray-700 leading-relaxed whitespace-pre-line overflow-y-auto",children:re(S.analysis.companyOverview||S.fullText.split("1)")[1]?.split("2)")[0]?.trim()||"Analysis not available")}),t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Strategic positioning"})]})})]})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-emerald-50/30 rounded-2xl border border-slate-200 shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-100/20 rounded-full -mr-16 -mt-16 blur-2xl"}),t.jsxs("div",{className:"relative p-6 h-full flex flex-col",children:[t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("span",{className:"text-xl font-bold text-white",children:"2"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-xs uppercase tracking-wider text-emerald-600 font-bold mb-1",children:"Core Offering"}),t.jsx("p",{className:"text-base text-gray-900 font-semibold",children:"Products & Value"})]})]}),t.jsx("div",{className:"flex-1 text-sm text-gray-700 leading-relaxed whitespace-pre-line overflow-y-auto",children:re(S.analysis.coreOffering||S.fullText.split("2)")[1]?.split("3)")[0]?.trim()||"Analysis not available")}),t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Value proposition"})]})})]})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-purple-50/30 rounded-2xl border border-slate-200 shadow-sm hover:shadow-xl transition-all duration-300 overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-100/20 rounded-full -mr-16 -mt-16 blur-2xl"}),t.jsxs("div",{className:"relative p-6 h-full flex flex-col",children:[t.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("span",{className:"text-xl font-bold text-white",children:"3"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-xs uppercase tracking-wider text-purple-600 font-bold mb-1",children:"Business Considerations"}),t.jsx("p",{className:"text-base text-gray-900 font-semibold",children:"Risks & Opportunities"})]})]}),t.jsx("div",{className:"flex-1 text-sm text-gray-700 leading-relaxed whitespace-pre-line overflow-y-auto",children:re(S.analysis.businessConsiderations||S.fullText.split("3)")[1]?.trim()||"Analysis not available")}),t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),t.jsx("span",{children:"Strategic insights"})]})})]})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-2 mt-4",children:[S.generatedAt&&t.jsxs("div",{className:"text-xs text-gray-500",children:["Generated on ",new Date(S.generatedAt).toLocaleString()]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:je,disabled:L,className:"text-sm text-blue-600 hover:text-blue-800 font-semibold",children:"Re-run"}),t.jsx("button",{onClick:()=>{D(null),O(null)},className:"text-sm text-gray-600 hover:text-gray-900",children:"Clear"})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 sticky top-4",children:[t.jsxs("div",{className:"flex flex-col items-center mb-6",children:[t.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-lg flex items-center justify-center mb-4",children:t.jsx("span",{className:"text-3xl font-bold text-blue-700",children:ae(P)})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center mb-2",children:P}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),t.jsxs("span",{children:[s.length," ",s.length===1?"person":"people"]})]})]}),t.jsxs("div",{className:"space-y-4 border-t border-gray-200 pt-6",children:[Z?.industry&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Industry"}),t.jsx("p",{className:"text-sm text-gray-900",children:Z.industry})]}),(Z?.companyAddress||Z?.companyCity||Z?.companyState||Z?.companyCountry)&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Address"}),t.jsx("p",{className:"text-sm text-gray-900",children:[Z.companyAddress,Z.companyCity,Z.companyState,Z.companyCountry].filter(Boolean).join(", ")||"Not available"})]}),Z?.companyPhone&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Phone"}),t.jsx("a",{href:`tel:${Z.companyPhone}`,className:"text-sm text-blue-600 hover:text-blue-700 hover:underline",children:Z.companyPhone})]}),Z?.website&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"Website"}),t.jsx("a",{href:Z.website.startsWith("http")?Z.website:`https://${Z.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 hover:underline",children:Z.website})]}),Z?.companyLinkedinUrl&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-1",children:"LinkedIn"}),t.jsxs("a",{href:Z.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 hover:underline",children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"View Company LinkedIn"]})]})]})]})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:["People at ",P]}),s.length===0?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"No contacts found for this company."})}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(ce=>t.jsxs("div",{onClick:()=>ke(ce._id),className:"bg-gray-50 rounded-lg p-4 border border-gray-200 hover:border-blue-300 hover:shadow-md transition-all cursor-pointer",children:[t.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[t.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-sm font-semibold text-blue-700",children:ce.name?ce.name.substring(0,2).toUpperCase():"?"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-1 truncate",children:ce.name||"Unknown"}),ce.title&&t.jsx("p",{className:"text-xs text-gray-600 mb-2 truncate",children:ce.title})]})]}),t.jsxs("div",{className:"space-y-2",children:[ce.email&&t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("a",{href:`mailto:${ce.email}`,onClick:ue=>ue.stopPropagation(),className:"hover:text-blue-600 hover:underline truncate",children:ce.email})]}),ce.firstPhone&&t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[t.jsx("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("a",{href:`tel:${ce.firstPhone}`,onClick:ue=>ue.stopPropagation(),className:"hover:text-blue-600 hover:underline",children:ce.firstPhone})]}),(ce.personLinkedinUrl||ce.companyLinkedinUrl)&&t.jsx("div",{className:"flex items-center gap-2 text-xs",children:t.jsxs("a",{href:ce.personLinkedinUrl||ce.companyLinkedinUrl,onClick:ue=>ue.stopPropagation(),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 hover:bg-blue-100 rounded text-xs",children:[t.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"LinkedIn"]})})]})]},ce._id))})]})})]})]})})}function Yk(){const[l,n]=B.useState(null),[a,o]=B.useState(!1),[s,e]=B.useState(""),[m,v]=B.useState(""),[w,N]=B.useState(null),[S,D]=B.useState(""),[L,M]=B.useState([]),[F,O]=B.useState(!0),[P,G]=B.useState(!1),[ae,re]=B.useState(""),[ke,xe]=B.useState(!1);B.useEffect(()=>{je()},[]);const je=async()=>{try{O(!0);const be=(await Vt.get("/categories")).data?.data||[];M(be),be.length>0&&!S&&D(be[0])}catch(Re){console.error("Error fetching categories:",Re);const be=["IND-IT & Service","Accounting & Book keeping","Web Design & Development","Enterprise Software","Finance Services - IND","E-commerce","CRM","Middle East","International","USA Chicago","IT Company - USA","IT Company - Chicago","Weam.ai Mumbai Data","ERP Software","ERP NEXT- Manufacturing-Automotive Components & Spares","Salon & Spa - Chicago","SPA & SALON AHMEDABAD","kology"];M(be),S||D(be[0])}finally{O(!1)}},Z=async()=>{if(!ae.trim()){v("Please enter a category name");return}try{xe(!0),v(""),(await Vt.post("/categories",{name:ae.trim()})).data.success&&(await je(),D(ae.trim()),re(""),G(!1),e("Category added successfully!"),setTimeout(()=>e(""),3e3))}catch(Re){v(Re.response?.data?.error||"Failed to add category")}finally{xe(!1)}},ce=Re=>{n(Re.target.files?.[0]||null),e(""),v(""),N(null)},ue=async()=>{if(!l){v("Please select a CSV or Excel file.");return}const Re=new FormData;Re.append("file",l),Re.append("category",S);try{o(!0),v(""),e(""),N(null);const be=await Vt.post("/import/upload",Re,{headers:{"Content-Type":"multipart/form-data"}});N(be.data.data),e("Import completed successfully")}catch(be){const oe=be?.response?.data?.error||"Upload failed. Please try again.";v(oe)}finally{o(!1)}};return t.jsx("div",{className:"min-h-screen bg-gray-50 py-10",children:t.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Import Contacts"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Upload a CSV or Excel file with the following columns: Name (required), Company (required), Email (required), Person Linkedin Url (required), Title, First Phone, # Employees, Category, Industry, Keywords, Website, Company Linkedin Url, Facebook Url, Twitter Url, City, State, Country, Company Address, Company City, Company State, Company Country, Company Phone, SEO Description, Technologies, Annual Revenue."}),t.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Select category to assign"}),t.jsxs("button",{type:"button",onClick:()=>{G(!P),v(""),e("")},className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),P?"Cancel":"Add New"]})]}),P?t.jsx("div",{className:"space-y-2",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:ae,onChange:Re=>re(Re.target.value),placeholder:"Enter new category name",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyDown:Re=>{Re.key==="Enter"&&Z()}}),t.jsx("button",{type:"button",onClick:Z,disabled:ke||!ae.trim(),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-sm font-medium",children:ke?"Adding...":"Add"})]})}):t.jsx("select",{value:S,onChange:Re=>D(Re.target.value),disabled:F,className:"border border-gray-300 rounded-lg px-3 py-2 w-full text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:F?t.jsx("option",{children:"Loading categories..."}):L.length===0?t.jsx("option",{children:"No categories available"}):L.map(Re=>t.jsx("option",{value:Re,children:Re},Re))})]}),t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select file (CSV, XLSX, or XLS)"}),t.jsx("input",{type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:ce,className:"block w-full text-sm text-gray-700 border border-gray-300 rounded-lg p-2 mb-4"}),t.jsx("button",{onClick:ue,disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed",children:a?"Uploading...":"Upload & Import"}),s&&t.jsx("div",{className:"mt-4 p-3 bg-green-50 text-green-700 border border-green-200 rounded",children:s}),m&&t.jsx("div",{className:"mt-4 p-3 bg-red-50 text-red-700 border border-red-200 rounded",children:m}),w&&t.jsxs("div",{className:"mt-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-gray-700",children:"Total Rows:"}),t.jsx("span",{className:"ml-2 text-gray-900",children:w.totalRows})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-gray-700",children:"Valid Contacts:"}),t.jsx("span",{className:"ml-2 text-gray-900",children:w.validContacts})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-green-700",children:"Inserted:"}),t.jsx("span",{className:"ml-2 text-green-900 font-semibold",children:w.inserted})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("strong",{className:"text-orange-700",children:"Skipped (Duplicates):"}),t.jsx("span",{className:"ml-2 text-orange-900 font-semibold",children:w.skipped||0})]})]}),w.columnMapping&&t.jsx("div",{className:"mt-4 space-y-3",children:t.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[t.jsx("div",{className:"text-sm font-semibold text-blue-800 mb-3",children:"Column Mapping Information"}),w.columnMapping.detected&&w.columnMapping.detected.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"text-xs font-semibold text-blue-700 mb-1",children:["Detected Columns (",w.columnMapping.detected.length,"):"]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:w.columnMapping.detected.map((Re,be)=>t.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:Re},be))})]}),w.columnMapping.mapped&&w.columnMapping.mapped.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"text-xs font-semibold text-green-700 mb-1",children:["Successfully Mapped (",w.columnMapping.mapped.length,"):"]}),t.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:w.columnMapping.mapped.map((Re,be)=>t.jsxs("div",{className:"text-xs text-gray-700",children:[t.jsx("span",{className:"font-medium",children:Re.original}),t.jsx("span",{className:"mx-2",children:""}),t.jsx("span",{className:"text-green-700",children:Re.mapped})]},be))})]}),w.columnMapping.unmapped&&w.columnMapping.unmapped.length>0&&t.jsxs("div",{children:[t.jsxs("div",{className:"text-xs font-semibold text-orange-700 mb-1",children:["Unmapped Columns (",w.columnMapping.unmapped.length,"):"]}),t.jsx("div",{className:"text-xs text-orange-600 mb-1",children:"These columns were not recognized and will be ignored."}),t.jsx("div",{className:"flex flex-wrap gap-2",children:w.columnMapping.unmapped.map((Re,be)=>t.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:Re},be))})]})]})}),w.errors&&w.errors.length>0&&t.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsxs("div",{className:"text-sm font-semibold text-yellow-800 mb-2",children:["Warnings & Errors (",w.errors.length,"):"]}),t.jsx("ul",{className:"list-disc list-inside text-sm text-yellow-700 space-y-1 max-h-60 overflow-y-auto",children:w.errors.map((Re,be)=>t.jsx("li",{children:Re},be))})]})]})]})]})})}const Cb={name:"",title:"",company:"",email:"",firstPhone:"",employees:"",category:"IND-IT & Service",industry:"",keywords:"",personLinkedinUrl:"",website:"",companyLinkedinUrl:"",facebookUrl:"",twitterUrl:"",city:"",state:"",country:"",companyAddress:"",companyCity:"",companyState:"",companyCountry:"",companyPhone:"",seoDescription:"",technologies:"",annualRevenue:""};function Gk(){const[l,n]=B.useState(Cb),[a,o]=B.useState(!1),[s,e]=B.useState(""),m=Tr(),v=N=>{const{name:S,value:D}=N.target;n(L=>({...L,[S]:D}))},w=async N=>{if(N.preventDefault(),!l.name.trim()){e("Name is required.");return}try{o(!0),e(""),await Vt.post("/contacts",l),m("/contacts")}catch(S){let D=S?.response?.data?.error||"Failed to save contact.";(S?.response?.status===409||S?.response?.data?.duplicate)&&(D=`Duplicate contact detected: ${D}`),e(D)}finally{o(!1)}};return t.jsx("div",{className:"min-h-screen bg-gray-50 py-10",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Add Contact"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Enter the contact details and save to MongoDB."})]}),t.jsx("button",{onClick:()=>m("/contacts"),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Back to Contacts"})]}),s&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded",children:s}),t.jsxs("form",{onSubmit:w,className:"bg-white shadow rounded-lg p-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[[["name","Name",!0],["title","Title"],["company","Company"],["email","Email",!1,"email"],["firstPhone","First Phone"],["employees","# Employees"],["category","Category"],["industry","Industry"],["keywords","Keywords"],["personLinkedinUrl","Person Linkedin Url"],["website","Website"],["companyLinkedinUrl","Company Linkedin Url"],["facebookUrl","Facebook Url"],["twitterUrl","Twitter Url"],["city","City"],["state","State"],["country","Country"],["companyAddress","Company Address"],["companyCity","Company City"],["companyState","Company State"],["companyCountry","Company Country"],["companyPhone","Company Phone"],["seoDescription","SEO Description"],["technologies","Technologies"],["annualRevenue","Annual Revenue"]].map(([N,S,D,L="text"])=>t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1",children:[S,D?" *":""]}),t.jsx("input",{type:L,name:N,value:l[N],onChange:v,required:D,className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]},N)),t.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3 mt-2",children:[t.jsx("button",{type:"button",onClick:()=>n(Cb),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Reset"}),t.jsx("button",{type:"submit",disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400",children:a?"Saving...":"Save Contact"})]})]})]})})}function Kk(){const l=Tr(),[n,a]=B.useState(""),[o,s]=B.useState([]),[e,m]=B.useState(!0),[v,w]=B.useState(null),[N,S]=B.useState({total:0,totalProspects:0,totalActivities:0,activeProjects:0,meetingRate:0,sqlCount:0,avgActivitiesPerProspect:0}),[D,L]=B.useState(null),[M,F]=B.useState(""),[O,P]=B.useState(""),[G,ae]=B.useState(""),[re,ke]=B.useState({isOpen:!1,project:null});B.useEffect(()=>{xe(),je()},[n,M,O,G]);const xe=async()=>{try{m(!0);const oe={};n&&(oe.search=n),O&&(oe.status=O);const he=await Vt.get("/projects",{params:oe});if(he.data.success){const ye=he.data.data,Te=Array.isArray(ye)?ye:[];let fe=[...Te];G==="active"?fe=fe.filter(te=>te.status==="active"):G==="draft"?fe=fe.filter(te=>te.status==="draft"):G==="completed"&&(fe=fe.filter(te=>te.status==="completed")),s(fe);const _e=Te.reduce((te,me)=>te+(me.totalProspects||0),0),We=Te.filter(te=>te.status==="active").length;S({total:Te.length,totalProspects:_e,totalActivities:0,activeProjects:We,meetingRate:0,sqlCount:0,avgActivitiesPerProspect:0})}}catch(oe){console.error("Error fetching projects:",oe),w("Couldn't load your projects right now. Give it another try in a moment.")}finally{m(!1)}},je=async()=>{try{const oe=await Vt.get("/projects/analytics");if(oe.data.success){const he=oe.data.data;L(he),S(ye=>({...ye,totalProspects:he.overview.totalProspects||ye.totalProspects,totalActivities:he.overview.totalActivities||0,activeProjects:he.overview.activeProjects||ye.activeProjects,meetingRate:he.pipeline?.conversion?.meetingRate||0,sqlCount:he.pipeline?.conversion?.sql||0,avgActivitiesPerProspect:he.overview.totalProspects>0?parseFloat((he.overview.totalActivities/he.overview.totalProspects).toFixed(1)):0}))}}catch(oe){console.error("Error fetching analytics:",oe)}},Z=()=>{l("/projects/new")},ce=oe=>{l(`/projects/${oe}/edit`)},ue=async(oe,he,ye)=>{oe.stopPropagation();const Te=ye==="active",fe=Te?"draft":"active";try{(await Vt.patch(`/projects/${he}/status`,{isActive:!Te})).data.success&&s(We=>We.map(te=>te._id===he?{...te,status:fe}:te))}catch(_e){console.error("Error toggling project status:",_e),alert("Something went wrong updating the project. Try again in a moment.")}},Re=oe=>oe?new Date(oe).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",be=oe=>{if(!oe)return 0;const{interested:he=0,cip:ye=0,detailsShared:Te=0,demoBooked:fe=0,demoCompleted:_e=0,meetingProposed:We=0,meetingScheduled:te=0,meetingCompleted:me=0,sql:W=0,won:pe=0}=oe;return he+ye+Te+fe+_e+We+te+me+W+pe};return t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Project Management"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Manage your outbound campaigns and track what's working"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{onClick:()=>l("/projects/dashboard"),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-colors font-medium text-sm shadow-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Analytics Dashboard"]}),t.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Project"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Portfolio Size"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.total}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Projects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Prospects"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.totalProspects.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Prospects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full shadow-xs",children:"Activities"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.totalActivities.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Activities"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Projects"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N.activeProjects}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Active Projects"})]})]}),t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 mb-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",placeholder:"Search by name, company, email...",value:n,onChange:oe=>a(oe.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),t.jsx("div",{className:"w-64",children:t.jsxs("select",{value:"",onChange:oe=>{oe.target.value&&l(`/projects/${oe.target.value}`)},className:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:[t.jsx("option",{value:"",children:"Select a project..."}),o.map(oe=>t.jsxs("option",{value:oe._id,children:[oe.companyName," - ",oe.contactPerson?.fullName||"N/A"]},oe._id))]})})]})}),v&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:v}),e?t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-12",children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):o.length>0?t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-fixed",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"16%"},children:"Company"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"11%"},children:"Created Date"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"11%"},children:"Assigned To"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"16%"},children:"Contact Person"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"10%"},children:"Total Prospects"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"10%"},children:"Leads Generated"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"10%"},children:"Active"}),t.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"14%"},children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(oe=>t.jsxs("tr",{onClick:()=>l(`/projects/${oe._id}`),className:"hover:bg-gray-50 transition-colors cursor-pointer",children:[t.jsxs("td",{className:"px-3 py-4",children:[t.jsx("div",{className:"text-sm font-semibold text-gray-900 truncate",children:oe.companyName||"N/A"}),oe.industry&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:oe.industry})]}),t.jsx("td",{className:"px-3 py-4",children:t.jsx("div",{className:"text-sm text-gray-900",children:Re(oe.createdAt)})}),t.jsx("td",{className:"px-3 py-4 text-sm text-gray-900 truncate",children:oe.assignedTo||"-"}),t.jsxs("td",{className:"px-3 py-4",children:[t.jsx("div",{className:"text-sm text-gray-900 truncate",children:oe.contactPerson?.fullName||"N/A"}),oe.contactPerson?.email&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:oe.contactPerson.email})]}),t.jsx("td",{className:"px-3 py-4",children:t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:oe.totalProspects||0})}),t.jsx("td",{className:"px-3 py-4",children:t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:oe.leadsByStatus?be(oe.leadsByStatus):oe.leadsGenerated||0})}),t.jsx("td",{className:"px-3 py-4",onClick:he=>he.stopPropagation(),children:t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:oe.status==="active",onChange:he=>ue(he,oe._id,oe.status),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})}),t.jsx("td",{className:"px-3 py-4",onClick:he=>he.stopPropagation(),children:t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsxs("button",{onClick:he=>{he.stopPropagation(),ke({isOpen:!0,project:oe})},className:"inline-flex items-center gap-1 px-2 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 hover:border-blue-300 transition-colors",title:"View Project Details",children:[t.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]}),t.jsxs("button",{onClick:he=>{he.stopPropagation(),ce(oe._id)},className:"inline-flex items-center gap-1 px-2 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-colors",title:"Edit Project",children:[t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]})]})})]},oe._id))})]})})}):t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-12",children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No projects yet"}),t.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Create your first project to get started"}),t.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Project"]})]})}),re.isOpen&&re.project&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between z-10",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Project Details"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:re.project.companyName})]}),t.jsx("button",{onClick:()=>ke({isOpen:!1,project:null}),className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Company Details"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Name"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.companyName||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Website"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.website?t.jsx("a",{href:re.project.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:re.project.website}):"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"City"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.city||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Country"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.country||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Industry"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.industry||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Size"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.companySize||"N/A"})]}),re.project.companyDescription&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Description"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1 whitespace-pre-wrap",children:re.project.companyDescription})]})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Contact Person"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Full Name"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.contactPerson?.fullName||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Designation"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.contactPerson?.designation||"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Email"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.contactPerson?.email?t.jsx("a",{href:`mailto:${re.project.contactPerson.email}`,className:"text-blue-600 hover:underline",children:re.project.contactPerson.email}):"N/A"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Phone Number"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.contactPerson?.phoneNumber?t.jsx("a",{href:`tel:${re.project.contactPerson.phoneNumber}`,className:"text-blue-600 hover:underline",children:re.project.contactPerson.phoneNumber}):"N/A"})]}),re.project.contactPerson?.linkedInProfileUrl&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"LinkedIn Profile"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:t.jsx("a",{href:re.project.contactPerson.linkedInProfileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:re.project.contactPerson.linkedInProfileUrl})})]})]})]}),re.project.campaignDetails&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),"Campaign Details"]}),t.jsxs("div",{className:"space-y-4",children:[re.project.campaignDetails.servicesOffered&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Services Offered"}),t.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[re.project.campaignDetails.servicesOffered.leadGeneration&&t.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:"Lead Generation"}),re.project.campaignDetails.servicesOffered.marketResearch&&t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:"Market Research"}),re.project.campaignDetails.servicesOffered.appointmentSetting&&t.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full",children:"Appointment Setting"}),re.project.campaignDetails.servicesOffered.dataEnrichment&&t.jsx("span",{className:"px-3 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded-full",children:"Data Enrichment"}),!re.project.campaignDetails.servicesOffered.leadGeneration&&!re.project.campaignDetails.servicesOffered.marketResearch&&!re.project.campaignDetails.servicesOffered.appointmentSetting&&!re.project.campaignDetails.servicesOffered.dataEnrichment&&t.jsx("span",{className:"text-sm text-gray-500",children:"None selected"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[re.project.campaignDetails.leadQuotaCommitted>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Lead Quota Committed"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.campaignDetails.leadQuotaCommitted})]}),re.project.campaignDetails.startDate&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Start Date"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Re(re.project.campaignDetails.startDate)})]}),re.project.campaignDetails.endDate&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"End Date"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Re(re.project.campaignDetails.endDate)})]})]}),re.project.campaignDetails.expectationsFromUs&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Expectations From Us"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1 whitespace-pre-wrap",children:re.project.campaignDetails.expectationsFromUs})]})]})]}),re.project.channels&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})}),"Channels"]}),t.jsxs("div",{className:"flex flex-wrap gap-3",children:[re.project.channels.linkedInOutreach&&t.jsxs("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 text-sm font-medium rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),"LinkedIn Outreach"]}),re.project.channels.coldEmail&&t.jsxs("span",{className:"px-4 py-2 bg-purple-100 text-purple-800 text-sm font-medium rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Cold Email"]}),re.project.channels.coldCalling&&t.jsxs("span",{className:"px-4 py-2 bg-green-100 text-green-800 text-sm font-medium rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Cold Calling"]}),!re.project.channels.linkedInOutreach&&!re.project.channels.coldEmail&&!re.project.channels.coldCalling&&t.jsx("span",{className:"text-sm text-gray-500",children:"No channels selected"})]})]}),re.project.icpDefinition&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"ICP Definition"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[re.project.icpDefinition.targetIndustries&&re.project.icpDefinition.targetIndustries.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Target Industries"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(re.project.icpDefinition.targetIndustries)?re.project.icpDefinition.targetIndustries.join(", "):re.project.icpDefinition.targetIndustries})]}),re.project.icpDefinition.targetJobTitles&&re.project.icpDefinition.targetJobTitles.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Target Job Titles"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(re.project.icpDefinition.targetJobTitles)?re.project.icpDefinition.targetJobTitles.join(", "):re.project.icpDefinition.targetJobTitles})]}),(re.project.icpDefinition.companySizeMin>0||re.project.icpDefinition.companySizeMax<1e3)&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Company Size Range"}),t.jsxs("p",{className:"text-sm text-gray-900 mt-1",children:[re.project.icpDefinition.companySizeMin," - ",re.project.icpDefinition.companySizeMax," employees"]})]}),re.project.icpDefinition.geographies&&re.project.icpDefinition.geographies.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Geographies"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(re.project.icpDefinition.geographies)?re.project.icpDefinition.geographies.join(", "):re.project.icpDefinition.geographies})]}),re.project.icpDefinition.keywords&&re.project.icpDefinition.keywords.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Keywords"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(re.project.icpDefinition.keywords)?re.project.icpDefinition.keywords.join(", "):re.project.icpDefinition.keywords})]}),re.project.icpDefinition.exclusionCriteria&&re.project.icpDefinition.exclusionCriteria.length>0&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Exclusion Criteria"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:Array.isArray(re.project.icpDefinition.exclusionCriteria)?re.project.icpDefinition.exclusionCriteria.join(", "):re.project.icpDefinition.exclusionCriteria})]})]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-5",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),"Team Allocation"]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Assigned To"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:re.project.assignedTo||"N/A"})]})]})]}),t.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4 flex items-center justify-end gap-3",children:[t.jsx("button",{onClick:()=>ke({isOpen:!1,project:null}),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"}),t.jsx("button",{onClick:()=>{ke({isOpen:!1,project:null}),ce(re.project._id)},className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Edit Project"})]})]})})]})}const sp=[{id:1,label:"Company Details"},{id:2,label:"Contact Person"},{id:3,label:"Campaign Details"},{id:4,label:"Channels"},{id:5,label:"ICP Definition"},{id:6,label:"Team Allocation"}];function Sb(){const l=Tr(),{id:n}=ai(),a=!!n,[o,s]=B.useState(1),[e,m]=B.useState(!1),[v,w]=B.useState(a),[N,S]=B.useState(null),[D,L]=B.useState({companyName:"",website:"",city:"",country:"",industry:"",companySize:"",companyDescription:"",contactPerson:{fullName:"",designation:"",email:"",phoneNumber:"",linkedInProfileUrl:""},campaignDetails:{servicesOffered:{leadGeneration:!1,marketResearch:!1,appointmentSetting:!1,dataEnrichment:!1},expectationsFromUs:"",leadQuotaCommitted:0,startDate:"",endDate:""},channels:{linkedInOutreach:!1,coldEmail:!1,coldCalling:!1},icpDefinition:{targetIndustries:"",targetJobTitles:"",companySizeMin:0,companySizeMax:1e3,geographies:"",keywords:"",exclusionCriteria:""},assignedTo:"",teamMembers:[]}),M=(Z,ce)=>{if(Z.includes(".")){const[ue,Re]=Z.split(".");L(be=>({...be,[ue]:{...be[ue],[Re]:ce}}))}else L(ue=>({...ue,[Z]:ce}))},F=(Z,ce,ue)=>{L(Re=>({...Re,[Z]:{...Re[Z],[ce]:ue}}))},O=(Z,ce)=>{L(ue=>({...ue,campaignDetails:{...ue.campaignDetails,servicesOffered:{...ue.campaignDetails.servicesOffered,[Z]:ce}}}))};B.useEffect(()=>{(async()=>{if(a)try{w(!0);const ce=await Vt.get(`/projects/${n}`);if(ce.data.success){const ue=ce.data.data,Re=oe=>oe?new Date(oe).toISOString().split("T")[0]:"",be=oe=>Array.isArray(oe)?oe.join(", "):"";L({companyName:ue.companyName||"",website:ue.website||"",city:ue.city||"",country:ue.country||"",industry:ue.industry||"",companySize:ue.companySize||"",companyDescription:ue.companyDescription||"",contactPerson:{fullName:ue.contactPerson?.fullName||"",designation:ue.contactPerson?.designation||"",email:ue.contactPerson?.email||"",phoneNumber:ue.contactPerson?.phoneNumber||"",linkedInProfileUrl:ue.contactPerson?.linkedInProfileUrl||""},campaignDetails:{servicesOffered:{leadGeneration:ue.campaignDetails?.servicesOffered?.leadGeneration||!1,marketResearch:ue.campaignDetails?.servicesOffered?.marketResearch||!1,appointmentSetting:ue.campaignDetails?.servicesOffered?.appointmentSetting||!1,dataEnrichment:ue.campaignDetails?.servicesOffered?.dataEnrichment||!1},expectationsFromUs:ue.campaignDetails?.expectationsFromUs||"",leadQuotaCommitted:ue.campaignDetails?.leadQuotaCommitted||0,startDate:Re(ue.campaignDetails?.startDate),endDate:Re(ue.campaignDetails?.endDate)},channels:{linkedInOutreach:ue.channels?.linkedInOutreach||!1,coldEmail:ue.channels?.coldEmail||!1,coldCalling:ue.channels?.coldCalling||!1},icpDefinition:{targetIndustries:be(ue.icpDefinition?.targetIndustries),targetJobTitles:be(ue.icpDefinition?.targetJobTitles),companySizeMin:ue.icpDefinition?.companySizeMin||0,companySizeMax:ue.icpDefinition?.companySizeMax||1e3,geographies:be(ue.icpDefinition?.geographies),keywords:be(ue.icpDefinition?.keywords),exclusionCriteria:be(ue.icpDefinition?.exclusionCriteria)},assignedTo:ue.assignedTo||"",teamMembers:Array.isArray(ue.teamMembers)&&ue.teamMembers.length>0?ue.teamMembers:[]})}}catch(ce){console.error("Error fetching project:",ce),S(ce.response?.data?.error||"Couldn't load the project details. Try refreshing the page.")}finally{w(!1)}})()},[n,a]);const P=Z=>{switch(Z){case 1:return D.companyName.trim()?!0:(S("Company Name is required"),!1);case 2:return D.contactPerson.fullName.trim()?!0:(S("Full Name is required"),!1);default:return!0}},G=()=>{P(o)&&(S(null),o<sp.length&&s(o+1))},ae=()=>{o>1&&(s(o-1),S(null))},re=Z=>{Z!==o&&(Z>o&&!P(o)||(S(null),s(Z)))},ke=()=>{window.confirm("Are you sure you want to cancel? All unsaved data will be lost.")&&l("/projects")},xe=async()=>{if(P(o)){m(!0),S(null);try{const Z=Re=>!Re||typeof Re!="string"?[]:Re.split(",").map(be=>be.trim()).filter(Boolean),ce={...D,icpDefinition:{...D.icpDefinition,targetIndustries:Z(D.icpDefinition.targetIndustries),targetJobTitles:Z(D.icpDefinition.targetJobTitles),geographies:Z(D.icpDefinition.geographies),keywords:Z(D.icpDefinition.keywords),exclusionCriteria:Z(D.icpDefinition.exclusionCriteria),companySizeMin:Number(D.icpDefinition.companySizeMin)||0,companySizeMax:Number(D.icpDefinition.companySizeMax)||0},campaignDetails:{...D.campaignDetails,leadQuotaCommitted:Number(D.campaignDetails.leadQuotaCommitted)||0},teamMembers:Array.isArray(D.teamMembers)?D.teamMembers.map(Re=>(Re||"").trim()).filter(Boolean):[]};let ue;a?ue=await Vt.put(`/projects/${n}`,ce):ue=await Vt.post("/projects",ce),ue.data.success?l("/projects"):S(ue.data.error||`Couldn't ${a?"update":"create"} the project. Something went wrong.`)}catch(Z){console.error(`Error ${a?"updating":"creating"} project:`,Z),S(Z.response?.data?.error||Z.message||`Something went wrong trying to ${a?"update":"create"} the project. Try again.`)}finally{m(!1)}}},je=()=>{switch(o){case 1:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Company Details"}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Company Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:D.companyName,onChange:Z=>M("companyName",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter company name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),t.jsx("input",{type:"url",value:D.website,onChange:Z=>M("website",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),t.jsx("input",{type:"text",value:D.city,onChange:Z=>M("city",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter city"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),t.jsx("input",{type:"text",value:D.country,onChange:Z=>M("country",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter country"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Industry"}),t.jsx("input",{type:"text",value:D.industry,onChange:Z=>M("industry",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter industry"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Size"}),t.jsxs("select",{value:D.companySize,onChange:Z=>M("companySize",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"",children:"Select size"}),t.jsx("option",{value:"1-10",children:"1-10"}),t.jsx("option",{value:"11-50",children:"11-50"}),t.jsx("option",{value:"51-200",children:"51-200"}),t.jsx("option",{value:"201-500",children:"201-500"}),t.jsx("option",{value:"501-1000",children:"501-1000"}),t.jsx("option",{value:"1000+",children:"1000+"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Description"}),t.jsx("textarea",{value:D.companyDescription,onChange:Z=>M("companyDescription",Z.target.value),rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y",placeholder:"Enter company description"})]})]});case 2:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Contact Person"}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Full Name ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:D.contactPerson.fullName,onChange:Z=>F("contactPerson","fullName",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter full name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Designation"}),t.jsx("input",{type:"text",value:D.contactPerson.designation,onChange:Z=>F("contactPerson","designation",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter designation"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),t.jsx("input",{type:"email",value:D.contactPerson.email,onChange:Z=>F("contactPerson","email",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@example.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),t.jsx("input",{type:"tel",value:D.contactPerson.phoneNumber,onChange:Z=>F("contactPerson","phoneNumber",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+1 234 567 8900"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"LinkedIn Profile URL"}),t.jsx("input",{type:"url",value:D.contactPerson.linkedInProfileUrl,onChange:Z=>F("contactPerson","linkedInProfileUrl",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://linkedin.com/in/username"})]})]});case 3:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Campaign Details"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Services Offered"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.leadGeneration,onChange:Z=>O("leadGeneration",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Lead Generation"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.marketResearch,onChange:Z=>O("marketResearch",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Market Research"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.appointmentSetting,onChange:Z=>O("appointmentSetting",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Appointment Setting"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.campaignDetails.servicesOffered.dataEnrichment,onChange:Z=>O("dataEnrichment",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Data Enrichment"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expectations from Us"}),t.jsx("textarea",{value:D.campaignDetails.expectationsFromUs,onChange:Z=>F("campaignDetails","expectationsFromUs",Z.target.value),rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-y",placeholder:"Enter expectations"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lead Quota Committed"}),t.jsx("input",{type:"number",value:D.campaignDetails.leadQuotaCommitted,onChange:Z=>F("campaignDetails","leadQuotaCommitted",parseInt(Z.target.value)||0),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0",min:"0"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",value:D.campaignDetails.startDate,onChange:Z=>F("campaignDetails","startDate",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"date",value:D.campaignDetails.endDate,onChange:Z=>F("campaignDetails","endDate",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})]})]})]})]});case 4:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Channels"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Channel Selection"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.channels.linkedInOutreach,onChange:Z=>F("channels","linkedInOutreach",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"LinkedIn Outreach"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.channels.coldEmail,onChange:Z=>F("channels","coldEmail",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Cold Email"})]}),t.jsxs("label",{className:"flex items-center gap-3 p-4 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:D.channels.coldCalling,onChange:Z=>F("channels","coldCalling",Z.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Cold Calling"})]})]})]})]});case 5:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"ICP Definition"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Industries (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.targetIndustries,onChange:Z=>F("icpDefinition","targetIndustries",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Technology, Healthcare, Finance"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Job Titles (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.targetJobTitles,onChange:Z=>F("icpDefinition","targetJobTitles",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., CEO, CTO, VP Sales"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Size Min"}),t.jsx("input",{type:"number",value:D.icpDefinition.companySizeMin,onChange:Z=>F("icpDefinition","companySizeMin",parseInt(Z.target.value)||0),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0",min:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Size Max"}),t.jsx("input",{type:"number",value:D.icpDefinition.companySizeMax,onChange:Z=>F("icpDefinition","companySizeMax",parseInt(Z.target.value)||1e3),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"1000",min:"0"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Geographies (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.geographies,onChange:Z=>F("icpDefinition","geographies",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., USA, UK, Canada"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Keywords (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.keywords,onChange:Z=>F("icpDefinition","keywords",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., SaaS, Cloud, AI"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exclusion Criteria (comma-separated)"}),t.jsx("input",{type:"text",value:D.icpDefinition.exclusionCriteria,onChange:Z=>F("icpDefinition","exclusionCriteria",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Government, Non-profit"})]})]});case 6:return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Team Allocation"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assigned To"}),t.jsx("input",{type:"text",value:D.assignedTo,onChange:Z=>M("assignedTo",Z.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter assigned person name"}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Enter the name of the person assigned to manage this project"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Team Members"}),t.jsx("button",{type:"button",onClick:()=>{const Z=[...D.teamMembers,""];M("teamMembers",Z)},className:"px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:"+ Add Member"})]}),t.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Add team member email addresses to grant them access to this project"}),D.teamMembers.length===0?t.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"No team members added yet"}),t.jsx("button",{type:"button",onClick:()=>M("teamMembers",[""]),className:"mt-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Add first team member"})]}):t.jsx("div",{className:"space-y-3",children:D.teamMembers.map((Z,ce)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"email",value:Z,onChange:ue=>{const Re=[...D.teamMembers];Re[ce]=ue.target.value.trim(),M("teamMembers",Re)},className:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"team.member@example.com"}),t.jsx("button",{type:"button",onClick:()=>{const ue=D.teamMembers.filter((Re,be)=>be!==ce);M("teamMembers",ue)},className:"px-3 py-2.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove team member",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},ce))})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsxs("p",{className:"text-sm text-blue-800",children:[t.jsx("strong",{children:"Note:"})," Team members will be able to access this project, view all activities, create/edit entries, and their activities will appear in Team Performance."]})})]});default:return null}};return v?t.jsx("div",{className:"p-6 max-w-4xl mx-auto",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):t.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:a?"Edit Project":"Create New Project"}),t.jsx("div",{className:"mb-8",children:t.jsx("div",{className:"flex items-center justify-between",children:sp.map((Z,ce)=>{const ue=Z.id<o,Re=Z.id===o,be=Z.id>o;return t.jsxs("div",{className:"flex items-center flex-1",children:[t.jsxs("button",{type:"button",onClick:()=>re(Z.id),className:"flex flex-col items-center flex-1 focus:outline-none",children:[t.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-all ${ue||Re?"bg-blue-600 text-white":"bg-gray-200 text-gray-500"}`,children:ue?t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):Z.id}),t.jsx("span",{className:`mt-2 text-xs font-medium ${Re?"text-blue-600":be?"text-gray-400":"text-gray-600"}`,children:Z.label})]}),ce<sp.length-1&&t.jsx("div",{className:`flex-1 h-0.5 mx-2 ${ue?"bg-blue-600":"bg-gray-200"}`})]},Z.id)})})}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-8 mb-6",children:[N&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:N}),je()]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:ke,className:"text-gray-600 hover:text-gray-900 font-medium",children:"Cancel"}),t.jsxs("div",{className:"flex items-center gap-3",children:[o>1&&t.jsxs("button",{onClick:ae,className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-gray-700 font-medium",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]}),o<sp.length?t.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:["Next",t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}):t.jsx("button",{onClick:xe,disabled:e,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:e?a?"Updating...":"Creating...":a?"Update Project":"Create Project & Map ICP"})]})]})]})}function Qk({isOpen:l,onClose:n,projectId:a,onImportSuccess:o}){const[s,e]=B.useState(null),[m,v]=B.useState(""),[w,N]=B.useState("New"),[S,D]=B.useState(!1),[L,M]=B.useState(!1),[F,O]=B.useState(""),[P,G]=B.useState(""),ae=B.useRef(null),re=["New","Contacted","Qualified","Proposal","Negotiation"],ke=be=>{if(be){const oe=be.name.toLowerCase(),he=[".csv",".xlsx",".xls"],ye=["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/excel","application/x-excel","application/x-msexcel"],Te=he.some(_e=>oe.endsWith(_e)),fe=ye.includes(be.type);if(!Te&&!fe){O("Please upload a CSV, XLSX, or XLS file only");return}e(be),O("")}},xe=be=>{be.preventDefault(),D(!0)},je=be=>{be.preventDefault(),D(!1)},Z=be=>{be.preventDefault(),D(!1);const oe=be.dataTransfer.files[0];ke(oe)},ce=be=>{const oe=be.target.files[0];ke(oe)},ue=async()=>{if(!s){O("Please select a file (CSV, XLSX, or XLS)");return}if(!a){O("Project ID is missing");return}M(!0),O(""),G("");try{const be=new FormData;be.append("file",s),be.append("projectId",a),m&&be.append("assignTo",m),be.append("defaultStage",w);const oe=await Vt.post("/projects/bulk-import",be,{headers:{"Content-Type":"multipart/form-data"}});oe.data.success&&(G(`Successfully imported ${oe.data.data.imported} prospects. ${oe.data.data.skipped>0?`${oe.data.data.skipped} duplicates skipped.`:""}`),setTimeout(()=>{o?.(),Re()},2e3))}catch(be){console.error("Import error:",be),O(be.response?.data?.error||"Couldn't import those prospects. Double-check your file format and give it another shot.")}finally{M(!1)}},Re=()=>{e(null),v(""),N("New"),O(""),G(""),D(!1),ae.current&&(ae.current.value=""),n()};return l?t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 animate-fade-in",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto animate-fade-in",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Bulk Import Prospects"}),t.jsx("button",{onClick:Re,className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Upload a CSV, XLSX, or XLS file with the following columns:"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[t.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 list-disc list-inside",children:[t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Name"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Email"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Person Linkedin Url"})," (required)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Title"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"First Phone"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Employees"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Category"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Industry"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Keywords"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Website"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Linkedin Url"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Facebook Url"})," (optional)"]})]}),t.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 list-disc list-inside",children:[t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Twitter Url"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"City"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"State"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Country"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Address"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company City"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company State"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Country"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Company Phone"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"SEO Description"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Technologies"})," (optional)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:"Annual Revenue"})," (optional)"]})]})]})]})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Upload File"}),t.jsxs("div",{onDragOver:xe,onDragLeave:je,onDrop:Z,onClick:()=>ae.current?.click(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${S?"border-blue-500 bg-blue-50":s?"border-green-500 bg-green-50":"border-gray-300 bg-gray-50 hover:border-gray-400"}`,children:[t.jsx("input",{ref:ae,type:"file",accept:".csv,.xlsx,.xls,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/csv",onChange:ce,className:"hidden"}),t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Click to upload or drag and drop"}),t.jsx("p",{className:"text-xs text-gray-500",children:"CSV, XLSX, or XLS files only (max 10MB)"})]}),s&&t.jsx("p",{className:"text-sm text-green-600 font-medium mt-2",children:s.name})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Assign To"}),t.jsx("input",{type:"text",value:m,onChange:be=>v(be.target.value),placeholder:"Enter person name or leave empty for auto-assign",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm bg-white"}),t.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Enter team member name or leave empty to let system auto-assign"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Default Stage"}),t.jsx("select",{value:w,onChange:be=>N(be.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm bg-white",children:re.map(be=>t.jsx("option",{value:be,children:be},be))}),t.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Initial pipeline stage for imported prospects"})]}),t.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("svg",{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"text-sm font-semibold text-yellow-900 mb-2",children:"Quick heads up"}),t.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"We'll skip any duplicate emails automatically"}),t.jsx("li",{children:"Invalid email formats get flagged so you can fix them"}),t.jsx("li",{children:"Large files might take a minute or two to process"})]})]})]})}),F&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-red-700",children:F})}),P&&t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-green-700",children:P})})]}),t.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200",children:[t.jsx("button",{onClick:Re,disabled:L,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{onClick:ue,disabled:L||!s,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:L?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import Prospects"]})})]})]})}):null}function Xk({isOpen:l,onClose:n,type:a,selectedContacts:o,projectId:s,contacts:e}){const[m,v]=B.useState({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),[w,N]=B.useState({}),[S,D]=B.useState(!1),[L,M]=B.useState(!1),[F,O]=B.useState({current:0,total:0,success:0,failed:0}),[P,G]=B.useState({phone:!1,email:!1,linkedin:!1}),[ae,re]=B.useState(!1),[ke,xe]=B.useState([]),[je,Z]=B.useState(""),[ce,ue]=B.useState(!1);B.useEffect(()=>{const V=localStorage.getItem("linkedInAccounts");if(V)try{xe(JSON.parse(V))}catch(H){console.error("Error parsing LinkedIn accounts:",H),xe([])}else xe([])},[]),B.useEffect(()=>{if(l){setTimeout(()=>M(!0),10),O({current:0,total:o.size,success:0,failed:0});const V=new Date().toISOString().split("T")[0];v(H=>({...H,callDate:a==="call"?V:"",emailDate:a==="email"?V:"",linkedinDate:a==="linkedin"?V:""}))}else M(!1),v({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),N({}),re(!1),ue(!1),Z("")},[l,o.size]);const Re=()=>{if(je.trim()&&!ke.includes(je.trim())){const V=[...ke,je.trim()];xe(V),localStorage.setItem("linkedInAccounts",JSON.stringify(V)),v(H=>({...H,linkedInAccountName:je.trim()})),Z(""),ue(!1)}};if(!l)return null;const be=()=>{const V="w-5 h-5";switch(a){case"call":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${V} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${V} text-white`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:`${V} text-white`,fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},oe=()=>{switch(a){case"call":return"Bulk Log Call Activity";case"email":return"Bulk Log Email Activity";case"linkedin":return"Bulk Log LinkedIn Activity";default:return"Bulk Log Activity"}},he=()=>{switch(a){case"call":return"from-green-50 to-emerald-50";case"email":return"from-blue-50 to-cyan-50";case"linkedin":return"from-blue-50 to-indigo-50";default:return"from-gray-50 to-gray-100"}},ye=(V,H)=>{v(Q=>({...Q,[V]:H})),w[V]&&N(Q=>({...Q,[V]:""}))},Te=()=>{const V={};if(m.nextAction&&!m.nextActionDate&&(V.nextActionDate="Next action date is required when next action is specified"),m.nextActionDate){const H=new Date(m.nextActionDate),Q=new Date,se=new Date(Q);se.setDate(se.getDate()+7),H>se&&(V.nextActionDate="Next action must be scheduled within 7 days")}return N(V),Object.keys(V).length===0},fe=async V=>{if(V.preventDefault(),!Te())return;D(!0);const H=Array.from(o),Q=e.filter(we=>H.includes((we._id||we.name).toString()));O({current:0,total:Q.length,success:0,failed:0});let se=0,de=0;try{for(let we=0;we<Q.length;we++){const Ce=Q[we];let ne=null;Ce._id&&(ne=Ce._id.toString?Ce._id.toString():Ce._id,typeof ne=="string"&&ne.length!==24&&(ne=null)),O(ve=>({...ve,current:we+1}));try{const ve=m.email||Ce.email,Ge=m.phoneNumber||Ce.firstPhone,vt=m.linkedInUrl||Ce.personLinkedinUrl||Ce.companyLinkedinUrl,ze=m.conversationNotes.trim()||"",jt={projectId:s,type:a,template:m.template,outcome:null,conversationNotes:ze,nextAction:m.nextAction,nextActionDate:m.nextActionDate,phoneNumber:Ge||null,email:ve||null,linkedInUrl:vt||null,status:m.status||null,linkedInAccountName:m.linkedInAccountName||null,lnRequestSent:m.lnRequestSent||null,connected:m.connected||null,callNumber:m.callNumber||null,callStatus:m.callStatus||null,callDate:m.callDate||null,emailDate:m.emailDate||null,linkedinDate:m.linkedinDate||null};if(ne&&(jt.contactId=ne),(await Vt.post("/activities",jt)).data.success&&m.status&&ne&&s)try{await Vt.put(`/projects/${s}/project-contacts/${ne}`,{stage:m.status})}catch(Kt){console.error("Error updating contact status:",Kt)}se++,O(Kt=>({...Kt,success:se}))}catch(ve){console.error(`Error saving activity for ${Ce.name}:`,ve),de++,O(Ge=>({...Ge,failed:de}))}}v({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),setTimeout(()=>{n()},1e3)}catch(we){console.error("Error in bulk activity logging:",we),N({submit:"Some activities didn't save properly. Check what went wrong and try again."})}finally{D(!1)}},_e=()=>{S||(v({template:"",outcome:"",conversationNotes:"",nextAction:"",nextActionDate:"",phoneNumber:"",email:"",linkedInUrl:"",status:"",linkedInAccountName:"",lnRequestSent:"",connected:"",callNumber:"",callStatus:"",callDate:"",emailDate:"",linkedinDate:""}),N({}),G({phone:!1,email:!1,linkedin:!1}),n())},We=async(V,H,Q)=>{const se=Array.from(o),de=e.filter(ne=>{const ve=ne._id?.toString();return se.includes((ne._id||ne.name).toString())&&ve&&typeof ve=="string"&&ve.length===24});if(de.length===0){N({submit:"No valid contacts selected to save."});return}G(ne=>({...ne,[V]:!0}));let we=0,Ce=0;try{for(const ne of de)try{const ve=ne._id.toString();await Vt.put(`/contacts/${ve}`,{[Q]:H||""}),we++}catch(ve){console.error(`Error saving ${V} for ${ne.name}:`,ve),Ce++}we>0&&(N({}),V==="phone"?v(ne=>({...ne,phoneNumber:H||""})):V==="email"?v(ne=>({...ne,email:H||""})):V==="linkedin"&&v(ne=>({...ne,linkedInUrl:H||""}))),Ce>0&&N({submit:`Saved ${V} for ${we} contact(s), but ${Ce} failed.`})}catch(ne){console.error(`Error saving ${V}:`,ne),N({submit:`Couldn't save ${V}. Try again in a moment.`})}finally{G(ne=>({...ne,[V]:!1}))}},te=e.filter(V=>o.has((V._id||V.name).toString())),me=te.some(V=>V.firstPhone),W=te.some(V=>V.email),pe=te.some(V=>V.personLinkedinUrl||V.companyLinkedinUrl),Le=()=>te.map(V=>V.personLinkedinUrl||V.companyLinkedinUrl).filter(V=>V&&V.trim()!==""),Ae=()=>{const V=Le();if(V.length>0){const H=V.join(`
`);navigator.clipboard.writeText(H).then(()=>{const Q=document.getElementById("copy-linkedin-urls-btn");if(Q){const se=Q.textContent;Q.textContent="Copied!",Q.classList.add("bg-green-600"),setTimeout(()=>{Q.textContent=se,Q.classList.remove("bg-green-600")},2e3)}}).catch(Q=>{console.error("Failed to copy URLs:",Q)})}};return t.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${L?"opacity-100":"opacity-0"}`,onClick:_e,children:t.jsxs("div",{className:`bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col transform transition-all duration-300 ${L?"scale-100 translate-y-0":"scale-95 translate-y-4"}`,onClick:V=>V.stopPropagation(),children:[t.jsx("div",{className:`bg-gradient-to-r ${he()} border-b border-gray-200 p-4 flex-shrink-0`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[ae&&t.jsx("button",{onClick:()=>re(!1),className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-600 hover:text-gray-900 hover:bg-white/50 transition-all duration-200 group",title:"Back to form",children:t.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("div",{className:"animate-pulse-once",children:be()}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-0.5",children:ae&&a==="linkedin"?"LinkedIn Message Variations":ae&&a==="email"?"Email Variations":oe()}),!ae&&t.jsxs("p",{className:"text-xs text-gray-600 font-medium",children:[te.length," ",te.length===1?"contact":"contacts"," selected"]})]})]}),t.jsx("button",{onClick:_e,disabled:S,className:"w-8 h-8 flex items-center justify-center rounded-lg text-gray-400 hover:text-gray-600 hover:bg-white/50 transition-all duration-200 group disabled:opacity-50",children:t.jsx("svg",{className:"w-5 h-5 group-hover:rotate-90 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),S&&t.jsxs("div",{className:"px-4 py-3 bg-blue-50 border-b border-blue-100",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("span",{className:"text-sm font-semibold text-blue-900",children:["Processing ",F.current," of ",F.total," contacts..."]}),t.jsxs("span",{className:"text-sm font-semibold text-blue-700",children:[F.success," success, ",F.failed," failed"]})]}),t.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${F.current/F.total*100}%`}})})]}),t.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200 max-h-32 overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("p",{className:"text-xs font-semibold text-gray-700",children:a==="linkedin"?"Selected LinkedIn URLs:":"Selected Contacts:"}),a==="linkedin"&&Le().length>0&&t.jsxs("button",{id:"copy-linkedin-urls-btn",type:"button",onClick:Ae,className:"px-2 py-1 text-xs font-semibold text-blue-600 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition-colors flex items-center gap-1",title:"Copy all LinkedIn URLs",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy All URLs"]})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:a==="linkedin"?t.jsxs(t.Fragment,{children:[te.slice(0,10).map(V=>{const H=V.personLinkedinUrl||V.companyLinkedinUrl;return H?t.jsx("span",{className:"px-2 py-1 bg-white text-xs font-medium text-blue-700 rounded-md border border-blue-200 hover:bg-blue-50 transition-colors break-all",title:H,children:H.length>50?`${H.substring(0,50)}...`:H},V._id||V.name):null}),te.length>10&&t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-xs font-semibold text-blue-700 rounded-md",children:["+",te.length-10," more"]})]}):t.jsxs(t.Fragment,{children:[te.slice(0,10).map(V=>t.jsx("span",{className:"px-2 py-1 bg-white text-xs font-medium text-gray-700 rounded-md border border-gray-200",children:V.name||"N/A"},V._id||V.name)),te.length>10&&t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-xs font-semibold text-blue-700 rounded-md",children:["+",te.length-10," more"]})]})})]}),ae&&a==="linkedin"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Existing"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm usually in touch with teams managing residential projects and leasing, so I was just curious how you manage bookings, rentals, and property maintenance across your units."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I mostly connect with people working in residential and leasing rolesit keeps me close to how things really move on a day-to-day basis."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"The world today feels like one connected marketplace, and being part of the real estate ecosystem, I enjoy connecting with people who are building and managing things on the ground. Looking forward to connecting and exchanging perspectives."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I've noticed that no two property teams manage bookings, rentals, and maintenance the same way. I'm always interested in hearing how others handle it in practice."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Always open to exchanging thoughts and learning how things are shaping up on your side. Would be great to stay connected."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We work closely with property teams to simplify how day-to-day operations are managed  from rentals and billing to maintenance  so things feel more connected and easier to handle."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Everyday operational conversations around properties quietly offer the most value in understanding how things really work."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"Enjoy grounded conversations around real work and real challenges. Happy to stay connected and exchange insights whenever it makes sense."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"We believe real value often comes from reducing small operational frictions and giving teams better visibility into what's happening across their properties."})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Message"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I'm always interested in seeing how teams optimize their workflowsdo you have any strategies that make managing bookings and maintenance simpler?"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"I value thoughtful conversations with people close to the work. Whenever it feels right, I'd enjoy exchanging insights as things evolve on your side."}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:"No worries if you didn't catch my earlier message. Just checking if you're up for a chat about possible ways we can team up and grow together."})]})]})]})})})}):ae&&a==="email"?t.jsx("div",{className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-yellow-100",children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300 w-[15%]",children:"Email"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 1"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 2"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 3"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-900 border border-gray-300",children:"Variation 4"})]})}),t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"1st Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I work closely with people involved in residential projects and leasing, and I enjoy staying connected with those who are close to the day-to-day side of property work."}),t.jsx("p",{children:"At Terabits, we focus on making everyday property operations a little easier by keeping rentals, billing, and maintenance in one place."}),t.jsx("p",{children:"Happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working close to residential projects and leasing. I've found those conversations tend to be the most honest and practical."}),t.jsx("p",{children:"I'm part of the Terabits team, where we focus on making everyday property operations easier to manage."}),t.jsx("p",{children:"Nice to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"font-semibold",children:"Subject: Exchanging notes on leasing & residential work"}),t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I usually stay in touch with people working on residential projects and leasing. I've found these conversations to be the most practical."}),t.jsx("p",{children:'When it comes to daily management, where do you usually find the most friction or "extra work" in your current process?'})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I tend to reach out to people in residential leasing because the conversations are usually more practical."}),t.jsx("p",{children:`I'm curiouswhen it comes to your daily management, where do things usually get stuck or feel like a "headache" for your team?`}),t.jsx("p",{children:"Nice to connect,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"2nd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just wanted to follow up on my last note."}),t.jsx("p",{children:"We usually speak with property teams who want a bit more clarity in their daily workflows without changing how they already operate."}),t.jsx("p",{children:"Always good to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Just sharing a short follow-up."}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing without adding extra complexity to daily work."}),t.jsx("p",{children:"Happy to stay in touch."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"Most of our discussions with property teams revolve around simplifying rentals, maintenance, and billing."}),t.jsx("p",{children:"This is where Terabits usually steps inwe focus on making those everyday operations feel less like a chore so you can focus on the bigger picture."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"That's usually where we come in. At Terabits, we focus on making those messy partslike rentals, maintenance, and billingfeel a lot more manageable."}),t.jsx("p",{children:"We try to keep the tech simple so it actually helps the team instead of adding more work to their day."}),t.jsx("p",{children:"Happy to stay in touch,"})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"3rd Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing we often notice is that small improvements in visibility can make day-to-day property work feel much more manageable."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that even small clarity in systems can make a big difference in day-to-day property operations."}),t.jsx("p",{children:"Thought I'd share that with you."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I often hear is that small clarity in systems makes a big difference."}),t.jsx("p",{children:"Specifically, we help by automating the repetitive stufflike tracking maintenance requests or streamlining billing workflowswithout adding extra complexity to your day-to-day work."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"One thing I've noticed is that just adding a bit of clarity to maintenance tracking or billing can save a lot of hours."}),t.jsx("p",{children:"We mostly help by automating those repetitive tasks so they just happen in the background. It's a small change that usually makes the day-to-day much smoother."}),t.jsx("p",{children:"Thought I'd share that."})]})})]}),t.jsxs("tr",{children:[t.jsx("td",{className:"px-4 py-3 text-xs font-semibold text-gray-900 bg-yellow-50 border border-gray-300 align-top",children:"4th Email"}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here for now."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Wishing you a great week ahead."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I won't take more of your time."}),t.jsx("p",{children:"If at any point it feels useful to exchange notes around property operations or workflows, I'm always happy to connect."}),t.jsx("p",{children:"Take care."})]})}),t.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 border border-gray-300 align-top",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{children:["Hi ",{Name},","]}),t.jsx("p",{children:"I'll leave it here as I don't want to crowd your inbox."}),t.jsx("p",{children:"If you ever want to swap notes on how to make property workflows easier, I'm always happy to chat."}),t.jsx("p",{children:"Wishing you the best,"})]})})]})]})]})})})}):t.jsx("form",{onSubmit:fe,className:"p-4 bg-gray-50 overflow-y-auto flex-1",children:t.jsxs("div",{className:"space-y-4",children:[a!=="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-700",children:"Select Template (Optional)"}),(a==="linkedin"||a==="email")&&t.jsxs("button",{type:"button",onClick:()=>re(!0),disabled:S,className:"px-3 py-1.5 text-xs font-semibold text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-all duration-200 flex items-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a==="email"?"View Email Variations":"View Message Variations"]})]}),t.jsxs("select",{value:m.template,onChange:V=>ye("template",V.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"no-template",children:"No Template"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"introduction-email",children:"Introduction Email"}),t.jsx("option",{value:"follow-up-email",children:"Follow-up Email"}),t.jsx("option",{value:"value-proposition-email",children:"Value Proposition Email"})]}):a==="linkedin"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"connection-request-message",children:"Connection Request Message"}),t.jsx("option",{value:"introduction-message",children:"Introduction Message"}),t.jsx("option",{value:"follow-up-message",children:"Follow-up Message"})]}):null]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Account Used ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsxs("select",{value:m.linkedInAccountName,onChange:V=>ye("linkedInAccountName",V.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select LinkedIn account"}),ke.map((V,H)=>t.jsx("option",{value:V,children:V},H))]})]}),t.jsx("button",{type:"button",onClick:()=>ue(!ce),disabled:S,className:"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed",children:ce?"Cancel":"+ Add"})]}),ce&&t.jsxs("div",{className:"mt-3 flex gap-2",children:[t.jsx("input",{type:"text",value:je,onChange:V=>Z(V.target.value),onKeyPress:V=>{V.key==="Enter"&&(V.preventDefault(),Re())},disabled:S,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Enter new LinkedIn account name"}),t.jsx("button",{type:"button",onClick:Re,disabled:!je.trim()||ke.includes(je.trim())||S,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Add"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select or add a LinkedIn account that sent the connection request"]})]}),a==="linkedin"&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Ln Request Sent ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.lnRequestSent,onChange:V=>ye("lnRequestSent",V.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"}),t.jsx("option",{value:"Existing Connect",children:"Existing Connect"}),t.jsx("option",{value:"Inactive Profile",children:"Inactive Profile"}),t.jsx("option",{value:"Irrelevant Profile",children:"Irrelevant Profile"}),t.jsx("option",{value:"Open to Work",children:"Open to Work"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Status of the LinkedIn connection request"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Connected ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.connected,onChange:V=>ye("connected",V.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"Yes",children:"Yes"}),t.jsx("option",{value:"No",children:"No"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Whether the connection was established"]})]})]}),(a==="email"||a==="linkedin")&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.status,onChange:V=>ye("status",V.target.value),disabled:S,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed ${w.status?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select status"}),a==="email"?t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Out of Office",children:"Out of Office"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Wrong Person",children:"Wrong Person"}),t.jsx("option",{value:"Bounce",children:"Bounce"}),t.jsx("option",{value:"Opt-Out",children:"Opt-Out"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"})]}):t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"CIP",children:"CIP"}),t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"In-Person Meeting",children:"In-Person Meeting"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"}),t.jsx("option",{value:"SQL",children:"SQL"}),t.jsx("option",{value:"Tech Discussion",children:"Tech Discussion"}),t.jsx("option",{value:"WON",children:"WON"}),t.jsx("option",{value:"Lost",children:"Lost"}),t.jsx("option",{value:"Low Potential - Open",children:"Low Potential - Open"}),t.jsx("option",{value:"Potential Future",children:"Potential Future"})]})]}),w.status&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1 animate-shake",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.status]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a==="email"?"Update the contact status based on this email interaction":"Update the contact status based on this interaction"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Call ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsx("div",{children:t.jsxs("select",{value:m.callNumber,onChange:V=>ye("callNumber",V.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select call number"}),t.jsx("option",{value:"1st call",children:"1st call"}),t.jsx("option",{value:"2nd call",children:"2nd call"}),t.jsx("option",{value:"3rd call",children:"3rd call"}),t.jsx("option",{value:"4th call",children:"4th call"}),t.jsx("option",{value:"5th call",children:"5th call"}),t.jsx("option",{value:"6th call",children:"6th call"}),t.jsx("option",{value:"7th call",children:"7th call"}),t.jsx("option",{value:"8th call",children:"8th call"}),t.jsx("option",{value:"9th call",children:"9th call"}),t.jsx("option",{value:"10th call",children:"10th call"})]})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:m.callDate,onChange:V=>ye("callDate",V.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Select call date"})]})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select which call attempt this is and the date when the call was made"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Status ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.callStatus,onChange:V=>ye("callStatus",V.target.value),disabled:S,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:"Select status"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Ring",children:"Ring"}),t.jsx("option",{value:"Busy",children:"Busy"}),t.jsx("option",{value:"Call Back",children:"Call Back"}),t.jsx("option",{value:"Hang Up",children:"Hang Up"}),t.jsx("option",{value:"Switch Off",children:"Switch Off"}),t.jsx("option",{value:"Future",children:"Future"}),t.jsx("option",{value:"Details Shared",children:"Details Shared"}),t.jsx("option",{value:"Demo Booked",children:"Demo Booked"}),t.jsx("option",{value:"Invalid",children:"Invalid"}),t.jsx("option",{value:"Existing",children:"Existing"}),t.jsx("option",{value:"Demo Completed",children:"Demo Completed"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the status of this call"]})]}),a==="call"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Phone Number ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("input",{type:"tel",value:m.phoneNumber,onChange:V=>ye("phoneNumber",V.target.value),disabled:S||P.phone,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Add phone number (e.g., +1 234-567-8900)"})]}),t.jsx("button",{type:"button",onClick:()=>We("phone",m.phoneNumber,"firstPhone"),disabled:S||P.phone,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database for all selected contacts",children:P.phone?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:me?"Some selected contacts have phone numbers in database. Enter a value to override or leave empty to use existing data.":"This will be applied to all selected contacts. Click Save to store in database for all contacts with valid IDs."})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Address ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("input",{type:"email",value:m.email,onChange:V=>ye("email",V.target.value),disabled:S||P.email,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Add email address (e.g., contact@example.com)"})]}),t.jsx("button",{type:"button",onClick:()=>We("email",m.email,"email"),disabled:S||P.email,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database for all selected contacts",children:P.email?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:W?"Some selected contacts have emails in database. Enter a value to override or leave empty to use existing data.":"This will be applied to all selected contacts. Click Save to store in database for all contacts with valid IDs."})]}),a==="email"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Email Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:m.emailDate,onChange:V=>ye("emailDate",V.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Select email date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the email was sent"]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Profile URL ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("input",{type:"url",value:m.linkedInUrl,onChange:V=>ye("linkedInUrl",V.target.value),disabled:S||P.linkedin,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Add LinkedIn profile URL (e.g., https://linkedin.com/in/username)"})]}),t.jsx("button",{type:"button",onClick:()=>We("linkedin",m.linkedInUrl,"personLinkedinUrl"),disabled:S||P.linkedin,className:"px-3 py-2 text-xs font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Save to database for all selected contacts",children:P.linkedin?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save"]})})]}),t.jsx("p",{className:"mt-2 text-xs text-gray-500",children:pe?`Using LinkedIn URLs from ${Le().length} selected contact(s). Enter a value to override or leave empty to use existing URLs.`:"This will be applied to all selected contacts. Click Save to store in database for all contacts with valid IDs."}),a==="linkedin"&&Le().length>0&&t.jsxs("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded-md",children:[t.jsxs("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:["LinkedIn URLs from selected contacts (",Le().length,"):"]}),t.jsxs("div",{className:"max-h-20 overflow-y-auto space-y-1",children:[Le().slice(0,5).map((V,H)=>t.jsx("p",{className:"text-xs text-blue-700 break-all font-mono",children:V},H)),Le().length>5&&t.jsxs("p",{className:"text-xs text-blue-600 font-semibold",children:["+",Le().length-5," more URLs"]})]})]})]}),a==="linkedin"&&t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["LinkedIn Date ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("input",{type:"date",value:m.linkedinDate,onChange:V=>ye("linkedinDate",V.target.value),disabled:S,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Select LinkedIn date"})]}),t.jsxs("p",{className:"mt-2 text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Select the date when the LinkedIn activity occurred"]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Conversation Notes ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(optional, but helpful)"})]}),t.jsx("textarea",{value:m.conversationNotes,onChange:V=>ye("conversationNotes",V.target.value),disabled:S,rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 resize-y font-sans hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Jot down what happened, any concerns they raised, or what to follow up on. This applies to all selected contacts..."})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action ",t.jsx("span",{className:"text-gray-400 text-xs font-normal",children:"(Optional)"})]}),t.jsxs("select",{value:m.nextAction,onChange:V=>ye("nextAction",V.target.value),disabled:S,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed ${w.nextAction?"border-red-300 bg-red-50":"border-gray-300"}`,children:[t.jsx("option",{value:"",children:"Select an option"}),t.jsx("option",{value:"follow-up-call",children:"Follow-up Call"}),t.jsx("option",{value:"send-proposal",children:"Send Proposal"}),t.jsx("option",{value:"schedule-meeting",children:"Schedule Meeting"}),t.jsx("option",{value:"send-email",children:"Send Email"}),t.jsx("option",{value:"connect-linkedin",children:"Connect on LinkedIn"})]}),w.nextAction&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.nextAction]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:["Next Action Date ",t.jsx("span",{className:m.nextAction?"text-red-500":"text-gray-400 text-xs font-normal",children:m.nextAction?"*":"(Optional)"})]}),t.jsx("div",{className:"relative",children:t.jsx("input",{type:"date",value:m.nextActionDate,onChange:V=>ye("nextActionDate",V.target.value),disabled:S,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white hover:border-gray-400 disabled:opacity-50 disabled:cursor-not-allowed ${w.nextActionDate?"border-red-300 bg-red-50":"border-gray-300"}`})}),w.nextActionDate&&t.jsxs("p",{className:"mt-2 text-xs text-red-600 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),w.nextActionDate]})]})]}),w.submit&&t.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-3 animate-shake",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-xs font-medium text-red-700",children:w.submit})]})}),t.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-200",children:[t.jsx("button",{type:"button",onClick:_e,disabled:S,className:"px-4 py-2 text-xs font-semibold text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:S,className:"px-4 py-2 text-xs font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:hover:scale-100",children:S?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Log Activity for ",te.length," ",te.length===1?"Contact":"Contacts"]})})]})]})})]})})}const On=l=>l.type==="call"&&l.callDate?new Date(l.callDate):l.type==="email"&&l.emailDate?new Date(l.emailDate):l.type==="linkedin"&&l.linkedinDate?new Date(l.linkedinDate):new Date(l.createdAt),rp=(...l)=>{},Jk=l=>{if(!l._id)return null;try{const n=l._id.toString?l._id.toString():String(l._id);if(n.length>=8){const a=parseInt(n.substring(0,8),16)*1e3;return new Date(a)}}catch(n){console.error("Error extracting import date from contact ID:",n)}return l.createdAt?new Date(l.createdAt):null},Eo={};function Zk(){const{id:l}=ai(),n=Tr(),[a,o]=l0(),[s,e]=B.useState(null),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState(null),[L,M]=B.useState(a.get("search")||""),[F,O]=B.useState(""),P=B.useRef(null),G=B.useRef(!1),[ae,re]=B.useState(a.get("quickFilter")||""),[ke,xe]=B.useState(a.get("filterStatus")||""),[je,Z]=B.useState(a.get("filterActionDate")||""),[ce,ue]=B.useState(a.get("filterActionDateFrom")||""),[Re,be]=B.useState(a.get("filterActionDateTo")||""),[oe,he]=B.useState(a.get("filterLastInteraction")||""),[ye,Te]=B.useState(a.get("filterLastInteractionFrom")||""),[fe,_e]=B.useState(a.get("filterLastInteractionTo")||""),[We,te]=B.useState(a.get("filterImportDate")||""),[me,W]=B.useState(a.get("filterImportDateFrom")||""),[pe,Le]=B.useState(a.get("filterImportDateTo")||""),[Ae,V]=B.useState(a.get("filterNoActivity")==="true"),[H,Q]=B.useState(a.get("filterMatchType")||""),[se,de]=B.useState(null),[we,Ce]=B.useState("linkedin"),[ne,ve]=B.useState({isOpen:!1,filter:null}),[Ge,vt]=B.useState(null),[ze,jt]=B.useState(new Set),[rt,Kt]=B.useState({}),[Lt,ks]=B.useState({}),[_s,ms]=B.useState({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,lastActivity:null}),[ws,Ie]=B.useState(!1),[st,Dt]=B.useState([]),[xs,Pa]=B.useState(new Set),[dr,Io]=B.useState(!1),[Qc,zn]=B.useState({isOpen:!1,type:null}),[Ga,Kr]=B.useState({}),[Or,Bo]=B.useState({}),[ll,zo]=B.useState(!1),[ol,Ci]=B.useState(!1),[Ta,Si]=B.useState(new Set),[Tt,cl]=B.useState(null),[Uo,wr]=B.useState(!1),[Ai,ni]=B.useState(null),[Ei,dl]=B.useState("asc"),[Sr,ii]=B.useState(!1),Yl=B.useRef(null),Qr=B.useMemo(()=>{if(!s?.channels)return["call","email","linkedin"];const K=[];return s.channels.coldCalling&&K.push("call"),s.channels.coldEmail&&K.push("email"),s.channels.linkedInOutreach&&K.push("linkedin"),K.length>0?K:["call","email","linkedin"]},[s?.channels]),wn=B.useMemo(()=>{if(!st||st.length===0)return{linkedin:{today:0,tomorrow:0,missed:0},email:{today:0,tomorrow:0,missed:0}};const K=new Date,Ve=new Date(K);Ve.setHours(0,0,0,0);const nt=new Date(Ve);nt.setDate(nt.getDate()+1);const Ue=new Date(nt);Ue.setDate(Ue.getDate()+1);const it=new Set,Be=new Set,Ke=new Set,Ze=new Set,Fe=new Set,At=new Set;return st.forEach(Rt=>{if(!Rt.nextActionDate||!Rt.contactId)return;const It=new Date(Rt.nextActionDate);It.setHours(0,0,0,0);const gt=Rt.contactId.toString?Rt.contactId.toString():Rt.contactId;Rt.type==="linkedin"?It>=Ve&&It<nt?it.add(gt):It>=nt&&It<Ue?Be.add(gt):It<Ve&&Ke.add(gt):Rt.type==="email"&&(It>=Ve&&It<nt?Ze.add(gt):It>=nt&&It<Ue?Fe.add(gt):It<Ve&&At.add(gt))}),{linkedin:{today:it.size,tomorrow:Be.size,missed:Ke.size},email:{today:Ze.size,tomorrow:Fe.size,missed:At.size}}},[st]);B.useEffect(()=>{Qr.length>0&&!Qr.includes(we)&&Ce(Qr[0])},[Qr,we]),B.useEffect(()=>{const K=Ve=>{Yl.current&&!Yl.current.contains(Ve.target)&&ii(!1)};return Sr&&document.addEventListener("mousedown",K),()=>{document.removeEventListener("mousedown",K)}},[Sr]),B.useEffect(()=>{const K=a.get("search")||"";K&&O(K)},[]),B.useEffect(()=>(P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{O(L)},300),()=>{P.current&&clearTimeout(P.current)}),[L]),B.useEffect(()=>{if(l){M(""),re(""),xe(""),Z(""),ue(""),be(""),he(""),Te(""),_e(""),te(""),W(""),Le(""),V(!1),Q("");const K=a.get("returnTo"),Ve=a.get("page"),nt=new URLSearchParams;K&&nt.set("returnTo",K),Ve&&nt.set("page",Ve),o(nt,{replace:!0});const Ue=Eo[l];Ue&&(Ue.project&&e(Ue.project),Ue.kpiMetrics&&cl(Ue.kpiMetrics),Ue.contacts&&v(Ue.contacts),Ue.allProjectActivities&&Dt(Ue.allProjectActivities),N(!1)),Gl().then(()=>{const it=a.get("page"),Be=it?parseInt(it,10):1;Be!==Xs&&Cs(Be),Promise.all([us().catch(Ke=>{console.error("Error fetching activities:",Ke)}),Xr(Be).catch(Ke=>{console.error("Error fetching imported contacts:",Ke)}),jn().catch(Ke=>{console.error("Error fetching KPI metrics:",Ke)})])})}},[l]),B.useEffect(()=>{if(!l)return;if(!G.current){G.current=!0;return}Cs(1);const K=new URLSearchParams(a);K.delete("page"),o(K,{replace:!0}),Xr(1)},[F,l]),B.useEffect(()=>{if(!l)return;const K=a.get("page"),Ve=K?parseInt(K,10):1;if(Ve!==Xs&&Ve>=1&&!F){const nt=setTimeout(()=>{Ve!==Xs&&(Cs(Ve),Xr(Ve))},50);return()=>clearTimeout(nt)}},[a.get("page"),l,a]);const Gl=async()=>{try{N(!0);const K=await Vt.get(`/projects/${l}`);if(K.data.success){const Ve=K.data.data;e(Ve),Eo[l]={...Eo[l]||{},project:Ve}}}catch(K){console.error("Error fetching project:",K),D("Having trouble loading the project. Refresh the page and try again.")}finally{N(!1)}},jn=async()=>{try{wr(!0);const K=await Vt.get(`/projects/${l}/kpi-metrics`);if(K.data.success){const Ve=K.data.data;cl(Ve),Eo[l]={...Eo[l]||{},kpiMetrics:Ve}}}catch(K){console.error("Error fetching KPI metrics:",K)}finally{wr(!1)}},[Xs,Cs]=B.useState(()=>{const K=a.get("page");return K?parseInt(K,10):1}),[_a,sr]=B.useState(0),[ar,nn]=B.useState(1),Ho=50,Xr=async(K=1)=>{try{N(!0);const Ve=F?1e4:Ho,nt=F?`&search=${encodeURIComponent(F)}`:"",Ue=await Vt.get(`/projects/${l}/project-contacts?page=${K}&limit=${Ve}${nt}`);if(Ue.data.success){const it=Ue.data.data||[],Be=Ue.data.pagination||{};sr(Be.total||it.length),nn(Be.totalPages||1),Cs(K);const Ke=new Map;it.forEach(Fe=>{const At=Fe._id?.toString?Fe._id.toString():String(Fe._id);if(!At)return;const Rt=Ke.get(At);if(!Rt)Ke.set(At,Fe);else{const It=Rt.projectContactId!==null&&Rt.projectContactId!==void 0;Fe.projectContactId!==null&&Fe.projectContactId!==void 0&&!It&&Ke.set(At,Fe)}});let Ze=Array.from(Ke.values());Ta.size>0&&(Ze=Ze.filter(Fe=>{if(!Fe._id)return!0;const At=Fe._id.toString?Fe._id.toString():String(Fe._id);return!Ta.has(At)})),v(Ze),K===1&&!F&&(Eo[l]={...Eo[l]||{},contacts:Ze})}}catch(Ve){console.error("Error fetching imported contacts:",Ve)}finally{N(!1)}},li=B.useCallback(K=>{if(K>=1&&K!==Xs){const Ve=new URLSearchParams(a);K===1?Ve.delete("page"):Ve.set("page",K.toString()),o(Ve,{replace:!0}),Xr(K)}},[Xs,l,a,o]),Nn=async()=>{try{const K=await Vt.get(`/projects/${l}/similar-contacts`);if(K.data.success){let Ve=K.data.data||[];if(Ta.size>0){const nt=Ve.length;Ve=Ve.filter(Ue=>{if(!Ue._id)return!0;const it=Ue._id.toString?Ue._id.toString():String(Ue._id);return!Ta.has(it)}),nt!==Ve.length&&rp(`Filtered out ${nt-Ve.length} previously deleted contact(s) from similar contacts`)}return v(Ve),K.data.matchStats&&vt(K.data.matchStats),K.data.hasICP===!1?(Io(!1),dr&&alert(K.data.message||"No ICP defined for this project. Please add an ICP definition to get suggestions."),!1):!0}}catch(K){return console.error("Error fetching similar contacts:",K),!1}},Di=s?.icpDefinition?.companySizeMin!==void 0&&s?.icpDefinition?.companySizeMax!==void 0&&!(s.icpDefinition.companySizeMin===0&&s.icpDefinition.companySizeMax===1e3),ul=s?.icpDefinition?.targetIndustries&&Array.isArray(s.icpDefinition.targetIndustries)&&s.icpDefinition.targetIndustries.length>0,ca=s?.icpDefinition?.targetJobTitles&&Array.isArray(s.icpDefinition.targetJobTitles)&&s.icpDefinition.targetJobTitles.length>0,Vr=s?.icpDefinition?.geographies&&Array.isArray(s.icpDefinition.geographies)&&s.icpDefinition.geographies.length>0,Pr=s?.icpDefinition?.keywords&&Array.isArray(s.icpDefinition.keywords)&&s.icpDefinition.keywords.length>0,Ar=ul||ca||Vr||Pr||Di;B.useEffect(()=>{const K=new URLSearchParams;L&&K.set("search",L),ae&&K.set("quickFilter",ae),ke&&K.set("filterStatus",ke),je&&K.set("filterActionDate",je),ce&&K.set("filterActionDateFrom",ce),Re&&K.set("filterActionDateTo",Re),oe&&K.set("filterLastInteraction",oe),ye&&K.set("filterLastInteractionFrom",ye),fe&&K.set("filterLastInteractionTo",fe),We&&K.set("filterImportDate",We),me&&K.set("filterImportDateFrom",me),pe&&K.set("filterImportDateTo",pe),Ae&&K.set("filterNoActivity","true"),H&&K.set("filterMatchType",H),o(K,{replace:!0})},[L,ae,ke,je,ce,Re,oe,ye,fe,We,me,pe,Ae,H,o]),B.useEffect(()=>{dr&&!Ar&&(Io(!1),Xr().catch(K=>{console.error("Error fetching imported contacts:",K)}))},[Ar,dr]);const oi=async()=>{if(!Ar){alert("No ICP (Ideal Customer Profile) is defined for this project. Please add an ICP definition in project settings to get suggestions.");return}const K=!dr;Io(K),K?(!await Nn()||!Ar)&&(Io(!1),Ar||alert("No ICP (Ideal Customer Profile) is defined for this project. Please add an ICP definition in project settings to get suggestions.")):await Xr()},us=async()=>{try{const K=await Vt.get(`/activities/project/${l}?limit=5000`);if(K.data.success){const Ve=K.data.data||[];Dt(Ve),Eo[l]={...Eo[l]||{},allProjectActivities:Ve},jn()}}catch(K){console.error("Error fetching project activities:",K)}},Ir=B.useMemo(()=>{const K={byContactId:new Map,lastActivityByContactId:new Map,nextActionByContactId:new Map,latestActivityStatusByContactId:new Map},Ve=new Date;return st.forEach(nt=>{if(nt.contactId){const Ue=nt.contactId.toString();K.byContactId.has(Ue)||K.byContactId.set(Ue,[]),K.byContactId.get(Ue).push(nt);const it=K.lastActivityByContactId.get(Ue),Be=On(nt);if(!it)K.lastActivityByContactId.set(Ue,nt);else{const Ze=On(it);Be>Ze&&K.lastActivityByContactId.set(Ue,nt)}if(nt.nextActionDate&&new Date(nt.nextActionDate)>=Ve){const Ze=K.nextActionByContactId.get(Ue);(!Ze||new Date(nt.nextActionDate)<new Date(Ze.nextActionDate))&&K.nextActionByContactId.set(Ue,nt)}let Ke=null;if(nt.type==="call"&&nt.callStatus&&nt.callStatus.trim()!==""?Ke=nt.callStatus:nt.status&&nt.status.trim()!==""&&(Ke=nt.status),Ke){const Ze=K.latestActivityStatusByContactId.get(Ue),Fe=On(nt);if(!Ze)K.latestActivityStatusByContactId.set(Ue,{status:Ke,createdAt:Fe,activityDate:Fe});else{const At=Ze.activityDate?new Date(Ze.activityDate):new Date(Ze.createdAt);Fe>At&&K.latestActivityStatusByContactId.set(Ue,{status:Ke,createdAt:Fe,activityDate:Fe})}}}}),K},[st]),hl=B.useCallback(async(K,Ve,nt)=>{if(Lt[K])return;const Ue=K?.toString?K.toString():K;if(Ue)try{ks(Ke=>({...Ke,[K]:!0}));const Be=(Ir.byContactId.get(Ue)||[]).filter(Ke=>Ke.projectId&&Ke.projectId.toString()===l);if(Be.length>0){Kt(Ke=>({...Ke,[K]:Be.sort((Ze,Fe)=>new Date(Fe.createdAt)-new Date(Ze.createdAt))})),ks(Ke=>({...Ke,[K]:!1}));return}try{const Ke=await Vt.get(`/activities/contact/${Ue}?projectId=${l}`);if(Ke.data.success){const Ze=Ke.data.data||[];Kt(Fe=>({...Fe,[K]:Ze.sort((At,Rt)=>new Date(Rt.createdAt)-new Date(At.createdAt))}))}}catch(Ke){console.warn(`API call failed for contact ${Ue}, using cached activities:`,Ke.message);const Ze=st.filter(Fe=>{if((Fe.projectId?.toString?Fe.projectId.toString():Fe.projectId)!==l)return!1;if(Fe.contactId&&(Fe.contactId.toString?Fe.contactId.toString():Fe.contactId)===Ue)return!0;if(Ve||nt){const Rt=Ve?.toLowerCase()||"",It=nt?.toLowerCase()||"",gt=Fe.conversationNotes?.toLowerCase()||"";return gt.includes(Rt)||gt.includes(It)}return!1});Kt(Fe=>({...Fe,[K]:Ze.sort((At,Rt)=>new Date(Rt.createdAt)-new Date(At.createdAt))}))}}catch(it){console.error("Error fetching activities:",it)}finally{ks(it=>({...it,[K]:!1}))}},[Lt,Ir,st]),fl=B.useCallback(async(K,Ve,nt)=>{ze.has(K)?B.startTransition(()=>{jt(it=>{const Be=new Set(it);return Be.delete(K),Be})}):(B.startTransition(()=>{jt(it=>new Set(it).add(K))}),hl(K,Ve,nt).catch(it=>{console.error("Error fetching activities:",it)}))},[ze,hl]),jr=(K,Ve)=>{const nt=Ve._id?Ve._id.toString?Ve._id.toString():String(Ve._id):null;let Ue=null,it=K;nt&&(Ue=Ir.lastActivityByContactId.get(nt)||null,Ue&&Ue.type&&(it=Ue.type)),ms({isOpen:!0,type:it,contactName:Ve.name||"N/A",companyName:Ve.company||"",projectId:l,contactId:nt||null,phoneNumber:Ve.firstPhone||null,email:Ve.email||null,linkedInProfileUrl:Ve.personLinkedinUrl||Ve.companyLinkedinUrl||null,lastActivity:Ue||null})},Vo=async(K=!1)=>{ms({isOpen:!1,type:null,contactName:"",companyName:"",projectId:null,contactId:null,phoneNumber:null,email:null,linkedInProfileUrl:null,lastActivity:null}),await us(),await new Promise(Ve=>setTimeout(Ve,100)),dr?await Nn():await Xr(),ze.forEach(Ve=>{const nt=m.find(Ue=>(Ue._id||Ue.name)===Ve);nt&&hl(Ve,nt.email,nt.name)})},Jr=async()=>{zn({isOpen:!1,type:null}),Pa(new Set),await us(),await new Promise(K=>setTimeout(K,100)),dr?await Nn():await Xr(),ze.forEach(K=>{const Ve=m.find(nt=>(nt._id||nt.name)===K);Ve&&hl(K,Ve.email,Ve.name)})},Un=K=>K?K.split(" ").map(Ve=>Ve[0]).join("").toUpperCase().slice(0,2):"?",Ka=K=>{const nt={Ring:{bg:"bg-yellow-100",text:"text-yellow-800"},Busy:{bg:"bg-orange-100",text:"text-orange-800"},"Call Back":{bg:"bg-amber-100",text:"text-amber-800"},"Hang Up":{bg:"bg-red-100",text:"text-red-800"},"Switch Off":{bg:"bg-gray-100",text:"text-gray-800"},Invalid:{bg:"bg-red-100",text:"text-red-800"},Future:{bg:"bg-blue-100",text:"text-blue-800"},Existing:{bg:"bg-indigo-100",text:"text-indigo-800"},Interested:{bg:"bg-green-100",text:"text-green-800"},"Not Interested":{bg:"bg-red-100",text:"text-red-800"},"Details Shared":{bg:"bg-cyan-100",text:"text-cyan-800"},"Demo Booked":{bg:"bg-purple-100",text:"text-purple-800"},"Demo Completed":{bg:"bg-emerald-100",text:"text-emerald-800"},CIP:{bg:"bg-blue-100",text:"text-blue-800"},"No Reply":{bg:"bg-gray-100",text:"text-gray-800"},"Out of Office":{bg:"bg-gray-100",text:"text-gray-800"},"Meeting Proposed":{bg:"bg-yellow-100",text:"text-yellow-800"},"Meeting Scheduled":{bg:"bg-cyan-100",text:"text-cyan-800"},"In-Person Meeting":{bg:"bg-indigo-100",text:"text-indigo-800"},"Meeting Completed":{bg:"bg-green-100",text:"text-green-800"},SQL:{bg:"bg-emerald-100",text:"text-emerald-800"},"Tech Discussion":{bg:"bg-purple-100",text:"text-purple-800"},WON:{bg:"bg-green-200",text:"text-green-900",border:"border-2 border-green-400"},Lost:{bg:"bg-red-200",text:"text-red-900",border:"border-2 border-red-400"},"Low Potential - Open":{bg:"bg-orange-100",text:"text-orange-800"},"Potential Future":{bg:"bg-teal-100",text:"text-teal-800"},"Wrong Person":{bg:"bg-red-100",text:"text-red-800"},Bounce:{bg:"bg-red-100",text:"text-red-800"},"Opt-Out":{bg:"bg-red-100",text:"text-red-800"},New:{bg:"bg-blue-100",text:"text-blue-800"},Contacted:{bg:"bg-purple-100",text:"text-purple-800"},Qualified:{bg:"bg-green-100",text:"text-green-800"},Proposal:{bg:"bg-yellow-100",text:"text-yellow-800"},Negotiation:{bg:"bg-orange-100",text:"text-orange-800"}}[K]||{bg:"bg-gray-100",text:"text-gray-800"};return t.jsx("span",{className:`inline-flex items-center justify-center px-2.5 py-1 text-xs font-medium rounded-full whitespace-nowrap ${nt.bg} ${nt.text} ${nt.border||""}`,children:K})},os=K=>{if(!K)return"N/A";const Ve=K instanceof Date?K:new Date(K);return isNaN(Ve.getTime())?"N/A":Ve.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},kn=K=>{if(!K)return"N/A";const Ve=K instanceof Date?K:new Date(K);return isNaN(Ve.getTime())?"N/A":Ve.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},Wo=({contact:K,activities:Ve})=>{const nt=()=>{const Ze=Ve.filter(gt=>gt.type==="call").length,Fe=Ve.filter(gt=>gt.type==="email").length,At=Ve.filter(gt=>gt.type==="linkedin").length,Rt=Ve.length,It=Math.min(100,Math.max(0,Rt*10+(Rt>0?30:0)));return{totalInteractions:Rt,callsMade:Ze,emailsSent:Fe,linkedInMessages:At,engagementScore:It}},Ue=Ze=>{switch(Ze){case"call":return t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})});case"email":return t.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})});case"linkedin":return t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})});default:return null}},it=Ze=>{switch(Ze){case"call":return"Call";case"email":return"Email";case"linkedin":return"LinkedIn";default:return"Activity"}},Be=Ze=>({"connected-had-conversation":"Connected","left-voicemail":"Left Voicemail","no-answer":"No Answer","wrong-number":"Wrong Number","not-interested":"Not Interested","email-sent-successfully":"Sent","email-bounced":"Bounced","received-reply":"Received Reply","out-of-office-response":"Out of Office","connection-request-sent":"Connection Request Sent","message-sent":"Message Sent","connection-accepted":"Connection Accepted"})[Ze]||Ze,Ke=nt();return t.jsxs("div",{className:"py-4 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),t.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Activity Summary"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-600",children:"Calls Made"}),t.jsx("span",{className:"text-xs font-semibold text-gray-900",children:Ke.callsMade})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-600",children:"Emails Sent"}),t.jsx("span",{className:"text-xs font-semibold text-gray-900",children:Ke.emailsSent})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-600",children:"LinkedIn Messages"}),t.jsx("span",{className:"text-xs font-semibold text-gray-900",children:Ke.linkedInMessages})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Engagement Score"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-1",children:Ke.engagementScore}),t.jsx("div",{className:"text-xs text-gray-500",children:"out of 100"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Interaction Timeline"}),t.jsxs("button",{onClick:()=>jr("call",K),className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Log Activity"]})]}),Ve.length===0?t.jsx("div",{className:"text-center py-8 text-gray-500 text-sm transition-opacity duration-300",children:'No activities logged yet. Click "Log Activity" to get started.'}):t.jsx("div",{className:"space-y-4 animate-fade-in",children:Ve.sort((Ze,Fe)=>On(Fe)-On(Ze)).map((Ze,Fe)=>t.jsxs("div",{className:"flex items-start gap-4 pb-4 border-b border-gray-100 last:border-0 transition-all duration-300 hover:bg-gray-50 rounded-lg px-2 -mx-2 py-1",style:{animationDelay:`${Fe*50}ms`},children:[t.jsx("div",{className:"flex-shrink-0 mt-1",children:Ue(Ze.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"mb-2",children:t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:it(Ze.type)})}),Ze.conversationNotes&&(()=>{const Rt=Ze.conversationNotes.replace(/\[Contact:.*?\|.*?Email:.*?\|.*?Phone:.*?\|.*?LinkedIn:.*?\]/g,"").trim().replace(/\[Contact:.*?\]/g,"").trim();return Rt?t.jsx("p",{className:"text-sm text-gray-700 mb-2 whitespace-pre-wrap leading-relaxed",children:Rt}):null})(),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsx("span",{className:`px-2 py-0.5 rounded font-medium ${Ze.type==="call"?"bg-blue-100 text-blue-700":Ze.type==="email"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:Be(Ze.outcome)}),t.jsxs("span",{children:["by ",s?.assignedTo||"User"]})]})]}),t.jsx("div",{className:"flex-shrink-0 text-xs text-gray-500 text-right whitespace-nowrap",children:kn(On(Ze))})]},Ze._id))})]})]})},Hn=B.useMemo(()=>m.filter(K=>{if(ke){const Ve=(K._id?.toString?K._id.toString():K._id)||"";if(((Ve?Ir.latestActivityStatusByContactId.get(Ve):null)?.status||null||K.stage||"New")!==ke)return!1}if(je||ce||Re){K._id||K.name;const Ve=K._id?.toString?K._id.toString():K._id,nt=Ve?Ir.nextActionByContactId.get(Ve):null;if(je==="custom"&&(ce||Re)){if(!nt||!nt.nextActionDate)return!1;const Ue=new Date(nt.nextActionDate);if(Ue.setHours(0,0,0,0),ce){const it=new Date(ce);if(it.setHours(0,0,0,0),Ue<it)return!1}if(Re){const it=new Date(Re);if(it.setHours(23,59,59,999),Ue>it)return!1}}else if(je&&je!=="custom"){if(!nt||!nt.nextActionDate)return!1;const Ue=new Date(nt.nextActionDate);Ue.setHours(0,0,0,0);const it=new Date,Be=new Date(it.getFullYear(),it.getMonth(),it.getDate()),Ke=new Date(Be);switch(Ke.setDate(Ke.getDate()+1),je){case"today":if(Ue<Be||Ue>=Ke)return!1;break;case"this-week":const Ze=Be.getDay(),Fe=Ze===0?6:Ze-1,At=new Date(Be);At.setDate(Be.getDate()-Fe),At.setHours(0,0,0,0);const Rt=new Date(At);if(Rt.setDate(At.getDate()+7),Ue<At||Ue>=Rt)return!1;break;case"this-month":const It=new Date(it.getFullYear(),it.getMonth(),1),gt=new Date(it.getFullYear(),it.getMonth()+1,1);if(Ue<It||Ue>=gt)return!1;break}}}if(oe||ye||fe){const Ve=(K._id?.toString?K._id.toString():K._id)||"",nt=Ve?Ir.lastActivityByContactId.get(Ve):null;if(oe==="custom"&&(ye||fe)){if(!nt)return!1;const Ue=On(nt);if(Ue.setHours(0,0,0,0),ye){const it=new Date(ye);if(it.setHours(0,0,0,0),Ue<it)return!1}if(fe){const it=new Date(fe);if(it.setHours(23,59,59,999),Ue>it)return!1}}else if(oe&&oe!=="custom"){if(!nt)return!1;const Ue=On(nt);Ue.setHours(0,0,0,0);const it=new Date,Be=new Date(it.getFullYear(),it.getMonth(),it.getDate()),Ke=new Date(Be);switch(Ke.setDate(Ke.getDate()+1),oe){case"today":if(Ue<Be||Ue>=Ke)return!1;break;case"this-week":const Ze=Be.getDay(),Fe=Ze===0?6:Ze-1,At=new Date(Be);At.setDate(Be.getDate()-Fe),At.setHours(0,0,0,0);const Rt=new Date(At);if(Rt.setDate(At.getDate()+7),Ue<At||Ue>=Rt)return!1;break;case"this-month":const It=new Date(it.getFullYear(),it.getMonth(),1),gt=new Date(it.getFullYear(),it.getMonth()+1,1);if(Ue<It||Ue>=gt)return!1;break}}}if(We||me||pe){const Ve=Jk(K);if(!Ve)return!1;if(We==="custom"&&(me||pe)){const nt=new Date(Ve);if(nt.setHours(0,0,0,0),me){const Ue=new Date(me);if(Ue.setHours(0,0,0,0),nt<Ue)return!1}if(pe){const Ue=new Date(pe);if(Ue.setHours(23,59,59,999),nt>Ue)return!1}}else if(We&&We!=="custom"){const nt=new Date(Ve);nt.setHours(0,0,0,0);const Ue=new Date,it=new Date(Ue.getFullYear(),Ue.getMonth(),Ue.getDate()),Be=new Date(it);Be.setDate(Be.getDate()-1);const Ke=new Date(it);switch(Ke.setDate(Ke.getDate()+1),We){case"today":if(nt<it||nt>=Ke)return!1;break;case"yesterday":if(nt<Be||nt>=it)return!1;break}}}if(Ae){const Ve=(K._id?.toString?K._id.toString():K._id)||"";if((Ve?Ir.lastActivityByContactId.get(Ve):null)||st.some(it=>{if(!it.contactId)return!1;if((it.contactId.toString?it.contactId.toString():it.contactId)===Ve)return!0;if(!Ve){const Ke=K.email?.toLowerCase()||"",Ze=K.name?.toLowerCase()||"",Fe=it.conversationNotes?.toLowerCase()||"",At=it.email?.toLowerCase()||"";return Ke&&(Fe.includes(Ke)||At===Ke)||Ze&&Fe.includes(Ze)}return!1}))return!1}if(se){const Ve=(K._id?.toString?K._id.toString():K._id)||"",nt=st.filter(it=>{if((it.projectId?.toString?it.projectId.toString():it.projectId)!==l)return!1;if(Ve&&it.contactId&&(it.contactId.toString?it.contactId.toString():it.contactId)===Ve)return!0;if(!Ve||!it.contactId){const Ke=it.conversationNotes?.toLowerCase()||"",Ze=K.name?.toLowerCase()||"",Fe=K.email?.toLowerCase()||"";return Ke.includes(Ze)||Ke.includes(Fe)}return!1});let Ue=!1;if(se.channel==="linkedin"){const it=nt.filter(Be=>Be.type==="linkedin");se.metric==="connectionSent"?Ue=it.some(Be=>Be.lnRequestSent===!0||Be.lnRequestSent==="Yes"):se.metric==="accepted"?Ue=it.some(Be=>Be.connected===!0||Be.connected==="Yes"):se.metric==="followUps"?Ue=it.length>1:se.metric==="cip"?Ue=it.some(Be=>Be.status&&(Be.status==="CIP"||Be.status==="Conversations in Progress")):se.metric==="meetingProposed"?Ue=it.some(Be=>Be.status==="Meeting Proposed"):se.metric==="scheduled"?Ue=it.some(Be=>Be.status==="Meeting Scheduled"):se.metric==="completed"?Ue=it.some(Be=>Be.status==="Meeting Completed"):se.metric==="sql"?Ue=K.stage==="SQL":se.metric==="win"?Ue=K.stage==="WON":se.metric==="connectionRequestsSent"?Ue=it.some(Be=>Be.lnRequestSent===!0||Be.lnRequestSent==="Yes"):se.metric==="connectionAcceptanceRate"?Ue=it.some(Be=>Be.connected===!0||Be.connected==="Yes"):se.metric==="messagesSent"?Ue=it.some(Be=>Be.status&&Be.status!==""):se.metric==="messageReplyRate"?Ue=it.some(Be=>Be.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Be.status)):se.metric==="meetingsBooked"&&(Ue=it.some(Be=>Be.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Be.status)))}else if(se.channel==="call"){const it=nt.filter(Be=>Be.type==="call");se.metric==="allProspects"?Ue=!0:se.metric==="callsAttempted"?Ue=it.length>0:se.metric==="callsConnected"?Ue=it.some(Be=>Be.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Be.callStatus)):se.metric==="decisionMakerReached"?Ue=it.some(Be=>Be.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up","Not Interested"].includes(Be.callStatus)):se.metric==="interested"?Ue=it.some(Be=>Be.callStatus==="Interested"):se.metric==="notInterested"?Ue=it.some(Be=>Be.callStatus==="Not Interested"):se.metric==="detailsShared"?Ue=it.some(Be=>Be.callStatus==="Details Shared"):se.metric==="demoBooked"?Ue=it.some(Be=>Be.callStatus==="Demo Booked"):se.metric==="demoCompleted"?Ue=it.some(Be=>Be.callStatus==="Demo Completed"):se.metric==="sql"?Ue=K.stage==="SQL":se.metric==="won"?Ue=K.stage==="WON":se.metric==="callsMade"?Ue=it.length>0:se.metric==="callAnswerRate"?Ue=it.some(Be=>Be.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Be.callStatus)):se.metric==="callInterestedRate"?Ue=it.some(Be=>Be.callStatus&&["Interested","Details Shared","Demo Booked","Demo Completed"].includes(Be.callStatus)):se.metric==="meetingsBooked"&&(Ue=it.some(Be=>Be.callStatus&&["Demo Booked","Demo Completed"].includes(Be.callStatus)))}else if(se.channel==="email"){const it=nt.filter(Be=>Be.type==="email");se.metric==="emailsSent"?Ue=it.length>0:se.metric==="accepted"?Ue=it.some(Be=>Be.status&&Be.status!=="Bounce"&&Be.status!=="Opt-Out"&&Be.status!=="No Reply"):se.metric==="followups"?Ue=it.length>1:se.metric==="cip"?Ue=it.some(Be=>Be.status&&(Be.status==="CIP"||Be.status==="Conversations in Progress")):se.metric==="meetingProposed"?Ue=it.some(Be=>Be.status==="Meeting Proposed"):se.metric==="scheduled"?Ue=it.some(Be=>Be.status==="Meeting Scheduled"):se.metric==="completed"?Ue=it.some(Be=>Be.status==="Meeting Completed"):se.metric==="sql"?Ue=K.stage==="SQL":se.metric==="emailBounce"?Ue=it.some(Be=>Be.status==="Bounce"):se.metric==="emailOpenRate"?Ue=it.some(Be=>Be.status&&Be.status!=="Bounce"&&Be.status!=="Opt-Out"&&Be.status!=="No Reply"):se.metric==="emailReplyRate"?Ue=it.some(Be=>Be.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Be.status)):se.metric==="meetingsBooked"&&(Ue=it.some(Be=>Be.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Be.status)))}if(!Ue)return!1}if(ae==="due-today"){const Ve=new Date;Ve.setHours(0,0,0,0);const nt=new Date(Ve);nt.setDate(nt.getDate()+1);const Ue=(K._id?.toString?K._id.toString():K._id)||"";if(!(Ue?Ir.byContactId.get(Ue)||[]:[]).some(Ke=>{if(!Ke.nextActionDate)return!1;const Ze=new Date(Ke.nextActionDate);return Ze.setHours(0,0,0,0),Ze>=Ve&&Ze<nt}))return!1}else if(ae==="new-prospects"){const Ve=(K._id?.toString?K._id.toString():K._id)||"";if(((Ve?Ir.latestActivityStatusByContactId.get(Ve):null)?.status||null||K.stage||"New")!=="New")return!1}return!0}).sort((K,Ve)=>{if(Ai==="name"){const nt=(K.name||"").toLowerCase(),Ue=(Ve.name||"").toLowerCase();return Ei==="asc"?nt.localeCompare(Ue):Ue.localeCompare(nt)}return 0}),[m,F,ae,ke,je,ce,Re,oe,ye,fe,We,me,pe,Ae,H,se,st,s,Ir,l,Ai,Ei]),[Ti,ml]=B.useState([]),[ys,gl]=B.useState(!1),Xc=B.useCallback(async()=>{try{gl(!0),ml([]);const K=await Vt.get(`/projects/${l}/project-contacts?page=1&limit=10000`);if(K.data.success){const Ve=K.data.data||[],Ue=(K.data.pagination||{}).total||Ve.length;let it=[...Ve];if(Ve.length<Ue&&Ue>1e4){const Ze=Math.ceil(Ue/1e4),Fe=[];for(let At=2;At<=Ze;At++)try{const Rt=await Vt.get(`/projects/${l}/project-contacts?page=${At}&limit=10000`);Rt.data.success&&Fe.push(...Rt.data.data||[])}catch(Rt){console.error(`Error fetching page ${At} for KPI:`,Rt)}it=[...Ve,...Fe]}const Be=new Map;it.forEach(Ze=>{const Fe=Ze._id?.toString?Ze._id.toString():String(Ze._id);if(!Fe)return;const At=Be.get(Fe);if(!At)Be.set(Fe,Ze);else{const Rt=At.projectContactId!==null&&At.projectContactId!==void 0;Ze.projectContactId!==null&&Ze.projectContactId!==void 0&&!Rt&&Be.set(Fe,Ze)}});const Ke=Array.from(Be.values());ml(Ke)}}catch(K){console.error("Error fetching all contacts for KPI:",K),ml([])}finally{gl(!1)}},[l]),Ys=B.useCallback(K=>K?(Ti.length>0?Ti:m).filter(nt=>{const Ue=(nt._id?.toString?nt._id.toString():nt._id)||"",Be=(Ue?Ir.byContactId.get(Ue)||[]:[]).filter(Ze=>(Ze.projectId?.toString?Ze.projectId.toString():Ze.projectId)===l);if(Be.length===0&&(!Ue||Ue==="")){const Ze=st.filter(gt=>{if((gt.projectId?.toString?gt.projectId.toString():gt.projectId)!==l)return!1;const js=gt.conversationNotes?.toLowerCase()||"",nr=nt.name?.toLowerCase()||"",Is=nt.email?.toLowerCase()||"";return js.includes(nr)||js.includes(Is)});if(Ze.length===0)return!1;const Fe=Ze.filter(gt=>gt.type==="linkedin"),At=Ze.filter(gt=>gt.type==="call"),Rt=Ze.filter(gt=>gt.type==="email");let It=!1;if(K.channel==="linkedin")K.metric==="connectionSent"?It=Fe.some(gt=>gt.lnRequestSent===!0||gt.lnRequestSent==="Yes"):K.metric==="accepted"?It=Fe.some(gt=>gt.connected===!0||gt.connected==="Yes"):K.metric==="followUps"?It=Fe.length>1:K.metric==="cip"?It=Fe.some(gt=>gt.status&&(gt.status==="CIP"||gt.status==="Conversations in Progress")):K.metric==="meetingProposed"?It=Fe.some(gt=>gt.status==="Meeting Proposed"):K.metric==="scheduled"?It=Fe.some(gt=>gt.status==="Meeting Scheduled"):K.metric==="completed"?It=Fe.some(gt=>gt.status==="Meeting Completed"):K.metric==="sql"?It=nt.stage==="SQL":K.metric==="win"?It=nt.stage==="WON":K.metric==="connectionRequestsSent"?It=Fe.some(gt=>gt.lnRequestSent===!0||gt.lnRequestSent==="Yes"):K.metric==="connectionAcceptanceRate"?It=Fe.some(gt=>gt.connected===!0||gt.connected==="Yes"):K.metric==="messagesSent"?It=Fe.some(gt=>gt.status&&gt.status!==""):K.metric==="messageReplyRate"?It=Fe.some(gt=>gt.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(gt.status)):K.metric==="meetingsBooked"&&(It=Fe.some(gt=>gt.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(gt.status)));else if(K.channel==="call"){if(K.metric==="allProspects")It=!0;else if(K.metric==="callsAttempted")It=At.length>0;else if(K.metric==="callsConnected")It=At.some(gt=>gt.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(gt.callStatus));else if(K.metric==="decisionMakerReached")It=At.some(gt=>gt.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up","Not Interested"].includes(gt.callStatus));else if(K.metric==="interested")It=At.some(gt=>gt.callStatus==="Interested");else if(K.metric==="notInterested")It=At.some(gt=>gt.callStatus==="Not Interested");else if(K.metric==="detailsShared")It=At.some(gt=>gt.callStatus==="Details Shared");else if(K.metric==="demoBooked")It=At.some(gt=>gt.callStatus==="Demo Booked");else if(K.metric==="demoCompleted")It=At.some(gt=>gt.callStatus==="Demo Completed");else if(K.metric==="sql")It=nt.stage==="SQL";else if(K.metric==="won")It=nt.stage==="WON";else if(K.metric==="followups"||K.metric==="todayFollowups"||K.metric==="tomorrowFollowups"||K.metric==="missedFollowups"){const gt=new Date,Zt=new Date(gt);Zt.setHours(0,0,0,0);const js=new Date(Zt);js.setDate(js.getDate()+1);const nr=new Date(js);nr.setDate(nr.getDate()+1),It=At.some(Is=>{if(!Is.nextActionDate)return!1;const Hs=new Date(Is.nextActionDate);return Hs.setHours(0,0,0,0),K.metric==="followups"?!0:K.metric==="todayFollowups"?Hs>=Zt&&Hs<js:K.metric==="tomorrowFollowups"?Hs>=js&&Hs<nr:K.metric==="missedFollowups"?Hs<Zt:!1})}}else K.channel==="email"&&(K.metric==="followups"?It=Rt.some(gt=>gt.nextActionDate!=null):K.metric==="emailsSent"?It=Rt.length>0:K.metric==="accepted"?It=Rt.some(gt=>gt.status&&gt.status!=="Bounce"&&gt.status!=="Opt-Out"&&gt.status!=="No Reply"):K.metric==="cip"?It=Rt.some(gt=>gt.status&&(gt.status==="CIP"||gt.status==="Conversations in Progress")):K.metric==="meetingProposed"?It=Rt.some(gt=>gt.status==="Meeting Proposed"):K.metric==="scheduled"?It=Rt.some(gt=>gt.status==="Meeting Scheduled"):K.metric==="completed"?It=Rt.some(gt=>gt.status==="Meeting Completed"):K.metric==="sql"?It=nt.stage==="SQL":K.metric==="emailBounce"?It=Rt.some(gt=>gt.status==="Bounce"):K.metric==="emailOpenRate"?It=Rt.some(gt=>gt.status&&gt.status!=="Bounce"&&gt.status!=="Opt-Out"&&gt.status!=="No Reply"):K.metric==="emailReplyRate"?It=Rt.some(gt=>gt.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(gt.status)):K.metric==="meetingsBooked"&&(It=Rt.some(gt=>gt.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(gt.status))));return It}let Ke=!1;if(K.channel==="linkedin"){const Ze=Be.filter(Fe=>Fe.type==="linkedin");if(K.metric==="connectionSent")Ke=Ze.some(Fe=>Fe.lnRequestSent===!0||Fe.lnRequestSent==="Yes");else if(K.metric==="accepted")Ke=Ze.some(Fe=>Fe.connected===!0||Fe.connected==="Yes");else if(K.metric==="followUps")Ke=Ze.length>1;else if(K.metric==="cip")Ke=Ze.some(Fe=>Fe.status&&(Fe.status==="CIP"||Fe.status==="Conversations in Progress"));else if(K.metric==="meetingProposed")Ke=Ze.some(Fe=>Fe.status==="Meeting Proposed");else if(K.metric==="scheduled")Ke=Ze.some(Fe=>Fe.status==="Meeting Scheduled");else if(K.metric==="completed")Ke=Ze.some(Fe=>Fe.status==="Meeting Completed");else if(K.metric==="sql")Ke=nt.stage==="SQL";else if(K.metric==="win")Ke=nt.stage==="WON";else if(K.metric==="followups"||K.metric==="todayFollowups"||K.metric==="tomorrowFollowups"||K.metric==="missedFollowups"){const Fe=new Date,At=new Date(Fe);At.setHours(0,0,0,0);const Rt=new Date(At);Rt.setDate(Rt.getDate()+1);const It=new Date(Rt);It.setDate(It.getDate()+1),Ke=Ze.some(gt=>{if(!gt.nextActionDate)return!1;const Zt=new Date(gt.nextActionDate);return Zt.setHours(0,0,0,0),K.metric==="followups"?!0:K.metric==="todayFollowups"?Zt>=At&&Zt<Rt:K.metric==="tomorrowFollowups"?Zt>=Rt&&Zt<It:K.metric==="missedFollowups"?Zt<At:!1})}else K.metric==="connectionRequestsSent"?Ke=Ze.some(Fe=>Fe.lnRequestSent===!0||Fe.lnRequestSent==="Yes"):K.metric==="connectionAcceptanceRate"?Ke=Ze.some(Fe=>Fe.connected===!0||Fe.connected==="Yes"):K.metric==="messagesSent"?Ke=Ze.some(Fe=>Fe.status&&Fe.status!==""):K.metric==="messageReplyRate"?Ke=Ze.some(Fe=>Fe.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Fe.status)):K.metric==="meetingsBooked"&&(Ke=Ze.some(Fe=>Fe.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Fe.status)))}else if(K.channel==="call"){const Ze=Be.filter(Fe=>Fe.type==="call");if(K.metric==="allProspects")Ke=!0;else if(K.metric==="callsAttempted")Ke=Ze.length>0;else if(K.metric==="callsConnected")Ke=Ze.some(Fe=>Fe.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Fe.callStatus));else if(K.metric==="decisionMakerReached")Ke=Ze.some(Fe=>Fe.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up","Not Interested"].includes(Fe.callStatus));else if(K.metric==="interested")Ke=Ze.some(Fe=>Fe.callStatus==="Interested");else if(K.metric==="notInterested")Ke=Ze.some(Fe=>Fe.callStatus==="Not Interested");else if(K.metric==="detailsShared")Ke=Ze.some(Fe=>Fe.callStatus==="Details Shared");else if(K.metric==="demoBooked")Ke=Ze.some(Fe=>Fe.callStatus==="Demo Booked");else if(K.metric==="demoCompleted")Ke=Ze.some(Fe=>Fe.callStatus==="Demo Completed");else if(K.metric==="sql")Ke=nt.stage==="SQL";else if(K.metric==="won")Ke=nt.stage==="WON";else if(K.metric==="followups"||K.metric==="todayFollowups"||K.metric==="tomorrowFollowups"||K.metric==="missedFollowups"){const Fe=new Date,At=new Date(Fe);At.setHours(0,0,0,0);const Rt=new Date(At);Rt.setDate(Rt.getDate()+1);const It=new Date(Rt);It.setDate(It.getDate()+1),Ke=Ze.some(gt=>{if(!gt.nextActionDate)return!1;const Zt=new Date(gt.nextActionDate);return Zt.setHours(0,0,0,0),K.metric==="followups"?!0:K.metric==="todayFollowups"?Zt>=At&&Zt<Rt:K.metric==="tomorrowFollowups"?Zt>=Rt&&Zt<It:K.metric==="missedFollowups"?Zt<At:!1})}else K.metric==="callsMade"?Ke=Ze.length>0:K.metric==="callAnswerRate"?Ke=Ze.some(Fe=>Fe.callStatus&&!["Ring","Busy","Switch Off","Invalid","Hang Up"].includes(Fe.callStatus)):K.metric==="callInterestedRate"?Ke=Ze.some(Fe=>Fe.callStatus&&["Interested","Details Shared","Demo Booked","Demo Completed"].includes(Fe.callStatus)):K.metric==="meetingsBooked"&&(Ke=Ze.some(Fe=>Fe.callStatus&&["Demo Booked","Demo Completed"].includes(Fe.callStatus)))}else if(K.channel==="email"){const Ze=Be.filter(Fe=>Fe.type==="email");if(K.metric==="followups"||K.metric==="todayFollowups"||K.metric==="tomorrowFollowups"||K.metric==="missedFollowups"){const Fe=new Date,At=new Date(Fe);At.setHours(0,0,0,0);const Rt=new Date(At);Rt.setDate(Rt.getDate()+1);const It=new Date(Rt);It.setDate(It.getDate()+1),Ke=Ze.some(gt=>{if(!gt.nextActionDate)return!1;const Zt=new Date(gt.nextActionDate);return Zt.setHours(0,0,0,0),K.metric==="followups"?!0:K.metric==="todayFollowups"?Zt>=At&&Zt<Rt:K.metric==="tomorrowFollowups"?Zt>=Rt&&Zt<It:K.metric==="missedFollowups"?Zt<At:!1})}else K.metric==="emailsSent"?Ke=Ze.length>0:K.metric==="accepted"?Ke=Ze.some(Fe=>Fe.status&&Fe.status!=="Bounce"&&Fe.status!=="Opt-Out"&&Fe.status!=="No Reply"):K.metric==="cip"?Ke=Ze.some(Fe=>Fe.status&&(Fe.status==="CIP"||Fe.status==="Conversations in Progress")):K.metric==="meetingProposed"?Ke=Ze.some(Fe=>Fe.status==="Meeting Proposed"):K.metric==="scheduled"?Ke=Ze.some(Fe=>Fe.status==="Meeting Scheduled"):K.metric==="completed"?Ke=Ze.some(Fe=>Fe.status==="Meeting Completed"):K.metric==="sql"?Ke=nt.stage==="SQL":K.metric==="emailBounce"?Ke=Ze.some(Fe=>Fe.status==="Bounce"):K.metric==="emailOpenRate"?Ke=Ze.some(Fe=>Fe.status&&Fe.status!=="Bounce"&&Fe.status!=="Opt-Out"&&Fe.status!=="No Reply"):K.metric==="emailReplyRate"?Ke=Ze.some(Fe=>Fe.status&&["Meeting Proposed","Meeting Scheduled","Meeting Completed","SQL","Tech Discussion"].includes(Fe.status)):K.metric==="meetingsBooked"&&(Ke=Ze.some(Fe=>Fe.status&&["Meeting Scheduled","Meeting Completed","In-Person Meeting"].includes(Fe.status)))}return Ke}):[],[Ti,m,Ir,st,l]);B.useEffect(()=>{ne.isOpen&&ne.filter?us().then(()=>{Xc()}):ne.isOpen||ml([])},[ne.isOpen,ne.filter,Xc]);const _i=B.useMemo(()=>Hn.length===0?!1:Hn.every(K=>xs.has((K._id||K.name).toString())),[Hn,xs]),Jc=B.useCallback(K=>{const Ve=K.target.checked;B.startTransition(()=>{Pa(nt=>{const Ue=new Set(nt);return Hn.forEach(it=>{const Be=(it._id||it.name).toString();Ve?Ue.add(Be):Ue.delete(Be)}),Ue})})},[Hn]),$o=B.useCallback((K,Ve)=>{B.startTransition(()=>{Pa(nt=>{const Ue=new Set(nt);return Ve?Ue.add(K.toString()):Ue.delete(K.toString()),Ue})})},[]),Fi=B.useCallback(()=>{B.startTransition(()=>{Pa(new Set)})},[]),c0=async()=>{if(xs.size!==0){Ci(!0);try{const K=Array.from(xs),Ve=await Vt.delete(`/projects/${l}/project-contacts`,{data:{contactIds:K}});if(Ve.data.success){const nt=Ve.data.data?.deletedCount||0;if(nt===0){alert("No prospects were removed. They may have already been deleted."),Ci(!1);return}Pa(new Set),zo(!1);const Ue=new Set;K.forEach(Be=>{const Ke=String(Be);Ue.add(Ke),Be&&typeof Be=="object"&&Be.toString&&Ue.add(Be.toString())});const it=new Set(Ue);Si(Be=>{const Ke=new Set(Be);return Ue.forEach(Ze=>Ke.add(Ze)),Ke}),v(Be=>{const Ke=Be.filter(Ze=>{if(!Ze._id)return!0;const Fe=Ze._id.toString?Ze._id.toString():String(Ze._id),At=Ze._id;return!(Ue.has(Fe)||At&&Ue.has(String(At)))});return rp(`Removed ${Be.length-Ke.length} contact(s) from UI`),Ke}),jt(Be=>{const Ke=new Set(Be);return Ue.forEach(Ze=>{Ke.delete(Ze)}),Ke}),Kt(Be=>{const Ke={...Be};return Ue.forEach(Ze=>{delete Ke[Ze]}),Ke}),Dt(Be=>Be.filter(Ke=>{if(!Ke.contactId)return!0;const Ze=Ke.contactId.toString?Ke.contactId.toString():String(Ke.contactId);return!Ue.has(Ze)})),setTimeout(async()=>{try{dr?await Nn():await Xr(),v(Be=>{const Ke=Be.filter(Ze=>{if(!Ze._id)return!0;const Fe=Ze._id.toString?Ze._id.toString():String(Ze._id);return!it.has(Fe)});return Be.length!==Ke.length&&rp(`Removed ${Be.length-Ke.length} contact(s) that reappeared after refresh`),Ke}),await us()}catch(Be){console.error("Background refresh after deletion:",Be)}},1e3),rp(`Successfully removed ${nt} prospect(s)`)}}catch(K){console.error("Error removing prospects:",K),alert(K.response?.data?.error||"Couldn't remove those prospects. Try again in a moment.")}finally{Ci(!1)}}};return B.useMemo(()=>{const K=new Date;K.setHours(0,0,0,0);const Ve=new Date(K);Ve.setDate(Ve.getDate()+7);let nt=0,Ue=0;return m.forEach(it=>{const Be=it._id?.toString?it._id.toString():it._id,Ke=Be?Ir.byContactId.get(Be)||[]:[];Ke.some(At=>At.nextActionDate?new Date(At.nextActionDate)<K:!1)&&nt++,Ke.some(At=>{if(!At.nextActionDate)return!1;const Rt=new Date(At.nextActionDate);return Rt>=K&&Rt<Ve})&&Ue++}),{total:m.length,active:m.filter(it=>{const Be=it.stage||"New";return Be==="Qualified"||Be==="Proposal"||Be==="Negotiation"}).length,overdue:nt,thisWeek:Ue}},[m,Ir]),w?t.jsx("div",{className:"p-6 flex items-center justify-center min-h-screen",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):S||!s?t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:S||"Project not found"})}):t.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[t.jsxs("div",{className:"flex items-start justify-between mb-6",children:[t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("button",{onClick:()=>n("/projects"),className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors mt-1",title:"Back to Projects",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[s&&t.jsx("h1",{className:"text-3xl font-bold text-indigo-600 mb-1",children:s.companyName}),t.jsx("p",{className:"text-lg font-semibold text-gray-700",children:"Prospect Management"})]})]}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap justify-end",children:[t.jsxs("button",{onClick:()=>n(`/prospects/dashboard?projectId=${l}`),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-colors font-medium text-sm shadow-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Prospect Analytics"]}),t.jsxs("button",{onClick:()=>n(`/projects/${l}/report`),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-lg hover:from-blue-700 hover:to-cyan-700 transition-colors font-medium text-sm shadow-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Report"]}),t.jsxs("button",{onClick:oi,disabled:!Ar,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors font-medium text-sm ${Ar?dr?"bg-blue-600 text-white hover:bg-blue-700":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50":"bg-gray-100 border border-gray-300 text-gray-400 cursor-not-allowed"}`,title:Ar?"Show prospect suggestions based on ICP":"No ICP defined. Add an ICP definition to get suggestions.",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Prospect Suggestion",!Ar&&t.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})]}),t.jsxs("button",{onClick:()=>Ie(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Bulk Import"]})]})]}),Tt&&t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"mb-3 overflow-x-auto -mx-1 px-1 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:[t.jsx("style",{children:`
              .scrollbar-thin::-webkit-scrollbar {
                height: 6px;
              }
              .scrollbar-thin::-webkit-scrollbar-track {
                background: transparent;
              }
              .scrollbar-thin::-webkit-scrollbar-thumb {
                background-color: #cbd5e1;
                border-radius: 3px;
              }
              .scrollbar-thin::-webkit-scrollbar-thumb:hover {
                background-color: #94a3b8;
              }
            `}),t.jsxs("div",{className:"flex gap-2 min-w-max pb-2",children:[Qr.includes("linkedin")&&t.jsxs("div",{onClick:()=>Ce("linkedin"),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-medium text-xs whitespace-nowrap transition-all cursor-pointer min-w-[150px] justify-center ${we==="linkedin"?"bg-blue-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),t.jsx("span",{children:"LinkedIn Pipeline"})]}),Qr.includes("call")&&t.jsxs("div",{onClick:()=>Ce("call"),className:`flex items-center justify-center gap-2.5 px-6 py-3 rounded-xl font-semibold text-sm whitespace-nowrap transition-all duration-200 cursor-pointer min-w-[200px] ${we==="call"?"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg shadow-green-500/30 hover:shadow-xl hover:shadow-green-500/40":"bg-white text-gray-700 border-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50 shadow-sm"}`,children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{children:"Cold Calling Pipeline"})]}),Qr.includes("email")&&t.jsxs("div",{onClick:()=>Ce("email"),className:`flex items-center gap-1.5 px-4 py-2 rounded-lg font-medium text-xs whitespace-nowrap transition-all cursor-pointer min-w-[150px] justify-center ${we==="email"?"bg-blue-600 text-white shadow-md":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{children:"Email Pipeline"})]})]})]}),Qr.includes("linkedin")&&we==="linkedin"&&Tt&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-9 gap-2",children:[t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"connectionSent"}}),className:`bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="linkedin"&&se?.metric==="connectionSent"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"Sent"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.linkedin?.connectionSent||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Connection Sent"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"accepted"}}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="linkedin"&&se?.metric==="accepted"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Accepted"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.linkedin?.accepted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Accepted"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"followUps"}}),className:`bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="linkedin"&&se?.metric==="followUps"?"border-purple-400 ring-2 ring-purple-200":"border-purple-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full",children:"Follow"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.linkedin?.followUps||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Follow-ups"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"cip"}}),className:`bg-gradient-to-br from-cyan-50 to-blue-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="linkedin"&&se?.metric==="cip"?"border-cyan-400 ring-2 ring-cyan-200":"border-cyan-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full",children:"CIP"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.linkedin?.cip||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"CIP"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"meetingProposed"}}),className:`bg-gradient-to-br from-yellow-50 to-amber-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="linkedin"&&se?.metric==="meetingProposed"?"border-yellow-400 ring-2 ring-yellow-200":"border-yellow-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-yellow-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-yellow-700 bg-white/70 border border-yellow-100 px-2 py-1 rounded-full",children:"Proposed"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.linkedin?.meetingProposed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Meeting Proposed"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"scheduled"}}),className:`bg-gradient-to-br from-orange-50 to-red-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="linkedin"&&se?.metric==="scheduled"?"border-orange-400 ring-2 ring-orange-200":"border-orange-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-orange-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-orange-700 bg-white/70 border border-orange-100 px-2 py-1 rounded-full",children:"Scheduled"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.linkedin?.scheduled||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Scheduled"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"completed"}}),className:`bg-gradient-to-br from-teal-50 to-green-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="linkedin"&&se?.metric==="completed"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Done"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.linkedin?.completed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Completed"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"sql"}}),className:`bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="linkedin"&&se?.metric==="sql"?"border-indigo-400 ring-2 ring-indigo-200":"border-indigo-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full",children:"SQL"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.linkedin?.sql||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"SQL"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"win"}}),className:`bg-gradient-to-br from-emerald-50 to-green-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="linkedin"&&se?.metric==="win"?"border-emerald-400 ring-2 ring-emerald-200":"border-emerald-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full",children:"WON"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.linkedin?.win||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Win"})]})]}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-start",children:[t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"todayFollowups"}}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Today's Follow-ups (",wn.linkedin.today,")"]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"tomorrowFollowups"}}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-emerald-200 text-emerald-700 bg-emerald-50 hover:bg-emerald-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Tomorrow's Follow-ups (",wn.linkedin.tomorrow,")"]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"linkedin",metric:"missedFollowups"}}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-rose-200 text-rose-700 bg-rose-50 hover:bg-rose-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Missed Follow-ups (",wn.linkedin.missed,")"]})]})]}),Qr.includes("call")&&we==="call"&&Tt&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2",children:[t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"callsAttempted"}}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="call"&&se?.metric==="callsAttempted"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Calls"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.call?.callsAttempted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Calls Attempted"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"callsConnected"}}),className:`bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="call"&&se?.metric==="callsConnected"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"Connected"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.call?.callsConnected||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Calls Connected"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"decisionMakerReached"}}),className:`bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="call"&&se?.metric==="decisionMakerReached"?"border-purple-400 ring-2 ring-purple-200":"border-purple-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full",children:"DM"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.call?.decisionMakerReached||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Decision Maker Reached"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"interested"}}),className:`bg-gradient-to-br from-yellow-50 to-amber-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="call"&&se?.metric==="interested"?"border-yellow-400 ring-2 ring-yellow-200":"border-yellow-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-yellow-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-yellow-700 bg-white/70 border border-yellow-100 px-2 py-1 rounded-full",children:"Interest"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.call?.interested||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Interested"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"detailsShared"}}),className:`bg-gradient-to-br from-indigo-50 to-blue-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="call"&&se?.metric==="detailsShared"?"border-indigo-400 ring-2 ring-indigo-200":"border-indigo-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full",children:"Details"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.call?.detailsShared||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Details Shared"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"demoBooked"}}),className:`bg-gradient-to-br from-teal-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="call"&&se?.metric==="demoBooked"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Demo"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.call?.demoBooked||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Demo Booked"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"demoCompleted"}}),className:`bg-gradient-to-br from-emerald-50 to-green-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="call"&&se?.metric==="demoCompleted"?"border-emerald-400 ring-2 ring-emerald-200":"border-emerald-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full",children:"Done"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.call?.demoCompleted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Demo Completed"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"sql"}}),className:`bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="call"&&se?.metric==="sql"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"SQL"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.call?.sql||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"SQL"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"won"}}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="call"&&se?.metric==="won"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"WON"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.call?.won||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"WON"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"notInterested"}}),className:`bg-gradient-to-br from-red-50 to-pink-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="call"&&se?.metric==="notInterested"?"border-red-400 ring-2 ring-red-200":"border-red-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full",children:"Not Interested"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.call?.notInterested||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Not Interested"})]})]}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-start",children:[t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"todayFollowups"}}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Today's Follow-ups (",Tt.call?.todayFollowups||0,")"]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"tomorrowFollowups"}}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-emerald-200 text-emerald-700 bg-emerald-50 hover:bg-emerald-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Tomorrow's Follow-ups (",Tt.call?.tomorrowFollowups||0,")"]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"call",metric:"missedFollowups"}}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-rose-200 text-rose-700 bg-rose-50 hover:bg-rose-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Missed Follow-ups (",Tt.call?.missedFollowups||0,")"]})]})]}),Qr.includes("email")&&we==="email"&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-9 gap-2",children:[t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"emailsSent"}}),className:`bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="email"&&se?.metric==="emailsSent"?"border-blue-400 ring-2 ring-blue-200":"border-blue-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full",children:"Sent"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.email?.emailsSent||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Emails Sent"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"accepted"}}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="email"&&se?.metric==="accepted"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Accepted"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.email?.accepted||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Accepted"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"followups"}}),className:`bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="email"&&se?.metric==="followups"?"border-purple-400 ring-2 ring-purple-200":"border-purple-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full",children:"Followups"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.email?.followups||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Follow-ups"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"cip"}}),className:`bg-gradient-to-br from-amber-50 to-yellow-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="email"&&se?.metric==="cip"?"border-amber-400 ring-2 ring-amber-200":"border-amber-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full",children:"CIP"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.email?.cip||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"CIP"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"meetingProposed"}}),className:`bg-gradient-to-br from-teal-50 to-cyan-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="email"&&se?.metric==="meetingProposed"?"border-teal-400 ring-2 ring-teal-200":"border-teal-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full",children:"Proposed"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.email?.meetingProposed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Meeting Proposed"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"scheduled"}}),className:`bg-gradient-to-br from-indigo-50 to-blue-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="email"&&se?.metric==="scheduled"?"border-indigo-400 ring-2 ring-indigo-200":"border-indigo-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full",children:"Scheduled"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.email?.scheduled||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Scheduled"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"completed"}}),className:`bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="email"&&se?.metric==="completed"?"border-green-400 ring-2 ring-green-200":"border-green-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full",children:"Completed"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.email?.completed||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Completed"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"sql"}}),className:`bg-gradient-to-br from-pink-50 to-rose-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="email"&&se?.metric==="sql"?"border-pink-400 ring-2 ring-pink-200":"border-pink-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-pink-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-pink-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),t.jsx("span",{className:"text-xs font-semibold text-pink-700 bg-white/70 border border-pink-100 px-2 py-1 rounded-full",children:"SQL"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.email?.sql||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"SQL"})]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"emailBounce"}}),className:`bg-gradient-to-br from-red-50 to-rose-50 rounded-lg border shadow-sm p-2.5 transition-all hover:shadow-md cursor-pointer ${se?.channel==="email"&&se?.metric==="emailBounce"?"border-red-400 ring-2 ring-red-200":"border-red-100"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[t.jsx("div",{className:"w-7 h-7 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full",children:"Bounce"})]}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Tt.email?.emailBounce||0}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Email Bounce"})]})]}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 justify-start",children:[t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"todayFollowups"}}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Today's Follow-ups (",wn.email.today,")"]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"tomorrowFollowups"}}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-emerald-200 text-emerald-700 bg-emerald-50 hover:bg-emerald-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Tomorrow's Follow-ups (",wn.email.tomorrow,")"]}),t.jsxs("button",{onClick:()=>ve({isOpen:!0,filter:{channel:"email",metric:"missedFollowups"}}),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-rose-200 text-rose-700 bg-rose-50 hover:bg-rose-100 transition-all duration-200 shadow-sm hover:shadow-md",children:["Missed Follow-ups (",wn.email.missed,")"]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),t.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"})]}),se&&t.jsxs("button",{onClick:()=>de(null),className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear KPI Filter"]})]}),t.jsx("div",{className:"mb-4",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",placeholder:"Search by name, company, email...",value:L,onChange:K=>M(K.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[t.jsx("div",{className:"text-xs font-medium text-gray-500",children:"Quick Filters:"}),t.jsx("button",{onClick:()=>{re(ae==="due-today"?"":"due-today")},className:`px-3 py-1.5 text-xs font-medium rounded-lg transition-all duration-200 ${ae==="due-today"?"bg-blue-600 text-white border border-blue-600 shadow-sm":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200 hover:border-gray-400"}`,children:"Due Today"}),t.jsx("button",{onClick:()=>{const K=ae==="new-prospects"?"":"new-prospects";re(K),K==="new-prospects"?xe("New"):ae==="new-prospects"&&xe("")},className:`px-3 py-1.5 text-xs font-medium rounded-lg transition-all duration-200 ${ae==="new-prospects"?"bg-blue-600 text-white border border-blue-600 shadow-sm":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200 hover:border-gray-400"}`,children:"New Prospects"}),t.jsxs("div",{className:"ml-auto flex items-center gap-3",children:[t.jsxs("select",{value:ke,onChange:K=>{xe(K.target.value),K.target.value!=="New"&&ae==="new-prospects"&&re("")},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Filter by status"}),t.jsxs("optgroup",{label:"Call Statuses",children:[t.jsx("option",{value:"Ring",children:"Ring"}),t.jsx("option",{value:"Busy",children:"Busy"}),t.jsx("option",{value:"Call Back",children:"Call Back"}),t.jsx("option",{value:"Hang Up",children:"Hang Up"}),t.jsx("option",{value:"Switch Off",children:"Switch Off"}),t.jsx("option",{value:"Invalid",children:"Invalid"}),t.jsx("option",{value:"Future",children:"Future"}),t.jsx("option",{value:"Existing",children:"Existing"}),t.jsx("option",{value:"Interested",children:"Interested"}),t.jsx("option",{value:"Not Interested",children:"Not Interested"}),t.jsx("option",{value:"Details Shared",children:"Details Shared"}),t.jsx("option",{value:"Demo Booked",children:"Demo Booked"}),t.jsx("option",{value:"Demo Completed",children:"Demo Completed"})]}),t.jsxs("optgroup",{label:"Email & LinkedIn Statuses",children:[t.jsx("option",{value:"CIP",children:"CIP"}),t.jsx("option",{value:"No Reply",children:"No Reply"}),t.jsx("option",{value:"Out of Office",children:"Out of Office"}),t.jsx("option",{value:"Meeting Proposed",children:"Meeting Proposed"}),t.jsx("option",{value:"Meeting Scheduled",children:"Meeting Scheduled"}),t.jsx("option",{value:"In-Person Meeting",children:"In-Person Meeting"}),t.jsx("option",{value:"Meeting Completed",children:"Meeting Completed"}),t.jsx("option",{value:"SQL",children:"SQL"}),t.jsx("option",{value:"Tech Discussion",children:"Tech Discussion"}),t.jsx("option",{value:"WON",children:"WON"}),t.jsx("option",{value:"Lost",children:"Lost"}),t.jsx("option",{value:"Low Potential - Open",children:"Low Potential - Open"}),t.jsx("option",{value:"Potential Future",children:"Potential Future"}),t.jsx("option",{value:"Wrong Person",children:"Wrong Person"}),t.jsx("option",{value:"Bounce",children:"Bounce"}),t.jsx("option",{value:"Opt-Out",children:"Opt-Out"})]})]}),t.jsxs("select",{value:je,onChange:K=>{Z(K.target.value),K.target.value!=="custom"&&(ue(""),be(""))},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Action Date"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"this-week",children:"This Week"}),t.jsx("option",{value:"this-month",children:"This Month"}),t.jsx("option",{value:"custom",children:"Custom Range"})]}),je==="custom"&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"date",value:ce,onChange:K=>{ue(K.target.value),K.target.value&&Re&&new Date(K.target.value)>new Date(Re)&&be(K.target.value)},max:Re||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"From"}),t.jsx("span",{className:"text-xs text-gray-500",children:"to"}),t.jsx("input",{type:"date",value:Re,onChange:K=>{be(K.target.value),K.target.value&&ce&&new Date(K.target.value)<new Date(ce)&&ue(K.target.value)},min:ce||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"To"})]}),t.jsxs("select",{value:oe,onChange:K=>{he(K.target.value),K.target.value!=="custom"&&(Te(""),_e(""))},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Last Interaction"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"this-week",children:"This Week"}),t.jsx("option",{value:"this-month",children:"This Month"}),t.jsx("option",{value:"custom",children:"Custom Range"})]}),oe==="custom"&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"date",value:ye,onChange:K=>{Te(K.target.value),K.target.value&&fe&&new Date(K.target.value)>new Date(fe)&&_e(K.target.value)},max:fe||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"From"}),t.jsx("span",{className:"text-xs text-gray-500",children:"to"}),t.jsx("input",{type:"date",value:fe,onChange:K=>{_e(K.target.value),K.target.value&&ye&&new Date(K.target.value)<new Date(ye)&&Te(K.target.value)},min:ye||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"To"})]}),t.jsxs("select",{value:We,onChange:K=>{te(K.target.value),K.target.value!=="custom"&&(W(""),Le(""))},className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("option",{value:"",children:"Import Date"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"yesterday",children:"Yesterday"}),t.jsx("option",{value:"custom",children:"Custom Range"})]}),We==="custom"&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"date",value:me,onChange:K=>{W(K.target.value),K.target.value&&pe&&new Date(K.target.value)>new Date(pe)&&Le(K.target.value)},max:pe||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"From"}),t.jsx("span",{className:"text-xs text-gray-500",children:"to"}),t.jsx("input",{type:"date",value:pe,onChange:K=>{Le(K.target.value),K.target.value&&me&&new Date(K.target.value)<new Date(me)&&W(K.target.value)},min:me||void 0,className:"px-3 py-1.5 text-xs border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white hover:border-gray-400 transition-colors",placeholder:"To"})]}),t.jsxs("label",{className:"flex items-center gap-2 px-3 py-1.5 text-xs border border-gray-300 rounded-lg bg-white hover:border-gray-400 transition-colors cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ae,onChange:K=>V(K.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500 cursor-pointer"}),t.jsx("span",{className:"text-gray-700",children:"No Activity"})]})]})]}),(L||ae||ke||je||ce||Re||oe||ye||fe||We||me||pe||Ae||H)&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 flex items-center gap-2 flex-wrap",children:[t.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Active filters:"}),L&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:['Search: "',L,'"',t.jsx("button",{onClick:()=>M(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),ae==="due-today"&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Due Today",t.jsx("button",{onClick:()=>re(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),ae==="new-prospects"&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["New Prospects",t.jsx("button",{onClick:()=>{re(""),xe("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),ke&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Status: ",ke,t.jsx("button",{onClick:()=>xe(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(je||ce||Re)&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Action Date: ",je==="custom"&&(ce||Re)?`${ce?os(ce):"..."} to ${Re?os(Re):"..."}`:je==="today"?"Today":je==="this-week"?"This Week":je==="this-month"?"This Month":je,t.jsx("button",{onClick:()=>{Z(""),ue(""),be("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(oe||ye||fe)&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Last Interaction: ",oe==="custom"&&(ye||fe)?`${ye?os(ye):"..."} to ${fe?os(fe):"..."}`:oe==="today"?"Today":oe==="this-week"?"This Week":oe==="this-month"?"This Month":oe,t.jsx("button",{onClick:()=>{he(""),Te(""),_e("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(We||me||pe)&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Import Date: ",We==="custom"&&(me||pe)?`${me?os(me):"..."} to ${pe?os(pe):"..."}`:We==="today"?"Today":We==="yesterday"?"Yesterday":We,t.jsx("button",{onClick:()=>{te(""),W(""),Le("")},className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Ae&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["No Activity",t.jsx("button",{onClick:()=>V(!1),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),H&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded border border-blue-200",children:["Match: ",H==="exact"?"Exact":H==="good"?"Good":H==="similar"?"Similar":H==="loose"?"Loose":"Imported",t.jsx("button",{onClick:()=>Q(""),className:"hover:text-blue-900",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("button",{onClick:()=>{M(""),re(""),xe(""),Z(""),ue(""),be(""),he(""),Te(""),_e(""),te(""),W(""),Le(""),V(!1),Q("")},className:"text-xs text-gray-600 hover:text-gray-900 font-medium ml-2",children:"Clear all"})]})]}),t.jsx("div",{className:"mb-3 flex items-center justify-between flex-wrap gap-3",children:t.jsx("div",{className:"flex items-center gap-4 flex-wrap",children:Ge&&t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Ge.imported>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-700 text-xs font-semibold rounded-md border border-purple-200",children:[t.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),Ge.imported," Imported"]}),Ge.exact>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-md border border-green-200",children:[t.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),Ge.exact," Exact"]}),Ge.good>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-md border border-blue-200",children:[t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),Ge.good," Good"]}),Ge.similar>0&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-semibold rounded-md border border-yellow-200",children:[t.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),Ge.similar," Similar"]})]})})}),dr&&Ar&&s?.icpDefinition&&t.jsx("div",{className:"mb-4 bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 border-2 border-indigo-200 rounded-2xl p-5 shadow-lg",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"ICP-Based Recommendations"}),t.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Showing prospects from databank that match your project's Ideal Customer Profile"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mt-4",children:[s.icpDefinition.targetIndustries&&s.icpDefinition.targetIndustries.length>0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Target Industries"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.targetIndustries.slice(0,2).join(", "),s.icpDefinition.targetIndustries.length>2&&` +${s.icpDefinition.targetIndustries.length-2} more`]})]}),s.icpDefinition.targetJobTitles&&s.icpDefinition.targetJobTitles.length>0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Target Job Titles"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.targetJobTitles.slice(0,2).join(", "),s.icpDefinition.targetJobTitles.length>2&&` +${s.icpDefinition.targetJobTitles.length-2} more`]})]}),s.icpDefinition.companySizeMin!==void 0&&s.icpDefinition.companySizeMax!==void 0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Company Size"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.companySizeMin.toLocaleString()," - ",s.icpDefinition.companySizeMax.toLocaleString()," employees"]})]}),s.icpDefinition.geographies&&s.icpDefinition.geographies.length>0&&t.jsxs("div",{className:"bg-white rounded-lg p-3 border border-indigo-100",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:"Geographies"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.icpDefinition.geographies.slice(0,2).join(", "),s.icpDefinition.geographies.length>2&&` +${s.icpDefinition.geographies.length-2} more`]})]})]}),Ge&&t.jsx("div",{className:"mt-4 flex items-center gap-4 flex-wrap",children:t.jsxs("div",{className:"text-xs text-gray-600 font-medium",children:["Recommendations:",t.jsxs("span",{className:"ml-2 inline-flex items-center gap-2",children:[Ge.exact>0&&t.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full font-semibold",children:[Ge.exact," Exact"]}),Ge.good>0&&t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full font-semibold",children:[Ge.good," Good"]}),Ge.similar>0&&t.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full font-semibold",children:[Ge.similar," Similar"]}),Ge.loose>0&&t.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded-full font-semibold",children:[Ge.loose," Loose"]})]})]})})]})})}),xs.size>0&&t.jsxs("div",{className:"mb-4 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border-2 border-blue-200 rounded-2xl p-5 shadow-xl animate-slide-down backdrop-blur-sm relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 opacity-5",children:t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 animate-pulse"})}),t.jsxs("div",{className:"relative flex items-center justify-between flex-wrap gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-700 rounded-2xl flex items-center justify-center shadow-lg transform hover:scale-110 transition-transform duration-300 ring-4 ring-blue-200 ring-opacity-50 animate-bounce-subtle",children:t.jsx("span",{className:"text-white font-bold text-lg",children:xs.size})}),t.jsx("div",{className:"absolute inset-0 bg-blue-600 rounded-2xl animate-ping opacity-20"})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("p",{className:"text-base font-bold text-gray-900 tracking-tight",children:[xs.size," ",xs.size===1?"prospect":"prospects"," selected"]}),t.jsx("p",{className:"text-xs text-gray-600 font-medium mt-0.5",children:"Choose an activity type to log for all selected prospects"})]})]}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[Qr.includes("call")&&t.jsxs("button",{onClick:()=>zn({isOpen:!0,type:"call"}),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-green-500 via-green-600 to-emerald-600 text-white text-sm font-bold rounded-xl hover:from-green-600 hover:via-green-700 hover:to-emerald-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:rotate-12 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.jsx("span",{className:"relative z-10",children:"Log Call"})]}),Qr.includes("email")&&t.jsxs("button",{onClick:()=>zn({isOpen:!0,type:"email"}),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 via-blue-600 to-cyan-600 text-white text-sm font-bold rounded-xl hover:from-blue-600 hover:via-blue-700 hover:to-cyan-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:scale-110 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("span",{className:"relative z-10",children:"Log Email"})]}),Qr.includes("linkedin")&&t.jsxs("button",{onClick:()=>zn({isOpen:!0,type:"linkedin"}),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-700 via-indigo-700 to-purple-700 text-white text-sm font-bold rounded-xl hover:from-blue-800 hover:via-indigo-800 hover:to-purple-800 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:scale-110 transition-transform duration-300",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("span",{className:"relative z-10",children:"Log LinkedIn"})]}),t.jsxs("button",{onClick:()=>zo(!0),className:"group relative inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-red-500 via-red-600 to-rose-600 text-white text-sm font-bold rounded-xl hover:from-red-600 hover:via-red-700 hover:to-rose-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-20 group-hover:animate-shimmer"}),t.jsx("svg",{className:"w-5 h-5 relative z-10 transform group-hover:scale-110 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),t.jsx("span",{className:"relative z-10",children:"Remove"})]}),t.jsxs("button",{onClick:Fi,className:"group relative inline-flex items-center justify-center gap-2 px-5 py-3 bg-white border-2 border-gray-300 text-gray-700 text-sm font-bold rounded-xl hover:bg-gray-50 hover:border-gray-400 hover:text-gray-900 transition-all duration-300 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95",children:[t.jsx("svg",{className:"w-4 h-4 transform group-hover:rotate-90 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})}),t.jsx("span",{children:"Clear"})]})]})]})]}),ll&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full mx-4 transform animate-fade-in-up",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Remove Prospects?"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"This action cannot be undone."})]})]}),t.jsxs("p",{className:"text-sm text-gray-700 mb-6",children:["Are you sure you want to remove ",t.jsx("span",{className:"font-bold text-gray-900",children:xs.size})," ",xs.size===1?"prospect":"prospects"," from this project? They will be removed from the project but will remain in the databank."]}),t.jsxs("div",{className:"flex items-center justify-end gap-3",children:[t.jsx("button",{onClick:()=>zo(!1),disabled:ol,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{onClick:c0,disabled:ol,className:"px-4 py-2 text-sm font-medium text-white bg-gradient-to-r from-red-500 to-red-600 rounded-lg hover:from-red-600 hover:to-red-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:ol?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Removing..."]}):"Remove"})]})]})}),Hn.length>0?t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[_a>0&&t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-white flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",t.jsx("span",{className:"font-semibold",children:(Xs-1)*Ho+1})," to"," ",t.jsx("span",{className:"font-semibold",children:Math.min(Xs*Ho,_a)})," ","of ",t.jsx("span",{className:"font-semibold",children:_a.toLocaleString()})," contacts"]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>li(Xs-1),disabled:Xs===1||w,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-colors",children:"Previous"}),(()=>{const K=[];let nt=Math.max(1,Xs-Math.floor(2.5)),Ue=Math.min(ar,nt+5-1);Ue-nt<4&&(nt=Math.max(1,Ue-5+1)),nt>1&&(K.push(t.jsx("button",{onClick:()=>li(1),className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"1"},1)),nt>2&&K.push(t.jsx("span",{className:"px-2 text-gray-500",children:"..."},"ellipsis1")));for(let it=nt;it<=Ue;it++)K.push(t.jsx("button",{onClick:()=>li(it),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${it===Xs?"bg-blue-600 text-white border border-blue-600":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:it},it));return Ue<ar&&(Ue<ar-1&&K.push(t.jsx("span",{className:"px-2 text-gray-500",children:"..."},"ellipsis2")),K.push(t.jsx("button",{onClick:()=>li(ar),className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:ar},ar))),K})(),t.jsx("button",{onClick:()=>li(Xs+1),disabled:Xs===ar||w,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white transition-colors",children:"Next"})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-fixed",children:[t.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-2.5 text-left text-[10px] font-semibold text-gray-700 uppercase tracking-wider w-12",children:t.jsx("input",{type:"checkbox",checked:_i,onChange:Jc,className:"h-3.5 w-3.5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer",title:"Select all"})}),t.jsx("th",{className:"px-3 py-2.5 text-left text-[10px] font-semibold text-gray-700 uppercase tracking-wider w-12"}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[20%] cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>{Ai==="name"?dl(Ei==="asc"?"desc":"asc"):(ni("name"),dl("asc"))},children:t.jsxs("div",{className:"flex items-center gap-1.5",children:["Contact",Ai==="name"?Ei==="asc"?t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):t.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]})}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[18%]",children:"Contact Info"}),t.jsxs("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[12%] relative",ref:Yl,children:[t.jsxs("div",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 transition-colors rounded px-1 py-0.5 -mx-1 -my-0.5",onClick:()=>ii(!Sr),children:["Status",t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})})]}),Sr&&t.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[200px] max-h-96 overflow-y-auto",children:t.jsxs("div",{className:"p-2",children:[t.jsx("button",{onClick:()=>{xe(""),ii(!1)},className:`w-full text-left px-3 py-2 text-xs rounded hover:bg-gray-100 ${ke?"text-gray-700":"bg-blue-50 text-blue-700 font-medium"}`,children:"All Statuses"}),["New","Interested","Not Interested","Details Shared","Demo Booked","Demo Completed","SQL","WON","Lost","CIP","No Reply","Meeting Proposed","Meeting Scheduled","Meeting Completed","Ring","Busy","Call Back","Hang Up","Switch Off","Invalid","Future","Existing","Bounce","Opt-Out"].map(K=>t.jsx("button",{onClick:()=>{xe(K),ii(!1)},className:`w-full text-left px-3 py-2 text-xs rounded hover:bg-gray-100 ${ke===K?"bg-blue-50 text-blue-700 font-medium":"text-gray-700"}`,children:K},K))]})})]}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[15%]",children:"Last Interaction"}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[18%]",children:"Next Action"}),t.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider w-[12%]",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Hn.map(K=>{const Ve=K._id||K.name,nt=ze.has(Ve),Ue=rt[Ve]||[],it=Lt[Ve],Be=K._id?.toString?K._id.toString():K._id;let Ke=null,Ze=null,Fe=null;if(Be){const Zt=Be.toString?Be.toString():String(Be);Ke=Ir.lastActivityByContactId.get(Zt)||null,Ze=Ir.nextActionByContactId.get(Zt)||null,Fe=Ir.latestActivityStatusByContactId.get(Zt)||null}let At=Fe?.status||null;if((!Ke||!Ze||!Fe)&&!Be){const Zt=K.name?.toLowerCase()||"",js=K.email?.toLowerCase()||"";if(!Ke&&(Zt||js)&&(Ke=st.filter(nr=>{if(nr.contactId)return!1;const Is=nr.conversationNotes?.toLowerCase()||"";return Is.includes(Zt)||Is.includes(js)}).sort((nr,Is)=>On(Is)-On(nr))[0]),!Ze&&(Zt||js)){const nr=new Date;Ze=st.filter(Is=>{if(!Is.nextActionDate||new Date(Is.nextActionDate)<nr||Is.contactId)return!1;const Hs=Is.conversationNotes?.toLowerCase()||"";return Hs.includes(Zt)||Hs.includes(js)}).sort((Is,Hs)=>new Date(Is.nextActionDate)-new Date(Hs.nextActionDate))[0]}if(!Fe&&(Zt||js)){const nr=st.filter(Is=>{if(Is.contactId||!(Is.type==="call"&&Is.callStatus&&Is.callStatus.trim()!==""||Is.status&&Is.status.trim()!==""))return!1;const Ia=Is.conversationNotes?.toLowerCase()||"";return Ia.includes(Zt)||Ia.includes(js)}).sort((Is,Hs)=>On(Hs)-On(Is));if(nr.length>0){const Is=nr[0];At=Is.type==="call"&&Is.callStatus?Is.callStatus:Is.status}}}const Rt=At||K.stage||"New";K.assignedTo||s?.assignedTo;const It=Be&&(typeof Be=="string"&&Be.length===24||typeof K._id=="object"&&K._id!==null),gt=Zt=>{if(!(Zt.target.closest("button")||Zt.target.closest("svg")||Zt.target.closest("a"))&&It&&Be){const js=new URLSearchParams;L&&js.set("search",L),ae&&js.set("quickFilter",ae),ke&&js.set("filterStatus",ke),je&&js.set("filterActionDate",je),ce&&js.set("filterActionDateFrom",ce),Re&&js.set("filterActionDateTo",Re),oe&&js.set("filterLastInteraction",oe),ye&&js.set("filterLastInteractionFrom",ye),fe&&js.set("filterLastInteractionTo",fe),We&&js.set("filterImportDate",We),me&&js.set("filterImportDateFrom",me),pe&&js.set("filterImportDateTo",pe),Ae&&js.set("filterNoActivity","true"),H&&js.set("filterMatchType",H),js.set("page",Xs.toString());const nr=`/projects/${l}${js.toString()?"?"+js.toString():""}`;n(`/contacts/${Be}/activities?projectId=${l}&returnTo=${encodeURIComponent(nr)}`)}};return t.jsxs(Mo.Fragment,{children:[t.jsxs("tr",{onClick:gt,className:`transition-all duration-150 ${It?"hover:bg-blue-50 cursor-pointer":"hover:bg-gray-50"} ${nt?"bg-blue-50":""}`,children:[t.jsx("td",{className:"px-3 py-2.5",onClick:Zt=>Zt.stopPropagation(),children:t.jsx("input",{type:"checkbox",checked:xs.has(Ve.toString()),onChange:Zt=>$o(Ve,Zt.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"})}),t.jsx("td",{className:"px-3 py-2.5",children:t.jsx("button",{onClick:Zt=>{Zt.stopPropagation(),fl(Ve,K.email,K.name)},className:"text-gray-400 hover:text-gray-600 transition-all",title:nt?"Collapse details":"Expand details",children:t.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${nt?"-rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}),t.jsx("td",{className:"px-4 py-2.5",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center flex-shrink-0 shadow-md",children:t.jsx("span",{className:"text-sm font-semibold text-white",children:Un(K.name)})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsx("div",{className:`text-sm font-semibold ${It?"text-gray-900 hover:text-blue-600":"text-gray-900"}`,children:K.name||"N/A"}),!K.isImported&&K.recommendationReasons&&K.recommendationReasons.length>0&&t.jsxs("div",{className:"group relative",children:[t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${K.matchType==="exact"?"bg-green-100 text-green-800":K.matchType==="good"?"bg-blue-100 text-blue-800":K.matchType==="similar"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),K.matchScore,"% Match"]}),t.jsxs("div",{className:"absolute left-0 top-full mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 p-4 z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 pointer-events-none",children:[t.jsx("div",{className:"absolute -top-2 left-4 w-4 h-4 bg-white border-l border-t border-gray-200 transform rotate-45"}),t.jsxs("div",{className:"relative",children:[t.jsxs("h4",{className:"text-xs font-bold text-gray-900 mb-2 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Recommended Based on ICP"]}),t.jsx("div",{className:"space-y-2",children:K.recommendationReasons.map((Zt,js)=>t.jsxs("div",{className:"text-xs text-gray-700 bg-gray-50 rounded p-2 border-l-2 border-blue-500",children:[t.jsxs("div",{className:"font-semibold text-gray-900 mb-1 capitalize",children:[Zt.type==="industry"&&" Industry Match",Zt.type==="jobTitle"&&" Job Title Match",Zt.type==="companySize"&&" Company Size Match",Zt.type==="geography"&&" Location Match",Zt.type==="keywords"&&" Keywords Match"]}),t.jsx("div",{className:"text-gray-600",children:Zt.message})]},js))}),t.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200",children:t.jsxs("div",{className:"text-xs text-gray-500",children:[t.jsx("span",{className:"font-semibold",children:"Match Score:"})," ",K.matchScore,"% (",K.matchType,")"]})})]})]})]})]}),t.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:K.company||"N/A"})]})]})}),t.jsx("td",{className:"px-4 py-2.5",children:t.jsxs("div",{className:"space-y-0.5",children:[K.email?(()=>{const js=String(K.email).trim().split(/[,\s]+/).filter(Is=>Is.trim()),nr=js.length>=2;return t.jsxs("div",{className:"text-sm text-gray-900 font-medium flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),nr?`${js[0]}....`:K.email]})})():t.jsx("div",{className:"text-xs text-gray-400",children:"No email"}),K.firstPhone?t.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),K.firstPhone]}):t.jsx("div",{className:"text-xs text-gray-400",children:"No phone"}),K.personLinkedinUrl||K.companyLinkedinUrl?t.jsxs("div",{className:"text-xs text-blue-600 flex items-center gap-1",children:[t.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),t.jsx("a",{href:K.personLinkedinUrl||K.companyLinkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"hover:underline truncate",onClick:Zt=>Zt.stopPropagation(),children:"LinkedIn"})]}):t.jsx("div",{className:"text-xs text-gray-400",children:"No LinkedIn"})]})}),t.jsx("td",{className:"px-4 py-2.5",children:Ka(Rt)}),t.jsx("td",{className:"px-4 py-2.5",children:Ke?t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-900 font-medium",children:os(On(Ke))}),t.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:Ke.type==="call"?"Call":Ke.type==="email"?"Email":Ke.type==="linkedin"?"LinkedIn":"Activity"})]}):t.jsx("div",{className:"text-sm text-gray-400",children:"-"})}),t.jsx("td",{className:"px-4 py-2.5",children:Ze?t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("svg",{className:`w-4 h-4 flex-shrink-0 ${new Date(Ze.nextActionDate)<new Date?"text-red-600":new Date(Ze.nextActionDate)<=new Date(Date.now()+4320*60*1e3)?"text-orange-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ze.nextAction}),t.jsx("div",{className:`text-xs font-medium mt-0.5 ${new Date(Ze.nextActionDate)<new Date?"text-red-600":new Date(Ze.nextActionDate)<=new Date(Date.now()+4320*60*1e3)?"text-orange-600":"text-gray-500"}`,children:os(Ze.nextActionDate)})]})]}):t.jsx("div",{className:"text-sm text-gray-400",children:"-"})}),t.jsx("td",{className:"px-4 py-2.5",children:t.jsxs("div",{className:"flex items-center gap-1.5",children:[Qr.includes("call")&&t.jsx("button",{onClick:Zt=>{Zt.stopPropagation(),jr("call",K)},className:"p-1.5 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Log Call",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),Qr.includes("email")&&t.jsx("button",{onClick:Zt=>{Zt.stopPropagation(),jr("email",K)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Log Email",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),Qr.includes("linkedin")&&t.jsx("button",{onClick:Zt=>{Zt.stopPropagation(),jr("linkedin",K)},className:"p-1.5 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Log LinkedIn",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})})]})})]}),nt&&t.jsx("tr",{className:"animate-fade-in",children:t.jsx("td",{colSpan:"7",className:"px-6 py-4 bg-blue-50 border-t-2 border-blue-200 transition-all duration-300",children:it?t.jsx("div",{className:"flex items-center justify-center py-8 animate-fade-in",children:t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Loading activities..."})]})}):t.jsx("div",{className:"animate-fade-in-up",children:t.jsx(Wo,{contact:K,activities:Ue})})})})]},Ve)})})]})})]}):t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-12",children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No prospects found"}),t.jsx("p",{className:"text-sm text-gray-600",children:"No similar contacts found for this project"})]})}),t.jsx(wv,{isOpen:_s.isOpen,onClose:Vo,type:_s.type,contactName:_s.contactName,companyName:_s.companyName,projectId:_s.projectId,contactId:_s.contactId,phoneNumber:_s.phoneNumber,email:_s.email,linkedInProfileUrl:_s.linkedInProfileUrl,lastActivity:_s.lastActivity}),t.jsx(Qk,{isOpen:ws,onClose:()=>Ie(!1),projectId:l,onImportSuccess:()=>{dr?Nn():Xr(1),us()}}),t.jsx(Xk,{isOpen:Qc.isOpen,onClose:Jr,type:Qc.type,selectedContacts:xs,projectId:l,contacts:m}),ne.isOpen&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[ne.filter?.channel==="linkedin"&&"LinkedIn Pipeline",ne.filter?.channel==="call"&&"Cold Calling Pipeline",ne.filter?.channel==="email"&&"Email Pipeline"]}),t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[ne.filter?.metric==="connectionSent"&&"Connection Sent",ne.filter?.metric==="accepted"&&"Accepted",(ne.filter?.metric==="followUps"||ne.filter?.metric==="followups")&&"Follow-ups",ne.filter?.metric==="cip"&&"CIP",ne.filter?.metric==="meetingProposed"&&"Meeting Proposed",ne.filter?.metric==="scheduled"&&"Scheduled",ne.filter?.metric==="completed"&&"Completed",ne.filter?.metric==="sql"&&"SQL",ne.filter?.metric==="win"&&"Win",ne.filter?.metric==="connectionRequestsSent"&&"Connection Requests Sent",ne.filter?.metric==="connectionAcceptanceRate"&&"Connection Acceptance Rate",ne.filter?.metric==="messagesSent"&&"Messages Sent",ne.filter?.metric==="messageReplyRate"&&"Message Reply Rate",ne.filter?.metric==="allProspects"&&"All Prospects",ne.filter?.metric==="callsAttempted"&&"Calls Attempted",ne.filter?.metric==="callsConnected"&&"Calls Connected",ne.filter?.metric==="decisionMakerReached"&&"Decision Maker Reached",ne.filter?.metric==="interested"&&"Interested",ne.filter?.metric==="detailsShared"&&"Details Shared",ne.filter?.metric==="demoBooked"&&"Demo Booked",ne.filter?.metric==="demoCompleted"&&"Demo Completed",ne.filter?.metric==="sql"&&"SQL",ne.filter?.metric==="won"&&"WON",ne.filter?.metric==="callsMade"&&"Calls Made",ne.filter?.metric==="callAnswerRate"&&"Call Answer Rate",ne.filter?.metric==="callInterestedRate"&&"Call Interested Rate",ne.filter?.metric==="emailsSent"&&"Emails Sent",ne.filter?.metric==="accepted"&&"Accepted",ne.filter?.metric==="followups"&&"Follow-ups",ne.filter?.metric==="cip"&&"CIP",ne.filter?.metric==="meetingProposed"&&"Meeting Proposed",ne.filter?.metric==="scheduled"&&"Scheduled",ne.filter?.metric==="completed"&&"Completed",ne.filter?.metric==="sql"&&"SQL",ne.filter?.metric==="emailBounce"&&"Email Bounce",ne.filter?.metric==="emailOpenRate"&&"Email Open Rate",ne.filter?.metric==="emailReplyRate"&&"Email Reply Rate",ne.filter?.metric==="meetingsBooked"&&"Meetings Booked"]}),!ys&&ne.filter&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing all ",Ys(ne.filter).length," prospects"]})]}),t.jsx("button",{onClick:()=>ve({isOpen:!1,filter:null}),className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:ys?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsx("p",{className:"text-sm font-medium",children:"Loading prospects..."})]}):(()=>{const K=Ys(ne.filter);return K.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm font-medium",children:"No prospects found for this metric"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"CONTACT"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"COMPANY"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"DATE"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"STATUS"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map(Ve=>{const nt=(Ve._id?.toString?Ve._id.toString():Ve._id)||"",Ue=nt?Ir.lastActivityByContactId.get(nt):null,Be=(nt?Ir.latestActivityStatusByContactId.get(nt):null)?.status||Ve.stage||"New",Ke=Ue?On(Ue):null,Ze=Ke?Ke.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",Fe=nt&&(typeof nt=="string"&&nt.length===24||typeof Ve._id=="object"&&Ve._id!==null),At=Rt=>{if(!(Rt.target.closest("button")||Rt.target.closest("svg")||Rt.target.closest("a"))&&Fe&&nt){const It=new URLSearchParams;It.set("page",Xs.toString());const gt=`/projects/${l}${It.toString()?"?"+It.toString():""}`;n(`/contacts/${nt}/activities?projectId=${l}&returnTo=${encodeURIComponent(gt)}`)}};return t.jsxs("tr",{onClick:At,className:`transition-colors ${Fe?"hover:bg-blue-50 cursor-pointer":"hover:bg-gray-50"}`,children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:Ve.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:Ve.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:Ze}),t.jsx("td",{className:"px-4 py-3 text-sm",children:t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded-full border border-green-200",children:Be})})]},Ve._id||Ve.name)})})]})})})()})]})})]})}const e7=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Line}))),Ab=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Bar}))),t7=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Doughnut}))),s7=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Pie})));nl.register(Yc,Gc,Hc,il,Vc,bm,$c,qc,Wc);function r7(){const l=Tr(),[n,a]=B.useState(null),[o,s]=B.useState(!0),[e,m]=B.useState("overview"),[v,w]=B.useState("30d");B.useEffect(()=>{N()},[v]);const N=async()=>{try{s(!0);const M=await Vt.get("/projects/analytics");M.data.success&&a(M.data.data)}catch(M){console.error("Error fetching project analytics:",M)}finally{s(!1)}},S=[{id:"overview",label:"Overview",icon:"grid"},{id:"pipeline",label:"Pipeline",icon:"funnel"},{id:"channels",label:"Channels",icon:"megaphone"},{id:"team",label:"Team Performance",icon:"users"}],D=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(o)return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((M,F)=>t.jsx(D,{},F))}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[...Array(4)].map((M,F)=>t.jsx(D,{},F))})]})});if(!n)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-600",children:"Failed to load dashboard data"}),t.jsx("button",{onClick:N,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})});const L=({title:M,value:F,subtitle:O,icon:P,trend:G,trendDirection:ae,color:re="blue"})=>{const ke={blue:{bg:"from-blue-50 to-indigo-50",border:"border-blue-100",icon:"text-indigo-600",badge:"text-blue-700 bg-white/70 border-blue-100"},green:{bg:"from-emerald-50 to-teal-50",border:"border-emerald-100",icon:"text-emerald-600",badge:"text-emerald-700 bg-white/70 border-emerald-100"},purple:{bg:"from-purple-50 to-indigo-50",border:"border-purple-100",icon:"text-purple-600",badge:"text-purple-700 bg-white/70 border-purple-100"},orange:{bg:"from-amber-50 to-orange-50",border:"border-amber-100",icon:"text-amber-600",badge:"text-amber-700 bg-white/70 border-amber-100"}},xe=ke[re]||ke.blue;return t.jsxs("div",{className:`bg-gradient-to-br ${xe.bg} rounded-xl border ${xe.border} shadow-sm p-6 hover:shadow-md transition-shadow`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:`w-12 h-12 rounded-lg bg-white/80 border ${xe.border} flex items-center justify-center shadow-xs`,children:P}),G&&t.jsxs("span",{className:`text-xs font-semibold ${xe.badge} px-2 py-1 rounded-full shadow-xs flex items-center gap-1`,children:[ae==="up"?"":""," ",G]})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:F}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:M}),O&&t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:O})]})};return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>l("/projects"),className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors",title:"Back to Projects",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Project Analytics Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Comprehensive insights into your lead generation campaigns"})]})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs("select",{value:v,onChange:M=>w(M.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"7d",children:"Last 7 days"}),t.jsx("option",{value:"30d",children:"Last 30 days"}),t.jsx("option",{value:"90d",children:"Last 90 days"})]})})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:S.map(M=>t.jsx("button",{onClick:()=>m(M.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${e===M.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:M.label},M.id))})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(L,{title:"Total Projects",value:n.overview.totalProjects,icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),color:"blue"}),t.jsx(L,{title:"Win Rate",value:`${n.pipeline.conversion.winRate}%`,subtitle:`${n.pipeline.conversion.won} won / ${n.pipeline.conversion.total} total`,icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"green"}),t.jsx(L,{title:"Meeting Rate",value:`${n.pipeline.conversion.meetingRate}%`,subtitle:`${n.pipeline.conversion.meetings} meetings scheduled`,icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),color:"blue"}),t.jsx(L,{title:"SQL Count",value:n.pipeline.conversion.sql||0,subtitle:"Sales Qualified Leads",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),color:"purple"}),t.jsx(L,{title:"Avg Activities/Prospect",value:n.overview.totalProspects>0?(n.overview.totalActivities/n.overview.totalProspects).toFixed(1):"0",subtitle:"Average engagement",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"orange"}),t.jsx(L,{title:"Total Prospects",value:n.overview.totalProspects.toLocaleString(),subtitle:"Across all projects",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),color:"purple"}),t.jsx(L,{title:"Total Activities",value:n.overview.totalActivities.toLocaleString(),subtitle:"Calls, emails & LinkedIn",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"orange"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Trends (Last 7 Days)"}),n.activities.trends.labels.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(e7,{data:{labels:n.activities.trends.labels,datasets:[{label:"Calls",data:n.activities.trends.call,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4},{label:"Emails",data:n.activities.trends.email,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4},{label:"LinkedIn",data:n.activities.trends.linkedin,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Distribution"}),n.activities.byType.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(t7,{data:{labels:n.activities.byType.map(M=>M.type.charAt(0).toUpperCase()+M.type.slice(1)),datasets:[{data:n.activities.byType.map(M=>M.count),backgroundColor:["rgb(34, 197, 94)","rgb(59, 130, 246)","rgb(168, 85, 247)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Project Growth"}),n.growth.monthly.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Ab,{data:{labels:n.growth.monthly.map(M=>M.month),datasets:[{label:"Projects Created",data:n.growth.monthly.map(M=>M.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No growth data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conversion Metrics"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Win Rate"}),t.jsxs("span",{className:"text-lg font-bold text-green-600",children:[n.pipeline.conversion.winRate,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:"bg-green-500 h-3 rounded-full",style:{width:`${n.pipeline.conversion.winRate}%`}})}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n.pipeline.conversion.won," won / ",n.pipeline.conversion.total," total"]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Meeting Rate"}),t.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[n.pipeline.conversion.meetingRate,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:"bg-blue-500 h-3 rounded-full",style:{width:`${n.pipeline.conversion.meetingRate}%`}})}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n.pipeline.conversion.meetings," meetings scheduled"]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.pipeline.conversion.sql}),t.jsx("div",{className:"text-xs text-gray-500",children:"SQL"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.pipeline.conversion.cip}),t.jsx("div",{className:"text-xs text-gray-500",children:"CIP"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:n.pipeline.conversion.lost}),t.jsx("div",{className:"text-xs text-gray-500",children:"Lost"})]})]})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performing Projects"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Project"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Prospects"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Activities"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Won"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Meetings"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:n.projects.topPerformers.slice(0,5).map(M=>t.jsxs("tr",{onClick:()=>l(`/projects/${M.id}`),className:"hover:bg-gray-50 cursor-pointer",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:M.companyName}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.contactCount}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.activityCount}),t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:M.wonCount}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.meetingCount})]},M.id))})]})})]})]}),e==="pipeline"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pipeline Stage Distribution"}),n.pipeline.stageDistribution.length>0?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(Ab,{data:{labels:n.pipeline.stageDistribution.map(M=>M.stage),datasets:[{label:"Prospects",data:n.pipeline.stageDistribution.map(M=>M.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No pipeline data available"})})]})}),e==="channels"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Channel Usage"}),t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(s7,{data:{labels:["LinkedIn","Email","Cold Calling"],datasets:[{data:[n.channels.linkedIn,n.channels.email,n.channels.calling],backgroundColor:["rgb(168, 85, 247)","rgb(59, 130, 246)","rgb(34, 197, 94)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Channel Statistics"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600",children:"LinkedIn Outreach"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.channels.linkedIn}),t.jsx("div",{className:"text-xs text-gray-500",children:"Projects using this channel"})]}),t.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})})]}),t.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Cold Email"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.channels.email}),t.jsx("div",{className:"text-xs text-gray-500",children:"Projects using this channel"})]}),t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),t.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Cold Calling"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.channels.calling}),t.jsx("div",{className:"text-xs text-gray-500",children:"Projects using this channel"})]}),t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]})]})]})]})}),e==="team"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Team Performance"}),n.team.performance.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Team Member"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Activities"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Calls"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Emails"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"LinkedIn"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:n.team.performance.map(M=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:M.name||"Unknown"}),t.jsx("div",{className:"text-xs text-gray-500",children:M.email})]}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-semibold",children:M.totalActivities}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.calls}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.emails}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.linkedin})]},M.id))})]})}):t.jsx("div",{className:"text-center py-12 text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No team performance data available"})})]})})]})]})}const a7=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Line}))),$u=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Bar}))),ap=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Doughnut}))),n7=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Pie})));nl.register(Yc,Gc,Hc,il,Vc,bm,$c,qc,Wc);const Eb={},Db={},Tb={},i7=60*1e3,M1=(l,n)=>{const a=l[n];return a?Date.now()-a.timestamp>i7?(delete l[n],null):a.data:null},L1=(l,n,a)=>{l[n]={data:a,timestamp:Date.now()}},l7=l=>l.type==="call"&&l.callDate?new Date(l.callDate):l.type==="email"&&l.emailDate?new Date(l.emailDate):l.type==="linkedin"&&l.linkedinDate?new Date(l.linkedinDate):new Date(l.createdAt);function o7(){const l=Tr(),[n,a]=l0(),[o,s]=B.useState(null),[e,m]=B.useState(!0),[v,w]=B.useState("overview"),[N,S]=B.useState([]),[D,L]=B.useState(n.get("projectId")||""),[M,F]=B.useState(null),[O,P]=B.useState([]),[G,ae]=B.useState(!1),[re,ke]=B.useState(null),[xe,je]=B.useState("today"),[Z,ce]=B.useState(null),[ue,Re]=B.useState(!1),[be,oe]=B.useState([]),[he,ye]=B.useState(!1);B.useEffect(()=>(M?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[M]),B.useEffect(()=>{fe()},[]),B.useEffect(()=>{_e()},[D]),B.useEffect(()=>{We()},[D,xe]),B.useEffect(()=>{Te()},[D]);const Te=async()=>{try{const H=D||"all",Q=M1(Tb,H);Q?(oe(Q),ye(!1)):ye(!0);const se=D?{projectId:D}:{},de=await Vt.get("/projects/team-member-funnels",{params:se});if(de.data.success){const we=de.data.data||[];oe(we),L1(Tb,H,we)}}catch(H){console.error("Error fetching team member funnels:",H),oe([])}finally{ye(!1)}},fe=async()=>{try{const H=await Vt.get("/projects");H.data.success&&S(H.data.data||[])}catch(H){console.error("Error fetching projects:",H)}},_e=async()=>{try{const H=D||"all",Q=M1(Eb,H);Q?(s(Q),m(!1)):m(!0);const se=D?{projectId:D}:{},de=await Vt.get("/projects/prospect-analytics",{params:se});if(de.data.success){const we=de.data.data;s(we),L1(Eb,H,we)}}catch(H){console.error("Error fetching prospect analytics:",H)}finally{m(!1)}},We=async()=>{try{const H=`${D||"all"}:${xe}`,Q=M1(Db,H);Q?(ce(Q),Re(!1)):Re(!0);const se={timeFilter:xe};D&&(se.projectId=D);const de=await Vt.get("/activities/team-performance",{params:se});if(de.data.success){const we=de.data.data;ce(we),L1(Db,H,we)}}catch(H){console.error("Error fetching team activity data:",H),ce(null)}finally{Re(!1)}},te=H=>{L(H),a(H?{projectId:H}:{})},me=async(H,Q,se,de=null)=>{try{if(ae(!0),F({stage:H,funnelType:Q,funnelData:se,memberId:de}),H==="prospectData"){if(!D){ke({type:"info",message:"Please select a project to view prospects"}),ae(!1);return}const[Ce,ne]=await Promise.all([Vt.get(`/projects/${D}/project-contacts?limit=100`),Vt.get(`/activities/project/${D}?limit=5000`)]);if(Ce.data.success){let ve=Ce.data.data||[],Ge=ne.data.success?ne.data.data||[]:[];if(de){const ze=de.toString?de.toString():String(de);Ge=Ge.filter(rt=>rt.createdBy?(rt.createdBy?.toString?rt.createdBy.toString():rt.createdBy?._id?rt.createdBy._id.toString():String(rt.createdBy))===ze:!1);const jt=new Set(Ge.map(rt=>rt.contactId?.toString?rt.contactId.toString():String(rt.contactId)).filter(Boolean));ve=ve.filter(rt=>{const Kt=rt._id?.toString?rt._id.toString():String(rt._id);return jt.has(Kt)})}const vt=new Map;Ge.forEach(ze=>{if(ze.contactId&&ze.status&&ze.status.trim()!==""){const jt=ze.contactId.toString?ze.contactId.toString():String(ze.contactId),rt=l7(ze),Kt=vt.get(jt);(!Kt||rt>Kt.activityDate)&&vt.set(jt,{status:ze.status,activityDate:rt})}}),P(ve.map(ze=>{const jt=ze._id?.toString?ze._id.toString():String(ze._id),Kt=vt.get(jt)?.status||ze.stage||"New";return{...ze,isProspect:!0,displayStatus:Kt}}))}ae(!1);return}if(!D){ke({type:"info",message:"Please select a project to view stage details"}),ae(!1);return}const we=await Vt.get(`/activities/project/${D}`);if(we.data.success){let Ce=we.data.data||[];if(de){const ze=de.toString?de.toString():String(de);Ce=Ce.filter(jt=>jt.createdBy?(jt.createdBy?.toString?jt.createdBy.toString():jt.createdBy?._id?jt.createdBy._id.toString():String(jt.createdBy))===ze:!1)}let ne=[];if(Q==="call")switch(H){case"callsAttempted":case"callSent":ne=Ce.filter(Lt=>Lt.type==="call"&&Lt.callDate);break;case"callsConnected":case"accepted":const ze=["Interested","Not Interested","Call Back","Future","Details Shared","Demo Booked","Demo Completed","Existing"];ne=Ce.filter(Lt=>Lt.type==="call"&&Lt.callStatus&&ze.includes(Lt.callStatus));break;case"decisionMakerReached":const jt=["Interested","Details Shared","Demo Booked","Demo Completed"];ne=Ce.filter(Lt=>Lt.type==="call"&&Lt.callStatus&&jt.includes(Lt.callStatus));break;case"interested":ne=Ce.filter(Lt=>Lt.type==="call"&&Lt.callStatus==="Interested");break;case"detailsShared":ne=Ce.filter(Lt=>Lt.type==="call"&&Lt.callStatus==="Details Shared");break;case"demoBooked":case"scheduled":ne=Ce.filter(Lt=>Lt.type==="call"&&Lt.callStatus==="Demo Booked");break;case"demoCompleted":case"completed":ne=Ce.filter(Lt=>Lt.type==="call"&&Lt.callStatus==="Demo Completed");break;case"sql":ne=Ce.filter(Lt=>Lt.type==="call"&&(Lt.callStatus==="Demo Completed"||Lt.callStatus==="Interested"&&Lt.conversationNotes&&Lt.conversationNotes.length>50||Lt.status==="SQL"));break;case"followups":const rt={};Ce.filter(Lt=>Lt.type==="call"&&Lt.callDate).forEach(Lt=>{const ks=Lt.contactId?.toString();ks&&(rt[ks]=(rt[ks]||0)+1)});const Kt=Object.keys(rt).filter(Lt=>rt[Lt]>1);ne=Ce.filter(Lt=>Lt.type==="call"&&Kt.includes(Lt.contactId?.toString()));break;case"cip":ne=Ce.filter(Lt=>Lt.type==="call"&&["Interested","Call Back","Future"].includes(Lt.callStatus));break;case"meetingProposed":ne=Ce.filter(Lt=>Lt.type==="call"&&Lt.nextAction&&(Lt.nextAction.toLowerCase().includes("meeting")||Lt.nextAction.toLowerCase().includes("demo")||Lt.nextAction.toLowerCase().includes("call")));break}else if(Q==="email")switch(H){case"emailSent":ne=Ce.filter(rt=>rt.type==="email"&&rt.emailDate);break;case"accepted":ne=Ce.filter(rt=>rt.type==="email"&&["Interested","Meeting Proposed","Meeting Scheduled"].includes(rt.status));break;case"followups":const ze={};Ce.filter(rt=>rt.type==="email"&&rt.emailDate).forEach(rt=>{const Kt=rt.contactId?.toString();Kt&&(ze[Kt]=(ze[Kt]||0)+1)});const jt=Object.keys(ze).filter(rt=>ze[rt]>1);ne=Ce.filter(rt=>rt.type==="email"&&jt.includes(rt.contactId?.toString()));break;case"cip":ne=Ce.filter(rt=>rt.type==="email"&&rt.status==="CIP");break;case"meetingProposed":ne=Ce.filter(rt=>rt.type==="email"&&rt.status==="Meeting Proposed");break;case"scheduled":ne=Ce.filter(rt=>rt.type==="email"&&rt.status==="Meeting Scheduled");break;case"completed":ne=Ce.filter(rt=>rt.type==="email"&&rt.status==="Meeting Completed");break;case"sql":ne=Ce.filter(rt=>rt.type==="email"&&["SQL","Meeting Completed"].includes(rt.status));break}else if(Q==="linkedin")switch(H){case"connectionSent":ne=Ce.filter(rt=>rt.type==="linkedin"&&(rt.lnRequestSent==="Yes"||rt.lnRequestSent===!0));break;case"accepted":ne=Ce.filter(rt=>rt.type==="linkedin"&&(rt.connected==="Yes"||rt.connected===!0));break;case"followups":const ze={};Ce.filter(rt=>rt.type==="linkedin").forEach(rt=>{const Kt=rt.contactId?.toString();Kt&&(ze[Kt]=(ze[Kt]||0)+1)});const jt=Object.keys(ze).filter(rt=>ze[rt]>1);ne=Ce.filter(rt=>rt.type==="linkedin"&&jt.includes(rt.contactId?.toString()));break;case"cip":ne=Ce.filter(rt=>rt.type==="linkedin"&&rt.status==="CIP");break;case"meetingProposed":ne=Ce.filter(rt=>rt.type==="linkedin"&&rt.status==="Meeting Proposed");break;case"scheduled":ne=Ce.filter(rt=>rt.type==="linkedin"&&rt.status==="Meeting Scheduled");break;case"completed":ne=Ce.filter(rt=>rt.type==="linkedin"&&rt.status==="Meeting Completed");break;case"sql":ne=Ce.filter(rt=>rt.type==="linkedin"&&["SQL","Meeting Completed"].includes(rt.status));break}const ve=[...new Set(ne.map(ze=>ze.contactId).filter(Boolean))],Ge=new Map;ve.length>0&&(await Promise.all(ve.slice(0,100).map(jt=>Vt.get(`/contacts/${jt}`).catch(()=>null)))).forEach((jt,rt)=>{jt?.data?.success&&Ge.set(ve[rt],jt.data.data)});const vt=ne.map(ze=>({...ze,contact:Ge.get(ze.contactId?.toString())||null}));P(vt)}}catch(we){console.error("Error fetching stage data:",we),P([])}finally{ae(!1)}},W=B.useMemo(()=>{if(!D)return["call","email","linkedin"];const H=N.find(se=>se._id===D);if(!H?.channels)return["call","email","linkedin"];const Q=[];return H.channels.coldCalling&&Q.push("call"),H.channels.coldEmail&&Q.push("email"),H.channels.linkedInOutreach&&Q.push("linkedin"),Q.length>0?Q:["call","email","linkedin"]},[D,N]),pe=B.useMemo(()=>[{id:"overview",label:"Overview"},{id:"pipeline",label:"Pipeline"},{id:"linkedin",label:"LinkedIn"},{id:"calls",label:"Cold Calls"},{id:"email",label:"Email"},{id:"team",label:"Team Performance"}].filter(Q=>["overview","pipeline","team"].includes(Q.id)?!0:Q.id==="linkedin"?W.includes("linkedin"):Q.id==="calls"?W.includes("call"):Q.id==="email"?W.includes("email"):!0),[W]);B.useEffect(()=>{const H=pe.map(Q=>Q.id);H.includes(v)||w(H[0]||"overview")},[pe,v]);const Le=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(e)return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((H,Q)=>t.jsx(Le,{},Q))})})});if(!o)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-600",children:"Having trouble loading the dashboard. Refresh the page."}),t.jsx("button",{onClick:_e,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})});const Ae=({title:H,value:Q,subtitle:se,icon:de,color:we="blue",compact:Ce=!1})=>{const ne={blue:{bg:"from-blue-50 to-indigo-50",border:"border-blue-100",icon:"text-indigo-600",badge:"text-blue-700 bg-white/70 border-blue-100"},green:{bg:"from-emerald-50 to-teal-50",border:"border-emerald-100",icon:"text-emerald-600",badge:"text-emerald-700 bg-white/70 border-emerald-100"},purple:{bg:"from-purple-50 to-indigo-50",border:"border-purple-100",icon:"text-purple-600",badge:"text-purple-700 bg-white/70 border-purple-100"},orange:{bg:"from-amber-50 to-orange-50",border:"border-amber-100",icon:"text-amber-600",badge:"text-amber-700 bg-white/70 border-amber-100"}},ve=ne[we]||ne.blue;return Ce?t.jsxs("div",{className:`bg-gradient-to-br ${ve.bg} rounded-lg border ${ve.border} shadow-sm p-4 hover:shadow-md transition-shadow h-full`,children:[t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsx("div",{className:`w-8 h-8 rounded-lg bg-white/80 border ${ve.border} flex items-center justify-center shadow-xs`,children:typeof de=="object"&&de.props?Mo.cloneElement(de,{className:"w-4 h-4"}):de})}),t.jsx("div",{className:"text-xl font-bold text-gray-900 leading-tight mb-1",children:Q}),t.jsx("div",{className:"text-xs font-medium text-gray-700",children:H}),se&&t.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:se})]}):t.jsxs("div",{className:`bg-gradient-to-br ${ve.bg} rounded-xl border ${ve.border} shadow-sm p-6 hover:shadow-md transition-shadow`,children:[t.jsx("div",{className:"flex items-center justify-between mb-3",children:t.jsx("div",{className:`w-12 h-12 rounded-lg bg-white/80 border ${ve.border} flex items-center justify-center shadow-xs`,children:de})}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Q}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:H}),se&&t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:se})]})},V=({title:H,data:Q,color:se="blue",funnelType:de="call",totalProspects:we=null,memberId:Ce=null})=>{let ne=[];Q.prospectData===void 0&&we!==null&&(Q={...Q,prospectData:we}),Q.callsAttempted!==void 0||Q.callSent!==void 0?(ne=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"callsAttempted",label:"Calls Attempted",clickable:!0},{key:"callsConnected",label:"Calls Connected",clickable:!0},{key:"decisionMakerReached",label:"Decision Maker Reached",clickable:!0},{key:"interested",label:"Interested",clickable:!0},{key:"detailsShared",label:"Details Shared",clickable:!0},{key:"demoBooked",label:"Demo Booked",clickable:!0},{key:"demoCompleted",label:"Demo Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}],Q.callSent!==void 0&&Q.callsAttempted===void 0&&(ne=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"callSent",label:"Call Sent",clickable:!0},{key:"accepted",label:"Accepted",clickable:!0},{key:"followups",label:"Followups",clickable:!0},{key:"cip",label:"CIP",clickable:!0},{key:"meetingProposed",label:"Meeting Proposed",clickable:!0},{key:"scheduled",label:"Scheduled",clickable:!0},{key:"completed",label:"Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}])):Q.emailSent!==void 0?ne=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"emailSent",label:"Email Sent",clickable:!0},{key:"accepted",label:"Accepted",clickable:!0},{key:"followups",label:"Followups",clickable:!0},{key:"cip",label:"CIP",clickable:!0},{key:"meetingProposed",label:"Meeting Proposed",clickable:!0},{key:"scheduled",label:"Scheduled",clickable:!0},{key:"completed",label:"Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}]:Q.connectionSent!==void 0&&(ne=[{key:"prospectData",label:"Prospect Data",clickable:!0},{key:"connectionSent",label:"Connection Sent",clickable:!0},{key:"accepted",label:"Accepted",clickable:!0},{key:"followups",label:"Followups",clickable:!0},{key:"cip",label:"CIP",clickable:!0},{key:"meetingProposed",label:"Meeting Proposed",clickable:!0},{key:"scheduled",label:"Scheduled",clickable:!0},{key:"completed",label:"Completed",clickable:!0},{key:"sql",label:"SQL",clickable:!0}]),ne=ne.filter(rt=>rt.key);const ve=Q.prospectData||(Q.prospectData===0?0:1),Ge={blue:{primary:"rgb(59, 130, 246)",light:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 0.3)",hover:"rgba(59, 130, 246, 0.2)"},green:{primary:"rgb(34, 197, 94)",light:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",hover:"rgba(34, 197, 94, 0.2)"},purple:{primary:"rgb(168, 85, 247)",light:"rgba(168, 85, 247, 0.1)",border:"rgba(168, 85, 247, 0.3)",hover:"rgba(168, 85, 247, 0.2)"}},vt=Ge[se]||Ge.blue,ze=(rt,Kt)=>rt===0?100:Math.max(15,100-rt*10),jt=rt=>{if(rt.key==="prospectData"){me(rt.key,de,Q,Ce);return}rt.clickable&&(Q[rt.key]||0)>0?me(rt.key,de,Q,Ce):rt.clickable&&(ke({type:"info",message:`No records found for ${rt.label} stage`}),setTimeout(()=>ke(null),3e3))};return t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow h-full",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4 text-center",children:H}),t.jsx("div",{className:"flex flex-col items-center space-y-0",children:ne.map((rt,Kt)=>{const Lt=rt.key==="prospectData"?Q[rt.key]!==void 0?Q[rt.key]:ve:Q[rt.key]||0,ks=ve>0?(Lt/ve*100).toFixed(1):0,_s=ze(Kt,ne.length),ms=ve>0?Lt/ve*_s:0,ws=rt.clickable;return t.jsxs("div",{className:"relative w-full flex flex-col items-center",children:[t.jsxs("div",{onClick:()=>jt(rt),className:`relative transition-all duration-300 ${ws?"cursor-pointer hover:scale-[1.03] group":"cursor-default"}`,style:{width:`${_s}%`,minHeight:"28px",display:"flex",alignItems:"center",justifyContent:"center"},title:ws?Lt>0?`Click to view ${Lt} ${rt.label.toLowerCase()} records`:`Click to view ${rt.label.toLowerCase()}`:"",children:[t.jsx("div",{className:`absolute inset-0 transition-all duration-300 ${ws?"group-hover:brightness-110 group-hover:shadow-md":""}`,style:{clipPath:Kt===0?"polygon(0 0, 100% 0, 95% 100%, 5% 100%)":Kt===ne.length-1?"polygon(15% 0, 85% 0, 100% 100%, 0 100%)":"polygon(8% 0, 92% 0, 96% 100%, 4% 100%)",backgroundColor:vt.light,border:`2px solid ${vt.border}`,borderBottom:Kt<ne.length-1?"none":`2px solid ${vt.border}`}}),ms>0&&t.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 transition-all duration-500",style:{width:`${Math.max(20,ms/_s*100)}%`,height:"100%",backgroundColor:vt.primary,clipPath:Kt===0?"polygon(0 0, 100% 0, 95% 100%, 5% 100%)":Kt===ne.length-1?"polygon(15% 0, 85% 0, 100% 100%, 0 100%)":"polygon(8% 0, 92% 0, 96% 100%, 4% 100%)",opacity:.85}}),t.jsxs("div",{className:"relative z-10 w-full px-2 py-1 text-center",children:[t.jsxs("div",{className:`text-xs font-bold mb-0.5 ${ws?"text-gray-800":"text-gray-600"}`,children:[rt.label,ws&&t.jsxs("svg",{className:"w-2.5 h-2.5 inline-block ml-1 opacity-70",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})]}),t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx("span",{className:"text-xs font-bold text-gray-900",children:Lt.toLocaleString()}),t.jsxs("span",{className:"text-xs text-gray-500",children:["(",ks,"%)"]})]})]})]}),Kt<ne.length-1&&t.jsx("div",{className:"w-0.5",style:{height:"4px",backgroundColor:vt.primary,opacity:.3}})]},rt.key)})}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-600 mb-1 text-xs font-medium",children:"Conversion"}),t.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[ve>0?(Q.sql/ve*100).toFixed(1):0,"%"]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-gray-600 mb-1 text-xs font-medium",children:"Meetings"}),t.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[ve>0?(Q.scheduled/ve*100).toFixed(1):0,"%"]})]})]})})]})};return t.jsxs("div",{className:"min-h-screen bg-gray-50 relative",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-20 shadow-sm backdrop-blur-sm bg-white/95",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>{if(D||o?.project?.id){const H=D||o.project.id;l(`/projects/${H}`)}else l("/projects")},className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors",title:D||o?.project?.id?"Back to Prospect Management":"Back to Projects",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Prospect Analytics Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.project?`Analytics for ${o.project.companyName}`:"Comprehensive insights across all projects"})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("select",{value:D,onChange:H=>te(H.target.value),className:"px-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white min-w-[200px]",children:[t.jsx("option",{value:"",children:"All Projects"}),N.map(H=>t.jsx("option",{value:H._id,children:H.companyName},H._id))]}),o.project&&t.jsx("button",{onClick:()=>l(`/projects/${o.project.id}`),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"View Project"})]})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:pe.map(H=>t.jsx("button",{onClick:()=>w(H.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${v===H.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:H.label},H.id))})]})}),re&&t.jsx("div",{className:"fixed top-20 right-4 z-50",style:{animation:"slideInRight 0.3s ease-out"},children:t.jsx("div",{className:`px-4 py-3 rounded-lg shadow-xl border-2 ${re.type==="info"?"bg-blue-50 border-blue-200 text-blue-800":re.type==="error"?"bg-red-50 border-red-200 text-red-800":"bg-green-50 border-green-200 text-green-800"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[re.type==="info"&&t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"text-sm font-medium",children:re.message}),t.jsx("button",{onClick:()=>ke(null),className:"ml-2 text-current opacity-70 hover:opacity-100 transition-opacity",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}),t.jsx("style",{children:`
        @keyframes slideInRight {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
      `}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 relative z-0",children:[v==="overview"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:[t.jsx(Ae,{title:"Total Prospects",value:o.overview.totalProspects.toLocaleString(),icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),color:"blue",compact:!0}),t.jsx(Ae,{title:"Total Activities",value:o.overview.totalActivities.toLocaleString(),subtitle:"Calls, emails & LinkedIn",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"green",compact:!0}),t.jsx(Ae,{title:"Win Rate",value:`${o.pipeline.conversion.winRate}%`,subtitle:`${o.pipeline.conversion.won} won`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"purple",compact:!0}),t.jsx(Ae,{title:"Meeting Rate",value:`${o.pipeline.conversion.meetingRate}%`,subtitle:`${o.pipeline.conversion.meetings} meetings`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),color:"orange",compact:!0}),t.jsx(Ae,{title:"SQL Rate",value:o.overview.totalProspects>0?`${(o.pipeline.conversion.sql/o.overview.totalProspects*100).toFixed(1)}%`:"0%",subtitle:`${o.pipeline.conversion.sql} SQL leads`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),color:"blue",compact:!0}),t.jsx(Ae,{title:"CIP Rate",value:o.overview.totalProspects>0?`${(o.pipeline.conversion.cip/o.overview.totalProspects*100).toFixed(1)}%`:"0%",subtitle:`${o.pipeline.conversion.cip} CIP prospects`,icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),color:"green",compact:!0}),t.jsx(Ae,{title:"Avg Activities/Prospect",value:o.overview.totalProspects>0?(o.overview.totalActivities/o.overview.totalProspects).toFixed(1):"0",subtitle:"Average engagement",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),color:"purple",compact:!0}),t.jsx(Ae,{title:"Lost Deals",value:o.pipeline.conversion.lost||0,subtitle:"Deals lost",icon:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),color:"orange",compact:!0})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Funnel Analytics"}),t.jsx("div",{className:`${W.length===1?"flex justify-center":W.length===2?"flex justify-center gap-6":"overflow-x-auto"}`,children:t.jsxs("div",{className:`${W.length===1?"w-80":W.length===2?"flex gap-6":"flex gap-6 min-w-max pb-2"}`,children:[W.includes("call")&&t.jsx("div",{className:`${W.length===1||W.length===2?"w-80":"flex-shrink-0 w-80"}`,children:t.jsx(V,{title:"Cold Calling Funnel",data:o.funnels.coldCalling,color:"green",funnelType:"call",totalProspects:o.overview?.totalProspects})}),W.includes("email")&&t.jsx("div",{className:`${W.length===1||W.length===2?"w-80":"flex-shrink-0 w-80"}`,children:t.jsx(V,{title:"Email Funnel",data:o.funnels.email,color:"blue",funnelType:"email",totalProspects:o.overview?.totalProspects})}),W.includes("linkedin")&&t.jsx("div",{className:`${W.length===1||W.length===2?"w-80":"flex-shrink-0 w-80"}`,children:t.jsx(V,{title:"LinkedIn Funnel",data:o.funnels.linkedin,color:"purple",funnelType:"linkedin",totalProspects:o.overview?.totalProspects})})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Trends (Last 7 Days)"}),o.activities.trends.labels.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(a7,{data:{labels:o.activities.trends.labels,datasets:[...W.includes("call")?[{label:"Calls",data:o.activities.trends.call,borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4}]:[],...W.includes("email")?[{label:"Emails",data:o.activities.trends.email,borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4}]:[],...W.includes("linkedin")?[{label:"LinkedIn",data:o.activities.trends.linkedin,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4}]:[]]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Distribution"}),o.activities.byType.length>0?t.jsx("div",{className:"h-64",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx(ap,{data:{labels:o.activities.byType.filter(H=>{const Q=H.type.toLowerCase();return Q==="call"&&W.includes("call")||Q==="email"&&W.includes("email")||Q==="linkedin"&&W.includes("linkedin")}).map(H=>H.type.charAt(0).toUpperCase()+H.type.slice(1)),datasets:[{data:o.activities.byType.filter(H=>{const Q=H.type.toLowerCase();return Q==="call"&&W.includes("call")||Q==="email"&&W.includes("email")||Q==="linkedin"&&W.includes("linkedin")}).map(H=>H.count),backgroundColor:[...W.includes("call")?["rgb(34, 197, 94)"]:[],...W.includes("email")?["rgb(59, 130, 246)"]:[],...W.includes("linkedin")?["rgb(168, 85, 247)"]:[]]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Prospect Stage Distribution"}),o.prospects.stageDistribution.length>0?t.jsx("div",{className:"h-80",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx($u,{data:{labels:o.prospects.stageDistribution.map(H=>H.stage),datasets:[{label:"Prospects",data:o.prospects.stageDistribution.map(H=>H.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No stage data available"})})]}),o.topPerformers&&o.topPerformers.length>0&&t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performing Prospects"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Prospect"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Activities"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Last Activity"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:o.topPerformers.map(H=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:H.name}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.company}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-semibold",children:H.activityCount}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.lastActivity?new Date(H.lastActivity).toLocaleDateString():"N/A"})]},H.id))})]})})]})]}),v==="funnels"&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:`${W.length===1?"flex justify-center":W.length===2?"grid grid-cols-1 lg:grid-cols-2 gap-3 justify-center":"grid grid-cols-1 lg:grid-cols-3 gap-3"}`,children:[W.includes("call")&&t.jsx(V,{title:"Cold Calling Funnel",data:o.funnels.coldCalling,color:"green",funnelType:"call",totalProspects:o.overview?.totalProspects}),W.includes("email")&&t.jsx(V,{title:"Email Funnel",data:o.funnels.email,color:"blue",funnelType:"email",totalProspects:o.overview?.totalProspects}),W.includes("linkedin")&&t.jsx(V,{title:"LinkedIn Funnel",data:o.funnels.linkedin,color:"purple",funnelType:"linkedin",totalProspects:o.overview?.totalProspects})]}),M&&t.jsx("div",{className:"text-xs text-gray-500 text-center mt-2",children:"Click on any stage above to view detailed records"})]}),v==="pipeline"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Pipeline Analysis"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Monitor your sales pipeline and conversion metrics"})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Conversion Metrics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:[o.pipeline.conversion.winRate,"%"]}),t.jsx("div",{className:"text-base font-semibold text-gray-700 mb-1",children:"Win Rate"}),t.jsxs("div",{className:"text-sm text-gray-600",children:[o.pipeline.conversion.won," won / ",o.pipeline.conversion.total," total"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"text-4xl font-bold text-green-600 mb-2",children:[o.pipeline.conversion.meetingRate,"%"]}),t.jsx("div",{className:"text-base font-semibold text-gray-700 mb-1",children:"Meeting Rate"}),t.jsxs("div",{className:"text-sm text-gray-600",children:[o.pipeline.conversion.meetings," meetings scheduled"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 border border-orange-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:o.pipeline.conversion.sql}),t.jsx("div",{className:"text-base font-semibold text-gray-700 mb-1",children:"SQL Count"}),t.jsx("div",{className:"text-sm text-gray-600",children:"Sales Qualified Leads"})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Pipeline Stage Distribution"}),o.prospects.byStage&&o.prospects.byStage.length>0?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}),children:t.jsx($u,{data:{labels:o.prospects.byStage.map(H=>H.stage||H._id),datasets:[{label:"Prospects",data:o.prospects.byStage.map(H=>H.count),backgroundColor:"rgb(59, 130, 246)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}},scales:{x:{beginAtZero:!0,ticks:{stepSize:50}},y:{ticks:{font:{size:12}}}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No pipeline data available"})})]})]}),W.includes("linkedin")&&v==="linkedin"&&(()=>{const H=o.funnels.linkedin||{},Q=H.connectionSent||0,se=H.accepted||0,de=H.followups||0,we=H.scheduled||0,Ce=H.completed||0,ne=Q>0?se/Q*100:0,ve=de>0?de/Q*100:0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"LinkedIn"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Q.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Connection Requests Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ne.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[se.toLocaleString()," accepted"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Messages"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:de.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Messages Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ve.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[de.toLocaleString()," replies"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(we+Ce).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"LinkedIn Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx($u,{data:{labels:["Requests Sent","Accepted","Messages Sent","Replies","Meetings"],datasets:[{label:"LinkedIn Funnel",data:[Q,se,de,de,we+Ce],backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:Ge=>`${Ge.label}: ${Ge.parsed.y.toLocaleString()}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:12}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Connection Acceptance Rate"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(ap,{data:{labels:["Accepted","Not Accepted"],datasets:[{label:"Connection Requests",data:[se,Math.max(0,Q-se)],backgroundColor:["#10B981","#EF4444"],borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:Ge=>{const vt=Ge.label||"",ze=Ge.parsed||0,jt=Q>0?ze/Q*100:0;return`${vt}: ${ze.toLocaleString()} (${jt.toFixed(1)}%)`}}}}}})})})]})]})]})})(),W.includes("call")&&v==="calls"&&(()=>{const H=o.funnels.coldCalling||{},Q=H.callsAttempted||0,se=H.callsConnected||0,de=H.decisionMakerReached||0,we=H.interested||0,Ce=(H.demoBooked||0)+(H.demoCompleted||0),ne=Q>0?se/Q*100:0,ve=H.callStatusBreakdown||{},Ge=Object.keys(ve).filter(rt=>ve[rt]>0&&ve[rt]!==void 0),vt=Ge.map(rt=>ve[rt]),ze={Interested:"#10B981","Not Interested":"#EF4444",Ring:"#F59E0B",Busy:"#F97316","Call Back":"#3B82F6","Hang Up":"#EF4444","Switch Off":"#6B7280",Future:"#8B5CF6","Details Shared":"#06B6D4","Demo Booked":"#10B981",Invalid:"#9CA3AF",Existing:"#6366F1","Demo Completed":"#059669","No Status":"#D1D5DB"},jt=Ge.map(rt=>ze[rt]||"#9CA3AF");return Ge.length===0&&Q>0&&console.log("Call Status Breakdown Debug:",{callStatusBreakdown:ve,callData:H,callsMade:Q,statusLabels:Ge}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Calls"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Q.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Calls Made"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ne.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[se.toLocaleString()," connected"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Decision"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:de.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Decision Maker Connects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Interested"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:we.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Interested"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Ce.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Cold Call Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx($u,{data:{labels:["Calls Made","Connected","Decision Maker","Interested","Meetings"],datasets:[{label:"Cold Call Funnel",data:[Q,se,de,we,Ce],backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:rt=>`${rt.label}: ${rt.parsed.y.toLocaleString()}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:25}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Call Status Distribution"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:Ge.length>0?t.jsx(ap,{data:{labels:Ge,datasets:[{label:"Call Status",data:vt,backgroundColor:jt,borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle",color:"#374151"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,callbacks:{label:rt=>{const Kt=rt.label||"",Lt=rt.parsed||0,ks=vt.reduce((ms,ws)=>ms+ws,0),_s=ks>0?(Lt/ks*100).toFixed(1):0;return`${Kt}: ${Lt.toLocaleString()} (${_s}%)`}}}}}}):Q>0?t.jsxs("div",{className:"text-gray-500 text-sm text-center",children:[t.jsx("p",{children:"No call status data available"}),t.jsx("p",{className:"text-xs mt-2",children:"Calls have been made but status information is missing"})]}):t.jsx("div",{className:"text-gray-500 text-sm",children:"No calls made yet"})})})]})]})]})})(),W.includes("email")&&v==="email"&&(()=>{const H=o.funnels.email||{},Q=H.emailSent||0,se=H.accepted||0,de=H.scheduled||0,we=H.completed||0,Ce=H.sql||0,ne=Q>0?se/Q*100:0,ve=Q>0?Ce/Q*100:0,Ge=de+we;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Email"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Q.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Emails Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsxs("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ne.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[se.toLocaleString()," opened"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[ve.toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[Ce.toLocaleString()," replies"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:Ge.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-pink-50 rounded-xl border border-red-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full shadow-xs",children:"Bounce"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:"0.0%"}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Bounce Rate"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx($u,{data:{labels:["Emails Sent","Opened","Replied","Meetings"],datasets:[{label:"Email Funnel",data:[Q,se,Ce,Ge],backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:vt=>`${vt.label}: ${vt.parsed.y.toLocaleString()}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:10}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Status Distribution"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(ap,{data:{labels:["Replied","Opened","No Reply"],datasets:[{label:"Email Status",data:[Ce,Math.max(0,se-Ce),Math.max(0,Q-se)],backgroundColor:["#10B981","#3B82F6","#9CA3AF"],borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:vt=>{const ze=vt.label||"",jt=vt.parsed||0,rt=Q>0?jt/Q*100:0;return`${ze}: ${jt.toLocaleString()} (${rt.toFixed(1)}%)`}}}}}})})})]})]})]})})(),v==="team"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Team Performance"}),he?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):be.length>0?t.jsx("div",{className:`${be.length===1?"flex justify-center":be.length===2?"grid grid-cols-1 lg:grid-cols-2 gap-6":"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6"}`,children:be.map(H=>{const Q=o?.team?.performance?.find(se=>se.id===H.memberId);return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-100",children:[t.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-1",children:H.name}),t.jsx("p",{className:"text-xs text-gray-600",children:H.email}),Q&&t.jsxs("div",{className:"mt-2 flex gap-4 text-xs text-gray-600",children:[t.jsxs("span",{children:["Total: ",t.jsx("span",{className:"font-semibold text-gray-900",children:Q.totalActivities})]}),W.includes("call")&&t.jsxs("span",{children:["Calls: ",t.jsx("span",{className:"font-semibold text-gray-900",children:Q.calls})]}),W.includes("email")&&t.jsxs("span",{children:["Emails: ",t.jsx("span",{className:"font-semibold text-gray-900",children:Q.emails})]}),W.includes("linkedin")&&t.jsxs("span",{children:["LinkedIn: ",t.jsx("span",{className:"font-semibold text-gray-900",children:Q.linkedin})]})]})]}),t.jsxs("div",{className:"space-y-3",children:[W.includes("call")&&H.funnels.coldCalling&&t.jsx(V,{title:`${H.name} - Cold Calling`,data:H.funnels.coldCalling,color:"green",funnelType:"call",totalProspects:o.overview?.totalProspects,memberId:H.memberId}),W.includes("linkedin")&&H.funnels.linkedin&&t.jsx(V,{title:`${H.name} - LinkedIn`,data:H.funnels.linkedin,color:"purple",funnelType:"linkedin",totalProspects:o.overview?.totalProspects,memberId:H.memberId}),W.includes("email")&&H.funnels.email&&t.jsx(V,{title:`${H.name} - Email`,data:H.funnels.email,color:"blue",funnelType:"email",totalProspects:o.overview?.totalProspects,memberId:H.memberId})]})]},H.memberId)})}):t.jsx("div",{className:"text-center py-12 text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No team performance data available"})})]}),t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Time Period:"}),t.jsx("button",{onClick:()=>je("today"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${xe==="today"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Today"}),t.jsx("button",{onClick:()=>je("last7days"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${xe==="last7days"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Last 7 Days"}),t.jsx("button",{onClick:()=>je("lastMonth"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${xe==="lastMonth"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Last Month"})]})}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Trends"}),ue?t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):Z?.chartData?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-full flex items-center justify-center",children:"Loading chart..."}),children:t.jsx($u,{data:Z.chartData,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:"Activities by Type and Status"}},scales:{x:{stacked:!0},y:{stacked:!0,beginAtZero:!0}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activity Distribution by Channel"}),ue?t.jsx("div",{className:"h-96 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):Z?.pieData?t.jsx("div",{className:"h-96",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-full flex items-center justify-center",children:"Loading chart..."}),children:t.jsx(n7,{data:Z.pieData,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"},title:{display:!0,text:"Activities by Channel"}}}})})}):t.jsx("div",{className:"h-96 flex items-center justify-center text-gray-500",children:t.jsx("p",{className:"text-sm",children:"No activity data available"})})]})]})]}),M&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[100] flex items-center justify-center p-4",onClick:()=>{F(null),P([])},style:{position:"fixed",top:0,left:0,right:0,bottom:0},children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] flex flex-col relative z-[101]",onClick:H=>H.stopPropagation(),style:{position:"relative",zIndex:101},children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gradient-to-r from-gray-50 to-white",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900",children:M.memberId?(()=>{const Q=be.find(se=>{const de=se.memberId?.toString?se.memberId.toString():String(se.memberId),we=M.memberId?.toString?M.memberId.toString():String(M.memberId);return de===we})?.name||"Team Member";return M.stage==="prospectData"?`${Q} - All Prospects`:`${Q} - ${M.stage.charAt(0).toUpperCase()+M.stage.slice(1)} - ${M.funnelType==="call"?"Cold Calling":M.funnelType==="email"?"Email":"LinkedIn"} Funnel`})():M.stage==="prospectData"?"All Prospects":M.stage.charAt(0).toUpperCase()+M.stage.slice(1)+" - "+(M.funnelType==="call"?"Cold Calling":M.funnelType==="email"?"Email":"LinkedIn")+" Funnel"}),t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[O.length," ",M.stage==="prospectData"?"prospect":"record",O.length!==1?"s":""," found"]})]}),t.jsx("button",{onClick:()=>{F(null),P([])},className:"text-gray-400 hover:text-gray-600 transition-colors p-1 hover:bg-gray-100 rounded-lg",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:G?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-200 border-t-blue-600"})}):O.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-200 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:M.stage==="prospectData"?"Prospect":"Contact"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Company"}),M.stage==="prospectData"?t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Phone"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Stage"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Priority"})]}):t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Date"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Status"})]})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:O.map((H,Q)=>H.isProspect||M.stage==="prospectData"?t.jsxs("tr",{className:"hover:bg-blue-50/50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:H.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:H.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.email||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.firstPhone||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm",children:(H.displayStatus||H.stage)&&t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-purple-100 text-purple-800 rounded-full border border-purple-200",children:H.displayStatus||H.stage})}),t.jsx("td",{className:"px-4 py-3 text-sm",children:H.priority&&t.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full border ${H.priority==="High"?"bg-red-100 text-red-800 border-red-200":H.priority==="Medium"?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-gray-100 text-gray-800 border-gray-200"}`,children:H.priority})})]},Q):t.jsxs("tr",{className:"hover:bg-blue-50/50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:H.contact?.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:H.contact?.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.callDate||H.emailDate||H.linkedinDate?new Date(H.callDate||H.emailDate||H.linkedinDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):H.createdAt?new Date(H.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}),t.jsxs("td",{className:"px-4 py-3 text-sm",children:[H.status&&t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded-full border border-blue-200",children:H.status}),H.callStatus&&t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded-full border border-green-200",children:H.callStatus}),!H.status&&!H.callStatus&&t.jsx("span",{className:"text-xs text-gray-400",children:"-"})]})]},Q))})]})}):t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm font-medium",children:"No records found for this stage"})]})})]})})]})}const c7=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Line}))),Do=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Bar}))),qu=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Doughnut})));nl.register(Yc,Gc,Hc,il,Vc,bm,$c,qc,Wc);let R1=null,_b=0;const d7=60*1e3;function u7(){const[l,n]=B.useState(null),[a,o]=B.useState(!0),[s,e]=B.useState("executive"),m=B.useRef(!0);B.useEffect(()=>(m.current=!0,(async()=>{const me=Date.now();R1&&me-_b<d7?m.current&&(n(R1),o(!1)):await v()})(),()=>{m.current=!1}),[]);const v=async()=>{if(m.current)try{o(!0);const te=await Vt.get("/master-dashboard");if(te.data.success&&m.current){const me=te.data.data;n(me),R1=me,_b=Date.now()}}catch(te){console.error("Error fetching master dashboard data:",te)}finally{m.current&&o(!1)}},w=()=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 animate-pulse",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),t.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]});if(a)return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(8)].map((te,me)=>t.jsx(w,{},me))})})});if(!l)return t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-600",children:"Couldn't load the dashboard right now. Try refreshing."}),t.jsx("button",{onClick:v,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]})});const N=l?.executive||{},S=l?.rankings||{bestPerformingProjects:[],channelEfficiency:{linkedin:{acceptanceRate:0},call:{connectRate:0},email:{replyRate:0}},teamLeaderboard:[]},D=l?.alerts||{lowActivityProjects:[],highBounceProjects:[],missingFollowUps:[]},L=l?.dataQuality||{leadsAddedDaily:0,leadsAddedWeekly:0,validEmailPercent:0,validPhonePercent:0,duplicatePercent:0,dataQualityScore:0,totalProspects:0,validEmailCount:0,validPhoneCount:0,duplicateCount:0},M=l?.linkedin||{connectionRequestsSent:0,acceptanceRate:0,accepted:0,messagesSent:0,replies:0,replyRate:0,meetingsBooked:0},F=l?.coldCall||{callsMade:0,connectRate:0,connected:0,decisionMakerConnects:0,interested:0,meetingsBooked:0},O=l?.email||{emailsSent:0,bounceRate:0,bounced:0,replyRate:0,replied:0,positiveReplies:0,meetingsBooked:0},P=l?.followUp||{totalDue:0,completed:0,overdueCount:0,completionRate:0,slaCompliance:0,chartData:null,projectData:null},G=te=>{const me=typeof te=="string"?parseFloat(te):te;return typeof me!="number"||isNaN(me)||!isFinite(me)||me<0?0:Math.max(0,Math.min(100,me))},ae=te=>te.map(me=>{const W=typeof me=="string"?parseFloat(me):me;return typeof W!="number"||isNaN(W)||!isFinite(W)?0:W}),re=[S?.channelEfficiency?.linkedin?.acceptanceRate,S?.channelEfficiency?.call?.connectRate,S?.channelEfficiency?.email?.replyRate].map(te=>G(te||0)),ke={labels:["LinkedIn","Call","Email"],datasets:[{label:"Efficiency Rate (%)",data:ae(re),backgroundColor:["#3B82F6","#10B981","#F59E0B"],borderColor:["#2563EB","#059669","#D97706"],borderWidth:2}]},xe={labels:(S?.teamLeaderboard||[]).slice(0,10).map(te=>te?.name||"Unknown"),datasets:[{label:"Total Activities",data:(S?.teamLeaderboard||[]).slice(0,10).map(te=>{const me=te?.totalActivities||0;return typeof me=="number"&&isFinite(me)?me:0}),backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:1}]},je=[L?.validEmailPercent||0,L?.validPhonePercent||0,L?.duplicatePercent||0].map(te=>G(te)),Z={labels:["Valid Email","Valid Phone","Duplicates"],datasets:[{data:ae(je),backgroundColor:["#10B981","#3B82F6","#EF4444"],borderWidth:2,borderColor:"#ffffff",hoverOffset:4}]},ce={labels:["Requests Sent","Accepted","Messages Sent","Replies","Meetings"],datasets:[{label:"LinkedIn Funnel",data:[M?.connectionRequestsSent||0,M?.accepted||0,M?.messagesSent||0,M?.replies||0,M?.meetingsBooked||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#0077B5","#00A0DC","#008CC9","#006699","#004D73"],borderColor:["#005885","#0077B5","#006699","#004D73","#003D5C"],borderWidth:2}]},ue={labels:["Accepted","Not Accepted"],datasets:[{label:"Connection Requests",data:[M?.accepted||0,Math.max(0,(M?.connectionRequestsSent||0)-(M?.accepted||0))].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#10B981","#EF4444"],borderWidth:2}]},Re={labels:["Calls Made","Connected","Decision Maker","Interested","Meetings"],datasets:[{label:"Cold Call Funnel",data:[F?.callsMade||0,F?.connected||0,F?.decisionMakerConnects||0,F?.interested||0,F?.meetingsBooked||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#3B82F6","#2563EB","#1D4ED8","#1E40AF","#1E3A8A"],borderColor:["#2563EB","#1D4ED8","#1E40AF","#1E3A8A","#1E3A8A"],borderWidth:2}]},be={labels:["Connected","Not Connected"],datasets:[{label:"Call Connections",data:[F?.connected||0,Math.max(0,(F?.callsMade||0)-(F?.connected||0))].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#10B981","#EF4444"],borderWidth:2}]},oe={labels:["Emails Sent","Replied","Positive Replies","Meetings"],datasets:[{label:"Email Funnel",data:[O?.emailsSent||0,O?.replied||0,O?.positiveReplies||0,O?.meetingsBooked||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#8B5CF6","#7C3AED","#6D28D9","#5B21B6"],borderColor:["#7C3AED","#6D28D9","#5B21B6","#4C1D95"],borderWidth:2}]},he={labels:["Replied","Bounced","No Reply"],datasets:[{label:"Email Status",data:[O?.replied||0,O?.bounced||0,Math.max(0,(O?.emailsSent||0)-(O?.replied||0)-(O?.bounced||0))].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#10B981","#EF4444","#9CA3AF"],borderWidth:2,borderColor:"#ffffff"}]},ye={labels:["Touches","Meetings"],datasets:[{label:"This Week",data:[N?.totalTouchesThisWeek||0,N?.totalMeetingsBookedThisWeek||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:"#3B82F6",borderColor:"#2563EB",borderWidth:2},{label:"This Month",data:[N?.totalTouchesThisMonth||0,N?.totalMeetingsBookedThisMonth||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:"#10B981",borderColor:"#059669",borderWidth:2}]},Te={labels:["LinkedIn","Cold Call","Email"],datasets:[{label:"Activities by Channel",data:[M?.connectionRequestsSent||0,F?.callsMade||0,O?.emailsSent||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#0077B5","#3B82F6","#8B5CF6"],borderWidth:2,borderColor:"#ffffff",hoverOffset:4}]},fe={labels:["Conversion Rate","SLA Compliance"],datasets:[{label:"Performance Metrics (%)",data:[G(N?.weightedConversionRate||0),G(N?.slaCompliance||0)],backgroundColor:["#10B981","#3B82F6"],borderColor:["#059669","#2563EB"],borderWidth:2}]},_e={labels:["Leads in Play","Total Touches","Meetings Booked"],datasets:[{label:"Overall Funnel",data:[N?.totalLeadsInPlay||0,N?.totalTouchesThisMonth||0,N?.totalMeetingsBookedThisMonth||0].map(te=>typeof te=="number"&&isFinite(te)?te:0),backgroundColor:["#3B82F6","#8B5CF6","#10B981"],borderColor:["#2563EB","#7C3AED","#059669"],borderWidth:2}]},We=[{id:"executive",label:"Executive Summary"},{id:"rankings",label:"Rankings"},{id:"alerts",label:"Alerts"},{id:"data",label:"Data Quality"},{id:"linkedin",label:"LinkedIn"},{id:"calls",label:"Cold Calls"},{id:"email",label:"Email"},{id:"followup",label:"Follow-ups"}];return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-20 shadow-sm backdrop-blur-sm bg-white/95",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>window.history.back(),className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors",title:"Go Back",children:t.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Master Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"All Projects Summary & Analytics"})]})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium text-sm text-gray-700",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})})]}),t.jsx("div",{className:"flex items-center gap-6 overflow-x-auto pb-2 border-b border-gray-200",children:We.map(te=>t.jsx("button",{onClick:()=>e(te.id),className:`flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap transition-colors ${s===te.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:te.label},te.id))})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 relative z-0",children:[s==="executive"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Projects"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N?.activeProjects||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Active Projects"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Leads"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(N?.totalLeadsInPlay||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Leads in Play"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl border border-green-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-green-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),t.jsx("span",{className:"text-xs font-semibold text-green-700 bg-white/70 border border-green-100 px-2 py-1 rounded-full shadow-xs",children:"Activity"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(N?.totalTouchesThisWeek||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Touches This Week"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N?.totalMeetingsBookedThisWeek||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings This Week"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-blue-50 rounded-xl border border-indigo-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-indigo-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-indigo-700 bg-white/70 border border-indigo-100 px-2 py-1 rounded-full shadow-xs",children:"Activity"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(N?.totalTouchesThisMonth||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Touches This Month"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-rose-50 to-pink-50 rounded-xl border border-rose-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-rose-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-rose-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-rose-700 bg-white/70 border border-rose-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:N?.totalMeetingsBookedThisMonth||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings This Month"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-cyan-50 rounded-xl border border-teal-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-teal-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),t.jsx("span",{className:"text-xs font-semibold text-teal-700 bg-white/70 border border-teal-100 px-2 py-1 rounded-full shadow-xs",children:"Conversion"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(N?.weightedConversionRate||0).toFixed(1),"%"]}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Weighted Conversion Rate"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl border border-orange-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-orange-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-orange-700 bg-white/70 border border-orange-100 px-2 py-1 rounded-full shadow-xs",children:"Compliance"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(N?.slaCompliance||0).toFixed(1),"%"]}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"SLA Compliance"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Week vs Month Performance"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:ye,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{position:"top",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:te=>{const me=typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0;return`${te.dataset.label}: ${me.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const me=typeof te=="number"?te:parseFloat(te);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1}},x:{grid:{display:!1}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Activity by Channel"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(qu,{data:Te,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:te=>{const me=te.label||"",W=te.parsed||0,pe=(M?.connectionRequestsSent||0)+(F?.callsMade||0)+(O?.emailsSent||0),Le=pe>0?W/pe*100:0;return`${me}: ${W.toLocaleString()} (${Le.toFixed(1)}%)`}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Overall Sales Funnel"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:_e,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>{const me=typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0;return`${te.label}: ${me.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const me=typeof te=="number"?te:parseFloat(te);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Key Performance Metrics"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:fe,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>{const me=G(te.parsed.y);return`${te.label}: ${me.toFixed(2)}%`}}}},scales:{y:{beginAtZero:!0,max:100,min:0,ticks:{callback:te=>`${G(te)}%`,stepSize:20,maxTicksLimit:6},afterDataLimits:te=>{te.max=100,te.min=0}},x:{grid:{display:!1}}}}})})})]})]})]}),s==="rankings"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Best Performing Projects"}),t.jsx("div",{className:"space-y-3",children:(S?.bestPerformingProjects||[]).slice(0,10).map((te,me)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${me===0?"bg-yellow-100 text-yellow-800":me===1?"bg-gray-100 text-gray-800":me===2?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:me+1}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:te.projectName}),t.jsxs("p",{className:"text-xs text-gray-500",children:[te.totalProspects," prospects"]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-semibold text-gray-900",children:te.meetingsPer100Leads.toFixed(1)}),t.jsx("p",{className:"text-xs text-gray-500",children:"meetings/100 leads"})]})]},me))})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Channel Efficiency Leaderboard"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:ke,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>`Efficiency: ${G(te.parsed.y).toFixed(2)}%`}}},scales:{y:{beginAtZero:!0,max:100,min:0,grace:0,ticks:{callback:te=>`${G(te)}%`,stepSize:20,maxTicksLimit:6,precision:0},afterDataLimits:te=>{te.max=100,te.min=0},afterBuildTicks:te=>{te.ticks=te.ticks.filter(me=>{const W=typeof me.value=="number"?me.value:parseFloat(me.value);return isFinite(W)&&W>=0&&W<=100})}},x:{grid:{display:!1}}}}})})}),t.jsxs("div",{className:"mt-4 space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg border border-blue-200",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"LinkedIn Acceptance"}),t.jsxs("span",{className:"font-bold text-lg text-blue-700",children:[G(S?.channelEfficiency?.linkedin?.acceptanceRate||0).toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-green-100 rounded-lg border border-green-200",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Call Connect Rate"}),t.jsxs("span",{className:"font-bold text-lg text-green-700",children:[G(S?.channelEfficiency?.call?.connectRate||0).toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-amber-50 to-amber-100 rounded-lg border border-amber-200",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Email Reply Rate"}),t.jsxs("span",{className:"font-bold text-lg text-amber-700",children:[G(S?.channelEfficiency?.email?.replyRate||0).toFixed(2),"%"]})]})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm lg:col-span-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Team Leaderboard"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:xe,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2.5,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>`Activities: ${typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0}`}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const me=typeof te=="number"?te:parseFloat(te);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1},afterBuildTicks:te=>{te.ticks=te.ticks.filter(me=>{const W=typeof me.value=="number"?me.value:parseFloat(me.value);return isFinite(W)&&W>=0})}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})}),t.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:(S?.teamLeaderboard||[]).slice(0,10).map((te,me)=>t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900 text-sm",children:te.name||"Unknown"}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[te.totalActivities," activities"]}),t.jsxs("div",{className:"mt-2 flex gap-2 text-xs",children:[t.jsxs("span",{className:"text-blue-600",children:[te.calls," calls"]}),t.jsxs("span",{className:"text-green-600",children:[te.emails," emails"]}),t.jsxs("span",{className:"text-purple-600",children:[te.linkedin," LI"]})]})]},me))})]})]})}),s==="alerts"&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Low Activity (Last 3 Days)"}),t.jsx("div",{className:"space-y-2",children:(D?.lowActivityProjects||[]).length>0?(D?.lowActivityProjects||[]).map((te,me)=>t.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900",children:te.projectName}),t.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[te.activityCount," activities / ",te.totalContacts," contacts"]})]},me)):t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No low activity projects"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"High Bounce/Wrong Data"})]}),t.jsx("div",{className:"space-y-2",children:(D?.highBounceProjects||[]).length>0?(D?.highBounceProjects||[]).map((te,me)=>t.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900",children:te.projectName}),t.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[te.errorRate.toFixed(1),"% error rate (",te.bounceCount," bounces, ",te.wrongPersonCount," wrong)"]})]},me)):t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No high bounce projects"})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Missing Follow-ups"}),t.jsx("div",{className:"space-y-2",children:(D?.missingFollowUps||[]).length>0?(D?.missingFollowUps||[]).map((te,me)=>t.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[t.jsx("p",{className:"font-medium text-gray-900",children:te.projectName}),t.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[te.overdueCount," overdue follow-ups"]})]},me)):t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No missing follow-ups"})})]})]})}),s==="data"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"Daily"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:L?.leadsAddedDaily||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Leads Added (Daily)"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Weekly"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:L?.leadsAddedWeekly||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Leads Added (Weekly)"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Quality"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(L?.validEmailPercent||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(L?.validEmailCount||0).toLocaleString()," of ",(L?.totalProspects||0).toLocaleString()]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Quality"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(L?.validPhonePercent||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(L?.validPhoneCount||0).toLocaleString()," of ",(L?.totalProspects||0).toLocaleString()]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 rounded-xl border border-red-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-red-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),t.jsx("span",{className:"text-xs font-semibold text-red-700 bg-white/70 border border-red-100 px-2 py-1 rounded-full shadow-xs",children:"Duplicates"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(L?.duplicatePercent||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(L?.duplicateCount||0).toLocaleString()," duplicates"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Score"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(L?.dataQualityScore||0).toFixed(1),"%"]}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Data Quality Score"})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Data Quality Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-80 flex items-center justify-center",children:t.jsx(qu,{data:Z,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",layout:{padding:{top:20,bottom:20}},plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:te=>{const me=te.label||"",W=G(te.parsed||0),pe=je.reduce((Ae,V)=>Ae+G(V),0),Le=pe>0?G(te.parsed||0)/pe*100:0;return`${me}: ${W.toFixed(2)}% (${Le.toFixed(1)}% of total)`}}}}}})})})]})]}),s==="linkedin"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-blue-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})})}),t.jsx("span",{className:"text-xs font-semibold text-blue-700 bg-white/70 border border-blue-100 px-2 py-1 rounded-full shadow-xs",children:"LinkedIn"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(M?.connectionRequestsSent||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Connection Requests Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl border border-emerald-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-emerald-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-white/70 border border-emerald-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(M?.acceptanceRate||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(M?.accepted||0).toLocaleString()," accepted"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border border-purple-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-purple-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),t.jsx("span",{className:"text-xs font-semibold text-purple-700 bg-white/70 border border-purple-100 px-2 py-1 rounded-full shadow-xs",children:"Messages"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:(M?.messagesSent||0).toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Messages Sent"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl border border-cyan-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-cyan-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),t.jsx("span",{className:"text-xs font-semibold text-cyan-700 bg-white/70 border border-cyan-100 px-2 py-1 rounded-full shadow-xs",children:"Rate"})]}),t.jsxs("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:[G(M?.replyRate||0).toFixed(1),"%"]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[(M?.replies||0).toLocaleString()," replies"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl border border-amber-100 shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/80 border border-amber-100 flex items-center justify-center shadow-xs",children:t.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-xs font-semibold text-amber-700 bg-white/70 border border-amber-100 px-2 py-1 rounded-full shadow-xs",children:"Meetings"})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900 leading-tight",children:M?.meetingsBooked||0}),t.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Meetings Booked"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"LinkedIn Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:ce,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>{const me=typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0;return`${te.label}: ${me.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const me=typeof te=="number"?te:parseFloat(te);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Connection Acceptance Rate"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(qu,{data:ue,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:te=>{const me=te.label||"",W=te.parsed||0,pe=M?.connectionRequestsSent||0,Le=pe>0?W/pe*100:0;return`${me}: ${W.toLocaleString()} (${Le.toFixed(1)}%)`}}}}}})})})]})]})]}),s==="calls"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Calls Made"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:(F?.callsMade||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Connect Rate"}),t.jsxs("p",{className:"text-4xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent",children:[G(F?.connectRate||0).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-medium",children:[(F?.connected||0).toLocaleString()," connected"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Decision Maker Connects"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:(F?.decisionMakerConnects||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-blue-50 border-2 border-cyan-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Interested"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent",children:(F?.interested||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Meetings Booked"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent",children:F?.meetingsBooked||0})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Cold Call Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:Re,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>{const me=typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0;return`${te.label}: ${me.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const me=typeof te=="number"?te:parseFloat(te);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Call Connection Rate"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(qu,{data:be,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:te=>{const me=te.label||"",W=te.parsed||0,pe=F?.callsMade||0,Le=pe>0?W/pe*100:0;return`${me}: ${W.toLocaleString()} (${Le.toFixed(1)}%)`}}}}}})})})]})]})]}),s==="email"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Emails Sent"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:(O?.emailsSent||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 border-2 border-red-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Bounce Rate"}),t.jsxs("p",{className:"text-4xl font-bold bg-gradient-to-r from-red-600 to-orange-600 bg-clip-text text-transparent",children:[G(O?.bounceRate||0).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-medium",children:[(O?.bounced||0).toLocaleString()," bounced"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Reply Rate"}),t.jsxs("p",{className:"text-4xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent",children:[G(O?.replyRate||0).toFixed(1),"%"]}),t.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-medium",children:[(O?.replied||0).toLocaleString()," replied"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Positive Replies"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:(O?.positiveReplies||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-xl p-6 shadow-md hover:shadow-lg transition-all duration-200",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Meetings Booked"}),t.jsx("p",{className:"text-4xl font-bold bg-gradient-to-r from-amber-600 to-yellow-600 bg-clip-text text-transparent",children:O?.meetingsBooked||0})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Funnel Overview"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:oe,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2,layout:{padding:{top:10,bottom:10}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:te=>{const me=typeof te.parsed.y=="number"&&isFinite(te.parsed.y)?te.parsed.y:0;return`${te.label}: ${me.toLocaleString()}`}}}},scales:{y:{beginAtZero:!0,ticks:{callback:te=>{const me=typeof te=="number"?te:parseFloat(te);return typeof me=="number"&&isFinite(me)?Math.round(me):0},stepSize:1}},x:{grid:{display:!1},ticks:{maxRotation:45,minRotation:45,font:{size:10}}}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Email Status Breakdown"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(qu,{data:he,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,cutout:"60%",plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0}},tooltip:{callbacks:{label:te=>{const me=te.label||"",W=te.parsed||0,pe=O?.emailsSent||0,Le=pe>0?W/pe*100:0;return`${me}: ${W.toLocaleString()} (${Le.toFixed(1)}%)`}}}}}})})})]})]})]}),s==="followup"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Total Due"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(P?.totalDue||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Completed"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(P?.completed||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Overdue Count"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(P?.overdueCount||0).toLocaleString()})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Completion Rate"}),t.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[(P?.completionRate||0).toFixed(2),"%"]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"SLA Compliance"}),t.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[(P?.slaCompliance||0).toFixed(2),"%"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-up Status Distribution"}),P?.totalDue>0?t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(qu,{data:{labels:["Completed","Overdue","Pending"],datasets:[{label:"Follow-ups",data:[P.completed||0,P.overdueCount||0,(P.totalDue||0)-(P.completed||0)-(P.overdueCount||0)],backgroundColor:["#10B981","#EF4444","#F59E0B"],borderColor:["#059669","#DC2626","#D97706"],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12}}},tooltip:{callbacks:{label:function(te){const me=te.label||"",W=te.parsed||0,pe=te.dataset.data.reduce((Ae,V)=>Ae+V,0),Le=pe>0?(W/pe*100).toFixed(1):0;return`${me}: ${W} (${Le}%)`}}}}}})})}):t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:"No follow-up data available"})]}),P?.projectData&&P.projectData.labels.length>0?t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-ups by Project (Top 10)"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(Do,{data:{labels:P.projectData.labels,datasets:[{label:"Completed",data:P.projectData.completed,backgroundColor:"#10B981",borderColor:"#059669",borderWidth:1},{label:"Overdue",data:P.projectData.overdue,backgroundColor:"#EF4444",borderColor:"#DC2626",borderWidth:1},{label:"Pending",data:P.projectData.total.map((te,me)=>te-P.projectData.completed[me]-P.projectData.overdue[me]),backgroundColor:"#F59E0B",borderColor:"#D97706",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:10,font:{size:12}}},tooltip:{mode:"index",intersect:!1}},scales:{x:{stacked:!0,ticks:{maxRotation:45,minRotation:45,font:{size:10}}},y:{stacked:!0,beginAtZero:!0,ticks:{stepSize:1}}}}})})})]}):t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-ups by Project"}),t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:"No project data available"})]}),P?.chartData&&P.chartData.labels.length>0?t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm lg:col-span-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-up Trends Over Time"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(c7,{data:{labels:P.chartData.labels,datasets:[{label:"Total Due",data:P.chartData.total,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!0,tension:.4},{label:"Completed",data:P.chartData.completed,borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:2,fill:!0,tension:.4},{label:"Overdue",data:P.chartData.overdue,borderColor:"#EF4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderWidth:2,fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12}}},tooltip:{mode:"index",intersect:!1}},scales:{x:{ticks:{maxRotation:45,minRotation:45,font:{size:10}}},y:{beginAtZero:!0,ticks:{stepSize:1}}}}})})})]}):t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm lg:col-span-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Follow-up Trends Over Time"}),t.jsx("div",{className:"h-64 flex items-center justify-center text-gray-500",children:"No trend data available"})]})]})]})]})]})}const O1=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Bar})));B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Line})));const P1=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Doughnut}))),h7=B.lazy(()=>Ea(()=>Promise.resolve().then(()=>Da),void 0).then(l=>({default:l.Pie})));nl.register(Yc,Gc,Hc,il,Vc,bm,$c,qc,Wc,Ip);const Fb={},f7=60*1e3;function m7(){const l=Tr(),[n,a]=B.useState(!0),[o,s]=B.useState(null),[e,m]=B.useState(null),[v,w]=B.useState("overview"),[N,S]=B.useState("last7days");B.useEffect(()=>{(async()=>{const ae=Fb[N||"all"];if(ae&&Date.now()-ae.timestamp<f7){const re=ae.data;s(re),re.employees.length>0&&!e&&m(re.employees[0].userId),a(!1)}else await D()})()},[N]);const D=async()=>{try{a(!0);const P=await Vt.get("/projects/employee-performance",{params:{timeFilter:N}});if(P.data.success){const G=P.data.data;s(G),Fb[N||"all"]={data:G,timestamp:Date.now()},G.employees.length>0&&!e&&m(G.employees[0].userId)}}catch(P){console.error("Error fetching employee performance:",P)}finally{a(!1)}},L=B.useMemo(()=>!o||!e?null:o.employees.find(P=>P.userId===e)||o.employees[0],[o,e]),M=B.useMemo(()=>o?{channelDistribution:{labels:["Email","Call","LinkedIn"],datasets:[{label:"Activities by Channel",data:[o.summary.byChannel.email,o.summary.byChannel.call,o.summary.byChannel.linkedin],backgroundColor:["#3B82F6","#10B981","#8B5CF6"],borderWidth:2,borderColor:"#ffffff"}]},employeeComparison:{labels:o.employees.map(P=>P.name),datasets:[{label:"Email",data:o.employees.map(P=>P.byChannel.email.total),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"#3B82F6",borderWidth:1},{label:"Call",data:o.employees.map(P=>P.byChannel.call.total),backgroundColor:"rgba(16, 185, 129, 0.8)",borderColor:"#10B981",borderWidth:1},{label:"LinkedIn",data:o.employees.map(P=>P.byChannel.linkedin.total),backgroundColor:"rgba(139, 92, 246, 0.8)",borderColor:"#8B5CF6",borderWidth:1}]},topPerformers:o.employees.sort((P,G)=>G.totalActivities-P.totalActivities).slice(0,5)}:null,[o]),F=B.useMemo(()=>{if(!L)return null;const P=Object.keys(L.byChannel.email.byStatus||{}),G=Object.keys(L.byChannel.call.byStatus||{}),ae=Object.keys(L.byChannel.linkedin.byStatus||{});return{channelDistribution:{labels:["Email","Call","LinkedIn"],datasets:[{label:"Activities",data:[L.byChannel.email.total,L.byChannel.call.total,L.byChannel.linkedin.total],backgroundColor:["#3B82F6","#10B981","#8B5CF6"],borderWidth:2,borderColor:"#ffffff"}]},emailStatus:{labels:P.length>0?P:["No Status"],datasets:[{label:"Email Status",data:P.length>0?P.map(re=>L.byChannel.email.byStatus[re]):[0],backgroundColor:["#3B82F6","#60A5FA","#93C5FD","#DBEAFE","#EFF6FF"],borderWidth:2,borderColor:"#ffffff"}]},callStatus:{labels:G.length>0?G:["No Status"],datasets:[{label:"Call Status",data:G.length>0?G.map(re=>L.byChannel.call.byStatus[re]):[0],backgroundColor:["#10B981","#34D399","#6EE7B7","#A7F3D0","#D1FAE5"],borderWidth:2,borderColor:"#ffffff"}]},linkedinStatus:{labels:ae.length>0?ae:["No Status"],datasets:[{label:"LinkedIn Status",data:ae.length>0?ae.map(re=>L.byChannel.linkedin.byStatus[re]):[0],backgroundColor:["#8B5CF6","#A78BFA","#C4B5FD","#DDD6FE","#EDE9FE"],borderWidth:2,borderColor:"#ffffff"}]},projectPerformance:{labels:L.byProject.map(re=>re.projectName),datasets:[{label:"Email",data:L.byProject.map(re=>re.email),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"#3B82F6",borderWidth:1},{label:"Call",data:L.byProject.map(re=>re.call),backgroundColor:"rgba(16, 185, 129, 0.8)",borderColor:"#10B981",borderWidth:1},{label:"LinkedIn",data:L.byProject.map(re=>re.linkedin),backgroundColor:"rgba(139, 92, 246, 0.8)",borderColor:"#8B5CF6",borderWidth:1}]}}},[L]);if(n)return t.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-gray-200 border-t-blue-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Loading performance data..."})]})});if(!o||!o.employees||o.employees.length===0)return t.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm p-8 text-center",children:[t.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Employee Data Available"}),t.jsx("p",{className:"text-gray-600",children:"There are no employees with performance data for the selected time period."})]})})});const O={today:"Today",last7days:"Last 7 Days",lastMonth:"Last Month"};return t.jsx("div",{className:"bg-gray-50 min-h-screen",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Employee Performance"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Comprehensive analytics and insights for team performance tracking"})]}),t.jsx("div",{className:"flex items-center gap-2 bg-white rounded-lg border border-gray-200 p-1 shadow-sm",children:["today","last7days","lastMonth"].map(P=>t.jsx("button",{onClick:()=>S(P),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${N===P?"bg-blue-600 text-white shadow-sm":"text-gray-700 hover:bg-gray-50"}`,children:O[P]},P))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Total Employees"}),t.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalEmployees})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-green-700",children:"Total Activities"}),t.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalActivities.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Total Projects"}),t.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalProjects})]}),t.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 border border-amber-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-amber-700",children:"Avg per Employee"}),t.jsx("div",{className:"w-10 h-10 bg-amber-500 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:o.summary.totalEmployees>0?Math.round(o.summary.totalActivities/o.summary.totalEmployees):0})]})]})]}),t.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm mb-6",children:t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"flex -mb-px",children:[t.jsx("button",{onClick:()=>w("overview"),className:`px-6 py-4 text-sm font-semibold border-b-2 transition-colors ${v==="overview"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:"Overview"}),t.jsx("button",{onClick:()=>w("employee"),className:`px-6 py-4 text-sm font-semibold border-b-2 transition-colors ${v==="employee"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:"Employee Details"})]})})}),v==="overview"&&M&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Email Activities"}),t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:o.summary.byChannel.email.toLocaleString()}),t.jsxs("div",{className:"text-xs text-gray-500",children:[(o.summary.byChannel.email/o.summary.totalActivities*100).toFixed(1),"% of total"]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Call Activities"}),t.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:o.summary.byChannel.call.toLocaleString()}),t.jsxs("div",{className:"text-xs text-gray-500",children:[(o.summary.byChannel.call/o.summary.totalActivities*100).toFixed(1),"% of total"]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"LinkedIn Activities"}),t.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})})]}),t.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:o.summary.byChannel.linkedin.toLocaleString()}),t.jsxs("div",{className:"text-xs text-gray-500",children:[(o.summary.byChannel.linkedin/o.summary.totalActivities*100).toFixed(1),"% of total"]})]})]}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Employee Activity Comparison"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(O1,{data:M.employeeComparison,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{padding:10,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12}},scales:{y:{beginAtZero:!0,ticks:{font:{size:11}},grid:{color:"rgba(0, 0, 0, 0.05)"}},x:{ticks:{font:{size:11}},grid:{display:!1}}}}})})})]})}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Performers"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Ranked by total activities"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Rank"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Employee"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Total Activities"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Call"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"LinkedIn"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Projects"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.topPerformers.map((P,G)=>t.jsxs("tr",{className:G<3?"bg-gradient-to-r from-amber-50 to-yellow-50":"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("div",{className:"flex items-center",children:G<3?t.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-amber-500 text-white font-bold text-sm",children:G+1}):t.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["#",G+1]})})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-semibold text-gray-900",children:P.name}),t.jsx("div",{className:"text-sm text-gray-500",children:P.email})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-semibold text-gray-900",children:P.totalActivities.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-blue-600",children:P.byChannel.email.total.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-green-600",children:P.byChannel.call.total.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-purple-600",children:P.byChannel.linkedin.total.toLocaleString()})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"text-sm font-medium text-gray-900",children:P.projects.length})})]},P.userId))})]})})]})]}),v==="employee"&&L&&F&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Select Employee"}),t.jsx("select",{value:e,onChange:P=>m(P.target.value),className:"w-full md:w-80 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm font-medium",children:o.employees.map(P=>t.jsxs("option",{value:P.userId,children:[P.name," (",P.email,")"]},P.userId))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-blue-700 mb-2",children:"Total Activities"}),t.jsx("div",{className:"text-3xl font-bold text-gray-900",children:L.totalActivities.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-blue-700 mb-2",children:"Email Activities"}),t.jsx("div",{className:"text-3xl font-bold text-blue-600",children:L.byChannel.email.total.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-green-700 mb-2",children:"Call Activities"}),t.jsx("div",{className:"text-3xl font-bold text-green-600",children:L.byChannel.call.total.toLocaleString()})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:"text-sm font-medium text-purple-700 mb-2",children:"LinkedIn Activities"}),t.jsx("div",{className:"text-3xl font-bold text-purple-600",children:L.byChannel.linkedin.total.toLocaleString()})]})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Channel Distribution"}),t.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-4 text-center",children:[t.jsx("div",{className:"text-xs font-medium text-blue-700 mb-1",children:"Email"}),t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:L.byChannel.email.total.toLocaleString()}),t.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[L.totalActivities>0?(L.byChannel.email.total/L.totalActivities*100).toFixed(1):0,"%"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-lg p-4 text-center",children:[t.jsx("div",{className:"text-xs font-medium text-green-700 mb-1",children:"Call"}),t.jsx("div",{className:"text-2xl font-bold text-green-600",children:L.byChannel.call.total.toLocaleString()}),t.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[L.totalActivities>0?(L.byChannel.call.total/L.totalActivities*100).toFixed(1):0,"%"]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-lg p-4 text-center",children:[t.jsx("div",{className:"text-xs font-medium text-purple-700 mb-1",children:"LinkedIn"}),t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:L.byChannel.linkedin.total.toLocaleString()}),t.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:[L.totalActivities>0?(L.byChannel.linkedin.total/L.totalActivities*100).toFixed(1):0,"%"]})]})]}),t.jsx("div",{className:"mb-6",children:t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(O1,{data:{labels:["Email","Call","LinkedIn"],datasets:[{label:"Activities",data:[L.byChannel.email.total,L.byChannel.call.total,L.byChannel.linkedin.total],backgroundColor:["#3B82F6","#10B981","#8B5CF6"],borderRadius:8,borderSkipped:!1}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,callbacks:{label:function(P){const G=L.totalActivities,ae=P.parsed.x,re=G>0?(ae/G*100).toFixed(1):0;return`${ae.toLocaleString()} activities (${re}%)`}}}},scales:{x:{beginAtZero:!0,ticks:{callback:function(P){return P.toLocaleString()}},grid:{color:"rgba(0, 0, 0, 0.05)"}},y:{grid:{display:!1}}}}})})})}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(h7,{data:F.channelDistribution,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,callbacks:{label:function(P){const G=L.totalActivities,ae=P.parsed,re=G>0?(ae/G*100).toFixed(1):0;return`${P.label}: ${ae.toLocaleString()} (${re}%)`}}}}}})})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Email Status"}),t.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})})]}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(P1,{data:F.emailStatus,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:8,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:10}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Call Status"}),t.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(P1,{data:F.callStatus,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:8,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:10}}}})})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"LinkedIn Status"}),t.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})})]}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-48 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-48",children:t.jsx(P1,{data:F.linkedinStatus,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:8,font:{size:10}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:10}}}})})})]})]}),L.byProject.length>0&&t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Activity by Project"}),t.jsx(B.Suspense,{fallback:t.jsx("div",{className:"h-64 flex items-center justify-center",children:"Loading chart..."}),children:t.jsx("div",{className:"h-64",children:t.jsx(O1,{data:F.projectPerformance,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{padding:10,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12}},scales:{y:{beginAtZero:!0,ticks:{font:{size:11}},grid:{color:"rgba(0, 0, 0, 0.05)"}},x:{ticks:{font:{size:11}},grid:{display:!1}}}}})})})]}),L.projects.length>0&&t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Assigned Projects"})}),t.jsx("div",{className:"divide-y divide-gray-200",children:L.projects.map(P=>t.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>l(`/projects/${P.id}`),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-gray-900",children:P.companyName}),t.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[P.isCreator&&t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-blue-100 text-blue-800 text-xs font-medium mr-2",children:"Creator"}),P.isTeamMember&&t.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md bg-green-100 text-green-800 text-xs font-medium",children:"Team Member"})]})]}),t.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},P.id))})]})]})]})})}function g7(){const{id:l}=ai(),n=Tr(),a=e=>{n(e==="linkedin"?`/projects/${l}/linkedin-funnel`:e==="cold-calling"?`/projects/${l}/cold-calling-funnel`:e==="email"?`/projects/${l}/email-funnel`:`/projects/${l}?funnel=${e}`)},o=[{id:"cold-calling",title:"Cold Calling",description:"Manage phone outreach and call activities",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),color:"green",accentColor:"emerald"},{id:"email",title:"Email",description:"Track email campaigns and responses",icon:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),color:"blue",accentColor:"blue"},{id:"linkedin",title:"LinkedIn",description:"Manage LinkedIn connections and messages",icon:t.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),color:"indigo",accentColor:"indigo"}],s=(e,m)=>{const v={green:{bg:"bg-emerald-50",border:"border-emerald-200",hoverBorder:"hover:border-emerald-300",iconBg:"bg-emerald-100",iconColor:"text-emerald-600",title:"text-gray-900",description:"text-gray-600",hoverBg:"hover:bg-emerald-50",hoverShadow:"hover:shadow-lg"},blue:{bg:"bg-blue-50",border:"border-blue-200",hoverBorder:"hover:border-blue-300",iconBg:"bg-blue-100",iconColor:"text-blue-600",title:"text-gray-900",description:"text-gray-600",hoverBg:"hover:bg-blue-50",hoverShadow:"hover:shadow-lg"},indigo:{bg:"bg-indigo-50",border:"border-indigo-200",hoverBorder:"hover:border-indigo-300",iconBg:"bg-indigo-100",iconColor:"text-indigo-600",title:"text-gray-900",description:"text-gray-600",hoverBg:"hover:bg-indigo-50",hoverShadow:"hover:shadow-lg"}};return v[e]||v.blue};return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-12",children:[t.jsxs("div",{className:"mb-12",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 mb-8 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("h1",{className:"text-3xl font-semibold text-gray-900 tracking-tight mb-3",children:"Sales Report"}),t.jsx("div",{className:"w-16 h-0.5 bg-gradient-to-r from-emerald-500 via-blue-500 to-indigo-500 rounded-full"})]}),t.jsx("p",{className:"text-base text-gray-600 mt-4",children:"Select a channel to view and manage prospects"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-5xl",children:o.map(e=>{const m=s(e.color,e.accentColor);return t.jsxs("button",{onClick:()=>a(e.id),className:`group relative bg-white border-2 ${m.border} ${m.hoverBorder} rounded-xl p-8 text-left transition-all duration-200 ${m.hoverBg} ${m.hoverShadow} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-${e.accentColor}-500`,children:[t.jsx("div",{className:`w-14 h-14 ${m.iconBg} rounded-lg flex items-center justify-center mb-5 ${m.iconColor} transition-colors duration-200`,children:e.icon}),t.jsxs("div",{children:[t.jsx("h3",{className:`text-xl font-semibold ${m.title} mb-2`,children:e.title}),t.jsx("p",{className:`text-sm ${m.description} leading-relaxed`,children:e.description})]}),t.jsx("div",{className:"absolute bottom-6 right-6 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:t.jsx("svg",{className:`w-5 h-5 ${m.iconColor}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]},e.id)})})]})})}const jv="label";function Mb(l,n){typeof l=="function"?l(n):l&&(l.current=n)}function p7(l,n){const a=l.options;a&&n&&Object.assign(a,n)}function Nv(l,n){l.labels=n}function kv(l,n,a=jv){const o=[];l.datasets=n.map(s=>{const e=l.datasets.find(m=>m[a]===s[a]);return!e||!s.data||o.includes(e)?{...s}:(o.push(e),Object.assign(e,s),e)})}function x7(l,n=jv){const a={labels:[],datasets:[]};return Nv(a,l.labels),kv(a,l.datasets,n),a}function b7(l,n){return l.getElementsAtEventForMode(n.nativeEvent,"dataset",{intersect:!0},!1)}function y7(l,n){return l.getElementsAtEventForMode(n.nativeEvent,"nearest",{intersect:!0},!1)}function v7(l,n){return l.getElementsAtEventForMode(n.nativeEvent,"index",{intersect:!0},!1)}function w7(l,n){const{height:a=150,width:o=300,redraw:s=!1,datasetIdKey:e,type:m,data:v,options:w,plugins:N=[],fallbackContent:S,updateMode:D,...L}=l,M=B.useRef(null),F=B.useRef(null),O=()=>{M.current&&(F.current=new nl(M.current,{type:m,data:x7(v,e),options:w&&{...w},plugins:N}),Mb(n,F.current))},P=()=>{Mb(n,null),F.current&&(F.current.destroy(),F.current=null)};return B.useEffect(()=>{!s&&F.current&&w&&p7(F.current,w)},[s,w]),B.useEffect(()=>{!s&&F.current&&Nv(F.current.config.data,v.labels)},[s,v.labels]),B.useEffect(()=>{!s&&F.current&&v.datasets&&kv(F.current.config.data,v.datasets,e)},[s,v.datasets]),B.useEffect(()=>{F.current&&(s?(P(),setTimeout(O)):F.current.update(D))},[s,w,v.labels,v.datasets,D]),B.useEffect(()=>{F.current&&(P(),setTimeout(O))},[m]),B.useEffect(()=>(O(),()=>P()),[]),t.jsx("canvas",{ref:M,role:"img",height:a,width:o,...L,children:S})}const Cv=B.forwardRef(w7);function Kc(l,n){return nl.register(n),B.forwardRef((a,o)=>t.jsx(Cv,{...a,ref:o,type:l}))}const n0=Kc("line",x6),i0=Kc("bar",m6),j7=Kc("radar",v6),N7=Kc("doughnut",rv),k7=Kc("polarArea",b6),C7=Kc("bubble",g6),S7=Kc("pie",y6),A7=Kc("scatter",w6),Da=Object.freeze(Object.defineProperty({__proto__:null,Bar:i0,Bubble:C7,Chart:Cv,Doughnut:N7,Line:n0,Pie:S7,PolarArea:k7,Radar:j7,Scatter:A7,getDatasetAtEvent:b7,getElementAtEvent:y7,getElementsAtEvent:v7},Symbol.toStringTag,{value:"Module"}));nl.register(Yc,Gc,Hc,il,Vc,$c,qc,Wc,Ip);function E7(){const{id:l}=ai(),n=Tr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({}),[L,M]=B.useState(null),[F,O]=B.useState("month");B.useEffect(()=>{l&&P()},[l]),B.useEffect(()=>{const be=()=>{l&&!w&&P()};return window.addEventListener("focus",be),()=>window.removeEventListener("focus",be)},[l,w]);const P=async()=>{try{N(!0);const be=await Vt.get(`/projects/${l}`);be.data.success&&o(be.data.data);const oe=await Vt.get(`/activities/project/${l}?limit=10000`);if(oe.data.success){const Te=(oe.data.data||[]).filter(fe=>fe.type==="linkedin");e(Te)}const he=await Vt.get(`/projects/${l}/project-contacts`);he.data.success&&v(he.data.data||[]),M(new Date)}catch(be){console.error("Error fetching data:",be)}finally{N(!1)}};B.useEffect(()=>{(s.length>0||m.length>0)&&xe()},[s,m,F]);const G=be=>{const oe=new Date(be),he=oe.toLocaleString("default",{month:"short"}),ye=oe.getFullYear().toString().slice(-2);return`${he} '${ye}`},ae=be=>new Date(be).getFullYear().toString(),re=()=>{const be=new Set;return s.forEach(he=>{he.createdAt&&be.add(G(he.createdAt))}),m.forEach(he=>{he.createdAt&&be.add(G(he.createdAt))}),Array.from(be).sort((he,ye)=>{const[Te,fe]=he.split(" '"),[_e,We]=ye.split(" '"),te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],me=te.indexOf(Te),W=te.indexOf(_e);return fe!==We?parseInt(fe)-parseInt(We):me-W})},ke=()=>{const be=new Set;return s.forEach(oe=>{oe.createdAt&&be.add(ae(oe.createdAt))}),m.forEach(oe=>{oe.createdAt&&be.add(ae(oe.createdAt))}),Array.from(be).sort((oe,he)=>parseInt(oe)-parseInt(he))},xe=()=>{const be=F==="month"?re():ke(),oe={};be.forEach(fe=>{oe[fe]={dataResearch:0,connectionRequestSent:0,connectionAccepted:0,firstMessageSent:0,followupMessagesSent:0,existingConnection:0,conversationsInProgress:0,meetingProposed:0,meetingScheduled:0,meetingCompleted:0}}),m.forEach(fe=>{if(fe.createdAt){const _e=F==="month"?G(fe.createdAt):ae(fe.createdAt);oe[_e]&&oe[_e].dataResearch++}});const he={};s.forEach(fe=>{if(!fe.createdAt)return;const _e=fe.contactId?.toString()||"unknown";he[_e]||(he[_e]=[]),he[_e].push(fe)}),s.forEach(fe=>{const _e=fe.linkedinDate?new Date(fe.linkedinDate):fe.createdAt?new Date(fe.createdAt):null;if(!_e)return;const We=F==="month"?G(_e):ae(_e);if(!oe[We])return;const te=fe.template?.trim()||"";(fe.lnRequestSent==="Yes"||te==="introduction-message")&&oe[We].connectionRequestSent++,fe.lnRequestSent==="Existing Connect"&&oe[We].existingConnection++,fe.connected==="Yes"&&oe[We].connectionAccepted++,fe.status==="CIP"?oe[We].conversationsInProgress++:fe.status==="Meeting Proposed"?oe[We].meetingProposed++:fe.status==="Meeting Scheduled"?oe[We].meetingScheduled++:fe.status==="Meeting Completed"&&oe[We].meetingCompleted++});const ye={},Te={};s.forEach(fe=>{const _e=fe.linkedinDate?new Date(fe.linkedinDate):fe.createdAt?new Date(fe.createdAt):null;if(!_e)return;const We=F==="month"?G(_e):ae(_e);if(!oe[We])return;ye[We]||(ye[We]=new Set),Te[We]||(Te[We]=new Set);const te=fe.contactId?.toString()||"unknown",me=fe.template?.trim()||"";me==="introduction-message"&&ye[We].add(te),me==="follow-up-message"&&Te[We].add(te)}),Object.keys(oe).forEach(fe=>{ye[fe]&&(oe[fe].firstMessageSent=ye[fe].size),Te[fe]&&(oe[fe].followupMessagesSent=Te[fe].size)}),D(oe)},je=[{key:"dataResearch",label:"Data Research manually",section:"DRA"},{key:"connectionRequestSent",label:"Connection Request Sent",section:"DRA"},{key:"connectionAccepted",label:"Connection Accepted",section:"DRA"},{key:"firstMessageSent",label:"First Message Sent",section:"DRA"},{key:"followupMessagesSent",label:"Followup Messages sent",section:"DRA"},{key:"existingConnection",label:"Existing Connection",section:"Linked IN"},{key:"conversationsInProgress",label:"Conversations in Progress",section:"Linked IN",highlight:!0},{key:"meetingProposed",label:"Meeting Proposed",section:"Linked IN",highlight:!0},{key:"meetingScheduled",label:"Meeting Scheduled",section:"Linked IN",highlight:!0},{key:"meetingCompleted",label:"Meeting Completed",section:"Linked IN",highlight:!0}],Z=F==="month"?re():ke(),ce=B.useMemo(()=>{const be=Z;return{connectionFunnel:{labels:be,datasets:[{label:"Connection Request Sent",data:be.map(oe=>S[oe]?.connectionRequestSent||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0},{label:"Connection Accepted",data:be.map(oe=>S[oe]?.connectionAccepted||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0}]},messageActivity:{labels:be,datasets:[{label:"First Message Sent",data:be.map(oe=>S[oe]?.firstMessageSent||0),borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4,fill:!0},{label:"Followup Messages",data:be.map(oe=>S[oe]?.followupMessagesSent||0),borderColor:"rgb(236, 72, 153)",backgroundColor:"rgba(236, 72, 153, 0.1)",tension:.4,fill:!0}]},meetingPipeline:{labels:be,datasets:[{label:"Meeting Proposed",data:be.map(oe=>S[oe]?.meetingProposed||0),backgroundColor:"rgba(251, 191, 36, 0.8)"},{label:"Meeting Scheduled",data:be.map(oe=>S[oe]?.meetingScheduled||0),backgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Meeting Completed",data:be.map(oe=>S[oe]?.meetingCompleted||0),backgroundColor:"rgba(34, 197, 94, 0.8)"}]},conversationsStatus:{labels:be,datasets:[{label:"Conversations in Progress",data:be.map(oe=>S[oe]?.conversationsInProgress||0),backgroundColor:"rgba(34, 197, 94, 0.8)"}]}}},[Z,S]),ue={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"600"},bodyFont:{size:13},cornerRadius:8,displayColors:!0}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}},x:{grid:{display:!1},ticks:{font:{size:11}}}}},Re={...ue,scales:{...ue.scales,x:{...ue.scales.x,stacked:!0},y:{...ue.scales.y,stacked:!0}}};return w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading report..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}/funnel`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Sales Report"]}),t.jsxs("button",{onClick:P,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh data",children:[t.jsx("svg",{className:`w-4 h-4 ${w?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:[F==="month"?"Monthly":"Yearly"," Report - ",a?.companyName||"Project"]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[L&&t.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",L.toLocaleTimeString()]}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>O("month"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Monthly"}),t.jsx("button",{onClick:()=>O("year"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="year"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Yearly"})]})]})]})})]}),Z.length>0&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Connection Funnel"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:ce.connectionFunnel,options:ue})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Message Activity"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:ce.messageActivity,options:ue})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Meeting Pipeline"}),t.jsx("div",{className:"h-64",children:t.jsx(i0,{data:ce.meetingPipeline,options:Re})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conversations in Progress"}),t.jsx("div",{className:"h-64",children:t.jsx(i0,{data:ce.conversationsStatus,options:ue})})]})]}),t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200",children:"Key Results"}),Z.map(be=>t.jsxs("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200 last:border-r-0",children:[t.jsx("div",{children:be}),t.jsx("div",{className:"text-xs font-normal text-gray-500 mt-1",children:"Progress"})]},be))]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:["DRA","Linked IN"].map(be=>t.jsx(Mo.Fragment,{children:je.filter(oe=>oe.section===be).map((oe,he)=>t.jsxs("tr",{className:oe.highlight?"bg-green-50":"hover:bg-gray-50",children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border-r border-gray-200 ${oe.highlight?"font-semibold":""}`,children:oe.label}),Z.map(ye=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${oe.highlight?"font-semibold text-gray-900":"text-gray-700"}`,children:S[ye]?.[oe.key]||0},ye))]},oe.key))},be))})]})})})]})})}nl.register(Yc,Gc,Hc,il,Vc,$c,qc,Wc,Ip);function D7(){const{id:l}=ai(),n=Tr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({}),[L,M]=B.useState(null),[F,O]=B.useState("day");B.useEffect(()=>{l&&P()},[l]),B.useEffect(()=>{const he=()=>{l&&!w&&P()};return window.addEventListener("focus",he),()=>window.removeEventListener("focus",he)},[l,w]);const P=async()=>{try{N(!0);const he=await Vt.get(`/projects/${l}`);he.data.success&&o(he.data.data);const ye=await Vt.get(`/activities/project/${l}?limit=10000`);if(ye.data.success){const _e=(ye.data.data||[]).filter(We=>We.type==="call");e(_e)}const Te=await Vt.get(`/projects/${l}/project-contacts`);Te.data.success&&v(Te.data.data||[]),M(new Date)}catch(he){console.error("Error fetching data:",he)}finally{N(!1)}};B.useEffect(()=>{(s.length>0||m.length>0)&&xe()},[s,m,F]);const G=he=>{const ye=new Date(he),Te=ye.getDate(),fe=ye.toLocaleString("default",{month:"short"}),_e=ye.getFullYear().toString().slice(-2);return`${Te} ${fe} '${_e}`},ae=he=>{const ye=new Date(he),Te=ye.toLocaleString("default",{month:"short"}),fe=ye.getFullYear().toString().slice(-2);return`${Te} '${fe}`},re=()=>{const he=new Set;return s.forEach(Te=>{const fe=Te.callDate?new Date(Te.callDate):new Date(Te.createdAt);fe&&he.add(G(fe))}),m.forEach(Te=>{Te.createdAt&&he.add(G(new Date(Te.createdAt)))}),Array.from(he).sort((Te,fe)=>{const _e=new Date(Te.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3")),We=new Date(fe.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3"));return _e-We})},ke=()=>{const he=new Set;return s.forEach(Te=>{const fe=Te.callDate?new Date(Te.callDate):new Date(Te.createdAt);fe&&he.add(ae(fe))}),m.forEach(Te=>{Te.createdAt&&he.add(ae(new Date(Te.createdAt)))}),Array.from(he).sort((Te,fe)=>{const[_e,We]=Te.split(" '"),[te,me]=fe.split(" '"),W=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pe=W.indexOf(_e),Le=W.indexOf(te);return We!==me?parseInt(We)-parseInt(me):pe-Le})},xe=()=>{const he=F==="day"?re():ke(),ye={};he.forEach(_e=>{ye[_e]={dataAllocated:0,interested:0,notInterested:0,ring:0,busy:0,hangUp:0,callBack:0,switchOff:0,detailsShared:0,future:0,invalid:0,demoBooked:0,followUps:0,totalCalls:0,freshCalls:0}}),m.forEach(_e=>{if(_e.createdAt){const We=F==="day"?G(new Date(_e.createdAt)):ae(new Date(_e.createdAt));ye[We]&&ye[We].dataAllocated++}});const Te=new Map,fe={};s.forEach(_e=>{const We=_e.callDate?new Date(_e.callDate):new Date(_e.createdAt);if(!We)return;const te=F==="day"?G(We):ae(We);if(!ye[te])return;const me=_e.contactId?.toString()||"unknown";_e.callNumber==="1st call"&&!Te.has(me)&&Te.set(me,te),fe[te]||(fe[te]={}),fe[te][me]||(fe[te][me]=[]),fe[te][me].push(_e)}),s.forEach(_e=>{const We=_e.callDate?new Date(_e.callDate):new Date(_e.createdAt);if(!We)return;const te=F==="day"?G(We):ae(We);if(ye[te]){if(_e.callStatus)switch(_e.callStatus){case"Interested":ye[te].interested++;break;case"Not Interested":ye[te].notInterested++;break;case"Ring":ye[te].ring++;break;case"Busy":ye[te].busy++;break;case"Hang Up":ye[te].hangUp++;break;case"Call Back":ye[te].callBack++;break;case"Switch Off":ye[te].switchOff++;break;case"Details Shared":ye[te].detailsShared++;break;case"Future":ye[te].future++;break;case"Invalid":ye[te].invalid++;break;case"Demo Booked":ye[te].demoBooked++;break}ye[te].totalCalls++}}),Object.keys(fe).forEach(_e=>{const We=fe[_e];let te=0,me=0;Object.keys(We).forEach(W=>{const pe=We[W],Le=Te.get(W);pe.forEach(Ae=>{Ae.callNumber==="1st call"||Le===_e&&!Ae.callNumber?te++:me++})}),ye[_e]&&(ye[_e].freshCalls=te,ye[_e].followUps=me)}),D(ye)},je=[{key:"dataAllocated",label:"Data Allocated",section:"DRA",bold:!1},{key:"interested",label:"Interested",section:"DRA",bold:!0},{key:"notInterested",label:"Not Interested",section:"DRA",bold:!0},{key:"ring",label:"Ring",section:"DRA",bold:!1},{key:"busy",label:"Busy",section:"DRA",bold:!1,highlight:!0},{key:"hangUp",label:"Hang Up",section:"DRA",bold:!1},{key:"callBack",label:"Call Back",section:"DRA",bold:!1},{key:"switchOff",label:"Switch Off",section:"DRA",bold:!1},{key:"detailsShared",label:"Detailed Shared",section:"Cold Calling",bold:!0,highlight:!0},{key:"future",label:"Future",section:"Cold Calling",bold:!1},{key:"invalid",label:"Invalid",section:"Cold Calling",bold:!1},{key:"demoBooked",label:"Demo Booked",section:"Cold Calling",bold:!0,highlight:!0,highlightDark:!0},{key:"followUps",label:"Follow Ups",section:"Cold Calling",bold:!0},{key:"totalCalls",label:"Total Calls",section:"Cold Calling",bold:!0},{key:"freshCalls",label:"(Fresh Calls + FollowUpS)",section:"Cold Calling",bold:!1,isFormula:!0}],Z=F==="day"?re():ke(),ce=B.useMemo(()=>{const he=Z;return{draMetrics:{labels:he,datasets:[{label:"Interested",data:he.map(ye=>S[ye]?.interested||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0},{label:"Not Interested",data:he.map(ye=>S[ye]?.notInterested||0),borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",tension:.4,fill:!0}]},callStatusBreakdown:{labels:he,datasets:[{label:"Ring",data:he.map(ye=>S[ye]?.ring||0),backgroundColor:"rgba(156, 163, 175, 0.8)"},{label:"Busy",data:he.map(ye=>S[ye]?.busy||0),backgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Call Back",data:he.map(ye=>S[ye]?.callBack||0),backgroundColor:"rgba(168, 85, 247, 0.8)"}]},coldCallingMetrics:{labels:he,datasets:[{label:"Details Shared",data:he.map(ye=>S[ye]?.detailsShared||0),borderColor:"rgb(251, 191, 36)",backgroundColor:"rgba(251, 191, 36, 0.1)",tension:.4,fill:!0},{label:"Demo Booked",data:he.map(ye=>S[ye]?.demoBooked||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0}]},callVolume:{labels:he,datasets:[{label:"Total Calls",data:he.map(ye=>S[ye]?.totalCalls||0),backgroundColor:"rgba(34, 197, 94, 0.8)"},{label:"Fresh Calls",data:he.map(ye=>S[ye]?.freshCalls||0),backgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Follow Ups",data:he.map(ye=>S[ye]?.followUps||0),backgroundColor:"rgba(168, 85, 247, 0.8)"}]}}},[Z,S]),ue={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"600"},bodyFont:{size:13},cornerRadius:8,displayColors:!0}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}},x:{grid:{display:!1},ticks:{font:{size:11}}}}},Re={...ue,scales:{...ue.scales,x:{...ue.scales.x,stacked:!0},y:{...ue.scales.y,stacked:!0}}};if(w)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading report..."})]})});const be=je.filter(he=>he.section==="DRA"),oe=je.filter(he=>he.section==="Cold Calling");return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}/funnel`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Sales Report"]}),t.jsxs("button",{onClick:P,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh data",children:[t.jsx("svg",{className:`w-4 h-4 ${w?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:[F==="day"?"Daily":"Monthly"," Report - ",a?.companyName||"Project"]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[L&&t.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",L.toLocaleTimeString()]}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>O("day"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="day"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Daily"}),t.jsx("button",{onClick:()=>O("month"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Monthly"})]})]})]})})]}),Z.length>0&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"DRA Metrics"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:ce.draMetrics,options:ue})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Call Status Breakdown"}),t.jsx("div",{className:"h-64",children:t.jsx(i0,{data:ce.callStatusBreakdown,options:Re})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cold Calling Metrics"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:ce.coldCallingMetrics,options:ue})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Call Volume"}),t.jsx("div",{className:"h-64",children:t.jsx(i0,{data:ce.callVolume,options:Re})})]})]}),Z.length>0&&t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200",children:"Key Results"}),Z.map(he=>t.jsxs("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200 last:border-r-0 bg-blue-50",children:[t.jsx("div",{children:he}),t.jsx("div",{className:"text-xs font-normal text-gray-500 mt-1",children:"Progress"})]},he))]})}),t.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.jsx("tr",{children:t.jsx("td",{colSpan:Z.length+1,className:"px-6 py-3 bg-yellow-100 border-b-2 border-yellow-200",children:t.jsx("span",{className:"text-sm font-bold text-gray-900",children:"DRA"})})}),be.map(he=>t.jsxs("tr",{className:`${he.highlight?"bg-green-50":"hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm border-r border-gray-200 ${he.bold?"font-bold text-gray-900":"text-gray-700"} ${he.highlightDark?"bg-green-100":""}`,children:he.label}),Z.map(ye=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${he.bold?"font-semibold text-gray-900":"text-gray-700"}`,children:he.isFormula?`(${S[ye]?.freshCalls||0} + ${S[ye]?.followUps||0})`:S[ye]?.[he.key]||0},ye))]},he.key)),t.jsx("tr",{children:t.jsx("td",{colSpan:Z.length+1,className:"px-6 py-3 bg-yellow-100 border-b-2 border-yellow-200",children:t.jsx("span",{className:"text-sm font-bold text-gray-900",children:"Cold Calling"})})}),oe.map(he=>t.jsxs("tr",{className:`${he.highlight?he.highlightDark?"bg-green-200":"bg-green-50":"hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm border-r border-gray-200 ${he.bold?"font-bold text-gray-900":"text-gray-700"} ${he.highlightDark?"bg-green-200":""}`,children:he.label}),Z.map(ye=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${he.bold?"font-semibold text-gray-900":"text-gray-700"}`,children:he.isFormula?`(${S[ye]?.freshCalls||0} + ${S[ye]?.followUps||0})`:S[ye]?.[he.key]||0},ye))]},he.key))]})]})})}),Z.length===0&&!w&&t.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:t.jsx("p",{className:"text-gray-500",children:"No call activities found for this project."})})]})})}nl.register(Yc,Gc,Hc,il,Vc,$c,qc,Wc,Ip);function T7(){const{id:l}=ai(),n=Tr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({}),[L,M]=B.useState(null),[F,O]=B.useState("month");B.useEffect(()=>{l&&P()},[l]),B.useEffect(()=>{const oe=()=>{l&&!w&&P()};return window.addEventListener("focus",oe),()=>window.removeEventListener("focus",oe)},[l,w]);const P=async()=>{try{N(!0);const oe=await Vt.get(`/projects/${l}`);oe.data.success&&o(oe.data.data);const he=await Vt.get(`/activities/project/${l}?limit=10000`);if(he.data.success){const fe=(he.data.data||[]).filter(_e=>_e.type==="email");e(fe)}const ye=await Vt.get(`/projects/${l}/project-contacts`);ye.data.success&&v(ye.data.data||[]),M(new Date)}catch(oe){console.error("Error fetching data:",oe)}finally{N(!1)}};B.useEffect(()=>{(s.length>0||m.length>0)&&xe()},[s,m,F]);const G=oe=>{const he=new Date(oe),ye=he.toLocaleString("default",{month:"short"}),Te=he.getFullYear().toString().slice(-2);return`${ye} '${Te}`},ae=oe=>new Date(oe).getFullYear().toString(),re=()=>{const oe=new Set;return s.forEach(ye=>{ye.createdAt&&oe.add(G(ye.createdAt))}),m.forEach(ye=>{ye.createdAt&&oe.add(G(new Date(ye.createdAt)))}),Array.from(oe).sort((ye,Te)=>{const[fe,_e]=ye.split(" '"),[We,te]=Te.split(" '"),me=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],W=me.indexOf(fe),pe=me.indexOf(We);return _e!==te?parseInt(_e)-parseInt(te):W-pe})},ke=()=>{const oe=new Set;return s.forEach(ye=>{ye.createdAt&&oe.add(ae(ye.createdAt))}),m.forEach(ye=>{ye.createdAt&&oe.add(ae(new Date(ye.createdAt)))}),Array.from(oe).sort((ye,Te)=>parseInt(ye)-parseInt(Te))},xe=()=>{const oe=F==="month"?re():ke(),he={};oe.forEach(ye=>{he[ye]={emailsSent:0,noReply:0,notInterested:0,outOfOffice:0,meetingProposed:0,meetingScheduled:0,interested:0,wrongPerson:0,bounce:0,optOut:0,meetingCompleted:0,totalResponses:0,responseRate:0,openRate:0,clickRate:0}}),s.forEach(ye=>{if(ye.createdAt){const Te=F==="month"?G(ye.createdAt):ae(ye.createdAt);he[Te]&&he[Te].emailsSent++}}),s.forEach(ye=>{if(ye.createdAt&&ye.status){const Te=F==="month"?G(ye.createdAt):ae(ye.createdAt);if(!he[Te])return;switch(ye.status){case"No Reply":he[Te].noReply++;break;case"Not Interested":he[Te].notInterested++,he[Te].totalResponses++;break;case"Out of Office":he[Te].outOfOffice++,he[Te].totalResponses++;break;case"Meeting Proposed":he[Te].meetingProposed++,he[Te].totalResponses++;break;case"Meeting Scheduled":he[Te].meetingScheduled++,he[Te].totalResponses++;break;case"Interested":he[Te].interested++,he[Te].totalResponses++;break;case"Wrong Person":he[Te].wrongPerson++,he[Te].totalResponses++;break;case"Bounce":he[Te].bounce++;break;case"Opt-Out":he[Te].optOut++,he[Te].totalResponses++;break;case"Meeting Completed":he[Te].meetingCompleted++,he[Te].totalResponses++;break}}}),oe.forEach(ye=>{he[ye].emailsSent>0&&(he[ye].responseRate=(he[ye].totalResponses/he[ye].emailsSent*100).toFixed(1))}),D(he)},je=[{key:"emailsSent",label:"Emails Sent",section:"Email Activity",bold:!0},{key:"noReply",label:"No Reply",section:"Email Activity",bold:!1},{key:"notInterested",label:"Not Interested",section:"Email Activity",bold:!1},{key:"outOfOffice",label:"Out of Office",section:"Email Activity",bold:!1},{key:"meetingProposed",label:"Meeting Proposed",section:"Email Activity",bold:!0,highlight:!0},{key:"meetingScheduled",label:"Meeting Scheduled",section:"Email Activity",bold:!0,highlight:!0},{key:"interested",label:"Interested",section:"Email Activity",bold:!0,highlight:!0},{key:"wrongPerson",label:"Wrong Person",section:"Email Activity",bold:!1},{key:"bounce",label:"Bounce",section:"Email Activity",bold:!1},{key:"optOut",label:"Opt-Out",section:"Email Activity",bold:!1},{key:"meetingCompleted",label:"Meeting Completed",section:"Email Activity",bold:!0,highlight:!0,highlightDark:!0},{key:"totalResponses",label:"Total Responses",section:"Email Activity",bold:!0},{key:"responseRate",label:"Response Rate (%)",section:"Email Activity",bold:!0,isPercentage:!0}],Z=F==="month"?re():ke(),ce=B.useMemo(()=>{const oe=Z;return{emailFunnel:{labels:oe,datasets:[{label:"Emails Sent",data:oe.map(he=>S[he]?.emailsSent||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4,fill:!0},{label:"Total Responses",data:oe.map(he=>S[he]?.totalResponses||0),borderColor:"rgb(34, 197, 94)",backgroundColor:"rgba(34, 197, 94, 0.1)",tension:.4,fill:!0}]},responseBreakdown:{labels:oe,datasets:[{label:"No Reply",data:oe.map(he=>S[he]?.noReply||0),backgroundColor:"rgba(156, 163, 175, 0.8)"},{label:"Not Interested",data:oe.map(he=>S[he]?.notInterested||0),backgroundColor:"rgba(239, 68, 68, 0.8)"},{label:"Interested",data:oe.map(he=>S[he]?.interested||0),backgroundColor:"rgba(34, 197, 94, 0.8)"},{label:"Meeting Proposed",data:oe.map(he=>S[he]?.meetingProposed||0),backgroundColor:"rgba(251, 191, 36, 0.8)"},{label:"Meeting Scheduled",data:oe.map(he=>S[he]?.meetingScheduled||0),backgroundColor:"rgba(6, 182, 212, 0.8)"}]},meetingPipeline:{labels:oe,datasets:[{label:"Meeting Proposed",data:oe.map(he=>S[he]?.meetingProposed||0),backgroundColor:"rgba(251, 191, 36, 0.8)"},{label:"Meeting Scheduled",data:oe.map(he=>S[he]?.meetingScheduled||0),backgroundColor:"rgba(6, 182, 212, 0.8)"},{label:"Meeting Completed",data:oe.map(he=>S[he]?.meetingCompleted||0),backgroundColor:"rgba(34, 197, 94, 0.8)"}]},responseRate:{labels:oe,datasets:[{label:"Response Rate (%)",data:oe.map(he=>parseFloat(S[he]?.responseRate||0)),borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.4,fill:!0}]}}},[Z,S]),ue={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:15,font:{size:12,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14,weight:"600"},bodyFont:{size:13},cornerRadius:8,displayColors:!0}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}},x:{grid:{display:!1},ticks:{font:{size:11}}}}},Re={...ue,scales:{...ue.scales,x:{...ue.scales.x,stacked:!0},y:{...ue.scales.y,stacked:!0}}};if(w)return t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading report..."})]})});const be=je.filter(oe=>oe.section==="Email Activity");return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}/funnel`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Sales Report"]}),t.jsxs("button",{onClick:P,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh data",children:[t.jsx("svg",{className:`w-4 h-4 ${w?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:[F==="month"?"Monthly":"Yearly"," Email Report - ",a?.companyName||"Project"]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[L&&t.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",L.toLocaleTimeString()]}),t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>O("month"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Monthly"}),t.jsx("button",{onClick:()=>O("year"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ${F==="year"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Yearly"})]})]})]})})]}),Z.length>0&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Funnel"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:ce.emailFunnel,options:ue})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Response Breakdown"}),t.jsx("div",{className:"h-64",children:t.jsx(i0,{data:ce.responseBreakdown,options:Re})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Meeting Pipeline"}),t.jsx("div",{className:"h-64",children:t.jsx(i0,{data:ce.meetingPipeline,options:Re})})]}),t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Response Rate"}),t.jsx("div",{className:"h-64",children:t.jsx(n0,{data:ce.responseRate,options:ue})})]})]}),Z.length>0&&t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200",children:"Key Results"}),Z.map(oe=>t.jsxs("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider border-r border-gray-200 last:border-r-0 bg-blue-50",children:[t.jsx("div",{children:oe}),t.jsx("div",{className:"text-xs font-normal text-gray-500 mt-1",children:"Progress"})]},oe))]})}),t.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.jsx("tr",{children:t.jsx("td",{colSpan:Z.length+1,className:"px-6 py-3 bg-yellow-100 border-b-2 border-yellow-200",children:t.jsx("span",{className:"text-sm font-bold text-gray-900",children:"Email Activity"})})}),be.map(oe=>t.jsxs("tr",{className:`${oe.highlight?oe.highlightDark?"bg-green-200":"bg-green-50":"hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm border-r border-gray-200 ${oe.bold?"font-bold text-gray-900":"text-gray-700"} ${oe.highlightDark?"bg-green-200":""}`,children:oe.label}),Z.map(he=>t.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${oe.bold?"font-semibold text-gray-900":"text-gray-700"}`,children:oe.isPercentage?`${S[he]?.[oe.key]||0}%`:S[he]?.[oe.key]||0},he))]},oe.key))]})]})})}),Z.length===0&&!w&&t.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:t.jsx("p",{className:"text-gray-500",children:"No email activities found for this project."})})]})})}function fp(l){throw new Error('Could not dynamically require "'+l+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var np={exports:{}},mp={exports:{}};var _7=mp.exports,Lb;function F7(){return Lb||(Lb=1,(function(l){var n={version:"1.15.0"};n[437]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[620]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[737]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[850]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[852]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[857]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[861]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[865]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[866]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[874]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[895]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[932]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(o[s[129][e]]=33024+e,a[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(o[s[130][e]]=33280+e,a[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(o[s[131][e]]=33536+e,a[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(o[s[132][e]]=33792+e,a[33792+e]=s[132][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(o[s[135][e]]=34560+e,a[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(o[s[136][e]]=34816+e,a[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(o[s[137][e]]=35072+e,a[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(o[s[138][e]]=35328+e,a[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(o[s[139][e]]=35584+e,a[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(o[s[140][e]]=35840+e,a[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(o[s[141][e]]=36096+e,a[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(o[s[142][e]]=36352+e,a[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(o[s[143][e]]=36608+e,a[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(o[s[144][e]]=36864+e,a[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(o[s[145][e]]=37120+e,a[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(o[s[146][e]]=37376+e,a[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(o[s[147][e]]=37632+e,a[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(o[s[148][e]]=37888+e,a[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(o[s[149][e]]=38144+e,a[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(o[s[150][e]]=38400+e,a[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(o[s[151][e]]=38656+e,a[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(o[s[152][e]]=38912+e,a[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(o[s[153][e]]=39168+e,a[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(o[s[154][e]]=39424+e,a[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(o[s[155][e]]=39680+e,a[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(o[s[156][e]]=39936+e,a[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(o[s[157][e]]=40192+e,a[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(o[s[158][e]]=40448+e,a[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(o[s[159][e]]=40704+e,a[40704+e]=s[159][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(o[s[250][e]]=64e3+e,a[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(o[s[251][e]]=64256+e,a[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(o[s[252][e]]=64512+e,a[64512+e]=s[252][e]);return{enc:o,dec:a}})(),n[936]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(o[s[129][e]]=33024+e,a[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(o[s[130][e]]=33280+e,a[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(o[s[131][e]]=33536+e,a[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(o[s[132][e]]=33792+e,a[33792+e]=s[132][e]);for(s[133]="".split(""),e=0;e!=s[133].length;++e)s[133][e].charCodeAt(0)!==65533&&(o[s[133][e]]=34048+e,a[34048+e]=s[133][e]);for(s[134]="".split(""),e=0;e!=s[134].length;++e)s[134][e].charCodeAt(0)!==65533&&(o[s[134][e]]=34304+e,a[34304+e]=s[134][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(o[s[135][e]]=34560+e,a[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(o[s[136][e]]=34816+e,a[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(o[s[137][e]]=35072+e,a[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(o[s[138][e]]=35328+e,a[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(o[s[139][e]]=35584+e,a[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(o[s[140][e]]=35840+e,a[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(o[s[141][e]]=36096+e,a[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(o[s[142][e]]=36352+e,a[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(o[s[143][e]]=36608+e,a[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(o[s[144][e]]=36864+e,a[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(o[s[145][e]]=37120+e,a[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(o[s[146][e]]=37376+e,a[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(o[s[147][e]]=37632+e,a[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(o[s[148][e]]=37888+e,a[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(o[s[149][e]]=38144+e,a[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(o[s[150][e]]=38400+e,a[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(o[s[151][e]]=38656+e,a[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(o[s[152][e]]=38912+e,a[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(o[s[153][e]]=39168+e,a[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(o[s[154][e]]=39424+e,a[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(o[s[155][e]]=39680+e,a[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(o[s[156][e]]=39936+e,a[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(o[s[157][e]]=40192+e,a[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(o[s[158][e]]=40448+e,a[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(o[s[159][e]]=40704+e,a[40704+e]=s[159][e]);for(s[160]="".split(""),e=0;e!=s[160].length;++e)s[160][e].charCodeAt(0)!==65533&&(o[s[160][e]]=40960+e,a[40960+e]=s[160][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(o[s[170][e]]=43520+e,a[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(o[s[171][e]]=43776+e,a[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(o[s[172][e]]=44032+e,a[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(o[s[173][e]]=44288+e,a[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(o[s[174][e]]=44544+e,a[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(o[s[175][e]]=44800+e,a[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(o[s[199][e]]=50944+e,a[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(o[s[200][e]]=51200+e,a[51200+e]=s[200][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(o[s[201][e]]=51456+e,a[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(o[s[248][e]]=63488+e,a[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(o[s[249][e]]=63744+e,a[63744+e]=s[249][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(o[s[250][e]]=64e3+e,a[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(o[s[251][e]]=64256+e,a[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(o[s[252][e]]=64512+e,a[64512+e]=s[252][e]);for(s[253]="".split(""),e=0;e!=s[253].length;++e)s[253][e].charCodeAt(0)!==65533&&(o[s[253][e]]=64768+e,a[64768+e]=s[253][e]);for(s[254]="".split(""),e=0;e!=s[254].length;++e)s[254][e].charCodeAt(0)!==65533&&(o[s[254][e]]=65024+e,a[65024+e]=s[254][e]);return{enc:o,dec:a}})(),n[949]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(o[s[129][e]]=33024+e,a[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(o[s[130][e]]=33280+e,a[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(o[s[131][e]]=33536+e,a[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(o[s[132][e]]=33792+e,a[33792+e]=s[132][e]);for(s[133]="".split(""),e=0;e!=s[133].length;++e)s[133][e].charCodeAt(0)!==65533&&(o[s[133][e]]=34048+e,a[34048+e]=s[133][e]);for(s[134]="".split(""),e=0;e!=s[134].length;++e)s[134][e].charCodeAt(0)!==65533&&(o[s[134][e]]=34304+e,a[34304+e]=s[134][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(o[s[135][e]]=34560+e,a[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(o[s[136][e]]=34816+e,a[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(o[s[137][e]]=35072+e,a[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(o[s[138][e]]=35328+e,a[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(o[s[139][e]]=35584+e,a[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(o[s[140][e]]=35840+e,a[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(o[s[141][e]]=36096+e,a[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(o[s[142][e]]=36352+e,a[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(o[s[143][e]]=36608+e,a[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(o[s[144][e]]=36864+e,a[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(o[s[145][e]]=37120+e,a[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(o[s[146][e]]=37376+e,a[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(o[s[147][e]]=37632+e,a[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(o[s[148][e]]=37888+e,a[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(o[s[149][e]]=38144+e,a[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(o[s[150][e]]=38400+e,a[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(o[s[151][e]]=38656+e,a[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(o[s[152][e]]=38912+e,a[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(o[s[153][e]]=39168+e,a[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(o[s[154][e]]=39424+e,a[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(o[s[155][e]]=39680+e,a[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(o[s[156][e]]=39936+e,a[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(o[s[157][e]]=40192+e,a[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(o[s[158][e]]=40448+e,a[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(o[s[159][e]]=40704+e,a[40704+e]=s[159][e]);for(s[160]="".split(""),e=0;e!=s[160].length;++e)s[160][e].charCodeAt(0)!==65533&&(o[s[160][e]]=40960+e,a[40960+e]=s[160][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(o[s[170][e]]=43520+e,a[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(o[s[171][e]]=43776+e,a[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(o[s[172][e]]=44032+e,a[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(o[s[173][e]]=44288+e,a[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(o[s[174][e]]=44544+e,a[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(o[s[175][e]]=44800+e,a[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(o[s[199][e]]=50944+e,a[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(o[s[200][e]]=51200+e,a[51200+e]=s[200][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(o[s[248][e]]=63488+e,a[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(o[s[249][e]]=63744+e,a[63744+e]=s[249][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(o[s[250][e]]=64e3+e,a[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(o[s[251][e]]=64256+e,a[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(o[s[252][e]]=64512+e,a[64512+e]=s[252][e]);for(s[253]="".split(""),e=0;e!=s[253].length;++e)s[253][e].charCodeAt(0)!==65533&&(o[s[253][e]]=64768+e,a[64768+e]=s[253][e]);return{enc:o,dec:a}})(),n[950]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(o[s[170][e]]=43520+e,a[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(o[s[171][e]]=43776+e,a[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(o[s[172][e]]=44032+e,a[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(o[s[173][e]]=44288+e,a[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(o[s[174][e]]=44544+e,a[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(o[s[175][e]]=44800+e,a[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(o[s[201][e]]=51456+e,a[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(o[s[248][e]]=63488+e,a[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(o[s[249][e]]=63744+e,a[63744+e]=s[249][e]);return{enc:o,dec:a}})(),n[1250]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1251]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1252]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1253]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1254]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1255]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1256]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1257]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1258]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[1e4]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10006]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10007]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10008]=(function(){var a=[],o={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(o[s[0][e]]=0+e,a[0+e]=s[0][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(o[s[161][e]]=41216+e,a[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(o[s[162][e]]=41472+e,a[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(o[s[163][e]]=41728+e,a[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(o[s[164][e]]=41984+e,a[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(o[s[165][e]]=42240+e,a[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(o[s[166][e]]=42496+e,a[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(o[s[167][e]]=42752+e,a[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(o[s[168][e]]=43008+e,a[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(o[s[169][e]]=43264+e,a[43264+e]=s[169][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(o[s[176][e]]=45056+e,a[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(o[s[177][e]]=45312+e,a[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(o[s[178][e]]=45568+e,a[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(o[s[179][e]]=45824+e,a[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(o[s[180][e]]=46080+e,a[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(o[s[181][e]]=46336+e,a[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(o[s[182][e]]=46592+e,a[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(o[s[183][e]]=46848+e,a[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(o[s[184][e]]=47104+e,a[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(o[s[185][e]]=47360+e,a[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(o[s[186][e]]=47616+e,a[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(o[s[187][e]]=47872+e,a[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(o[s[188][e]]=48128+e,a[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(o[s[189][e]]=48384+e,a[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(o[s[190][e]]=48640+e,a[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(o[s[191][e]]=48896+e,a[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(o[s[192][e]]=49152+e,a[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(o[s[193][e]]=49408+e,a[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(o[s[194][e]]=49664+e,a[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(o[s[195][e]]=49920+e,a[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(o[s[196][e]]=50176+e,a[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(o[s[197][e]]=50432+e,a[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(o[s[198][e]]=50688+e,a[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(o[s[199][e]]=50944+e,a[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(o[s[200][e]]=51200+e,a[51200+e]=s[200][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(o[s[201][e]]=51456+e,a[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(o[s[202][e]]=51712+e,a[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(o[s[203][e]]=51968+e,a[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(o[s[204][e]]=52224+e,a[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(o[s[205][e]]=52480+e,a[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(o[s[206][e]]=52736+e,a[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(o[s[207][e]]=52992+e,a[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(o[s[208][e]]=53248+e,a[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(o[s[209][e]]=53504+e,a[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(o[s[210][e]]=53760+e,a[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(o[s[211][e]]=54016+e,a[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(o[s[212][e]]=54272+e,a[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(o[s[213][e]]=54528+e,a[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(o[s[214][e]]=54784+e,a[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(o[s[215][e]]=55040+e,a[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(o[s[216][e]]=55296+e,a[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(o[s[217][e]]=55552+e,a[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(o[s[218][e]]=55808+e,a[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(o[s[219][e]]=56064+e,a[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(o[s[220][e]]=56320+e,a[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(o[s[221][e]]=56576+e,a[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(o[s[222][e]]=56832+e,a[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(o[s[223][e]]=57088+e,a[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(o[s[224][e]]=57344+e,a[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(o[s[225][e]]=57600+e,a[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(o[s[226][e]]=57856+e,a[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(o[s[227][e]]=58112+e,a[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(o[s[228][e]]=58368+e,a[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(o[s[229][e]]=58624+e,a[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(o[s[230][e]]=58880+e,a[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(o[s[231][e]]=59136+e,a[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(o[s[232][e]]=59392+e,a[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(o[s[233][e]]=59648+e,a[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(o[s[234][e]]=59904+e,a[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(o[s[235][e]]=60160+e,a[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(o[s[236][e]]=60416+e,a[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(o[s[237][e]]=60672+e,a[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(o[s[238][e]]=60928+e,a[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(o[s[239][e]]=61184+e,a[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(o[s[240][e]]=61440+e,a[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(o[s[241][e]]=61696+e,a[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(o[s[242][e]]=61952+e,a[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(o[s[243][e]]=62208+e,a[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(o[s[244][e]]=62464+e,a[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(o[s[245][e]]=62720+e,a[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(o[s[246][e]]=62976+e,a[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(o[s[247][e]]=63232+e,a[63232+e]=s[247][e]);return{enc:o,dec:a}})(),n[10029]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10079]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[10081]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),n[28591]=(function(){for(var a=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,o=[],s={},e=0;e!=a.length;++e)a.charCodeAt(e)!==65533&&(s[a.charAt(e)]=e),o[e]=a.charAt(e);return{enc:s,dec:o}})(),l.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"&&(l.exports=n);(function(a,o){if(typeof n>"u")if(typeof fp<"u"){var s=n;l.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"?l.exports=o(s):a.cptable=o(s)}else throw new Error("cptable not found");else n=o(n)})(_7,function(a){var o={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},s=[874,1250,1251,1252,1253,1254,1255,1256,1e4],e=[932,936,949,950],m=[65001],v={},w={},N={},S={},D=function(me){return String.fromCharCode(me)},L=function(me){return me.charCodeAt(0)},M=typeof Buffer<"u",F=function(){};if(M){var O=!Buffer.from;if(!O)try{Buffer.from("foo","utf8")}catch{O=!0}F=O?function(te,me){return me?new Buffer(te,me):new Buffer(te)}:Buffer.from.bind(Buffer),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(te){return new Buffer(te)});var P=1024,G=Buffer.allocUnsafe(P),ae=function(me){for(var W=Buffer.allocUnsafe(65536),pe=0;pe<65536;++pe)W[pe]=0;for(var Le=Object.keys(me),Ae=Le.length,V=0,H=Le[V];V<Ae;++V)(H=Le[V])&&(W[H.charCodeAt(0)]=me[H]);return W},re=function(me){var W=ae(a[me].enc);return function(Le,Ae){var V=Le.length,H,Q=0,se=0,de=0,we=0;if(typeof Le=="string")for(H=Buffer.allocUnsafe(V),Q=0;Q<V;++Q)H[Q]=W[Le.charCodeAt(Q)];else if(Buffer.isBuffer(Le)){for(H=Buffer.allocUnsafe(2*V),se=0,Q=0;Q<V;++Q)de=Le[Q],de<128?H[se++]=W[de]:de<224?(H[se++]=W[((de&31)<<6)+(Le[Q+1]&63)],++Q):de<240?(H[se++]=W[((de&15)<<12)+((Le[Q+1]&63)<<6)+(Le[Q+2]&63)],Q+=2):(we=((de&7)<<18)+((Le[Q+1]&63)<<12)+((Le[Q+2]&63)<<6)+(Le[Q+3]&63),Q+=3,we<65536?H[se++]=W[we]:(we-=65536,H[se++]=W[55296+(we>>10&1023)],H[se++]=W[56320+(we&1023)]));H=H.slice(0,se)}else for(H=Buffer.allocUnsafe(V),Q=0;Q<V;++Q)H[Q]=W[Le[Q].charCodeAt(0)];return!Ae||Ae==="buf"?H:Ae!=="arr"?H.toString("binary"):[].slice.call(H)}},ke=function(me){var W=a[me].dec,pe=Buffer.allocUnsafe(131072),Le=0,Ae="";for(Le=0;Le<W.length;++Le)if(Ae=W[Le]){var V=Ae.charCodeAt(0);pe[2*Le]=V&255,pe[2*Le+1]=V>>8}return function(Q){var se=Q.length,de=0,we=0;if(2*se>P&&(P=2*se,G=Buffer.allocUnsafe(P)),Buffer.isBuffer(Q))for(de=0;de<se;de++)we=2*Q[de],G[2*de]=pe[we],G[2*de+1]=pe[we+1];else if(typeof Q=="string")for(de=0;de<se;de++)we=2*Q.charCodeAt(de),G[2*de]=pe[we],G[2*de+1]=pe[we+1];else for(de=0;de<se;de++)we=2*Q[de],G[2*de]=pe[we],G[2*de+1]=pe[we+1];return G.slice(0,2*se).toString("ucs2")}},xe=function(me){for(var W=a[me].enc,pe=Buffer.allocUnsafe(131072),Le=0;Le<131072;++Le)pe[Le]=0;for(var Ae=Object.keys(W),V=0,H=Ae[V];V<Ae.length;++V)if(H=Ae[V]){var Q=H.charCodeAt(0);pe[2*Q]=W[H]&255,pe[2*Q+1]=W[H]>>8}return function(de,we){var Ce=de.length,ne=Buffer.allocUnsafe(2*Ce),ve=0,Ge=0,vt=0,ze=0,jt=0;if(typeof de=="string"){for(ve=ze=0;ve<Ce;++ve)Ge=de.charCodeAt(ve)*2,ne[ze++]=pe[Ge+1]||pe[Ge],pe[Ge+1]>0&&(ne[ze++]=pe[Ge]);ne=ne.slice(0,ze)}else if(Buffer.isBuffer(de)){for(ve=ze=0;ve<Ce;++ve)jt=de[ve],jt<128?Ge=jt:jt<224?(Ge=((jt&31)<<6)+(de[ve+1]&63),++ve):jt<240?(Ge=((jt&15)<<12)+((de[ve+1]&63)<<6)+(de[ve+2]&63),ve+=2):(Ge=((jt&7)<<18)+((de[ve+1]&63)<<12)+((de[ve+2]&63)<<6)+(de[ve+3]&63),ve+=3),Ge<65536?(Ge*=2,ne[ze++]=pe[Ge+1]||pe[Ge],pe[Ge+1]>0&&(ne[ze++]=pe[Ge])):(vt=Ge-65536,Ge=2*(55296+(vt>>10&1023)),ne[ze++]=pe[Ge+1]||pe[Ge],pe[Ge+1]>0&&(ne[ze++]=pe[Ge]),Ge=2*(56320+(vt&1023)),ne[ze++]=pe[Ge+1]||pe[Ge],pe[Ge+1]>0&&(ne[ze++]=pe[Ge]));ne=ne.slice(0,ze)}else for(ve=ze=0;ve<Ce;ve++)Ge=de[ve].charCodeAt(0)*2,ne[ze++]=pe[Ge+1]||pe[Ge],pe[Ge+1]>0&&(ne[ze++]=pe[Ge]);return!we||we==="buf"?ne:we!=="arr"?ne.toString("binary"):[].slice.call(ne)}},je=function(me){var W=a[me].dec,pe=Buffer.allocUnsafe(131072),Le=0,Ae,V=0,H=0,Q=0;for(Q=0;Q<65536;++Q)pe[2*Q]=255,pe[2*Q+1]=253;for(Le=0;Le<W.length;++Le)(Ae=W[Le])&&(V=Ae.charCodeAt(0),H=2*Le,pe[H]=V&255,pe[H+1]=V>>8);return function(de){var we=de.length,Ce=Buffer.allocUnsafe(2*we),ne=0,ve=0,Ge=0;if(Buffer.isBuffer(de))for(ne=0;ne<we;ne++)ve=2*de[ne],pe[ve]===255&&pe[ve+1]===253&&(ve=2*((de[ne]<<8)+de[ne+1]),++ne),Ce[Ge++]=pe[ve],Ce[Ge++]=pe[ve+1];else if(typeof de=="string")for(ne=0;ne<we;ne++)ve=2*de.charCodeAt(ne),pe[ve]===255&&pe[ve+1]===253&&(ve=2*((de.charCodeAt(ne)<<8)+de.charCodeAt(ne+1)),++ne),Ce[Ge++]=pe[ve],Ce[Ge++]=pe[ve+1];else for(ne=0;ne<we;ne++)ve=2*de[ne],pe[ve]===255&&pe[ve+1]===253&&(ve=2*((de[ne]<<8)+de[ne+1]),++ne),Ce[Ge++]=pe[ve],Ce[Ge++]=pe[ve+1];return Ce.slice(0,Ge).toString("ucs2")}};v[65001]=function te(me){if(typeof me=="string")return te(me.split("").map(L));var W=me.length,pe=0,Le=0;4*W>P&&(P=4*W,G=Buffer.allocUnsafe(P));var Ae=0;W>=3&&me[0]==239&&me[1]==187&&me[2]==191&&(Ae=3);for(var V=1,H=0,Q=0;Ae<W;Ae+=V)V=1,Q=me[Ae],Q<128?pe=Q:Q<224?(pe=(Q&31)*64+(me[Ae+1]&63),V=2):Q<240?(pe=((Q&15)<<12)+(me[Ae+1]&63)*64+(me[Ae+2]&63),V=3):(pe=(Q&7)*262144+((me[Ae+1]&63)<<12)+(me[Ae+2]&63)*64+(me[Ae+3]&63),V=4),pe<65536?(G[H++]=pe&255,G[H++]=pe>>8):(pe-=65536,Le=55296+(pe>>10&1023),pe=56320+(pe&1023),G[H++]=Le&255,G[H++]=Le>>>8,G[H++]=pe&255,G[H++]=pe>>>8&255);return G.slice(0,H).toString("ucs2")},w[65001]=function(me,W){if(M&&Buffer.isBuffer(me))return!W||W==="buf"?me:W!=="arr"?me.toString("binary"):[].slice.call(me);var pe=me.length,Le=0,Ae=0,V=0,H=typeof me=="string";4*pe>P&&(P=4*pe,G=Buffer.allocUnsafe(P));for(var Q=0;Q<pe;++Q)Le=H?me.charCodeAt(Q):me[Q].charCodeAt(0),Le<=127?G[V++]=Le:Le<=2047?(G[V++]=192+(Le>>6),G[V++]=128+(Le&63)):Le>=55296&&Le<=57343?(Le-=55296,++Q,Ae=(H?me.charCodeAt(Q):me[Q].charCodeAt(0))-56320+(Le<<10),G[V++]=240+(Ae>>>18&7),G[V++]=144+(Ae>>>12&63),G[V++]=128+(Ae>>>6&63),G[V++]=128+(Ae&63)):(G[V++]=224+(Le>>12),G[V++]=128+(Le>>6&63),G[V++]=128+(Le&63));return!W||W==="buf"?G.slice(0,V):W!=="arr"?G.slice(0,V).toString("binary"):[].slice.call(G,0,V)}}var Z=function(){if(M){if(N[s[0]])return;var me=0,W=0;for(me=0;me<s.length;++me)W=s[me],a[W]&&(N[W]=ke(W),S[W]=re(W));for(me=0;me<e.length;++me)W=e[me],a[W]&&(N[W]=je(W),S[W]=xe(W));for(me=0;me<m.length;++me)W=m[me],v[W]&&(N[W]=v[W]),w[W]&&(S[W]=w[W])}},ce=function(te,me){return""},ue=function(me){delete N[me],delete S[me]},Re=function(){if(M){if(!N[s[0]])return;s.forEach(ue),e.forEach(ue),m.forEach(ue)}ye=ce,Te=0},be={encache:Z,decache:Re,sbcs:s,dbcs:e};Z();var oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",he="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?",ye=ce,Te=0,fe=function te(me,W,pe){if(me===Te&&ye)return ye(W,pe);if(S[me])return ye=S[Te=me],ye(W,pe);M&&Buffer.isBuffer(W)&&(W=W.toString("utf8"));var Le=W.length,Ae=M?Buffer.allocUnsafe(4*Le):[],V=0,H=0,Q=0,se=0,de=a[me],we,Ce="",ne=typeof W=="string";if(de&&(we=de.enc))for(H=0;H<Le;++H,++Q)V=we[ne?W.charAt(H):W[H]],V>255?(Ae[Q]=V>>8,Ae[++Q]=V&255):Ae[Q]=V&255;else if(Ce=o[me])switch(Ce){case"utf8":if(M&&ne){Ae=F(W,Ce),Q=Ae.length;break}for(H=0;H<Le;++H,++Q)V=ne?W.charCodeAt(H):W[H].charCodeAt(0),V<=127?Ae[Q]=V:V<=2047?(Ae[Q]=192+(V>>6),Ae[++Q]=128+(V&63)):V>=55296&&V<=57343?(V-=55296,se=(ne?W.charCodeAt(++H):W[++H].charCodeAt(0))-56320+(V<<10),Ae[Q]=240+(se>>>18&7),Ae[++Q]=144+(se>>>12&63),Ae[++Q]=128+(se>>>6&63),Ae[++Q]=128+(se&63)):(Ae[Q]=224+(V>>12),Ae[++Q]=128+(V>>6&63),Ae[++Q]=128+(V&63));break;case"ascii":if(M&&typeof W=="string"){Ae=F(W,Ce),Q=Ae.length;break}for(H=0;H<Le;++H,++Q)if(V=ne?W.charCodeAt(H):W[H].charCodeAt(0),V<=127)Ae[Q]=V;else throw new Error("bad ascii "+V);break;case"utf16le":if(M&&typeof W=="string"){Ae=F(W,Ce),Q=Ae.length;break}for(H=0;H<Le;++H)V=ne?W.charCodeAt(H):W[H].charCodeAt(0),Ae[Q++]=V&255,Ae[Q++]=V>>8;break;case"utf16be":for(H=0;H<Le;++H)V=ne?W.charCodeAt(H):W[H].charCodeAt(0),Ae[Q++]=V>>8,Ae[Q++]=V&255;break;case"utf32le":for(H=0;H<Le;++H)V=ne?W.charCodeAt(H):W[H].charCodeAt(0),V>=55296&&V<=57343&&(V=65536+(V-55296<<10)+(W[++H].charCodeAt(0)-56320)),Ae[Q++]=V&255,V>>=8,Ae[Q++]=V&255,V>>=8,Ae[Q++]=V&255,V>>=8,Ae[Q++]=V&255;break;case"utf32be":for(H=0;H<Le;++H)V=ne?W.charCodeAt(H):W[H].charCodeAt(0),V>=55296&&V<=57343&&(V=65536+(V-55296<<10)+(W[++H].charCodeAt(0)-56320)),Ae[Q+3]=V&255,V>>=8,Ae[Q+2]=V&255,V>>=8,Ae[Q+1]=V&255,V>>=8,Ae[Q]=V&255,Q+=4;break;case"utf7":for(H=0;H<Le;H++){var ve=ne?W.charAt(H):W[H].charAt(0);if(ve==="+"){Ae[Q++]=43,Ae[Q++]=45;continue}if(he.indexOf(ve)>-1){Ae[Q++]=ve.charCodeAt(0);continue}var Ge=te(1201,ve);Ae[Q++]=43,Ae[Q++]=oe.charCodeAt(Ge[0]>>2),Ae[Q++]=oe.charCodeAt(((Ge[0]&3)<<4)+((Ge[1]||0)>>4)),Ae[Q++]=oe.charCodeAt(((Ge[1]&15)<<2)+((Ge[2]||0)>>6)),Ae[Q++]=45}break;default:throw new Error("Unsupported magic: "+me+" "+o[me])}else throw new Error("Unrecognized CP: "+me);return Ae=Ae.slice(0,Q),M?!pe||pe==="buf"?Ae:pe!=="arr"?Ae.toString("binary"):[].slice.call(Ae):pe=="str"?Ae.map(D).join(""):Ae},_e=function te(me,W){var pe;if(pe=N[me])return pe(W);if(typeof W=="string")return te(me,W.split("").map(L));var Le=W.length,Ae=new Array(Le),V="",H=0,Q=0,se=1,de=0,we=0,Ce=a[me],ne,ve="";if(Ce&&(ne=Ce.dec))for(Q=0;Q<Le;Q+=se){if(se=2,V=ne[(W[Q]<<8)+W[Q+1]],V||(se=1,V=ne[W[Q]]),!V)throw new Error("Unrecognized code: "+W[Q]+" "+W[Q+se-1]+" "+Q+" "+se+" "+ne[W[Q]]);Ae[de++]=V}else if(ve=o[me])switch(ve){case"utf8":for(Le>=3&&W[0]==239&&W[1]==187&&W[2]==191&&(Q=3);Q<Le;Q+=se)se=1,W[Q]<128?H=W[Q]:W[Q]<224?(H=(W[Q]&31)*64+(W[Q+1]&63),se=2):W[Q]<240?(H=((W[Q]&15)<<12)+(W[Q+1]&63)*64+(W[Q+2]&63),se=3):(H=(W[Q]&7)*262144+((W[Q+1]&63)<<12)+(W[Q+2]&63)*64+(W[Q+3]&63),se=4),H<65536||(H-=65536,we=55296+(H>>10&1023),H=56320+(H&1023),Ae[de++]=String.fromCharCode(we)),Ae[de++]=String.fromCharCode(H);break;case"ascii":if(M&&Buffer.isBuffer(W))return W.toString(ve);for(Q=0;Q<Le;Q++)Ae[Q]=String.fromCharCode(W[Q]);de=Le;break;case"utf16le":if(Le>=2&&W[0]==255&&W[1]==254&&(Q=2),M&&Buffer.isBuffer(W))return W.toString(ve);for(se=2;Q+1<Le;Q+=se)Ae[de++]=String.fromCharCode((W[Q+1]<<8)+W[Q]);break;case"utf16be":for(Le>=2&&W[0]==254&&W[1]==255&&(Q=2),se=2;Q+1<Le;Q+=se)Ae[de++]=String.fromCharCode((W[Q]<<8)+W[Q+1]);break;case"utf32le":for(Le>=4&&W[0]==255&&W[1]==254&&W[2]===0&&W[3]===0&&(Q=4),se=4;Q<Le;Q+=se)H=(W[Q+3]<<24)+(W[Q+2]<<16)+(W[Q+1]<<8)+W[Q],H>65535?(H-=65536,Ae[de++]=String.fromCharCode(55296+(H>>10&1023)),Ae[de++]=String.fromCharCode(56320+(H&1023))):Ae[de++]=String.fromCharCode(H);break;case"utf32be":for(Le>=4&&W[3]==255&&W[2]==254&&W[1]===0&&W[0]===0&&(Q=4),se=4;Q<Le;Q+=se)H=(W[Q]<<24)+(W[Q+1]<<16)+(W[Q+2]<<8)+W[Q+3],H>65535?(H-=65536,Ae[de++]=String.fromCharCode(55296+(H>>10&1023)),Ae[de++]=String.fromCharCode(56320+(H&1023))):Ae[de++]=String.fromCharCode(H);break;case"utf7":for(Le>=4&&W[0]==43&&W[1]==47&&W[2]==118&&(Le>=5&&W[3]==56&&W[4]==45?Q=5:(W[3]==56||W[3]==57||W[3]==43||W[3]==47)&&(Q=4));Q<Le;Q+=se){if(W[Q]!==43){se=1,Ae[de++]=String.fromCharCode(W[Q]);continue}if(se=1,W[Q+1]===45){se=2,Ae[de++]="+";continue}for(;String.fromCharCode(W[Q+se]).match(/[A-Za-z0-9+\/]/);)se++;var Ge=0;W[Q+se]===45&&(++se,Ge=1);for(var vt=[],ze="",jt=0,rt=0,Kt=0,Lt=0,ks=0,_s=0,ms=0,ws=1;ws<se-Ge&&(Lt=oe.indexOf(String.fromCharCode(W[Q+ws++])),ks=oe.indexOf(String.fromCharCode(W[Q+ws++])),jt=Lt<<2|ks>>4,vt.push(jt),_s=oe.indexOf(String.fromCharCode(W[Q+ws++])),!(_s===-1||(rt=(ks&15)<<4|_s>>2,vt.push(rt),ms=oe.indexOf(String.fromCharCode(W[Q+ws++])),ms===-1)));)Kt=(_s&3)<<6|ms,ms<64&&vt.push(Kt);for(ze=te(1201,vt),ws=0;ws<ze.length;++ws)Ae[de++]=ze.charAt(ws)}break;default:throw new Error("Unsupported magic: "+me+" "+o[me])}else throw new Error("Unrecognized CP: "+me);return Ae.slice(0,de).join("")},We=function(me){return!!(a[me]||o[me])};return a.utils={decode:_e,encode:fe,hascp:We,magic:o,cache:be},a})})(mp)),mp.exports}const M7={},L7=Object.freeze(Object.defineProperty({__proto__:null,default:M7},Symbol.toStringTag,{value:"Module"})),I1=Av(L7);var Rb;function R7(){return Rb||(Rb=1,(function(l,n){var a={};function o(s){s.version="0.18.5",s.style_version="1.2.0";var e,m=1200,v=1252;typeof cptable<"u"?e=cptable:typeof fp<"u"&&(e=F7());var w=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},S=function(r){w.indexOf(r)!=-1&&(v=N[0]=r)},D=function(r){S(m=r)};function L(){D(1200),S(1252)}function M(r){for(var d=[],u=0,h=r.length;u<h;++u)d[u]=r.charCodeAt(u);return d}function F(r){for(var d=[],u=0;u<r.length>>1;++u)d[u]=String.fromCharCode(r.charCodeAt(2*u+1)+(r.charCodeAt(2*u)<<8));return d.join("")}var O=function(r){var d=r.charCodeAt(0),u=r.charCodeAt(1);return d==255&&u==254?(function(h){for(var g=[],b=0;b<h.length>>1;++b)g[b]=String.fromCharCode(h.charCodeAt(2*b)+(h.charCodeAt(2*b+1)<<8));return g.join("")})(r.slice(2)):d==254&&u==255?F(r.slice(2)):d==65279?r.slice(1):r},P=function(r){return String.fromCharCode(r)},G=function(r){return String.fromCharCode(r)};e!==void 0&&(D=function(r){S(m=r)},O=function(r){return r.charCodeAt(0)===255&&r.charCodeAt(1)===254?e.utils.decode(1200,M(r.slice(2))):r},P=function(r){return m===1200?String.fromCharCode(r):e.utils.decode(m,[255&r,r>>8])[0]},G=function(r){return e.utils.decode(v,[r])[0]});var ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function re(r){for(var d,u,h,g,b,x="",y=0,j=0,k=0;k<r.length;)g=(d=r.charCodeAt(k++))>>2,b=(3&d)<<4|(u=r.charCodeAt(k++))>>4,y=(15&u)<<2|(h=r.charCodeAt(k++))>>6,j=63&h,isNaN(u)?y=j=64:isNaN(h)&&(j=64),x+=ae.charAt(g)+ae.charAt(b)+ae.charAt(y)+ae.charAt(j);return x}function ke(r){var d,u,h,g,b,x,y="";r=r.replace(/[^\w\+\/\=]/g,"");for(var j=0;j<r.length;)d=ae.indexOf(r.charAt(j++))<<2|(g=ae.indexOf(r.charAt(j++)))>>4,y+=String.fromCharCode(d),u=(15&g)<<4|(b=ae.indexOf(r.charAt(j++)))>>2,b!==64&&(y+=String.fromCharCode(u)),h=(3&b)<<6|(x=ae.indexOf(r.charAt(j++))),x!==64&&(y+=String.fromCharCode(h));return y}var xe=typeof Buffer<"u"&&typeof process<"u"&&process.versions!==void 0&&!!process.versions.node,je=(function(){if(typeof Buffer>"u")return function(){};var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(d,u){return u?new Buffer(d,u):new Buffer(d)}:Buffer.from.bind(Buffer)})();function Z(r){return xe?Buffer.alloc?Buffer.alloc(r):new Buffer(r):new(typeof Uint8Array<"u"?Uint8Array:Array)(r)}function ce(r){return xe?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):new(typeof Uint8Array<"u"?Uint8Array:Array)(r)}var ue=function(r){return xe?je(r,"binary"):r.split("").map(function(d){return 255&d.charCodeAt(0)})};function Re(r){if(typeof ArrayBuffer>"u")return ue(r);for(var d=new ArrayBuffer(r.length),u=new Uint8Array(d),h=0;h!=r.length;++h)u[h]=255&r.charCodeAt(h);return d}function be(r){if(Array.isArray(r))return r.map(function(h){return String.fromCharCode(h)}).join("");for(var d=[],u=0;u<r.length;++u)d[u]=String.fromCharCode(r[u]);return d.join("")}function oe(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return oe(new Uint8Array(r));for(var d=new Array(r.length),u=0;u<r.length;++u)d[u]=r[u];return d}var he=xe?function(r){return Buffer.concat(r.map(function(d){return Buffer.isBuffer(d)?d:je(d)}))}:function(r){if(typeof Uint8Array>"u")return[].concat.apply([],r.map(function(b){return Array.isArray(b)?b:[].slice.call(b)}));for(var u=0,d=0,u=0;u<r.length;++u)d+=r[u].length;for(var h,g=new Uint8Array(d),d=u=0;u<r.length;d+=h,++u)if(h=r[u].length,r[u]instanceof Uint8Array)g.set(r[u],d);else{if(typeof r[u]=="string")throw"wtf";g.set(new Uint8Array(r[u]),d)}return g},ye=/\u0000/g,Te=/[\u0001-\u0006]/g;function fe(r){for(var d="",u=r.length-1;0<=u;)d+=r.charAt(u--);return d}function _e(r,d){return r=""+r,d<=r.length?r:ar("0",d-r.length)+r}function We(r,d){return r=""+r,d<=r.length?r:ar(" ",d-r.length)+r}function te(r,d){return r=""+r,d<=r.length?r:r+ar(" ",d-r.length)}var me=Math.pow(2,32);function W(g,d){if(me<g||g<-me)return u=g,h=d,u=""+Math.round(u),h<=u.length?u:ar("0",h-u.length)+u;var u,h,g=Math.round(g);return(d=d)<=(g=""+(g=g)).length?g:ar("0",d-g.length)+g}function pe(r,d){return d=d||0,r.length>=7+d&&(32|r.charCodeAt(d))==103&&(32|r.charCodeAt(d+1))==101&&(32|r.charCodeAt(d+2))==110&&(32|r.charCodeAt(d+3))==101&&(32|r.charCodeAt(d+4))==114&&(32|r.charCodeAt(d+5))==97&&(32|r.charCodeAt(d+6))==108}var Le=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ae=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],V={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},H={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Q={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function se(r,d,u){for(var h=r<0?-1:1,g=r*h,b=0,x=1,y=0,j=1,k=0,E=0,T=Math.floor(g);k<d&&(y=(T=Math.floor(g))*x+b,E=T*k+j,!(g-T<5e-8));)g=1/(g-T),b=x,x=y,j=k,k=E;return d<E&&(y=d<k?(E=j,b):(E=k,x)),u?(u=Math.floor(h*y/E),[u,h*y-u*E,E]):[0,h*y,E]}function de(y,d,u){if(2958465<y||y<0)return null;var h=0|y,g=Math.floor(86400*(y-h)),b=0,x=[],y={D:h,T:g,u:86400*(y-h)-g,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(y.u)<1e-6&&(y.u=0),d&&d.date1904&&(h+=1462),.9999<y.u&&(y.u=0,++g==86400&&(y.T=g=0,++h,++y.D)),h===60?(x=u?[1317,10,29]:[1900,2,29],b=3):h===0?(x=u?[1317,8,29]:[1900,1,0],b=6):(60<h&&--h,(d=new Date(1900,0,1)).setDate(d.getDate()+h-1),x=[d.getFullYear(),d.getMonth()+1,d.getDate()],b=d.getDay(),h<60&&(b=(b+6)%7),u&&(b=(function(j,k){return k[0]-=581,k=j.getDay(),j<60&&(k=(k+6)%7),k})(d,x))),y.y=x[0],y.m=x[1],y.d=x[2],y.S=g%60,g=Math.floor(g/60),y.M=g%60,g=Math.floor(g/60),y.H=g,y.q=b,y}var we=new Date(1899,11,31,0,0,0),Ce=we.getTime(),ne=new Date(1900,2,1,0,0,0);function ve(r,d){var u=r.getTime();return d?u-=1262304e5:ne<=r&&(u+=864e5),(u-(Ce+6e4*(r.getTimezoneOffset()-we.getTimezoneOffset())))/864e5}function Ge(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function vt(r){var d,u,h,g=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),b=-4<=g&&g<=-1?r.toPrecision(10+g):Math.abs(g)<=9?(u=(d=r)<0?12:11,(h=Ge(d.toFixed(12))).length<=u||(h=d.toPrecision(10)).length<=u?h:d.toExponential(5)):g===10?r.toFixed(10).substr(0,12):(b=Ge((r=r).toFixed(11))).length>(r<0?12:11)||b==="0"||b==="-0"?r.toPrecision(6):b;return Ge((b=b.toUpperCase()).indexOf("E")==-1?b:b.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function ze(r,d){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(0|r)===r?r.toString(10):vt(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return Kr(14,ve(r,d&&d.date1904),d)}throw new Error("unsupported value in General format: "+r)}function jt(r){if(r.length<=3)return r;for(var d=r.length%3,u=r.substr(0,d);d!=r.length;d+=3)u+=(0<u.length?",":"")+r.substr(d,3);return u}var rt=/%/g,Kt=/# (\?+)( ?)\/( ?)(\d+)/,Lt=/^#*0*\.([0#]+)/,ks=/\).*[0#]/,_s=/\(###\) ###\\?-####/;function ms(r){for(var d,u="",h=0;h!=r.length;++h)switch(d=r.charCodeAt(h)){case 35:break;case 63:u+=" ";break;case 48:u+="0";break;default:u+=String.fromCharCode(d)}return u}function ws(r,d){return d=Math.pow(10,d),""+Math.round(r*d)/d}function Ie(h,d){var u=h-Math.floor(h),h=Math.pow(10,d);return d<(""+Math.round(u*h)).length?0:Math.round(u*h)}function st(r,d,u){if(r.charCodeAt(0)===40&&!d.match(ks)){var h=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?st("n",h,u):"("+st("n",h,-u)+")"}if(d.charCodeAt(d.length-1)===44)return(function(z,X,ie){for(var le=X.length-1;X.charCodeAt(le-1)===44;)--le;return xs(z,X.substr(0,le),ie/Math.pow(10,3*(X.length-le)))})(r,d,u);if(d.indexOf("%")!==-1)return y=r,k=u,j=(E=d).replace(rt,""),E=E.length-j.length,xs(y,j,k*Math.pow(10,2*E))+ar("%",E);var g;if(d.indexOf("E")!==-1)return(function z(X,ie){var le,Ee=X.indexOf("E")-X.indexOf(".")-1;if(X.match(/^#+0.0E\+0$/)){if(ie==0)return"0.0E+0";if(ie<0)return"-"+z(X,-ie);var He=X.indexOf(".");He===-1&&(He=X.indexOf("E"));var Pe=Math.floor(Math.log(ie)*Math.LOG10E)%He;if(Pe<0&&(Pe+=He),(le=(ie/Math.pow(10,Pe)).toPrecision(1+Ee+(He+Pe)%He)).indexOf("e")===-1){var Qe=Math.floor(Math.log(ie)*Math.LOG10E);for(le.indexOf(".")===-1?le=le.charAt(0)+"."+le.substr(1)+"E+"+(Qe-le.length+Pe):le+="E+"+(Qe-Pe);le.substr(0,2)==="0.";)le=(le=le.charAt(0)+le.substr(2,He)+"."+le.substr(2+He)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");le=le.replace(/\+-/,"-")}le=le.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(pt,xt,at,kt){return xt+at+kt.substr(0,(He+Pe)%He)+"."+kt.substr(Pe)+"E"})}else le=ie.toExponential(Ee);return X.match(/E\+00$/)&&le.match(/e[+-]\d$/)&&(le=le.substr(0,le.length-1)+"0"+le.charAt(le.length-1)),(le=X.match(/E\-/)&&le.match(/e\+/)?le.replace(/e\+/,"e"):le).replace("e","E")})(d,u);if(d.charCodeAt(0)===36)return"$"+st(r,d.substr(d.charAt(1)==" "?2:1),u);var b,x,y,j,k,E,T,_=Math.abs(u),R=u<0?"-":"";if(d.match(/^00+$/))return R+W(_,d.length);if(d.match(/^[#?]+$/))return(g=(g=W(u,0))==="0"?"":g).length>d.length?g:ms(d.substr(0,d.length-g.length))+g;if(b=d.match(Kt))return T=b,y=_,j=R,k=parseInt(T[4],10),E=Math.round(y*k),y=Math.floor(E/k),j+(y===0?"":""+y)+" "+((E-=y*k)==0?ar(" ",T[1].length+1+T[4].length):We(E,T[1].length)+T[2]+"/"+T[3]+_e(k,T[4].length));if(d.match(/^#+0+$/))return R+W(_,d.length-d.indexOf("0"));if(b=d.match(Lt))return g=ws(u,b[1].length).replace(/^([^\.]+)$/,"$1."+ms(b[1])).replace(/\.$/,"."+ms(b[1])).replace(/\.(\d*)$/,function(z,X){return"."+X+ar("0",ms(b[1]).length-X.length)}),d.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(d=d.replace(/^#+([0.])/,"$1"),b=d.match(/^(0*)\.(#*)$/))return R+ws(_,b[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,b[1].length?"0.":".");if(b=d.match(/^#{1,3},##0(\.?)$/))return R+jt(W(_,0));if(b=d.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+st(r,d,-u):jt(""+(Math.floor(u)+(T=u,(q=b[1].length)<(""+Math.round((T-Math.floor(T))*Math.pow(10,q))).length?1:0)))+"."+_e(Ie(u,b[1].length),b[1].length);if(b=d.match(/^#,#*,#0/))return st(r,d.replace(/^#,#*,/,""),u);if(b=d.match(/^([0#]+)(\\?-([0#]+))+$/))return g=fe(st(r,d.replace(/[\\-]/g,""),u)),x=0,fe(fe(d.replace(/\\/g,"")).replace(/[0#]/g,function(z){return x<g.length?g.charAt(x++):z==="0"?"0":""}));if(d.match(_s))return"("+(g=st(r,"##########",u)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var q="";if(b=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(b[4].length,7),I=se(_,Math.pow(10,x)-1,!1),g=R,(q=xs("n",b[1],I[1])).charAt(q.length-1)==" "&&(q=q.substr(0,q.length-1)+"0"),g+=q+b[2]+"/"+b[3],(q=te(I[2],x)).length<b[4].length&&(q=ms(b[4].substr(b[4].length-q.length))+q),g+=q;if(b=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(Math.max(b[1].length,b[4].length),7),R+((I=se(_,Math.pow(10,x)-1,!0))[0]||(I[1]?"":"0"))+" "+(I[1]?We(I[1],x)+b[2]+"/"+b[3]+te(I[2],x):ar(" ",2*x+1+b[2].length+b[3].length));if(b=d.match(/^[#0?]+$/))return g=W(u,0),d.length<=g.length?g:ms(d.substr(0,d.length-g.length))+g;if(b=d.match(/^([#0?]+)\.([#0]+)$/)){g=""+u.toFixed(Math.min(b[2].length,10)).replace(/([^0])0+$/,"$1"),x=g.indexOf(".");var I=d.indexOf(".")-x,J=d.length-g.length-I;return ms(d.substr(0,I)+g+d.substr(d.length-J))}if(b=d.match(/^00,000\.([#0]*0)$/))return x=Ie(u,b[1].length),u<0?"-"+st(r,d,-u):jt((J=u)<2147483647&&-2147483648<J?""+(0<=J?0|J:J-1|0):""+Math.floor(J)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(z){return"00,"+(z.length<3?_e(0,3-z.length):"")+z})+"."+_e(x,b[1].length);switch(d){case"###,##0.00":return st(r,"#,##0.00",u);case"###,###":case"##,###":case"#,###":var Y=jt(W(_,0));return Y!=="0"?R+Y:"";case"###,###.00":return st(r,"###,##0.00",u).replace(/^0\./,".");case"#,###.00":return st(r,"#,##0.00",u).replace(/^0\./,".")}throw new Error("unsupported format |"+d+"|")}function Dt(r,d,u){if(r.charCodeAt(0)===40&&!d.match(ks)){var h=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?Dt("n",h,u):"("+Dt("n",h,-u)+")"}if(d.charCodeAt(d.length-1)===44)return(function(I,J,Y){for(var z=J.length-1;J.charCodeAt(z-1)===44;)--z;return xs(I,J.substr(0,z),Y/Math.pow(10,3*(J.length-z)))})(r,d,u);if(d.indexOf("%")!==-1)return g=r,x=u,h=(b=d).replace(rt,""),b=b.length-h.length,xs(g,h,x*Math.pow(10,2*b))+ar("%",b);var g,b,x,y;if(d.indexOf("E")!==-1)return(function I(J,Y){var z,X=J.indexOf("E")-J.indexOf(".")-1;if(J.match(/^#+0.0E\+0$/)){if(Y==0)return"0.0E+0";if(Y<0)return"-"+I(J,-Y);var ie=J.indexOf(".");ie===-1&&(ie=J.indexOf("E"));var le,Ee=Math.floor(Math.log(Y)*Math.LOG10E)%ie;Ee<0&&(Ee+=ie),(z=(Y/Math.pow(10,Ee)).toPrecision(1+X+(ie+Ee)%ie)).match(/[Ee]/)||(le=Math.floor(Math.log(Y)*Math.LOG10E),z.indexOf(".")===-1?z=z.charAt(0)+"."+z.substr(1)+"E+"+(le-z.length+Ee):z+="E+"+(le-Ee),z=z.replace(/\+-/,"-")),z=z.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(He,Pe,Qe,pt){return Pe+Qe+pt.substr(0,(ie+Ee)%ie)+"."+pt.substr(Ee)+"E"})}else z=Y.toExponential(X);return J.match(/E\+00$/)&&z.match(/e[+-]\d$/)&&(z=z.substr(0,z.length-1)+"0"+z.charAt(z.length-1)),(z=J.match(/E\-/)&&z.match(/e\+/)?z.replace(/e\+/,"e"):z).replace("e","E")})(d,u);if(d.charCodeAt(0)===36)return"$"+Dt(r,d.substr(d.charAt(1)==" "?2:1),u);var j,k,E=Math.abs(u),T=u<0?"-":"";if(d.match(/^00+$/))return T+_e(E,d.length);if(d.match(/^[#?]+$/))return(y=u===0?"":""+u).length>d.length?y:ms(d.substr(0,d.length-y.length))+y;if(j=d.match(Kt))return T+((_=E)===0?"":""+_)+ar(" ",(_=j)[1].length+2+_[4].length);if(d.match(/^#+0+$/))return T+_e(E,d.length-d.indexOf("0"));if(j=d.match(Lt))return y=(y=(""+u).replace(/^([^\.]+)$/,"$1."+ms(j[1])).replace(/\.$/,"."+ms(j[1]))).replace(/\.(\d*)$/,function(I,J){return"."+J+ar("0",ms(j[1]).length-J.length)}),d.indexOf("0.")!==-1?y:y.replace(/^0\./,".");if(d=d.replace(/^#+([0.])/,"$1"),j=d.match(/^(0*)\.(#*)$/))return T+(""+E).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,j[1].length?"0.":".");if(j=d.match(/^#{1,3},##0(\.?)$/))return T+jt(""+E);if(j=d.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+Dt(r,d,-u):jt(""+u)+"."+ar("0",j[1].length);if(j=d.match(/^#,#*,#0/))return Dt(r,d.replace(/^#,#*,/,""),u);if(j=d.match(/^([0#]+)(\\?-([0#]+))+$/))return y=fe(Dt(r,d.replace(/[\\-]/g,""),u)),k=0,fe(fe(d.replace(/\\/g,"")).replace(/[0#]/g,function(I){return k<y.length?y.charAt(k++):I==="0"?"0":""}));if(d.match(_s))return"("+(y=Dt(r,"##########",u)).substr(0,3)+") "+y.substr(3,3)+"-"+y.substr(6);var _="";if(j=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(j[4].length,7),R=se(E,Math.pow(10,k)-1,!1),y=T,(_=xs("n",j[1],R[1])).charAt(_.length-1)==" "&&(_=_.substr(0,_.length-1)+"0"),y+=_+j[2]+"/"+j[3],(_=te(R[2],k)).length<j[4].length&&(_=ms(j[4].substr(j[4].length-_.length))+_),y+=_;if(j=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(j[1].length,j[4].length),7),T+((R=se(E,Math.pow(10,k)-1,!0))[0]||(R[1]?"":"0"))+" "+(R[1]?We(R[1],k)+j[2]+"/"+j[3]+te(R[2],k):ar(" ",2*k+1+j[2].length+j[3].length));if(j=d.match(/^[#0?]+$/))return y=""+u,d.length<=y.length?y:ms(d.substr(0,d.length-y.length))+y;if(j=d.match(/^([#0]+)\.([#0]+)$/)){y=""+u.toFixed(Math.min(j[2].length,10)).replace(/([^0])0+$/,"$1"),k=y.indexOf(".");var _=d.indexOf(".")-k,R=d.length-y.length-_;return ms(d.substr(0,_)+y+d.substr(d.length-R))}if(j=d.match(/^00,000\.([#0]*0)$/))return u<0?"-"+Dt(r,d,-u):jt(""+u).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(I){return"00,"+(I.length<3?_e(0,3-I.length):"")+I})+"."+_e(0,j[1].length);switch(d){case"###,###":case"##,###":case"#,###":var q=jt(""+E);return q!=="0"?T+q:"";default:if(d.match(/\.[0#?]*$/))return Dt(r,d.slice(0,d.lastIndexOf(".")),u)+ms(d.slice(d.lastIndexOf(".")))}throw new Error("unsupported format |"+d+"|")}function xs(r,d,u){return((0|u)===u?Dt:st)(r,d,u)}var Pa=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function dr(r){for(var d=0,u="",h="";d<r.length;)switch(u=r.charAt(d)){case"G":pe(r,d)&&(d+=6),d++;break;case'"':for(;r.charCodeAt(++d)!==34&&d<r.length;);++d;break;case"\\":case"_":d+=2;break;case"@":++d;break;case"B":case"b":if(r.charAt(d+1)==="1"||r.charAt(d+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(d,3).toUpperCase()==="A/P"||r.substr(d,5).toUpperCase()==="AM/PM"||r.substr(d,5).toUpperCase()==="/")return!0;++d;break;case"[":for(h=u;r.charAt(d++)!=="]"&&d<r.length;)h+=r.charAt(d);if(h.match(Pa))return!0;break;case".":case"0":case"#":for(;d<r.length&&(-1<"0#?.,E+-%".indexOf(u=r.charAt(++d))||u=="\\"&&r.charAt(d+1)=="-"&&-1<"0#".indexOf(r.charAt(d+2))););break;case"?":for(;r.charAt(++d)===u;);break;case"*":++d,r.charAt(d)!=" "&&r.charAt(d)!="*"||++d;break;case"(":case")":++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;d<r.length&&-1<"0123456789".indexOf(r.charAt(++d)););break;default:++d}return!1}function Io(r,d,u,h){for(var g,b,x,y=[],j="",k=0,E="",T="t",_="H";k<r.length;)switch(E=r.charAt(k)){case"G":if(!pe(r,k))throw new Error("unrecognized character "+E+" in "+r);y[y.length]={t:"G",v:"General"},k+=7;break;case'"':for(j="";(x=r.charCodeAt(++k))!==34&&k<r.length;)j+=String.fromCharCode(x);y[y.length]={t:"t",v:j},++k;break;case"\\":var R=r.charAt(++k),q=R==="("||R===")"?R:"t";y[y.length]={t:q,v:R},++k;break;case"_":y[y.length]={t:"t",v:" "},k+=2;break;case"@":y[y.length]={t:"T",v:d},++k;break;case"B":case"b":if(r.charAt(k+1)==="1"||r.charAt(k+1)==="2"){if(g==null&&(g=de(d,u,r.charAt(k+1)==="2"))==null)return"";y[y.length]={t:"X",v:r.substr(k,2)},T=E,k+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":E=E.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(d<0||g==null&&(g=de(d,u))==null)return"";for(j=E;++k<r.length&&r.charAt(k).toLowerCase()===E;)j+=E;(E=E==="m"&&T.toLowerCase()==="h"?"M":E)==="h"&&(E=_),y[y.length]={t:E,v:j},T=E;break;case"A":case"a":case"":if(R={t:E,v:E},g==null&&(g=de(d,u)),r.substr(k,3).toUpperCase()==="A/P"?(g!=null&&(R.v=12<=g.H?"P":"A"),R.t="T",_="h",k+=3):r.substr(k,5).toUpperCase()==="AM/PM"?(g!=null&&(R.v=12<=g.H?"PM":"AM"),R.t="T",k+=5,_="h"):r.substr(k,5).toUpperCase()==="/"?(g!=null&&(R.v=12<=g.H?"":""),R.t="T",k+=5,_="h"):(R.t="t",++k),g==null&&R.t==="T")return"";y[y.length]=R,T=E;break;case"[":for(j=E;r.charAt(k++)!=="]"&&k<r.length;)j+=r.charAt(k);if(j.slice(-1)!=="]")throw'unterminated "[" block: |'+j+"|";if(j.match(Pa)){if(g==null&&(g=de(d,u))==null)return"";y[y.length]={t:"Z",v:j.toLowerCase()},T=j.charAt(1)}else-1<j.indexOf("$")&&(j=(j.match(/\$([^-\[\]]*)/)||[])[1]||"$",dr(r)||(y[y.length]={t:"t",v:j}));break;case".":if(g!=null){for(j=E;++k<r.length&&(E=r.charAt(k))==="0";)j+=E;y[y.length]={t:"s",v:j};break}case"0":case"#":for(j=E;++k<r.length&&-1<"0#?.,E+-%".indexOf(E=r.charAt(k));)j+=E;y[y.length]={t:"n",v:j};break;case"?":for(j=E;r.charAt(++k)===E;)j+=E;y[y.length]={t:E,v:j},T=E;break;case"*":++k,r.charAt(k)!=" "&&r.charAt(k)!="*"||++k;break;case"(":case")":y[y.length]={t:h===1?"t":E,v:E},++k;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(j=E;k<r.length&&-1<"0123456789".indexOf(r.charAt(++k));)j+=r.charAt(k);y[y.length]={t:"D",v:j};break;case" ":y[y.length]={t:E,v:E},++k;break;case"$":y[y.length]={t:"t",v:"$"},++k;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(E)===-1)throw new Error("unrecognized character "+E+" in "+r);y[y.length]={t:"t",v:E},++k}var I,J=0,Y=0;for(k=y.length-1,T="t";0<=k;--k)switch(y[k].t){case"h":case"H":y[k].t=_,T="h",J<1&&(J=1);break;case"s":(I=y[k].v.match(/\.0+$/))&&(Y=Math.max(Y,I[0].length-1)),J<3&&(J=3);case"d":case"y":case"M":case"e":T=y[k].t;break;case"m":T==="s"&&(y[k].t="M",J<2&&(J=2));break;case"X":break;case"Z":(J=(J=J<1&&y[k].v.match(/[Hh]/)?1:J)<2&&y[k].v.match(/[Mm]/)?2:J)<3&&y[k].v.match(/[Ss]/)&&(J=3)}switch(J){case 0:break;case 1:.5<=g.u&&(g.u=0,++g.S),60<=g.S&&(g.S=0,++g.M),60<=g.M&&(g.M=0,++g.H);break;case 2:.5<=g.u&&(g.u=0,++g.S),60<=g.S&&(g.S=0,++g.M)}var z,X="";for(k=0;k<y.length;++k)switch(y[k].t){case"t":case"T":case" ":case"D":break;case"X":y[k].v="",y[k].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":y[k].v=(function(pt,xt,at,kt){var Wt,Ht="",Mt=0,Ot=0,_t=at.y,wt=0;switch(pt){case 98:_t=at.y+543;case 121:switch(xt.length){case 1:case 2:Wt=_t%100,wt=2;break;default:Wt=_t%1e4,wt=4}break;case 109:switch(xt.length){case 1:case 2:Wt=at.m,wt=xt.length;break;case 3:return Ae[at.m-1][1];case 5:return Ae[at.m-1][0];default:return Ae[at.m-1][2]}break;case 100:switch(xt.length){case 1:case 2:Wt=at.d,wt=xt.length;break;case 3:return Le[at.q][0];default:return Le[at.q][1]}break;case 104:switch(xt.length){case 1:case 2:Wt=1+(at.H+11)%12,wt=xt.length;break;default:throw"bad hour format: "+xt}break;case 72:switch(xt.length){case 1:case 2:Wt=at.H,wt=xt.length;break;default:throw"bad hour format: "+xt}break;case 77:switch(xt.length){case 1:case 2:Wt=at.M,wt=xt.length;break;default:throw"bad minute format: "+xt}break;case 115:if(xt!="s"&&xt!="ss"&&xt!=".0"&&xt!=".00"&&xt!=".000")throw"bad second format: "+xt;return at.u!==0||xt!="s"&&xt!="ss"?(60*(Ot=2<=kt?kt===3?1e3:100:kt===1?10:1)<=(Mt=Math.round(Ot*(at.S+at.u)))&&(Mt=0),xt==="s"?Mt===0?"0":""+Mt/Ot:(Ht=_e(Mt,2+kt),xt==="ss"?Ht.substr(0,2):"."+Ht.substr(2,xt.length-1))):_e(at.S,xt.length);case 90:switch(xt){case"[h]":case"[hh]":Wt=24*at.D+at.H;break;case"[m]":case"[mm]":Wt=60*(24*at.D+at.H)+at.M;break;case"[s]":case"[ss]":Wt=60*(60*(24*at.D+at.H)+at.M)+Math.round(at.S+at.u);break;default:throw"bad abstime format: "+xt}wt=xt.length===3?1:2;break;case 101:Wt=_t,wt=1}return 0<wt?_e(Wt,wt):""})(y[k].t.charCodeAt(0),y[k].v,g,Y),y[k].t="t";break;case"n":case"?":for(z=k+1;y[z]!=null&&((E=y[z].t)==="?"||E==="D"||(E===" "||E==="t")&&y[z+1]!=null&&(y[z+1].t==="?"||y[z+1].t==="t"&&y[z+1].v==="/")||y[k].t==="("&&(E===" "||E==="n"||E===")")||E==="t"&&(y[z].v==="/"||y[z].v===" "&&y[z+1]!=null&&y[z+1].t=="?"));)y[k].v+=y[z].v,y[z]={v:"",t:";"},++z;X+=y[k].v,k=z-1;break;case"G":y[k].t="t",y[k].v=ze(d,u)}var ie,le,Ee="";if(0<X.length){X.charCodeAt(0)==40?(ie=d<0&&X.charCodeAt(0)===45?-d:d,le=xs("n",X,ie)):(le=xs("n",X,ie=d<0&&1<h?-d:d),ie<0&&y[0]&&y[0].t=="t"&&(le=le.substr(1),y[0].v="-"+y[0].v)),z=le.length-1;for(var He=y.length,k=0;k<y.length;++k)if(y[k]!=null&&y[k].t!="t"&&-1<y[k].v.indexOf(".")){He=k;break}var Pe=y.length;if(He===y.length&&le.indexOf("E")===-1){for(k=y.length-1;0<=k;--k)y[k]!=null&&"n?".indexOf(y[k].t)!==-1&&(z>=y[k].v.length-1?(z-=y[k].v.length,y[k].v=le.substr(z+1,y[k].v.length)):z<0?y[k].v="":(y[k].v=le.substr(0,z+1),z=-1),y[k].t="t",Pe=k);0<=z&&Pe<y.length&&(y[Pe].v=le.substr(0,z+1)+y[Pe].v)}else if(He!==y.length&&le.indexOf("E")===-1){for(z=le.indexOf(".")-1,k=He;0<=k;--k)if(y[k]!=null&&"n?".indexOf(y[k].t)!==-1){for(b=-1<y[k].v.indexOf(".")&&k===He?y[k].v.indexOf(".")-1:y[k].v.length-1,Ee=y[k].v.substr(b+1);0<=b;--b)0<=z&&(y[k].v.charAt(b)==="0"||y[k].v.charAt(b)==="#")&&(Ee=le.charAt(z--)+Ee);y[k].v=Ee,y[k].t="t",Pe=k}for(0<=z&&Pe<y.length&&(y[Pe].v=le.substr(0,z+1)+y[Pe].v),z=le.indexOf(".")+1,k=He;k<y.length;++k)if(y[k]!=null&&("n?(".indexOf(y[k].t)!==-1||k===He)){for(b=-1<y[k].v.indexOf(".")&&k===He?y[k].v.indexOf(".")+1:0,Ee=y[k].v.substr(0,b);b<y[k].v.length;++b)z<le.length&&(Ee+=le.charAt(z++));y[k].v=Ee,y[k].t="t",Pe=k}}}for(k=0;k<y.length;++k)y[k]!=null&&-1<"n?".indexOf(y[k].t)&&(ie=1<h&&d<0&&0<k&&y[k-1].v==="-"?-d:d,y[k].v=xs(y[k].t,y[k].v,ie),y[k].t="t");var Qe="";for(k=0;k!==y.length;++k)y[k]!=null&&(Qe+=y[k].v);return Qe}var Qc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function zn(r,d){if(d!=null){var u=parseFloat(d[2]);switch(d[1]){case"=":if(r==u)return 1;break;case">":if(u<r)return 1;break;case"<":if(r<u)return 1;break;case"<>":if(r!=u)return 1;break;case">=":if(u<=r)return 1;break;case"<=":if(r<=u)return 1}}}function Ga(r,d){var u=(function(x){for(var y=[],j=!1,k=0,E=0;k<x.length;++k)switch(x.charCodeAt(k)){case 34:j=!j;break;case 95:case 42:case 92:++k;break;case 59:y[y.length]=x.substr(E,k-E),E=k+1}if(y[y.length]=x.substr(E),j===!0)throw new Error("Format |"+x+"| unterminated string ");return y})(r),h=u.length,g=u[h-1].indexOf("@");if(h<4&&-1<g&&--h,4<u.length)throw new Error("cannot find right format for |"+u.join("|")+"|");if(typeof d!="number")return[4,u.length===4||-1<g?u[u.length-1]:"@"];switch(u.length){case 1:u=-1<g?["General","General","General",u[0]]:[u[0],u[0],u[0],"@"];break;case 2:u=-1<g?[u[0],u[0],u[0],u[1]]:[u[0],u[1],u[0],"@"];break;case 3:u=-1<g?[u[0],u[1],u[0],u[2]]:[u[0],u[1],u[2],"@"]}var b=0<d?u[0]:d<0?u[1]:u[2];return u[0].indexOf("[")===-1&&u[1].indexOf("[")===-1?[h,b]:u[0].match(/\[[=<>]/)==null&&u[1].match(/\[[=<>]/)==null?[h,b]:(r=u[0].match(Qc),b=u[1].match(Qc),zn(d,r)?[h,u[0]]:zn(d,b)?[h,u[1]]:[h,u[r!=null&&b!=null?2:1]])}function Kr(r,d,u){u==null&&(u={});var h="";switch(typeof r){case"string":h=r=="m/d/yy"&&u.dateNF?u.dateNF:r;break;case"number":(h=(h=r==14&&u.dateNF?u.dateNF:(u.table!=null?u.table:V)[r])==null?u.table&&u.table[H[r]]||V[H[r]]:h)==null&&(h=Q[r]||"General")}if(pe(h,0))return ze(d,u);var g=Ga(h,d=d instanceof Date?ve(d,u.date1904):d);if(pe(g[1]))return ze(d,u);if(d===!0)d="TRUE";else if(d===!1)d="FALSE";else if(d===""||d==null)return"";return Io(g[1],d,u,g[0])}function Or(r,d){if(typeof d!="number"){d=+d||-1;for(var u=0;u<392;++u)if(V[u]!=null){if(V[u]==r){d=u;break}}else d<0&&(d=u);d<0&&(d=391)}return V[d]=r,d}function Bo(r){for(var d=0;d!=392;++d)r[d]!==void 0&&Or(r[d],d)}function ll(){var r;(r=r||{})[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',V=r}var zo={format:Kr,load:Or,_table:V,load_table:Bo,parse_date_code:de,is_date:dr,get_table:function(){return zo._table=V}},ol={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ci=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,Ta,Si=(function(){var r={};r.version="1.2.0";var d=(function(){for(var z=0,X=new Array(256),ie=0;ie!=256;++ie)z=1&(z=1&(z=1&(z=1&(z=1&(z=1&(z=1&(z=1&(z=ie)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1)?-306674912^z>>>1:z>>>1,X[ie]=z;return typeof Int32Array<"u"?new Int32Array(X):X})(),u=(function(z){for(var X=0,ie=0,Ee=0,le=new(typeof Int32Array<"u"?Int32Array:Array)(4096),Ee=0;Ee!=256;++Ee)le[Ee]=z[Ee];for(Ee=0;Ee!=256;++Ee)for(ie=z[Ee],X=256+Ee;X<4096;X+=256)ie=le[X]=ie>>>8^z[255&ie];var He=[];for(Ee=1;Ee!=16;++Ee)He[Ee-1]=typeof Int32Array<"u"?le.subarray(256*Ee,256*Ee+256):le.slice(256*Ee,256*Ee+256);return He})(d),h=u[0],g=u[1],b=u[2],x=u[3],y=u[4],j=u[5],k=u[6],E=u[7],T=u[8],_=u[9],R=u[10],q=u[11],I=u[12],J=u[13],Y=u[14];return r.table=d,r.bstr=function(z,X){for(var ie=-1^X,le=0,Ee=z.length;le<Ee;)ie=ie>>>8^d[255&(ie^z.charCodeAt(le++))];return~ie},r.buf=function(z,X){for(var ie=-1^X,le=z.length-15,Ee=0;Ee<le;)ie=Y[z[Ee++]^255&ie]^J[z[Ee++]^ie>>8&255]^I[z[Ee++]^ie>>16&255]^q[z[Ee++]^ie>>>24]^R[z[Ee++]]^_[z[Ee++]]^T[z[Ee++]]^E[z[Ee++]]^k[z[Ee++]]^j[z[Ee++]]^y[z[Ee++]]^x[z[Ee++]]^b[z[Ee++]]^g[z[Ee++]]^h[z[Ee++]]^d[z[Ee++]];for(le+=15;Ee<le;)ie=ie>>>8^d[255&(ie^z[Ee++])];return~ie},r.str=function(z,X){for(var ie,le=-1^X,Ee=0,He=z.length,Pe=0;Ee<He;)le=(Pe=z.charCodeAt(Ee++))<128?le>>>8^d[255&(le^Pe)]:Pe<2048?(le=le>>>8^d[255&(le^(192|Pe>>6&31))])>>>8^d[255&(le^(128|63&Pe))]:55296<=Pe&&Pe<57344?(Pe=64+(1023&Pe),ie=1023&z.charCodeAt(Ee++),(le=(le=(le=le>>>8^d[255&(le^(240|Pe>>8&7))])>>>8^d[255&(le^(128|Pe>>2&63))])>>>8^d[255&(le^(128|ie>>6&15|(3&Pe)<<4))])>>>8^d[255&(le^(128|63&ie))]):(le=(le=le>>>8^d[255&(le^(224|Pe>>12&15))])>>>8^d[255&(le^(128|Pe>>6&63))])>>>8^d[255&(le^(128|63&Pe))];return~le},r})(),Tt=(function(){var r,d={};function u(ge){if(ge.charAt(ge.length-1)=="/")return ge.slice(0,-1).indexOf("/")===-1?ge:u(ge.slice(0,-1));var lt=ge.lastIndexOf("/");return lt===-1?ge:ge.slice(0,lt+1)}function h(ge){if(ge.charAt(ge.length-1)=="/")return h(ge.slice(0,-1));var lt=ge.lastIndexOf("/");return lt===-1?ge:ge.slice(lt+1)}function g(ge){Na(ge,0);for(var lt,De={};ge.l<=ge.length-4;){var tt=ge.read_shift(2),Se=ge.read_shift(2),Nt=ge.l+Se,Xe={};tt===21589&&(1&(lt=ge.read_shift(1))&&(Xe.mtime=ge.read_shift(4)),5<Se&&(2&lt&&(Xe.atime=ge.read_shift(4)),4&lt&&(Xe.ctime=ge.read_shift(4))),Xe.mtime&&(Xe.mt=new Date(1e3*Xe.mtime))),ge.l=Nt,De[tt]=Xe}return De}function b(){return r=r||I1}function x(ge,lt){if(ge[0]==80&&ge[1]==75)return qs(ge,lt);if((32|ge[0])==109&&(32|ge[1])==105)return(function(Et,as){if(z(Et.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var qt=as&&as.root||"",Ft=(xe&&Buffer.isBuffer(Et)?Et.toString("binary"):z(Et)).split(`\r
`),cs=0,ns="";for(cs=0;cs<Ft.length;++cs)if(ns=Ft[cs],/^Content-Location:/i.test(ns)&&(ns=ns.slice(ns.indexOf("file")),qt=qt||ns.slice(0,ns.lastIndexOf("/")+1),ns.slice(0,qt.length)!=qt))for(;0<qt.length&&(qt=(qt=qt.slice(0,qt.length-1)).slice(0,qt.lastIndexOf("/")+1),ns.slice(0,qt.length)!=qt););if(Et=(Ft[1]||"").match(/boundary="(.*?)"/),!Et)throw new Error("MAD cannot find boundary");var gr="--"+(Et[1]||""),ds={FileIndex:[],FullPaths:[]};j(ds);var vs,es=0;for(cs=0;cs<Ft.length;++cs){var zs=Ft[cs];zs!==gr&&zs!==gr+"--"||(es++&&(function(Ms,i,c){for(var f,p="",C="",A="",U=0;U<10;++U){var ee=i[U];if(!ee||ee.match(/^\s*$/))break;var Ne=ee.match(/^(.*?):\s*([^\s].*)$/);if(Ne)switch(Ne[1].toLowerCase()){case"content-location":p=Ne[2].trim();break;case"content-type":A=Ne[2].trim();break;case"content-transfer-encoding":C=Ne[2].trim()}}switch(++U,C.toLowerCase()){case"base64":f=ue(ke(i.slice(U).join("")));break;case"quoted-printable":f=(function(qe){for(var ut=[],ft=0;ft<qe.length;++ft){for(var Je=qe[ft];ft<=qe.length&&Je.charAt(Je.length-1)=="=";)Je=Je.slice(0,Je.length-1)+qe[++ft];ut.push(Je)}for(var ot=0;ot<ut.length;++ot)ut[ot]=ut[ot].replace(/[=][0-9A-Fa-f]{2}/g,function(ts){return String.fromCharCode(parseInt(ts.slice(1),16))});return ue(ut.join(`\r
`))})(i.slice(U));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+C)}c=Ln(Ms,p.slice(c.length),f,{unsafe:!0}),A&&(c.ctype=A)})(ds,Ft.slice(vs,cs),qt),vs=cs)}return ds})(ge,lt);if(ge.length<512)throw new Error("CFB file size "+ge.length+" < 512");var De,tt,Se,Nt=3,Xe=512,Pt=0,ct=[],Ye=ge.slice(0,512);Na(Ye,0);var ht=(function(Et){if(Et[Et.l]==80&&Et[Et.l+1]==75)return[0,0];Et.chk(q,"Header Signature: "),Et.l+=16;var as=Et.read_shift(2,"u");return[Et.read_shift(2,"u"),as]})(Ye);switch(Nt=ht[0]){case 3:Xe=512;break;case 4:Xe=4096;break;case 0:if(ht[1]==0)return qs(ge,lt);default:throw new Error("Major Version: Expected 3 or 4 saw "+Nt)}Xe!==512&&Na(Ye=ge.slice(0,Xe),28);var St=ge.slice(0,Xe);(function(Et,as){var qt=9;switch(Et.l+=2,qt=Et.read_shift(2)){case 9:if(as!=3)throw new Error("Sector Shift: Expected 9 saw "+qt);break;case 12:if(as!=4)throw new Error("Sector Shift: Expected 12 saw "+qt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+qt)}Et.chk("0600","Mini Sector Shift: "),Et.chk("000000000000","Reserved: ")})(Ye,Nt);var rs=Ye.read_shift(4,"i");if(Nt===3&&rs!==0)throw new Error("# Directory Sectors: Expected 0 saw "+rs);Ye.l+=4,tt=Ye.read_shift(4,"i"),Ye.l+=4,Ye.chk("00100000","Mini Stream Cutoff Size: "),Se=Ye.read_shift(4,"i"),De=Ye.read_shift(4,"i"),ss=Ye.read_shift(4,"i"),Pt=Ye.read_shift(4,"i");for(var Qt,Gt=0;Gt<109&&!((Qt=Ye.read_shift(4,"i"))<0);++Gt)ct[Gt]=Qt;var Ut=(function(Et,as){for(var qt=Math.ceil(Et.length/as)-1,Ft=[],cs=1;cs<qt;++cs)Ft[cs-1]=Et.slice(cs*as,(cs+1)*as);return Ft[qt-1]=Et.slice(qt*as),Ft})(ge,Xe);(function Et(as,qt,Ft,cs,ns){var gr=R;if(as===R){if(qt!==0)throw new Error("DIFAT chain shorter than expected")}else if(as!==-1){var ds=Ft[as],vs=(cs>>>2)-1;if(ds){for(var es=0;es<vs&&(gr=Kl(ds,4*es))!==R;++es)ns.push(gr);Et(Kl(ds,cs-4),qt-1,Ft,cs,ns)}}})(ss,Pt,Ut,Xe,ct);var Xt=(function(Et,as,qt,Ft){var cs=Et.length,ns=[],gr=[],ds=[],vs=[],es=Ft-1,zs=0,Ms=0,i=0,c=0;for(zs=0;zs<cs;++zs)if(ds=[],cs<=(i=zs+as)&&(i-=cs),!gr[i]){vs=[];var f=[];for(Ms=i;0<=Ms;){f[Ms]=!0,gr[Ms]=!0,ds[ds.length]=Ms,vs.push(Et[Ms]);var p=qt[Math.floor(4*Ms/Ft)];if(Ft<4+(c=4*Ms&es))throw new Error("FAT boundary crossed: "+Ms+" 4 "+Ft);if(!Et[p]||(Ms=Kl(Et[p],c),f[Ms]))break}ns[i]={nodes:ds,data:wm([vs])}}return ns})(Ut,tt,ct,Xe);Xt[tt].name="!Directory",0<De&&Se!==R&&(Xt[Se].name="!MiniFAT"),Xt[ct[0]].name="!FAT",Xt.fat_addrs=ct,Xt.ssz=Xe;var rs=[],ss=[],Pt=[];return(function(Et,as,qt,Ft,cs,ns,gr){for(var ds,vs=0,es=qt.length?2:0,zs=Et[tt].data,Ms=0,i=0;Ms<zs.length;Ms+=128){var c=zs.slice(Ms,Ms+128);Na(c,64),i=c.read_shift(2),ds=f0(c,0,i-es),qt.push(ds);var f={name:ds,type:c.read_shift(1),color:c.read_shift(1),L:c.read_shift(4,"i"),R:c.read_shift(4,"i"),C:c.read_shift(4,"i"),clsid:c.read_shift(16),state:c.read_shift(4,"i"),start:0,size:0};c.read_shift(2)+c.read_shift(2)+c.read_shift(2)+c.read_shift(2)!==0&&(f.ct=y(c,c.l-8)),c.read_shift(2)+c.read_shift(2)+c.read_shift(2)+c.read_shift(2)!==0&&(f.mt=y(c,c.l-8)),f.start=c.read_shift(4,"i"),f.size=c.read_shift(4,"i"),f.size<0&&f.start<0&&(f.size=f.type=0,f.start=R,f.name=""),f.type===5?(vs=f.start,0<Ft&&vs!==R&&(Et[vs].name="!StreamData")):4096<=f.size?(f.storage="fat",Et[f.start]===void 0&&(Et[f.start]=(function(p,C,A,U,ee){var Ne=[],qe=[];ee=ee||[];var ut=U-1,ft=0,Je=0;for(ft=C;0<=ft;){ee[ft]=!0,Ne[Ne.length]=ft,qe.push(p[ft]);var ot=A[Math.floor(4*ft/U)];if(U<4+(Je=4*ft&ut))throw new Error("FAT boundary crossed: "+ft+" 4 "+U);if(!p[ot])break;ft=Kl(p[ot],Je)}return{nodes:Ne,data:wm([qe])}})(as,f.start,Et.fat_addrs,Et.ssz)),Et[f.start].name=f.name,f.content=Et[f.start].data.slice(0,f.size)):(f.storage="minifat",f.size<0?f.size=0:vs!==R&&f.start!==R&&Et[vs]&&(f.content=(function(p,C,A){for(var U=p.start,ee=p.size,Ne=[],qe=U;A&&0<ee&&0<=qe;)Ne.push(C.slice(qe*_,qe*_+_)),ee-=_,qe=Kl(A,4*qe);return Ne.length===0?mt(0):he(Ne).slice(0,p.size)})(f,Et[vs].data,(Et[gr]||{}).data))),f.content&&Na(f.content,0),cs[ds]=f,ns.push(f)}})(Xt,Ut,rs,De,{},ss,Se),(function(Et,as,qt){for(var Ft=0,cs=0,ns=0,gr=0,ds=0,vs=qt.length,es=[],zs=[];Ft<vs;++Ft)es[Ft]=zs[Ft]=Ft,as[Ft]=qt[Ft];for(;ds<zs.length;++ds)Ft=zs[ds],cs=Et[Ft].L,ns=Et[Ft].R,gr=Et[Ft].C,es[Ft]===Ft&&(cs!==-1&&es[cs]!==cs&&(es[Ft]=es[cs]),ns!==-1&&es[ns]!==ns&&(es[Ft]=es[ns])),gr!==-1&&(es[gr]=Ft),cs!==-1&&Ft!=es[Ft]&&(es[cs]=es[Ft],zs.lastIndexOf(cs)<ds&&zs.push(cs)),ns!==-1&&Ft!=es[Ft]&&(es[ns]=es[Ft],zs.lastIndexOf(ns)<ds&&zs.push(ns));for(Ft=1;Ft<vs;++Ft)es[Ft]===Ft&&(ns!==-1&&es[ns]!==ns?es[Ft]=es[ns]:cs!==-1&&es[cs]!==cs&&(es[Ft]=es[cs]));for(Ft=1;Ft<vs;++Ft)if(Et[Ft].type!==0){if((ds=Ft)!=es[ds])for(;ds=es[ds],as[Ft]=as[ds]+"/"+as[Ft],ds!==0&&es[ds]!==-1&&ds!=es[ds];);es[Ft]=-1}for(as[0]+="/",Ft=1;Ft<vs;++Ft)Et[Ft].type!==2&&(as[Ft]+="/")})(ss,Pt,rs),rs.shift(),Pt={FileIndex:ss,FullPaths:Pt},lt&&lt.raw&&(Pt.raw={header:St,sectors:Ut}),Pt}function y(ge,lt){return new Date(1e3*(ga(ge,lt+4)/1e7*Math.pow(2,32)+ga(ge,lt)/1e7-11644473600))}function j(ge,tt){var De=tt||{},tt=De.root||"Root Entry";if(ge.FullPaths||(ge.FullPaths=[]),ge.FileIndex||(ge.FileIndex=[]),ge.FullPaths.length!==ge.FileIndex.length)throw new Error("inconsistent CFB structure");ge.FullPaths.length===0&&(ge.FullPaths[0]=tt+"/",ge.FileIndex[0]={name:tt,type:5}),De.CLSID&&(ge.FileIndex[0].clsid=De.CLSID),tt=ge,De="Sh33tJ5",Tt.find(tt,"/"+De)||((ge=mt(4))[0]=55,ge[1]=ge[3]=50,ge[2]=54,tt.FileIndex.push({name:De,type:2,content:ge,size:4,L:69,R:69,C:69}),tt.FullPaths.push(tt.FullPaths[0]+De),k(tt))}function k(ge,lt){j(ge);for(var De=!1,tt=!1,Se=ge.FullPaths.length-1;0<=Se;--Se){var Nt=ge.FileIndex[Se];switch(Nt.type){case 0:tt?De=!0:(ge.FileIndex.pop(),ge.FullPaths.pop());break;case 1:case 2:case 5:tt=!0,isNaN(Nt.R*Nt.L*Nt.C)&&(De=!0),-1<Nt.R&&-1<Nt.L&&Nt.R==Nt.L&&(De=!0);break;default:De=!0}}if(De||lt){for(var Xe=new Date(1987,1,19),ct=0,Ye=Object.create?Object.create(null):{},ht=[],Se=0;Se<ge.FullPaths.length;++Se)Ye[ge.FullPaths[Se]]=!0,ge.FileIndex[Se].type!==0&&ht.push([ge.FullPaths[Se],ge.FileIndex[Se]]);for(Se=0;Se<ht.length;++Se){var St=u(ht[Se][0]);(tt=Ye[St])||(ht.push([St,{name:h(St).replace("/",""),type:1,clsid:J,ct:Xe,mt:Xe,content:null}]),Ye[St]=!0)}for(ht.sort(function(Ut,Xt){return(function(rs,ss){for(var Pt,Et=rs.split("/"),as=ss.split("/"),qt=0,Ft=Math.min(Et.length,as.length);qt<Ft;++qt){if(Pt=Et[qt].length-as[qt].length)return Pt;if(Et[qt]!=as[qt])return Et[qt]<as[qt]?-1:1}return Et.length-as.length})(Ut[0],Xt[0])}),ge.FullPaths=[],ge.FileIndex=[],Se=0;Se<ht.length;++Se)ge.FullPaths[Se]=ht[Se][0],ge.FileIndex[Se]=ht[Se][1];for(Se=0;Se<ht.length;++Se){var Qt=ge.FileIndex[Se],Gt=ge.FullPaths[Se];if(Qt.name=h(Gt).replace("/",""),Qt.L=Qt.R=Qt.C=-(Qt.color=1),Qt.size=Qt.content?Qt.content.length:0,Qt.start=0,Qt.clsid=Qt.clsid||J,Se===0)Qt.C=1<ht.length?1:-1,Qt.size=0,Qt.type=5;else if(Gt.slice(-1)=="/"){for(ct=Se+1;ct<ht.length&&u(ge.FullPaths[ct])!=Gt;++ct);for(Qt.C=ct>=ht.length?-1:ct,ct=Se+1;ct<ht.length&&u(ge.FullPaths[ct])!=u(Gt);++ct);Qt.R=ct>=ht.length?-1:ct,Qt.type=1}else u(ge.FullPaths[Se+1]||"")==u(Gt)&&(Qt.R=Se+1),Qt.type=2}}}function E(ge,lt){var De=lt||{};if(De.fileType=="mad")return(function(Gt,Ut){for(var Xt=Ut||{},rs=Xt.boundary||"SheetJS",ss=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(rs="------="+rs).slice(2)+'"',"","",""],Pt=Gt.FullPaths[0],Et=Pt,as=Gt.FileIndex[0],qt=1;qt<Gt.FullPaths.length;++qt)if(Et=Gt.FullPaths[qt].slice(Pt.length),(as=Gt.FileIndex[qt]).size&&as.content&&Et!="Sh33tJ5"){Et=Et.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(es){return"_x"+es.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(es){return"_u"+es.charCodeAt(0).toString(16)+"_"});for(var Ft=as.content,cs=xe&&Buffer.isBuffer(Ft)?Ft.toString("binary"):z(Ft),ns=0,gr=Math.min(1024,cs.length),ds=0,vs=0;vs<=gr;++vs)32<=(ds=cs.charCodeAt(vs))&&ds<128&&++ns;Ft=4*gr/5<=ns,ss.push(rs),ss.push("Content-Location: "+(Xt.root||"file:///C:/SheetJS/")+Et),ss.push("Content-Transfer-Encoding: "+(Ft?"quoted-printable":"base64")),ss.push("Content-Type: "+(function(i,zs){if(i.ctype)return i.ctype;var Ms=i.name||"",i=Ms.match(/\.([^\.]+)$/);return i&&fa[i[1]]||zs&&(i=(Ms=zs).match(/[\.\\]([^\.\\])+$/))&&fa[i[1]]?fa[i[1]]:"application/octet-stream"})(as,Et)),ss.push(""),ss.push((Ft?function(es){es=es.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(A){return A=A.charCodeAt(0).toString(16).toUpperCase(),"="+(A.length==1?"0"+A:A)}),(es=es.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)==`
`&&(es="=0D"+es.slice(1)),es=es.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,`
=0A`).replace(/([^\r\n])\n/gm,"$1=0A");for(var zs=[],Ms=es.split(`\r
`),i=0;i<Ms.length;++i){var c=Ms[i];if(c.length!=0)for(var f=0;f<c.length;){var p=76,C=c.slice(f,f+p);C.charAt(p-1)=="="?p--:C.charAt(p-2)=="="?p-=2:C.charAt(p-3)=="="&&(p-=3),C=c.slice(f,f+p),(f+=p)<c.length&&(C+="="),zs.push(C)}else zs.push("")}return zs.join(`\r
`)}:function(es){for(var zs=re(es),Ms=[],i=0;i<zs.length;i+=76)Ms.push(zs.slice(i,i+76));return Ms.join(`\r
`)+`\r
`})(cs))}return ss.push(rs+`--\r
`),ss.join(`\r
`)})(ge,De);if(k(ge),De.fileType==="zip")return(function(Gt,Xt){var Xt=Xt||{},rs=[],ss=[],Pt=mt(1),Et=Xt.compression?8:0,as=0,qt=0,Ft=0,cs=0,ns=0,gr=Gt.FullPaths[0],ds=gr,vs=Gt.FileIndex[0],es=[],zs=0;for(qt=1;qt<Gt.FullPaths.length;++qt)if(ds=Gt.FullPaths[qt].slice(gr.length),(vs=Gt.FileIndex[qt]).size&&vs.content&&ds!="Sh33tJ5"){var Ms=cs,i=mt(ds.length);for(Ft=0;Ft<ds.length;++Ft)i.write_shift(1,127&ds.charCodeAt(Ft));i=i.slice(0,i.l),es[ns]=Si.buf(vs.content,0);var c=vs.content;Et==8&&(c=(function(f){return T?T.deflateRawSync(f):$t(f)})(c)),(Pt=mt(30)).write_shift(4,67324752),Pt.write_shift(2,20),Pt.write_shift(2,as),Pt.write_shift(2,Et),vs.mt?(function(f,p){var C=(p=typeof p=="string"?new Date(p):p).getHours();C=(C=C<<6|p.getMinutes())<<5|p.getSeconds()>>>1,f.write_shift(2,C),C=(C=(C=p.getFullYear()-1980)<<4|p.getMonth()+1)<<5|p.getDate(),f.write_shift(2,C)})(Pt,vs.mt):Pt.write_shift(4,0),Pt.write_shift(-4,es[ns]),Pt.write_shift(4,c.length),Pt.write_shift(4,vs.content.length),Pt.write_shift(2,i.length),Pt.write_shift(2,0),cs+=Pt.length,rs.push(Pt),cs+=i.length,rs.push(i),cs+=c.length,rs.push(c),(Pt=mt(46)).write_shift(4,33639248),Pt.write_shift(2,0),Pt.write_shift(2,20),Pt.write_shift(2,as),Pt.write_shift(2,Et),Pt.write_shift(4,0),Pt.write_shift(-4,es[ns]),Pt.write_shift(4,c.length),Pt.write_shift(4,vs.content.length),Pt.write_shift(2,i.length),Pt.write_shift(2,0),Pt.write_shift(2,0),Pt.write_shift(2,0),Pt.write_shift(2,0),Pt.write_shift(4,0),Pt.write_shift(4,Ms),zs+=Pt.l,ss.push(Pt),zs+=i.length,ss.push(i),++ns}return(Pt=mt(22)).write_shift(4,101010256),Pt.write_shift(2,0),Pt.write_shift(2,0),Pt.write_shift(2,ns),Pt.write_shift(2,ns),Pt.write_shift(4,zs),Pt.write_shift(4,cs),Pt.write_shift(2,0),he([he(rs),he(ss),Pt])})(ge,De);for(var tt=(function(Gt){for(var Ut=0,Xt=0,rs=0;rs<Gt.FileIndex.length;++rs){var ss=Gt.FileIndex[rs];ss.content&&0<(ss=ss.content.length)&&(ss<4096?Ut+=ss+63>>6:Xt+=ss+511>>9)}for(var Pt=Gt.FullPaths.length+3>>2,Et=Ut+127>>7,as=(Ut+7>>3)+Xt+Pt+Et,qt=as+127>>7,Ft=qt<=109?0:Math.ceil((qt-109)/127);qt<as+qt+Ft+127>>7;)Ft=++qt<=109?0:Math.ceil((qt-109)/127);return Pt=[1,Ft,qt,Et,Pt,Xt,Ut,0],Gt.FileIndex[0].size=Ut<<6,Pt[7]=(Gt.FileIndex[0].start=Pt[0]+Pt[1]+Pt[2]+Pt[3]+Pt[4]+Pt[5])+(Pt[6]+7>>3),Pt})(ge),Se=mt(tt[7]<<9),Xe=0,Nt=0,Xe=0;Xe<8;++Xe)Se.write_shift(1,I[Xe]);for(Xe=0;Xe<8;++Xe)Se.write_shift(2,0);for(Se.write_shift(2,62),Se.write_shift(2,3),Se.write_shift(2,65534),Se.write_shift(2,9),Se.write_shift(2,6),Xe=0;Xe<3;++Xe)Se.write_shift(2,0);for(Se.write_shift(4,0),Se.write_shift(4,tt[2]),Se.write_shift(4,tt[0]+tt[1]+tt[2]+tt[3]-1),Se.write_shift(4,0),Se.write_shift(4,4096),Se.write_shift(4,tt[3]?tt[0]+tt[1]+tt[2]-1:R),Se.write_shift(4,tt[3]),Se.write_shift(-4,tt[1]?tt[0]-1:R),Se.write_shift(4,tt[1]),Xe=0;Xe<109;++Xe)Se.write_shift(-4,Xe<tt[2]?tt[1]+Xe:-1);if(tt[1])for(Nt=0;Nt<tt[1];++Nt){for(;Xe<236+127*Nt;++Xe)Se.write_shift(-4,Xe<tt[2]?tt[1]+Xe:-1);Se.write_shift(-4,Nt===tt[1]-1?R:Nt+1)}function ct(Gt){for(Nt+=Gt;Xe<Nt-1;++Xe)Se.write_shift(-4,Xe+1);Gt&&(++Xe,Se.write_shift(-4,R))}for(Nt=Xe=0,Nt+=tt[1];Xe<Nt;++Xe)Se.write_shift(-4,Y.DIFSECT);for(Nt+=tt[2];Xe<Nt;++Xe)Se.write_shift(-4,Y.FATSECT);ct(tt[3]),ct(tt[4]);for(var Ye=0,ht=0,St=ge.FileIndex[0];Ye<ge.FileIndex.length;++Ye)(St=ge.FileIndex[Ye]).content&&((ht=St.content.length)<4096||(St.start=Nt,ct(ht+511>>9)));for(ct(tt[6]+7>>3);511&Se.l;)Se.write_shift(-4,Y.ENDOFCHAIN);for(Ye=Nt=Xe=0;Ye<ge.FileIndex.length;++Ye)(St=ge.FileIndex[Ye]).content&&(!(ht=St.content.length)||4096<=ht||(St.start=Nt,ct(ht+63>>6)));for(;511&Se.l;)Se.write_shift(-4,Y.ENDOFCHAIN);for(Xe=0;Xe<tt[4]<<2;++Xe){var Qt=ge.FullPaths[Xe];if(Qt&&Qt.length!==0){if(St=ge.FileIndex[Xe],Xe===0&&(St.start=St.size?St.start-1:R),Qt=Xe===0&&De.root||St.name,ht=2*(Qt.length+1),Se.write_shift(64,Qt,"utf16le"),Se.write_shift(2,ht),Se.write_shift(1,St.type),Se.write_shift(1,St.color),Se.write_shift(-4,St.L),Se.write_shift(-4,St.R),Se.write_shift(-4,St.C),St.clsid)Se.write_shift(16,St.clsid,"hex");else for(Ye=0;Ye<4;++Ye)Se.write_shift(4,0);Se.write_shift(4,St.state||0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,St.start),Se.write_shift(4,St.size),Se.write_shift(4,0)}else{for(Ye=0;Ye<17;++Ye)Se.write_shift(4,0);for(Ye=0;Ye<3;++Ye)Se.write_shift(4,-1);for(Ye=0;Ye<12;++Ye)Se.write_shift(4,0)}}for(Xe=1;Xe<ge.FileIndex.length;++Xe)if(4096<=(St=ge.FileIndex[Xe]).size)if(Se.l=St.start+1<<9,xe&&Buffer.isBuffer(St.content))St.content.copy(Se,Se.l,0,St.size),Se.l+=St.size+511&-512;else{for(Ye=0;Ye<St.size;++Ye)Se.write_shift(1,St.content[Ye]);for(;511&Ye;++Ye)Se.write_shift(1,0)}for(Xe=1;Xe<ge.FileIndex.length;++Xe)if(0<(St=ge.FileIndex[Xe]).size&&St.size<4096)if(xe&&Buffer.isBuffer(St.content))St.content.copy(Se,Se.l,0,St.size),Se.l+=St.size+63&-64;else{for(Ye=0;Ye<St.size;++Ye)Se.write_shift(1,St.content[Ye]);for(;63&Ye;++Ye)Se.write_shift(1,0)}if(xe)Se.l=Se.length;else for(;Se.l<Se.length;)Se.write_shift(1,0);return Se}d.version="1.2.1";var T,_=64,R=-2,q="d0cf11e0a1b11ae1",I=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function z(ge){for(var lt=new Array(ge.length),De=0;De<ge.length;++De)lt[De]=String.fromCharCode(ge[De]);return lt.join("")}for(var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Ee,He=typeof Uint8Array<"u",Pe=He?new Uint8Array(256):[],Qe=0;Qe<256;++Qe)Pe[Qe]=255&((Ee=139536&((Ee=Qe)<<1|Ee<<11)|558144&(Ee<<5|Ee<<15))>>16|Ee>>8|Ee);function pt(ge,tt){var De=7&tt,tt=tt>>>3;return(ge[tt]|(De<=5?0:ge[1+tt]<<8))>>>De&7}function xt(ge,tt){var De=7&tt,tt=tt>>>3;return(ge[tt]|(De<=3?0:ge[1+tt]<<8))>>>De&31}function at(ge,tt){var De=7&tt,tt=tt>>>3;return(ge[tt]|(De<=1?0:ge[1+tt]<<8))>>>De&127}function kt(ge,Xe,De){var tt=7&Xe,Se=Xe>>>3,Nt=(1<<De)-1,Xe=ge[Se]>>>tt;return De<8-tt?Xe&Nt:(Xe|=ge[1+Se]<<8-tt,De<16-tt?Xe&Nt:(Xe|=ge[2+Se]<<16-tt,De<24-tt?Xe&Nt:(Xe|=ge[3+Se]<<24-tt)&Nt))}function Wt(ge,lt,De){var tt=7&lt,Se=lt>>>3;return tt<=5?ge[Se]|=(7&De)<<tt:(ge[Se]|=De<<tt&255,ge[1+Se]=(7&De)>>8-tt),lt+3}function Ht(ge,lt,De){var tt=lt>>>3;return De<<=7&lt,ge[tt]|=255&De,De>>>=8,ge[1+tt]=De,lt+8}function Mt(ge,lt,De){var tt=lt>>>3;return De<<=7&lt,ge[tt]|=255&De,De>>>=8,ge[1+tt]=255&De,ge[2+tt]=De>>>8,lt+16}function Ot(ge,lt){var De=ge.length,tt=lt<2*De?2*De:lt+5,Se=0;if(lt<=De)return ge;if(xe){var Nt=ce(tt);if(ge.copy)ge.copy(Nt);else for(;Se<ge.length;++Se)Nt[Se]=ge[Se];return Nt}if(He){var Xe=new Uint8Array(tt);if(Xe.set)Xe.set(ge);else for(;Se<De;++Se)Xe[Se]=ge[Se];return Xe}return ge.length=tt,ge}function _t(ge){for(var lt=new Array(ge),De=0;De<ge;++De)lt[De]=0;return lt}function wt(ge,lt,De){for(var tt,Se=1,ht=0,Nt=0,Xe=0,ct=ge.length,Ye=He?new Uint16Array(32):_t(32),ht=0;ht<32;++ht)Ye[ht]=0;for(ht=ct;ht<De;++ht)ge[ht]=0;ct=ge.length;var St=He?new Uint16Array(ct):_t(ct);for(ht=0;ht<ct;++ht)Ye[tt=ge[ht]]++,Se<tt&&(Se=tt),St[ht]=0;for(Ye[0]=0,ht=1;ht<=Se;++ht)Ye[ht+16]=Xe=Xe+Ye[ht-1]<<1;for(ht=0;ht<ct;++ht)(Xe=ge[ht])!=0&&(St[ht]=Ye[Xe+16]++);var Qt,Gt,Ut,Xt;for(ht=0;ht<ct;++ht)if((Qt=ge[ht])!=0)for(Gt=St[ht],Ut=Se,Xt=void 0,Xt=Pe[255&Gt],Xe=(Ut<=8?Xt>>>8-Ut:(Xt=Xt<<8|Pe[Gt>>8&255],Ut<=16?Xt>>>16-Ut:(Xt=Xt<<8|Pe[Gt>>16&255])>>>24-Ut))>>Se-Qt,Nt=(1<<Se+4-Qt)-1;0<=Nt;--Nt)lt[Xe|Nt<<Qt]=15&Qt|ht<<4;return Se}var Yt=He?new Uint16Array(512):_t(512),Jt=He?new Uint16Array(32):_t(32);if(!He){for(var is=0;is<512;++is)Yt[is]=0;for(is=0;is<32;++is)Jt[is]=0}(function(){for(var ge=[],lt=0;lt<32;lt++)ge.push(5);wt(ge,Jt,32);for(var De=[],lt=0;lt<=143;lt++)De.push(8);for(;lt<=255;lt++)De.push(9);for(;lt<=279;lt++)De.push(7);for(;lt<=287;lt++)De.push(8);wt(De,Yt,288)})();var Ds=(function(){for(var ge=He?new Uint8Array(32768):[],lt=0,De=0;lt<le.length-1;++lt)for(;De<le[lt+1];++De)ge[De]=lt;for(;De<32768;++De)ge[De]=29;for(var tt=He?new Uint8Array(259):[],lt=0,De=0;lt<ie.length-1;++lt)for(;De<ie[lt+1];++De)tt[De]=lt;return function(Se,Nt){return(Se.length<8?function(Xe,ct){for(var Ye=0;Ye<Xe.length;){var ht=Math.min(65535,Xe.length-Ye),St=Ye+ht==Xe.length;for(ct.write_shift(1,+St),ct.write_shift(2,ht),ct.write_shift(2,65535&~ht);0<ht--;)ct[ct.l++]=Xe[Ye++]}return ct.l}:function(Xe,ct){for(var Ye=0,ht=0,St=He?new Uint16Array(32768):[];ht<Xe.length;){var Qt=Math.min(65535,Xe.length-ht);if(Qt<10){for(7&(Ye=Wt(ct,Ye,+(ht+Qt==Xe.length)))&&(Ye+=8-(7&Ye)),ct.l=Ye/8|0,ct.write_shift(2,Qt),ct.write_shift(2,65535&~Qt);0<Qt--;)ct[ct.l++]=Xe[ht++];Ye=8*ct.l}else{Ye=Wt(ct,Ye,+(ht+Qt==Xe.length)+2);for(var Gt=0;0<Qt--;){var Ut=Xe[ht],Gt=32767&(Gt<<5^Ut),Xt=-1,rs=0;if((Xt=St[Gt])&&(ht<(Xt|=-32768&ht)&&(Xt-=32768),Xt<ht))for(;Xe[Xt+rs]==Xe[ht+rs]&&rs<250;)++rs;if(2<rs){(Ut=tt[rs])<=22?Ye=Ht(ct,Ye,Pe[Ut+1]>>1)-1:(Ht(ct,Ye,3),Ht(ct,Ye+=5,Pe[Ut-23]>>5),Ye+=3);var ss=Ut<8?0:Ut-4>>2;0<ss&&(Mt(ct,Ye,rs-ie[Ut]),Ye+=ss),Ut=ge[ht-Xt],Ye=Ht(ct,Ye,Pe[Ut]>>3),Ye-=3;var Pt=Ut<4?0:Ut-2>>1;0<Pt&&(Mt(ct,Ye,ht-Xt-le[Ut]),Ye+=Pt);for(var Et=0;Et<rs;++Et)St[Gt]=32767&ht,Gt=32767&(Gt<<5^Xe[ht]),++ht;Qt-=rs-1}else Ut<=143?Ut+=48:(ss=((ss=1)&ss)<<(7&(Pt=Ye)),ct[Pt>>>3]|=ss,Ye=Pt+1),Ye=Ht(ct,Ye,Pe[Ut]),St[Gt]=32767&ht,++ht}Ye=Ht(ct,Ye,0)-1}}return ct.l=(Ye+7)/8|0,ct.l})(Se,Nt)}})();function $t(De){var lt=mt(50+Math.floor(1.1*De.length)),De=Ds(De,lt);return lt.slice(0,De)}var Ct=He?new Uint16Array(32768):_t(32768),gs=He?new Uint16Array(32768):_t(32768),Us=He?new Uint16Array(128):_t(128),Os=1,er=1;function Rr(ge,lt){if(ge[0]==3&&!(3&ge[1]))return[Z(lt),2];for(var De=0,tt=0,Se=ce(lt||1<<18),Nt=0,Xe=Se.length>>>0,ct=0,Ye=0;(1&tt)==0;)if(tt=pt(ge,De),De+=3,tt>>>1!=0)for(Ye=tt>>1==1?(ct=9,5):(De=(function(rs,ss){var Pt,Et,as,qt=xt(rs,ss)+257,Ft=xt(rs,ss+=5)+1,cs=(as=7&(Et=ss+=5),4+(((Pt=rs)[Et=Et>>>3]|(as<=4?0:Pt[1+Et]<<8))>>>as&15));ss+=4;for(var ns=0,gr=He?new Uint8Array(19):_t(19),ds=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],vs=1,es=He?new Uint8Array(8):_t(8),zs=He?new Uint8Array(8):_t(8),Ms=gr.length,i=0;i<cs;++i)gr[X[i]]=ns=pt(rs,ss),vs<ns&&(vs=ns),es[ns]++,ss+=3;var c=0;for(es[0]=0,i=1;i<=vs;++i)zs[i]=c=c+es[i-1]<<1;for(i=0;i<Ms;++i)(c=gr[i])!=0&&(ds[i]=zs[c]++);for(var f,i=0;i<Ms;++i)if((f=gr[i])!=0){c=Pe[ds[i]]>>8-f;for(var p=(1<<7-f)-1;0<=p;--p)Us[c|p<<f]=7&f|i<<3}for(var C,A,U,ee=[],vs=1;ee.length<qt+Ft;)switch(ss+=7&(c=Us[at(rs,ss)]),c>>>=3){case 16:for(ns=3+(U=void 0,U=7&(A=ss),((C=rs)[A=A>>>3]|(U<=6?0:C[1+A]<<8))>>>U&3),ss+=2,c=ee[ee.length-1];0<ns--;)ee.push(c);break;case 17:for(ns=3+pt(rs,ss),ss+=3;0<ns--;)ee.push(0);break;case 18:for(ns=11+at(rs,ss),ss+=7;0<ns--;)ee.push(0);break;default:ee.push(c),vs<c&&(vs=c)}var Ne=ee.slice(0,qt),qe=ee.slice(qt);for(i=qt;i<286;++i)Ne[i]=0;for(i=Ft;i<30;++i)qe[i]=0;return Os=wt(Ne,Ct,286),er=wt(qe,gs,30),ss})(ge,De),ct=Os,er);;){!lt&&Xe<Nt+32767&&(Xe=(Se=Ot(Se,Nt+32767)).length);var ht=kt(ge,De,ct),St=(tt>>>1==1?Yt:Ct)[ht];if(De+=15&St,((St>>>=4)>>>8&255)==0)Se[Nt++]=St;else{if(St==256)break;var Qt=(St-=257)<8?0:St-4>>2;5<Qt&&(Qt=0);var Gt=Nt+ie[St];0<Qt&&(Gt+=kt(ge,De,Qt),De+=Qt),ht=kt(ge,De,Ye),De+=15&(St=(tt>>>1==1?Jt:gs)[ht]);var ht=(St>>>=4)<4?0:St-2>>1,Ut=le[St];for(0<ht&&(Ut+=kt(ge,De,ht),De+=ht),!lt&&Xe<Gt&&(Xe=(Se=Ot(Se,Gt+100)).length);Nt<Gt;)Se[Nt]=Se[Nt-Ut],++Nt}}else{7&De&&(De+=8-(7&De));var Xt=ge[De>>>3]|ge[1+(De>>>3)]<<8;if(De+=32,0<Xt)for(!lt&&Xe<Nt+Xt&&(Xe=(Se=Ot(Se,Nt+Xt)).length);0<Xt--;)Se[Nt++]=ge[De>>>3],De+=8}return lt?[Se,De+7>>>3]:[Se.slice(0,Nt),De+7>>>3]}function Me(ge,lt){return lt=Rr(ge.slice(ge.l||0),lt),ge.l+=lt[1],lt[0]}function tr(ge,lt){if(!ge)throw new Error(lt);typeof console<"u"&&console.error(lt)}function qs(ge,lt){var De=ge;Na(De,0);var tt={FileIndex:[],FullPaths:[]};j(tt,{root:lt.root});for(var Se=De.length-4;(De[Se]!=80||De[Se+1]!=75||De[Se+2]!=5||De[Se+3]!=6)&&0<=Se;)--Se;De.l=Se+4,De.l+=4;var Nt=De.read_shift(2);for(De.l+=6,lt=De.read_shift(4),De.l=lt,Se=0;Se<Nt;++Se){De.l+=20;var Xe=De.read_shift(4),ct=De.read_shift(4),Ye=De.read_shift(2),ht=De.read_shift(2),St=De.read_shift(2);De.l+=8;var Qt=De.read_shift(4),Gt=g(De.slice(De.l+Ye,De.l+Ye+ht));De.l+=Ye+ht+St,St=De.l,De.l=Qt+4,(function(Ut,Xt,rs,ss,Pt){Ut.l+=2;var Et=Ut.read_shift(2),as=Ut.read_shift(2),qt=(function(C){var i=65535&C.read_shift(2),c=65535&C.read_shift(2),f=new Date,p=31&c,C=15&(c>>>=5);return c>>>=4,f.setMilliseconds(0),f.setFullYear(1980+c),f.setMonth(C-1),f.setDate(p),C=31&i,p=63&(i>>>=5),i>>>=6,f.setHours(i),f.setMinutes(p),f.setSeconds(C<<1),f})(Ut);if(8257&Et)throw new Error("Unsupported ZIP encryption");Ut.read_shift(4);for(var Ft,cs=Ut.read_shift(4),ns=Ut.read_shift(4),gr=Ut.read_shift(2),ds=Ut.read_shift(2),vs="",es=0;es<gr;++es)vs+=String.fromCharCode(Ut[Ut.l++]);ds&&(((Ft=g(Ut.slice(Ut.l,Ut.l+ds)))[21589]||{}).mt&&(qt=Ft[21589].mt),((Pt||{})[21589]||{}).mt&&(qt=Pt[21589].mt)),Ut.l+=ds;var zs=Ut.slice(Ut.l,Ut.l+cs);switch(as){case 8:zs=(function(Ms,f){if(!T)return Me(Ms,f);var c=new T.InflateRaw,f=c._processChunk(Ms.slice(Ms.l),c._finishFlushFlag);return Ms.l+=c.bytesRead,f})(Ut,ns);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+as)}ds=!1,8&Et&&(Ut.read_shift(4)==134695760&&(Ut.read_shift(4),ds=!0),cs=Ut.read_shift(4),ns=Ut.read_shift(4)),cs!=Xt&&tr(ds,"Bad compressed size: "+Xt+" != "+cs),ns!=rs&&tr(ds,"Bad uncompressed size: "+rs+" != "+ns),Ln(ss,vs,zs,{unsafe:!0,mt:qt})})(De,Xe,ct,tt,Gt),De.l=St}return tt}var fa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ln(ge,lt,De,tt){var Se=tt&&tt.unsafe;Se||j(ge);var Nt,Xe=!Se&&Tt.find(ge,lt);return Xe||(Nt=ge.FullPaths[0],Nt=lt.slice(0,Nt.length)==Nt?lt:(Nt.slice(-1)!="/"&&(Nt+="/"),(Nt+lt).replace("//","/")),Xe={name:h(lt),type:2},ge.FileIndex.push(Xe),ge.FullPaths.push(Nt),Se||Tt.utils.cfb_gc(ge)),Xe.content=De,Xe.size=De?De.length:0,tt&&(tt.CLSID&&(Xe.clsid=tt.CLSID),tt.mt&&(Xe.mt=tt.mt),tt.ct&&(Xe.ct=tt.ct)),Xe}return d.find=function(ge,lt){var De=ge.FullPaths.map(function(Ye){return Ye.toUpperCase()}),tt=De.map(function(Ye){var ht=Ye.split("/");return ht[ht.length-(Ye.slice(-1)=="/"?2:1)]}),Se=!1;lt.charCodeAt(0)===47?(Se=!0,lt=De[0].slice(0,-1)+lt):Se=lt.indexOf("/")!==-1;var ct=lt.toUpperCase(),Nt=(Se===!0?De:tt).indexOf(ct);if(Nt!==-1)return ge.FileIndex[Nt];var Xe=!ct.match(Te),ct=ct.replace(ye,"");for(Xe&&(ct=ct.replace(Te,"!")),Nt=0;Nt<De.length;++Nt)if((Xe?De[Nt].replace(Te,"!"):De[Nt]).replace(ye,"")==ct||(Xe?tt[Nt].replace(Te,"!"):tt[Nt]).replace(ye,"")==ct)return ge.FileIndex[Nt];return null},d.read=function(ge,lt){var De,tt,Se=lt&&lt.type;switch(Se||xe&&Buffer.isBuffer(ge)&&(Se="buffer"),Se||"base64"){case"file":return De=ge,tt=lt,b(),x(r.readFileSync(De),tt);case"base64":return x(ue(ke(ge)),lt);case"binary":return x(ue(ge),lt)}return x(ge,lt)},d.parse=x,d.write=function(ge,lt){var De=E(ge,lt);switch(lt&&lt.type||"buffer"){case"file":return b(),r.writeFileSync(lt.filename,De),De;case"binary":return typeof De=="string"?De:z(De);case"base64":return re(typeof De=="string"?De:z(De));case"buffer":if(xe)return Buffer.isBuffer(De)?De:je(De);case"array":return typeof De=="string"?ue(De):De}return De},d.writeFile=function(ge,lt,De){b(),De=E(ge,De),r.writeFileSync(lt,De)},d.utils={cfb_new:function(ge){var lt={};return j(lt,ge),lt},cfb_add:Ln,cfb_del:function(ge,lt){j(ge);var De=Tt.find(ge,lt);if(De){for(var tt=0;tt<ge.FileIndex.length;++tt)if(ge.FileIndex[tt]==De)return ge.FileIndex.splice(tt,1),ge.FullPaths.splice(tt,1),!0}return!1},cfb_mov:function(ge,lt,De){j(ge);var tt=Tt.find(ge,lt);if(tt){for(var Se=0;Se<ge.FileIndex.length;++Se)if(ge.FileIndex[Se]==tt)return ge.FileIndex[Se].name=h(De),ge.FullPaths[Se]=De,!0}return!1},cfb_gc:function(ge){k(ge,!0)},ReadShift:Xo,CheckField:jm,prep_blob:Na,bconcat:he,use_zlib:function(ge){try{var lt=new ge.InflateRaw;if(lt._processChunk(new Uint8Array([3,0]),lt._finishFlushFlag),!lt.bytesRead)throw new Error("zlib does not expose bytesRead");T=ge}catch(De){console.error("cannot use native zlib: "+(De.message||De))}},_deflateRaw:$t,_inflateRaw:Me,consts:Y},d})();if(typeof fp<"u")try{Ta=I1}catch{}function cl(r){return typeof r=="string"?Re(r):Array.isArray(r)?(function(d){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(d)})(r):r}function Uo(r,d,u){if(Ta!==void 0&&Ta.writeFileSync)return u?Ta.writeFileSync(r,d,u):Ta.writeFileSync(r,d);if(typeof Deno<"u"){if(u&&typeof d=="string")switch(u){case"utf8":d=new TextEncoder(u).encode(d);break;case"binary":d=Re(d);break;default:throw new Error("Unsupported encoding "+u)}return Deno.writeFileSync(r,d)}var h=u=="utf8"?At(d):d;if(typeof IE_SaveFile<"u")return IE_SaveFile(h,r);if(typeof Blob<"u"){if(h=new Blob([cl(h)],{type:"application/octet-stream"}),typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(h,r);if(typeof saveAs<"u")return saveAs(h,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var g=URL.createObjectURL(h);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),chrome.downloads.download({url:g,filename:r,saveAs:!0});if(h=document.createElement("a"),h.download!=null)return h.download=r,h.href=g,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),g}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var b=File(r);return b.open("w"),b.encoding="binary",Array.isArray(d)&&(d=be(d)),b.write(d),b.close(),d}catch(x){if(!x.message||!x.message.match(/onstruct/))throw x}throw new Error("cannot save file "+r)}function wr(r){for(var d=Object.keys(r),u=[],h=0;h<d.length;++h)Object.prototype.hasOwnProperty.call(r,d[h])&&u.push(d[h]);return u}function Ai(r,d){for(var u=[],h=wr(r),g=0;g!==h.length;++g)u[r[h[g]][d]]==null&&(u[r[h[g]][d]]=h[g]);return u}function ni(r){for(var d=[],u=wr(r),h=0;h!==u.length;++h)d[r[u[h]]]=u[h];return d}function Ei(r){for(var d=[],u=wr(r),h=0;h!==u.length;++h)d[r[u[h]]]=parseInt(u[h],10);return d}var dl=new Date(1899,11,30,0,0,0);function Sr(r,d){var u=r.getTime();return(u-(dl.getTime()+6e4*(r.getTimezoneOffset()-dl.getTimezoneOffset())))/864e5}var ii=new Date,Yl=dl.getTime()+6e4*(ii.getTimezoneOffset()-dl.getTimezoneOffset()),Qr=ii.getTimezoneOffset();function wn(r){var d=new Date;return d.setTime(24*r*60*60*1e3+Yl),d.getTimezoneOffset()!==Qr&&d.setTime(d.getTime()+6e4*(d.getTimezoneOffset()-Qr)),d}var Gl=new Date("2017-02-19T19:06:09.000Z"),jn=isNaN(Gl.getFullYear())?new Date("2/19/17"):Gl,Xs=jn.getFullYear()==2017;function Cs(r,d){var u=new Date(r);return Xs?(0<d?u.setTime(u.getTime()+60*u.getTimezoneOffset()*1e3):d<0&&u.setTime(u.getTime()-60*u.getTimezoneOffset()*1e3),u):r instanceof Date?r:jn.getFullYear()==1917&&!isNaN(u.getFullYear())?(d=u.getFullYear(),-1<r.indexOf(""+d)||u.setFullYear(u.getFullYear()+100),u):(u=r.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+u[0],+u[1]-1,+u[2],+u[3]||0,+u[4]||0,+u[5]||0),u=-1<r.indexOf("Z")?new Date(u.getTime()-60*u.getTimezoneOffset()*1e3):u)}function _a(r,d){if(xe&&Buffer.isBuffer(r)){if(d){if(r[0]==255&&r[1]==254)return At(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return At(F(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(d){if(r[0]==255&&r[1]==254)return At(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return At(new TextDecoder("utf-16be").decode(r.slice(2)))}var u={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(b){return u[b]||b})}catch{}for(var h=[],g=0;g!=r.length;++g)h.push(String.fromCharCode(r[g]));return h.join("")}function sr(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var d,u={};for(d in r)Object.prototype.hasOwnProperty.call(r,d)&&(u[d]=sr(r[d]));return u}function ar(r,d){for(var u="";u.length<d;)u+=r;return u}function nn(h){var d=Number(h);if(!isNaN(d))return isFinite(d)?d:NaN;if(!/\d/.test(h))return d;var u=1,h=h.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return u*=100,""});return isNaN(d=Number(h))?(h=h.replace(/[(](.*)[)]/,function(g,b){return u=-u,b}),isNaN(d=Number(h))?d:d/u):d/u}var Ho=["january","february","march","april","may","june","july","august","september","october","november","december"];function Xr(r){var d=new Date(r),u=new Date(NaN),h=d.getYear(),g=d.getMonth(),b=d.getDate();if(isNaN(b))return u;var x=r.toLowerCase();if(x.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(x=x.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&Ho.indexOf(x)==-1)return u}else if(x.match(/[a-z]/))return u;return h<0||8099<h||(!(0<g||1<b)||h==101)&&r.match(/[^-0-9:,\/\\]/)?u:d}var li,Nn=(li="abacaba".split(/(:?b)/i).length==5,function(r,d,u){if(li||typeof d=="string")return r.split(d);for(var h=r.split(d),g=[h[0]],b=1;b<h.length;++b)g.push(u),g.push(h[b]);return g});function Di(r){return r?r.content&&r.type?_a(r.content,!0):r.data?O(r.data):r.asNodeBuffer&&xe?O(r.asNodeBuffer().toString("binary")):r.asBinary?O(r.asBinary()):r._data&&r._data.getContent?O(_a(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function ul(r){if(!r)return null;if(r.data)return M(r.data);if(r.asNodeBuffer&&xe)return r.asNodeBuffer();if(r._data&&r._data.getContent){var d=r._data.getContent();return typeof d=="string"?M(d):Array.prototype.slice.call(d)}return r.content&&r.type?r.content:null}function ca(r,d){for(var u=r.FullPaths||wr(r.files),h=d.toLowerCase().replace(/[\/]/g,"\\"),g=h.replace(/\\/g,"/"),b=0;b<u.length;++b){var x=u[b].replace(/^Root Entry[\/]/,"").toLowerCase();if(h==x||g==x)return r.files?r.files[u[b]]:r.FileIndex[b]}return null}function Vr(r,d){if(r=ca(r,d),r==null)throw new Error("Cannot find file "+d+" in zip");return r}function Pr(r,d,u){if(!u)return((u=Vr(r,d))&&u.name.slice(-4)===".bin"?ul:Di)(u);if(!d)return null;try{return Pr(r,d)}catch{return null}}function Ar(r,d,u){if(!u)return Di(Vr(r,d));if(!d)return null;try{return Ar(r,d)}catch{return null}}function oi(r){for(var d=r.FullPaths||wr(r.files),u=[],h=0;h<d.length;++h)d[h].slice(-1)!="/"&&u.push(d[h].replace(/^Root Entry[\/]/,""));return u.sort()}function us(r,d,u){if(r.FullPaths){if(typeof u=="string"){var h=(xe?je:function(g){for(var b=[],x=0,y=g.length+250,j=Z(g.length+255),k=0;k<g.length;++k){var E,T=g.charCodeAt(k);T<128?j[x++]=T:T<2048?(j[x++]=192|T>>6&31,j[x++]=128|63&T):55296<=T&&T<57344?(T=64+(1023&T),E=1023&g.charCodeAt(++k),j[x++]=240|T>>8&7,j[x++]=128|T>>2&63,j[x++]=128|E>>6&15|(3&T)<<4,j[x++]=128|63&E):(j[x++]=224|T>>12&15,j[x++]=128|T>>6&63,j[x++]=128|63&T),y<x&&(b.push(j.slice(0,x)),x=0,j=Z(65535),y=65530)}return b.push(j.slice(0,x)),he(b)})(u);return Tt.utils.cfb_add(r,d,h)}Tt.utils.cfb_add(r,d,u)}else r.file(d,u)}function Ir(){return Tt.utils.cfb_new()}function hl(r,d){switch(d.type){case"base64":return Tt.read(r,{type:"base64"});case"binary":return Tt.read(r,{type:"binary"});case"buffer":case"array":return Tt.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+d.type)}function fl(r,d){if(r.charAt(0)=="/")return r.slice(1);var u=d.split("/");d.slice(-1)!="/"&&u.pop();for(var h=r.split("/");h.length!==0;){var g=h.shift();g===".."?u.pop():g!=="."&&u.push(g)}return u.join("/")}var jr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Vo=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ld=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Jr=jr.match(Ld)?Ld:/<[^>]*>/g,Un=/<\w*:/,Ka=/<(\/?)\w+:/;function os(r,d,u){for(var h={},g=0,b=0;g!==r.length&&(b=r.charCodeAt(g))!==32&&b!==10&&b!==13;++g);if(d||(h[0]=r.slice(0,g)),g===r.length)return h;var x,y,j,k=r.match(Vo),E=0,T=0,_="",R="";if(k)for(T=0;T!=k.length;++T){for(R=k[T],b=0;b!=R.length&&R.charCodeAt(b)!==61;++b);for(_=R.slice(0,b).trim();R.charCodeAt(b+1)==32;)++b;for(y=(g=R.charCodeAt(b+1))==34||g==39?1:0,x=R.slice(b+1+y,R.length-y),E=0;E!=_.length&&_.charCodeAt(E)!==58;++E);E===_.length?(h[_=0<_.indexOf("_")?_.slice(0,_.indexOf("_")):_]=x,h[_.toLowerCase()]=x):h[j=(E===5&&_.slice(0,5)==="xmlns"?"xmlns":"")+_.slice(E+1)]&&_.slice(E-3,E)=="ext"||(h[j]=x,h[j.toLowerCase()]=x)}return h}function kn(r){return r.replace(Ka,"<$1")}var Wo,Hn,Ti={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ml=ni(Ti),ys=(Wo=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,Hn=/_x([\da-fA-F]{4})_/gi,function r(d){var u=d+"",h=u.indexOf("<![CDATA[");return h==-1?u.replace(Wo,function(g,b){return Ti[g]||String.fromCharCode(parseInt(b,-1<g.indexOf("x")?16:10))||g}).replace(Hn,function(g,b){return String.fromCharCode(parseInt(b,16))}):(d=u.indexOf("]]>"),r(u.slice(0,h))+u.slice(h+9,d)+r(u.slice(d+3)))}),gl=/[&<>'"]/g,Xc=/[\u0000-\u0008\u000b-\u001f]/g;function Ys(r){return(r+"").replace(gl,function(d){return ml[d]}).replace(Xc,function(d){return"_x"+("000"+d.charCodeAt(0).toString(16)).slice(-4)+"_"})}function _i(r){return Ys(r).replace(/ /g,"_x0020_")}var Jc=/[\u0000-\u001f]/g;function $o(r){return(r+"").replace(gl,function(d){return ml[d]}).replace(/\n/g,"<br/>").replace(Jc,function(d){return"&#x"+("000"+d.charCodeAt(0).toString(16)).slice(-4)+";"})}var Fi,c0=(Fi=/&#(\d+);/g,function(r){return r.replace(Fi,K)});function K(r,d){return String.fromCharCode(parseInt(d,10))}function Ve(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function nt(r){for(var d,u,h,g,b="",x=0,y=0;x<r.length;)(d=r.charCodeAt(x++))<128?b+=String.fromCharCode(d):(u=r.charCodeAt(x++),191<d&&d<224?(y=(31&d)<<6,y|=63&u,b+=String.fromCharCode(y)):(h=r.charCodeAt(x++),d<240?b+=String.fromCharCode((15&d)<<12|(63&u)<<6|63&h):(g=((7&d)<<18|(63&u)<<12|(63&h)<<6|63&(y=r.charCodeAt(x++)))-65536,b+=String.fromCharCode(55296+(g>>>10&1023)),b+=String.fromCharCode(56320+(1023&g)))));return b}function Ue(r){for(var d,u,h=Z(2*r.length),g=1,b=0,x=0,y=0;y<r.length;y+=g)g=1,(u=r.charCodeAt(y))<128?d=u:u<224?(d=64*(31&u)+(63&r.charCodeAt(y+1)),g=2):u<240?(d=4096*(15&u)+64*(63&r.charCodeAt(y+1))+(63&r.charCodeAt(y+2)),g=3):(g=4,d=262144*(7&u)+4096*(63&r.charCodeAt(y+1))+64*(63&r.charCodeAt(y+2))+(63&r.charCodeAt(y+3)),x=55296+((d-=65536)>>>10&1023),d=56320+(1023&d)),x!==0&&(h[b++]=255&x,h[b++]=x>>>8,x=0),h[b++]=d%256,h[b++]=d>>>8;return h.slice(0,b).toString("ucs2")}function it(r){return je(r,"binary").toString("utf8")}var Be,Ke,Ze,vi="foo bar baz",Fe=xe&&(it(vi)==nt(vi)?it:Ue(vi)==nt(vi)&&Ue)||nt,At=xe?function(r){return je(r,"utf8").toString("binary")}:function(r){for(var d,u=[],h=0,g=0;h<r.length;)switch(!0){case(g=r.charCodeAt(h++))<128:u.push(String.fromCharCode(g));break;case g<2048:u.push(String.fromCharCode(192+(g>>6))),u.push(String.fromCharCode(128+(63&g)));break;case(55296<=g&&g<57344):g-=55296,d=r.charCodeAt(h++)-56320+(g<<10),u.push(String.fromCharCode(240+(d>>18&7))),u.push(String.fromCharCode(144+(d>>12&63))),u.push(String.fromCharCode(128+(d>>6&63))),u.push(String.fromCharCode(128+(63&d)));break;default:u.push(String.fromCharCode(224+(g>>12))),u.push(String.fromCharCode(128+(g>>6&63))),u.push(String.fromCharCode(128+(63&g)))}return u.join("")},Rt=(Be={},function(r,d){var u=r+"|"+(d||"");return Be[u]||(Be[u]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",d||""))}),It=(Ke=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]}),function(r){for(var d=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),u=0;u<Ke.length;++u)d=d.replace(Ke[u][0],Ke[u][1]);return d}),gt=(Ze={},function(r){return Ze[r]!==void 0?Ze[r]:Ze[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}),Zt=/<\/?(?:vt:)?variant>/g,js=/<(?:vt:)([^>]*)>([\s\S]*)</;function nr(h,d){var u=os(h),h=h.match(gt(u.baseType))||[],g=[];if(h.length==u.size)return h.forEach(function(b){b=b.replace(Zt,"").match(js),b&&g.push({v:Fe(b[2]),t:b[1]})}),g;if(d.WTF)throw new Error("unexpected vector length "+h.length+" != "+u.size);return g}var Is=/(^\s|\s$|\n)/;function Hs(r,d){return"<"+r+(d.match(Is)?' xml:space="preserve"':"")+">"+d+"</"+r+">"}function Ia(r){return wr(r).map(function(d){return" "+d+'="'+r[d]+'"'}).join("")}function Bt(r,d,u){return"<"+r+(u!=null?Ia(u):"")+(d!=null?(d.match(Is)?' xml:space="preserve"':"")+">"+d+"</"+r:"/")+">"}function qo(r,d){try{return r.toISOString().replace(/\.\d*/,"")}catch(u){if(d)throw u}return""}function d0(r){if(xe&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return Fe(be(oe(r)));throw new Error("Bad input format: expected Buffer or string")}var pl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Wr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Nr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bl(r){for(var d=[],u=0;u<r[0].length;++u)if(r[0][u])for(var h=0,g=r[0][u].length;h<g;h+=10240)d.push.apply(d,r[0][u].slice(h,h+10240));return d}function Zc(r,d,u){for(var h=[],g=d;g<u;g+=2)h.push(String.fromCharCode(Mi(r,g)));return h.join("").replace(ye,"")}function Yo(r,d,u){for(var h=[],g=d;g<d+u;++g)h.push(("0"+r[g].toString(16)).slice(-2));return h.join("")}function ym(r,d,u){for(var h=[],g=d;g<u;g++)h.push(String.fromCharCode(Qo(r,g)));return h.join("")}function u0(r,d){var u=ga(r,d);return 0<u?Ko(r,d+4,d+4+u-1):""}function h0(r,d){var u=ga(r,d);return 0<u?Ko(r,d+4,d+4+u-1):""}function Go(r,d){var u=2*ga(r,d);return 0<u?Ko(r,d+4,d+4+u-1):""}function ed(r,d){var u=ga(r,d);return 0<u?f0(r,d+4,d+4+u):""}function nh(r,d){var u=ga(r,d);return 0<u?Ko(r,d+4,d+4+u):""}function vm(r,d){for(var u=1-2*(r[d+7]>>>7),h=((127&r[d+7])<<4)+(r[d+6]>>>4&15),g=15&r[d+6],b=5;0<=b;--b)g=256*g+r[d+b];return h==2047?g==0?1/0*u:NaN:(h==0?h=-1022:(h-=1023,g+=Math.pow(2,52)),u*Math.pow(2,h-52)*g)}var wm=xe?function(r){return 0<r[0].length&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(d){return Buffer.isBuffer(d)?d:je(d)})):bl(r)}:bl,f0=xe?function(r,d,u){return Buffer.isBuffer(r)?r.toString("utf16le",d,u).replace(ye,""):Zc(r,d,u)}:Zc,m0=xe?function(r,d,u){return Buffer.isBuffer(r)?r.toString("hex",d,d+u):Yo(r,d,u)}:Yo,Ko=xe?function(r,d,u){return Buffer.isBuffer(r)?r.toString("utf8",d,u):ym(r,d,u)}:ym,ih=u0,lh=h0,oh=Go,ch=ed,g0=nh,p0=vm,dh=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};xe&&(ih=function(r,d){if(!Buffer.isBuffer(r))return u0(r,d);var u=r.readUInt32LE(d);return 0<u?r.toString("utf8",d+4,d+4+u-1):""},lh=function(r,d){if(!Buffer.isBuffer(r))return h0(r,d);var u=r.readUInt32LE(d);return 0<u?r.toString("utf8",d+4,d+4+u-1):""},oh=function(r,d){if(!Buffer.isBuffer(r))return Go(r,d);var u=2*r.readUInt32LE(d);return r.toString("utf16le",d+4,d+4+u-1)},ch=function(r,d){if(!Buffer.isBuffer(r))return ed(r,d);var u=r.readUInt32LE(d);return r.toString("utf16le",d+4,d+4+u)},g0=function(r,d){if(!Buffer.isBuffer(r))return nh(r,d);var u=r.readUInt32LE(d);return r.toString("utf8",d+4,d+4+u)},p0=function(r,d){return Buffer.isBuffer(r)?r.readDoubleLE(d):vm(r,d)},dh=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array}),e!==void 0&&(f0=function(r,d,u){return e.utils.decode(1200,r.slice(d,u)).replace(ye,"")},Ko=function(r,d,u){return e.utils.decode(65001,r.slice(d,u))},ih=function(r,d){var u=ga(r,d);return 0<u?e.utils.decode(v,r.slice(d+4,d+4+u-1)):""},lh=function(r,d){var u=ga(r,d);return 0<u?e.utils.decode(m,r.slice(d+4,d+4+u-1)):""},oh=function(r,d){var u=2*ga(r,d);return 0<u?e.utils.decode(1200,r.slice(d+4,d+4+u-1)):""},ch=function(r,d){var u=ga(r,d);return 0<u?e.utils.decode(1200,r.slice(d+4,d+4+u)):""},g0=function(r,d){var u=ga(r,d);return 0<u?e.utils.decode(65001,r.slice(d+4,d+4+u)):""});var Qo=function(r,d){return r[d]},Mi=function(r,d){return 256*r[d+1]+r[d]},uh=function(r,d){return d=256*r[d+1]+r[d],d<32768?d:-1*(65535-d+1)},ga=function(r,d){return r[d+3]*(1<<24)+(r[d+2]<<16)+(r[d+1]<<8)+r[d]},Kl=function(r,d){return r[d+3]<<24|r[d+2]<<16|r[d+1]<<8|r[d]},zp=function(r,d){return r[d]<<24|r[d+1]<<16|r[d+2]<<8|r[d+3]};function Xo(r,d){var u,h,g,b,x,y,j="",k=[];switch(d){case"dbcs":if(y=this.l,xe&&Buffer.isBuffer(this))j=this.slice(this.l,this.l+2*r).toString("utf16le");else for(x=0;x<r;++x)j+=String.fromCharCode(Mi(this,y)),y+=2;r*=2;break;case"utf8":j=Ko(this,this.l,this.l+r);break;case"utf16le":r*=2,j=f0(this,this.l,this.l+r);break;case"wstr":if(e===void 0)return Xo.call(this,r,"dbcs");j=e.utils.decode(m,this.slice(this.l,this.l+2*r)),r*=2;break;case"lpstr-ansi":j=ih(this,this.l),r=4+ga(this,this.l);break;case"lpstr-cp":j=lh(this,this.l),r=4+ga(this,this.l);break;case"lpwstr":j=oh(this,this.l),r=4+2*ga(this,this.l);break;case"lpp4":r=4+ga(this,this.l),j=ch(this,this.l),2&r&&(r+=2);break;case"8lpp4":r=4+ga(this,this.l),j=g0(this,this.l),3&r&&(r+=4-(3&r));break;case"cstr":for(r=0,j="";(g=Qo(this,this.l+r++))!==0;)k.push(P(g));j=k.join("");break;case"_wstr":for(r=0,j="";(g=Mi(this,this.l+r))!==0;)k.push(P(g)),r+=2;r+=2,j=k.join("");break;case"dbcs-cont":for(j="",y=this.l,x=0;x<r;++x){if(this.lens&&this.lens.indexOf(y)!==-1)return g=Qo(this,y),this.l=y+1,b=Xo.call(this,r-x,g?"dbcs-cont":"sbcs-cont"),k.join("")+b;k.push(P(Mi(this,y))),y+=2}j=k.join(""),r*=2;break;case"cpstr":if(e!==void 0){j=e.utils.decode(m,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(j="",y=this.l,x=0;x!=r;++x){if(this.lens&&this.lens.indexOf(y)!==-1)return g=Qo(this,y),this.l=y+1,b=Xo.call(this,r-x,g?"dbcs-cont":"sbcs-cont"),k.join("")+b;k.push(P(Qo(this,y))),y+=1}j=k.join("");break;default:switch(r){case 1:return u=Qo(this,this.l),this.l++,u;case 2:return u=(d==="i"?uh:Mi)(this,this.l),this.l+=2,u;case 4:case-4:return d==="i"||(128&this[this.l+3])==0?(u=(0<r?Kl:zp)(this,this.l),this.l+=4,u):(h=ga(this,this.l),this.l+=4,h);case 8:case-8:if(d==="f")return h=r==8?p0(this,this.l):p0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,h;r=8;case 16:j=m0(this,this.l,r)}}return this.l+=r,j}var Up=function(r,d,u){r[u]=255&d,r[u+1]=d>>>8&255,r[u+2]=d>>>16&255,r[u+3]=d>>>24&255},Hp=function(r,d,u){r[u]=255&d,r[u+1]=d>>8&255,r[u+2]=d>>16&255,r[u+3]=d>>24&255},Vp=function(r,d,u){r[u]=255&d,r[u+1]=d>>>8&255};function Wp(r,d,u){var h=0,g=0;if(u==="dbcs"){for(g=0;g!=d.length;++g)Vp(this,d.charCodeAt(g),this.l+2*g);h=2*d.length}else if(u==="sbcs"){if(e!==void 0&&v==874)for(g=0;g!=d.length;++g){var b=e.utils.encode(v,d.charAt(g));this[this.l+g]=b[0]}else for(d=d.replace(/[^\x00-\x7F]/g,"_"),g=0;g!=d.length;++g)this[this.l+g]=255&d.charCodeAt(g);h=d.length}else{if(u==="hex"){for(;g<r;++g)this[this.l++]=parseInt(d.slice(2*g,2*g+2),16)||0;return this}if(u==="utf16le"){for(var x=Math.min(this.l+r,this.length),g=0;g<Math.min(d.length,r);++g){var y=d.charCodeAt(g);this[this.l++]=255&y,this[this.l++]=y>>8}for(;this.l<x;)this[this.l++]=0;return this}switch(r){case 1:h=1,this[this.l]=255&d;break;case 2:h=2,this[this.l]=255&d,d>>>=8,this[this.l+1]=255&d;break;case 3:h=3,this[this.l]=255&d,d>>>=8,this[this.l+1]=255&d,d>>>=8,this[this.l+2]=255&d;break;case 4:h=4,Up(this,d,this.l);break;case 8:if(h=8,u==="f"){(function(j,k,E){var T=(k<0||1/k==-1/0?1:0)<<7,_=0,R=0,q=T?-k:k;isFinite(q)?q==0?_=R=0:(_=Math.floor(Math.log(q)/Math.LN2),R=q*Math.pow(2,52-_),_<=-1023&&(!isFinite(R)||R<Math.pow(2,52))?_=-1022:(R-=Math.pow(2,52),_+=1023)):(_=2047,R=isNaN(k)?26985:0);for(var I=0;I<=5;++I,R/=256)j[E+I]=255&R;j[E+6]=(15&_)<<4|15&R,j[E+7]=_>>4|T})(this,d,this.l);break}case 16:break;case-4:h=4,Hp(this,d,this.l)}}return this.l+=h,this}function jm(r,d){var u=m0(this,this.l,r.length>>1);if(u!==r)throw new Error(d+"Expected "+r+" saw "+u);this.l+=r.length>>1}function Na(r,d){r.l=d,r.read_shift=Xo,r.chk=jm,r.write_shift=Wp}function Fa(r,d){r.l+=d}function mt(r){return r=Z(r),Na(r,0),r}function Li(r,d,u){if(r){Na(r,r.l||0);for(var h,g=r.length,b=0;r.l<g;){128&(b=r.read_shift(1))&&(b=(127&b)+((127&r.read_shift(1))<<7));for(var x,y=jo[b]||jo[65535],j=127&(x=r.read_shift(1)),k=1;k<4&&128&x;++k)j+=(127&(x=r.read_shift(1)))<<7*k;h=r.l+j;var E=y.f&&y.f(r,j,u);if(r.l=h,d(E,y,b))return}}}function Ma(){function r(x){return Na(x=mt(x),0),x}function d(){b&&(b.length>b.l&&((b=b.slice(0,b.l)).l=b.length),0<b.length&&h.push(b),b=null)}function u(x){return b&&x<b.length-b.l?b:(d(),b=r(Math.max(x+1,g)))}var h=[],g=xe?256:2048,b=r(g);return{next:u,push:function(x){d(),(b=x).l==null&&(b.l=b.length),u(g)},end:function(){return d(),he(h)},_bufs:h}}function yt(r,d,u,h){var g=+d;if(!isNaN(g)){d=1+(128<=g?1:0)+1,128<=(h=h||jo[g].p||(u||[]).length||0)&&++d,16384<=h&&++d,2097152<=h&&++d;var b=r.next(d);g<=127?b.write_shift(1,g):(b.write_shift(1,128+(127&g)),b.write_shift(1,g>>7));for(var x=0;x!=4;++x){if(!(128<=h)){b.write_shift(1,h);break}b.write_shift(1,128+(127&h)),h>>=7}0<h&&dh(u)&&r.push(u)}}function td(r,d,u){var h=sr(r);if(d.s?(h.cRel&&(h.c+=d.s.c),h.rRel&&(h.r+=d.s.r)):(h.cRel&&(h.c+=d.c),h.rRel&&(h.r+=d.r)),!u||u.biff<12){for(;256<=h.c;)h.c-=256;for(;65536<=h.r;)h.r-=65536}return h}function hh(r,d,u){return r=sr(r),r.s=td(r.s,d.s,u),r.e=td(r.e,d.s,u),r}function Jo(r,d){if(r.cRel&&r.c<0)for(r=sr(r);r.c<0;)r.c+=8<d?16384:256;if(r.rRel&&r.r<0)for(r=sr(r);r.r<0;)r.r+=8<d?1048576:5<d?65536:16384;var u=bs(r);return r.cRel||r.cRel==null||(u=u.replace(/^([A-Z])/,"$$$1")),u=!r.rRel&&r.rRel!=null?u.replace(/([A-Z]|^)(\d+)$/,"$1$$$2"):u}function x0(r,d){return r.s.r!=0||r.s.rRel||r.e.r!=(12<=d.biff?1048575:8<=d.biff?65536:16384)||r.e.rRel?r.s.c!=0||r.s.cRel||r.e.c!=(12<=d.biff?16383:255)||r.e.cRel?Jo(r.s,d.biff)+":"+Jo(r.e,d.biff):(r.s.rRel?"":"$")+Br(r.s.r)+":"+(r.e.rRel?"":"$")+Br(r.e.r):(r.s.cRel?"":"$")+Er(r.s.c)+":"+(r.e.cRel?"":"$")+Er(r.e.c)}function b0(r){return parseInt(r.replace(/\$(\d+)$/,"$1"),10)-1}function Br(r){return""+(r+1)}function yl(r){for(var d=r.replace(/^\$([A-Z])/,"$1"),u=0,h=0;h!==d.length;++h)u=26*u+d.charCodeAt(h)-64;return u-1}function Er(r){if(r<0)throw new Error("invalid column "+r);var d="";for(++r;r;r=Math.floor((r-1)/26))d=String.fromCharCode((r-1)%26+65)+d;return d}function zr(r){for(var d=0,u=0,h=0;h<r.length;++h){var g=r.charCodeAt(h);48<=g&&g<=57?d=10*d+(g-48):65<=g&&g<=90&&(u=26*u+(g-64))}return{c:u-1,r:d-1}}function bs(r){for(var d=r.c+1,u="";d;d=(d-1)/26|0)u=String.fromCharCode((d-1)%26+65)+u;return u+(r.r+1)}function La(r){var d=r.indexOf(":");return d==-1?{s:zr(r),e:zr(r)}:{s:zr(r.slice(0,d)),e:zr(r.slice(d+1))}}function Ss(r,d){return d===void 0||typeof d=="number"?Ss(r.s,r.e):(r=typeof r!="string"?bs(r):r)==(d=typeof d!="string"?bs(d):d)?r:r+":"+d}function Fs(r){for(var d={s:{c:0,r:0},e:{c:0,r:0}},b=0,u=0,h=0,g=r.length,b=0;u<g&&!((h=r.charCodeAt(u)-64)<1||26<h);++u)b=26*b+h;for(d.s.c=--b,b=0;u<g&&!((h=r.charCodeAt(u)-48)<0||9<h);++u)b=10*b+h;if(d.s.r=--b,u===g||h!=10)return d.e.c=d.s.c,d.e.r=d.s.r,d;for(++u,b=0;u!=g&&!((h=r.charCodeAt(u)-64)<1||26<h);++u)b=26*b+h;for(d.e.c=--b,b=0;u!=g&&!((h=r.charCodeAt(u)-48)<0||9<h);++u)b=10*b+h;return d.e.r=--b,d}function sd(r,d){var u=r.t=="d"&&d instanceof Date;if(r.z!=null)try{return r.w=Kr(r.z,u?Sr(d):d)}catch{}try{return r.w=Kr((r.XF||{}).numFmtId||(u?14:0),u?Sr(d):d)}catch{return""+d}}function ci(r,d,u){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&u&&u.dateNF&&(r.z=u.dateNF),r.t=="e"?$n[r.v]||r.v:sd(r,d??r.v))}function Vn(r,h){var u=h&&h.sheet?h.sheet:"Sheet1",h={};return h[u]=r,{SheetNames:[u],Sheets:h}}function fh(r,d,u){var h=u||{},g=r?Array.isArray(r):h.dense,b=r||(g?[]:{}),x=0,y=0;b&&h.origin!=null&&(typeof h.origin=="number"?x=h.origin:(x=(j=typeof h.origin=="string"?zr(h.origin):h.origin).r,y=j.c),b["!ref"]||(b["!ref"]="A1:A1"));var j,k={s:{c:1e7,r:1e7},e:{c:0,r:0}};b["!ref"]&&(j=Fs(b["!ref"]),k.s.c=j.s.c,k.s.r=j.s.r,k.e.c=Math.max(k.e.c,j.e.c),k.e.r=Math.max(k.e.r,j.e.r),x==-1&&(k.e.r=x=j.e.r+1));for(var E=0;E!=d.length;++E)if(d[E]){if(!Array.isArray(d[E]))throw new Error("aoa_to_sheet expects an array of arrays");for(var T=0;T!=d[E].length;++T)if(d[E][T]!==void 0){var _={v:d[E][T]},R=x+E,q=y+T;if(k.s.r>R&&(k.s.r=R),k.s.c>q&&(k.s.c=q),k.e.r<R&&(k.e.r=R),k.e.c<q&&(k.e.c=q),!d[E][T]||typeof d[E][T]!="object"||Array.isArray(d[E][T])||d[E][T]instanceof Date)if(Array.isArray(_.v)&&(_.f=d[E][T][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(h.nullError)_.t="e",_.v=0;else{if(!h.sheetStubs)continue;_.t="z"}else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=h.dateNF||V[14],h.cellDates?(_.t="d",_.w=Kr(_.z,Sr(_.v))):(_.t="n",_.v=Sr(_.v),_.w=Kr(_.z,_.v))):_.t="s";else _=d[E][T];g?(b[R]||(b[R]=[]),b[R][q]&&b[R][q].z&&(_.z=b[R][q].z),b[R][q]=_):(b[R=bs({c:q,r:R})]&&b[R].z&&(_.z=b[R].z),b[R]=_)}}return k.s.c<1e7&&(b["!ref"]=Ss(k)),b}function Ql(r,d){return fh(null,r,d)}function ln(r,d){return(d=d||mt(4)).write_shift(4,r),d}function pa(r){var d=r.read_shift(4);return d===0?"":r.read_shift(d,"dbcs")}function da(r,d){var u=!1;return d==null&&(u=!0,d=mt(4+2*r.length)),d.write_shift(4,r.length),0<r.length&&d.write_shift(0,r,"dbcs"),u?d.slice(0,d.l):d}function y0(r,d){var u,h=r.l,g=r.read_shift(1),x=pa(r),b=[],x={t:x,h:x};if((1&g)!=0){for(var y=r.read_shift(4),j=0;j!=y;++j)b.push({ich:(u=r).read_shift(2),ifnt:u.read_shift(2)});x.r=b}else x.r=[{ich:0,ifnt:0}];return r.l=h+d,x}var Nm=y0;function $p(r,d){var u,h=!1;return d==null&&(h=!0,d=mt(23+4*r.t.length)),d.write_shift(1,1),da(r.t,d),d.write_shift(4,1),u={ich:0,ifnt:0},(r=(r=d)||mt(4)).write_shift(2,u.ich||0),r.write_shift(2,u.ifnt||0),h?d.slice(0,d.l):d}function Cn(r){var d=r.read_shift(4),u=r.read_shift(2);return u+=r.read_shift(1)<<16,r.l++,{c:d,iStyleRef:u}}function Xl(r,d){return(d=d??mt(8)).write_shift(-4,r.c),d.write_shift(3,r.iStyleRef||r.s),d.write_shift(1,0),d}function Jl(r){var d=r.read_shift(2);return d+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:d}}function Zl(r,d){return(d=d??mt(4)).write_shift(3,r.iStyleRef||r.s),d.write_shift(1,0),d}var on=pa,Zo=da;function v0(r){var d=r.read_shift(4);return d===0||d===4294967295?"":r.read_shift(d,"dbcs")}function rd(r,d){var u=!1;return d==null&&(u=!0,d=mt(127)),d.write_shift(4,0<r.length?r.length:4294967295),0<r.length&&d.write_shift(0,r,"dbcs"),u?d.slice(0,d.l):d}var km=pa,w0=v0,ad=rd;function mh(r){var d=r.slice(r.l,r.l+4),u=1&d[0],h=2&d[0];return r.l+=4,d=h==0?p0([0,0,0,0,252&d[0],d[1],d[2],d[3]],0):Kl(d,0)>>2,u?d/100:d}function eo(r,d){d==null&&(d=mt(4));var u=0,h=0,g=100*r;if(r==(0|r)&&-536870912<=r&&r<1<<29?h=1:g==(0|g)&&-536870912<=g&&g<1<<29&&(u=h=1),!h)throw new Error("unsupported RkNumber "+r);d.write_shift(-4,((u?g:r)<<2)+(u+2))}function j0(r){var d={s:{},e:{}};return d.s.r=r.read_shift(4),d.e.r=r.read_shift(4),d.s.c=r.read_shift(4),d.e.c=r.read_shift(4),d}var Wn=j0,vl=function(r,d){return(d=d||mt(16)).write_shift(4,r.s.r),d.write_shift(4,r.e.r),d.write_shift(4,r.s.c),d.write_shift(4,r.e.c),d};function ka(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Sn(r,d){return(d||mt(8)).write_shift(8,r,"f")}function Ri(r,d){if(d=d||mt(8),!r||r.auto)return d.write_shift(4,0),d.write_shift(4,0),d;r.index!=null?(d.write_shift(1,2),d.write_shift(1,r.index)):r.theme!=null?(d.write_shift(1,6),d.write_shift(1,r.theme)):(d.write_shift(1,5),d.write_shift(1,0));var u=r.tint||0;return 0<u?u*=32767:u<0&&(u*=32768),d.write_shift(2,u),r.rgb&&r.theme==null?(typeof(r=r.rgb||"FFFFFF")=="number"&&(r=("000000"+r.toString(16)).slice(-6)),d.write_shift(1,parseInt(r.slice(0,2),16)),d.write_shift(1,parseInt(r.slice(2,4),16)),d.write_shift(1,parseInt(r.slice(4,6),16)),d.write_shift(1,255)):(d.write_shift(2,0),d.write_shift(1,0),d.write_shift(1,0)),d}function N0(r,d){var u=r.read_shift(4);switch(u){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[r.read_shift(4)]||""}if(400<u)throw new Error("Unsupported Clipboard: "+u.toString(16));return r.l-=4,r.read_shift(0,d==1?"lpstr":"lpwstr")}var k0=2,ra=3,gh=12,ph=81,Cm=[80,ph],xh={1:{n:"CodePage",t:k0},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:ra},5:{n:"LineCount",t:ra},6:{n:"ParagraphCount",t:ra},7:{n:"SlideCount",t:ra},8:{n:"NoteCount",t:ra},9:{n:"HiddenCount",t:ra},10:{n:"MultimediaClipCount",t:ra},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:ra},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:ra,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},bh={1:{n:"CodePage",t:k0},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:ra},15:{n:"WordCount",t:ra},16:{n:"CharCount",t:ra},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:ra},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Sm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Am=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ec=sr([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(r){return[r>>16&255,r>>8&255,255&r]})),$n={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},An={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ba={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function wl(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function C0(r,d){var u,h=(function(j){for(var k=[],E=wr(j),T=0;T!==E.length;++T)k[j[E[T]]]==null&&(k[j[E[T]]]=[]),k[j[E[T]]].push(E[T]);return k})(tc),g=[];g[g.length]=jr,g[g.length]=Bt("Types",null,{xmlns:Wr.CT,"xmlns:xsd":Wr.xsd,"xmlns:xsi":Wr.xsi}),g=g.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(j){return Bt("Default",null,{Extension:j[0],ContentType:j[1]})}));function b(j){r[j]&&0<r[j].length&&(u=r[j][0],g[g.length]=Bt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Ba[j][d.bookType]||Ba[j].xlsx}))}function x(j){(r[j]||[]).forEach(function(k){g[g.length]=Bt("Override",null,{PartName:(k[0]=="/"?"":"/")+k,ContentType:Ba[j][d.bookType]||Ba[j].xlsx})})}function y(j){(r[j]||[]).forEach(function(k){g[g.length]=Bt("Override",null,{PartName:(k[0]=="/"?"":"/")+k,ContentType:h[j][0]})})}return b("workbooks"),x("sheets"),x("charts"),y("themes"),["strs","styles"].forEach(b),["coreprops","extprops","custprops"].forEach(y),y("vba"),y("comments"),y("threadedcomments"),y("drawings"),x("metadata"),y("people"),2<g.length&&(g[g.length]="</Types>",g[1]=g[1].replace("/>",">")),g.join("")}var Ns={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function jl(r){var d=r.lastIndexOf("/");return r.slice(0,d+1)+"_rels/"+r.slice(d+1)+".rels"}function to(r,d){var u={"!id":{}};if(!r)return u;d.charAt(0)!=="/"&&(d="/"+d);var h={};return(r.match(Jr)||[]).forEach(function(g){var b,x=os(g);x[0]==="<Relationship"&&((b={}).Type=x.Type,b.Target=x.Target,b.Id=x.Id,x.TargetMode&&(b.TargetMode=x.TargetMode),g=x.TargetMode==="External"?x.Target:fl(x.Target,d),u[g]=b,h[x.Id]=b)}),u["!id"]=h,u}function En(r){var d=[jr,Bt("Relationships",null,{xmlns:Wr.RELS})];return wr(r["!id"]).forEach(function(u){d[d.length]=Bt("Relationship",null,r["!id"][u])}),2<d.length&&(d[d.length]="</Relationships>",d[1]=d[1].replace("/>",">")),d.join("")}function ir(r,d,u,h,g,b){if(g=g||{},r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),d<0)for(d=r["!idx"];r["!id"]["rId"+d];++d);if(r["!idx"]=d+1,g.Id="rId"+d,g.Type=h,g.Target=u,-1<[Ns.HLINK,Ns.XPATH,Ns.XMISS].indexOf(g.Type)&&(g.TargetMode="External"),r["!id"][g.Id])throw new Error("Cannot rewrite rId "+d);return r["!id"][g.Id]=g,r[("/"+g.Target).replace("//","/")]=g,d}var S0="application/vnd.oasis.opendocument.spreadsheet";function so(r,d,u){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(u||"odf")+"#"+d+`"/>
`,`  </rdf:Description>
`].join("")}function Em(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+s.version+"</meta:generator></office:meta></office:document-meta>"}var _r=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],yh=(function(){for(var r=new Array(_r.length),d=0;d<_r.length;++d){var u=_r[d],u="(?:"+u[0].slice(0,u[0].indexOf(":"))+":)"+u[0].slice(u[0].indexOf(":")+1);r[d]=new RegExp("<"+u+"[^>]*>([\\s\\S]*?)</"+u+">")}return r})();function di(r){var d={};r=Fe(r);for(var u=0;u<_r.length;++u){var h=_r[u],g=r.match(yh[u]);g!=null&&0<g.length&&(d[h[1]]=ys(g[1])),h[2]==="date"&&d[h[1]]&&(d[h[1]]=Cs(d[h[1]]))}return d}function A0(r,d,u,h,g){g[r]==null&&d!=null&&d!==""&&(d=Ys(g[r]=d),h[h.length]=u?Bt(r,d,u):Hs(r,d))}function nd(r,d){var u=d||{},h=[jr,Bt("cp:coreProperties",null,{"xmlns:cp":Wr.CORE_PROPS,"xmlns:dc":Wr.dc,"xmlns:dcterms":Wr.dcterms,"xmlns:dcmitype":Wr.dcmitype,"xmlns:xsi":Wr.xsi})],g={};if(!r&&!u.Props)return h.join("");r&&(r.CreatedDate!=null&&A0("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:qo(r.CreatedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},h,g),r.ModifiedDate!=null&&A0("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:qo(r.ModifiedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},h,g));for(var b=0;b!=_r.length;++b){var x=_r[b],y=u.Props&&u.Props[x[1]]!=null?u.Props[x[1]]:r?r[x[1]]:null;y===!0?y="1":y===!1?y="0":typeof y=="number"&&(y=String(y)),y!=null&&A0(x[0],y,null,h,g)}return 2<h.length&&(h[h.length]="</cp:coreProperties>",h[1]=h[1].replace("/>",">")),h.join("")}var cn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],E0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function vh(r,d,u,h){var g=[];if(typeof r=="string")g=nr(r,h);else for(var b=0;b<r.length;++b)g=g.concat(r[b].map(function(E){return{v:E}}));var x,y=typeof d=="string"?nr(d,h).map(function(E){return E.v}):d,j=0;if(0<y.length)for(var k=0;k!==g.length;k+=2){switch(x=+g[k+1].v,g[k].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":u.Worksheets=x,u.SheetNames=y.slice(j,j+x);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":u.NamedRanges=x,u.DefinedNames=y.slice(j,j+x);break;case"Charts":case"Diagramme":u.Chartsheets=x,u.ChartNames=y.slice(j,j+x)}j+=x}}function D0(r){var d=[],u=Bt;return(r=r||{}).Application="SheetJS",d[d.length]=jr,d[d.length]=Bt("Properties",null,{xmlns:Wr.EXT_PROPS,"xmlns:vt":Wr.vt}),cn.forEach(function(h){if(r[h[1]]!==void 0){var g;switch(h[2]){case"string":g=Ys(String(r[h[1]]));break;case"bool":g=r[h[1]]?"true":"false"}g!==void 0&&(d[d.length]=u(h[0],g))}}),d[d.length]=u("HeadingPairs",u("vt:vector",u("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+u("vt:variant",u("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),d[d.length]=u("TitlesOfParts",u("vt:vector",r.SheetNames.map(function(h){return"<vt:lpstr>"+Ys(h)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),2<d.length&&(d[d.length]="</Properties>",d[1]=d[1].replace("/>",">")),d.join("")}var Dm=/<[^>]+>[^<]*/g;function dn(r){var d=[jr,Bt("Properties",null,{xmlns:Wr.CUST_PROPS,"xmlns:vt":Wr.vt})];if(!r)return d.join("");var u=1;return wr(r).forEach(function(h){++u,d[d.length]=Bt("property",(function(g,b){switch(typeof g){case"string":var x=Bt("vt:lpwstr",Ys(g));return x=x.replace(/&quot;/g,"_x0022_");case"number":return Bt((0|g)==g?"vt:i4":"vt:r8",Ys(String(g)));case"boolean":return Bt("vt:bool",g?"true":"false")}if(g instanceof Date)return Bt("vt:filetime",qo(g));throw new Error("Unable to serialize "+g)})(r[h]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:u,name:Ys(h)})}),2<d.length&&(d[d.length]="</Properties>",d[1]=d[1].replace("/>",">")),d.join("")}var ro,Nl={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function sc(u){var d=u.read_shift(4),u=u.read_shift(4);return new Date(1e3*(u/1e7*Math.pow(2,32)+d/1e7-11644473600)).toISOString().replace(/\.000/,"")}function rc(r,d,u){var h=r.l,g=r.read_shift(0,"lpstr-cp");if(u)for(;r.l-h&3;)++r.l;return g}function un(r,d,u){var h=r.read_shift(0,"lpwstr");return h}function hn(r,d,u){return d===31?un(r):rc(r,0,u)}function Oi(r,d,u){return hn(r,d,u===!1?0:4)}function ui(r){for(var d,u,h,g=r.read_shift(4),b=[],x=0;x<g/2;++x)b.push((h=u=void 0,u=(d=r).l,h=id(d,ph),d[d.l]==0&&d[d.l+1]==0&&d.l-u&2&&(d.l+=2),[h,id(d,ra)]));return b}function qn(r,d){for(var u=r.read_shift(4),h={},g=0;g!=u;++g){var b=r.read_shift(4),x=r.read_shift(4);h[b]=r.read_shift(x,d===1200?"utf16le":"utf8").replace(ye,"").replace(Te,"!"),d===1200&&x%2&&(r.l+=2)}return 3&r.l&&(r.l=r.l>>3<<2),h}function hi(r){var d=r.read_shift(4),u=r.slice(r.l,r.l+d);return r.l+=d,0<(3&d)&&(r.l+=4-(3&d)&3),u}function id(r,d,u){var h,g,b=r.read_shift(2),x=u||{};if(r.l+=2,d!==gh&&b!==d&&Cm.indexOf(d)===-1&&((65534&d)!=4126||(65534&b)!=4126))throw new Error("Expected type "+d+" saw "+b);switch(d===gh?b:d){case 2:return h=r.read_shift(2,"i"),x.raw||(r.l+=2),h;case 3:return h=r.read_shift(4,"i");case 11:return r.read_shift(4)!==0;case 19:return h=r.read_shift(4);case 30:return rc(r,0,4).replace(ye,"");case 31:return un(r);case 64:return sc(r);case 65:return hi(r);case 71:return(g={}).Size=(h=r).read_shift(4),h.l+=g.Size+3-(g.Size-1)%4,g;case 80:return Oi(r,b,!x.raw).replace(ye,"");case 81:return(function(y,j){if(!j)throw new Error("VtUnalignedString must have positive length");return hn(y,j,0)})(r,b).replace(ye,"");case 4108:return ui(r);case 4126:case 4127:return(b==4127?function(y){for(var j=y.read_shift(4),k=[],E=0;E!=j;++E){var T=y.l;k[E]=y.read_shift(0,"lpwstr").replace(ye,""),y.l-T&2&&(y.l+=2)}return k}:function(y){for(var j=y.read_shift(4),k=[],E=0;E!=j;++E)k[E]=y.read_shift(0,"lpstr-cp").replace(ye,"");return k})(r);default:throw new Error("TypedPropertyValue unrecognized type "+d+" "+b)}}function T0(r,d){var u,h,g,b=mt(4),x=mt(4);switch(b.write_shift(4,r==80?31:r),r){case 3:x.write_shift(-4,d);break;case 5:(x=mt(8)).write_shift(8,d,"f");break;case 11:x.write_shift(4,d?1:0);break;case 64:h=(typeof(u=d)=="string"?new Date(Date.parse(u)):u).getTime()/1e3+11644473600,g=h%Math.pow(2,32),u=(h-g)/Math.pow(2,32),u*=1e7,0<(h=(g*=1e7)/Math.pow(2,32)|0)&&(g%=Math.pow(2,32),u+=h),(h=mt(8)).write_shift(4,g),h.write_shift(4,u),x=h;break;case 31:case 80:for((x=mt(4+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,d.length+1),x.write_shift(0,d,"dbcs");x.l!=x.length;)x.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+d)}return he([b,x])}function _0(r,d){for(var u=r.l,h=r.read_shift(4),g=r.read_shift(4),b=[],k=0,x=0,y=-1,j={},k=0;k!=g;++k){var E=r.read_shift(4),T=r.read_shift(4);b[k]=[E,T+u]}b.sort(function(Y,z){return Y[1]-z[1]});var _={};for(k=0;k!=g;++k){if(r.l!==b[k][1]){var R=!0;if(0<k&&d)switch(d[b[k-1][0]].t){case 2:r.l+2===b[k][1]&&(r.l+=2,R=!1);break;case 80:case 4108:r.l<=b[k][1]&&(r.l=b[k][1],R=!1)}if((!d||k==0)&&r.l<=b[k][1]&&(R=!1,r.l=b[k][1]),R)throw new Error("Read Error: Expected address "+b[k][1]+" at "+r.l+" :"+k)}if(d){var q=d[b[k][0]];if(_[q.n]=id(r,q.t,{raw:!0}),q.p==="version"&&(_[q.n]=String(_[q.n]>>16)+"."+("0000"+String(65535&_[q.n])).slice(-4)),q.n=="CodePage")switch(_[q.n]){case 0:_[q.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:D(x=_[q.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[q.n])}}else if(b[k][0]===1)x=_.CodePage=id(r,k0),D(x),y!==-1&&(J=r.l,r.l=b[y][1],j=qn(r,x),r.l=J);else if(b[k][0]===0)x!==0?j=qn(r,x):(y=k,r.l=b[k+1][1]);else{var I,J=j[b[k][0]];switch(r[r.l]){case 65:r.l+=4,I=hi(r);break;case 30:case 31:r.l+=4,I=Oi(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,I=r.read_shift(4,"i");break;case 19:r.l+=4,I=r.read_shift(4);break;case 5:r.l+=4,I=r.read_shift(8,"f");break;case 11:r.l+=4,I=Zs(r,4);break;case 64:r.l+=4,I=Cs(sc(r));break;default:throw new Error("unparsed value: "+r[r.l])}_[J]=I}}return r.l=u+h,_}var wh=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function xa(r,d,u){var h,g,b,x,y=mt(8),j=[],k=[],E=8,T=0,_=mt(8),R=mt(8);if(_.write_shift(4,2),_.write_shift(4,1200),R.write_shift(4,1),k.push(_),j.push(R),E+=8+_.length,!d){(R=mt(8)).write_shift(4,0),j.unshift(R);var q=[mt(4)];for(q[0].write_shift(4,r.length),T=0;T<r.length;++T){var I=r[T][0];for((_=mt(8+2*(I.length+1)+(I.length%2?0:2))).write_shift(4,T+2),_.write_shift(4,I.length+1),_.write_shift(0,I,"dbcs");_.l!=_.length;)_.write_shift(1,0);q.push(_)}_=he(q),k.unshift(_),E+=8+_.length}for(T=0;T<r.length;++T)d&&!d[r[T][0]]||-1<wh.indexOf(r[T][0])||-1<E0.indexOf(r[T][0])||r[T][1]!=null&&(b=r[T][1],h=0,_=d?((x=u[h=+d[r[T][0]]]).p=="version"&&typeof b=="string"&&(b=(+(g=b.split("."))[0]<<16)+(+g[1]||0)),T0(x.t,b)):((x=(function(Y){switch(typeof Y){case"boolean":return 11;case"number":return(0|Y)==Y?3:5;case"string":return 31;case"object":if(Y instanceof Date)return 64}return-1})(b))==-1&&(x=31,b=String(b)),T0(x,b)),k.push(_),(R=mt(8)).write_shift(4,d?h:2+T),j.push(R),E+=8+_.length);for(var J=8*(k.length+1),T=0;T<k.length;++T)j[T].write_shift(4,J),J+=k[T].length;return y.write_shift(4,E),y.write_shift(4,k.length),he([y].concat(j).concat(k))}function kr(r,d,u){var h=r.content;if(!h)return{};Na(h,0);var g,b=0;h.chk("feff","Byte Order: "),h.read_shift(2);var x=h.read_shift(4),y=h.read_shift(16);if(y!==Tt.utils.consts.HEADER_CLSID&&y!==u)throw new Error("Bad PropertySet CLSID "+y);if((r=h.read_shift(4))!==1&&r!==2)throw new Error("Unrecognized #Sets: "+r);if(u=h.read_shift(16),y=h.read_shift(4),r===1&&y!==h.l)throw new Error("Length mismatch: "+y+" !== "+h.l);r===2&&(g=h.read_shift(16),b=h.read_shift(4));var j,k,E=_0(h,d),T={SystemIdentifier:x};for(j in E)T[j]=E[j];if(T.FMTID=u,r===1)return T;if(b-h.l==2&&(h.l+=2),h.l!==b)throw new Error("Length mismatch 2: "+h.l+" !== "+b);try{k=_0(h,null)}catch{}for(j in k)T[j]=k[j];return T.FMTID=[u,g],T}function Vs(r,d,u,h,g,b){var x=mt(g?68:48),y=[x];return x.write_shift(2,65534),x.write_shift(2,0),x.write_shift(4,842412599),x.write_shift(16,Tt.utils.consts.HEADER_CLSID,"hex"),x.write_shift(4,g?2:1),x.write_shift(16,d,"hex"),x.write_shift(4,g?68:48),h=xa(r,u,h),y.push(h),g&&(g=xa(g,null,null),x.write_shift(16,b,"hex"),x.write_shift(4,68+h.length),y.push(g)),he(y)}function za(r,d){return r.read_shift(d),null}function Zs(r,d){return r.read_shift(d)===1}function Ca(r,d){return(d=d||mt(2)).write_shift(2,+!!r),d}function xr(r){return r.read_shift(2,"u")}function fn(r,d){return(d=d||mt(2)).write_shift(2,r),d}function jh(r,d){return(function(u,h,g){for(var b=[],x=u.l+h;u.l<x;)b.push(g(u,x-u.l));if(x!==u.l)throw new Error("Slurp error");return b})(r,d,xr)}function ao(r,d,u){return(u=u||mt(2)).write_shift(1,d=="e"?+r:+!!r),u.write_shift(1,d=="e"?1:0),u}function Yn(r,d,u){var h=r.read_shift(u&&12<=u.biff?2:1),g="sbcs-cont",b=m;return u&&8<=u.biff&&(m=1200),u&&u.biff!=8?u.biff==12&&(g="wstr"):r.read_shift(1)&&(g="dbcs-cont"),2<=u.biff&&u.biff<=5&&(g="cpstr"),g=h?r.read_shift(h,g):"",m=b,g}function Pi(r,d,u){if(u){if(2<=u.biff&&u.biff<=5)return r.read_shift(d,"cpstr");if(12<=u.biff)return r.read_shift(d,"dbcs-cont")}return r.read_shift(1)===0?r.read_shift(d,"sbcs-cont"):r.read_shift(d,"dbcs-cont")}function Ii(r,d,u){var h=r.read_shift(u&&u.biff==2?1:2);return h===0?(r.l++,""):Pi(r,h,u)}function Bi(r,d,u){if(5<u.biff)return Ii(r,0,u);var h=r.read_shift(1);return h===0?(r.l++,""):r.read_shift(h,u.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function kl(r,d,u){return(u=u||mt(3+2*r.length)).write_shift(2,r.length),u.write_shift(1,1),u.write_shift(31,r,"utf16le"),u}function zi(r){var d,u,h,g,b=r.read_shift(16);switch(b){case"e0c9ea79f9bace118c8200aa004ba90b":return u=(d=r).read_shift(4),h=d.l,g=!1,24<u&&(d.l+=u-24,d.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(g=!0),d.l=h),u=d.read_shift((g?u-24:u)>>1,"utf16le").replace(ye,""),g&&(d.l+=24),u;case"0303000000000000c000000000000046":return(function(x){for(var y=x.read_shift(2),j="";0<y--;)j+="../";var k=x.read_shift(0,"lpstr-ansi");if(x.l+=2,x.read_shift(2)!=57005)throw new Error("Bad FileMoniker");if(x.read_shift(4)===0)return j+k.replace(/\\/g,"/");if(k=x.read_shift(4),x.read_shift(2)!=3)throw new Error("Bad FileMoniker");return j+x.read_shift(k>>1,"utf16le").replace(ye,"")})(r);default:throw new Error("Unsupported Moniker "+b)}}function Gn(r){var d=r.read_shift(4);return 0<d?r.read_shift(d,"utf16le").replace(ye,""):""}function fi(r,d){(d=d||mt(6+2*r.length)).write_shift(4,1+r.length);for(var u=0;u<r.length;++u)d.write_shift(2,r.charCodeAt(u));return d.write_shift(2,0),d}function F0(r){return[r.read_shift(1),r.read_shift(1),r.read_shift(1),r.read_shift(1)]}function M0(r){return r=F0(r),r[3]=0,r}function Ua(r){return{r:r.read_shift(2),c:r.read_shift(2),ixfe:r.read_shift(2)}}function mi(r,d,u,h){return(h=h||mt(6)).write_shift(2,r),h.write_shift(2,d),h.write_shift(2,u||0),h}function Cl(r){return[r.read_shift(2),mh(r)]}function aa(r){var d=r.read_shift(2),u=r.read_shift(2);return{s:{c:r.read_shift(2),r:d},e:{c:r.read_shift(2),r:u}}}function ld(r,d){return(d=d||mt(8)).write_shift(2,r.s.r),d.write_shift(2,r.e.r),d.write_shift(2,r.s.c),d.write_shift(2,r.e.c),d}function Nh(r){var d=r.read_shift(2),u=r.read_shift(2);return{s:{c:r.read_shift(1),r:d},e:{c:r.read_shift(1),r:u}}}var qp=Nh;function Tm(r){r.l+=4;var d=r.read_shift(2),u=r.read_shift(2),h=r.read_shift(2);return r.l+=12,[u,d,h]}function Ra(r){r.l+=2,r.l+=r.read_shift(2)}var na={0:Ra,4:Ra,5:Ra,6:Ra,7:function(r){return r.l+=4,r.cf=r.read_shift(2),{}},8:Ra,9:Ra,10:Ra,11:Ra,12:Ra,13:function(r){var d={};return r.l+=4,r.l+=16,d.fSharedNote=r.read_shift(2),r.l+=4,d},14:Ra,15:Ra,16:Ra,17:Ra,18:Ra,19:Ra,20:Ra,21:Tm};function ac(r,d){var u={BIFFVer:0,dt:0};switch(u.BIFFVer=r.read_shift(2),2<=(d-=2)&&(u.dt=r.read_shift(2),r.l-=2),u.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<d)throw new Error("Unexpected BIFF Ver "+u.BIFFVer)}return r.read_shift(d),u}function no(r,d,u){var h=1536,g=16;switch(u.bookType){case"biff8":break;case"biff5":h=1280,g=8;break;case"biff4":h=4,g=6;break;case"biff3":h=3,g=6;break;case"biff2":h=2,g=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}return u=mt(g),u.write_shift(2,h),u.write_shift(2,d),4<g&&u.write_shift(2,29282),6<g&&u.write_shift(2,1997),8<g&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function od(r){var d=mt(8);d.write_shift(4,r.Count),d.write_shift(4,r.Unique);for(var u,h,g,b=[],x=0;x<r.length;++x)b[x]=(u=r[x],g=h=void 0,h=u.t||"",(g=mt(3)).write_shift(2,h.length),g.write_shift(1,1),(u=mt(2*h.length)).write_shift(2*h.length,h,"utf16le"),he([g,u]));var y=he([d].concat(b));return y.parts=[d.length].concat(b.map(function(j){return j.length})),y}function L0(r,d,u){var h=0;return u&&u.biff==2||(h=r.read_shift(2)),r=r.read_shift(2),u&&u.biff==2&&(h=1-(r>>15),r&=32767),[{Unsynced:1&h,DyZero:(2&h)>>1,ExAsc:(4&h)>>2,ExDsc:(8&h)>>3},r]}var Bl=Bi;function io(r,b,x){var h=r.l+b,y=x.biff!=8&&x.biff?2:4,g=r.read_shift(y),b=r.read_shift(y),x=r.read_shift(2),y=r.read_shift(2);return r.l=h,{s:{r:g,c:x},e:{r:b,c:y}}}function lo(r,d,u,h){return u=u&&u.biff==5,(h=h||mt(u?16:20)).write_shift(2,0),r.style?(h.write_shift(2,r.numFmtId||0),h.write_shift(2,65524)):(h.write_shift(2,r.numFmtId||0),h.write_shift(2,d<<4)),d=0,0<r.numFmtId&&u&&(d|=1024),h.write_shift(4,d),h.write_shift(4,0),u||h.write_shift(4,0),h.write_shift(2,0),h}function _m(r,d,u){var h=Ua(r);return u.biff!=2&&d!=9||++r.l,r=(d=r).read_shift(1),r=d.read_shift(1)===1?r:r===1,h.val=r,h.t=r===!0||r===!1?"b":"e",h}function kh(r,d,u){return d===0?"":Bi(r,0,u)}function Fm(r,d,u){var h,g=r.read_shift(2),g={fBuiltIn:1&g,fWantAdvise:g>>>1&1,fWantPict:g>>>2&1,fOle:g>>>3&1,fOleLink:g>>>4&1,cf:g>>>5&1023,fIcon:g>>>15&1};return u.sbcch===14849&&(h=(function(b,k,y){b.l+=4,k-=4;var j=b.l+k,k=Yn(b,0,y);if((y=b.read_shift(2))!==(j-=b.l))throw new Error("Malformed AddinUdf: padding = "+j+" != "+y);return b.l+=y,k})(r,d-2,u)),g.body=h||r.read_shift(d-2),typeof h=="string"&&(g.Name=h),g}var Mm=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Sl(r,j,u){var h=r.l+j,g=r.read_shift(2),b=r.read_shift(1),x=r.read_shift(1),y=r.read_shift(u&&u.biff==2?1:2),j=0;return(!u||5<=u.biff)&&(u.biff!=5&&(r.l+=2),j=r.read_shift(2),u.biff==5&&(r.l+=2),r.l+=4),x=Pi(r,x,u),32&g&&(x=Mm[x.charCodeAt(0)]),g=h-r.l,u&&u.biff==2&&--g,{chKey:b,Name:x,itab:j,rgce:h!=r.l&&y!==0&&0<g?(function(k,q,T,I){var R,q=k.l+q,I=Td(k,I,T);return q!==k.l&&(R=yo(k,q-k.l,I,T)),[I,R]})(r,g,u,y):[]}}function R0(r,d,u){if(u.biff<8)return(function(y,j){return y[y.l+1]==3&&y[y.l]++,j=Yn(y,0,j),j.charCodeAt(0)==3?j.slice(1):j})(r,u);for(var h,g,b=[],d=r.l+d,x=r.read_shift(8<u.biff?4:2);x--!=0;)b.push((h=r,u.biff,g=8<(g=u).biff?4:2,[h.read_shift(g),h.read_shift(g,"i"),h.read_shift(g,"i")]));if(r.l!=d)throw new Error("Bad ExternSheet: "+r.l+" != "+d);return b}function cd(r,d,u){var h=qp(r);switch(u.biff){case 2:r.l++,d-=7;break;case 3:case 4:r.l+=2,d-=8;break;default:r.l+=6,d-=12}return[h,(function(g,b,x){var y,j=g.l+b,k=x.biff==2?1:2,E=g.read_shift(k);if(E==65535)return[[],Fa(g,b-2)];var T=Td(g,E,x);return b!==E+k&&(y=yo(g,b-E-k,T,x)),g.l=j,[T,y]})(r,d,u)]}var Lm={8:function(r,d){var u=r.l+d;r.l+=10;var h=r.read_shift(2);return r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4,d=r.read_shift(1),r.l+=d,r.l=u,{fmt:h}}};function nc(r){var d=mt(24),u=zr(r[0]);d.write_shift(2,u.r),d.write_shift(2,u.r),d.write_shift(2,u.c),d.write_shift(2,u.c);for(var h="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),g=0;g<16;++g)d.write_shift(1,parseInt(h[g],16));return he([d,(function(b){var x=mt(512),y=0,j=b.Target,k=-1<(b=(j=j.slice(0,7)=="file://"?j.slice(7):j).indexOf("#"))?31:23;switch(j.charAt(0)){case"#":k=28;break;case".":k&=-3}x.write_shift(4,2),x.write_shift(4,k);for(var E=[8,6815827,6619237,4849780,83],y=0;y<E.length;++y)x.write_shift(4,E[y]);if(k==28)fi(j=j.slice(1),x);else if(2&k){for(E="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),y=0;y<E.length;++y)x.write_shift(1,parseInt(E[y],16));var T=-1<b?j.slice(0,b):j;for(x.write_shift(4,2*(T.length+1)),y=0;y<T.length;++y)x.write_shift(2,T.charCodeAt(y));x.write_shift(2,0),8&k&&fi(-1<b?j.slice(b+1):"",x)}else{for(E="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),y=0;y<E.length;++y)x.write_shift(1,parseInt(E[y],16));for(var _=0;j.slice(3*_,3*_+3)=="../"||j.slice(3*_,3*_+3)=="..\\";)++_;for(x.write_shift(2,_),x.write_shift(4,j.length-3*_+1),y=0;y<j.length-3*_;++y)x.write_shift(1,255&j.charCodeAt(y+3*_));for(x.write_shift(1,0),x.write_shift(2,65535),x.write_shift(2,57005),y=0;y<6;++y)x.write_shift(4,0)}return x.slice(0,x.l)})(r[1])])}function O0(r,j,u){if(!u.cellStyles)return Fa(r,j);var h=u&&12<=u.biff?4:2,g=r.read_shift(h),b=r.read_shift(h),x=r.read_shift(h),y=r.read_shift(h),j=r.read_shift(2);return h==2&&(r.l+=2),y={s:g,e:b,w:x,ixfe:y,flags:j},(5<=u.biff||!u.biff)&&(y.level=j>>8&7),y}var P0=Ua,I0=jh,If=Ii,Ch,Sh,gi,oo=[2,3,48,49,131,139,140,245],B0=(Ch={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},Sh=ni({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),gi={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(r,d){try{return Vn(Ah(r,d),d)}catch(u){if(d&&d.WTF)throw u}return{SheetNames:[],Sheets:{}}},to_sheet:Ah,from_sheet:function(r,d){if(0<=+(d=d||{}).codepage&&D(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");for(var u=Ma(),h=(d=Pu(r,{header:1,raw:!0,cellDates:!0}))[0],g=d.slice(1),b=r["!cols"]||[],k=0,x=0,y=0,j=1,k=0;k<h.length;++k)if(((b[k]||{}).DBF||{}).name)h[k]=b[k].DBF.name,++y;else if(h[k]!=null){if(++y,typeof h[k]=="number"&&(h[k]=h[k].toString(10)),typeof h[k]!="string")throw new Error("DBF Invalid column name "+h[k]+" |"+typeof h[k]+"|");if(h.indexOf(h[k])!==k){for(x=0;x<1024;++x)if(h.indexOf(h[k]+"_"+x)==-1){h[k]+="_"+x;break}}}var E=Fs(r["!ref"]),T=[],_=[],R=[];for(k=0;k<=E.e.c-E.s.c;++k){for(var q="",I="",J=0,Y=[],x=0;x<g.length;++x)g[x][k]!=null&&Y.push(g[x][k]);if(Y.length!=0&&h[k]!=null){for(x=0;x<Y.length;++x){switch(typeof Y[x]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=Y[x]instanceof Date?"D":"C";break;default:I="C"}J=Math.max(J,String(Y[x]).length),q=q&&q!=I?"C":I}250<J&&(J=250),(I=((b[k]||{}).DBF||{}).type)=="C"&&b[k].DBF.len>J&&(J=b[k].DBF.len),q=="B"&&I=="N"&&(q="N",R[k]=b[k].DBF.dec,J=b[k].DBF.len),_[k]=q=="C"||I=="N"?J:gi[q]||0,j+=_[k],T[k]=q}else T[k]="?"}var z,X,ie=u.next(32);for(ie.write_shift(4,318902576),ie.write_shift(4,g.length),ie.write_shift(2,296+32*y),ie.write_shift(2,j),k=0;k<4;++k)ie.write_shift(4,0);for(ie.write_shift(4,0|(+Sh[v]||3)<<8),x=k=0;k<h.length;++k)h[k]!=null&&(z=u.next(32),X=(h[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),z.write_shift(1,X,"sbcs"),z.write_shift(1,T[k]=="?"?"C":T[k],"sbcs"),z.write_shift(4,x),z.write_shift(1,_[k]||gi[T[k]]||0),z.write_shift(1,R[k]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),x+=_[k]||gi[T[k]]||0);var le=u.next(264);for(le.write_shift(4,13),k=0;k<65;++k)le.write_shift(4,0);for(k=0;k<g.length;++k){var Ee=u.next(j);for(Ee.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(T[x]){case"L":Ee.write_shift(1,g[k][x]==null?63:g[k][x]?84:70);break;case"B":Ee.write_shift(8,g[k][x]||0,"f");break;case"N":var He="0";for(typeof g[k][x]=="number"&&(He=g[k][x].toFixed(R[x]||0)),y=0;y<_[x]-He.length;++y)Ee.write_shift(1,32);Ee.write_shift(1,He,"sbcs");break;case"D":g[k][x]?(Ee.write_shift(4,("0000"+g[k][x].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(g[k][x].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+g[k][x].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var Pe=String(g[k][x]!=null?g[k][x]:"").slice(0,_[x]);for(Ee.write_shift(1,Pe,"sbcs"),y=0;y<_[x]-Pe.length;++y)Ee.write_shift(1,32)}}return u.next(1).write_shift(1,26),u.end()}});function Ah(r,d){return d=d||{},d.dateNF||(d.dateNF="yyyymmdd"),r=Ql((function(u,h){var g=[],b=Z(1);switch(h.type){case"base64":b=ue(ke(u));break;case"binary":b=ue(u);break;case"buffer":case"array":b=u}Na(b,0);var x=b.read_shift(1),y=!!(136&x),j=!1,k=!1;switch(x){case 2:case 3:break;case 48:case 49:y=j=!0;break;case 131:case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var E=0,T=521;x==2&&(E=b.read_shift(2)),b.l+=3,1048576<(E=x!=2?b.read_shift(4):E)&&(E=1e6),x!=2&&(T=b.read_shift(2));var _=b.read_shift(2),R=h.codepage||1252;x!=2&&(b.l+=16,b.read_shift(1),b[b.l]!==0&&(R=Ch[b[b.l]]),b.l+=1,b.l+=2),k&&(b.l+=36);for(var q=[],I={},J=Math.min(b.length,x==2?521:T-10-(j?264:0)),Y=k?32:11;b.l<J&&b[b.l]!=13;)switch((I={}).name=e.utils.decode(R,b.slice(b.l,b.l+Y)).replace(/[\u0000\r\n].*$/g,""),b.l+=Y,I.type=String.fromCharCode(b.read_shift(1)),x==2||k||(I.offset=b.read_shift(4)),I.len=b.read_shift(1),x==2&&(I.offset=b.read_shift(2)),I.dec=b.read_shift(1),I.name.length&&q.push(I),x!=2&&(b.l+=k?13:14),I.type){case"B":j&&I.len==8||!h.WTF||console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(b[b.l]!==13&&(b.l=T-1),b.read_shift(1)!==13)throw new Error("DBF Terminator not found "+b.l+" "+b[b.l]);b.l=T;var z=0,X=0;for(g[0]=[],X=0;X!=q.length;++X)g[0][X]=q[X].name;for(;0<E--;)if(b[b.l]!==42)for(++b.l,g[++z]=[],X=X=0;X!=q.length;++X){var ie=b.slice(b.l,b.l+q[X].len);b.l+=q[X].len,Na(ie,0);var le=e.utils.decode(R,ie);switch(q[X].type){case"C":le.trim().length&&(g[z][X]=le.replace(/\s+$/,""));break;case"D":le.length===8?g[z][X]=new Date(+le.slice(0,4),+le.slice(4,6)-1,+le.slice(6,8)):g[z][X]=le;break;case"F":g[z][X]=parseFloat(le.trim());break;case"+":case"I":g[z][X]=k?2147483648^ie.read_shift(-4,"i"):ie.read_shift(4,"i");break;case"L":switch(le.trim().toUpperCase()){case"Y":case"T":g[z][X]=!0;break;case"N":case"F":g[z][X]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+le+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));g[z][X]="##MEMO##"+(k?parseInt(le.trim(),10):ie.read_shift(4));break;case"N":(le=le.replace(/\u0000/g,"").trim())&&le!="."&&(g[z][X]=+le||0);break;case"@":g[z][X]=new Date(ie.read_shift(-8,"f")-621356832e5);break;case"T":g[z][X]=new Date(864e5*(ie.read_shift(4)-2440588)+ie.read_shift(4));break;case"Y":g[z][X]=ie.read_shift(4,"i")/1e4+ie.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[z][X]=-ie.read_shift(-8,"f");break;case"B":if(j&&q[X].len==8){g[z][X]=ie.read_shift(8,"f");break}case"G":case"P":ie.l+=q[X].len;break;case"0":if(q[X].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+q[X].type)}}else b.l+=_;if(x!=2&&b.l<b.length&&b[b.l++]!=26)throw new Error("DBF EOF Marker missing "+(b.l-1)+" of "+b.length+" "+b[b.l-1].toString(16));return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),h.DBF=q,g})(r,d),d),r["!cols"]=d.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete d.DBF,r}var Ui,ic,dd,lc,ud=(Ui={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},ic=new RegExp("\x1BN("+wr(Ui).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),dd=function(r,d){return d=Ui[d],typeof d=="number"?G(d):d},lc=function(r,d,u){return u=d.charCodeAt(0)-32<<4|u.charCodeAt(0)-48,u==59?r:G(u)},Ui["|"]=254,{to_workbook:function(r,d){return Vn(Al(r,d),d)},to_sheet:Al,from_sheet:function(r,d){var u,h,g=["ID;PWXL;N;E"],b=[],x=Fs(r["!ref"]),y=Array.isArray(r),j=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),r["!cols"]&&(u=g,r["!cols"].forEach(function(_,R){R="F;W"+(R+1)+" "+(R+1)+" ",_.hidden?R+="0":(typeof _.width!="number"||_.wpx||(_.wpx=fc(_.width)),typeof _.wpx!="number"||_.wch||(_.wch=Dl(_.wpx)),typeof _.wch=="number"&&(R+=Math.round(_.wch))),R.charAt(R.length-1)!=" "&&u.push(R)})),r["!rows"]&&(h=g,r["!rows"].forEach(function(_,R){var q="F;";_.hidden?q+="M0;":_.hpt?q+="M"+20*_.hpt+";":_.hpx&&(q+="M"+20*mc(_.hpx)+";"),2<q.length&&h.push(q+"R"+(R+1))})),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var k=x.s.r;k<=x.e.r;++k)for(var E=x.s.c;E<=x.e.c;++E){var T=bs({r:k,c:E});(T=y?(r[k]||[])[E]:r[T])&&(T.v!=null||T.f&&!T.F)&&b.push((function(_,R,q){var I="C;Y"+(R+1)+";X"+(q+1)+";K";switch(_.t){case"n":I+=_.v||0,_.f&&!_.F&&(I+=";E"+nu(_.f,{r:R,c:q}));break;case"b":I+=_.v?"TRUE":"FALSE";break;case"e":I+=_.w||_.v;break;case"d":I+='"'+(_.w||_.v)+'"';break;case"s":I+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return I})(T,k,E))}return g.join(j)+j+b.join(j)+j+"E"+j}});function hd(_,d){var u,h,g=_.split(/[\n\r]+/),b=-1,x=-1,y=0,j=0,k=[],E=[],T=null,_={},R=[],q=[],I=0;for(0<=+d.codepage&&D(+d.codepage);y!==g.length;++y){I=0;var J,Y=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,lc).replace(ic,dd),z=Y.replace(/;;/g,"\0").split(";").map(function(kt){return kt.replace(/\u0000/g,";")}),X=z[0];if(0<Y.length)switch(X){case"ID":case"E":case"B":case"O":case"W":break;case"P":z[1].charAt(0)=="P"&&E.push(Y.slice(3).replace(/;;/g,";"));break;case"C":for(var ie=!1,le=!1,Ee=!1,He=!1,Pe=-1,Qe=-1,j=1;j<z.length;++j)switch(z[j].charAt(0)){case"A":break;case"X":x=parseInt(z[j].slice(1))-1,le=!0;break;case"Y":for(b=parseInt(z[j].slice(1))-1,le||(x=0),h=k.length;h<=b;++h)k[h]=[];break;case"K":(J=z[j].slice(1)).charAt(0)==='"'?J=J.slice(1,J.length-1):J==="TRUE"?J=!0:J==="FALSE"?J=!1:isNaN(nn(J))?isNaN(Xr(J).getDate())||(J=Cs(J)):(J=nn(J),T!==null&&dr(T)&&(J=wn(J))),e!==void 0&&typeof J=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(J=e.utils.decode(d.codepage,J)),ie=!0;break;case"E":He=!0;var pt=xo(z[j].slice(1),{r:b,c:x});k[b][x]=[k[b][x],pt];break;case"S":Ee=!0,k[b][x]=[k[b][x],"S5S"];break;case"G":break;case"R":Pe=parseInt(z[j].slice(1))-1;break;case"C":Qe=parseInt(z[j].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+Y)}if(ie&&(k[b][x]&&k[b][x].length==2?k[b][x][0]=J:k[b][x]=J,T=null),Ee){if(He)throw new Error("SYLK shared formula cannot have own formula");var xt=-1<Pe&&k[Pe][Qe];if(!xt||!xt[1])throw new Error("SYLK shared formula cannot find base");k[b][x][1]=Ad(xt[1],{r:b-Pe,c:x-Qe})}break;case"F":var at=0;for(j=1;j<z.length;++j)switch(z[j].charAt(0)){case"X":x=parseInt(z[j].slice(1))-1,++at;break;case"Y":for(b=parseInt(z[j].slice(1))-1,h=k.length;h<=b;++h)k[h]=[];break;case"M":I=parseInt(z[j].slice(1))/20;break;case"F":case"G":break;case"P":T=E[parseInt(z[j].slice(1))];break;case"S":case"D":case"N":break;case"W":for(u=z[j].slice(1).split(" "),h=parseInt(u[0],10);h<=parseInt(u[1],10);++h)I=parseInt(u[2],10),q[h-1]=I===0?{hidden:!0}:{wch:I},Tl(q[h-1]);break;case"C":q[x=parseInt(z[j].slice(1))-1]||(q[x]={});break;case"R":R[b=parseInt(z[j].slice(1))-1]||(R[b]={}),0<I?(R[b].hpt=I,R[b].hpx=po(I)):I===0&&(R[b].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+Y)}at<1&&(T=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+Y)}}return 0<R.length&&(_["!rows"]=R),0<q.length&&(_["!cols"]=q),[k=d&&d.sheetRows?k.slice(0,d.sheetRows):k,_]}function Al(h,d){var u=(function(x,y){switch(y.type){case"base64":return hd(ke(x),y);case"binary":return hd(x,y);case"buffer":return hd(xe&&Buffer.isBuffer(x)?x.toString("binary"):be(x),y);case"array":return hd(_a(x),y)}throw new Error("Unrecognized type "+y.type)})(h,d),h=u[0],g=u[1],b=Ql(h,d);return wr(g).forEach(function(x){b[x]=g[x]}),b}var Eh={to_workbook:function(r,d){return Vn(z0(r,d),d)},to_sheet:z0,from_sheet:function(r){var d=[],u=Fs(r["!ref"]),h=Array.isArray(r);oc(d,"TABLE",0,1,"sheetjs"),oc(d,"VECTORS",0,u.e.r-u.s.r+1,""),oc(d,"TUPLES",0,u.e.c-u.s.c+1,""),oc(d,"DATA",0,0,"");for(var g=u.s.r;g<=u.e.r;++g){Sa(d,-1,0,"BOT");for(var b=u.s.c;b<=u.e.c;++b){var x,y=bs({r:g,c:b});if(x=h?(r[g]||[])[b]:r[y])switch(x.t){case"n":var j=x.w;(j=!j&&x.v!=null?x.v:j)==null?x.f&&!x.F?Sa(d,1,0,"="+x.f):Sa(d,1,0,""):Sa(d,0,j,"V");break;case"b":Sa(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":Sa(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Kr(x.z||V[14],Sr(Cs(x.v)))),Sa(d,0,x.w,"V");break;default:Sa(d,1,0,"")}else Sa(d,1,0,"")}}return Sa(d,-1,0,"EOD"),d.join(`\r
`)}};function Kn(r,d){for(var u=r.split(`
`),h=-1,g=-1,b=0,x=[];b!==u.length;++b)if(u[b].trim()!=="BOT"){if(!(h<0)){for(var y=u[b].trim().split(","),j=y[0],k=y[1],E=u[++b]||"";1&(E.match(/["]/g)||[]).length&&b<u.length-1;)E+=`
`+u[++b];switch(E=E.trim(),+j){case-1:if(E==="BOT"){x[++h]=[],g=0;continue}if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?x[h][g]=!0:E==="FALSE"?x[h][g]=!1:isNaN(nn(k))?isNaN(Xr(k).getDate())?x[h][g]=k:x[h][g]=Cs(k):x[h][g]=nn(k),++g;break;case 1:E=(E=E.slice(1,E.length-1)).replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),x[h][g++]=E!==""?E:null}if(E==="EOD")break}}else x[++h]=[],g=0;return x=d&&d.sheetRows?x.slice(0,d.sheetRows):x}function z0(r,d){return Ql((function(u,h){switch(h.type){case"base64":return Kn(ke(u),h);case"binary":return Kn(u,h);case"buffer":return Kn(xe&&Buffer.isBuffer(u)?u.toString("binary"):be(u),h);case"array":return Kn(_a(u),h)}throw new Error("Unrecognized type "+h.type)})(r,d),d)}function oc(r,d,u,h,g){r.push(d),r.push(u+","+h),r.push('"'+g.replace(/"/g,'""')+'"')}function Sa(r,d,u,h){r.push(d+","+u),r.push(d==1?'"'+h.replace(/"/g,'""')+'"':h)}var Hi,co,U0,H0,cc=(Hi=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),co=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,U0=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),H0="--SocialCalcSpreadsheetControlSave--",{to_workbook:function(r,d){return Vn(Dh(r,d),d)},to_sheet:Dh,from_sheet:function(r){return[Hi,co,U0,co,(function(d){if(!d||!d["!ref"])return"";for(var u,h,g=[],b=[],x=La(d["!ref"]),y=Array.isArray(d),j=x.s.r;j<=x.e.r;++j)for(var k=x.s.c;k<=x.e.c;++k)if(h=bs({r:j,c:k}),(u=y?(d[j]||[])[k]:d[h])&&u.v!=null&&u.t!=="z"){switch(b=["cell",h,"t"],u.t){case"s":case"str":b.push(uo(u.v));break;case"n":u.f?(b[2]="vtf",b[3]="n",b[4]=u.v,b[5]=uo(u.f)):(b[2]="v",b[3]=u.v);break;case"b":b[2]="vt"+(u.f?"f":"c"),b[3]="nl",b[4]=u.v?"1":"0",b[5]=uo(u.f||(u.v?"TRUE":"FALSE"));break;case"d":var E=Sr(Cs(u.v));b[2]="vtc",b[3]="nd",b[4]=""+E,b[5]=u.w||Kr(u.z||V[14],E);break;case"e":continue}g.push(b.join(":"))}return g.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)})(r),H0].join(`
`)}});function uo(r){return r.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function Dh(r,d){return Ql((function(u,h){for(var g,b=u.split(`
`),x=-1,y=0,j=[];y!==b.length;++y){var k=b[y].trim().split(":");if(k[0]==="cell"){var E=zr(k[1]);if(j.length<=E.r)for(x=j.length;x<=E.r;++x)j[x]||(j[x]=[]);switch(x=E.r,g=E.c,k[2]){case"t":j[x][g]=k[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`);break;case"v":j[x][g]=+k[3];break;case"vtf":var T=k[k.length-1];case"vtc":k[3]==="nl"?j[x][g]=!!+k[4]:j[x][g]=+k[4],k[2]=="vtf"&&(j[x][g]=[j[x][g],T])}}}return j=h&&h.sheetRows?j.slice(0,h.sheetRows):j})(r,d),d)}var V0,Vi,Wi=(V0={44:",",9:"	",59:";",124:"|"},Vi={44:3,9:2,59:1,124:0},{to_workbook:function(r,d){return Vn(gn(r,d),d)},to_sheet:gn,from_sheet:function(r){for(var d=[],u=Fs(r["!ref"]),h=Array.isArray(r),g=u.s.r;g<=u.e.r;++g){for(var b=[],x=u.s.c;x<=u.e.c;++x){var y=bs({r:g,c:x});if((y=h?(r[g]||[])[x]:r[y])&&y.v!=null){for(var j=(y.w||(ci(y),y.w)||"").slice(0,10);j.length<10;)j+=" ";b.push(j+(x===0?" ":""))}else b.push("          ")}d.push(b.join(""))}return d.join(`
`)}});function Th(r,d,u,h,g){g.raw?d[u][h]=r:r===""||(r==="TRUE"?d[u][h]=!0:r==="FALSE"?d[u][h]=!1:isNaN(nn(r))?isNaN(Xr(r).getDate())?d[u][h]=r:d[u][h]=Cs(r):d[u][h]=nn(r))}function W0(r){for(var d={},u=!1,h=0,g=0;h<r.length;++h)(g=r.charCodeAt(h))==34?u=!u:!u&&g in V0&&(d[g]=(d[g]||0)+1);for(h in g=[],d)Object.prototype.hasOwnProperty.call(d,h)&&g.push([d[h],h]);if(!g.length)for(h in d=Vi)Object.prototype.hasOwnProperty.call(d,h)&&g.push([d[h],h]);return g.sort(function(b,x){return b[0]-x[0]||Vi[b[1]]-Vi[x[1]]}),V0[g.pop()[1]]||44}function _h(r,h){var u=h||{},h="",g=u.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};r.slice(0,4)=="sep="?r.charCodeAt(5)==13&&r.charCodeAt(6)==10?(h=r.charAt(4),r=r.slice(7)):r.charCodeAt(5)==13||r.charCodeAt(5)==10?(h=r.charAt(4),r=r.slice(6)):h=W0(r.slice(0,1024)):h=u&&u.FS?u.FS:W0(r.slice(0,1024));var x=0,y=0,j=0,k=0,E=0,T=h.charCodeAt(0),_=!1,R=0,q=r.charCodeAt(0);r=r.replace(/\r\n/gm,`
`);var I=u.dateNF!=null?(h=(h=typeof(h=u.dateNF)=="number"?V[h]:h).replace(Ci,"(\\d+)"),new RegExp("^"+h+"$")):null;function J(){var Y,z=r.slice(k,E),X={};if((z=z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'?z.slice(1,-1).replace(/""/g,'"'):z).length===0?X.t="z":u.raw||z.trim().length===0?(X.t="s",X.v=z):z.charCodeAt(0)==61?z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(X.t="s",X.v=z.slice(2,-1).replace(/""/g,'"')):z.length!=1?(X.t="n",X.f=z.slice(1)):(X.t="s",X.v=z):z=="TRUE"?(X.t="b",X.v=!0):z=="FALSE"?(X.t="b",X.v=!1):isNaN(j=nn(z))?!isNaN(Xr(z).getDate())||I&&z.match(I)?(X.z=u.dateNF||V[14],Y=0,I&&z.match(I)&&(z=(function(ie,le){var Ee=-1,He=-1,Pe=-1,Qe=-1,pt=-1,xt=-1;(ie.match(Ci)||[]).forEach(function(kt,Wt){var Ht=parseInt(le[Wt+1],10);switch(kt.toLowerCase().charAt(0)){case"y":Ee=Ht;break;case"d":Pe=Ht;break;case"h":Qe=Ht;break;case"s":xt=Ht;break;case"m":0<=Qe?pt=Ht:He=Ht}}),0<=xt&&pt==-1&&0<=He&&(pt=He,He=-1);var at=(""+(0<=Ee?Ee:new Date().getFullYear())).slice(-4)+"-"+("00"+(1<=He?He:1)).slice(-2)+"-"+("00"+(1<=Pe?Pe:1)).slice(-2);return(at=at.length==7?"0"+at:at).length==8&&(at="20"+at),ie=("00"+(0<=Qe?Qe:0)).slice(-2)+":"+("00"+(0<=pt?pt:0)).slice(-2)+":"+("00"+(0<=xt?xt:0)).slice(-2),Qe==-1&&pt==-1&&xt==-1?at:Ee==-1&&He==-1&&Pe==-1?ie:at+"T"+ie})(u.dateNF,z.match(I)||[]),Y=1),u.cellDates?(X.t="d",X.v=Cs(z,Y)):(X.t="n",X.v=Sr(Cs(z,Y))),u.cellText!==!1&&(X.w=Kr(X.z,X.v instanceof Date?Sr(X.v):X.v)),u.cellNF||delete X.z):(X.t="s",X.v=z):(!(X.t="n")!==u.cellText&&(X.w=z),X.v=j),X.t=="z"||(u.dense?(g[x]||(g[x]=[]),g[x][y]=X):g[bs({c:y,r:x})]=X),k=E+1,q=r.charCodeAt(k),b.e.c<y&&(b.e.c=y),b.e.r<x&&(b.e.r=x),R!=T)return y=0,++x,u.sheetRows&&u.sheetRows<=x?1:void 0;++y}e:for(;E<r.length;++E)switch(R=r.charCodeAt(E)){case 34:q===34&&(_=!_);break;case T:case 10:case 13:if(!_&&J())break e}return 0<E-k&&J(),g["!ref"]=Ss(b),g}function mn(r,d){return!d||!d.PRN||d.FS||r.slice(0,4)=="sep="||0<=r.indexOf("	")||0<=r.indexOf(",")||0<=r.indexOf(";")?_h(r,d):Ql((function(u,h){var g=h||{},b=[];if(!u||u.length===0)return b;for(var x=u.split(/[\r\n]/),y=x.length-1;0<=y&&x[y].length===0;)--y;for(var j=10,k=0,E=0;E<=y;++E)(k=x[E].indexOf(" "))==-1?k=x[E].length:k++,j=Math.max(j,k);for(E=0;E<=y;++E){b[E]=[];var T=0;for(Th(x[E].slice(0,j).trim(),b,E,T,g),T=1;T<=(x[E].length-j)/10+1;++T)Th(x[E].slice(j+10*(T-1),j+10*T).trim(),b,E,T,g)}return b=g.sheetRows?b.slice(0,g.sheetRows):b})(r,d),d)}function gn(r,d){var u="",h=d.type=="string"?[0,0,0,0]:_f(r,d);switch(d.type){case"base64":u=ke(r);break;case"binary":u=r;break;case"buffer":u=d.codepage==65001?r.toString("utf8"):d.codepage&&e!==void 0?e.utils.decode(d.codepage,r):xe&&Buffer.isBuffer(r)?r.toString("binary"):be(r);break;case"array":u=_a(r);break;case"string":u=r;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?u=Fe(u.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?u=Fe(u):d.type=="binary"&&e!==void 0&&d.codepage&&(u=e.utils.decode(d.codepage,e.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?cc.to_sheet(d.type=="string"?u:Fe(u),d):mn(u,d)}var Qn,fd,$0,$i,ua=(Qn={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},fd=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""],$0={0:{n:"BOF",f:xr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(r,d,u){var h={s:{c:0,r:0},e:{c:0,r:0}};return d==8&&u.qpro?(h.s.c=r.read_shift(1),r.l++,h.s.r=r.read_shift(2),h.e.c=r.read_shift(1),r.l++,h.e.r=r.read_shift(2)):(h.s.c=r.read_shift(2),h.s.r=r.read_shift(2),d==12&&u.qpro&&(r.l+=2),h.e.c=r.read_shift(2),h.e.r=r.read_shift(2),d==12&&u.qpro&&(r.l+=2),h.s.c==65535&&(h.s.c=h.e.c=h.s.r=h.e.r=0)),h}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(r,d,u){return(u=Dn(r,0,u))[1].v=r.read_shift(2,"i"),u}},14:{n:"NUMBER",f:function(r,d,u){return(u=Dn(r,0,u))[1].v=r.read_shift(8,"f"),u}},15:{n:"LABEL",f:As},16:{n:"FORMULA",f:function(r,d,u){var h=r.l+d;return(d=Dn(r,0,u))[1].v=r.read_shift(8,"f"),u.qpro?r.l=h:(h=r.read_shift(2),(function(g,b){Na(g,0);for(var x=[],y=0,j="",k="",E="",T="";g.l<g.length;){var _=g[g.l++];switch(_){case 0:x.push(g.read_shift(8,"f"));break;case 1:k=Js(b[0].c,g.read_shift(2),!0),j=Js(b[0].r,g.read_shift(2),!1),x.push(k+j);break;case 2:var R=Js(b[0].c,g.read_shift(2),!0),q=Js(b[0].r,g.read_shift(2),!1);k=Js(b[0].c,g.read_shift(2),!0),j=Js(b[0].r,g.read_shift(2),!1),x.push(R+q+":"+k+j);break;case 3:if(g.l<g.length)return console.error("WK1 premature formula end");break;case 4:x.push("("+x.pop()+")");break;case 5:x.push(g.read_shift(2));break;case 6:for(var I="";_=g[g.l++];)I+=String.fromCharCode(_);x.push('"'+I.replace(/"/g,'""')+'"');break;case 8:x.push("-"+x.pop());break;case 23:x.push("+"+x.pop());break;case 22:x.push("NOT("+x.pop()+")");break;case 20:case 21:T=x.pop(),E=x.pop(),x.push(["AND","OR"][_-20]+"("+E+","+T+")");break;default:if(_<32&&fd[_])T=x.pop(),E=x.pop(),x.push(E+fd[_]+T);else{if(!Qn[_])return _<=7?console.error("WK1 invalid opcode "+_.toString(16)):_<=24?console.error("WK1 unsupported op "+_.toString(16)):_<=30?console.error("WK1 invalid opcode "+_.toString(16)):_<=115?console.error("WK1 unsupported function opcode "+_.toString(16)):console.error("WK1 unrecognized opcode "+_.toString(16));if((y=(y=Qn[_][1])==69?g[g.l++]:y)>x.length)return console.error("WK1 bad formula parse 0x"+_.toString(16)+":|"+x.join("|")+"|");q=x.slice(-y),x.length-=y,x.push(Qn[_][0]+"("+q.join(",")+")")}}}x.length==1?b[1].f=""+x[0]:console.error("WK1 bad formula parse |"+x.join("|")+"|")})(r.slice(r.l,r.l+h),d),r.l+=h),d}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:As},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:El},222:{n:"SHEETNAMELP",f:function(r,d){var u=r[r.l++];d-1<u&&(u=d-1);for(var h="";h.length<u;)h+=String.fromCharCode(r[r.l++]);return h}},65535:{n:""}},$i={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(r,d){var u=Fr(r);return u[1].t="s",u[1].v=r.read_shift(d-4,"cstr"),u}},23:{n:"NUMBER17",f:md},24:{n:"NUMBER18",f:function(r,d){var u=Fr(r);u[1].v=r.read_shift(2);var h=u[1].v>>1;if(1&u[1].v)switch(7&h){case 0:h=5e3*(h>>3);break;case 1:h=500*(h>>3);break;case 2:h=(h>>3)/20;break;case 3:h=(h>>3)/200;break;case 4:h=(h>>3)/2e3;break;case 5:h=(h>>3)/2e4;break;case 6:h=(h>>3)/16;break;case 7:h=(h>>3)/64}return u[1].v=h,u}},25:{n:"FORMULA19",f:function(r,d){var u=md(r);return r.l+=d-14,u}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(r,d){for(var u={},h=r.l+d;r.l<h;){var g=r.read_shift(2);if(g==14e3){for(u[g]=[0,""],u[g][0]=r.read_shift(2);r[r.l];)u[g][1]+=String.fromCharCode(r[r.l]),r.l++;r.l++}}return u}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(h,d){var u=Fr(h),h=h.read_shift(4);return u[1].v=h>>6,u}},38:{n:"??"},39:{n:"NUMBER27",f:ho},40:{n:"FORMULA28",f:function(r,d){var u=ho(r);return r.l+=d-10,u}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:El},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(r,d,u){if(u.qpro&&!(d<21))return u=r.read_shift(1),r.l+=17,r.l+=1,r.l+=2,[u,r.read_shift(d-21,"cstr")]}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},{sheet_to_wk1:function(r,d){var u=d||{};if(0<=+u.codepage&&D(+u.codepage),u.type=="string")throw new Error("Cannot write WK1 to JS string");var h=Ma(),g=Fs(r["!ref"]),b=Array.isArray(r),x=[];zt(h,0,(d=1030,(u=mt(2)).write_shift(2,d),u)),zt(h,6,(d=g,(u=mt(8)).write_shift(2,d.s.c),u.write_shift(2,d.s.r),u.write_shift(2,d.e.c),u.write_shift(2,d.e.r),u));for(var y,j,k,E,T=Math.min(g.e.r,8191),_=g.s.r;_<=T;++_)for(var R=Br(_),q=g.s.c;q<=g.e.c;++q){_===g.s.r&&(x[q]=Er(q));var I=x[q]+R,I=b?(r[_]||[])[q]:r[I];I&&I.t!="z"&&(I.t=="n"?(0|I.v)==I.v&&-32768<=I.v&&I.v<=32767?zt(h,13,(y=_,j=q,k=I.v,E=void 0,(E=mt(7)).write_shift(1,255),E.write_shift(2,j),E.write_shift(2,y),E.write_shift(2,k,"i"),E)):zt(h,14,(j=_,y=q,k=I.v,E=void 0,(E=mt(13)).write_shift(1,255),E.write_shift(2,y),E.write_shift(2,j),E.write_shift(8,k,"f"),E)):zt(h,15,(function(J,Y,z){var X=mt(7+z.length);X.write_shift(1,255),X.write_shift(2,Y),X.write_shift(2,J),X.write_shift(1,39);for(var ie=0;ie<X.length;++ie){var le=z.charCodeAt(ie);X.write_shift(1,128<=le?95:le)}return X.write_shift(1,0),X})(_,q,ci(I).slice(0,239))))}return zt(h,1),h.end()},book_to_wk3:function(r,d){if(0<=+(d=d||{}).codepage&&D(+d.codepage),d.type=="string")throw new Error("Cannot write WK3 to JS string");var u=Ma();zt(u,0,(function(I){var J=mt(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var Y=0,z=0,X=0,ie=0;ie<I.SheetNames.length;++ie){var le=I.SheetNames[ie],le=I.Sheets[le];le&&le["!ref"]&&(++X,le=La(le["!ref"]),Y<le.e.r&&(Y=le.e.r),z<le.e.c&&(z=le.e.c))}return 8191<Y&&(Y=8191),J.write_shift(2,Y),J.write_shift(1,X),J.write_shift(1,z),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J})(r));for(var h=0,g=0;h<r.SheetNames.length;++h)(r.Sheets[r.SheetNames[h]]||{})["!ref"]&&zt(u,27,(function(I,J){var Y=mt(5+I.length);Y.write_shift(2,14e3),Y.write_shift(2,J);for(var z=0;z<I.length;++z){var X=I.charCodeAt(z);Y[Y.l++]=127<X?95:X}return Y[Y.l++]=0,Y})(r.SheetNames[h],g++));for(var b=0,h=0;h<r.SheetNames.length;++h){var x=r.Sheets[r.SheetNames[h]];if(x&&x["!ref"]){for(var y=Fs(x["!ref"]),j=Array.isArray(x),k=[],E=Math.min(y.e.r,8191),T=y.s.r;T<=E;++T)for(var _=Br(T),R=y.s.c;R<=y.e.c;++R){T===y.s.r&&(k[R]=Er(R));var q=k[R]+_,q=j?(x[T]||[])[R]:x[q];q&&q.t!="z"&&(q.t=="n"?zt(u,23,(function(Ee,Pe,He,X){var ie=mt(14);if(ie.write_shift(2,Ee),ie.write_shift(1,He),ie.write_shift(1,Pe),X==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var le=0,Ee=0,He=0,Pe=0;return X<0&&(le=1,X=-X),Ee=0|Math.log2(X),X/=Math.pow(2,Ee-31),(2147483648&(Pe=X>>>0))==0&&(++Ee,Pe=(X/=2)>>>0),X-=Pe,Pe|=2147483648,Pe>>>=0,X*=Math.pow(2,32),He=X>>>0,ie.write_shift(4,He),ie.write_shift(4,Pe),Ee+=16383+(le?32768:0),ie.write_shift(2,Ee),ie})(T,R,b,q.v)):zt(u,22,(function(J,Y,z,X){var ie=mt(6+X.length);ie.write_shift(2,J),ie.write_shift(1,z),ie.write_shift(1,Y),ie.write_shift(1,39);for(var le=0;le<X.length;++le){var Ee=X.charCodeAt(le);ie.write_shift(1,128<=Ee?95:Ee)}return ie.write_shift(1,0),ie})(T,R,b,ci(q).slice(0,239))))}++b}}return zt(u,1),u.end()},to_workbook:function(r,d){switch(d.type){case"base64":return dc(ue(ke(r)),d);case"binary":return dc(ue(r),d);case"buffer":case"array":return dc(r,d)}throw"Unsupported type "+d.type}});function $r(r,d,u){if(r){Na(r,r.l||0);for(var h=u.Enum||$0;r.l<r.length;){var g=r.read_shift(2),b=h[g]||h[65535],y=r.read_shift(2),x=r.l+y,y=b.f&&b.f(r,y,u);if(r.l=x,d(y,b,g))return}}}function dc(r,d){if(!r)return r;var u=d||{},h=u.dense?[]:{},g="Sheet1",b="",x=0,y={},j=[],k=[],E={s:{r:0,c:0},e:{r:0,c:0}},T=u.sheetRows||0;if(r[2]==0&&(r[3]==8||r[3]==9)&&16<=r.length&&r[14]==5&&r[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(r[2]==2)u.Enum=$0,$r(r,function(I,J,Y){switch(Y){case 0:4096<=(u.vers=I)&&(u.qpro=!0);break;case 6:E=I;break;case 204:I&&(b=I);break;case 222:b=I;break;case 15:case 51:u.qpro||(I[1].v=I[1].v.slice(1));case 13:case 14:case 16:Y==14&&(112&I[2])==112&&1<(15&I[2])&&(15&I[2])<15&&(I[1].z=u.dateNF||V[14],u.cellDates&&(I[1].t="d",I[1].v=wn(I[1].v))),u.qpro&&I[3]>x&&(h["!ref"]=Ss(E),y[g]=h,j.push(g),h=u.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},x=I[3],g=b||"Sheet"+(x+1),b="");var z=u.dense?(h[I[0].r]||[])[I[0].c]:h[bs(I[0])];if(z){z.t=I[1].t,z.v=I[1].v,I[1].z!=null&&(z.z=I[1].z),I[1].f!=null&&(z.f=I[1].f);break}u.dense?(h[I[0].r]||(h[I[0].r]=[]),h[I[0].r][I[0].c]=I[1]):h[bs(I[0])]=I[1]}},u);else{if(r[2]!=26&&r[2]!=14)throw new Error("Unrecognized LOTUS BOF "+r[2]);u.Enum=$i,r[2]==14&&(u.qpro=!0,r.l=0),$r(r,function(I,J,Y){switch(Y){case 204:g=I;break;case 22:I[1].v=I[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(I[3]>x&&(h["!ref"]=Ss(E),y[g]=h,j.push(g),h=u.dense?[]:{},E={s:{r:0,c:0},e:{r:0,c:0}},x=I[3],g="Sheet"+(x+1)),0<T&&I[0].r>=T)break;u.dense?(h[I[0].r]||(h[I[0].r]=[]),h[I[0].r][I[0].c]=I[1]):h[bs(I[0])]=I[1],E.e.c<I[0].c&&(E.e.c=I[0].c),E.e.r<I[0].r&&(E.e.r=I[0].r);break;case 27:I[14e3]&&(k[I[14e3][0]]=I[14e3][1]);break;case 1537:k[I[0]]=I[1],I[0]==x&&(g=I[1])}},u)}if(h["!ref"]=Ss(E),y[b||g]=h,j.push(b||g),!k.length)return{SheetNames:j,Sheets:y};for(var _={},R=[],q=0;q<k.length;++q)y[j[q]]?(R.push(k[q]||j[q]),_[k[q]]=y[k[q]]||y[j[q]]):(R.push(k[q]),_[k[q]]={"!ref":"A1"});return{SheetNames:R,Sheets:_}}function Dn(r,d,u){var h=[{c:0,r:0},{t:"n",v:0},0,0];return u.qpro&&u.vers!=20768?(h[0].c=r.read_shift(1),h[3]=r.read_shift(1),h[0].r=r.read_shift(2),r.l+=2):(h[2]=r.read_shift(1),h[0].c=r.read_shift(2),h[0].r=r.read_shift(2)),h}function As(r,g,u){var h=r.l+g,g=Dn(r,0,u);return g[1].t="s",u.vers!=20768?(u.qpro&&r.l++,g[1].v=r.read_shift(h-r.l,"cstr"),g):(r.l++,h=r.read_shift(1),g[1].v=r.read_shift(h,"utf8"),g)}function Js(r,d,u){var h=32768&d;return(h?"":"$")+(u?Er:Br)(d=(h?r:0)+(8192<=(d&=-32769)?d-16384:d))}function Fr(r){var d=[{c:0,r:0},{t:"n",v:0},0];return d[0].r=r.read_shift(2),d[3]=r[r.l++],d[0].c=r[r.l++],d}function md(b,d){var u=Fr(b),h=b.read_shift(4),g=b.read_shift(4);if((x=b.read_shift(2))==65535)return h===0&&g===3221225472?(u[1].t="e",u[1].v=15):h===0&&g===3489660928?(u[1].t="e",u[1].v=42):u[1].v=0,u;var b=32768&x,x=(32767&x)-16446;return u[1].v=(1-2*b)*(g*Math.pow(2,32+x)+h*Math.pow(2,x)),u}function ho(h,d){var u=Fr(h),h=h.read_shift(8,"f");return u[1].v=h,u}function El(r,d){return r[r.l+d-1]==0?r.read_shift(d,"cstr"):""}var gd,uc,fo,Rm,qr=(gd=Rt("t"),uc=Rt("rPr"),fo=/<(?:\w+:)?r>/g,Rm=/<\/(?:\w+:)?r>/,function(r){return r.replace(fo,"").split(Rm).map(Fh).filter(function(d){return d.v})});function Fh(r){var d=r.match(gd);return d?(d={t:"s",v:ys(d[1])},r=r.match(uc),r&&(d.s=(function(u){var h={},g=u.match(Jr),b=0,x=!1;if(g)for(;b!=g.length;++b){var y=os(g[b]);switch(y[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!y.val)break;case"<shadow>":case"<shadow/>":h.shadow=1;break;case"</shadow>":break;case"<charset":if(y.val=="1")break;h.cp=N[parseInt(y.val,10)];break;case"<outline":if(!y.val)break;case"<outline>":case"<outline/>":h.outline=1;break;case"</outline>":break;case"<rFont":h.name=y.val;break;case"<sz":h.sz=y.val;break;case"<strike":if(!y.val)break;case"<strike>":case"<strike/>":h.strike=1;break;case"</strike>":break;case"<u":if(!y.val)break;switch(y.val){case"double":h.uval="double";break;case"singleAccounting":h.uval="single-accounting";break;case"doubleAccounting":h.uval="double-accounting"}case"<u>":case"<u/>":h.u=1;break;case"</u>":break;case"<b":if(y.val=="0")break;case"<b>":case"<b/>":h.b=1;break;case"</b>":break;case"<i":if(y.val=="0")break;case"<i>":case"<i/>":h.i=1;break;case"</i>":break;case"<color":y.rgb&&(h.color=y.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":h.family=y.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":h.valign=y.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":x=!0;break;case"</ext>":x=!1;break;default:if(y[0].charCodeAt(1)!==47&&!x)throw new Error("Unrecognized rich format "+y[0])}}return h})(r[1])),d):{t:"s",v:""}}var q0,Om=(q0=/(\r\n|\n)/g,function(r){return r.map(Pm).join("")});function Pm(r){var d,u,h,g=[[],r.v,[]];return r.v?(r.s&&(d=r.s,u=g[0],h=g[2],r=[],d.u&&r.push("text-decoration: underline;"),d.uval&&r.push("text-underline-style:"+d.uval+";"),d.sz&&r.push("font-size:"+d.sz+"pt;"),d.outline&&r.push("text-effect: outline;"),d.shadow&&r.push("text-shadow: auto;"),u.push('<span style="'+r.join("")+'">'),d.b&&(u.push("<b>"),h.push("</b>")),d.i&&(u.push("<i>"),h.push("</i>")),d.strike&&(u.push("<s>"),h.push("</s>")),(r=d.valign||"")=="superscript"||r=="super"?r="sup":r=="subscript"&&(r="sub"),r!=""&&(u.push("<"+r+">"),h.push("</"+r+">")),h.push("</span>")),g[0].join("")+g[1].replace(q0,"<br/>")+g[2].join("")):""}var Yp=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Mh=/<(?:\w+:)?r>/,Lh=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function pd(r,h){var u=!h||h.cellHTML,h={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(h.t=ys(Fe(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),h.r=Fe(r),u&&(h.h=$o(h.t))):r.match(Mh)&&(h.r=Fe(r),h.t=ys(Fe((r.replace(Lh,"").match(Yp)||[]).join("").replace(Jr,""))),u&&(h.h=Om(qr(h.r)))),h):{t:""}}var Ha=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Zr=/<(?:\w+:)?(?:si|sstItem)>/g,Y0=/<\/(?:\w+:)?(?:si|sstItem)>/,xd=/^\s|\s$|[\t\n\r]/;function bd(r,d){if(!d.bookSST)return"";var u=[jr];u[u.length]=Bt("sst",null,{xmlns:xl[0],count:r.Count,uniqueCount:r.Unique});for(var h,g,b=0;b!=r.length;++b)r[b]!=null&&(g="<si>",(h=r[b]).r?g+=h.r:(g+="<t",h.t||(h.t=""),h.t.match(xd)&&(g+=' xml:space="preserve"'),g+=">"+Ys(h.t)+"</t>"),g+="</si>",u[u.length]=g);return 2<u.length&&(u[u.length]="</sst>",u[1]=u[1].replace("/>",">")),u.join("")}var Rh=function(r,d){var u=!1;return d==null&&(u=!0,d=mt(15+4*r.t.length)),d.write_shift(1,0),da(r.t,d),u?d.slice(0,d.l):d};function qi(r){var d,u,h=Ma();yt(h,159,(d=r,(u=u||mt(8)).write_shift(4,d.Count),u.write_shift(4,d.Unique),u));for(var g=0;g<r.length;++g)yt(h,19,Rh(r[g]));return yt(h,160),h.end()}function yd(r){if(e!==void 0)return e.utils.encode(v,r);for(var d=[],u=r.split(""),h=0;h<u.length;++h)d[h]=u[h].charCodeAt(0);return d}function Xn(r,d){var u={};return u.Major=r.read_shift(2),u.Minor=r.read_shift(2),4<=d&&(r.l+=d-4),u}function Oh(r){var d=[];r.l+=4;for(var u=r.read_shift(4);0<u--;)d.push((function(h){for(var b=h.read_shift(4),g=h.l+b-4,b={},x=h.read_shift(4),y=[];0<x--;)y.push({t:h.read_shift(4),v:h.read_shift(0,"lpp4")});if(b.name=h.read_shift(0,"lpp4"),b.comps=y,h.l!=g)throw new Error("Bad DataSpaceMapEntry: "+h.l+" != "+g);return b})(r));return d}function Im(r){var d,u,u=(u={},(d=r).read_shift(4),d.l+=4,u.id=d.read_shift(0,"lpp4"),u.name=d.read_shift(0,"lpp4"),u.R=Xn(d,4),u.U=Xn(d,4),u.W=Xn(d,4),u);if(u.ename=r.read_shift(0,"8lpp4"),u.blksz=r.read_shift(4),u.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return u}function Ph(r,u){var u=r.l+u,h={};h.Flags=63&r.read_shift(4),r.l+=4,h.AlgID=r.read_shift(4);var g=!1;switch(h.AlgID){case 26126:case 26127:case 26128:g=h.Flags==36;break;case 26625:g=h.Flags==4;break;case 0:g=h.Flags==16||h.Flags==4||h.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+h.AlgID}if(!g)throw new Error("Encryption Flags/AlgID mismatch");return h.AlgIDHash=r.read_shift(4),h.KeySize=r.read_shift(4),h.ProviderType=r.read_shift(4),r.l+=8,h.CSPName=r.read_shift(u-r.l>>1,"utf16le"),r.l=u,h}function Ih(r,h){var u={},h=r.l+h;return r.l+=4,u.Salt=r.slice(r.l,r.l+16),r.l+=16,u.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),u.VerifierHash=r.slice(r.l,h),r.l=h,u}function Bm(r){var d=Xn(r);switch(d.Minor){case 2:return[d.Minor,(function(g){if((63&g.read_shift(4))!=36)throw new Error("EncryptionInfo mismatch");var h=g.read_shift(4),h=Ph(g,h),g=Ih(g,g.length-g.l);return{t:"Std",h,v:g}})(r)];case 3:return[d.Minor,(function(){throw new Error("File is password-protected: ECMA-376 Extensible")})()];case 4:return[d.Minor,(function(g){var h=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];g.l+=4;var g=g.read_shift(g.length-g.l,"utf8"),b={};return g.replace(Jr,function(x){var y=os(x);switch(kn(y[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":h.forEach(function(j){b[j]=y[j]});break;case"<dataIntegrity":b.encryptedHmacKey=y.encryptedHmacKey,b.encryptedHmacValue=y.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":b.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":b.uri=y.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":b.encs.push(y);break;default:throw y[0]}}),b})(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+d.Minor)}function G0(r){var d,u=0,h=yd(r),g=h.length+1,b=Z(g);for(b[0]=h.length,d=1;d!=g;++d)b[d]=h[d-1];for(d=g-1;0<=d;--d)u=(((16384&u)==0?0:1)|u<<1&32767)^b[d];return 52811^u}var K0,Q0,Bh,zm=(K0=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],Q0=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],Bh=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],function(r){for(var d,u,h=yd(r),g=(function(j){for(var k=Q0[j.length-1],E=104,T=j.length-1;0<=T;--T)for(var _=j[T],R=0;R!=7;++R)64&_&&(k^=Bh[E]),_*=2,--E;return k})(h),b=h.length,x=Z(16),y=0;y!=16;++y)x[y]=0;for((1&b)==1&&(d=g>>8,x[b]=mo(K0[0],d),--b,d=255&g,r=h[h.length-1],x[b]=mo(r,d));0<b;)d=g>>8,x[--b]=mo(h[b],d),d=255&g,x[--b]=mo(h[b],d);for(u=(b=15)-h.length;0<u;)d=g>>8,x[b]=mo(K0[u],d),--u,d=255&g,x[--b]=mo(h[b],d),--b,--u;return x});function mo(r,d){return 255&((d=r^d)/2|128*d)}var Um=function(r){var d=0,u=zm(r);return function(h){return h=(function(g,b,x,y,j){var k,E;for(j=j||b,y=y||zm(g),k=0;k!=b.length;++k)E=b[k],E=255&((E^=y[x])>>5|E<<3),j[k]=E,++x;return[j,x,y]})("",h,d,u),d=h[1],h[0]}};function Hm(r,d,u){return u=u||{},u.Info=r.read_shift(2),r.l-=2,u.Info===1?u.Data=(function(h){var g={},b=g.EncryptionVersionInfo=Xn(h,4);if(b.Major!=1||b.Minor!=1)throw"unrecognized version code "+b.Major+" : "+b.Minor;return g.Salt=h.read_shift(16),g.EncryptedVerifier=h.read_shift(16),g.EncryptedVerifierHash=h.read_shift(16),g})(r):u.Data=(function(h,g){var b={},x=b.EncryptionVersionInfo=Xn(h,4);if(g-=4,x.Minor!=2)throw new Error("unrecognized minor version code: "+x.Minor);if(4<x.Major||x.Major<2)throw new Error("unrecognized major version code: "+x.Major);return b.Flags=h.read_shift(4),g-=4,x=h.read_shift(4),g-=4,b.EncryptionHeader=Ph(h,x),g-=x,b.EncryptionVerifier=Ih(h,g),b})(r,d),u}var X0={to_workbook:function(r,d){return Vn(zh(r,d),d)},to_sheet:zh,from_sheet:function(r){for(var d=["{\\rtf1\\ansi"],u=Fs(r["!ref"]),h=Array.isArray(r),g=u.s.r;g<=u.e.r;++g){d.push("\\trowd\\trautofit1");for(var b=u.s.c;b<=u.e.c;++b)d.push("\\cellx"+(b+1));for(d.push("\\pard\\intbl"),b=u.s.c;b<=u.e.c;++b){var x=bs({r:g,c:b});(x=h?(r[g]||[])[b]:r[x])&&(x.v!=null||x.f&&!x.F)&&(d.push(" "+(x.w||(ci(x),x.w))),d.push("\\cell"))}d.push("\\pard\\intbl\\row")}return d.join("")+"}"}};function zh(r,d){switch(d.type){case"base64":return vd(ke(r),d);case"binary":return vd(r,d);case"buffer":return vd(xe&&Buffer.isBuffer(r)?r.toString("binary"):be(r),d);case"array":return vd(_a(r),d)}throw new Error("Unrecognized type "+d.type)}function vd(h,d){var u=(d||{}).dense?[]:{},h=h.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(b,x){Array.isArray(u)&&(u[x]=[]);for(var y,j=/\\\w+\b/g,k=0,E=-1;y=j.exec(b);)y[0]==="\\cell"&&(++E,(y=(y=b.slice(k,j.lastIndex-y[0].length))[0]==" "?y.slice(1):y).length&&(y={v:y,t:"s"},Array.isArray(u)?u[x][E]=y:u[bs({r:x,c:E})]=y)),k=j.lastIndex;E>g.e.c&&(g.e.c=E)}),u["!ref"]=Ss(g),u}function hc(r){for(var d=0,u=1;d!=3;++d)u=256*u+(255<r[d]?255:r[d]<0?0:r[d]);return u.toString(16).toUpperCase().slice(1)}function wd(r,d){return d===0?r:(r=(function(E){var h=E[0]/255,g=E[1]/255,b=E[2]/255,x=Math.max(h,g,b),y=Math.min(h,g,b),j=x-y;if(j==0)return[0,0,h];var k=0,E=0,E=j/(1<(y=x+y)?2-y:y);switch(x){case h:k=((g-b)/j+6)%6;break;case g:k=(b-h)/j+2;break;case b:k=(h-g)/j+4}return[k/6,E,y/2]})((r=(r=r).slice(r[0]==="#"?1:0).slice(0,6),[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)])),r[2]=d<0?r[2]*(1+d):1-(1-r[2])*(1-d),hc((function(x){var h,g=x[0],b=x[1],x=x[2],y=2*b*(x<.5?x:1-x),j=[x=x-y/2,x,x],k=6*g;if(b!==0)switch(0|k){case 0:case 6:h=y*k,j[0]+=y,j[1]+=h;break;case 1:h=y*(2-k),j[0]+=h,j[1]+=y;break;case 2:h=y*(k-2),j[1]+=y,j[2]+=h;break;case 3:h=y*(4-k),j[1]+=h,j[2]+=y;break;case 4:h=y*(k-4),j[2]+=y,j[0]+=h;break;case 5:h=y*(6-k),j[2]+=h,j[0]+=y}for(var E=0;E!=3;++E)j[E]=Math.round(255*j[E]);return j})(r)))}var Uh=6,Gp=15,Vm=1,ea=Uh;function fc(r){return Math.floor((r+Math.round(128/ea)/256)*ea)}function Dl(r){return Math.floor((r-5)/ea*100+.5)/100}function go(r){return Math.round((r*ea+5)/ea*256)/256}function J0(r){return go(Dl(fc(r)))}function jd(r){var d=Math.abs(r-J0(r)),u=ea;if(.005<d)for(ea=Vm;ea<Gp;++ea)Math.abs(r-J0(r))<=d&&(d=Math.abs(r-J0(r)),u=ea);ea=u}function Tl(r){r.width?(r.wpx=fc(r.width),r.wch=Dl(r.wpx),r.MDW=ea):r.wpx?(r.wch=Dl(r.wpx),r.width=go(r.wch),r.MDW=ea):typeof r.wch=="number"&&(r.width=go(r.wch),r.wpx=fc(r.width),r.MDW=ea),r.customWidth&&delete r.customWidth}var Hh=96;function mc(r){return 96*r/Hh}function po(r){return r*Hh/96}var Wm={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},Nd=["numFmtId","fillId","fontId","borderId","xfId"],gc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Vh,Wh,Z0,$h,qh,kd,Yh=(Vh=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,Wh=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,Z0=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,$h=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,qh=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(r,d,u){var h,g,b,x,y,j={};return r&&((h=(r=r.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(Vh))&&(function(k,E,T){E.NumberFmt=[];for(var _=wr(V),R=0;R<_.length;++R)E.NumberFmt[_[R]]=V[_[R]];var q=k[0].match(Jr);if(q)for(R=0;R<q.length;++R){var I=os(q[R]);switch(kn(I[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var J=ys(Fe(I.formatCode)),Y=parseInt(I.numFmtId,10);if(E.NumberFmt[Y]=J,0<Y){if(392<Y){for(Y=392;60<Y&&E.NumberFmt[Y]!=null;--Y);E.NumberFmt[Y]=J}Or(J,Y)}break;case"</numFmt>":break;default:if(T.WTF)throw new Error("unrecognized "+I[0]+" in numFmts")}}})(h,j,u),(h=r.match($h))&&(function(k,E,T,_){E.Fonts=[];var R={},q=!1;(k[0].match(Jr)||[]).forEach(function(I){var J,Y=os(I);switch(kn(Y[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":E.Fonts.push(R),R={};break;case"<name":Y.val&&(R.name=Fe(Y.val));break;case"<name/>":case"</name>":break;case"<b":R.bold=Y.val?Ve(Y.val):1;break;case"<b/>":R.bold=1;break;case"<i":R.italic=Y.val?Ve(Y.val):1;break;case"<i/>":R.italic=1;break;case"<u":switch(Y.val){case"none":R.underline=0;break;case"single":R.underline=1;break;case"double":R.underline=2;break;case"singleAccounting":R.underline=33;break;case"doubleAccounting":R.underline=34}break;case"<u/>":R.underline=1;break;case"<strike":R.strike=Y.val?Ve(Y.val):1;break;case"<strike/>":R.strike=1;break;case"<outline":R.outline=Y.val?Ve(Y.val):1;break;case"<outline/>":R.outline=1;break;case"<shadow":R.shadow=Y.val?Ve(Y.val):1;break;case"<shadow/>":R.shadow=1;break;case"<condense":R.condense=Y.val?Ve(Y.val):1;break;case"<condense/>":R.condense=1;break;case"<extend":R.extend=Y.val?Ve(Y.val):1;break;case"<extend/>":R.extend=1;break;case"<sz":Y.val&&(R.sz=+Y.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":Y.val&&(R.vertAlign=Y.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":Y.val&&(R.family=parseInt(Y.val,10));break;case"<family/>":case"</family>":break;case"<scheme":Y.val&&(R.scheme=Y.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(Y.val=="1")break;Y.codepage=N[parseInt(Y.val,10)];break;case"<color":R.color||(R.color={}),Y.auto&&(R.color.auto=Ve(Y.auto)),Y.rgb?R.color.rgb=Y.rgb.slice(-6):Y.indexed?(R.color.index=parseInt(Y.indexed,10),J=ec[R.color.index],J=(J=R.color.index==81?ec[1]:J)||ec[1],R.color.rgb=J[0].toString(16)+J[1].toString(16)+J[2].toString(16)):Y.theme&&(R.color.theme=parseInt(Y.theme,10),Y.tint&&(R.color.tint=parseFloat(Y.tint)),Y.theme&&T.themeElements&&T.themeElements.clrScheme&&(R.color.rgb=wd(T.themeElements.clrScheme[R.color.theme].rgb,R.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":q=!0;break;case"</AlternateContent>":q=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":q=!0;break;case"</ext>":q=!1;break;default:if(_&&_.WTF&&!q)throw new Error("unrecognized "+Y[0]+" in fonts")}})})(h,j,d,u),(h=r.match(Z0))&&(function(k,E,T){E.Fills=[];var _={},R=!1;(k[0].match(Jr)||[]).forEach(function(q){var I=os(q);switch(kn(I[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":_={},E.Fills.push(_);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":E.Fills.push(_),_={};break;case"<patternFill":case"<patternFill>":I.patternType&&(_.patternType=I.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":_.bgColor||(_.bgColor={}),I.indexed&&(_.bgColor.indexed=parseInt(I.indexed,10)),I.theme&&(_.bgColor.theme=parseInt(I.theme,10)),I.tint&&(_.bgColor.tint=parseFloat(I.tint)),I.rgb&&(_.bgColor.rgb=I.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":_.fgColor||(_.fgColor={}),I.theme&&(_.fgColor.theme=parseInt(I.theme,10)),I.tint&&(_.fgColor.tint=parseFloat(I.tint)),I.rgb!=null&&(_.fgColor.rgb=I.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":R=!0;break;case"</ext>":R=!1;break;default:if(T&&T.WTF&&!R)throw new Error("unrecognized "+I[0]+" in fills")}})})(h,j,u),(h=r.match(qh))&&(function(k,E,T){E.Borders=[];var _={},R=!1;(k[0].match(Jr)||[]).forEach(function(q){var I=os(q);switch(kn(I[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":_={},I.diagonalUp&&(_.diagonalUp=Ve(I.diagonalUp)),I.diagonalDown&&(_.diagonalDown=Ve(I.diagonalDown)),E.Borders.push(_);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":R=!0;break;case"</ext>":R=!1;break;default:if(T&&T.WTF&&!R)throw new Error("unrecognized "+I[0]+" in borders")}})})(h,j,u),(h=r.match(Wh))&&(h=h,b=u,y=!((g=j).CellXf=[]),(h[0].match(Jr)||[]).forEach(function(k){var E=os(k),T=0;switch(kn(E[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(x=E)[0],T=0;T<Nd.length;++T)x[Nd[T]]&&(x[Nd[T]]=parseInt(x[Nd[T]],10));for(T=0;T<gc.length;++T)x[gc[T]]&&(x[gc[T]]=Ve(x[gc[T]]));if(g.NumberFmt&&392<x.numFmtId){for(T=392;60<T;--T)if(g.NumberFmt[x.numFmtId]==g.NumberFmt[T]){x.numFmtId=T;break}}g.CellXf.push(x);break;case"</xf>":break;case"<alignment":case"<alignment/>":var _={};E.vertical&&(_.vertical=E.vertical),E.horizontal&&(_.horizontal=E.horizontal),E.textRotation!=null&&(_.textRotation=E.textRotation),E.indent&&(_.indent=E.indent),E.wrapText&&(_.wrapText=Ve(E.wrapText)),x.alignment=_;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":y=!0;break;case"</AlternateContent>":y=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":y=!0;break;case"</ext>":y=!1;break;default:if(b&&b.WTF&&!y)throw new Error("unrecognized "+E[0]+" in cellXfs")}}))),j});function Gh(r,d){if(kd!==void 0)return kd.toXml();var u,h,g,b,x=[jr,Bt("styleSheet",null,{xmlns:xl[0],"xmlns:vt":Wr.vt})];return r.SSF&&(h=r.SSF,g=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(y){for(var j=y[0];j<=y[1];++j)h[j]!=null&&(g[g.length]=Bt("numFmt",null,{numFmtId:j,formatCode:Ys(h[j])}))}),(u=g.length===1?"":(g[g.length]="</numFmts>",g[0]=Bt("numFmts",null,{count:g.length-2}).replace("/>",">"),g.join("")))!=null)&&(x[x.length]=u),x[x.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',x[x.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',x[x.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',x[x.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',d=d.cellXfs,(b=[])[b.length]="<cellXfs/>",d.forEach(function(y){b[b.length]=Bt("xf",null,y)}),b[b.length]="</cellXfs>",(u=b.length===2?"":(b[0]=Bt("cellXfs",null,{count:b.length-2}).replace("/>",">"),b.join("")))&&(x[x.length]=u),x[x.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',x[x.length]='<dxfs count="0"/>',x[x.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<x.length&&(x[x.length]="</styleSheet>",x[1]=x[1].replace("/>",">")),x.join("")}function $m(r,d){var u;(d=d||mt(153)).write_shift(2,20*r.sz),u=r,h=(h=d)||mt(2),u=(u.italic?2:0)|(u.strike?8:0)|(u.outline?16:0)|(u.shadow?32:0)|(u.condense?64:0)|(u.extend?128:0),h.write_shift(1,u),h.write_shift(1,0),d.write_shift(2,r.bold?700:400);var h=0;return r.vertAlign=="superscript"?h=1:r.vertAlign=="subscript"&&(h=2),d.write_shift(2,h),d.write_shift(1,r.underline||0),d.write_shift(1,r.family||0),d.write_shift(1,r.charset||0),d.write_shift(1,0),Ri(r.color,d),h=0,r.scheme=="major"&&(h=1),r.scheme=="minor"&&(h=2),d.write_shift(1,h),da(r.name,d),d.length>d.l?d.slice(0,d.l):d}var eu,qm=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ym=Fa;function Gm(r,d){d=d||mt(84),r=(eu=eu||ni(qm))[r.patternType],r==null&&(r=40),d.write_shift(4,r);var u=0;if(r!=40)for(Ri({auto:1},d),Ri({auto:1},d);u<12;++u)d.write_shift(4,0);else{for(;u<4;++u)d.write_shift(4,0);for(;u<12;++u)d.write_shift(4,0)}return d.length>d.l?d.slice(0,d.l):d}function Km(r,d,u){return(u=u||mt(16)).write_shift(2,d||0),u.write_shift(2,r.numFmtId||0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u}function pc(r,d){return(d=d||mt(10)).write_shift(1,0),d.write_shift(1,0),d.write_shift(4,0),d.write_shift(4,0),d}ii=Fa;function Cd(r,d){var u;d&&(u=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g=h[0];g<=h[1];++g)d[g]!=null&&++u}),u!=0&&(yt(r,615,ln(u)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g,b,x,y=h[0];y<=h[1];++y)d[y]!=null&&yt(r,44,(g=y,b=d[y],(x=(x=void 0)||mt(6+4*b.length)).write_shift(2,g),da(b,x),b=x.length>x.l?x.slice(0,x.l):x,x.l==null&&(x.l=x.length),b))}),yt(r,616)))}function Kh(r){var d;yt(r,613,ln(1)),yt(r,46,((d=d||mt(51)).write_shift(1,0),pc(0,d),pc(0,d),pc(0,d),pc(0,d),pc(0,d),d.length>d.l?d.slice(0,d.l):d)),yt(r,614)}function tu(r){var d,u;yt(r,619,ln(1)),yt(r,48,(d={xfId:0,builtinId:0,name:"Normal"},(u=u||mt(52)).write_shift(4,d.xfId),u.write_shift(2,1),u.write_shift(1,+d.builtinId),u.write_shift(1,0),rd(d.name||"",u),u.length>u.l?u.slice(0,u.l):u)),yt(r,620)}function Qm(r){var d,u,h,g;yt(r,508,(d=0,u="TableStyleMedium9",h="PivotStyleMedium4",(g=mt(2052)).write_shift(4,d),rd(u,g),rd(h,g),g.length>g.l?g.slice(0,g.l):g)),yt(r,509)}function Xm(r,d){var u,h=Ma();return yt(h,278),Cd(h,r.SSF),yt(r=h,611,ln(1)),yt(r,43,$m({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),yt(r,612),yt(r=h,603,ln(2)),yt(r,45,Gm({patternType:"none"})),yt(r,45,Gm({patternType:"gray125"})),yt(r,604),Kh(h),yt(r=h,626,ln(1)),yt(r,47,Km({numFmtId:0},65535)),yt(r,627),u=h,d=d.cellXfs,yt(u,617,ln(d.length)),d.forEach(function(g){yt(u,47,Km(g,0))}),yt(u,618),tu(h),yt(d=h,505,ln(0)),yt(d,506),Qm(h),yt(h,279),h.end()}var Sd=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Jm(r,d,u){d.themeElements.clrScheme=[];var h={};(r[0].match(Jr)||[]).forEach(function(g){var b=os(g);switch(b[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":h.rgb=b.val;break;case"<a:sysClr":h.rgb=b.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":b[0].charAt(1)==="/"?(d.themeElements.clrScheme[Sd.indexOf(b[0])]=h,h={}):h.name=b[0].slice(3,b[0].length-1);break;default:if(u&&u.WTF)throw new Error("Unrecognized "+b[0]+" in clrScheme")}})}function Qh(){}function Zm(){}var Xh=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Jh=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eg=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,tg=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function _l(r,d){var u,h,g,b,x,y={};if(!(u=(r=!r||r.length===0?su():r).match(tg)))throw new Error("themeElements not found in theme");return h=u[0],b=d,(g=y).themeElements={},[["clrScheme",Xh,Jm],["fontScheme",Jh,Qh],["fmtScheme",eg,Zm]].forEach(function(j){if(!(x=h.match(j[1])))throw new Error(j[0]+" not found in themeElements");j[2](x,g,b)}),y.raw=r,y}function su(r,d){return d&&d.themeXLSX?d.themeXLSX:r&&typeof r.raw=="string"?r.raw:(r=[jr],r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join(""))}function sg(r){var d={};switch(d.xclrType=r.read_shift(2),d.nTintShade=r.read_shift(2),d.xclrType){case 0:r.l+=4;break;case 1:d.xclrValue=Fa(r,4);break;case 2:d.xclrValue=F0(r);break;case 3:d.xclrValue=r.read_shift(4);break;case 4:r.l+=4}return r.l+=8,d}function rg(r){var d=r.read_shift(2),u=r.read_shift(2)-4,h=[d];switch(d){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:h[1]=sg(r);break;case 6:h[1]=Fa(r,u);break;case 14:case 15:h[1]=r.read_shift(u==1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+d+" "+u)}return h}function ru(){var r,d,u,h=Ma();return yt(h,332),yt(h,334,ln(1)),yt(h,335,((u=mt(12+2*(d={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,d.flags),u.write_shift(4,d.version),da(d.name,u),u.slice(0,u.l))),yt(h,336),yt(h,339,(r=1,(u=mt(8+2*(d="XLDAPR").length)).write_shift(4,r),da(d,u),u.slice(0,u.l))),yt(h,52),yt(h,35,ln(514)),yt(h,4096,ln(0)),yt(h,4097,fn(1)),yt(h,36),yt(h,53),yt(h,340),yt(h,337,(r=1,d=!0,(u=mt(8)).write_shift(4,r),u.write_shift(4,d?1:0),u)),yt(h,51,(function(g){var b=mt(4+8*g.length);b.write_shift(4,g.length);for(var x=0;x<g.length;++x)b.write_shift(4,g[x][0]),b.write_shift(4,g[x][1]);return b})([[1,0]])),yt(h,338),yt(h,333),h.end()}function Zh(){var r=[jr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}var Fl=1024;function ef(r,d){for(var u=[21600,21600],h=["m0,0l0",u[1],u[0],u[1],u[0],"0xe"].join(","),g=[Bt("xml",null,{"xmlns:v":Nr.v,"xmlns:o":Nr.o,"xmlns:x":Nr.x,"xmlns:mv":Nr.mv}).replace(/\/>/,">"),Bt("o:shapelayout",Bt("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Bt("v:shapetype",[Bt("v:stroke",null,{joinstyle:"miter"}),Bt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:u.join(","),path:h})];Fl<1e3*r;)Fl+=1e3;return d.forEach(function(b){var x=zr(b[0]),j={color2:"#BEFF82",type:"gradient"};j.type=="gradient"&&(j.angle="-180");var y=j.type=="gradient"?Bt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,j=Bt("v:fill",y,j);++Fl,g=g.concat(["<v:shape"+Ia({id:"_x0000_s"+Fl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(b[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",j,Bt("v:shadow",null,{on:"t",obscured:"t"}),Bt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Hs("x:Anchor",[x.c+1,0,x.r+1,0,x.c+3,20,x.r+5,20].join(",")),Hs("x:AutoFill","False"),Hs("x:Row",String(x.r)),Hs("x:Column",String(x.c)),b[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),g.push("</xml>"),g.join("")}function tf(r,d,u,h){var g,b=Array.isArray(r);d.forEach(function(x){var y,j=zr(x.ref);(g=b?(r[j.r]||(r[j.r]=[]),r[j.r][j.c]):r[x.ref])||(g={t:"z"},b?r[j.r][j.c]=g:r[x.ref]=g,(y=Fs(r["!ref"]||"BDWGO1000001:A1")).s.r>j.r&&(y.s.r=j.r),y.e.r<j.r&&(y.e.r=j.r),y.s.c>j.c&&(y.s.c=j.c),y.e.c<j.c&&(y.e.c=j.c),(y=Ss(y))!==r["!ref"]&&(r["!ref"]=y)),g.c||(g.c=[]);var k={a:x.author,t:x.t,r:x.r,T:u};x.h&&(k.h=x.h);for(var E=g.c.length-1;0<=E;--E){if(!u&&g.c[E].T)return;u&&!g.c[E].T&&g.c.splice(E,1)}if(u&&h){for(E=0;E<h.length;++E)if(k.a==h[E].id){k.a=h[E].name||k.a;break}}g.c.push(k)})}function ag(r){var d=[jr,Bt("comments",null,{xmlns:xl[0]})],u=[];return d.push("<authors>"),r.forEach(function(h){h[1].forEach(function(g){var b=Ys(g.a);u.indexOf(b)==-1&&(u.push(b),d.push("<author>"+b+"</author>")),g.T&&g.ID&&u.indexOf("tc="+g.ID)==-1&&(u.push("tc="+g.ID),d.push("<author>tc="+g.ID+"</author>"))})}),u.length==0&&(u.push("SheetJ5"),d.push("<author>SheetJ5</author>")),d.push("</authors>"),d.push("<commentList>"),r.forEach(function(h){var g=0,b=[];if(h[1][0]&&h[1][0].T&&h[1][0].ID?g=u.indexOf("tc="+h[1][0].ID):h[1].forEach(function(j){j.a&&(g=u.indexOf(Ys(j.a))),b.push(j.t||"")}),d.push('<comment ref="'+h[0]+'" authorId="'+g+'"><text>'),b.length<=1)d.push(Hs("t",Ys(b[0]||"")));else{for(var x=`Comment:
    `+b[0]+`
`,y=1;y<b.length;++y)x+=`Reply:
    `+b[y]+`
`;d.push(Hs("t",Ys(x)))}d.push("</text></comment>")}),d.push("</commentList>"),2<d.length&&(d[d.length]="</comments>",d[1]=d[1].replace("/>",">")),d.join("")}Gl=pa;function sf(r){var d=Ma(),u=[];return yt(d,628),yt(d,630),r.forEach(function(h){h[1].forEach(function(g){-1<u.indexOf(g.a)||(u.push(g.a.slice(0,54)),yt(d,632,da(g.a.slice(0,54))))})}),yt(d,631),yt(d,633),r.forEach(function(h){h[1].forEach(function(g){g.iauthor=u.indexOf(g.a);var b,x={s:zr(h[0]),e:zr(h[0])};yt(d,635,(x=[x,g],(b=b??mt(36)).write_shift(4,x[1].iauthor),vl(x[0],b),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b)),g.t&&0<g.t.length&&yt(d,637,$p(g)),yt(d,636),delete g.iauthor})}),yt(d,634),yt(d,629),d.end()}var ia="application/vnd.ms-office.vbaProject",ba=["xlsb","xlsm","xlam","biff8","xla"],au,rf,xo=(rf=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,function(r,d){return au=d,r.replace(rf,ng)});function ng(r,d,u,h){var g=!1,b=!1;return u.length==0?b=!0:u.charAt(0)=="["&&(b=!0,u=u.slice(1,-1)),h.length==0?g=!0:h.charAt(0)=="["&&(g=!0,h=h.slice(1,-1)),u=0<u.length?0|parseInt(u,10):0,h=0<h.length?0|parseInt(h,10):0,g?h+=au.c:--h,b?u+=au.r:--u,d+(g?"":"$")+Er(h)+(b?"":"$")+Br(u)}var bo=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nu=function(r,d){return r.replace(bo,function(u,h,g,b,x,y){return b=yl(b)-(g?0:d.c),y=b0(y)-(x?0:d.r),h+"R"+(y==0?"":x?1+y:"["+y+"]")+"C"+(b==0?"":g?1+b:"["+b+"]")})};function Ad(r,d){return r.replace(bo,function(u,h,g,b,x,y){return h+(g=="$"?g+b:Er(yl(b)+d.c))+(x=="$"?x+y:Br(b0(y)+d.r))})}function af(r){return r.replace(/_xlfn\./g,"")}function la(r){r.l+=1}function Jn(r,d){return d=r.read_shift(d==1?1:2),[16383&d,d>>14&1,d>>15&1]}function iu(x,d,g){var b=2;if(g){if(2<=g.biff&&g.biff<=5)return nf(x);g.biff==12&&(b=4)}var h=x.read_shift(b),g=x.read_shift(b),b=Jn(x,2),x=Jn(x,2);return{s:{r:h,c:b[0],cRel:b[1],rRel:b[2]},e:{r:g,c:x[0],cRel:x[1],rRel:x[2]}}}function nf(g){var d=Jn(g,2),u=Jn(g,2),h=g.read_shift(1),g=g.read_shift(1);return{s:{r:d[0],c:h,cRel:d[1],rRel:d[2]},e:{r:u[0],c:g,cRel:u[1],rRel:u[2]}}}function lf(x,d,b){if(b&&2<=b.biff&&b.biff<=5)return g=Jn(h=x,2),h=h.read_shift(1),{r:g[0],c:h,cRel:g[1],rRel:g[2]};var h,g,b=x.read_shift(b&&b.biff==12?4:2),x=Jn(x,2);return{r:b,c:x[0],cRel:x[1],rRel:x[2]}}function ig(x,d,b){if(b=b&&b.biff?b.biff:8,2<=b&&b<=5)return(function(T){var j=T.read_shift(2),k=T.read_shift(1),E=(32768&j)>>15,T=(16384&j)>>14;return j&=16383,E==1&&8192<=j&&(j-=16384),T==1&&128<=k&&(k-=256),{r:j,c:k,cRel:T,rRel:E}})(x);var h=x.read_shift(12<=b?4:2),g=x.read_shift(2),b=(16384&g)>>14,x=(32768&g)>>15;if(g&=16383,x==1)for(;524287<h;)h-=1048576;if(b==1)for(;8191<g;)g-=16384;return{r:h,c:g,cRel:b,rRel:x}}function lu(r){var d=1&r[r.l+1];return r.l+=4,[d,1]}function ou(r){return[r.read_shift(1),r.read_shift(1)]}function of(r,d,u){var h=0,g=0;u.biff==12?(h=r.read_shift(4),g=r.read_shift(4)):(g=1+r.read_shift(1),h=1+r.read_shift(2)),2<=u.biff&&u.biff<8&&(--h,--g==0&&(g=256));for(var b=0,x=[];b!=h&&(x[b]=[]);++b)for(var y=0;y!=g;++y)x[b][y]=(function(j,k){var E=[j.read_shift(1)];if(k==12)switch(E[0]){case 2:E[0]=4;break;case 4:E[0]=16;break;case 0:E[0]=1;break;case 1:E[0]=2}switch(E[0]){case 4:E[1]=Zs(j,1)?"TRUE":"FALSE",k!=12&&(j.l+=7);break;case 37:case 16:E[1]=$n[j[j.l]],j.l+=k==12?4:8;break;case 0:j.l+=8;break;case 1:E[1]=ka(j);break;case 2:E[1]=Bi(j,0,{biff:0<k&&k<8?2:k});break;default:throw new Error("Bad SerAr: "+E[0])}return E})(r,u.biff);return x}function xc(r,d,u){return r.l+=2,[(r=(h=r).read_shift(2),h=h.read_shift(2),{r,c:255&h,fQuoted:!!(16384&h),cRel:h>>15,rRel:h>>15})];var h}function Ed(r){return r.l+=6,[]}function Dd(r){return r.l+=2,[xr(r),1&r.read_shift(2)]}var cf=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],df={1:{n:"PtgExp",f:function(r,d,u){return r.l++,u&&u.biff==12?[r.read_shift(4,"i"),0]:[r.read_shift(2),r.read_shift(u&&u.biff==2?1:2)]}},2:{n:"PtgTbl",f:Fa},3:{n:"PtgAdd",f:la},4:{n:"PtgSub",f:la},5:{n:"PtgMul",f:la},6:{n:"PtgDiv",f:la},7:{n:"PtgPower",f:la},8:{n:"PtgConcat",f:la},9:{n:"PtgLt",f:la},10:{n:"PtgLe",f:la},11:{n:"PtgEq",f:la},12:{n:"PtgGe",f:la},13:{n:"PtgGt",f:la},14:{n:"PtgNe",f:la},15:{n:"PtgIsect",f:la},16:{n:"PtgUnion",f:la},17:{n:"PtgRange",f:la},18:{n:"PtgUplus",f:la},19:{n:"PtgUminus",f:la},20:{n:"PtgPercent",f:la},21:{n:"PtgParen",f:la},22:{n:"PtgMissArg",f:la},23:{n:"PtgStr",f:function(r,d,u){return r.l++,Yn(r,0,u)}},26:{n:"PtgSheet",f:function(r,d,u){return r.l+=5,r.l+=2,r.l+=u.biff==2?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(r,d,u){return r.l+=u.biff==2?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(r){return r.l++,$n[r.read_shift(1)]}},29:{n:"PtgBool",f:function(r){return r.l++,r.read_shift(1)!==0}},30:{n:"PtgInt",f:function(r){return r.l++,r.read_shift(2)}},31:{n:"PtgNum",f:function(r){return r.l++,ka(r)}},32:{n:"PtgArray",f:function(r,d,u){var h=(96&r[r.l++])>>5;return r.l+=u.biff==2?6:u.biff==12?14:7,[h]}},33:{n:"PtgFunc",f:function(r,d,u){var h=(96&r[r.l])>>5;return r.l+=1,u=r.read_shift(u&&u.biff<=3?1:2),[dg[u],hf[u],h]}},34:{n:"PtgFuncVar",f:function(r,d,u){var h=r[r.l++],g=r.read_shift(1),b=u&&u.biff<=3?[h==88?-1:0,r.read_shift(1)]:[(b=r)[b.l+1]>>7,32767&b.read_shift(2)];return[g,(b[0]===0?hf:Ml)[b[1]]]}},35:{n:"PtgName",f:function(r,d,u){var h=r.read_shift(1)>>>5&3,g=!u||8<=u.biff?4:2,g=r.read_shift(g);switch(u.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12}return[h,0,g]}},36:{n:"PtgRef",f:function(r,d,u){var h=(96&r[r.l])>>5;return r.l+=1,[h,lf(r,0,u)]}},37:{n:"PtgArea",f:function(r,d,u){return[(96&r[r.l++])>>5,iu(r,2<=u.biff&&u.biff,u)]}},38:{n:"PtgMemArea",f:function(r,d,u){var h=r.read_shift(1)>>>5&3;return r.l+=u&&u.biff==2?3:4,[h,r.read_shift(u&&u.biff==2?1:2)]}},39:{n:"PtgMemErr",f:Fa},40:{n:"PtgMemNoMem",f:Fa},41:{n:"PtgMemFunc",f:function(r,d,u){return[r.read_shift(1)>>>5&3,r.read_shift(u&&u.biff==2?1:2)]}},42:{n:"PtgRefErr",f:function(r,d,u){var h=r.read_shift(1)>>>5&3;return r.l+=4,u.biff<8&&r.l--,u.biff==12&&(r.l+=2),[h]}},43:{n:"PtgAreaErr",f:function(r,d,u){var h=(96&r[r.l++])>>5;return r.l+=u&&8<u.biff?12:u.biff<8?6:8,[h]}},44:{n:"PtgRefN",f:function(r,d,u){var h=(96&r[r.l])>>5;return r.l+=1,[h,ig(r,0,u)]}},45:{n:"PtgAreaN",f:function(r,d,u){return[(96&r[r.l++])>>5,(function(j,y){if(y.biff<8)return nf(j);var b=j.read_shift(y.biff==12?4:2),x=j.read_shift(y.biff==12?4:2),y=Jn(j,2),j=Jn(j,2);return{s:{r:b,c:y[0],cRel:y[1],rRel:y[2]},e:{r:x,c:j[0],cRel:j[1],rRel:j[2]}}})(r,u)]}},46:{n:"PtgMemAreaN",f:function(r){return[r.read_shift(1)>>>5&3,r.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(r){return[r.read_shift(1)>>>5&3,r.read_shift(2)]}},57:{n:"PtgNameX",f:function(r,d,u){return u.biff==5?(function(h){var g=h.read_shift(1)>>>5&3,b=h.read_shift(2,"i");h.l+=8;var x=h.read_shift(2);return h.l+=12,[g,b,x]})(r):[r.read_shift(1)>>>5&3,r.read_shift(2),r.read_shift(4)]}},58:{n:"PtgRef3d",f:function(r,d,u){var h=(96&r[r.l])>>5;r.l+=1;var g=r.read_shift(2);return u&&u.biff==5&&(r.l+=12),[h,g,lf(r,0,u)]}},59:{n:"PtgArea3d",f:function(r,d,u){var h=(96&r[r.l++])>>5,g=r.read_shift(2,"i");return u&&u.biff===5&&(r.l+=12),[h,g,iu(r,0,u)]}},60:{n:"PtgRefErr3d",f:function(r,d,u){var h=(96&r[r.l++])>>5,g=r.read_shift(2),b=4;if(u)switch(u.biff){case 5:b=15;break;case 12:b=6}return r.l+=b,[h,g]}},61:{n:"PtgAreaErr3d",f:function(r,d,u){var h=(96&r[r.l++])>>5,g=r.read_shift(2),b=8;if(u)switch(u.biff){case 5:r.l+=12,b=6;break;case 12:b=12}return r.l+=b,[h,g]}},255:{}},uf={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lg={1:{n:"PtgElfLel",f:Dd},2:{n:"PtgElfRw",f:xc},3:{n:"PtgElfCol",f:xc},6:{n:"PtgElfRwV",f:xc},7:{n:"PtgElfColV",f:xc},10:{n:"PtgElfRadical",f:xc},11:{n:"PtgElfRadicalS",f:Ed},13:{n:"PtgElfColS",f:Ed},15:{n:"PtgElfColSV",f:Ed},16:{n:"PtgElfRadicalLel",f:Dd},25:{n:"PtgList",f:function(b){b.l+=2;var d=b.read_shift(2),u=b.read_shift(2),h=b.read_shift(4),g=b.read_shift(2),b=b.read_shift(2);return{ixti:d,coltype:3&u,rt:cf[u>>2&31],idx:h,c:g,C:b}}},29:{n:"PtgSxName",f:function(r){return r.l+=2,[r.read_shift(4)]}},255:{}},Yi={0:{n:"PtgAttrNoop",f:function(r){return r.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(r,d,u){var h=255&r[r.l+1]?1:0;return r.l+=u&&u.biff==2?3:4,[h]}},2:{n:"PtgAttrIf",f:function(r,d,u){var h=255&r[r.l+1]?1:0;return r.l+=2,[h,r.read_shift(u&&u.biff==2?1:2)]}},4:{n:"PtgAttrChoose",f:function(r,d,u){r.l+=2;for(var h=r.read_shift(u&&u.biff==2?1:2),g=[],b=0;b<=h;++b)g.push(r.read_shift(u&&u.biff==2?1:2));return g}},8:{n:"PtgAttrGoto",f:function(r,d,u){var h=255&r[r.l+1]?1:0;return r.l+=2,[h,r.read_shift(u&&u.biff==2?1:2)]}},16:{n:"PtgAttrSum",f:function(r,d,u){r.l+=u&&u.biff==2?3:4}},32:{n:"PtgAttrBaxcel",f:lu},33:{n:"PtgAttrBaxcel",f:lu},64:{n:"PtgAttrSpace",f:function(r){return r.read_shift(2),ou(r)}},65:{n:"PtgAttrSpaceSemi",f:function(r){return r.read_shift(2),ou(r)}},128:{n:"PtgAttrIfError",f:function(r){var d=255&r[r.l+1]?1:0;return r.l+=2,[d,r.read_shift(2)]}},255:{}};function yo(r,d,u,h){if(h.biff<8)return Fa(r,d);for(var g=r.l+d,b=[],x=0;x!==u.length;++x)switch(u[x][0]){case"PtgArray":u[x][1]=of(r,0,h),b.push(u[x][1]);break;case"PtgMemArea":u[x][2]=(function(y,j){for(var k=y.read_shift(j.biff==12?4:2),E=[],T=0;T!=k;++T)E.push((j.biff==12?Wn:aa)(y));return E})(r,(u[x][1],h)),b.push(u[x][2]);break;case"PtgExp":h&&h.biff==12&&(u[x][1][1]=r.read_shift(4),b.push(u[x][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+u[x][0]}return(d=g-r.l)!==0&&b.push(Fa(r,d)),b}function Td(r,d,u){for(var h,g,b=r.l+d,x=[];b!=r.l;)d=b-r.l,g=r[r.l],h=df[g]||df[uf[g]],(h=g===24||g===25?(g===24?lg:Yi)[r[r.l+1]]:h)&&h.f?x.push([h.n,h.f(r,d,u)]):Fa(r,d);return x}var og={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function pi(r,d,u){if(!r)return"SH33TJSERR0";if(8<u.biff&&(!r.XTI||!r.XTI[d]))return r.SheetNames[d];if(!r.XTI)return"SH33TJSERR6";var h=r.XTI[d];if(u.biff<8)return 1e4<d&&(d-=65536),(d=d<0?-d:d)==0?"":r.XTI[d-1];if(!h)return"SH33TJSERR1";var g="";if(8<u.biff)switch(r[h[0]][0]){case 357:return g=h[1]==-1?"#REF":r.SheetNames[h[1]],h[1]==h[2]?g:g+":"+r.SheetNames[h[2]];case 358:return u.SID!=null?r.SheetNames[u.SID]:"SH33TJSSAME"+r[h[0]][0];default:return"SH33TJSSRC"+r[h[0]][0]}switch(r[h[0]][0][0]){case 1025:return g=h[1]==-1?"#REF":r.SheetNames[h[1]]||"SH33TJSERR3",h[1]==h[2]?g:g+":"+r.SheetNames[h[2]];case 14849:return r[h[0]].slice(1).map(function(b){return b.Name}).join(";;");default:return r[h[0]][0][3]?(g=h[1]==-1?"#REF":r[h[0]][0][3][h[1]]||"SH33TJSERR4",h[1]==h[2]?g:g+":"+r[h[0]][0][3][h[2]]):"SH33TJSERR2"}}function cu(r,d,u){return d=pi(r,d,u),d=="#REF"?d:(function(h,g){if(!(h||g&&g.biff<=5&&2<=g.biff))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(h)?"'"+h+"'":h})(d,u)}function Oa(r,d,u,h,g){var b,x,y,j=g&&g.biff||8,k={s:{c:0,r:0}},E=[],T=0,_=0,R="";if(!r[0]||!r[0][0])return"";for(var q=-1,I="",J=0,Y=r[0].length;J<Y;++J){var z=r[0][J];switch(z[0]){case"PtgUminus":E.push("-"+E.pop());break;case"PtgUplus":E.push("+"+E.pop());break;case"PtgPercent":E.push(E.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(Wt=E.pop(),b=E.pop(),0<=q){switch(r[0][q][1][0]){case 0:I=ar(" ",r[0][q][1][1]);break;case 1:I=ar("\r",r[0][q][1][1]);break;default:if(I="",g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][q][1][0])}b+=I,q=-1}E.push(b+og[z[0]]+Wt);break;case"PtgIsect":Wt=E.pop(),b=E.pop(),E.push(b+" "+Wt);break;case"PtgUnion":Wt=E.pop(),b=E.pop(),E.push(b+","+Wt);break;case"PtgRange":Wt=E.pop(),b=E.pop(),E.push(b+":"+Wt);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":x=td(z[1][1],k,g),E.push(Jo(x,j));break;case"PtgRefN":x=u?td(z[1][1],u,g):z[1][1],E.push(Jo(x,j));break;case"PtgRef3d":T=z[1][1],x=td(z[1][2],k,g),R=cu(h,T,g),E.push(R+"!"+Jo(x,j));break;case"PtgFunc":case"PtgFuncVar":var ie=z[1][0],X=z[1][1],ie=ie||0,le=(ie&=127)==0?[]:E.slice(-ie);E.length-=ie,X==="User"&&(X=le.shift()),E.push(X+"("+le.join(",")+")");break;case"PtgBool":E.push(z[1]?"TRUE":"FALSE");break;case"PtgInt":E.push(z[1]);break;case"PtgNum":E.push(String(z[1]));break;case"PtgStr":E.push('"'+z[1].replace(/"/g,'""')+'"');break;case"PtgErr":E.push(z[1]);break;case"PtgAreaN":y=hh(z[1][1],u?{s:u}:k,g),E.push(x0(y,g));break;case"PtgArea":y=hh(z[1][1],k,g),E.push(x0(y,g));break;case"PtgArea3d":T=z[1][1],y=z[1][2],R=cu(h,T,g),E.push(R+"!"+x0(y,g));break;case"PtgAttrSum":E.push("SUM("+E.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=z[1][2];var Ee=(h.names||[])[_-1]||(h[0]||[])[_],He=Ee?Ee.Name:"SH33TJSNAME"+String(_);He&&He.slice(0,6)=="_xlfn."&&!g.xlfn&&(He=He.slice(6)),E.push(He);break;case"PtgNameX":var Pe,Qe=z[1][1],_=z[1][2];if(!(g.biff<=5)){Ee="",((h[Qe]||[])[0]||[])[0]==14849||(((h[Qe]||[])[0]||[])[0]==1025?h[Qe][_]&&0<h[Qe][_].itab&&(Ee=h.SheetNames[h[Qe][_].itab-1]+"!"):Ee=h.SheetNames[_-1]+"!"),h[Qe]&&h[Qe][_]?Ee+=h[Qe][_].Name:h[0]&&h[0][_]?Ee+=h[0][_].Name:(He=(pi(h,Qe,g)||"").split(";;"))[_-1]?Ee=He[_-1]:Ee+="SH33TJSERRX",E.push(Ee);break}Pe=(Pe=h[Qe=Qe<0?-Qe:Qe]?h[Qe][_]:Pe)||{Name:"SH33TJSERRY"},E.push(Pe.Name);break;case"PtgParen":var pt="(",xt=")";if(0<=q){switch(I="",r[0][q][1][0]){case 2:pt=ar(" ",r[0][q][1][1])+pt;break;case 3:pt=ar("\r",r[0][q][1][1])+pt;break;case 4:xt=ar(" ",r[0][q][1][1])+xt;break;case 5:xt=ar("\r",r[0][q][1][1])+xt;break;default:if(g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][q][1][0])}q=-1}E.push(pt+E.pop()+xt);break;case"PtgRefErr":case"PtgRefErr3d":E.push("#REF!");break;case"PtgExp":x={c:z[1][1],r:z[1][0]};var at={c:u.c,r:u.r};if(h.sharedf[bs(x)])Qe=h.sharedf[bs(x)],E.push(Oa(Qe,0,at,h,g));else{for(var kt=!1,Wt=0;Wt!=h.arrayf.length;++Wt)if(b=h.arrayf[Wt],!(x.c<b[0].s.c||x.c>b[0].e.c||x.r<b[0].s.r||x.r>b[0].e.r)){E.push(Oa(b[1],0,at,h,g)),kt=!0;break}kt||E.push(z[1])}break;case"PtgArray":E.push("{"+(function(Ot){for(var _t=[],wt=0;wt<Ot.length;++wt){for(var Yt=Ot[wt],Jt=[],is=0;is<Yt.length;++is){var Ds=Yt[is];Ds?Ds[0]===2?Jt.push('"'+Ds[1].replace(/"/g,'""')+'"'):Jt.push(Ds[1]):Jt.push("")}_t.push(Jt.join(","))}return _t.join(";")})(z[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":q=J;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":E.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":E.push("#REF!");break;case"PtgList":E.push("Table"+z[1].idx+"[#"+z[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(z))}if(g.biff!=3&&0<=q&&["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(r[0][J][0])==-1){var Ht=!0;switch((z=r[0][q])[1][0]){case 4:Ht=!1;case 0:I=ar(" ",z[1][1]);break;case 5:Ht=!1;case 1:I=ar("\r",z[1][1]);break;default:if(I="",g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+z[1][0])}E.push((Ht?I:"")+E.pop()+(Ht?"":I)),q=-1}}if(1<E.length&&g.WTF)throw new Error("bad formula stack");return E[0]}function bc(r,x,u){var h=r.l+x,g=Ua(r);u.biff==2&&++r.l;var b=(function(y){var j;if(Mi(y,y.l+6)!==65535)return[ka(y),"n"];switch(y[y.l]){case 0:return y.l+=8,["String","s"];case 1:return j=y[y.l+2]===1,y.l+=8,[j,"b"];case 2:return j=y[y.l+2],y.l+=8,[j,"e"];case 3:return y.l+=8,["","s"]}return[]})(r),x=r.read_shift(1);return u.biff!=2&&(r.read_shift(1),5<=u.biff&&r.read_shift(4)),u=(function(y,j,k){var E,T=y.l+j,_=k.biff==2?1:2,R=y.read_shift(_);if(R==65535)return[[],Fa(y,j-2)];var q=Td(y,R,k);return j!==R+_&&(E=yo(y,j-R-_,q,k)),y.l=T,[q,E]})(r,h-r.l,u),{cell:g,val:b[0],formula:u,shared:x>>3&1,tt:b[1]}}function _d(r,d,u,h,g){d=mi(d,u,g),g=(u=r.v)!=null?Sn(typeof u=="number"?u:0):((u=mt(8)).write_shift(1,3),u.write_shift(1,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,65535),u),u=mt(6),u.write_shift(2,33),u.write_shift(4,0);for(var b=mt(r.bf.length),x=0;x<r.bf.length;++x)b[x]=r.bf[x];return he([d,g,u,b])}function fr(r,d,u){var g=r.read_shift(4),h=Td(r,g,u),g=r.read_shift(4);return[h,0<g?yo(r,g,h,u):null]}var Kp=fr,du=fr,cg=fr,Fd=fr,Ml={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},hf={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dg={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function yc(r){return(r=(r=(r=(r=(r=r.slice(0,3)=="of:"?r.slice(3):r).charCodeAt(0)==61&&(r=r.slice(1)).charCodeAt(0)==61?r.slice(1):r).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(d,u){return u.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Tn(r){return r=r.split(":"),[r[0].split(".")[0],r[0].split(".")[1]+(1<r.length?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var vc={},Ll={},wc=typeof Map<"u";function Md(r,d,u){var h=0,g=r.length;if(u){if(wc?u.has(d):Object.prototype.hasOwnProperty.call(u,d)){for(var b=wc?u.get(d):u[d];h<b.length;++h)if(r[b[h]].t===d)return r.Count++,b[h]}}else for(;h<g;++h)if(r[h].t===d)return r.Count++,h;return r[g]={t:d},r.Count++,r.Unique++,u&&(wc?(u.has(d)||u.set(d,[]),u.get(d).push(g)):(Object.prototype.hasOwnProperty.call(u,d)||(u[d]=[]),u[d].push(g))),g}function jc(h,d){var u={min:h+1,max:h+1},h=-1;return d.MDW&&(ea=d.MDW),d.width!=null?u.customWidth=1:d.wpx!=null?h=Dl(d.wpx):d.wch!=null&&(h=d.wch),-1<h?(u.width=go(h),u.customWidth=1):d.width!=null&&(u.width=d.width),d.hidden&&(u.hidden=!0),d.level!=null&&(u.outlineLevel=u.level=d.level),u}function xi(r,d){r&&(d=d=="xlml"?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],r.left==null&&(r.left=d[0]),r.right==null&&(r.right=d[1]),r.top==null&&(r.top=d[2]),r.bottom==null&&(r.bottom=d[3]),r.header==null&&(r.header=d[4]),r.footer==null&&(r.footer=d[5]))}function Gi(r,d,u){if(kd!==void 0){if(/^\d+$/.exec(d.s)||d.s&&d.s==+d.s)return d.s;var h=d.s||{};return d.z&&(h.numFmt=d.z),kd.addStyle(h)}var g=u.revssf[d.z!=null?d.z:"General"],b=60,x=r.length;if(g==null&&u.ssf){for(;b<392;++b)if(u.ssf[b]==null){Or(d.z,b),u.ssf[b]=d.z,u.revssf[d.z]=g=b;break}}for(b=0;b!=x;++b)if(r[b].numFmtId===g)return b;return r[x]={numFmtId:g,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},x}function bi(r,d,u,h,g,b){try{h.cellNF&&(r.z=V[d])}catch(y){if(h.WTF)throw y}if(r.t!=="z"||h.cellStyles){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Cs(r.v)),(!h||h.cellText!==!1)&&r.t!=="z")try{if(V[d]==null&&Or(ol[d]||"General",d),r.t==="e")r.w=r.w||$n[r.v];else if(d===0)if(r.t==="n")(0|r.v)===r.v?r.w=r.v.toString(10):r.w=vt(r.v);else if(r.t==="d"){var x=Sr(r.v);r.w=(0|x)===x?x.toString(10):vt(x)}else{if(r.v===void 0)return;r.w=ze(r.v,Ll)}else r.t==="d"?r.w=Kr(d,Sr(r.v),Ll):r.w=Kr(d,r.v,Ll)}catch(y){if(h.WTF)throw y}if(h.cellStyles&&u!=null)try{r.s=b.Fills[u],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=wd(g.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),h.WTF&&(r.s.fgColor.raw_rgb=g.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=wd(g.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),h.WTF&&(r.s.bgColor.raw_rgb=g.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(y){if(h.WTF&&b.Fills)throw y}}}var oa=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,ff=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,ug=/<(?:\w:)?hyperlink [^>]*>/gm,ya=/"(\w*:\w*)"/,Qp=/<(?:\w:)?col\b[^>]*[\/]?>/g,hg=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,fg=/<(?:\w:)?pageMargins[^>]*\/>/g,Dr=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Qa=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Ki=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function mg(r,d,u,h,g,b,x){if(!r)return r;h=h||{"!id":{}};var y=d.dense?[]:{},j={s:{r:2e6,c:2e6},e:{r:0,c:0}},k="",He="",E=r.match(ff);E?(k=r.slice(0,E.index),He=r.slice(E.index+E[0].length)):k=He=r;var T=k.match(Dr);T?uu(T[0],0,g,u):(T=k.match(Qa))&&(r=T[0],T[1],T=y,_=g,R=u,uu(r.slice(0,r.indexOf(">")),0,_,R));var _,R,q=(k.match(/<(?:\w*:)?dimension/)||{index:-1}).index;0<q&&(_=k.slice(q,q+50).match(ya))&&(R=y,(J=Fs(J=_[1])).s.r<=J.e.r&&J.s.c<=J.e.c&&0<=J.s.r&&0<=J.s.c&&(R["!ref"]=Ss(J)));var I,J=k.match(Ki);J&&J[1]&&(z=J[1],(I=g).Views||(I.Views=[{}]),(z.match(hu)||[]).forEach(function(Pe,Qe){Pe=os(Pe),I.Views[Qe]||(I.Views[Qe]={}),+Pe.zoomScale&&(I.Views[Qe].zoom=+Pe.zoomScale),Ve(Pe.rightToLeft)&&(I.Views[Qe].RTL=!0)}));var Y,z=[];d.cellStyles&&(Y=k.match(Qp))&&(function(Pe,Qe){for(var pt=!1,xt=0;xt!=Qe.length;++xt){var at=os(Qe[xt],!0);at.hidden&&(at.hidden=Ve(at.hidden));var kt=parseInt(at.min,10)-1,Wt=parseInt(at.max,10)-1;for(at.outlineLevel&&(at.level=+at.outlineLevel||0),delete at.min,delete at.max,at.width=+at.width,!pt&&at.width&&(pt=!0,jd(at.width)),Tl(at);kt<=Wt;)Pe[kt++]=sr(at)}})(z,Y),E&&Qi(E[1],y,d,j,b,x),x=He.match(hg),x&&(y["!autofilter"]={ref:(x[0].match(/ref="([^"]*)"/)||[])[1]});var X=[],ie=He.match(oa);if(ie)for(q=0;q!=ie.length;++q)X[q]=Fs(ie[q].slice(ie[q].indexOf('"')+1));x=He.match(ug),x&&(function(Pe,Qe,pt){for(var xt=Array.isArray(Pe),at=0;at!=Qe.length;++at){var kt=os(Fe(Qe[at]),!0);if(!kt.ref)return;var Wt=((pt||{})["!id"]||[])[kt.id];Wt?(kt.Target=Wt.Target,kt.location&&(kt.Target+="#"+ys(kt.location))):(kt.Target="#"+ys(kt.location),Wt={Target:kt.Target,TargetMode:"Internal"}),kt.Rel=Wt,kt.tooltip&&(kt.Tooltip=kt.tooltip,delete kt.tooltip);for(var Ht=Fs(kt.ref),Mt=Ht.s.r;Mt<=Ht.e.r;++Mt)for(var Ot=Ht.s.c;Ot<=Ht.e.c;++Ot){var _t=bs({c:Ot,r:Mt});xt?(Pe[Mt]||(Pe[Mt]=[]),Pe[Mt][Ot]||(Pe[Mt][Ot]={t:"z",v:void 0}),Pe[Mt][Ot].l=kt):(Pe[_t]||(Pe[_t]={t:"z",v:void 0}),Pe[_t].l=kt)}}})(y,x,h);var le,Ee,He=He.match(fg);return He&&(y["!margins"]=(le=os(He[0]),Ee={},["left","right","top","bottom","header","footer"].forEach(function(Pe){le[Pe]&&(Ee[Pe]=parseFloat(le[Pe]))}),Ee)),!y["!ref"]&&j.e.c>=j.s.c&&j.e.r>=j.s.r&&(y["!ref"]=Ss(j)),0<d.sheetRows&&y["!ref"]&&(He=Fs(y["!ref"]),d.sheetRows<=+He.e.r&&(He.e.r=d.sheetRows-1,He.e.r>j.e.r&&(He.e.r=j.e.r),He.e.r<He.s.r&&(He.s.r=He.e.r),He.e.c>j.e.c&&(He.e.c=j.e.c),He.e.c<He.s.c&&(He.s.c=He.e.c),y["!fullref"]=y["!ref"],y["!ref"]=Ss(He))),0<z.length&&(y["!cols"]=z),0<X.length&&(y["!merges"]=X),y}function uu(r,d,u,h){r=os(r),u.Sheets[h]||(u.Sheets[h]={}),r.codeName&&(u.Sheets[h].CodeName=ys(Fe(r.codeName)))}var gg=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Xp=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],hu=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,Va,_n,mf,Wa,gf,yi,Rl,Qi=(Va=/<(?:\w+:)?c[ \/>]/,_n=/<\/(?:\w+:)?row>/,mf=/r=["']([^"']*)["']/,Wa=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,gf=/ref=["']([^"']*)["']/,yi=Rt("v"),Rl=Rt("f"),function(r,d,u,h,g,b){for(var x,y,j,k,E,T,_=0,R="",q=[],I=[],J=0,Y=0,z="",X=0,ie=0,le=0,Ee=0,He=Array.isArray(b.CellXf),Pe=[],Qe=[],pt=Array.isArray(d),xt=[],at={},kt=!1,Wt=!!u.sheetStubs,Ht=r.split(_n),Mt=0,Ot=Ht.length;Mt!=Ot;++Mt){var _t=(R=Ht[Mt].trim()).length;if(_t!==0){var wt=0;e:for(_=0;_<_t;++_)switch(R[_]){case">":if(R[_-1]!="/"){++_;break e}if(u&&u.cellStyles){if(X=(j=os(R.slice(wt,_),!0)).r!=null?parseInt(j.r,10):X+1,ie=-1,u.sheetRows&&u.sheetRows<X)continue;kt=!(at={}),j.ht&&(kt=!0,at.hpt=parseFloat(j.ht),at.hpx=po(at.hpt)),j.hidden=="1"&&(kt=!0,at.hidden=!0),j.outlineLevel!=null&&(kt=!0,at.level=+j.outlineLevel),kt&&(xt[X-1]=at)}break;case"<":wt=_}if(_<=wt)break;if(X=(j=os(R.slice(wt,_),!0)).r!=null?parseInt(j.r,10):X+1,ie=-1,!(u.sheetRows&&u.sheetRows<X)){h.s.r>X-1&&(h.s.r=X-1),h.e.r<X-1&&(h.e.r=X-1),u&&u.cellStyles&&(kt=!(at={}),j.ht&&(kt=!0,at.hpt=parseFloat(j.ht),at.hpx=po(at.hpt)),j.hidden=="1"&&(kt=!0,at.hidden=!0),j.outlineLevel!=null&&(kt=!0,at.level=+j.outlineLevel),kt&&(xt[X-1]=at)),q=R.slice(_).split(Va);for(var Yt,Jt=0;Jt!=q.length&&q[Jt].trim().charAt(0)=="<";++Jt);for(q=q.slice(Jt),_=0;_!=q.length;++_)if((R=q[_].trim()).length!==0){if(I=R.match(mf),J=_,Y=0,R="<c "+(R.slice(0,1)=="<"?">":"")+R,I!=null&&I.length===2){for(J=0,z=I[1],Y=0;Y!=z.length&&!((x=z.charCodeAt(Y)-64)<1||26<x);++Y)J=26*J+x;ie=--J}else++ie;for(Y=0;Y!=R.length&&R.charCodeAt(Y)!==62;++Y);if(++Y,(j=os(R.slice(0,Y),!0)).r||(j.r=bs({r:X-1,c:ie})),y={t:""},(I=(z=R.slice(Y)).match(yi))!=null&&I[1]!==""&&(y.v=ys(I[1])),u.cellFormula){(I=z.match(Rl))!=null&&I[1]!==""?(y.f=ys(Fe(I[1])).replace(/\r\n/g,`
`),u.xlfn||(y.f=af(y.f)),-1<I[0].indexOf('t="array"')?(y.F=(z.match(gf)||[])[1],-1<y.F.indexOf(":")&&Pe.push([Fs(y.F),y.F])):-1<I[0].indexOf('t="shared"')&&(E=os(I[0]),Yt=ys(Fe(I[1])),u.xlfn||(Yt=af(Yt)),Qe[parseInt(E.si,10)]=[E,Yt,j.r])):(I=z.match(/<f[^>]*\/>/))&&Qe[(E=os(I[0])).si]&&(y.f=(T=Qe[E.si][1],$t=Qe[E.si][2],Yt=j.r,$t=La($t).s,Yt=zr(Yt),Ad(T,{r:Yt.r-$t.r,c:Yt.c-$t.c})));for(var is=zr(j.r),Y=0;Y<Pe.length;++Y)is.r>=Pe[Y][0].s.r&&is.r<=Pe[Y][0].e.r&&is.c>=Pe[Y][0].s.c&&is.c<=Pe[Y][0].e.c&&(y.F=Pe[Y][1])}if(j.t==null&&y.v===void 0)if(y.f||y.F)y.v=0,y.t="n";else{if(!Wt)continue;y.t="z"}else y.t=j.t||"n";switch(h.s.c>ie&&(h.s.c=ie),h.e.c<ie&&(h.e.c=ie),y.t){case"n":if(y.v==""||y.v==null){if(!Wt)continue;y.t="z"}else y.v=parseFloat(y.v);break;case"s":if(y.v===void 0){if(!Wt)continue;y.t="z"}else k=vc[parseInt(y.v,10)],y.v=k.t,y.r=k.r,u.cellHTML&&(y.h=k.h);break;case"str":y.t="s",y.v=y.v!=null?Fe(y.v):"",u.cellHTML&&(y.h=$o(y.v));break;case"inlineStr":I=z.match(Wa),y.t="s",I!=null&&(k=pd(I[1]))?(y.v=k.t,u.cellHTML&&(y.h=k.h)):y.v="";break;case"b":y.v=Ve(y.v);break;case"d":u.cellDates?y.v=Cs(y.v,1):(y.v=Sr(Cs(y.v,1)),y.t="n");break;case"e":u&&u.cellText===!1||(y.w=y.v),y.v=An[y.v]}var Ds,le=Ee=0,$t=null;He&&j.s!==void 0&&($t=b.CellXf[j.s])!=null&&($t.numFmtId!=null&&(le=$t.numFmtId),u.cellStyles&&$t.fillId!=null&&(Ee=$t.fillId)),bi(y,le,Ee,u,g,b),u.cellDates&&He&&y.t=="n"&&dr(V[le])&&(y.t="d",y.v=wn(y.v)),j.cm&&u.xlmeta&&(Ds=(u.xlmeta.Cell||[])[+j.cm-1])&&Ds.type=="XLDAPR"&&(y.D=!0),pt?(d[(Ds=zr(j.r)).r]||(d[Ds.r]=[]),d[Ds.r][Ds.c]=y):d[j.r]=y}}}}0<xt.length&&(d["!rows"]=xt)});function pf(r,d){for(var u,h,g,b,x=[],y=[],j=Fs(r["!ref"]),k=[],E=0,I=0,T=r["!rows"],_=Array.isArray(r),R={r:""},q=-1,I=j.s.c;I<=j.e.c;++I)k[I]=Er(I);for(E=j.s.r;E<=j.e.r;++E){for(y=[],g=Br(E),I=j.s.c;I<=j.e.c;++I){h=k[I]+g;var J=_?(r[E]||[])[I]:r[h];J!==void 0&&(u=(function(Y,z,X,ie){if(Y.c&&X["!comments"].push([z,Y.c]),Y.v===void 0&&typeof Y.f!="string"||Y.t==="z"&&!Y.f)return"";var le="",Ee=Y.t,He=Y.v;if(Y.t!=="z")switch(Y.t){case"b":le=Y.v?"1":"0";break;case"n":le=""+Y.v;break;case"e":le=$n[Y.v];break;case"d":le=ie&&ie.cellDates?Cs(Y.v,-1).toISOString():((Y=sr(Y)).t="n",""+(Y.v=Sr(Cs(Y.v)))),Y.z===void 0&&(Y.z=V[14]);break;default:le=Y.v}var Pe=Hs("v",Ys(le)),Qe={r:z},pt=Gi(ie.cellXfs,Y,ie);switch(pt!==0&&(Qe.s=pt),Y.t){case"n":break;case"d":Qe.t="d";break;case"b":Qe.t="b";break;case"e":Qe.t="e";break;case"z":break;default:if(Y.v==null){delete Y.t;break}if(32767<Y.v.length)throw new Error("Text length must not exceed 32767 characters");if(ie&&ie.bookSST){Pe=Hs("v",""+Md(ie.Strings,Y.v,ie.revStrings)),Qe.t="s";break}Qe.t="str"}return Y.t!=Ee&&(Y.t=Ee,Y.v=He),typeof Y.f=="string"&&Y.f&&(He=Y.F&&Y.F.slice(0,z.length)==z?{t:"array",ref:Y.F}:null,Pe=Bt("f",Ys(Y.f),He)+(Y.v!=null?Pe:"")),Y.l&&X["!links"].push([z,Y.l]),Y.D&&(Qe.cm=1),Bt("c",Pe,Qe)})(J,h,r,d))!=null&&y.push(u)}(0<y.length||T&&T[E])&&(R={r:g},T&&T[E]&&((b=T[E]).hidden&&(R.hidden=1),q=-1,b.hpx?q=mc(b.hpx):b.hpt&&(q=b.hpt),-1<q&&(R.ht=q,R.customHeight=1),b.level&&(R.outlineLevel=b.level)),x[x.length]=Bt("row",y.join(""),R))}if(T)for(;E<T.length;++E)T&&T[E]&&(R={r:E+1},(b=T[E]).hidden&&(R.hidden=1),q=-1,b.hpx?q=mc(b.hpx):b.hpt&&(q=b.hpt),-1<q&&(R.ht=q,R.customHeight=1),b.level&&(R.outlineLevel=b.level),x[x.length]=Bt("row","",R));return x.join("")}function fu(r,d,u,h){var g,b,x=[jr,Bt("worksheet",null,{xmlns:xl[0],"xmlns:r":Wr.r})],y=u.SheetNames[r],j=u.Sheets[y],k=(j=j??{})["!ref"]||"A1",E=Fs(k);if(16383<E.e.c||1048575<E.e.r){if(d.WTF)throw new Error("Range "+k+" exceeds format limit A1:XFD1048576");E.e.c=Math.min(E.e.c,16383),E.e.r=Math.min(E.e.c,1048575),k=Ss(E)}h=h||{},j["!comments"]=[];var T,_,R=[];(function(Y,z,X,ie,le){var Ee=!1,He={},Pe=null;if(ie.bookType!=="xlsx"&&z.vbaraw){var Qe=z.SheetNames[X];try{z.Workbook&&(Qe=z.Workbook.Sheets[X].CodeName||Qe)}catch{}Ee=!0,He.codeName=At(Ys(Qe))}Y&&Y["!outline"]&&(ie={summaryBelow:1,summaryRight:1},Y["!outline"].above&&(ie.summaryBelow=0),Y["!outline"].left&&(ie.summaryRight=0),Pe=(Pe||"")+Bt("outlinePr",null,ie)),(Ee||Pe)&&(le[le.length]=Bt("sheetPr",Pe,He))})(j,u,r,d,x),x[x.length]=Bt("dimension",null,{ref:k}),x[x.length]=(y={workbookViewId:"0"},((((E=u)||{}).Workbook||{}).Views||[])[0]&&(y.rightToLeft=E.Workbook.Views[0].RTL?"1":"0"),Bt("sheetViews",Bt("sheetView",null,y),{})),d.sheetFormat&&(x[x.length]=Bt("sheetFormatPr",null,{defaultRowHeight:d.sheetFormat.defaultRowHeight||"16",baseColWidth:d.sheetFormat.baseColWidth||"10",outlineLevelRow:d.sheetFormat.outlineLevelRow||"7"})),j["!cols"]!=null&&0<j["!cols"].length&&(x[x.length]=(function(Y){for(var z,X=["<cols>"],ie=0;ie!=Y.length;++ie)(z=Y[ie])&&(X[X.length]=Bt("col",null,jc(ie,z)));return X[X.length]="</cols>",X.join("")})(j["!cols"])),x[g=x.length]="<sheetData/>",j["!links"]=[],j["!ref"]!=null&&0<(b=pf(j,d)).length&&(x[x.length]=b),x.length>g+1&&(x[x.length]="</sheetData>",x[g]=x[g].replace("/>",">")),j["!protect"]&&(x[x.length]=(T=j["!protect"],_={sheet:1},gg.forEach(function(Y){T[Y]!=null&&T[Y]&&(_[Y]="1")}),Xp.forEach(function(Y){T[Y]==null||T[Y]||(_[Y]="0")}),T.password&&(_.password=G0(T.password).toString(16).toUpperCase()),Bt("sheetProtection",null,_))),j["!autofilter"]!=null&&(x[x.length]=(function(Y,z,X,ie){var le=typeof Y.ref=="string"?Y.ref:Ss(Y.ref);X.Workbook||(X.Workbook={Sheets:[]}),X.Workbook.Names||(X.Workbook.Names=[]);var Ee=X.Workbook.Names;(Y=La(le)).s.r==Y.e.r&&(Y.e.r=La(z["!ref"]).e.r,le=Ss(Y));for(var He=0;He<Ee.length;++He){var Pe=Ee[He];if(Pe.Name=="_xlnm._FilterDatabase"&&Pe.Sheet==ie){Pe.Ref="'"+X.SheetNames[ie]+"'!"+le;break}}return He==Ee.length&&Ee.push({Name:"_xlnm._FilterDatabase",Sheet:ie,Ref:"'"+X.SheetNames[ie]+"'!"+le}),Bt("autoFilter",null,{ref:le})})(j["!autofilter"],j,u,r)),j["!merges"]!=null&&0<j["!merges"].length&&(x[x.length]=(function(Y){if(Y.length===0)return"";for(var z='<mergeCells count="'+Y.length+'">',X=0;X!=Y.length;++X)z+='<mergeCell ref="'+Ss(Y[X])+'"/>';return z+"</mergeCells>"})(j["!merges"]));var q,I,J=-1;return 0<j["!links"].length&&(x[x.length]="<hyperlinks>",j["!links"].forEach(function(Y){Y[1].Target&&(I={ref:Y[0]},Y[1].Target.charAt(0)!="#"&&(J=ir(h,-1,Ys(Y[1].Target).replace(/#.*$/,""),Ns.HLINK),I["r:id"]="rId"+J),-1<(q=Y[1].Target.indexOf("#"))&&(I.location=Ys(Y[1].Target.slice(q+1))),Y[1].Tooltip&&(I.tooltip=Ys(Y[1].Tooltip)),x[x.length]=Bt("hyperlink",null,I))}),x[x.length]="</hyperlinks>"),delete j["!links"],j["!margins"]!=null&&(x[x.length]=(xi(u=j["!margins"]),Bt("pageMargins",null,u))),d&&!d.ignoreEC&&d.ignoreEC!=null||(x[x.length]=Hs("ignoredErrors",Bt("ignoredError",null,{numberStoredAsText:1,sqref:k}))),0<R.length&&(J=ir(h,-1,"../drawings/drawing"+(r+1)+".xml",Ns.DRAW),x[x.length]=Bt("drawing",null,{"r:id":"rId"+J}),j["!drawing"]=R),0<j["!comments"].length&&(J=ir(h,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ns.VML),x[x.length]=Bt("legacyDrawing",null,{"r:id":"rId"+J}),j["!legacy"]=J),1<x.length&&(x[x.length]="</worksheet>",x[1]=x[1].replace("/>",">")),x.join("")}function Zn(r,d,u,h){u=(function(g,b,x){var y=mt(145),j=(x["!rows"]||[])[g]||{};y.write_shift(4,g),y.write_shift(4,0);var E=320;j.hpx?E=20*mc(j.hpx):j.hpt&&(E=20*j.hpt),y.write_shift(2,E),y.write_shift(1,0),E=0,j.level&&(E|=j.level),j.hidden&&(E|=16),(j.hpx||j.hpt)&&(E|=32),y.write_shift(1,E),y.write_shift(1,0);var k=0,E=y.l;y.l+=4;for(var T={r:g,c:0},_=0;_<16;++_)if(!(b.s.c>_+1<<10||b.e.c<_<<10)){for(var R=-1,q=-1,I=_<<10;I<_+1<<10;++I)T.c=I,(Array.isArray(x)?(x[T.r]||[])[T.c]:x[bs(T)])&&(R<0&&(R=I),q=I);R<0||(++k,y.write_shift(4,R),y.write_shift(4,q))}return g=y.l,y.l=E,y.write_shift(4,k),y.l=g,y.length>y.l?y.slice(0,y.l):y})(h,u,d),(17<u.length||(d["!rows"]||[])[h])&&yt(r,0,u)}var Ld=Wn,Nc=vl;function kc(r){return[Jl(r),ka(r),"n"]}var vi=Wn,Cc=vl,xf=["left","right","top","bottom","header","footer"];function pg(r,d,u,h,g,b,x){if(d.v===void 0)return!1;var y="";switch(d.t){case"b":y=d.v?"1":"0";break;case"d":(d=sr(d)).z=d.z||V[14],d.v=Sr(Cs(d.v)),d.t="n";break;case"n":case"e":y=""+d.v;break;default:y=d.v}var j,k,E,T,_,R,q,I,J,Y,z,X,ie,le,Ee,He,Pe,Qe,pt,xt,at={r:u,c:h};switch(at.s=Gi(g.cellXfs,d,g),d.l&&b["!links"].push([bs(at),d.l]),d.c&&b["!comments"].push([bs(at),d.c]),d.t){case"s":case"str":return g.bookSST?(y=Md(g.Strings,d.v,g.revStrings),at.t="s",at.v=y,x?yt(r,18,(Zl(Pe=at,Qe=Qe??mt(8)),Qe.write_shift(4,Pe.v),Qe)):yt(r,7,(Xl(Pe=at,He=He??mt(12)),He.write_shift(4,Pe.v),He))):(at.t="str",x?yt(r,17,(le=d,Zl(at,Ee=Ee??mt(8+4*le.v.length)),da(le.v,Ee),Ee.length>Ee.l?Ee.slice(0,Ee.l):Ee)):yt(r,6,(le=d,Xl(at,ie=ie??mt(12+4*le.v.length)),da(le.v,ie),ie.length>ie.l?ie.slice(0,ie.l):ie))),!0;case"n":return d.v==(0|d.v)&&-1e3<d.v&&d.v<1e3?x?yt(r,13,(z=d,Zl(at,X=X??mt(8)),eo(z.v,X),X)):yt(r,2,(z=d,Xl(at,Y=Y??mt(12)),eo(z.v,Y),Y)):x?yt(r,16,(I=d,Zl(at,J=J??mt(12)),Sn(I.v,J),J)):yt(r,5,(I=d,Xl(at,q=q??mt(16)),Sn(I.v,q),q)),!0;case"b":return at.t="b",x?yt(r,15,(_=d,Zl(at,R=R??mt(5)),R.write_shift(1,_.v?1:0),R)):yt(r,4,(_=d,Xl(at,T=T??mt(9)),T.write_shift(1,_.v?1:0),T)),!0;case"e":return at.t="e",x?yt(r,14,(k=d,Zl(at,E=E??mt(8)),E.write_shift(1,k.v),E.write_shift(2,0),E.write_shift(1,0),E)):yt(r,3,(k=d,Xl(at,j=j??mt(9)),j.write_shift(1,k.v),j)),!0}return x?yt(r,12,Zl(at,xt=xt??mt(4))):yt(r,1,Xl(at,pt=pt??mt(8))),!0}function Rd(r,d){var u,h;d&&d["!merges"]&&(yt(r,177,(u=d["!merges"].length,(h=h??mt(4)).write_shift(4,u),h)),d["!merges"].forEach(function(g){yt(r,176,Cc(g))}),yt(r,178))}function xg(r,d){d&&d["!cols"]&&(yt(r,390),d["!cols"].forEach(function(u,h){u&&yt(r,60,(function(g,b,x){x==null&&(x=mt(18));var y=jc(g,b);return x.write_shift(-4,g),x.write_shift(-4,g),x.write_shift(4,256*(y.width||10)),x.write_shift(4,0),g=0,b.hidden&&(g|=1),typeof y.width=="number"&&(g|=2),b.level&&(g|=b.level<<8),x.write_shift(2,g),x})(h,u))}),yt(r,391))}function mu(r,d){var u;d&&d["!ref"]&&(yt(r,648),yt(r,649,(u=Fs(d["!ref"]),(d=mt(24)).write_shift(4,4),d.write_shift(4,1),vl(u,d),d)),yt(r,650))}function bg(r,d,u){d["!links"].forEach(function(h){var g,b;h[1].Target&&(g=ir(u,-1,h[1].Target.replace(/#.*$/,""),Ns.HLINK),yt(r,494,(b=g,h=mt(50+4*((g=h)[1].Target.length+(g[1].Tooltip||"").length)),vl({s:zr(g[0]),e:zr(g[0])},h),ad("rId"+b,h),da(((b=g[1].Target.indexOf("#"))==-1?"":g[1].Target.slice(b+1))||"",h),da(g[1].Tooltip||"",h),da("",h),h.slice(0,h.l))))}),delete d["!links"]}function Jp(r,d,u){yt(r,133),yt(r,137,(function(h,g){g==null&&(g=mt(30));var b=924;return(((h||{}).Views||[])[0]||{}).RTL&&(b|=32),g.write_shift(2,b),g.write_shift(4,0),g.write_shift(4,0),g.write_shift(4,0),g.write_shift(1,0),g.write_shift(1,0),g.write_shift(2,0),g.write_shift(2,100),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(4,0),g})(u)),yt(r,138),yt(r,134)}function Zp(r,d){var u,h;d["!protect"]&&yt(r,535,(u=d["!protect"],(h=h??mt(66)).write_shift(2,u.password?G0(u.password):0),h.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(g){g[1]?h.write_shift(4,u[g[0]]==null||u[g[0]]?0:1):h.write_shift(4,u[g[0]]!=null&&u[g[0]]?0:1)}),h))}function rr(r,d,u,h){var g=Ma(),k=u.SheetNames[r],b=u.Sheets[k]||{},x=k;try{u&&u.Workbook&&(x=u.Workbook.Sheets[r].CodeName||x)}catch{}var y,j,k=Fs(b["!ref"]||"A1");if(16383<k.e.c||1048575<k.e.r){if(d.WTF)throw new Error("Range "+(b["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");k.e.c=Math.min(k.e.c,16383),k.e.r=Math.min(k.e.c,1048575)}return b["!links"]=[],b["!comments"]=[],yt(g,129),(u.vbaraw||b["!outline"])&&yt(g,147,(function(E,T,_){_==null&&(_=mt(84+4*E.length));var R=192;T&&(T.above&&(R&=-65),T.left&&(R&=-129)),_.write_shift(1,R);for(var q=1;q<3;++q)_.write_shift(1,0);return Ri({auto:1},_),_.write_shift(-4,-1),_.write_shift(-4,-1),Zo(E,_),_.slice(0,_.l)})(x,b["!outline"])),yt(g,148,Nc(k)),Jp(g,0,u.Workbook),xg(g,b),(function(E,T,_){var R,q=Fs(T["!ref"]||"A1"),I=[];yt(E,145);var J=Array.isArray(T),Y=q.e.r;T["!rows"]&&(Y=Math.max(q.e.r,T["!rows"].length-1));for(var z=q.s.r;z<=Y;++z){R=Br(z),Zn(E,T,q,z);var X=!1;if(z<=q.e.r)for(var ie=q.s.c;ie<=q.e.c;++ie){z===q.s.r&&(I[ie]=Er(ie)),le=I[ie]+R;var le=J?(T[z]||[])[ie]:T[le];le?X=pg(E,le,z,ie,_,T,X):X=!1}}yt(E,146)})(g,b,d),Zp(g,b),(function(E,T,_,R){if(T["!autofilter"]){var J=T["!autofilter"],q=typeof J.ref=="string"?J.ref:Ss(J.ref);_.Workbook||(_.Workbook={Sheets:[]}),_.Workbook.Names||(_.Workbook.Names=[]);var I=_.Workbook.Names,J=La(q);J.s.r==J.e.r&&(J.e.r=La(T["!ref"]).e.r,q=Ss(J));for(var Y=0;Y<I.length;++Y){var z=I[Y];if(z.Name=="_xlnm._FilterDatabase"&&z.Sheet==R){z.Ref="'"+_.SheetNames[R]+"'!"+q;break}}Y==I.length&&I.push({Name:"_xlnm._FilterDatabase",Sheet:R,Ref:"'"+_.SheetNames[R]+"'!"+q}),yt(E,161,vl(Fs(q))),yt(E,162)}})(g,b,u,r),Rd(g,b),bg(g,b,h),b["!margins"]&&yt(g,476,(y=b["!margins"],j==null&&(j=mt(48)),xi(y),xf.forEach(function(E){Sn(y[E],j)}),j)),d&&!d.ignoreEC&&d.ignoreEC!=null||mu(g,b),k=g,d=r,h=h,0<(b=b)["!comments"].length&&(d=ir(h,-1,"../drawings/vmlDrawing"+(d+1)+".vml",Ns.VML),yt(k,551,ad("rId"+d)),b["!legacy"]=d),yt(g,130),g.end()}function br(r,d,u,h,g,b){var x=b||{"!type":"chart"};if(!r)return b;var y,j=0,k=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(T){var _=(function(R){var q,I=[],J=R.match(/^<c:numCache>/);(R.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(z){z=z.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/),z&&(I[+z[1]]=J?+z[2]:z[2])});var Y=ys((R.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(R.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(z){q=z.replace(/<.*?>/g,"")}),[I,Y,q]})(T);E.s.r=E.s.c=0,E.e.c=j,y=Er(j),_[0].forEach(function(R,q){x[y+Br(q)]={t:"n",v:R,z:_[1]},k=q}),E.e.r<k&&(E.e.r=k),++j}),0<j&&(x["!ref"]=Ss(E)),x}var Rs=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Ws=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ur=[],pn=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Xi(r,d){for(var u=0;u!=r.length;++u)for(var h=r[u],g=0;g!=d.length;++g){var b=d[g];if(h[b[0]]==null)h[b[0]]=b[1];else switch(b[2]){case"bool":typeof h[b[0]]=="string"&&(h[b[0]]=Ve(h[b[0]]));break;case"int":typeof h[b[0]]=="string"&&(h[b[0]]=parseInt(h[b[0]],10))}}}function vo(r,d){for(var u=0;u!=d.length;++u){var h=d[u];if(r[h[0]]==null)r[h[0]]=h[1];else switch(h[2]){case"bool":typeof r[h[0]]=="string"&&(r[h[0]]=Ve(r[h[0]]));break;case"int":typeof r[h[0]]=="string"&&(r[h[0]]=parseInt(r[h[0]],10))}}}function gu(r){vo(r.WBProps,Rs),vo(r.CalcPr,pn),Xi(r.WBView,Ws),Xi(r.Sheets,ur),Ll.date1904=Ve(r.WBProps.date1904)}var Ji="][*?/\\".split("");function Ur(r,d){if(31<r.length)throw new Error("Sheet names cannot exceed 31 chars");var u=!0;return Ji.forEach(function(h){if(r.indexOf(h)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),u}function Zi(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var d,u,h,g=r.Workbook&&r.Workbook.Sheets||[];d=r.SheetNames,u=g,h=!!r.vbaraw,d.forEach(function(x,y){Ur(x);for(var j=0;j<y;++j)if(x==d[j])throw new Error("Duplicate Sheet Name: "+x);if(h){var k=u&&u[y]&&u[y].CodeName||x;if(k.charCodeAt(0)==95&&22<k.length)throw new Error("Bad Code Name: Worksheet"+k)}});for(var b=0;b<r.SheetNames.length;++b)(function(x,y){if(x&&x["!ref"]){var j=Fs(x["!ref"]);if(j.e.c<j.s.c||j.e.r<j.s.r)throw new Error("Bad range ("+y+"): "+x["!ref"])}})(r.Sheets[r.SheetNames[b]],(r.SheetNames[b],b))}var wo=/<\w+:workbook/;function pu(r){var d=[jr];d[d.length]=Bt("workbook",null,{xmlns:xl[0],"xmlns:r":Wr.r});var u=r.Workbook&&0<(r.Workbook.Names||[]).length,h={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(Rs.forEach(function(y){r.Workbook.WBProps[y[0]]!=null&&r.Workbook.WBProps[y[0]]!=y[1]&&(h[y[0]]=r.Workbook.WBProps[y[0]])}),r.Workbook.WBProps.CodeName&&(h.codeName=r.Workbook.WBProps.CodeName,delete h.CodeName)),d[d.length]=Bt("workbookPr",null,h);var g=r.Workbook&&r.Workbook.Sheets||[],b=0;if(g&&g[0]&&g[0].Hidden){for(d[d.length]="<bookViews>",b=0;b!=r.SheetNames.length&&g[b]&&g[b].Hidden;++b);b==r.SheetNames.length&&(b=0),d[d.length]='<workbookView firstSheet="'+b+'" activeTab="'+b+'"/>',d[d.length]="</bookViews>"}for(d[d.length]="<sheets>",b=0;b!=r.SheetNames.length;++b){var x={name:Ys(r.SheetNames[b].slice(0,31))};if(x.sheetId=""+(b+1),x["r:id"]="rId"+(b+1),g[b])switch(g[b].Hidden){case 1:x.state="hidden";break;case 2:x.state="veryHidden"}d[d.length]=Bt("sheet",null,x)}return d[d.length]="</sheets>",u&&(d[d.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(y){var j={name:y.Name};y.Comment&&(j.comment=y.Comment),y.Sheet!=null&&(j.localSheetId=""+y.Sheet),y.Hidden&&(j.hidden="1"),y.Ref&&(d[d.length]=Bt("definedName",Ys(y.Ref),j))}),d[d.length]="</definedNames>"),2<d.length&&(d[d.length]="</workbook>",d[1]=d[1].replace("/>",">")),d.join("")}function xn(r,d){var u={};return r.read_shift(4),u.ArchID=r.read_shift(4),r.l+=d-8,u}function Sc(r,d){yt(r,143);for(var u,h=0;h!=d.SheetNames.length;++h){var g={Hidden:d.Workbook&&d.Workbook.Sheets&&d.Workbook.Sheets[h]&&d.Workbook.Sheets[h].Hidden||0,iTabID:h+1,strRelID:"rId"+(h+1),name:d.SheetNames[h]};yt(r,156,(u=g,(g=(g=void 0)||mt(127)).write_shift(4,u.Hidden),g.write_shift(4,u.iTabID),ad(u.strRelID,g),da(u.name.slice(0,31),g),g.length>g.l?g.slice(0,g.l):g))}yt(r,144)}function Od(r,d){if(d.Workbook&&d.Workbook.Sheets){for(var u,h=d.Workbook.Sheets,g=0,b=-1,x=-1;g<h.length;++g)!h[g]||!h[g].Hidden&&b==-1?b=g:h[g].Hidden==1&&x==-1&&(x=g);b<x||(yt(r,135),yt(r,158,(d=b,(u=u||mt(29)).write_shift(-4,0),u.write_shift(-4,460),u.write_shift(4,28800),u.write_shift(4,17600),u.write_shift(4,500),u.write_shift(4,d),u.write_shift(4,d),u.write_shift(1,120),u.length>u.l?u.slice(0,u.l):u)),yt(r,136))}}function Xa(r,d){var u=Ma();return yt(u,131),yt(u,128,(function(h){h=h||mt(127);for(var g=0;g!=4;++g)h.write_shift(4,0);return da("SheetJS",h),da(s.version,h),da(s.version,h),da("7262",h),h.length>h.l?h.slice(0,h.l):h})()),yt(u,153,(function(h,g){g=g||mt(72);var b=0;return h&&h.filterPrivacy&&(b|=8),g.write_shift(4,b),g.write_shift(4,0),Zo(h&&h.CodeName||"ThisWorkbook",g),g.slice(0,g.l)})(r.Workbook&&r.Workbook.WBProps||null)),Od(u,r),Sc(u,r),yt(u,132),u.end()}function bf(r,d,u){return(d.slice(-4)===".bin"?function(h,g){var b={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},x=[],y=!1;(g=g||{}).biff=12;var j=[],k=[[]];return k.SheetNames=[],k.XTI=[],jo[16]={n:"BrtFRTArchID$",f:xn},Li(h,function(E,T,_){switch(_){case 156:k.SheetNames.push(E.name),b.Sheets.push(E);break;case 153:b.WBProps=E;break;case 39:E.Sheet!=null&&(g.SID=E.Sheet),E.Ref=Oa(E.Ptg,0,null,k,g),delete g.SID,delete E.Ptg,j.push(E);break;case 1036:break;case 357:case 358:case 355:case 667:k[0].length?k.push([_,E]):k[0]=[_,E],k[k.length-1].XTI=[];break;case 362:k.length===0&&(k[0]=[],k[0].XTI=[]),k[k.length-1].XTI=k[k.length-1].XTI.concat(E),k.XTI=k.XTI.concat(E);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:x.push(_),y=!0;break;case 36:x.pop(),y=!1;break;case 37:x.push(_),y=!0;break;case 38:x.pop(),y=!1;break;case 16:break;default:if(!T.T&&(!y||g.WTF&&x[x.length-1]!=37&&x[x.length-1]!=35))throw new Error("Unexpected record 0x"+_.toString(16))}},g),gu(b),b.Names=j,b.supbooks=k,b}:function(h,g){if(!h)throw new Error("Could not find file");var b={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},x=!1,y="xmlns",j={},k=0;if(h.replace(Jr,function(E,T){var _=os(E);switch(kn(_[0])){case"<?xml":break;case"<workbook":E.match(wo)&&(y="xmlns"+E.match(/<(\w+):/)[1]),b.xmlns=_[y];break;case"</workbook>":break;case"<fileVersion":delete _[0],b.AppVersion=_;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Rs.forEach(function(R){if(_[R[0]]!=null)switch(R[2]){case"bool":b.WBProps[R[0]]=Ve(_[R[0]]);break;case"int":b.WBProps[R[0]]=parseInt(_[R[0]],10);break;default:b.WBProps[R[0]]=_[R[0]]}}),_.codeName&&(b.WBProps.CodeName=Fe(_.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete _[0],b.WBView.push(_);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(_.state){case"hidden":_.Hidden=1;break;case"veryHidden":_.Hidden=2;break;default:_.Hidden=0}delete _.state,_.name=ys(Fe(_.name)),delete _[0],b.Sheets.push(_);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":x=!0;break;case"</definedNames>":x=!1;break;case"<definedName":(j={}).Name=Fe(_.name),_.comment&&(j.Comment=_.comment),_.localSheetId&&(j.Sheet=+_.localSheetId),Ve(_.hidden||"0")&&(j.Hidden=!0),k=T+E.length;break;case"</definedName>":j.Ref=ys(Fe(h.slice(k,T))),b.Names.push(j);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete _[0],b.CalcPr=_;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":x=!0;break;case"</ext>":x=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":x=!0;break;case"</AlternateContent>":x=!1;break;case"<revisionPtr":break;default:if(!x&&g.WTF)throw new Error("unrecognized "+_[0]+" in workbook")}return E}),xl.indexOf(b.xmlns)===-1)throw new Error("Unknown Namespace: "+b.xmlns);return gu(b),b})(r,u)}function xu(r,d,u,h,g,b,x,y){return(d.slice(-4)===".bin"?function(j,k,E,T,_,R,q){if(!j)return j;var I=k||{};T=T||{"!id":{}};var J,Y,z,X,ie,le,Ee,He,Pe,Qe,pt=I.dense?[]:{},xt={s:{r:2e6,c:2e6},e:{r:0,c:0}},at=!1,kt=!1,Wt=[];I.biff=12;var Ht=I["!row"]=0,Mt=!1,Ot=[],_t={},wt=I.supbooks||_.supbooks||[[]];if(wt.sharedf=_t,wt.arrayf=Ot,wt.SheetNames=_.SheetNames||_.Sheets.map(function(Ct){return Ct.name}),!I.supbooks&&(I.supbooks=wt,_.Names))for(var Yt=0;Yt<_.Names.length;++Yt)wt[0][Yt+1]=_.Names[Yt];var Jt,is=[],Ds=[],$t=!1;return jo[16]={n:"BrtShortReal",f:kc},Li(j,function(Ct,gs,Us){if(!kt)switch(Us){case 148:J=Ct;break;case 0:Y=Ct,I.sheetRows&&I.sheetRows<=Y.r&&(kt=!0),Pe=Br(ie=Y.r),I["!row"]=Y.r,(Ct.hidden||Ct.hpt||Ct.level!=null)&&(Ct.hpt&&(Ct.hpx=po(Ct.hpt)),Ds[Ct.r]=Ct);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(z={t:Ct[2]},Ct[2]){case"n":z.v=Ct[1];break;case"s":He=vc[Ct[1]],z.v=He.t,z.r=He.r;break;case"b":z.v=!!Ct[1];break;case"e":z.v=Ct[1],I.cellText!==!1&&(z.w=$n[z.v]);break;case"str":z.t="s",z.v=Ct[1];break;case"is":z.t="s",z.v=Ct[1].t}if((X=q.CellXf[Ct[0].iStyleRef])&&bi(z,X.numFmtId,null,I,R,q),le=Ct[0].c==-1?le+1:Ct[0].c,I.dense?(pt[ie]||(pt[ie]=[]),pt[ie][le]=z):pt[Er(le)+Pe]=z,I.cellFormula){for(Mt=!1,Ht=0;Ht<Ot.length;++Ht){var Os=Ot[Ht];Y.r>=Os[0].s.r&&Y.r<=Os[0].e.r&&le>=Os[0].s.c&&le<=Os[0].e.c&&(z.F=Ss(Os[0]),Mt=!0)}!Mt&&3<Ct.length&&(z.f=Ct[3])}xt.s.r>Y.r&&(xt.s.r=Y.r),xt.s.c>le&&(xt.s.c=le),xt.e.r<Y.r&&(xt.e.r=Y.r),xt.e.c<le&&(xt.e.c=le),I.cellDates&&X&&z.t=="n"&&dr(V[X.numFmtId])&&(er=de(z.v))&&(z.t="d",z.v=new Date(er.y,er.m-1,er.d,er.H,er.M,er.S,er.u)),Jt&&(Jt.type=="XLDAPR"&&(z.D=!0),Jt=void 0);break;case 1:case 12:if(!I.sheetStubs||at)break;z={t:"z",v:void 0},le=Ct[0].c==-1?le+1:Ct[0].c,I.dense?(pt[ie]||(pt[ie]=[]),pt[ie][le]=z):pt[Er(le)+Pe]=z,xt.s.r>Y.r&&(xt.s.r=Y.r),xt.s.c>le&&(xt.s.c=le),xt.e.r<Y.r&&(xt.e.r=Y.r),xt.e.c<le&&(xt.e.c=le),Jt&&(Jt.type=="XLDAPR"&&(z.D=!0),Jt=void 0);break;case 176:Wt.push(Ct);break;case 49:Jt=((I.xlmeta||{}).Cell||[])[Ct-1];break;case 494:var er=T["!id"][Ct.relId];for(er?(Ct.Target=er.Target,Ct.loc&&(Ct.Target+="#"+Ct.loc),Ct.Rel=er):Ct.relId==""&&(Ct.Target="#"+Ct.loc),ie=Ct.rfx.s.r;ie<=Ct.rfx.e.r;++ie)for(le=Ct.rfx.s.c;le<=Ct.rfx.e.c;++le)I.dense?(pt[ie]||(pt[ie]=[]),pt[ie][le]||(pt[ie][le]={t:"z",v:void 0}),pt[ie][le].l=Ct):(Ee=bs({c:le,r:ie}),pt[Ee]||(pt[Ee]={t:"z",v:void 0}),pt[Ee].l=Ct);break;case 426:if(!I.cellFormula)break;Ot.push(Ct),(Qe=I.dense?pt[ie][le]:pt[Er(le)+Pe]).f=Oa(Ct[1],0,{r:Y.r,c:le},wt,I),Qe.F=Ss(Ct[0]);break;case 427:if(!I.cellFormula)break;_t[bs(Ct[0].s)]=Ct[1],(Qe=I.dense?pt[ie][le]:pt[Er(le)+Pe]).f=Oa(Ct[1],0,{r:Y.r,c:le},wt,I);break;case 60:if(!I.cellStyles)break;for(;Ct.e>=Ct.s;)is[Ct.e--]={width:Ct.w/256,hidden:!!(1&Ct.flags),level:Ct.level},$t||($t=!0,jd(Ct.w/256)),Tl(is[Ct.e+1]);break;case 161:pt["!autofilter"]={ref:Ss(Ct)};break;case 476:pt["!margins"]=Ct;break;case 147:_.Sheets[E]||(_.Sheets[E]={}),Ct.name&&(_.Sheets[E].CodeName=Ct.name),(Ct.above||Ct.left)&&(pt["!outline"]={above:Ct.above,left:Ct.left});break;case 137:_.Views||(_.Views=[{}]),_.Views[0]||(_.Views[0]={}),Ct.RTL&&(_.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:at=!0;break;case 36:at=!1;break;case 37:at=!0;break;case 38:at=!1;break;default:if(!gs.T&&(!at||I.WTF))throw new Error("Unexpected record 0x"+Us.toString(16))}},I),delete I.supbooks,delete I["!row"],!pt["!ref"]&&(xt.s.r<2e6||J&&(0<J.e.r||0<J.e.c||0<J.s.r||0<J.s.c))&&(pt["!ref"]=Ss(J||xt)),I.sheetRows&&pt["!ref"]&&(j=Fs(pt["!ref"]),I.sheetRows<=+j.e.r&&(j.e.r=I.sheetRows-1,j.e.r>xt.e.r&&(j.e.r=xt.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>xt.e.c&&(j.e.c=xt.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),pt["!fullref"]=pt["!ref"],pt["!ref"]=Ss(j))),0<Wt.length&&(pt["!merges"]=Wt),0<is.length&&(pt["!cols"]=is),0<Ds.length&&(pt["!rows"]=Ds),pt}:mg)(r,h,u,g,b,x,y)}function yg(r,d,u,h,g,b){return d.slice(-4)===".bin"?(function(x,y,j,k,E){if(!x)return x;k=k||{"!id":{}};var T={"!type":"chart","!drawel":null,"!rel":""},_=!1;return Li(x,function(R,q,I){switch(I){case 550:T["!rel"]=R;break;case 651:E.Sheets[j]||(E.Sheets[j]={}),R.name&&(E.Sheets[j].CodeName=R.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:_=!0;break;case 36:_=!1;break;case 37:break;case 38:break;default:if(!(0<q.T)){if(!(q.T<0)){if(!_||y.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}}},y),k["!id"][T["!rel"]]&&(T["!drawel"]=k["!id"][T["!rel"]]),T})(r,h,u,g,b):(function(x,y,j,k){if(!x)return x;j=j||{"!id":{}};var E={"!type":"chart","!drawel":null,"!rel":""},T=x.match(Dr);return T&&uu(T[0],0,k,y),(x=x.match(/drawing r:id="(.*?)"/))&&(E["!rel"]=x[1]),j["!id"][E["!rel"]]&&(E["!drawel"]=j["!id"][E["!rel"]]),E})(r,u,g,b)}function bu(r,d,u,h){return(d.slice(-4)===".bin"?function(g,b,x){var y,j={NumberFmt:[]};for(y in V)j.NumberFmt[y]=V[y];j.CellXf=[],j.Fonts=[];var k=[],E=!1;return Li(g,function(T,_,R){switch(R){case 44:j.NumberFmt[T[0]]=T[1],Or(T[1],T[0]);break;case 43:j.Fonts.push(T),T.color.theme!=null&&b&&b.themeElements&&b.themeElements.clrScheme&&(T.color.rgb=wd(b.themeElements.clrScheme[T.color.theme].rgb,T.color.tint||0));break;case 1025:case 45:case 46:break;case 47:k[k.length-1]==617&&j.CellXf.push(T);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:E=!0;break;case 36:E=!1;break;case 37:k.push(R),E=!0;break;case 38:k.pop(),E=!1;break;default:if(0<_.T)k.push(R);else if(_.T<0)k.pop();else if(!E||x.WTF&&k[k.length-1]!=37)throw new Error("Unexpected record 0x"+R.toString(16))}}),j}:Yh)(r,u,h)}function yu(r,d,u){return d.slice(-4)===".bin"?(h=u,b=!(g=[]),Li(r,function(x,y,j){switch(j){case 159:g.Count=x[0],g.Unique=x[1];break;case 19:g.push(x);break;case 160:return 1;case 35:b=!0;break;case 36:b=!1;break;default:if(y.T,!b||h.WTF)throw new Error("Unexpected record 0x"+j.toString(16))}}),g):(function(x,y){var j=[],k="";if(!x)return j;if(x=x.match(Ha)){k=x[2].replace(Zr,"").split(Y0);for(var E=0;E!=k.length;++E){var T=pd(k[E].trim(),y);T!=null&&(j[j.length]=T)}x=os(x[1]),j.Count=x.count,j.Unique=x.uniqueCount}return j})(r,u);var h,g,b}function Ol(r,d,u){return d.slice(-4)===".bin"?(h=u,g=[],b=[],y=!(x={}),Li(r,function(j,k,E){switch(E){case 632:b.push(j);break;case 635:x=j;break;case 637:x.t=j.t,x.h=j.h,x.r=j.r;break;case 636:if(x.author=b[x.iauthor],delete x.iauthor,h.sheetRows&&x.rfx&&h.sheetRows<=x.rfx.r)break;x.t||(x.t=""),delete x.rfx,g.push(x);break;case 3072:break;case 35:y=!0;break;case 36:y=!1;break;case 37:case 38:break;default:if(!k.T&&(!y||h.WTF))throw new Error("Unexpected record 0x"+E.toString(16))}}),g):(function(j,k){if(j.match(/<(?:\w+:)?comments *\/>/))return[];var E=[],T=[],_=j.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);return _&&_[1]&&_[1].split(/<\/\w*:?author>/).forEach(function(R){R===""||R.trim()===""||(R=R.match(/<(?:\w+:)?author[^>]*>(.*)/))&&E.push(R[1])}),(j=j.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&j[1]&&j[1].split(/<\/\w*:?comment>/).forEach(function(R){var q,I;R===""||R.trim()===""||(q=R.match(/<(?:\w+:)?comment[^>]*>/))&&(q={author:(I=os(q[0])).authorId&&E[I.authorId]||"sheetjsghost",ref:I.ref,guid:I.guid},I=zr(I.ref),k.sheetRows&&k.sheetRows<=I.r||(R=!!(R=R.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!R[1]&&pd(R[1])||{r:"",t:"",h:""},q.r=R.r,R.r=="<t></t>"&&(R.t=R.h=""),q.t=(R.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),k.cellHTML&&(q.h=R.h),T.push(q)))}),T})(r,u);var h,g,b,x,y}function ha(r,d){return d.slice(-4)===".bin"?(u=[],Li(r,function(h,g,b){if(b===63)u.push(h);else if(!g.T)throw new Error("Unexpected record 0x"+b.toString(16))}),u):(function(h){var g=[];if(!h)return g;var b=1;return(h.match(Jr)||[]).forEach(function(x){var y=os(x);switch(y[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete y[0],y.i?b=y.i:y.i=b,g.push(y)}}),g})(r);var u}function Pl(r,d,u,h){if(u.slice(-4)===".bin")return(function(g,b){if(!g)return g;var x=b||{},y=!1;Li(g,function(j,k,E){switch(E){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:y=!0;break;case 36:y=!1;break;default:if(!k.T&&(!y||x.WTF))throw new Error("Unexpected record 0x"+E.toString(16))}},x)})(r,h)}function Ac(r,d,u){return d.slice(-4)===".bin"?(h={Types:[],Cell:[],Value:[]},g=u||{},x=!(b=[]),y=2,Li(r,function(j,k,E){switch(E){case 335:h.Types.push({name:j.name});break;case 51:j.forEach(function(T){y==1?h.Cell.push({type:h.Types[T[0]-1].name,index:T[1]}):y==0&&h.Value.push({type:h.Types[T[0]-1].name,index:T[1]})});break;case 337:y=j?1:0;break;case 338:y=2;break;case 35:b.push(E),x=!0;break;case 36:b.pop(),x=!1;break;default:if(!k.T&&(!x||g.WTF&&b[b.length-1]!=35))throw new Error("Unexpected record 0x"+E.toString(16))}}),h):(function(j,k){var E={Types:[],Cell:[],Value:[]};if(!j)return E;var T,_=!1,R=2;return j.replace(Jr,function(q){var I=os(q);switch(kn(I[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":E.Types.push({name:I.name});break;case"</metadataType>":break;case"<futureMetadata":for(var J=0;J<E.Types.length;++J)E.Types[J].name==I.name&&(T=E.Types[J]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":R==1?E.Cell.push({type:E.Types[I.t-1].name,index:+I.v}):R==0&&E.Value.push({type:E.Types[I.t-1].name,index:+I.v});break;case"</rc>":break;case"<cellMetadata":R=1;break;case"</cellMetadata>":R=2;break;case"<valueMetadata":R=0;break;case"</valueMetadata>":R=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":_=!0;break;case"</ext>":_=!1;break;case"<rvb":if(!T)break;T.offsets||(T.offsets=[]),T.offsets.push(+I.i);break;default:if(!_&&k.WTF)throw new Error("unrecognized "+I[0]+" in metadata")}return q}),E})(r,u);var h,g,b,x,y}var bn,vu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Fn(r,d){var u=r.split(/\s+/),h=[];if(h[0]=u[0],u.length===1)return h;var g,b,x,y=r.match(vu);if(y)for(x=0;x!=y.length;++x)(b=(g=y[x].match(wu))[1].indexOf(":"))===-1?h[g[1]]=g[2].slice(1,g[2].length-1):h[g[1].slice(0,6)==="xmlns:"?"xmlns"+g[1].slice(6):g[1].slice(b+1)]=g[2].slice(1,g[2].length-1);return h}function Pd(r,d,u){if(r.t!=="z"){if(!u||u.cellText!==!1)try{r.t==="e"?r.w=r.w||$n[r.v]:d==="General"?r.t==="n"?(0|r.v)===r.v?r.w=r.v.toString(10):r.w=vt(r.v):r.w=ze(r.v):r.w=(h=d||"General",g=r.v,(h=bn[h]||ys(h))==="General"?ze(g):Kr(h,g))}catch(x){if(u.WTF)throw x}var h,g;try{var b=bn[d]||d||"General";u.cellNF&&(r.z=b),u.cellDates&&r.t=="n"&&dr(b)&&(b=de(r.v))&&(r.t="d",r.v=new Date(b.y,b.m-1,b.d,b.H,b.M,b.S,b.u))}catch(x){if(u.WTF)throw x}}}function Id(r,d){var u=d||{};ll();var h,g=O(d0(r)),b=(g=u.type=="binary"||u.type=="array"||u.type=="base64"?e!==void 0?e.utils.decode(65001,M(g)):Fe(g):g).slice(0,1024).toLowerCase(),x=!1;if((1023&(b=b.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&b.indexOf(","),1023&b.indexOf(";"))){var y=sr(u);return y.type="string",Wi.to_workbook(g,y)}if(b.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Se){0<=b.indexOf("<"+Se)&&(x=!0)}),x)return(function(Se,Nt){if(Se=Se.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi),!Se||Se.length==0)throw new Error("Invalid HTML: could not find <table>");if(Se.length==1)return Vn(Hd(Se[0],Nt),Nt);var Xe=Pf();return Se.forEach(function(ct,Ye){Uu(Xe,Hd(ct,Nt),"Sheet"+(Ye+1))}),Xe})(g,u);bn={"General Number":"General","General Date":V[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":V[15],"Short Date":V[14],"Long Time":V[19],"Medium Time":V[18],"Short Time":V[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:V[2],Standard:V[4],Percent:V[10],Scientific:V[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var j,k=[],E,T={},_=[],R=u.dense?[]:{},q="",I={},J={},Y=Fn('<Data ss:Type="String">'),z=0,X=0,ie=0,le={s:{r:2e6,c:2e6},e:{r:0,c:0}},Ee={},He={},Pe="",Qe=0,pt=[],xt={},at={},kt=0,Wt=[],Ht=[],Mt={},Ot=[],_t=!1,wt=[],Yt=[],Jt={},is=0,Ds=0,$t={Sheets:[],WBProps:{date1904:!1}},Ct={};pl.lastIndex=0,g=g.replace(/<!--([\s\S]*?)-->/gm,"");for(var gs,Us,Os,er,Rr="";h=pl.exec(g);)switch(h[3]=(Rr=h[3]).toLowerCase()){case"data":if(Rr=="data"){if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break}if(k[k.length-1][1])break;h[1]==="/"?(function(Se,Nt,Xe,ct,Ye,ht,St,Qt,Gt,Ut){var Xt="General",rs=ct.StyleID,ss={};Ut=Ut||{};var Pt=[],Et=0;for((rs=rs===void 0&&Qt?Qt.StyleID:rs)===void 0&&St&&(rs=St.StyleID);ht[rs]!==void 0&&(ht[rs].nf&&(Xt=ht[rs].nf),ht[rs].Interior&&Pt.push(ht[rs].Interior),ht[rs].Parent);)rs=ht[rs].Parent;switch(Xe.Type){case"Boolean":ct.t="b",ct.v=Ve(Se);break;case"String":ct.t="s",ct.r=c0(ys(Se)),ct.v=-1<Se.indexOf("<")?ys(Nt||Se).replace(/<.*?>/g,""):ct.r;break;case"DateTime":Se.slice(-1)!="Z"&&(Se+="Z"),ct.v=(Cs(Se)-new Date(Date.UTC(1899,11,30)))/864e5,ct.v!=ct.v?ct.v=ys(Se):ct.v<60&&(ct.v=ct.v-1),Xt&&Xt!="General"||(Xt="yyyy-mm-dd");case"Number":ct.v===void 0&&(ct.v=+Se),ct.t||(ct.t="n");break;case"Error":ct.t="e",ct.v=An[Se],Ut.cellText!==!1&&(ct.w=Se);break;default:Se==""&&Nt==""?ct.t="z":(ct.t="s",ct.v=c0(Nt||Se))}if(Pd(ct,Xt,Ut),Ut.cellFormula!==!1)if(ct.Formula)Xe=ys(ct.Formula),Xe.charCodeAt(0)==61&&(Xe=Xe.slice(1)),ct.f=xo(Xe,Ye),delete ct.Formula,ct.ArrayRange=="RC"?ct.F=xo("RC:RC",Ye):ct.ArrayRange&&(ct.F=xo(ct.ArrayRange,Ye),Gt.push([Fs(ct.F),ct.F]));else for(Et=0;Et<Gt.length;++Et)Ye.r>=Gt[Et][0].s.r&&Ye.r<=Gt[Et][0].e.r&&Ye.c>=Gt[Et][0].s.c&&Ye.c<=Gt[Et][0].e.c&&(ct.F=Gt[Et][1]);Ut.cellStyles&&(Pt.forEach(function(as){!ss.patternType&&as.patternType&&(ss.patternType=as.patternType)}),ct.s=ss),ct.StyleID!==void 0&&(ct.ixfe=ct.StyleID)})(g.slice(z,h.index),Pe,Y,k[k.length-1][0]=="comment"?Mt:I,{c:X,r:ie},Ee,Ot[X],J,wt,u):(Pe="",Y=Fn(h[0]),z=h.index+h[0].length);break;case"cell":if(h[1]==="/")if(0<Ht.length&&(I.c=Ht),(!u.sheetRows||u.sheetRows>ie)&&I.v!==void 0&&(u.dense?(R[ie]||(R[ie]=[]),R[ie][X]=I):R[Er(X)+Br(ie)]=I),I.HRef&&(I.l={Target:ys(I.HRef)},I.HRefScreenTip&&(I.l.Tooltip=I.HRefScreenTip),delete I.HRef,delete I.HRefScreenTip),(I.MergeAcross||I.MergeDown)&&(is=X+(0|parseInt(I.MergeAcross,10)),Ds=ie+(0|parseInt(I.MergeDown,10)),pt.push({s:{c:X,r:ie},e:{c:is,r:Ds}})),u.sheetStubs)if(I.MergeAcross||I.MergeDown){for(var Me=X;Me<=is;++Me)for(var tr=ie;tr<=Ds;++tr)(X<Me||ie<tr)&&(u.dense?(R[tr]||(R[tr]=[]),R[tr][Me]={t:"z"}):R[Er(Me)+Br(tr)]={t:"z"});X=is+1}else++X;else I.MergeAcross?X=is+1:++X;else(X=(I=(function(Se){var Nt={};if(Se.split(/\s+/).length===1)return Nt;var Xe,ct,Ye,ht=Se.match(vu);if(ht)for(Ye=0;Ye!=ht.length;++Ye)(ct=(Xe=ht[Ye].match(wu))[1].indexOf(":"))===-1?Nt[Xe[1]]=Xe[2].slice(1,Xe[2].length-1):Nt[Xe[1].slice(0,6)==="xmlns:"?"xmlns"+Xe[1].slice(6):Xe[1].slice(ct+1)]=Xe[2].slice(1,Xe[2].length-1);return Nt})(h[0])).Index?+I.Index-1:X)<le.s.c&&(le.s.c=X),X>le.e.c&&(le.e.c=X),h[0].slice(-2)==="/>"&&++X,Ht=[];break;case"row":h[1]==="/"||h[0].slice(-2)==="/>"?(ie<le.s.r&&(le.s.r=ie),ie>le.e.r&&(le.e.r=ie),h[0].slice(-2)==="/>"&&(J=Fn(h[0])).Index&&(ie=+J.Index-1),X=0,++ie):((J=Fn(h[0])).Index&&(ie=+J.Index-1),Jt={},J.AutoFitHeight!="0"&&!J.Height||(Jt.hpx=parseInt(J.Height,10),Jt.hpt=mc(Jt.hpx),Yt[ie]=Jt),J.Hidden=="1"&&(Jt.hidden=!0,Yt[ie]=Jt));break;case"worksheet":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"));_.push(q),le.s.r<=le.e.r&&le.s.c<=le.e.c&&(R["!ref"]=Ss(le),u.sheetRows&&u.sheetRows<=le.e.r&&(R["!fullref"]=R["!ref"],le.e.r=u.sheetRows-1,R["!ref"]=Ss(le))),pt.length&&(R["!merges"]=pt),0<Ot.length&&(R["!cols"]=Ot),0<Yt.length&&(R["!rows"]=Yt),T[q]=R}else le={s:{r:2e6,c:2e6},e:{r:0,c:0}},ie=X=0,k.push([h[3],!1]),j=Fn(h[0]),q=ys(j.Name),R=u.dense?[]:{},pt=[],wt=[],Yt=[],Ct={name:q,Hidden:0},$t.Sheets.push(Ct);break;case"table":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else{if(h[0].slice(-2)=="/>")break;k.push([h[3],!1]),_t=!(Ot=[])}break;case"style":h[1]==="/"?(Us=Ee,Os=He,(er=u).cellStyles&&(!Os.Interior||(er=Os.Interior).Pattern&&(er.patternType=Wm[er.Pattern]||er.Pattern)),Us[Os.ID]=Os):He=Fn(h[0]);break;case"numberformat":He.nf=ys(Fn(h[0]).Format||"General"),bn[He.nf]&&(He.nf=bn[He.nf]);for(var qs=0;qs!=392&&V[qs]!=He.nf;++qs);if(qs==392){for(qs=57;qs!=392;++qs)if(V[qs]==null){Or(He.nf,qs);break}}break;case"column":if(k[k.length-1][0]!=="table")break;if((E=Fn(h[0])).Hidden&&(E.hidden=!0,delete E.Hidden),E.Width&&(E.wpx=parseInt(E.Width,10)),!_t&&10<E.wpx){_t=!0,ea=Uh;for(var fa=0;fa<Ot.length;++fa)Ot[fa]&&Tl(Ot[fa])}_t&&Tl(E),Ot[E.Index-1||Ot.length]=E;for(var Ln=0;Ln<+E.Span;++Ln)Ot[Ot.length]=sr(E);break;case"namedrange":if(h[1]==="/")break;$t.Names||($t.Names=[]);var ge=os(h[0]),lt={Name:ge.Name,Ref:xo(ge.RefersTo.slice(1),{r:0,c:0})};0<$t.Sheets.length&&(lt.Sheet=$t.Sheets.length-1),$t.Names.push(lt);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":if(h[0].slice(-2)==="/>")break;h[1]==="/"?Pe+=g.slice(Qe,h.index):Qe=h.index+h[0].length;break;case"interior":if(!u.cellStyles)break;He.Interior=Fn(h[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(h[0].slice(-2)==="/>")break;h[1]==="/"?(Os=xt,ge=Rr,lt=g.slice(kt,h.index),Os[ge=(ro=ro||ni(Nl))[ge]||ge]=lt):kt=h.index+h[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else k.push([h[3],!1]);break;case"comment":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"));(gs=Mt).t=gs.v||"",gs.t=gs.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),gs.v=gs.w=gs.ixfe=void 0,Ht.push(Mt)}else k.push([h[3],!1]),Mt={a:(j=Fn(h[0])).Author};break;case"autofilter":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&(gs=Fn(h[0]),R["!autofilter"]={ref:xo(gs.Range).replace(/\$/g,"")},k.push([h[3],!0]));break;case"name":break;case"datavalidation":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(h[1]==="/"){if((j=k.pop())[0]!==h[3])throw new Error("Bad state: "+j.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break;case"null":break;default:if(k.length==0&&h[3]=="document"||k.length==0&&h[3]=="uof")return Su(g,u);var De=!0;switch(k[k.length-1][0]){case"officedocumentsettings":switch(h[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:De=!1}break;case"componentoptions":switch(h[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:De=!1}break;case"excelworkbook":switch(h[3]){case"date1904":$t.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:De=!1}break;case"workbookoptions":switch(h[3]){case"owcversion":case"height":case"width":break;default:De=!1}break;case"worksheetoptions":switch(h[3]){case"visible":if(h[0].slice(-2)!=="/>")if(h[1]==="/")switch(g.slice(kt,h.index)){case"SheetHidden":Ct.Hidden=1;break;case"SheetVeryHidden":Ct.Hidden=2}else kt=h.index+h[0].length;break;case"header":R["!margins"]||xi(R["!margins"]={},"xlml"),isNaN(+os(h[0]).Margin)||(R["!margins"].header=+os(h[0]).Margin);break;case"footer":R["!margins"]||xi(R["!margins"]={},"xlml"),isNaN(+os(h[0]).Margin)||(R["!margins"].footer=+os(h[0]).Margin);break;case"pagemargins":var tt=os(h[0]);R["!margins"]||xi(R["!margins"]={},"xlml"),isNaN(+tt.Top)||(R["!margins"].top=+tt.Top),isNaN(+tt.Left)||(R["!margins"].left=+tt.Left),isNaN(+tt.Right)||(R["!margins"].right=+tt.Right),isNaN(+tt.Bottom)||(R["!margins"].bottom=+tt.Bottom);break;case"displayrighttoleft":$t.Views||($t.Views=[]),$t.Views[0]||($t.Views[0]={}),$t.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":break;case"nosummaryrowsbelowdetail":R["!outline"]||(R["!outline"]={}),R["!outline"].above=!0;break;case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":R["!outline"]||(R["!outline"]={}),R["!outline"].left=!0;break;case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:De=!1}break;case"pivottable":case"pivotcache":switch(h[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:De=!1}break;case"pagebreaks":switch(h[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:De=!1}break;case"autofilter":switch(h[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:De=!1}break;case"querytable":switch(h[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:De=!1}break;case"datavalidation":switch(h[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:De=!1}break;case"sorting":case"conditionalformatting":switch(h[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:De=!1}break;case"mapinfo":case"schema":case"data":switch(h[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:De=!1}break;case"smarttags":break;default:De=!1}if(De||h[3].match(/!\[CDATA/))break;if(!k[k.length-1][1])throw"Unrecognized tag: "+h[3]+"|"+k.join("|");if(k[k.length-1][0]==="customdocumentproperties"){if(h[0].slice(-2)==="/>")break;h[1]==="/"?(function(Se,Nt,Xe,ct){var Ye=ct;switch((Xe[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":Ye=Ve(ct);break;case"i2":case"int":Ye=parseInt(ct,10);break;case"r4":case"float":Ye=parseFloat(ct);break;case"date":case"dateTime.tz":Ye=Cs(ct);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+Xe[0])}Se[ys(Nt)]=Ye})(at,Rr,Wt,g.slice(kt,h.index)):kt=(Wt=h).index+h[0].length;break}if(u.WTF)throw"Unrecognized tag: "+h[3]+"|"+k.join("|")}return y={},u.bookSheets||u.bookProps||(y.Sheets=T),y.SheetNames=_,y.Workbook=$t,y.SSF=sr(V),y.Props=xt,y.Custprops=at,y}function $a(r,d){switch(Ef(d=d||{}),d.type||"base64"){case"base64":return Id(ke(r),d);case"binary":case"buffer":case"file":return Id(r,d);case"array":return Id(be(r),d)}}function vg(r,d){var u,h,g,b,x,y,j,k=[];return r.Props&&k.push((u=r.Props,h=d,g=[],wr(Nl).map(function(E){for(var T=0;T<_r.length;++T)if(_r[T][1]==E)return _r[T];for(T=0;T<cn.length;++T)if(cn[T][1]==E)return cn[T];throw E}).forEach(function(E){var T;u[E[1]]!=null&&(T=(h&&h.Props&&h.Props[E[1]]!=null?h.Props:u)[E[1]],typeof(T=E[2]==="date"?new Date(T).toISOString().replace(/\.\d*Z/,"Z"):T)=="number"?T=String(T):T===!0||T===!1?T=T?"1":"0":T instanceof Date&&(T=new Date(T).toISOString().replace(/\.\d*Z/,"")),g.push(Hs(Nl[E[1]]||E[1],T)))}),Bt("DocumentProperties",g.join(""),{xmlns:Nr.o}))),r.Custprops&&k.push((b=r.Props,x=r.Custprops,y=["Worksheets","SheetNames"],r="CustomDocumentProperties",j=[],b&&wr(b).forEach(function(E){if(Object.prototype.hasOwnProperty.call(b,E)){for(var T=0;T<_r.length;++T)if(E==_r[T][1])return;for(T=0;T<cn.length;++T)if(E==cn[T][1])return;for(T=0;T<y.length;++T)if(E==y[T])return;var _="string",R=typeof(R=b[E])=="number"?(_="float",String(R)):R===!0||R===!1?(_="boolean",R?"1":"0"):String(R);j.push(Bt(_i(E),R,{"dt:dt":_}))}}),x&&wr(x).forEach(function(E){var T,_;Object.prototype.hasOwnProperty.call(x,E)&&(b&&Object.prototype.hasOwnProperty.call(b,E)||(T="string",_=typeof(_=x[E])=="number"?(T="float",String(_)):_===!0||_===!1?(T="boolean",_?"1":"0"):_ instanceof Date?(T="dateTime.tz",_.toISOString()):String(_),j.push(Bt(_i(E),_,{"dt:dt":T}))))}),"<"+r+' xmlns="'+Nr.o+'">'+j.join("")+"</"+r+">")),k.join("")}function qa(r){return Bt("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+nu(r.Ref,{r:0,c:0})})}function wg(r,d,u,h,g,b,x){if(!r||r.v==null&&r.f==null)return"";var y={};if(r.f&&(y["ss:Formula"]="="+Ys(nu(r.f,x))),r.F&&r.F.slice(0,d.length)==d&&(d=zr(r.F.slice(d.length+1)),y["ss:ArrayRange"]="RC:R"+(d.r==x.r?"":"["+(d.r-x.r)+"]")+"C"+(d.c==x.c?"":"["+(d.c-x.c)+"]")),r.l&&r.l.Target&&(y["ss:HRef"]=Ys(r.l.Target),r.l.Tooltip&&(y["x:HRefScreenTip"]=Ys(r.l.Tooltip))),u["!merges"])for(var j=u["!merges"],k=0;k!=j.length;++k)j[k].s.c==x.c&&j[k].s.r==x.r&&(j[k].e.c>j[k].s.c&&(y["ss:MergeAcross"]=j[k].e.c-j[k].s.c),j[k].e.r>j[k].s.r&&(y["ss:MergeDown"]=j[k].e.r-j[k].s.r));var E="",T="";switch(r.t){case"z":if(!h.sheetStubs)return"";break;case"n":E="Number",T=String(r.v);break;case"b":E="Boolean",T=r.v?"1":"0";break;case"e":E="Error",T=$n[r.v];break;case"d":E="DateTime",T=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||V[14]);break;case"s":E="String",T=((r.v||"")+"").replace(gl,function(_){return ml[_]}).replace(Jc,function(_){return"&#x"+_.charCodeAt(0).toString(16).toUpperCase()+";"})}return u=Gi(h.cellXfs,r,h),y["ss:StyleID"]="s"+(21+u),y["ss:Index"]=x.c+1,u=r.v!=null?T:"",u=r.t=="z"?"":'<Data ss:Type="'+E+'">'+u+"</Data>",0<(r.c||[]).length&&(u+=r.c.map(function(_){var R=Bt("ss:Data",(_.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Bt("Comment",R,{"ss:Author":_.a})}).join("")),Bt("Cell",u,y)}function jg(r,d){if(!r["!ref"])return"";var u=Fs(r["!ref"]),h=r["!merges"]||[],g=0,b=[];r["!cols"]&&r["!cols"].forEach(function(J,ie){Tl(J);var z=!!J.width,X=jc(ie,J),ie={"ss:Index":ie+1};z&&(ie["ss:Width"]=fc(X.width)),J.hidden&&(ie["ss:Hidden"]="1"),b.push(Bt("Column",null,ie))});for(var x,y,j=Array.isArray(r),k=u.s.r;k<=u.e.r;++k){for(var E=[(x=k,y=(r["!rows"]||[])[k],x='<Row ss:Index="'+(x+1)+'"',y&&(y.hpt&&!y.hpx&&(y.hpx=po(y.hpt)),y.hpx&&(x+=' ss:AutoFitHeight="0" ss:Height="'+y.hpx+'"'),y.hidden&&(x+=' ss:Hidden="1"')),x+">")],T=u.s.c;T<=u.e.c;++T){for(var _,R,q,I=!1,g=0;g!=h.length;++g)if(!(h[g].s.c>T||h[g].s.r>k||h[g].e.c<T||h[g].e.r<k)){h[g].s.c==T&&h[g].s.r==k||(I=!0);break}I||(R=bs(_={r:k,c:T}),q=j?(r[k]||[])[T]:r[R],E.push(wg(q,R,r,d,0,0,_)))}E.push("</Row>"),2<E.length&&b.push(E.join(""))}return b.join("")}function e1(r,d,u){var h=[],b=u.SheetNames[r],g=u.Sheets[b],b=g?(function(x,y,j){if(!x||!((j||{}).Workbook||{}).Names)return"";for(var k=j.Workbook.Names,E=[],T=0;T<k.length;++T){var _=k[T];_.Sheet==y&&(_.Name.match(/^_xlfn\./)||E.push(qa(_)))}return E.join("")})(g,r,u):"";return 0<b.length&&h.push("<Names>"+b+"</Names>"),0<(b=g?jg(g,d):"").length&&h.push("<Table>"+b+"</Table>"),h.push((function(x,y,j){if(!x)return"";var k=[];if(x["!margins"]&&(k.push("<PageSetup>"),x["!margins"].header&&k.push(Bt("Header",null,{"x:Margin":x["!margins"].header})),x["!margins"].footer&&k.push(Bt("Footer",null,{"x:Margin":x["!margins"].footer})),k.push(Bt("PageMargins",null,{"x:Bottom":x["!margins"].bottom||"0.75","x:Left":x["!margins"].left||"0.7","x:Right":x["!margins"].right||"0.7","x:Top":x["!margins"].top||"0.75"})),k.push("</PageSetup>")),j&&j.Workbook&&j.Workbook.Sheets&&j.Workbook.Sheets[y])if(j.Workbook.Sheets[y].Hidden)k.push(Bt("Visible",j.Workbook.Sheets[y].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var E=0;E<y&&(!j.Workbook.Sheets[E]||j.Workbook.Sheets[E].Hidden);++E);E==y&&k.push("<Selected/>")}return((((j||{}).Workbook||{}).Views||[])[0]||{}).RTL&&k.push("<DisplayRightToLeft/>"),x["!protect"]&&(k.push(Hs("ProtectContents","True")),x["!protect"].objects&&k.push(Hs("ProtectObjects","True")),x["!protect"].scenarios&&k.push(Hs("ProtectScenarios","True")),x["!protect"].selectLockedCells==null||x["!protect"].selectLockedCells?x["!protect"].selectUnlockedCells==null||x["!protect"].selectUnlockedCells||k.push(Hs("EnableSelection","UnlockedCells")):k.push(Hs("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(T){x["!protect"][T[0]]&&k.push("<"+T[1]+"/>")})),k.length==0?"":Bt("WorksheetOptions",k.join(""),{xmlns:Nr.x})})(g,r,u)),h.join("")}function Il(r,d){d=d||{},r.SSF||(r.SSF=sr(V)),r.SSF&&(ll(),Bo(r.SSF),d.revssf=Ei(r.SSF),d.revssf[r.SSF[65535]]=0,d.ssf=r.SSF,d.cellXfs=[],Gi(d.cellXfs,{},{revssf:{General:0}}));var u=[];u.push(vg(r,d)),u.push(""),u.push(""),u.push("");for(var h,g=0;g<r.SheetNames.length;++g)u.push(Bt("Worksheet",e1(g,d,r),{"ss:Name":Ys(r.SheetNames[g])}));return u[2]=(h=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],d.cellXfs.forEach(function(b,x){var y=[];y.push(Bt("NumberFormat",null,{"ss:Format":Ys(V[b.numFmtId])})),x={"ss:ID":"s"+(21+x)},h.push(Bt("Style",y.join(""),x))}),Bt("Styles",h.join(""))),u[3]=(function(b){if(!((b||{}).Workbook||{}).Names)return"";for(var x=b.Workbook.Names,y=[],j=0;j<x.length;++j){var k=x[j];k.Sheet==null&&(k.Name.match(/^_xlfn\./)||y.push(qa(k)))}return Bt("Names",y.join(""))})(r),jr+Bt("Workbook",u.join(""),{xmlns:Nr.ss,"xmlns:o":Nr.o,"xmlns:x":Nr.x,"xmlns:ss":Nr.ss,"xmlns:dt":Nr.dt,"xmlns:html":Nr.html})}function ju(r){var d={},u=r.content;return u.l=28,d.AnsiUserType=u.read_shift(0,"lpstr-ansi"),d.AnsiClipboardFormat=N0(u,1),u.length-u.l<=4?d:(r=u.read_shift(4),r==0||40<r?d:(u.l-=4,d.Reserved1=u.read_shift(0,"lpstr-ansi"),u.length-u.l<=4||(r=u.read_shift(4))!==1907505652?d:(d.UnicodeClipboardFormat=N0(u,2),(r=u.read_shift(4))==0||40<r?d:(u.l-=4,void(d.Reserved2=u.read_shift(0,"lpwstr"))))))}var yf=[60,1084,2066,2165,2175];function Ya(r,d,u){if(r.t!=="z"&&r.XF){var h,g=0;try{g=r.z||r.XF.numFmtId||0,d.cellNF&&(r.z=V[g])}catch(b){if(d.WTF)throw b}if(!d||d.cellText!==!1)try{r.t==="e"?r.w=r.w||$n[r.v]:g===0||g=="General"?r.t==="n"?(0|r.v)===r.v?r.w=r.v.toString(10):r.w=vt(r.v):r.w=ze(r.v):r.w=Kr(g,r.v,{date1904:!!u,dateNF:d&&d.dateNF})}catch(b){if(d.WTF)throw b}d.cellDates&&g&&r.t=="n"&&dr(V[g]||String(g))&&(h=de(r.v))&&(r.t="d",r.v=new Date(h.y,h.m-1,h.d,h.H,h.M,h.S,h.u))}}function Bd(r,d,u){return{v:r,ixfe:d,t:u}}function Ng(r,d){var u={opts:{}},h={};function g(Ye){return!(Ye<8)&&Ye<64&&Ee[Ye-8]||ec[Ye]}function b(Ye,ht,St){if(!(1<_t||St.sheetRows&&Ye.r>=St.sheetRows)){var Qt,Gt,Ut;if(St.cellStyles&&ht.XF&&ht.XF.data&&(Gt=St,(Ut=(Qt=ht).XF.data)&&Ut.patternType&&Gt&&Gt.cellStyles&&(Qt.s={},Qt.s.patternType=Ut.patternType,(Gt=hc(g(Ut.icvFore)))&&(Qt.s.fgColor={rgb:Gt}),(Gt=hc(g(Ut.icvBack)))&&(Qt.s.bgColor={rgb:Gt}))),delete ht.ixfe,delete ht.XF,z=bs(x=Ye),R&&R.s&&R.e||(R={s:{r:0,c:0},e:{r:0,c:0}}),Ye.r<R.s.r&&(R.s.r=Ye.r),Ye.c<R.s.c&&(R.s.c=Ye.c),Ye.r+1>R.e.r&&(R.e.r=Ye.r+1),Ye.c+1>R.e.c&&(R.e.c=Ye.c+1),St.cellFormula&&ht.f){for(var Xt=0;Xt<ie.length;++Xt)if(!(ie[Xt][0].s.c>Ye.c||ie[Xt][0].s.r>Ye.r||ie[Xt][0].e.c<Ye.c||ie[Xt][0].e.r<Ye.r)){ht.F=Ss(ie[Xt][0]),ie[Xt][0].s.c==Ye.c&&ie[Xt][0].s.r==Ye.r||delete ht.f,ht.f&&(ht.f=""+Oa(ie[Xt][1],0,Ye,Ht,Qe));break}}St.dense?(T[Ye.r]||(T[Ye.r]=[]),T[Ye.r][Ye.c]=ht):T[z]=ht}}var x,y,j,k,E,T=d.dense?[]:{},_={},R={},q=null,I=[],J="",Y={},z="",X={},ie=[],le=[],Ee=[],He={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Pe={},Qe={enc:!1,sbcch:0,snames:[],sharedf:X,arrayf:ie,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!d&&!!d.cellStyles,WTF:!!d&&!!d.wtf};d.password&&(Qe.password=d.password);var pt=[],xt=[],at=[],kt=[],Wt=!1,Ht=[];Ht.SheetNames=Qe.snames,Ht.sharedf=Qe.sharedf,Ht.arrayf=Qe.arrayf,Ht.names=[],Ht.XTI=[];var Mt,Ot=0,_t=0,wt=0,Yt=[],Jt=[];Qe.codepage=1200,D(1200);for(var is=!1;r.l<r.length-1;){var Ds=r.l,$t=r.read_shift(2);if($t===0&&Ot===10)break;var Ct=r.l===r.length?0:r.read_shift(2),gs=vf[$t];if(gs&&gs.f){if(d.bookSheets&&Ot===133&&$t!==133)break;if(Ot=$t,gs.r===2||gs.r==12){var Us=r.read_shift(2);if(Ct-=2,!Qe.enc&&Us!==$t&&((255&Us)<<8|Us>>8)!==$t)throw new Error("rt mismatch: "+Us+"!="+$t);gs.r==12&&(r.l+=10,Ct-=10)}var Os,er,Rr,Me={},Me=$t===10?gs.f(r,Ct,Qe):(function(Ye,ht,St,Qt,Gt){var Ut=Qt,Xt=[],rs=St.slice(St.l,St.l+Ut);if(Gt&&Gt.enc&&Gt.enc.insitu&&0<rs.length)switch(Ye){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:Gt.enc.insitu(rs)}Xt.push(rs),St.l+=Ut;for(var ss=Mi(St,St.l),Pt=vf[ss],Et=0;Pt!=null&&-1<yf.indexOf(ss);)Ut=Mi(St,St.l+2),Et=St.l+4,ss==2066?Et+=4:ss!=2165&&ss!=2175||(Et+=12),rs=St.slice(Et,St.l+4+Ut),Xt.push(rs),St.l+=4+Ut,Pt=vf[ss=Mi(St,St.l)];var as=he(Xt);Na(as,0);var qt=0;as.lens=[];for(var Ft=0;Ft<Xt.length;++Ft)as.lens.push(qt),qt+=Xt[Ft].length;if(as.length<Qt)throw"XLS Record 0x"+Ye.toString(16)+" Truncated: "+as.length+" < "+Qt;return ht.f(as,as.length,Gt)})($t,gs,r,Ct,Qe);if(_t!=0||[9,521,1033,2057].indexOf(Ot)!==-1)switch($t){case 34:u.opts.Date1904=He.WBProps.date1904=Me;break;case 134:u.opts.WriteProtect=!0;break;case 47:if(Qe.enc||(r.l=0),Qe.enc=Me,!d.password)throw new Error("File is password-protected");if(Me.valid==null)throw new Error("Encryption scheme unsupported");if(!Me.valid)throw new Error("Password is incorrect");break;case 92:Qe.lastuser=Me;break;case 66:var tr=Number(Me);switch(tr){case 21010:tr=1200;break;case 32768:tr=1e4;break;case 32769:tr=1252}D(Qe.codepage=tr),is=!0;break;case 317:Qe.rrtabid=Me;break;case 25:Qe.winlocked=Me;break;case 439:u.opts.RefreshAll=Me;break;case 12:u.opts.CalcCount=Me;break;case 16:u.opts.CalcDelta=Me;break;case 17:u.opts.CalcIter=Me;break;case 13:u.opts.CalcMode=Me;break;case 14:u.opts.CalcPrecision=Me;break;case 95:u.opts.CalcSaveRecalc=Me;break;case 15:Qe.CalcRefMode=Me;break;case 2211:u.opts.FullCalc=Me;break;case 129:Me.fDialog&&(T["!type"]="dialog"),Me.fBelow||((T["!outline"]||(T["!outline"]={})).above=!0),Me.fRight||((T["!outline"]||(T["!outline"]={})).left=!0);break;case 224:le.push(Me);break;case 430:Ht.push([Me]),Ht[Ht.length-1].XTI=[];break;case 35:case 547:Ht[Ht.length-1].push(Me);break;case 24:case 536:Mt={Name:Me.Name,Ref:Oa(Me.rgce,0,null,Ht,Qe)},0<Me.itab&&(Mt.Sheet=Me.itab-1),Ht.names.push(Mt),Ht[0]||(Ht[0]=[],Ht[0].XTI=[]),Ht[Ht.length-1].push(Me),Me.Name=="_xlnm._FilterDatabase"&&0<Me.itab&&Me.rgce&&Me.rgce[0]&&Me.rgce[0][0]&&Me.rgce[0][0][0]=="PtgArea3d"&&(Jt[Me.itab-1]={ref:Ss(Me.rgce[0][0][1][2])});break;case 22:Qe.ExternCount=Me;break;case 23:Ht.length==0&&(Ht[0]=[],Ht[0].XTI=[]),Ht[Ht.length-1].XTI=Ht[Ht.length-1].XTI.concat(Me),Ht.XTI=Ht.XTI.concat(Me);break;case 2196:if(Qe.biff<8)break;Mt!=null&&(Mt.Comment=Me[1]);break;case 18:T["!protect"]=Me;break;case 19:Me!==0&&Qe.WTF&&console.error("Password verifier: "+Me);break;case 133:_[Me.pos]=Me,Qe.snames.push(Me.name);break;case 10:if(--_t)break;R.e&&(0<R.e.r&&0<R.e.c&&(R.e.r--,R.e.c--,T["!ref"]=Ss(R),d.sheetRows&&d.sheetRows<=R.e.r&&(qs=R.e.r,R.e.r=d.sheetRows-1,T["!fullref"]=T["!ref"],T["!ref"]=Ss(R),R.e.r=qs),R.e.r++,R.e.c++),0<pt.length&&(T["!merges"]=pt),0<xt.length&&(T["!objects"]=xt),0<at.length&&(T["!cols"]=at),0<kt.length&&(T["!rows"]=kt),He.Sheets.push(Pe)),J===""?Y=T:h[J]=T,T=d.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(Qe.biff===8&&(Qe.biff={9:2,521:3,1033:4}[$t]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Me.BIFFVer]||8),Qe.biffguess=Me.BIFFVer==0,Me.BIFFVer==0&&Me.dt==4096&&(Qe.biff=5,is=!0,D(Qe.codepage=28591)),Qe.biff==8&&Me.BIFFVer==0&&Me.dt==16&&(Qe.biff=2),_t++)break;var qs,T=d.dense?[]:{};Qe.biff<8&&!is&&(is=!0,D(Qe.codepage=d.codepage||1252)),Qe.biff<5||Me.BIFFVer==0&&Me.dt==4096?(J===""&&(J="Sheet1"),R={s:{r:0,c:0},e:{r:0,c:0}},qs={pos:r.l-Ct,name:J},_[qs.pos]=qs,Qe.snames.push(J)):J=(_[Ds]||{name:""}).name,Me.dt==32&&(T["!type"]="chart"),Me.dt==64&&(T["!type"]="macro"),pt=[],xt=[],Qe.arrayf=ie=[],at=[],Wt=!(kt=[]),Pe={Hidden:(_[Ds]||{hs:0}).hs,name:J};break;case 515:case 3:case 2:T["!type"]=="chart"&&(d.dense?(T[Me.r]||[])[Me.c]:T[bs({c:Me.c,r:Me.r})])&&++Me.c,ge={ixfe:Me.ixfe,XF:le[Me.ixfe]||{},v:Me.val,t:"n"},0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ya(ge,d,u.opts.Date1904),b({c:Me.c,r:Me.r},ge,d);break;case 5:case 517:ge={ixfe:Me.ixfe,XF:le[Me.ixfe],v:Me.val,t:Me.t},0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ya(ge,d,u.opts.Date1904),b({c:Me.c,r:Me.r},ge,d);break;case 638:ge={ixfe:Me.ixfe,XF:le[Me.ixfe],v:Me.rknum,t:"n"},0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ya(ge,d,u.opts.Date1904),b({c:Me.c,r:Me.r},ge,d);break;case 189:for(var fa=Me.c;fa<=Me.C;++fa){var Ln=Me.rkrec[fa-Me.c][0],ge={ixfe:Ln,XF:le[Ln],v:Me.rkrec[fa-Me.c][1],t:"n"};0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ya(ge,d,u.opts.Date1904),b({c:fa,r:Me.r},ge,d)}break;case 6:case 518:case 1030:if(Me.val=="String"){q=Me;break}(ge=Bd(Me.val,Me.cell.ixfe,Me.tt)).XF=le[ge.ixfe],d.cellFormula&&(!((lt=Me.formula)&&lt[0]&&lt[0][0]&&lt[0][0][0]=="PtgExp")||X[Rr=bs({r:Os=lt[0][0][1][0],c:er=lt[0][0][1][1]})]?ge.f=""+Oa(Me.formula,0,Me.cell,Ht,Qe):ge.F=((d.dense?(T[Os]||[])[er]:T[Rr])||{}).F),0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ya(ge,d,u.opts.Date1904),b(Me.cell,ge,d),q=Me;break;case 7:case 519:if(!q)throw new Error("String record expects Formula");(ge=Bd(q.val=Me,q.cell.ixfe,"s")).XF=le[ge.ixfe],d.cellFormula&&(ge.f=""+Oa(q.formula,0,q.cell,Ht,Qe)),0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ya(ge,d,u.opts.Date1904),b(q.cell,ge,d),q=null;break;case 33:case 545:ie.push(Me);var lt=bs(Me[0].s),De=d.dense?(T[Me[0].s.r]||[])[Me[0].s.c]:T[lt];if(d.cellFormula&&De){if(!q||!lt||!De)break;De.f=""+Oa(Me[1],0,Me[0],Ht,Qe),De.F=Ss(Me[0])}break;case 1212:if(!d.cellFormula)break;if(z){if(!q)break;X[bs(q.cell)]=Me[0],((De=d.dense?(T[q.cell.r]||[])[q.cell.c]:T[bs(q.cell)])||{}).f=""+Oa(Me[0],0,x,Ht,Qe)}break;case 253:ge=Bd(I[Me.isst].t,Me.ixfe,"s"),I[Me.isst].h&&(ge.h=I[Me.isst].h),ge.XF=le[ge.ixfe],0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ya(ge,d,u.opts.Date1904),b({c:Me.c,r:Me.r},ge,d);break;case 513:d.sheetStubs&&(ge={ixfe:Me.ixfe,XF:le[Me.ixfe],t:"z"},0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ya(ge,d,u.opts.Date1904),b({c:Me.c,r:Me.r},ge,d));break;case 190:if(d.sheetStubs)for(var tt=Me.c;tt<=Me.C;++tt){var Se=Me.ixfe[tt-Me.c];ge={ixfe:Se,XF:le[Se],t:"z"},0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ya(ge,d,u.opts.Date1904),b({c:tt,r:Me.r},ge,d)}break;case 214:case 516:case 4:(ge=Bd(Me.val,Me.ixfe,"s")).XF=le[ge.ixfe],0<wt&&(ge.z=Yt[ge.ixfe>>8&63]),Ya(ge,d,u.opts.Date1904),b({c:Me.c,r:Me.r},ge,d);break;case 0:case 512:_t===1&&(R=Me);break;case 252:I=Me;break;case 1054:if(Qe.biff==4){Yt[wt++]=Me[1];for(var Nt=0;Nt<wt+163&&V[Nt]!=Me[1];++Nt);163<=Nt&&Or(Me[1],wt+163)}else Or(Me[1],Me[0]);break;case 30:Yt[wt++]=Me;for(var Xe=0;Xe<wt+163&&V[Xe]!=Me;++Xe);163<=Xe&&Or(Me,wt+163);break;case 229:pt=pt.concat(Me);break;case 93:xt[Me.cmo[0]]=Qe.lastobj=Me;break;case 438:Qe.lastobj.TxO=Me;break;case 127:Qe.lastobj.ImData=Me;break;case 440:for(j=Me[0].s.r;j<=Me[0].e.r;++j)for(y=Me[0].s.c;y<=Me[0].e.c;++y)(De=d.dense?(T[j]||[])[y]:T[bs({c:y,r:j})])&&(De.l=Me[1]);break;case 2048:for(j=Me[0].s.r;j<=Me[0].e.r;++j)for(y=Me[0].s.c;y<=Me[0].e.c;++y)(De=d.dense?(T[j]||[])[y]:T[bs({c:y,r:j})])&&De.l&&(De.l.Tooltip=Me[1]);break;case 28:if(Qe.biff<=5&&2<=Qe.biff)break;De=d.dense?(T[Me[0].r]||[])[Me[0].c]:T[bs(Me[0])];var ct=xt[Me[2]];De||(De=d.dense?(T[Me[0].r]||(T[Me[0].r]=[]),T[Me[0].r][Me[0].c]={t:"z"}):T[bs(Me[0])]={t:"z"},R.e.r=Math.max(R.e.r,Me[0].r),R.s.r=Math.min(R.s.r,Me[0].r),R.e.c=Math.max(R.e.c,Me[0].c),R.s.c=Math.min(R.s.c,Me[0].c)),De.c||(De.c=[]),ct={a:Me[1],t:ct.TxO.t},De.c.push(ct);break;case 2173:le[Me.ixfe],Me.ext.forEach(function(ht){ht[0]});break;case 125:if(!Qe.cellStyles)break;for(;Me.e>=Me.s;)at[Me.e--]={width:Me.w/256,level:Me.level||0,hidden:!!(1&Me.flags)},Wt||(Wt=!0,jd(Me.w/256)),Tl(at[Me.e+1]);break;case 520:ct={},Me.level!=null&&((kt[Me.r]=ct).level=Me.level),Me.hidden&&((kt[Me.r]=ct).hidden=!0),Me.hpt&&((kt[Me.r]=ct).hpt=Me.hpt,ct.hpx=po(Me.hpt));break;case 38:case 39:case 40:case 41:T["!margins"]||xi(T["!margins"]={}),T["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[$t]]=Me;break;case 161:T["!margins"]||xi(T["!margins"]={}),T["!margins"].header=Me.header,T["!margins"].footer=Me.footer;break;case 574:Me.RTL&&(He.Views[0].RTL=!0);break;case 146:Ee=Me;break;case 2198:E=Me;break;case 140:k=Me;break;case 442:J?Pe.CodeName=Me||Pe.name:He.WBProps.CodeName=Me||"ThisWorkbook"}}else gs||console.error("Missing Info for XLS Record 0x"+$t.toString(16)),r.l+=Ct}return u.SheetNames=wr(_).sort(function(Ye,ht){return Number(Ye)-Number(ht)}).map(function(Ye){return _[Ye].name}),d.bookSheets||(u.Sheets=h),!u.SheetNames.length&&Y["!ref"]?(u.SheetNames.push("Sheet1"),u.Sheets&&(u.Sheets.Sheet1=Y)):u.Preamble=Y,u.Sheets&&Jt.forEach(function(Ye,ht){u.Sheets[u.SheetNames[ht]]["!autofilter"]=Ye}),u.Strings=I,u.SSF=sr(V),Qe.enc&&(u.Encryption=Qe.enc),E&&(u.Themes=E),u.Metadata={},k!==void 0&&(u.Metadata.Country=k),0<Ht.names.length&&(He.Names=Ht.names),u.Workbook=He,u}var Ec={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function zd(r,d){var u,h,g,b,x;if(Ef(d=d||{}),L(),d.codepage&&S(d.codepage),r.FullPaths){if(Tt.find(r,"/encryption"))throw new Error("File is password-protected");u=Tt.find(r,"!CompObj"),g=Tt.find(r,"/Workbook")||Tt.find(r,"/Book")}else{switch(d.type){case"base64":r=ue(ke(r));break;case"binary":r=ue(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r))}Na(r,0),g={content:r}}if(u&&ju(u),d.bookProps&&!d.bookSheets)h={};else{var y=xe?"buffer":"array";if(g&&g.content)h=Ng(g.content,d);else if((g=Tt.find(r,"PerfectOffice_MAIN"))&&g.content)h=ua.to_workbook(g.content,(d.type=y,d));else{if(!(g=Tt.find(r,"NativeContent_MAIN"))||!g.content)throw(g=Tt.find(r,"MN0"))&&g.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");h=ua.to_workbook(g.content,(d.type=y,d))}d.bookVBA&&r.FullPaths&&Tt.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(h.vbaraw=(b=r,x=Tt.utils.cfb_new({root:"R"}),b.FullPaths.forEach(function(j,k){j.slice(-1)!=="/"&&j.match(/_VBA_PROJECT_CUR/)&&(j=j.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),Tt.utils.cfb_add(x,j,b.FileIndex[k].content))}),Tt.write(x)))}return y={},r.FullPaths&&(function(j,k,E){var T=Tt.find(j,"/!DocumentSummaryInformation");if(T&&0<T.size)try{var _,R=kr(T,xh,Ec.DSI);for(_ in R)k[_]=R[_]}catch(Y){if(E.WTF)throw Y}var q=Tt.find(j,"/!SummaryInformation");if(q&&0<q.size)try{var I,J=kr(q,bh,Ec.SI);for(I in J)k[I]==null&&(k[I]=J[I])}catch(Y){if(E.WTF)throw Y}k.HeadingPairs&&k.TitlesOfParts&&(vh(k.HeadingPairs,k.TitlesOfParts,k,E),delete k.HeadingPairs,delete k.TitlesOfParts)})(r,y,d),h.Props=h.Custprops=y,d.bookFiles&&(h.cfb=r),h}function Nu(r,b){var u,h,g=b||{},b=Tt.utils.cfb_new({root:"R"}),x="/Workbook";switch(g.bookType||"xls"){case"xls":g.bookType="biff8";case"xla":g.bookType||(g.bookType="xla");case"biff8":x="/Workbook",g.biff=8;break;case"biff5":x="/Book",g.biff=5;break;default:throw new Error("invalid type "+g.bookType+" for XLS CFB")}return Tt.utils.cfb_add(b,x,wf(r,g)),g.biff==8&&(r.Props||r.Custprops)&&(function(y,j){var k,E=[],T=[],_=[],R=0,q=Ai(xh,"n"),I=Ai(bh,"n");if(y.Props)for(k=wr(y.Props),R=0;R<k.length;++R)(Object.prototype.hasOwnProperty.call(q,k[R])?E:Object.prototype.hasOwnProperty.call(I,k[R])?T:_).push([k[R],y.Props[k[R]]]);if(y.Custprops)for(k=wr(y.Custprops),R=0;R<k.length;++R)Object.prototype.hasOwnProperty.call(y.Props||{},k[R])||(Object.prototype.hasOwnProperty.call(q,k[R])?E:Object.prototype.hasOwnProperty.call(I,k[R])?T:_).push([k[R],y.Custprops[k[R]]]);for(var J=[],R=0;R<_.length;++R)-1<wh.indexOf(_[R][0])||-1<E0.indexOf(_[R][0])||_[R][1]!=null&&J.push(_[R]);T.length&&Tt.utils.cfb_add(j,"/SummaryInformation",Vs(T,Ec.SI,I,bh)),(E.length||J.length)&&Tt.utils.cfb_add(j,"/DocumentSummaryInformation",Vs(E,Ec.DSI,q,xh,J.length?J:null,Ec.UDI))})(r,b),g.biff==8&&r.vbaraw&&(u=b,(h=Tt.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})).FullPaths.forEach(function(y,j){j==0||(y=y.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)!=="/"&&Tt.utils.cfb_add(u,y,h.FileIndex[j].content)})),b}var jo={0:{f:function(r,d){var u={},h=r.l+d;u.r=r.read_shift(4),r.l+=4;var g=r.read_shift(2);return r.l+=1,d=r.read_shift(1),r.l=h,7&d&&(u.level=7&d),16&d&&(u.hidden=!0),32&d&&(u.hpt=g/20),u}},1:{f:function(r){return[Cn(r)]}},2:{f:function(r){return[Cn(r),mh(r),"n"]}},3:{f:function(r){return[Cn(r),r.read_shift(1),"e"]}},4:{f:function(r){return[Cn(r),r.read_shift(1),"b"]}},5:{f:function(r){return[Cn(r),ka(r),"n"]}},6:{f:function(r){return[Cn(r),pa(r),"str"]}},7:{f:function(r){return[Cn(r),r.read_shift(4),"s"]}},8:{f:function(r,d,u){var h=r.l+d,g=Cn(r);g.r=u["!row"];var b=[g,pa(r),"str"];return u.cellFormula?(r.l+=2,d=du(r,h-r.l,u),b[3]=Oa(d,0,g,u.supbooks,u)):r.l=h,b}},9:{f:function(r,d,u){var h=r.l+d,g=Cn(r);g.r=u["!row"];var b=[g,ka(r),"n"];return u.cellFormula?(r.l+=2,d=du(r,h-r.l,u),b[3]=Oa(d,0,g,u.supbooks,u)):r.l=h,b}},10:{f:function(r,d,u){var h=r.l+d,g=Cn(r);g.r=u["!row"];var b=[g,r.read_shift(1),"b"];return u.cellFormula?(r.l+=2,d=du(r,h-r.l,u),b[3]=Oa(d,0,g,u.supbooks,u)):r.l=h,b}},11:{f:function(r,d,u){var h=r.l+d,g=Cn(r);g.r=u["!row"];var b=[g,r.read_shift(1),"e"];return u.cellFormula?(r.l+=2,d=du(r,h-r.l,u),b[3]=Oa(d,0,g,u.supbooks,u)):r.l=h,b}},12:{f:function(r){return[Jl(r)]}},13:{f:function(r){return[Jl(r),mh(r),"n"]}},14:{f:function(r){return[Jl(r),r.read_shift(1),"e"]}},15:{f:function(r){return[Jl(r),r.read_shift(1),"b"]}},16:{f:kc},17:{f:function(r){return[Jl(r),pa(r),"str"]}},18:{f:function(r){return[Jl(r),r.read_shift(4),"s"]}},19:{f:y0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(r,x,y){var h=r.l+x;r.l+=4,r.l+=1;var g=r.read_shift(4),b=km(r),x=cg(r,0,y),y=v0(r);return r.l=h,x={Name:b,Ptg:x},g<268435455&&(x.Sheet=g),y&&(x.Comment=y),x}},40:{},42:{},43:{f:function(r,d,u){var h={};h.sz=r.read_shift(2)/20;var g,b=(b=(g=r).read_shift(1),g.l++,{fBold:1&b,fItalic:2&b,fUnderline:4&b,fStrikeout:8&b,fOutline:16&b,fShadow:32&b,fCondense:64&b,fExtend:128&b});switch(b.fItalic&&(h.italic=1),b.fCondense&&(h.condense=1),b.fExtend&&(h.extend=1),b.fShadow&&(h.shadow=1),b.fOutline&&(h.outline=1),b.fStrikeout&&(h.strike=1),r.read_shift(2)===700&&(h.bold=1),r.read_shift(2)){case 1:h.vertAlign="superscript";break;case 2:h.vertAlign="subscript"}switch((b=r.read_shift(1))!=0&&(h.underline=b),0<(b=r.read_shift(1))&&(h.family=b),0<(b=r.read_shift(1))&&(h.charset=b),r.l++,h.color=(function(x){var y={},j=x.read_shift(1)>>>1,k=x.read_shift(1),E=x.read_shift(2,"i"),T=x.read_shift(1),_=x.read_shift(1),R=x.read_shift(1);switch(x.l++,j){case 0:y.auto=1;break;case 1:y.index=k;var q=ec[k];q&&(y.rgb=hc(q));break;case 2:y.rgb=hc([T,_,R]);break;case 3:y.theme=k}return E!=0&&(y.tint=0<E?E/32767:E/32768),y})(r),r.read_shift(1)){case 1:h.scheme="major";break;case 2:h.scheme="minor"}return h.name=pa(r),h}},44:{f:function(r,d){return[r.read_shift(2),pa(r)]}},45:{f:Ym},46:{f:ii},47:{f:function(r,g){var u=r.l+g,h=r.read_shift(2),g=r.read_shift(2);return r.l=u,{ixfe:h,numFmtId:g}}},48:{},49:{f:function(r){return r.read_shift(4,"i")}},50:{},51:{f:function(r){for(var d=[],u=r.read_shift(4);0<u--;)d.push([r.read_shift(4),r.read_shift(4)]);return d}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:O0},62:{f:function(r){return[Cn(r),y0(r),"is"]}},63:{f:function(r){var d={};d.i=r.read_shift(4);var u={};return u.r=r.read_shift(4),u.c=r.read_shift(4),d.r=bs(u),2&(r=r.read_shift(1))&&(d.l="1"),8&r&&(d.a="1"),d}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Fa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(r){var d=r.read_shift(2);return r.l+=28,{RTL:32&d}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(r,d){var u={},h=r[r.l];return++r.l,u.above=!(64&h),u.left=!(128&h),r.l+=18,u.name=on(r),u}},148:{f:Ld,p:16},151:{f:function(){}},152:{},153:{f:function(r,d){var u={},h=r.read_shift(4);return u.defaultThemeVersion=r.read_shift(4),0<(r=8<d?pa(r):"").length&&(u.CodeName=r),u.autoCompressPictures=!!(65536&h),u.backupFile=!!(64&h),u.checkCompatibility=!!(4096&h),u.date1904=!!(1&h),u.filterPrivacy=!!(8&h),u.hidePivotFieldList=!!(1024&h),u.promptedSolutions=!!(16&h),u.publishItems=!!(2048&h),u.refreshAllConnections=!!(262144&h),u.saveExternalLinkValues=!!(128&h),u.showBorderUnselectedTables=!!(4&h),u.showInkAnnotation=!!(32&h),u.showObjects=["all","placeholders","none"][h>>13&3],u.showPivotChartFilter=!!(32768&h),u.updateLinks=["userSet","never","always"][h>>8&3],u}},154:{},155:{},156:{f:function(r,d){var u={};return u.Hidden=r.read_shift(4),u.iTabID=r.read_shift(4),u.strRelID=w0(r),u.name=pa(r),u}},157:{},158:{},159:{T:1,f:function(r){return[r.read_shift(4),r.read_shift(4)]}},160:{T:-1},161:{T:1,f:Wn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:vi},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(r,d){return{flags:r.read_shift(4),version:r.read_shift(4),name:pa(r)}}},336:{T:-1},337:{f:function(r){return r.l+=4,r.read_shift(4)!=0},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:w0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:R0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(r,b,u){var h=r.l+b,g=j0(r),b=r.read_shift(1);return(g=[g])[2]=b,u.cellFormula?(u=Kp(r,h-r.l,u),g[1]=u):r.l=h,g}},427:{f:function(r,g,u){var h=r.l+g,g=[Wn(r)];return u.cellFormula&&(u=Fd(r,h-r.l,u),g[1]=u),r.l=h,g}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(r){var d={};return xf.forEach(function(u){d[u]=ka(r)}),d}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(r,y){var u=r.l+y,h=Wn(r),g=v0(r),b=pa(r),x=pa(r),y=pa(r);return r.l=u,y={rfx:h,relId:g,loc:b,display:y},x&&(y.Tooltip=x),y}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:w0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Gl},633:{T:1},634:{T:-1},635:{T:1,f:function(r){var d={};d.iauthor=r.read_shift(4);var u=Wn(r);return d.rfx=u.s,d.ref=bs(u.s),r.l+=16,d}},636:{T:-1},637:{f:Nm},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(r,d){return r.l+=10,{name:pa(r)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},vf={6:{f:bc},10:{f:za},12:{f:xr},13:{f:xr},14:{f:Zs},15:{f:Zs},16:{f:ka},17:{f:Zs},18:{f:Zs},19:{f:xr},20:{f:kh},21:{f:kh},23:{f:R0},24:{f:Sl},25:{f:Zs},26:{},27:{},28:{f:function(r,d,u){return(function(h,g){if(!(g.biff<8)){var b=h.read_shift(2),x=h.read_shift(2),y=h.read_shift(2),j=h.read_shift(2),k=Bi(h,0,g);return g.biff<8&&h.read_shift(1),[{r:b,c:x},k,j,y]}})(r,u)}},29:{},34:{f:Zs},35:{f:Fm},38:{f:ka},39:{f:ka},40:{f:ka},41:{f:ka},42:{f:Zs},43:{f:Zs},47:{f:function(r,d,u){var h={Type:8<=u.biff?r.read_shift(2):0};return h.Type?Hm(r,d-2,h):(d=r,u.biff,r=u,u=h,d={key:xr(d),verificationBytes:xr(d)},r.password&&(d.verifier=G0(r.password)),u.valid=d.verificationBytes===d.verifier,u.valid&&(u.insitu=Um(r.password))),h}},49:{f:function(r,d,u){var h={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(u&&u.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10}return h.name=Yn(r,0,u),h}},51:{f:xr},60:{},61:{f:function(r){return{Pos:[r.read_shift(2),r.read_shift(2)],Dim:[r.read_shift(2),r.read_shift(2)],Flags:r.read_shift(2),CurTab:r.read_shift(2),FirstTab:r.read_shift(2),Selected:r.read_shift(2),TabRatio:r.read_shift(2)}}},64:{f:Zs},65:{f:function(){}},66:{f:xr},77:{},80:{},81:{},82:{},85:{f:xr},89:{},90:{},91:{},92:{f:function(r,d,g){if(g.enc)return r.l+=d,"";var h=r.l,g=Bi(r,0,g);return r.read_shift(d+h-r.l),g}},93:{f:function(r,d,u){return u&&u.biff<8?(function(h,g,b){h.l+=4;var x=h.read_shift(2),y=h.read_shift(2),j=h.read_shift(2);h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=6,g-=36;var k=[];return k.push((Lm[x]||Fa)(h,g,b)),{cmo:[y,x,j],ft:k}})(r,d,u):{cmo:u=Tm(r),ft:(function(h,g){for(var b=h.l+g,x=[];h.l<b;){var y=h.read_shift(2);h.l-=2;try{x.push(na[y](h,b-h.l))}catch{return h.l=b,x}}return h.l!=b&&(h.l=b),x})(r,d-22,u[1])}}},94:{},95:{f:Zs},96:{},97:{},99:{f:Zs},125:{f:O0},128:{f:function(r){if(r.l+=4,(r=[r.read_shift(2),r.read_shift(2)])[0]!==0&&r[0]--,r[1]!==0&&r[1]--,7<r[0]||7<r[1])throw new Error("Bad Gutters: "+r.join("|"));return r}},129:{f:function(r,d,u){return{fDialog:16&(d=u&&u.biff==8||d==2?r.read_shift(2):(r.l+=d,0)),fBelow:64&d,fRight:128&d}}},130:{f:xr},131:{f:Zs},132:{f:Zs},133:{f:function(r,d,u){var h=r.read_shift(4),g=3&r.read_shift(1),b=r.read_shift(1);switch(b){case 0:b="Worksheet";break;case 1:b="Macrosheet";break;case 2:b="Chartsheet";break;case 6:b="VBAModule"}return u=Yn(r,0,u),{pos:h,hs:g,dt:b,name:u=u.length===0?"Sheet1":u}}},134:{},140:{f:function(r){var d=[0,0],u=r.read_shift(2);return d[0]=Sm[u]||u,u=r.read_shift(2),d[1]=Sm[u]||u,d}},141:{f:xr},144:{},146:{f:function(r){for(var d=r.read_shift(2),u=[];0<d--;)u.push(M0(r));return u}},151:{},152:{},153:{},154:{},155:{},156:{f:xr},157:{},158:{},160:{f:I0},161:{f:function(r,d){var u={};return d<32||(r.l+=16,u.header=ka(r),u.footer=ka(r),r.l+=2),u}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(r,d){for(var u=r.l+d-2,h=r.read_shift(2),g=r.read_shift(2),b=[];r.l<u;)b.push(Cl(r));if(r.l!==u)throw new Error("MulRK read error");if(d=r.read_shift(2),b.length!=d-g+1)throw new Error("MulRK length mismatch");return{r:h,c:g,C:d,rkrec:b}}},190:{f:function(r,d){for(var u=r.l+d-2,h=r.read_shift(2),g=r.read_shift(2),b=[];r.l<u;)b.push(r.read_shift(2));if(r.l!==u)throw new Error("MulBlank read error");if(d=r.read_shift(2),b.length!=d-g+1)throw new Error("MulBlank length mismatch");return{r:h,c:g,C:d,ixfe:b}}},193:{f:za},197:{},198:{},199:{},200:{},201:{},202:{f:Zs},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:xr},220:{},221:{f:Zs},222:{},224:{f:function(r,d,u){var h,g,b,x={};return x.ifnt=r.read_shift(2),x.numFmtId=r.read_shift(2),x.flags=r.read_shift(2),x.fStyle=x.flags>>2&1,d-=6,x.data=(h=r,x.fStyle,g=u,b={},d=h.read_shift(4),r=h.read_shift(4),u=h.read_shift(4),h=h.read_shift(2),b.patternType=Am[u>>26],g.cellStyles&&(b.alc=7&d,b.fWrap=d>>3&1,b.alcV=d>>4&7,b.fJustLast=d>>7&1,b.trot=d>>8&255,b.cIndent=d>>16&15,b.fShrinkToFit=d>>20&1,b.iReadOrder=d>>22&2,b.fAtrNum=d>>26&1,b.fAtrFnt=d>>27&1,b.fAtrAlc=d>>28&1,b.fAtrBdr=d>>29&1,b.fAtrPat=d>>30&1,b.fAtrProt=d>>31&1,b.dgLeft=15&r,b.dgRight=r>>4&15,b.dgTop=r>>8&15,b.dgBottom=r>>12&15,b.icvLeft=r>>16&127,b.icvRight=r>>23&127,b.grbitDiag=r>>30&3,b.icvTop=127&u,b.icvBottom=u>>7&127,b.icvDiag=u>>14&127,b.dgDiag=u>>21&15,b.icvFore=127&h,b.icvBack=h>>7&127,b.fsxButton=h>>14&1),b),x}},225:{f:function(r,d){return d===0||r.read_shift(2),1200}},226:{f:za},227:{},229:{f:function(r,d){for(var u=[],h=r.read_shift(2);h--;)u.push(aa(r));return u}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(r,d){for(var u=r.l+d,d=r.read_shift(4),h=r.read_shift(4),g=[],b=0;b!=h&&r.l<u;++b)g.push((function(y){var j=m;m=1200;var k,E=y.read_shift(2),T=4&(I=y.read_shift(1)),_=8&I,R=1+(1&I),q=0,I={};return _&&(q=y.read_shift(2)),T&&(k=y.read_shift(4)),R=R==2?"dbcs-cont":"sbcs-cont",R=E===0?"":y.read_shift(E,R),_&&(y.l+=4*q),T&&(y.l+=k),I.t=R,_||(I.raw="<t>"+I.t+"</t>",I.r=I.t),m=j,I})(r));return g.Count=d,g.Unique=h,g}},253:{f:function(r){var d=Ua(r);return d.isst=r.read_shift(4),d}},255:{f:function(r,d){var u={};return u.dsst=r.read_shift(2),r.l+=d-2,u}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:jh},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Zs},353:{f:za},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(r,b,u){var h=r.l+b,g=r.read_shift(2),b=r.read_shift(2);if((u.sbcch=b)==1025||b==14849)return[b,g];if(b<1||255<b)throw new Error("Unexpected SupBook type: "+b);for(var u=Pi(r,b),x=[];h>r.l;)x.push(Ii(r));return[b,g,u,x]}},431:{f:Zs},432:{},433:{},434:{},437:{},438:{f:function(r,d,u){var h=r.l,g="";try{r.l+=4;var b=(u.lastobj||{cmo:[0,0]}).cmo[1];[0,5,7,11,12,14].indexOf(b)==-1?r.l+=6:(function(k){var E=k.read_shift(1);k.l++;var T=k.read_shift(2);k.l+=2})(r);var x=r.read_shift(2);r.read_shift(2),xr(r),b=r.read_shift(2),r.l+=b;for(var y=1;y<r.lens.length-1;++y){if(r.l-h!=r.lens[y])throw new Error("TxO: bad continue record");var j=r[r.l];if((g+=Pi(r,r.lens[y+1]-r.lens[y]-1)).length>=(j?x:2*x))break}if(g.length!==x&&g.length!==2*x)throw new Error("cchText: "+x+" != "+g.length);return r.l=h+d,{t:g}}catch{return r.l=h+d,{t:g}}}},439:{f:Zs},440:{f:function(r,d){var u=aa(r);return r.l+=16,[u,(function(h,g){var b=h.l+g;if((T=h.read_shift(4))!==2)throw new Error("Unrecognized streamVersion: "+T);g=h.read_shift(2),h.l+=2;var x,y,j,k,E,T="";16&g&&(x=Gn(h,h.l)),128&g&&(y=Gn(h,h.l)),(257&g)==257&&(j=Gn(h,h.l)),(257&g)==1&&(_=zi(h,h.l)),8&g&&(T=Gn(h,h.l)),32&g&&(k=h.read_shift(16)),64&g&&(E=sc(h)),h.l=b;var _=y||j||_||"";return _&&T&&(_+="#"+T),_=_||"#"+T,_={Target:_=2&g&&_.charAt(0)=="/"&&_.charAt(1)!="/"?"file://"+_:_},k&&(_.guid=k),E&&(_.time=E),x&&(_.Tooltip=x),_})(r,d-24)]}},441:{},442:{f:Ii},443:{},444:{f:xr},445:{},446:{},448:{f:za},449:{f:function(r){return r.read_shift(2),r.read_shift(4)},r:2},450:{f:za},512:{f:io},513:{f:P0},515:{f:function(r,d,u){return u.biffguess&&u.biff==2&&(u.biff=5),u=Ua(r),r=ka(r),u.val=r,u}},516:{f:function(r,d,u){return u.biffguess&&u.biff==2&&(u.biff=5),r.l,d=Ua(r),u.biff==2&&r.l++,u=Ii(r,r.l,u),d.val=u,d}},517:{f:_m},519:{f:If},520:{f:function(r){var d={};d.r=r.read_shift(2),d.c=r.read_shift(2),d.cnt=r.read_shift(2)-d.c;var u=r.read_shift(2);r.l+=4;var h=r.read_shift(1);return r.l+=3,7&h&&(d.level=7&h),32&h&&(d.hidden=!0),64&h&&(d.hpt=u/20),d}},523:{},545:{f:cd},549:{f:L0},566:{},574:{f:function(r,d,u){return u&&2<=u.biff&&u.biff<5?{}:{RTL:64&r.read_shift(2)}}},638:{f:function(h){var d=h.read_shift(2),u=h.read_shift(2),h=Cl(h);return{r:d,c:u,ixfe:h[0],rknum:h[1]}}},659:{},1048:{},1054:{f:function(r,d,u){return[r.read_shift(2),Bi(r,0,u)]}},1084:{},1212:{f:function(r,d,u){var h=Nh(r);r.l++;var g=r.read_shift(1);return[(function(b,x,y){var j,k=b.l+x,E=b.read_shift(2),T=Td(b,E,y);return E==65535?[[],Fa(b,x-2)]:(x!==E+2&&(j=yo(b,k-E-2,T,y)),[T,j])})(r,d-=8,u),g,h]}},2048:{f:function(r,d){return r.read_shift(2),[aa(r),r.read_shift((d-10)/2,"dbcs-cont").replace(ye,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ac},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:za},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(r){r.l+=2;var d={cxfs:0,crc:0};return d.cxfs=r.read_shift(2),d.crc=r.read_shift(4),d},r:12},2173:{f:function(r,d){r.l,r.l+=2,d=r.read_shift(2),r.l+=2;for(var u=r.read_shift(2),h=[];0<u--;)h.push(rg(r,r.l));return{ixfe:d,ext:h}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Zs,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(r,d,u){if(!(u.biff<8)){var h=r.read_shift(2),g=r.read_shift(2);return[Pi(r,h,u),Pi(r,g,u)]}r.l+=d},r:12},2197:{},2198:{f:function(r,d,u){var h=r.l+d;if(r.read_shift(4)!==124226)if(u.cellStyles){var g,b=r.slice(r.l);r.l=h;try{g=hl(b,{type:"array"})}catch{return}if(d=Ar(g,"theme/theme/theme1.xml",!0),d)return _l(d,u)}else r.l=h},r:12},2199:{},2200:{},2201:{},2202:{f:function(r){return[r.read_shift(4)!==0,r.read_shift(4)!==0,r.read_shift(4)]},r:12},2203:{f:za},2204:{},2205:{},2206:{},2207:{},2211:{f:function(r){var d,u,h=(u=(d=r).read_shift(2),h=d.read_shift(2),d.l+=8,{type:u});if(h.type!=2211)throw new Error("Invalid Future Record "+h.type);return r.read_shift(4)!==0}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:xr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(r,d,u){var h={area:!1};return u.biff!=5?r.l+=d:(d=r.read_shift(1),r.l+=3,16&d&&(h.area=!0)),h}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(r){for(var d=r.read_shift(2),u=[];0<d--;)u.push(M0(r));return u}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:io},1:{},2:{f:function(r){var d=Ua(r);return++r.l,r=r.read_shift(2),d.t="n",d.val=r,d}},3:{f:function(r){var d=Ua(r);return++r.l,r=ka(r),d.t="n",d.val=r,d}},4:{f:function(r,d,u){u.biffguess&&u.biff==5&&(u.biff=2);var h=Ua(r);return++r.l,u=Bi(r,0,u),h.t="str",h.val=u,h}},5:{f:_m},7:{f:function(r){var d=r.read_shift(1);return d===0?(r.l++,""):r.read_shift(d,"sbcs-cont")}},8:{},9:{f:ac},11:{},22:{f:xr},30:{f:Bl},31:{},32:{},33:{f:cd},36:{},37:{f:L0},50:{f:function(r,d){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=d-13}},62:{},52:{},67:{},68:{f:xr},69:{},86:{},126:{},127:{f:function(r){var d=r.read_shift(2),h=r.read_shift(2),u=r.read_shift(4),h={fmt:d,env:h,len:u,data:r.slice(r.l,r.l+u)};return r.l+=u,h}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(r,b,x){var h=r.l+b,g=Ua(r),b=r.read_shift(2),x=Pi(r,b,x);return r.l=h,g.t="str",g.val=x,g}},223:{},234:{},354:{},421:{},518:{f:bc},521:{f:ac},536:{f:Sl},547:{f:Fm},561:{},579:{},1030:{f:bc},1033:{f:ac},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function zt(r,d,u,h){var g=d;isNaN(g)||(d=h||(u||[]).length||0,(h=r.next(4)).write_shift(2,g),h.write_shift(2,d),0<d&&dh(u)&&r.push(u))}function Ud(r,d,u){return(r=r||mt(7)).write_shift(2,d),r.write_shift(2,u),r.write_shift(2,0),r.write_shift(1,0),r}function kg(r,d,u,h){if(d.v!=null)switch(d.t){case"d":case"n":var g=d.t=="d"?Sr(Cs(d.v)):d.v;return void(g==(0|g)&&0<=g&&g<65536?zt(r,2,(E=u,T=h,_=g,Ud(R=mt(9),E,T),R.write_shift(2,_),R)):zt(r,3,(_=u,R=h,g=g,Ud(k=mt(15),_,R),k.write_shift(8,g,"f"),k)));case"b":case"e":return void zt(r,5,(k=u,b=h,x=d.v,y=d.t,Ud(j=mt(9),k,b),ao(x,y||"b",j),j));case"s":case"str":return void zt(r,4,(b=u,x=h,y=(d.v||"").slice(0,255),Ud(j=mt(8+2*y.length),b,x),j.write_shift(1,y.length),j.write_shift(y.length,y,"sbcs"),j.l<j.length?j.slice(0,j.l):j))}var b,x,y,j,k,E,T,_,R;zt(r,1,Ud(null,u,h))}function Cg(r,d){for(var u=d||{},d=Ma(),h=0,g=0;g<r.SheetNames.length;++g)r.SheetNames[g]==u.sheet&&(h=g);if(h==0&&u.sheet&&r.SheetNames[0]!=u.sheet)throw new Error("Sheet not found: "+u.sheet);return zt(d,u.biff==4?1033:u.biff==3?521:9,no(0,16,u)),(function(b,x,y){var j,k,E=Array.isArray(x),T=Fs(x["!ref"]||"A1"),_=[];if(255<T.e.c||16383<T.e.r){if(y.WTF)throw new Error("Range "+(x["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,16383),j=Ss(T)}for(var R=T.s.r;R<=T.e.r;++R){k=Br(R);for(var q=T.s.c;q<=T.e.c;++q){R===T.s.r&&(_[q]=Er(q)),j=_[q]+k;var I=E?(x[R]||[])[q]:x[j];I&&kg(b,I,R,q)}}})(d,r.Sheets[r.SheetNames[h]],u),zt(d,10),d.end()}function Dc(r,d,u){var h,g;zt(r,49,(g=(h={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(r=mt((u=(r=u)&&r.biff==5)?15+g.length:16+2*g.length)).write_shift(2,20*(h.sz||12)),r.write_shift(4,0),r.write_shift(2,400),r.write_shift(4,0),r.write_shift(2,0),r.write_shift(1,g.length),u||r.write_shift(1,1),r.write_shift((u?1:2)*g.length,g,u?"sbcs":"utf16le"),r))}function ku(r,d,u){d&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g,b,x,y,j=h[0];j<=h[1];++j)d[j]!=null&&zt(r,1054,(g=j,b=d[j],y=void 0,x=(x=u)&&x.biff==5,(y=y||mt(x?3+b.length:5+2*b.length)).write_shift(2,g),y.write_shift(x?1:2,b.length),x||y.write_shift(1,1),y.write_shift((x?1:2)*b.length,b,x?"sbcs":"utf16le"),(y=y.length>y.l?y.slice(0,y.l):y).l==null&&(y.l=y.length),y))})}function Sg(r,d){for(var u=0;u<d["!links"].length;++u){var h=d["!links"][u];zt(r,440,nc(h)),h[1].Tooltip&&zt(r,2048,(function(g){var b=g[1].Tooltip,x=mt(10+2*(b.length+1));x.write_shift(2,2048),g=zr(g[0]),x.write_shift(2,g.r),x.write_shift(2,g.r),x.write_shift(2,g.c),x.write_shift(2,g.c);for(var y=0;y<b.length;++y)x.write_shift(2,b.charCodeAt(y));return x.write_shift(2,0),x})(h))}delete d["!links"]}function Ag(r,d){var u;d&&(u=0,d.forEach(function(h,g){var b;++u<=256&&h&&zt(r,125,(b=jc(g,h),h=g,(g=mt(12)).write_shift(2,h),g.write_shift(2,h),g.write_shift(2,256*b.width),g.write_shift(2,0),h=0,b.hidden&&(h|=1),g.write_shift(1,h),h=b.level||0,g.write_shift(1,h),g.write_shift(2,0),g))}))}function Eg(r,d,u,h,g){var b,x,y,j,k,E,T,_,R,q,I,J=16+Gi(g.cellXfs,d,g);if(d.v!=null||d.bf)if(d.bf)zt(r,6,_d(d,u,h,0,J));else switch(d.t){case"d":case"n":var Y=d.t=="d"?Sr(Cs(d.v)):d.v;zt(r,515,(E=u,T=h,_=Y,R=J,q=mt(14),mi(E,T,R,q),Sn(_,q),q));break;case"b":case"e":zt(r,517,(Y=u,E=h,T=d.v,R=J,_=d.t,q=mt(8),mi(Y,E,R,q),ao(T,_,q),q));break;case"s":case"str":g.bookSST?(I=Md(g.Strings,d.v,g.revStrings),zt(r,253,(b=u,x=h,y=I,j=J,k=mt(10),mi(b,x,j,k),k.write_shift(4,y),k))):zt(r,516,(I=u,b=h,x=(d.v||"").slice(0,255),j=J,y=mt(+(k=!(y=g)||y.biff==8)+8+(1+k)*x.length),mi(I,b,j,y),y.write_shift(2,x.length),k&&y.write_shift(1,1),y.write_shift((1+k)*x.length,x,k?"utf16le":"sbcs"),y));break;default:zt(r,513,mi(u,h,J))}else zt(r,513,mi(u,h,J))}function Dg(r,d,u){var h,g,b=Ma(),X=u.SheetNames[r],x=u.Sheets[X]||{},y=(u||{}).Workbook||{},j=(y.Sheets||[])[r]||{},k=Array.isArray(x),E=d.biff==8,T=[],_=Fs(x["!ref"]||"A1"),R=E?65536:16384;if(255<_.e.c||_.e.r>=R){if(d.WTF)throw new Error("Range "+(x["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,R-1)}zt(b,2057,no(0,16,d)),zt(b,13,fn(1)),zt(b,12,fn(100)),zt(b,15,Ca(!0)),zt(b,17,Ca(!1)),zt(b,16,Sn(.001)),zt(b,95,Ca(!0)),zt(b,42,Ca(!1)),zt(b,43,Ca(!1)),zt(b,130,fn(1)),zt(b,128,(u=[0,0],(r=mt(8)).write_shift(4,0),r.write_shift(2,u[0]?u[0]+1:0),r.write_shift(2,u[1]?u[1]+1:0),r)),zt(b,131,Ca(!1)),zt(b,132,Ca(!1)),E&&Ag(b,x["!cols"]),zt(b,512,(R=_,(u=mt(2*(r=(u=d).biff!=8&&u.biff?2:4)+6)).write_shift(r,R.s.r),u.write_shift(r,R.e.r+1),u.write_shift(2,R.s.c),u.write_shift(2,R.e.c+1),u.write_shift(2,0),u)),E&&(x["!links"]=[]);for(var q=_.s.r;q<=_.e.r;++q){g=Br(q);for(var I=_.s.c;I<=_.e.c;++I){q===_.s.r&&(T[I]=Er(I)),h=T[I]+g;var J=k?(x[q]||[])[I]:x[h];J&&(Eg(b,J,q,I,d),E&&J.l&&x["!links"].push([h,J.l]))}}var Y,z,X=j.CodeName||j.name||X;return E&&zt(b,574,(y=(y.Views||[])[0],z=mt(18),Y=1718,y&&y.RTL&&(Y|=64),z.write_shift(2,Y),z.write_shift(4,0),z.write_shift(4,64),z.write_shift(4,0),z.write_shift(4,0),z)),E&&(x["!merges"]||[]).length&&zt(b,229,(function(ie){var le=mt(2+8*ie.length);le.write_shift(2,ie.length);for(var Ee=0;Ee<ie.length;++Ee)ld(ie[Ee],le);return le})(x["!merges"])),E&&Sg(b,x),zt(b,442,kl(X)),E&&(Y=b,z=x,(X=mt(19)).write_shift(4,2151),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,3),X.write_shift(1,1),X.write_shift(4,0),zt(Y,2151,X),(X=mt(39)).write_shift(4,2152),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,3),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(2,1),X.write_shift(4,4),X.write_shift(2,0),ld(Fs(z["!ref"]||"A1"),X),X.write_shift(4,4),zt(Y,2152,X)),zt(b,10),b.end()}function Tg(r,d,u){var h=Ma(),y=(r||{}).Workbook||{},g=y.Sheets||[],b=y.WBProps||{},x=u.biff==8,y=u.biff==5;zt(h,2057,no(0,5,u)),u.bookType=="xla"&&zt(h,135),zt(h,225,x?fn(1200):null),zt(h,193,(function(Y,z){z=z||mt(Y);for(var X=0;X<Y;++X)z.write_shift(1,0);return z})(2)),y&&zt(h,191),y&&zt(h,192),zt(h,226),zt(h,92,(function(Y){var z=!Y||Y.biff==8,X=mt(z?112:54);for(X.write_shift(Y.biff==8?2:1,7),z&&X.write_shift(1,0),X.write_shift(4,859007059),X.write_shift(4,5458548|(z?0:536870912));X.l<X.length;)X.write_shift(1,z?0:32);return X})(u)),zt(h,66,fn(x?1200:1252)),x&&zt(h,353,fn(0)),x&&zt(h,448),zt(h,317,(function(Y){for(var z=mt(2*Y),X=0;X<Y;++X)z.write_shift(2,X+1);return z})(r.SheetNames.length)),x&&r.vbaraw&&zt(h,211),x&&r.vbaraw&&zt(h,442,kl(b.CodeName||"ThisWorkbook")),zt(h,156,fn(17)),zt(h,25,Ca(!1)),zt(h,18,Ca(!1)),zt(h,19,fn(0)),x&&zt(h,431,Ca(!1)),x&&zt(h,444,fn(0)),zt(h,61,((y=mt(18)).write_shift(2,0),y.write_shift(2,0),y.write_shift(2,29280),y.write_shift(2,17600),y.write_shift(2,56),y.write_shift(2,0),y.write_shift(2,0),y.write_shift(2,1),y.write_shift(2,500),y)),zt(h,64,Ca(!1)),zt(h,141,fn(0)),zt(h,34,Ca(((b=r).Workbook&&b.Workbook.WBProps&&Ve(b.Workbook.WBProps.date1904)?"true":"false")=="true")),zt(h,14,Ca(!0)),x&&zt(h,439,Ca(!1)),zt(h,218,fn(0)),Dc(h,0,u),ku(h,r.SSF,u),(function(Y,z){for(var X=0;X<16;++X)zt(Y,224,lo({numFmtId:0,style:!0},0,z));z.cellXfs.forEach(function(ie){zt(Y,224,lo(ie,0,z))})})(h,u),x&&zt(h,352,Ca(!1)),y=h.end(),b=Ma(),x&&zt(b,140,((J=J||mt(4)).write_shift(2,1),J.write_shift(2,1),J)),x&&u.Strings&&(function(Y,z,X){var ie=(X||[]).length||0;if(ie<=8224)return zt(Y,z,X,ie);if(!isNaN(z)){for(var le=X.parts||[],Ee=0,He=0,Pe=0;Pe+(le[Ee]||8224)<=8224;)Pe+=le[Ee]||8224,Ee++;var Qe=Y.next(4);for(Qe.write_shift(2,z),Qe.write_shift(2,Pe),Y.push(X.slice(He,He+Pe)),He+=Pe;He<ie;){for((Qe=Y.next(4)).write_shift(2,60),Pe=0;Pe+(le[Ee]||8224)<=8224;)Pe+=le[Ee]||8224,Ee++;Qe.write_shift(2,Pe),Y.push(X.slice(He,He+Pe)),He+=Pe}}})(b,252,od(u.Strings)),zt(b,10);for(var h=b.end(),j=Ma(),k=0,E=0,E=0;E<r.SheetNames.length;++E)k+=(x?12:11)+(x?2:1)*r.SheetNames[E].length;var T,_,R,q,I=y.length+k+h.length;for(E=0;E<r.SheetNames.length;++E)zt(j,133,(T={pos:I,hs:(g[E]||{}).Hidden||0,dt:0,name:r.SheetNames[E]},q=R=void 0,R=!(_=u)||8<=_.biff?2:1,(q=mt(8+R*T.name.length)).write_shift(4,T.pos),q.write_shift(1,T.hs||0),q.write_shift(1,T.dt),q.write_shift(1,T.name.length),8<=_.biff&&q.write_shift(1,1),q.write_shift(R*T.name.length,T.name,_.biff<8?"sbcs":"utf16le"),(_=q.slice(0,q.l)).l=q.l,_)),I+=d[E].length;var J=j.end();if(k!=J.length)throw new Error("BS8 "+k+" != "+J.length);return b=[],y.length&&b.push(y),J.length&&b.push(J),h.length&&b.push(h),he(b)}function wf(r,d){for(var u=0;u<=r.SheetNames.length;++u){var h=r.Sheets[r.SheetNames[u]];h&&h["!ref"]&&255<La(h["!ref"]).e.c&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[u]+"' extends beyond column IV (255).  Data may be lost.")}var g=d||{};switch(g.biff||2){case 8:case 5:return(function(b,x){var y=x||{},j=[];b&&!b.SSF&&(b.SSF=sr(V)),b&&b.SSF&&(ll(),Bo(b.SSF),y.revssf=Ei(b.SSF),y.revssf[b.SSF[65535]]=0,y.ssf=b.SSF),y.Strings=[],y.Strings.Count=0,y.Strings.Unique=0,Mu(y),y.cellXfs=[],Gi(y.cellXfs,{},{revssf:{General:0}}),b.Props||(b.Props={});for(var k=0;k<b.SheetNames.length;++k)j[j.length]=Dg(k,y,b);return j.unshift(Tg(b,j,y)),he(j)})(r,d);case 4:case 3:case 2:return Cg(r,d)}throw new Error("invalid type "+g.bookType+" for BIFF")}function Hd(r,d){var u=d||{},h=u.dense?[]:{},g=(r=r.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!g)throw new Error("Invalid HTML: could not find <table>");for(var b,d=r.match(/<\/table/i),_=g.index,x=d&&d.index||r.length,y=Nn(r.slice(_,x),/(:?<tr[^>]*>)/i,"<tr>"),j=-1,k=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},T=[],_=0;_<y.length;++_){var R=y[_].trim(),q=R.slice(0,3).toLowerCase();if(q!="<tr"){if(q=="<td"||q=="<th")for(var I=R.split(/<\/t[dh]>/i),x=0;x<I.length;++x){var J=I[x].trim();if(J.match(/<t[dh]/i)){for(var Y=J,z=0;Y.charAt(0)=="<"&&-1<(z=Y.indexOf(">"));)Y=Y.slice(z+1);for(var X=0;X<T.length;++X){var ie=T[X];ie.s.c==k&&ie.s.r<j&&j<=ie.e.r&&(k=ie.e.c+1,X=-1)}var le=os(J.slice(0,J.indexOf(">"))),Ee=le.colspan?+le.colspan:1;(1<(b=+le.rowspan)||1<Ee)&&T.push({s:{r:j,c:k},e:{r:j+(b||1)-1,c:k+Ee-1}}),J=le.t||le["data-t"]||"",Y.length&&(Y=It(Y),E.s.r>j&&(E.s.r=j),E.e.r<j&&(E.e.r=j),E.s.c>k&&(E.s.c=k),E.e.c<k&&(E.e.c=k),Y.length&&(le={t:"s",v:Y},u.raw||!Y.trim().length||J=="s"||(Y==="TRUE"?le={t:"b",v:!0}:Y==="FALSE"?le={t:"b",v:!1}:isNaN(nn(Y))?isNaN(Xr(Y).getDate())||(le={t:"d",v:Cs(Y)},(le=u.cellDates?le:{t:"n",v:Sr(le.v)}).z=u.dateNF||V[14]):le={t:"n",v:nn(Y)}),u.dense?(h[j]||(h[j]=[]),h[j][k]=le):h[bs({r:j,c:k})]=le)),k+=Ee}}}else{if(++j,u.sheetRows&&u.sheetRows<=j){--j;break}k=0}}return h["!ref"]=Ss(E),T.length&&(h["!merges"]=T),h}function jf(r,d,u,h){for(var g=r["!merges"]||[],b=[],x=d.s.c;x<=d.e.c;++x){for(var y,j,k,E,T=0,_=0,R=0;R<g.length;++R)if(!(g[R].s.r>u||g[R].s.c>x||g[R].e.r<u||g[R].e.c<x)){if(g[R].s.r<u||g[R].s.c<x){T=-1;break}T=g[R].e.r-g[R].s.r+1,_=g[R].e.c-g[R].s.c+1;break}T<0||(y=bs({r:u,c:x}),k=(j=h.dense?(r[u]||[])[x]:r[y])&&j.v!=null&&(j.h||$o(j.w||(ci(j),j.w)||""))||"",E={},1<T&&(E.rowspan=T),1<_&&(E.colspan=_),h.editable?k='<span contenteditable="true">'+k+"</span>":j&&(E["data-t"]=j&&j.t||"z",j.v!=null&&(E["data-v"]=j.v),j.z!=null&&(E["data-z"]=j.z),j.l&&(j.l.Target||"#").charAt(0)!="#"&&(k='<a href="'+j.l.Target+'">'+k+"</a>")),E.id=(h.id||"sjs")+"-"+y,b.push(Bt("td",k,E)))}return"<tr>"+b.join("")+"</tr>"}var Nf='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',lr="</body></html>";function Cu(r,d,u){return[].join("")+"<table"+(u&&u.id?' id="'+u.id+'"':"")+">"}function _g(r,g){var u=g||{},h=u.header!=null?u.header:Nf,g=u.footer!=null?u.footer:lr,b=[h],x=La(r["!ref"]);u.dense=Array.isArray(r),b.push(Cu(0,0,u));for(var y=x.s.r;y<=x.e.r;++y)b.push(jf(r,x,y,u));return b.push("</table>"+g),b.join("")}function kf(r,d,u){var h=u||{},g=0,b=0;h.origin!=null&&(typeof h.origin=="number"?g=h.origin:(g=(u=typeof h.origin=="string"?zr(h.origin):h.origin).r,b=u.c));var x=d.getElementsByTagName("tr"),y=Math.min(h.sheetRows||1e7,x.length),j={s:{r:0,c:0},e:{r:g,c:b}};r["!ref"]&&(d=La(r["!ref"]),j.s.r=Math.min(j.s.r,d.s.r),j.s.c=Math.min(j.s.c,d.s.c),j.e.r=Math.max(j.e.r,d.e.r),j.e.c=Math.max(j.e.c,d.e.c),g==-1&&(j.e.r=g=d.e.r+1));var k,E,T=[],_=0,R=r["!rows"]||(r["!rows"]=[]),q=0,I=0,J=0,Y=0;for(r["!cols"]||(r["!cols"]=[]);q<x.length&&I<y;++q){var z=x[q];if(Mg(z)){if(h.display)continue;R[I]={hidden:!0}}for(var X=z.children,J=Y=0;J<X.length;++J){var ie=X[J];if(!h.display||!Mg(ie)){for(var le=ie.hasAttribute("data-v")?ie.getAttribute("data-v"):ie.hasAttribute("v")?ie.getAttribute("v"):It(ie.innerHTML),Ee=ie.getAttribute("data-z")||ie.getAttribute("z"),_=0;_<T.length;++_){var He=T[_];He.s.c==Y+b&&He.s.r<I+g&&I+g<=He.e.r&&(Y=He.e.c+1-b,_=-1)}E=+ie.getAttribute("colspan")||1,(1<(k=+ie.getAttribute("rowspan")||1)||1<E)&&T.push({s:{r:I+g,c:Y+b},e:{r:I+g+(k||1)-1,c:Y+b+(E||1)-1}});var Pe={t:"s",v:le},Qe=ie.getAttribute("data-t")||ie.getAttribute("t")||"";le!=null&&(le.length==0?Pe.t=Qe||"z":h.raw||le.trim().length==0||Qe=="s"||(le==="TRUE"?Pe={t:"b",v:!0}:le==="FALSE"?Pe={t:"b",v:!1}:isNaN(nn(le))?isNaN(Xr(le).getDate())||(Pe={t:"d",v:Cs(le)},(Pe=h.cellDates?Pe:{t:"n",v:Sr(Pe.v)}).z=h.dateNF||V[14]):Pe={t:"n",v:nn(le)})),Pe.z===void 0&&Ee!=null&&(Pe.z=Ee);var pt="",xt=ie.getElementsByTagName("A");if(xt&&xt.length)for(var at=0;at<xt.length&&(!xt[at].hasAttribute("href")||(pt=xt[at].getAttribute("href")).charAt(0)=="#");++at);pt&&pt.charAt(0)!="#"&&(Pe.l={Target:pt}),h.dense?(r[I+g]||(r[I+g]=[]),r[I+g][Y+b]=Pe):r[bs({c:Y+b,r:I+g})]=Pe,j.e.c<Y+b&&(j.e.c=Y+b),Y+=E}}++I}return T.length&&(r["!merges"]=(r["!merges"]||[]).concat(T)),j.e.r=Math.max(j.e.r,I-1+g),r["!ref"]=Ss(j),y<=I&&(r["!fullref"]=Ss((j.e.r=x.length-q+I-1+g,j))),r}function Fg(r,d){return kf((d||{}).dense?[]:{},r,d)}function Mg(r){var u,d="",u=(u=r).ownerDocument.defaultView&&typeof u.ownerDocument.defaultView.getComputedStyle=="function"?u.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null;return(d=(d=u?u(r).getPropertyValue("display"):d)||r.style&&r.style.display)==="none"}var Lg={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Vd(r,d){var u=d||{},h,g,b,x,y,j=d0(r),k=[],E={name:""},T="",_=0,R={},q=[],I=u.dense?[]:{},J={value:""},Y="",z=0,X=[],ie=-1,le=-1,Ee={s:{r:1e6,c:1e7},e:{r:0,c:0}},He=0,Pe={},Qe=[],pt={},xt=[],at=1,kt=1,Wt=[],Ht={Names:[]},Mt={},Ot=["",""],_t=[],wt={},Yt="",Jt=0,is=!1,Ds=!1,$t=0;for(pl.lastIndex=0,j=j.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=pl.exec(j);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(Ee.e.c>=Ee.s.c&&Ee.e.r>=Ee.s.r?I["!ref"]=Ss(Ee):I["!ref"]="A1:A1",0<u.sheetRows&&u.sheetRows<=Ee.e.r&&(I["!fullref"]=I["!ref"],Ee.e.r=u.sheetRows-1,I["!ref"]=Ss(Ee)),Qe.length&&(I["!merges"]=Qe),xt.length&&(I["!rows"]=xt),b.name=b.||b.name,typeof JSON<"u"&&JSON.stringify(b),q.push(b.name),R[b.name]=I,Ds=!1):x[0].charAt(x[0].length-2)!=="/"&&(b=os(x[0],!1),ie=le=-1,Ee.s.r=Ee.s.c=1e7,Ee.e.r=Ee.e.c=0,I=u.dense?[]:{},Qe=[],xt=[],Ds=!0);break;case"table-row-group":x[1]==="/"?--He:++He;break;case"table-row":case"":if(x[1]==="/"){ie+=at,at=1;break}if((Ct=os(x[0],!1)).?ie=Ct.-1:ie==-1&&(ie=0),(at=+Ct["number-rows-repeated"]||1)<10)for($t=0;$t<at;++$t)0<He&&(xt[ie+$t]={level:He});le=-1;break;case"covered-table-cell":x[1]!=="/"&&++le,u.sheetStubs&&(u.dense?(I[ie]||(I[ie]=[]),I[ie][le]={t:"z"}):I[bs({r:ie,c:le})]={t:"z"}),Y="",X=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++le,J=os(x[0],!1),kt=parseInt(J["number-columns-repeated"]||"1",10),y={t:"z",v:null},J.formula&&u.cellFormula!=0&&(y.f=yc(ys(J.formula))),(J.||J["value-type"])=="string"&&(y.t="s",y.v=ys(J["string-value"]||""),u.dense?(I[ie]||(I[ie]=[]),I[ie][le]=y):I[bs({r:ie,c:le})]=y),le+=kt-1;else if(x[1]!=="/"){Y="",z=0,X=[],kt=1;var Ct=at?ie+at-1:ie;if(++le>Ee.e.c&&(Ee.e.c=le),le<Ee.s.c&&(Ee.s.c=le),ie<Ee.s.r&&(Ee.s.r=ie),Ct>Ee.e.r&&(Ee.e.r=Ct),_t=[],wt={},y={t:(J=os(x[0],!1)).||J["value-type"],v:null},u.cellFormula)if(J.formula&&(J.formula=ys(J.formula)),J["number-matrix-columns-spanned"]&&J["number-matrix-rows-spanned"]&&(pt={s:{r:ie,c:le},e:{r:ie+(parseInt(J["number-matrix-rows-spanned"],10)||0)-1,c:le+(parseInt(J["number-matrix-columns-spanned"],10)||0)-1}},y.F=Ss(pt),Wt.push([pt,y.F])),J.formula)y.f=yc(J.formula);else for($t=0;$t<Wt.length;++$t)ie>=Wt[$t][0].s.r&&ie<=Wt[$t][0].e.r&&le>=Wt[$t][0].s.c&&le<=Wt[$t][0].e.c&&(y.F=Wt[$t][1]);switch((J["number-columns-spanned"]||J["number-rows-spanned"])&&(pt={s:{r:ie,c:le},e:{r:ie+(parseInt(J["number-rows-spanned"],10)||0)-1,c:le+(parseInt(J["number-columns-spanned"],10)||0)-1}},Qe.push(pt)),J["number-columns-repeated"]&&(kt=parseInt(J["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Ve(J["boolean-value"]);break;case"float":case"percentage":case"currency":y.t="n",y.v=parseFloat(J.value);break;case"date":y.t="d",y.v=Cs(J["date-value"]),u.cellDates||(y.t="n",y.v=Sr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=(function(Os){var er=0,Rr=0,Me=!1,tr=Os.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!tr)throw new Error("|"+Os+"| is not an ISO8601 Duration");for(var qs=1;qs!=tr.length;++qs)if(tr[qs]){switch(Rr=1,3<qs&&(Me=!0),tr[qs].slice(tr[qs].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+tr[qs].slice(tr[qs].length-1));case"D":Rr*=24;case"H":Rr*=60;case"M":if(!Me)throw new Error("Unsupported ISO Duration Field: M");Rr*=60}er+=Rr*parseInt(tr[qs],10)}return er})(J["time-value"])/86400,u.cellDates&&(y.t="d",y.v=wn(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(J.);break;default:if(y.t!=="string"&&y.t!=="text"&&y.t)throw new Error("Unsupported value type "+y.t);y.t="s",J["string-value"]!=null&&(Y=ys(J["string-value"]),X=[])}}else{if(is=!1,y.t==="s"&&(y.v=Y||"",X.length&&(y.R=X),is=z==0),Mt.Target&&(y.l=Mt),0<_t.length&&(y.c=_t,_t=[]),Y&&u.cellText!==!1&&(y.w=Y),is&&(y.t="z",delete y.v),(!is||u.sheetStubs)&&!(u.sheetRows&&u.sheetRows<=ie))for(var gs=0;gs<at;++gs){if(kt=parseInt(J["number-columns-repeated"]||"1",10),u.dense)for(I[ie+gs]||(I[ie+gs]=[]),I[ie+gs][le]=gs==0?y:sr(y);0<--kt;)I[ie+gs][le+kt]=sr(y);else for(I[bs({r:ie+gs,c:le})]=y;0<--kt;)I[bs({r:ie+gs,c:le+kt})]=sr(y);Ee.e.c<=le&&(Ee.e.c=le)}le+=(kt=parseInt(J["number-columns-repeated"]||"1",10))-1,kt=0,y={},Y="",X=[]}Mt={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((h=k.pop())[0]!==x[3])throw"Bad state: "+h}else x[0].charAt(x[0].length-2)!=="/"&&k.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((h=k.pop())[0]!==x[3])throw"Bad state: "+h;wt.t=Y,X.length&&(wt.R=X),wt.a=Yt,_t.push(wt)}else x[0].charAt(x[0].length-2)!=="/"&&k.push([x[3],!1]);Y=Yt="",z=Jt=0,X=[];break;case"creator":x[1]==="/"?Yt=j.slice(Jt,x.index):Jt=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((h=k.pop())[0]!==x[3])throw"Bad state: "+h}else x[0].charAt(x[0].length-2)!=="/"&&k.push([x[3],!1]);Y="",z=0,X=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(Pe[E.name]=T,(h=k.pop())[0]!==x[3])throw"Bad state: "+h}else x[0].charAt(x[0].length-2)!=="/"&&(T="",E=os(x[0],!1),k.push([x[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(k[k.length-1][0]){case"time-style":case"date-style":g=os(x[0],!1),T+=Lg[x[3]][g.style==="long"?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(k[k.length-1][0]){case"time-style":case"date-style":g=os(x[0],!1),T+=Lg[x[3]][g.style==="long"?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(k[k.length-1][0]){case"number-style":case"date-style":case"time-style":T+=j.slice(_,x.index)}else _=x.index+x[0].length;break;case"named-range":Ot=Tn((g=os(x[0],!1))["cell-range-address"]);var Us={Name:g.name,Ref:Ot[0]+"!"+Ot[1]};Ds&&(Us.Sheet=q.length),Ht.Names.push(Us);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":if(-1<["master-styles"].indexOf(k[k.length-1][0]))break;x[1]!=="/"||J&&J["string-value"]?(os(x[0],!1),z=x.index+x[0].length):(Us=(Us=j.slice(z,x.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(Os,er){return Array(parseInt(er,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),Us=[ys(Us.replace(/<[^>]*>/g,""))],Y=(0<Y.length?Y+`
`:"")+Us[0]);break;case"s":break;case"database-range":if(x[1]==="/")break;try{R[(Ot=Tn(os(x[0])["target-range-address"]))[0]]["!autofilter"]={ref:Ot[1]}}catch{}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if(x[1]!=="/"){if(!(Mt=os(x[0],!1)).href)break;Mt.Target=ys(Mt.href),delete Mt.href,Mt.Target.charAt(0)=="#"&&-1<Mt.Target.indexOf(".")?(Ot=Tn(Mt.Target.slice(1)),Mt.Target="#"+Ot[0]+"!"+Ot[1]):Mt.Target.match(/^\.\.[\\\/]/)&&(Mt.Target=Mt.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(u.WTF)throw new Error(x)}}return r={Sheets:R,SheetNames:q,Workbook:Ht},u.bookSheets&&delete r.Sheets,r}function No(r,d){d=d||{},ca(r,"META-INF/manifest.xml")&&(function(h,g){for(var b,x,y=d0(h);b=pl.exec(y);)switch(b[3]){case"manifest":break;case"file-entry":if((x=os(b[0],!1)).path=="/"&&x.type!==S0)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(g&&g.WTF)throw b}})(Pr(r,"META-INF/manifest.xml"),d);var u=Ar(r,"content.xml");if(!u)throw new Error("Missing content.xml in ODS / UOF file");return d=Vd(Fe(u),d),ca(r,"meta.xml")&&(d.Props=di(Pr(r,"meta.xml"))),d}function Su(r,d){return Vd(r,d)}var Au=(function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),d="<office:document-styles "+Ia({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return jr+d}})(),Eu=(function(){function r(u,h,g){var b=[];b.push('      <table:table table:name="'+Ys(h.SheetNames[g])+`" table:style-name="ta1">
`);var x=0,y=0,j=La(u["!ref"]||"A1"),k=u["!merges"]||[],E=0,T=Array.isArray(u);if(u["!cols"])for(y=0;y<=j.e.c;++y)b.push("        <table:table-column"+(u["!cols"][y]?' table:style-name="co'+u["!cols"][y].ods+'"':"")+`></table:table-column>
`);for(var _="",R=u["!rows"]||[],x=0;x<j.s.r;++x)_=R[x]?' table:style-name="ro'+R[x].ods+'"':"",b.push("        <table:table-row"+_+`></table:table-row>
`);for(;x<=j.e.r;++x){for(_=R[x]?' table:style-name="ro'+R[x].ods+'"':"",b.push("        <table:table-row"+_+`>
`),y=0;y<j.s.c;++y)b.push(d);for(;y<=j.e.c;++y){for(var q=!1,I={},J="",E=0;E!=k.length;++E)if(!(k[E].s.c>y||k[E].s.r>x||k[E].e.c<y||k[E].e.r<x)){k[E].s.c==y&&k[E].s.r==x||(q=!0),I["table:number-columns-spanned"]=k[E].e.c-k[E].s.c+1,I["table:number-rows-spanned"]=k[E].e.r-k[E].s.r+1;break}if(q)b.push(`          <table:covered-table-cell/>
`);else{var Y=bs({r:x,c:y}),z=T?(u[x]||[])[y]:u[Y];if(z&&z.f&&(I["table:formula"]=Ys(("of:="+z.f.replace(bo,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),z.F&&z.F.slice(0,Y.length)==Y&&(X=La(z.F),I["table:number-matrix-columns-spanned"]=X.e.c-X.s.c+1,I["table:number-matrix-rows-spanned"]=X.e.r-X.s.r+1)),z){switch(z.t){case"b":J=z.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=z.v?"true":"false";break;case"n":J=z.w||String(z.v||0),I["office:value-type"]="float",I["office:value"]=z.v||0;break;case"s":case"str":J=z.v==null?"":z.v,I["office:value-type"]="string";break;case"d":J=z.w||Cs(z.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=Cs(z.v).toISOString(),I["table:style-name"]="ce1";break;default:b.push(d);continue}var X,Y=Ys(J).replace(/  +/g,function(le){return'<text:s text:c="'+le.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");z.l&&z.l.Target&&(Y=Bt("text:a",Y,{"xlink:href":(X=(X=(X=z.l.Target).charAt(0)=="#"?"#"+X.slice(1).replace(/\./,"!"):X).charAt(0)!="#"&&!X.match(/^\w+:/)?"../"+X:X).replace(/&/g,"&amp;")})),b.push("          "+Bt("table:table-cell",Bt("text:p",Y,{}),I)+`
`)}else b.push(d)}}b.push(`        </table:table-row>
`)}return b.push(`      </table:table>
`),b.join("")}var d=`          <table:table-cell />
`;return function(u,h){var g=[jr],b=Ia({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=Ia({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(g.push("<office:document"+b+x+`>
`),g.push(Em().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+b+`>
`),(function(j,k){j.push(` <office:automatic-styles>
`),j.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),j.push(`   <number:month number:style="long"/>
`),j.push(`   <number:text>/</number:text>
`),j.push(`   <number:day number:style="long"/>
`),j.push(`   <number:text>/</number:text>
`),j.push(`   <number:year/>
`),j.push(`  </number:date-style>
`);var E=0;k.SheetNames.map(function(_){return k.Sheets[_]}).forEach(function(_){if(_&&_["!cols"]){for(var R=0;R<_["!cols"].length;++R)if(_["!cols"][R]){var q=_["!cols"][R];if(q.width==null&&q.wpx==null&&q.wch==null)continue;Tl(q),q.ods=E,q=_["!cols"][R].wpx+"px",j.push('  <style:style style:name="co'+E+`" style:family="table-column">
`),j.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+q+`"/>
`),j.push(`  </style:style>
`),++E}}});var T=0;k.SheetNames.map(function(_){return k.Sheets[_]}).forEach(function(_){if(_&&_["!rows"])for(var R,q=0;q<_["!rows"].length;++q)_["!rows"][q]&&(_["!rows"][q].ods=T,R=_["!rows"][q].hpx+"px",j.push('  <style:style style:name="ro'+T+`" style:family="table-row">
`),j.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+R+`"/>
`),j.push(`  </style:style>
`),++T)}),j.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),j.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),j.push(`  </style:style>
`),j.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),j.push(` </office:automatic-styles>
`)})(g,u),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var y=0;y!=u.SheetNames.length;++y)g.push(r(u.Sheets[u.SheetNames[y]],u,y));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),h.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}})();function el(r,d){if(d.bookType=="fods")return Eu(r,d);var u=Ir(),h=[],g=[];return us(u,"mimetype","application/vnd.oasis.opendocument.spreadsheet"),us(u,"content.xml",Eu(r,d)),h.push(["content.xml","text/xml"]),g.push(["content.xml","ContentFile"]),us(u,"styles.xml",Au(r,d)),h.push(["styles.xml","text/xml"]),g.push(["styles.xml","StylesFile"]),us(u,"meta.xml",jr+Em()),h.push(["meta.xml","text/xml"]),g.push(["meta.xml","MetadataFile"]),us(u,"manifest.rdf",(function(b){var x=[jr];x.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var y=0;y!=b.length;++y)x.push(so(b[y][0],b[y][1])),x.push([`  <rdf:Description rdf:about="">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+b[y][0]+`"/>
`,`  </rdf:Description>
`].join(""));return x.push(so("","Document","pkg")),x.push("</rdf:RDF>"),x.join("")})(g)),h.push(["manifest.rdf","application/rdf+xml"]),us(u,"META-INF/manifest.xml",(function(b){var x=[jr];x.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),x.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var y=0;y<b.length;++y)x.push('  <manifest:file-entry manifest:full-path="'+b[y][0]+'" manifest:media-type="'+b[y][1]+`"/>
`);return x.push("</manifest:manifest>"),x.join("")})(h)),u}function va(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function ko(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):Fe(be(r))}function Rg(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):ue(At(r))}function tl(r){var d=r.reduce(function(g,b){return g+b.length},0),u=new Uint8Array(d),h=0;return r.forEach(function(g){u.set(g,h),h+=g.length}),u}function Cf(r){return 16843009*((r=(858993459&(r-=r>>1&1431655765))+(r>>2&858993459))+(r>>4)&252645135)>>>24}function Tc(r,d){var u=d?d[0]:0,h=127&r[u];return 128<=r[u++]&&(h|=(127&r[u])<<7,r[u++]<128||(h|=(127&r[u])<<14,r[u++]<128||(h|=(127&r[u])<<21,r[u++]<128||(h+=(127&r[u])*Math.pow(2,28),++u,r[u++]<128||(h+=(127&r[u])*Math.pow(2,35),++u,r[u++]<128||(h+=(127&r[u])*Math.pow(2,42),++u,r[u++])))))),d&&(d[0]=u),h}function Gs(r){var d=new Uint8Array(7);d[0]=127&r;var u=1;return 127<r&&(d[u-1]|=128,d[u]=r>>7&127,++u,r<=16383||(d[u-1]|=128,d[u]=r>>14&127,++u,r<=2097151||(d[u-1]|=128,d[u]=r>>21&127,++u,r<=268435455||(d[u-1]|=128,d[u]=r/256>>>21&127,++u,r<=34359738367||(d[u-1]|=128,d[u]=r/65536>>>21&127,++u,r<=4398046511103||(d[u-1]|=128,d[u]=r/16777216>>>21&127,++u)))))),d.slice(0,u)}function Mr(r){var d=0,u=127&r[0];return 128<=r[d++]&&(u|=(127&r[1])<<7,r[d++]<128||(u|=(127&r[2])<<14,r[d++]<128||(u|=(127&r[3])<<21,r[+d]<128||(u|=(127&r[4])<<28)))),u}function Bs(r){for(var d=[],u=[0];u[0]<r.length;){var h,g=u[0],b=Tc(r,u),x=7&b,y=0;if((b=Math.floor(b/8))==0)break;switch(x){case 0:for(var j=u[0];128<=r[u[0]++];);h=r.slice(j,u[0]);break;case 5:y=4,h=r.slice(u[0],u[0]+y),u[0]+=y;break;case 1:y=8,h=r.slice(u[0],u[0]+y),u[0]+=y;break;case 2:y=Tc(r,u),h=r.slice(u[0],u[0]+y),u[0]+=y;break;default:throw new Error("PB Type ".concat(x," for Field ").concat(b," at offset ").concat(g))}var k={data:h,type:x};d[b]==null?d[b]=[k]:d[b].push(k)}return d}function Lr(r){var d=[];return r.forEach(function(u,h){h!=0&&u.forEach(function(g){g.data&&(d.push(Gs(8*h+g.type)),g.type==2&&d.push(Gs(g.data.length)),d.push(g.data))})}),tl(d)}function Du(r,d){return r?.map(function(u){return d(u.data)})||[]}function Mn(r){for(var d=[],u=[0];u[0]<r.length;){var h=Tc(r,u),g=Bs(r.slice(u[0],u[0]+h));u[0]+=h;var b={id:Mr(g[1][0].data),messages:[]};g[2].forEach(function(j){var y=Bs(j.data),j=Mr(y[3][0].data);b.messages.push({meta:y,data:r.slice(u[0],u[0]+j)}),u[0]+=j}),(h=g[3])!=null&&h[0]&&(b.merge=0<Mr(g[3][0].data)>>>0),d.push(b)}return d}function sl(r){var d=[];return r.forEach(function(u){var h=[[],[{data:Gs(u.id),type:0}],[]];u.merge!=null&&(h[3]=[{data:Gs(+!!u.merge),type:0}]);var g=[];u.messages.forEach(function(b){g.push(b.data),b.meta[3]=[{type:0,data:Gs(b.data.length)}],h[2].push({data:Lr(b.meta),type:2})}),u=Lr(h),d.push(Gs(u.length)),d.push(u),g.forEach(function(b){return d.push(b)})}),tl(d)}function Ja(r){for(var d=[],u=0;u<r.length;){var h=r[u++],g=r[u]|r[u+1]<<8|r[u+2]<<16;u+=3,d.push((function(b,x){if(b!=0)throw new Error("Unexpected Snappy chunk type ".concat(b));for(var y=[0],j=Tc(x,y),k=[];y[0]<x.length;){var E=3&x[y[0]];if(E!=0){var T=0,_=0;if(E==1?(_=4+(x[y[0]]>>2&7),T=(224&x[y[0]++])<<3,T|=x[y[0]++]):(_=1+(x[y[0]++]>>2),E==2?(T=x[y[0]]|x[y[0]+1]<<8,y[0]+=2):(T=(x[y[0]]|x[y[0]+1]<<8|x[y[0]+2]<<16|x[y[0]+3]<<24)>>>0,y[0]+=4)),k=[tl(k)],T==0)throw new Error("Invalid offset 0");if(T>k[0].length)throw new Error("Invalid offset beyond length");if(T<=_)for(k.push(k[0].slice(-T)),_-=T;_>=k[k.length-1].length;)k.push(k[k.length-1]),_-=k[k.length-1].length;k.push(k[0].slice(-T,-T+_))}else E=x[y[0]++]>>2,E<60?++E:(T=E-59,E=x[y[0]],1<T&&(E|=x[y[0]+1]<<8),2<T&&(E|=x[y[0]+2]<<16),3<T&&(E|=x[y[0]+3]<<24),E>>>=0,E++,y[0]+=T),k.push(x.slice(y[0],y[0]+E)),y[0]+=E}if((b=tl(k)).length!=j)throw new Error("Unexpected length: ".concat(b.length," != ").concat(j));return b})(h,r.slice(u,u+g))),u+=g}if(u!==r.length)throw new Error("data is not a valid framed stream!");return tl(d)}function Co(r){for(var d=[],u=0;u<r.length;){var h=Math.min(r.length-u,268435455),g=new Uint8Array(4);d.push(g);var b=Gs(h),x=b.length;d.push(b),h<=60?(x++,d.push(new Uint8Array([h-1<<2]))):h<=256?(x+=2,d.push(new Uint8Array([240,h-1&255]))):h<=65536?(x+=3,d.push(new Uint8Array([244,h-1&255,h-1>>8&255]))):h<=16777216?(x+=4,d.push(new Uint8Array([248,h-1&255,h-1>>8&255,h-1>>16&255]))):h<=4294967296&&(x+=5,d.push(new Uint8Array([252,h-1&255,h-1>>8&255,h-1>>16&255,h-1>>>24&255]))),d.push(r.slice(u,u+h)),x+=h,g[0]=0,g[1]=255&x,g[2]=x>>8&255,g[3]=x>>16&255,u+=h}return tl(d)}function t1(r,d,u){var h,g=va(r),b=g.getUint32(8,!0),x=12,y=-1,j=-1,k=NaN,E=NaN,T=new Date(2001,0,1);switch(1&b&&(k=(function(_,R){for(var q=(127&_[R+15])<<7|_[R+14]>>1,I=1&_[R+14],J=R+13;R<=J;--J)I=256*I+_[J];return(128&_[R+15]?-I:I)*Math.pow(10,q-6176)})(r,x),x+=16),2&b&&(E=g.getFloat64(x,!0),x+=8),4&b&&(T.setTime(T.getTime()+1e3*g.getFloat64(x,!0)),x+=8),8&b&&(j=g.getUint32(x,!0),x+=4),16&b&&(y=g.getUint32(x,!0),x+=4),r[1]){case 0:break;case 2:h={t:"n",v:k};break;case 3:h={t:"s",v:d[j]};break;case 5:h={t:"d",v:T};break;case 6:h={t:"b",v:0<E};break;case 7:h={t:"n",v:E/86400};break;case 8:h={t:"e",v:0};break;case 9:if(!(-1<y))throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(31&b," : ").concat(r.slice(0,4)));h={t:"s",v:u[y]};break;case 10:h={t:"n",v:k};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(31&b," : ").concat(r.slice(0,4)))}return h}function So(r,d){var u=new Uint8Array(32),h=va(u),g=12,b=0;switch(u[0]=5,r.t){case"n":u[1]=2,(function(x,y,j){var k=Math.floor(j==0?0:Math.LOG10E*Math.log(Math.abs(j)))+6176-16,E=j/Math.pow(10,k-6176);x[y+15]|=k>>7,x[y+14]|=(127&k)<<1;for(var T=0;1<=E;++T,E/=256)x[y+T]=255&E;x[y+15]|=0<=j?0:128})(u,g,r.v),b|=1,g+=16;break;case"b":u[1]=6,h.setFloat64(g,r.v?1:0,!0),b|=2,g+=8;break;case"s":if(d.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));u[1]=3,h.setUint32(g,d.indexOf(r.v),!0),b|=8,g+=4;break;default:throw"unsupported cell type "+r.t}return h.setUint32(8,b,!0),u.slice(0,g)}function Sf(r,d){var u=new Uint8Array(32),h=va(u),g=12,b=0;switch(u[0]=3,r.t){case"n":u[2]=2,h.setFloat64(g,r.v,!0),b|=32,g+=8;break;case"b":u[2]=6,h.setFloat64(g,r.v?1:0,!0),b|=32,g+=8;break;case"s":if(d.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));u[2]=3,h.setUint32(g,d.indexOf(r.v),!0),b|=16,g+=4;break;default:throw"unsupported cell type "+r.t}return h.setUint32(4,b,!0),u.slice(0,g)}function Og(r,d,u){switch(r[0]){case 0:case 1:case 2:case 3:return(function(h,g,b,x){var y,j=va(h),k=j.getUint32(4,!0),E=(1<x?12:8)+4*Cf(k&(1<x?3470:398)),T=-1,_=-1,R=NaN,q=new Date(2001,0,1);switch(512&k&&(T=j.getUint32(E,!0),E+=4),E+=4*Cf(k&(1<x?12288:4096)),16&k&&(_=j.getUint32(E,!0),E+=4),32&k&&(R=j.getFloat64(E,!0),E+=8),64&k&&(q.setTime(q.getTime()+1e3*j.getFloat64(E,!0)),E+=8),h[2]){case 0:break;case 2:y={t:"n",v:R};break;case 3:y={t:"s",v:g[_]};break;case 5:y={t:"d",v:q};break;case 6:y={t:"b",v:0<R};break;case 7:y={t:"n",v:R/86400};break;case 8:y={t:"e",v:0};break;case 9:if(-1<T)y={t:"s",v:b[T]};else if(-1<_)y={t:"s",v:g[_]};else{if(isNaN(R))throw new Error("Unsupported cell type ".concat(h.slice(0,4)));y={t:"n",v:R}}break;default:throw new Error("Unsupported cell type ".concat(h.slice(0,4)))}return y})(r,d,u,r[0]);case 5:return t1(r,d,u);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function hs(r){return Tc(Bs(r)[1][0].data)}function Tu(r,h){var h=Bs(h.data),u=Mr(h[1][0].data),h=h[3],g=[];return(h||[]).forEach(function(b){var x=Bs(b.data),y=Mr(x[1][0].data)>>>0;switch(u){case 1:g[y]=ko(x[3][0].data);break;case 8:var k=Bs(r[hs(x[9][0].data)][0].data),j=r[hs(k[1][0].data)][0],k=Mr(j.meta[1][0].data);if(k!=2001)throw new Error("2000 unexpected reference to ".concat(k));j=Bs(j.data),g[y]=j[3].map(function(E){return ko(E.data)}).join("")}}),g}function _u(r,g){var u=Bs(g.data),h=(g=u?.[7])!=null&&g[0]?0<Mr(u[7][0].data)>>>0?1:0:-1,g=Du(u[5],function(b){return(function(x,y){var j,k,E,T=Bs(x),_=Mr(T[1][0].data)>>>0,R=Mr(T[2][0].data)>>>0,q=((x=(q=T[8])==null?void 0:q[0])==null?void 0:x.data)&&0<Mr(T[8][0].data)||!1;if((x=(x=T[7])==null?void 0:x[0])!=null&&x.data&&y!=0)k=(j=(j=T[7])==null?void 0:j[0])==null?void 0:j.data,E=(j=(j=T[6])==null?void 0:j[0])==null?void 0:j.data;else{if((j=(j=T[4])==null?void 0:j[0])==null||!j.data||y==1)throw"NUMBERS Tile missing ".concat(y," cell storage");k=(y=(y=T[4])==null?void 0:y[0])==null?void 0:y.data,E=(T=(T=T[3])==null?void 0:T[0])==null?void 0:T.data}for(var I=q?4:1,J=va(k),Y=[],z=0;z<k.length/2;++z){var X=J.getUint16(2*z,!0);X<65535&&Y.push([z,X])}if(Y.length!=R)throw"Expected ".concat(R," cells, found ").concat(Y.length);for(var ie=[],z=0;z<Y.length-1;++z)ie[Y[z][0]]=E.subarray(Y[z][1]*I,Y[z+1][1]*I);return 1<=Y.length&&(ie[Y[Y.length-1][0]]=E.subarray(Y[Y.length-1][1]*I)),{R:_,cells:ie}})(b,h)});return{nrows:Mr(u[4][0].data)>>>0,data:g.reduce(function(b,x){return b[x.R]||(b[x.R]=[]),x.cells.forEach(function(y,j){if(b[x.R][j])throw new Error("Duplicate cell r=".concat(x.R," c=").concat(j));b[x.R][j]=y}),b},[])}}function Af(r,g){var u={"!ref":"A1"},h=r[hs(Bs(g.data)[2][0].data)],g=Mr(h[0].meta[1][0].data);if(g!=6001)throw new Error("6000 unexpected reference to ".concat(g));return(function(b,j,y){var T=Bs(j.data);if((j={s:{r:0,c:0},e:{r:0,c:0}}).e.r=(Mr(T[6][0].data)>>>0)-1,j.e.r<0)throw new Error("Invalid row varint ".concat(T[6][0].data));if(j.e.c=(Mr(T[7][0].data)>>>0)-1,j.e.c<0)throw new Error("Invalid col varint ".concat(T[7][0].data));y["!ref"]=Ss(j);var j=Bs(T[4][0].data),k=Tu(b,b[hs(j[4][0].data)][0]),E=(T=j[17])!=null&&T[0]?Tu(b,b[hs(j[17][0].data)][0]):[],T=Bs(j[3][0].data),_=0;if(T[1].forEach(function(q){var I=Bs(q.data),q=b[hs(I[2][0].data)][0],I=Mr(q.meta[1][0].data);if(I!=6002)throw new Error("6001 unexpected reference to ".concat(I));q=_u(0,q),q.data.forEach(function(J,Y){J.forEach(function(z,X){X=bs({r:_+Y,c:X}),z=Og(z,k,E),z&&(y[X]=z)})}),_+=q.nrows}),(T=j[13])!=null&&T[0]){if(T=b[hs(j[13][0].data)][0],j=Mr(T.meta[1][0].data),j!=6144)throw new Error("Expected merge type 6144, found ".concat(j));y["!merges"]=(T=Bs(T.data))==null?void 0:T[1].map(function(q){var I=Bs(q.data),q=va(Bs(I[1][0].data)[1][0].data),I=va(Bs(I[2][0].data)[1][0].data);return{s:{r:q.getUint16(0,!0),c:q.getUint16(2,!0)},e:{r:q.getUint16(0,!0)+I.getUint16(0,!0)-1,c:q.getUint16(2,!0)+I.getUint16(2,!0)-1}}})}})(r,h[0],u),u}function Pg(r,d){var u=Pf(),h=Bs(d.data);if((d=h[2])!=null&&d[0])throw new Error("Keynote presentations are not supported");if(Du(h[1],hs).forEach(function(g){r[g].forEach(function(b){var x,y,j,k;Mr(b.meta[1][0].data)==2&&(y=r,b=Bs((j=b).data),k={name:(j=b[1])!=null&&j[0]?ko(b[1][0].data):"",sheets:[]},Du(b[2],hs).forEach(function(E){y[E].forEach(function(T){Mr(T.meta[1][0].data)==6e3&&k.sheets.push(Af(y,T))})}),(x=k).sheets.forEach(function(E,T){Uu(u,E,T==0?x.name:x.name+"_"+T,!0)}))})}),u.SheetNames.length==0)throw new Error("Empty NUMBERS file");return u}function Fu(r){var d={},u=[];if(r.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var b,x;try{b=Ja(g.content)}catch(y){return console.log("?? "+g.content.length+" "+(y.message||y))}try{x=Mn(b)}catch(y){return console.log("## "+(y.message||y))}x.forEach(function(y){d[y.id]=y.messages,u.push(y.id)})}}),!u.length)throw new Error("File has no messages");if((r=(r=(r=(r=d?.[1])==null?void 0:r[0])==null?void 0:r.meta)==null?void 0:r[1])!=null&&r[0].data&&Mr(d[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var h=((r=(r=(r=(r=d?.[1])==null?void 0:r[0])==null?void 0:r.meta)==null?void 0:r[1])==null?void 0:r[0].data)&&Mr(d[1][0].meta[1][0].data)==1&&d[1][0];if(h||u.forEach(function(g){d[g].forEach(function(b){if(Mr(b.meta[1][0].data)>>>0==1){if(h)throw new Error("Document has multiple roots");h=b}})}),!h)throw new Error("Cannot find Document root");return Pg(d,h)}function Wd(r,d){if(!d||!d.numbers)throw new Error("Must pass a `numbers` option -- check the README");var u=r.Sheets[r.SheetNames[0]];1<r.SheetNames.length&&console.error("The Numbers writer currently writes only the first table");var h=La(u["!ref"]);h.s.r=h.s.c=0;var g=!1;9<h.e.c&&(g=!0,h.e.c=9),49<h.e.r&&(g=!0,h.e.r=49),g&&console.error("The Numbers writer is currently limited to ".concat(Ss(h)));var b=Pu(u,{range:h,header:1}),x=["~Sh33tJ5~"];b.forEach(function(Mt){return Mt.forEach(function(Ot){typeof Ot=="string"&&x.push(Ot)})});var y={},j=[],k=Tt.read(d.numbers,{type:"base64"});k.FileIndex.map(function(Mt,Ot){return[Mt,k.FullPaths[Ot]]}).forEach(function(Mt){var Ot=Mt[0],_t=Mt[1];Ot.type==2&&Ot.name.match(/\.iwa/)&&Mn(Ja(Ot.content)).forEach(function(wt){j.push(wt.id),y[wt.id]={deps:[],location:_t,type:Mr(wt.messages[0].meta[1][0].data)}})}),j.sort(function(Mt,Ot){return Mt-Ot});var E=j.filter(function(Mt){return 1<Mt}).map(function(Mt){return[Mt,Gs(Mt)]});k.FileIndex.map(function(Mt,Ot){return[Mt,k.FullPaths[Ot]]}).forEach(function(Mt){var Ot=Mt[0];Mt[1],Ot.name.match(/\.iwa/)&&Mn(Ja(Ot.content)).forEach(function(_t){_t.messages.forEach(function(wt){E.forEach(function(Yt){_t.messages.some(function(Jt){return Mr(Jt.meta[1][0].data)!=11006&&(function(is,Ds){e:for(var $t=0;$t<=is.length-Ds.length;++$t){for(var Ct=0;Ct<Ds.length;++Ct)if(is[$t+Ct]!=Ds[Ct])continue e;return!0}return!1})(Jt.data,Yt[1])})&&y[Yt[0]].deps.push(_t.id)})})})});for(var T,_=Tt.find(k,y[1].location),R=Mn(Ja(_.content)),q=0;q<R.length;++q){var I=R[q];I.id==1&&(T=I)}for(var J=hs(Bs(T.messages[0].data)[1][0].data),R=Mn(Ja((_=Tt.find(k,y[J].location)).content)),q=0;q<R.length;++q)(I=R[q]).id==J&&(T=I);var pt=Bs(T.messages[0].data);for(pt[1]=[{type:2,data:Rg(r.SheetNames[0])}],T.messages[0].data=Lr(pt),_.content=Co(sl(R)),_.size=_.content.length,J=hs(pt[2][0].data),R=Mn(Ja((_=Tt.find(k,y[J].location)).content)),q=0;q<R.length;++q)(I=R[q]).id==J&&(T=I);for(J=hs(Bs(T.messages[0].data)[2][0].data),R=Mn(Ja((_=Tt.find(k,y[J].location)).content)),q=0;q<R.length;++q)(I=R[q]).id==J&&(T=I);g=Bs(T.messages[0].data),g[6][0].data=Gs(h.e.r+1),g[7][0].data=Gs(h.e.c+1);for(var Y=hs(g[46][0].data),d=Tt.find(k,y[Y].location),z=Mn(Ja(d.content)),X=0;X<z.length&&z[X].id!=Y;++X);if(z[X].id!=Y)throw"Bad ColumnRowUIDMapArchive";var ie=Bs(z[X].messages[0].data);ie[1]=[],ie[2]=[],ie[3]=[];for(var le=0;le<=h.e.c;++le)ie[1].push({type:2,data:Lr([[],[{type:0,data:Gs(le+420690)}],[{type:0,data:Gs(le+420690)}]])}),ie[2].push({type:0,data:Gs(le)}),ie[3].push({type:0,data:Gs(le)});ie[4]=[],ie[5]=[],ie[6]=[];for(var Ee=0;Ee<=h.e.r;++Ee)ie[4].push({type:2,data:Lr([[],[{type:0,data:Gs(Ee+726270)}],[{type:0,data:Gs(Ee+726270)}]])}),ie[5].push({type:0,data:Gs(Ee)}),ie[6].push({type:0,data:Gs(Ee)});if(z[X].messages[0].data=Lr(ie),d.content=Co(sl(z)),d.size=d.content.length,delete g[46],r=Bs(g[4][0].data),r[7][0].data=Gs(h.e.r+1),pt=hs(Bs(r[1][0].data)[2][0].data),(z=Mn(Ja((d=Tt.find(k,y[pt].location)).content)))[0].id!=pt)throw"Bad HeaderStorageBucket";for(var He=Bs(z[0].messages[0].data),Ee=0;Ee<b.length;++Ee){var Pe=Bs(He[2][0].data);Pe[1][0].data=Gs(Ee),Pe[4][0].data=Gs(b[Ee].length),He[2][Ee]={type:He[2][0].type,data:Lr(Pe)}}z[0].messages[0].data=Lr(He),d.content=Co(sl(z)),d.size=d.content.length;var Qe,pt=hs(r[2][0].data);if((z=Mn(Ja((d=Tt.find(k,y[pt].location)).content)))[0].id!=pt)throw"Bad HeaderStorageBucket";for(He=Bs(z[0].messages[0].data),le=0;le<=h.e.c;++le)(Pe=Bs(He[2][0].data))[1][0].data=Gs(le),Pe[4][0].data=Gs(h.e.r+1),He[2][le]={type:He[2][0].type,data:Lr(Pe)};z[0].messages[0].data=Lr(He),d.content=Co(sl(z)),d.size=d.content.length,u["!merges"]&&(Wt=(function(Mt){for(var Ot=927262;Ot<2e6;++Ot)if(!y[Ot])return y[Ot]=Mt,Ot;throw new Error("Too many messages")})({type:6144,deps:[J],location:y[J].location}),Qe=[[],[]],u["!merges"].forEach(function(Mt){Qe[1].push({type:2,data:Lr([[],[{type:2,data:Lr([[],[{type:5,data:new Uint8Array(new Uint16Array([Mt.s.r,Mt.s.c]).buffer)}]])}],[{type:2,data:Lr([[],[{type:5,data:new Uint8Array(new Uint16Array([Mt.e.r-Mt.s.r+1,Mt.e.c-Mt.s.c+1]).buffer)}]])}]])})}),r[13]=[{type:2,data:Lr([[],[{type:0,data:Gs(Wt)}]])}],R.push({id:Wt,messages:[(kt=6144,Wt=Lr(Qe),{meta:[[],[{type:0,data:Gs(kt)}]],data:Wt})]}));var xt=hs(r[4][0].data);(function(){for(var Mt,Ot=Tt.find(k,y[xt].location),_t=Mn(Ja(Ot.content)),wt=0;wt<_t.length;++wt){var Yt=_t[wt];Yt.id==xt&&(Mt=Yt)}var Jt=Bs(Mt.messages[0].data);Jt[3]=[],x.forEach(function(is,Ds){Jt[3].push({type:2,data:Lr([[],[{type:0,data:Gs(Ds)}],[{type:0,data:Gs(1)}],[{type:2,data:Rg(is)}]])})}),Mt.messages[0].data=Lr(Jt),Ot.content=Co(sl(_t)),Ot.size=Ot.content.length})();var at=Bs(r[3][0].data),kt=at[1][0];delete at[2];var kt,Wt,Wt=Bs(kt.data),Ht=hs(Wt[2][0].data);return(function(){for(var Mt,Ot=Tt.find(k,y[Ht].location),_t=Mn(Ja(Ot.content)),wt=0;wt<_t.length;++wt){var Yt=_t[wt];Yt.id==Ht&&(Mt=Yt)}var Jt=Bs(Mt.messages[0].data);delete Jt[6],delete at[7];var is=new Uint8Array(Jt[5][0].data);Jt[5]=[];for(var Ds=0,$t=0;$t<=h.e.r;++$t){var Ct=Bs(is);Ds+=(function(gs,Us,Os){var er,Rr;if((er=gs[6])==null||!er[0]||(Rr=gs[7])==null||!Rr[0])throw"Mutation only works on post-BNC storages!";if((Rr=(Rr=gs[8])==null?void 0:Rr[0])!=null&&Rr.data&&0<Mr(gs[8][0].data))throw"Math only works with normal offsets";for(var Me,tr,qs=0,fa=va(gs[7][0].data),Ln=0,ge=[],lt=va(gs[4][0].data),De=0,tt=[],Se=0;Se<Us.length;++Se)if(Us[Se]!=null){switch(fa.setUint16(2*Se,Ln,!0),lt.setUint16(2*Se,De,!0),typeof Us[Se]){case"string":Me=So({t:"s",v:Us[Se]},Os),tr=Sf({t:"s",v:Us[Se]},Os);break;case"number":Me=So({t:"n",v:Us[Se]},Os),tr=Sf({t:"n",v:Us[Se]},Os);break;case"boolean":Me=So({t:"b",v:Us[Se]},Os),tr=Sf({t:"b",v:Us[Se]},Os);break;default:throw new Error("Unsupported value "+Us[Se])}ge.push(Me),Ln+=Me.length,tt.push(tr),De+=tr.length,++qs}else fa.setUint16(2*Se,65535,!0),lt.setUint16(2*Se,65535);for(gs[2][0].data=Gs(qs);Se<gs[7][0].data.length/2;++Se)fa.setUint16(2*Se,65535,!0),lt.setUint16(2*Se,65535,!0);return gs[6][0].data=tl(ge),gs[3][0].data=tl(tt),qs})(Ct,b[$t],x),Ct[1][0].data=Gs($t),Jt[5].push({data:Lr(Ct),type:2})}Jt[1]=[{type:0,data:Gs(h.e.c+1)}],Jt[2]=[{type:0,data:Gs(h.e.r+1)}],Jt[3]=[{type:0,data:Gs(Ds)}],Jt[4]=[{type:0,data:Gs(h.e.r+1)}],Mt.messages[0].data=Lr(Jt),Ot.content=Co(sl(_t)),Ot.size=Ot.content.length})(),kt.data=Lr(Wt),r[3][0].data=Lr(at),g[4][0].data=Lr(r),T.messages[0].data=Lr(g),_.content=Co(sl(R)),_.size=_.content.length,k}function $d(r){return function(d){for(var u=0;u!=r.length;++u){var h=r[u];d[h[0]]===void 0&&(d[h[0]]=h[1]),h[2]==="n"&&(d[h[0]]=Number(d[h[0]]))}}}function Ef(r){$d([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function Mu(r){$d([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function s1(r,d){if(!r)return 0;try{r=d.map(function(u){return u.id||(u.id=u.strRelID),[u.name,r["!id"][u.id].Target,(u=r["!id"][u.id].Type,-1<Ns.WS.indexOf(u)?"sheet":Ns.CS&&u==Ns.CS?"chart":Ns.DS&&u==Ns.DS?"dialog":Ns.MS&&u==Ns.MS?"macro":u&&u.length?u:"sheet")]})}catch{return null}return r&&r.length!==0?r:null}function r1(r,d,u,h,g,b,x,y,j,k,E,T){try{b[h]=to(Ar(r,u,!0),d);var _=Pr(r,d);switch(y){case"sheet":I=xu(_,d,g,j,b[h],k,E,T);break;case"chart":if(!(I=yg(_,d,g,j,b[h],k))||!I["!drawel"])break;var q=fl(I["!drawel"].Target,d),R=jl(q),z=fl((z=Ar(r,q,!0),R=to(Ar(r,R,!0),q),z?(z=(z.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],R["!id"][z].Target):"??"),q),q=jl(z),I=br(Ar(r,z,!0),0,0,to(Ar(r,q,!0),z),0,I);break;case"macro":Y=d,b[h],Y.slice(-4),I={"!type":"macro"};break;case"dialog":Y=d,b[h],Y.slice(-4),I={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+y)}x[h]=I;var J=[];b&&b[h]&&wr(b[h]).forEach(function(X){var ie,le,Ee,He,Pe,Qe,pt="";if(b[h][X].Type==Ns.CMNT){pt=fl(b[h][X].Target,d);var xt=Ol(Pr(r,pt,!0),pt,j);if(!xt||!xt.length)return;tf(I,xt,!1)}b[h][X].Type==Ns.TCMNT&&(pt=fl(b[h][X].Target,d),J=J.concat((ie=Pr(r,pt,!0),le=j,He=!(Ee=[]),Pe={},Qe=0,ie.replace(Jr,function(at,kt){var Wt=os(at);switch(kn(Wt[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":Pe={author:Wt.personId,guid:Wt.id,ref:Wt.ref,T:1};break;case"</threadedComment>":Pe.t!=null&&Ee.push(Pe);break;case"<text>":case"<text":Qe=kt+at.length;break;case"</text>":Pe.t=ie.slice(Qe,kt).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":He=!0;break;case"</mentions>":He=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":He=!0;break;case"</ext>":He=!1;break;default:if(!He&&le.WTF)throw new Error("unrecognized "+Wt[0]+" in threaded comments")}return at}),Ee)))}),J&&J.length&&tf(I,J,!0,j.people||[])}catch(X){if(j.WTF)throw X}var Y,z}function yn(r){return r.charAt(0)=="/"?r.slice(1):r}function Df(r,d){if(ll(),Ef(d=d||{}),ca(r,"META-INF/manifest.xml")||ca(r,"objectdata.xml"))return No(r,d);if(ca(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(r.FileIndex)return Fu(r);var u=Tt.utils.cfb_new();return oi(r).forEach(function(_t){us(u,_t,(function(Yt,Jt,is){return ul(Vr(Yt,Jt))})(r,_t))}),Fu(u)}if(!ca(r,"[Content_Types].xml"))throw ca(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ca(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var h,g,b=oi(r),x=(function(_t){var wt=wl();if(!_t||!_t.match)return wt;var Yt={};if((_t.match(Jr)||[]).forEach(function(Jt){var is=os(Jt);switch(is[0].replace(Un,"<")){case"<?xml":break;case"<Types":wt.xmlns=is["xmlns"+(is[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":Yt[is.Extension]=is.ContentType;break;case"<Override":wt[tc[is.ContentType]]!==void 0&&wt[tc[is.ContentType]].push(is.PartName)}}),wt.xmlns!==Wr.CT)throw new Error("Unknown Namespace: "+wt.xmlns);return wt.calcchain=0<wt.calcchains.length?wt.calcchains[0]:"",wt.sst=0<wt.strs.length?wt.strs[0]:"",wt.style=0<wt.styles.length?wt.styles[0]:"",wt.defaults=Yt,delete wt.calcchains,wt})(Ar(r,"[Content_Types].xml")),Pe=!1;if(x.workbooks.length===0&&Pr(r,g="xl/workbook.xml",!0)&&x.workbooks.push(g),x.workbooks.length===0){if(!Pr(r,g="xl/workbook.bin",!0))throw new Error("Could not find workbook");x.workbooks.push(g),Pe=!0}x.workbooks[0].slice(-3)=="bin"&&(Pe=!0);var y={},j={};if(!d.bookSheets&&!d.bookProps){if(vc=[],x.sst)try{vc=yu(Pr(r,yn(x.sst)),x.sst,d)}catch(_t){if(d.WTF)throw _t}d.cellStyles&&x.themes.length&&(q=Ar(r,x.themes[0].replace(/^\//,""),!0)||"",x.themes[0],y=_l(q,d)),x.style&&(j=bu(Pr(r,yn(x.style)),x.style,y,d))}x.links.map(function(_t){try{return to(Ar(r,jl(yn(_t))),_t),Pl(Pr(r,yn(_t)),0,_t,d)}catch{}});var k,E,T,_=bf(Pr(r,yn(x.workbooks[0])),x.workbooks[0],d),R={},q="";x.coreprops.length&&((q=Pr(r,yn(x.coreprops[0]),!0))&&(R=di(q)),x.extprops.length!==0&&(q=Pr(r,yn(x.extprops[0]),!0))&&(I=d,T={},E=(E=R)||{},k=Fe(k=q),cn.forEach(function(_t){var wt=(k.match(Rt(_t[0]))||[])[1];switch(_t[2]){case"string":wt&&(E[_t[1]]=ys(wt));break;case"bool":E[_t[1]]=wt==="true";break;case"raw":var Yt=k.match(new RegExp("<"+_t[0]+"[^>]*>([\\s\\S]*?)</"+_t[0]+">"));Yt&&0<Yt.length&&(T[_t[1]]=Yt[1])}}),T.HeadingPairs&&T.TitlesOfParts&&vh(T.HeadingPairs,T.TitlesOfParts,E,I)));var I={};d.bookSheets&&!d.bookProps||x.custprops.length!==0&&(q=Ar(r,yn(x.custprops[0]),!0))&&(I=(function(_t,wt){var Yt={},Jt="",is=_t.match(Dm);if(is)for(var Ds=0;Ds!=is.length;++Ds){var $t=is[Ds],Ct=os($t);switch(Ct[0]){case"<?xml":case"<Properties":break;case"<property":Jt=ys(Ct.name);break;case"</property>":Jt=null;break;default:if($t.indexOf("<vt:")===0){var gs=$t.split(">"),Us=gs[0].slice(4),Os=gs[1];switch(Us){case"lpstr":case"bstr":case"lpwstr":Yt[Jt]=ys(Os);break;case"bool":Yt[Jt]=Ve(Os);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":Yt[Jt]=parseInt(Os,10);break;case"r4":case"r8":case"decimal":Yt[Jt]=parseFloat(Os);break;case"filetime":case"date":Yt[Jt]=Cs(Os);break;case"cy":case"error":Yt[Jt]=ys(Os);break;default:if(Us.slice(-1)=="/")break;wt.WTF&&typeof console<"u"&&console.warn("Unexpected",$t,Us,gs)}}else if($t.slice(0,2)!=="</"&&wt.WTF)throw new Error($t)}}return Yt})(q,d));var J={};if((d.bookSheets||d.bookProps)&&(_.Sheets?h=_.Sheets.map(function(_t){return _t.name}):R.Worksheets&&0<R.SheetNames.length&&(h=R.SheetNames),d.bookProps&&(J.Props=R,J.Custprops=I),d.bookSheets&&h!==void 0&&(J.SheetNames=h),d.bookSheets?J.SheetNames:d.bookProps))return J;h={},q={},d.bookDeps&&x.calcchain&&(q=ha(Pr(r,yn(x.calcchain)),x.calcchain));var Y,z,X=0,ie={},le=_.Sheets;R.Worksheets=le.length,R.SheetNames=[];for(var Ee=0;Ee!=le.length;++Ee)R.SheetNames[Ee]=le[Ee].name;var He=Pe?"bin":"xml",Pe=x.workbooks[0].lastIndexOf("/"),Qe=(x.workbooks[0].slice(0,Pe+1)+"_rels/"+x.workbooks[0].slice(Pe+1)+".rels").replace(/^\//,"");ca(r,Qe)||(Qe="xl/_rels/workbook."+He+".rels");var pt,xt,at,kt=to(Ar(r,Qe,!0),Qe.replace(/_rels.*/,"s5s"));1<=(x.metadata||[]).length&&(d.xlmeta=Ac(Pr(r,yn(x.metadata[0])),x.metadata[0],d)),1<=(x.people||[]).length&&(d.people=(Pe=Pr(r,yn(x.people[0])),pt=d,at=!(xt=[]),Pe.replace(Jr,function(_t){var wt=os(_t);switch(kn(wt[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":xt.push({name:wt.displayname,id:wt.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":at=!0;break;case"</ext>":at=!1;break;default:if(!at&&pt.WTF)throw new Error("unrecognized "+wt[0]+" in threaded comments")}return _t}),xt)),kt=kt&&s1(kt,_.Sheets);var Wt=Pr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(X=0;X!=R.Worksheets;++X){var Ht="sheet";if(kt&&kt[X]?(Y="xl/"+kt[X][1].replace(/[\/]?xl\//,""),ca(r,Y)||(Y=kt[X][1]),ca(r,Y)||(Y=Qe.replace(/_rels\/.*$/,"")+kt[X][1]),Ht=kt[X][2]):Y=(Y="xl/worksheets/sheet"+(X+1-Wt)+"."+He).replace(/sheet0\./,"sheet."),z=Y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),d&&d.sheets!=null)switch(typeof d.sheets){case"number":if(X!=d.sheets)continue e;break;case"string":if(R.SheetNames[X].toLowerCase()!=d.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(d.sheets)){for(var Mt=!1,Ot=0;Ot!=d.sheets.length;++Ot)typeof d.sheets[Ot]=="number"&&d.sheets[Ot]==X&&(Mt=1),typeof d.sheets[Ot]=="string"&&d.sheets[Ot].toLowerCase()==R.SheetNames[X].toLowerCase()&&(Mt=1);if(!Mt)continue e}}r1(r,Y,z,R.SheetNames[X],X,ie,h,Ht,d,_,y,j)}return J={Directory:x,Workbook:_,Props:R,Custprops:I,Deps:q,Sheets:h,SheetNames:R.SheetNames,Strings:vc,Styles:j,Themes:y,SSF:sr(V)},d&&d.bookFiles&&(r.files?(J.keys=b,J.files=r.files):(J.keys=[],J.files={},r.FullPaths.forEach(function(_t,wt){_t=_t.replace(/^Root Entry[\/]/,""),J.keys.push(_t),J.files[_t]=r.FileIndex[wt]}))),d&&d.bookVBA&&(0<x.vba.length?J.vbaraw=Pr(r,yn(x.vba[0]),!0):x.defaults&&x.defaults.bin===ia&&(J.vbaraw=Pr(r,"xl/vbaProject.bin",!0))),J}function mr(r,d){var u,h=d||{},g="Workbook",b=Tt.find(r,g);try{if(g="/!DataSpaces/Version",!(b=Tt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(x=b.content,(u={}).id=x.read_shift(0,"lpp4"),u.R=Xn(x,4),u.U=Xn(x,4),u.W=Xn(x,4),g="/!DataSpaces/DataSpaceMap",!(b=Tt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);var x=Oh(b.content);if(x.length!==1||x[0].comps.length!==1||x[0].comps[0].t!==0||x[0].name!=="StrongEncryptionDataSpace"||x[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+g);if(g="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(b=Tt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(x=(function(y){var j=[];y.l+=4;for(var k=y.read_shift(4);0<k--;)j.push(y.read_shift(0,"lpp4"));return j})(b.content),x.length!=1||x[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+g);if(g="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(b=Tt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);Im(b.content)}catch{}if(g="/EncryptionInfo",!(b=Tt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(d=Bm(b.content),g="/EncryptedPackage",!(b=Tt.find(r,g))||!b.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],b.content,h.password||"",h);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],b.content,h.password||"",h);throw new Error("File is password-protected")}function Tf(r,d){return(d.bookType=="ods"?el:d.bookType=="numbers"?Wd:d.bookType=="xlsb"?function(u,h){Fl=1024,u&&!u.SSF&&(u.SSF=sr(V)),u&&u.SSF&&(ll(),Bo(u.SSF),h.revssf=Ei(u.SSF),h.revssf[u.SSF[65535]]=0,h.ssf=u.SSF),h.rels={},h.wbrels={},h.Strings=[],h.Strings.Count=0,h.Strings.Unique=0,wc?h.revStrings=new Map:(h.revStrings={},h.revStrings.foo=[],delete h.revStrings.foo);var g=h.bookType=="xlsb"?"bin":"xml",b=-1<ba.indexOf(h.bookType),x=wl();Mu(h=h||{});var y=Ir(),j="",k=0;if(h.cellXfs=[],Gi(h.cellXfs,{},{revssf:{General:0}}),u.Props||(u.Props={}),us(y,j="docProps/core.xml",nd(u.Props,h)),x.coreprops.push(j),ir(h.rels,2,j,Ns.CORE_PROPS),j="docProps/app.xml",!u.Props||!u.Props.SheetNames)if(u.Workbook&&u.Workbook.Sheets){for(var E=[],T=0;T<u.SheetNames.length;++T)(u.Workbook.Sheets[T]||{}).Hidden!=2&&E.push(u.SheetNames[T]);u.Props.SheetNames=E}else u.Props.SheetNames=u.SheetNames;for(u.Props.Worksheets=u.Props.SheetNames.length,us(y,j,D0(u.Props)),x.extprops.push(j),ir(h.rels,3,j,Ns.EXT_PROPS),u.Custprops!==u.Props&&0<wr(u.Custprops||{}).length&&(us(y,j="docProps/custom.xml",dn(u.Custprops)),x.custprops.push(j),ir(h.rels,4,j,Ns.CUST_PROPS)),k=1;k<=u.SheetNames.length;++k){var _,R,q,I={"!id":{}},J=u.Sheets[u.SheetNames[k-1]];us(y,j="xl/worksheets/sheet"+k+"."+g,(function(Y,z,X,ie,le){return(z.slice(-4)===".bin"?rr:fu)(Y,X,ie,le)})(k-1,j,h,u,I)),x.sheets.push(j),ir(h.wbrels,-1,"worksheets/sheet"+k+"."+g,Ns.WS[0]),J&&(_=J["!comments"],R=!1,q="",_&&0<_.length&&(us(y,q="xl/comments"+k+"."+g,(function(Y,z,X){return(z.slice(-4)===".bin"?sf:ag)(Y)})(_,q)),x.comments.push(q),ir(I,-1,"../comments"+k+"."+g,Ns.CMNT),R=!0),J["!legacy"]&&R&&us(y,"xl/drawings/vmlDrawing"+k+".vml",ef(k,J["!comments"])),delete J["!comments"],delete J["!legacy"]),I["!id"].rId1&&us(y,jl(j),En(I))}return h.Strings!=null&&0<h.Strings.length&&(us(y,j="xl/sharedStrings."+g,(function(Y,z,X){return(z.slice(-4)===".bin"?qi:bd)(Y,X)})(h.Strings,j,h)),x.strs.push(j),ir(h.wbrels,-1,"sharedStrings."+g,Ns.SST)),us(y,j="xl/workbook."+g,(function(Y,z,X){return(z.slice(-4)===".bin"?Xa:pu)(Y)})(u,j)),x.workbooks.push(j),ir(h.rels,1,j,Ns.WB),us(y,j="xl/theme/theme1.xml",su(u.Themes,h)),x.themes.push(j),ir(h.wbrels,-1,"theme/theme1.xml",Ns.THEME),us(y,j="xl/styles."+g,(function(Y,z,X){return(z.slice(-4)===".bin"?Xm:Gh)(Y,X)})(u,j,h)),x.styles.push(j),ir(h.wbrels,-1,"styles."+g,Ns.STY),u.vbaraw&&b&&(us(y,j="xl/vbaProject.bin",u.vbaraw),x.vba.push(j),ir(h.wbrels,-1,"vbaProject.bin",Ns.VBA)),us(y,j="xl/metadata."+g,(function(Y){return(Y.slice(-4)===".bin"?ru:Zh)()})(j)),x.metadata.push(j),ir(h.wbrels,-1,"metadata."+g,Ns.XLMETA),us(y,"[Content_Types].xml",C0(x,h)),us(y,"_rels/.rels",En(h.rels)),us(y,"xl/_rels/workbook."+g+".rels",En(h.wbrels)),delete h.revssf,delete h.ssf,y}:wa)(r,d)}function wa(r,d){Fl=1024,r&&!r.SSF&&(r.SSF=sr(V)),r&&r.SSF&&(ll(),Bo(r.SSF),d.revssf=Ei(r.SSF),d.revssf[r.SSF[65535]]=0,d.ssf=r.SSF),d.rels={},d.wbrels={},d.Strings=[],d.Strings.Count=0,d.Strings.Unique=0,wc?d.revStrings=new Map:(d.revStrings={},d.revStrings.foo=[],delete d.revStrings.foo);var u="xml",h=-1<ba.indexOf(d.bookType),g=wl();Mu(d=d||{});var b=Ir(),x="",y=0;if(d.cellXfs=[],Gi(d.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),x="docProps/core.xml",us(b,x,nd(r.Props,d)),g.coreprops.push(x),ir(d.rels,2,x,Ns.CORE_PROPS),x="docProps/app.xml",!r.Props||!r.Props.SheetNames)if(r.Workbook&&r.Workbook.Sheets){for(var j=[],k=0;k<r.SheetNames.length;++k)(r.Workbook.Sheets[k]||{}).Hidden!=2&&j.push(r.SheetNames[k]);r.Props.SheetNames=j}else r.Props.SheetNames=r.SheetNames;r.Props.Worksheets=r.Props.SheetNames.length,us(b,x,D0(r.Props)),g.extprops.push(x),ir(d.rels,3,x,Ns.EXT_PROPS),r.Custprops!==r.Props&&0<wr(r.Custprops||{}).length&&(us(b,x="docProps/custom.xml",dn(r.Custprops)),g.custprops.push(x),ir(d.rels,4,x,Ns.CUST_PROPS));var E,T=["SheetJ5"];for(d.tcid=0,y=1;y<=r.SheetNames.length;++y){var _,R,q,I,J={"!id":{}},Y=r.Sheets[r.SheetNames[y-1]];us(b,x="xl/worksheets/sheet"+y+"."+u,fu(y-1,d,r,J)),g.sheets.push(x),ir(d.wbrels,-1,"worksheets/sheet"+y+"."+u,Ns.WS[0]),Y&&(R=!1,q="",(_=Y["!comments"])&&0<_.length&&(I=!1,_.forEach(function(z){z[1].forEach(function(X){X.T==1&&(I=!0)})}),I&&(us(b,q="xl/threadedComments/threadedComment"+y+"."+u,(function(z,X,ie){var le=[jr,Bt("ThreadedComments",null,{xmlns:Wr.TCMNT}).replace(/[\/]>/,">")];return z.forEach(function(Ee){var He="";(Ee[1]||[]).forEach(function(Pe,Qe){var pt;Pe.T?(Pe.a&&X.indexOf(Pe.a)==-1&&X.push(Pe.a),pt={ref:Ee[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+ie.tcid++).slice(-12)+"}"},Qe==0?He=pt.id:pt.parentId=He,Pe.ID=pt.id,Pe.a&&(pt.personId="{54EE7950-7262-4200-6969-"+("000000000000"+X.indexOf(Pe.a)).slice(-12)+"}"),le.push(Bt("threadedComment",Hs("text",Pe.t||""),pt))):delete Pe.ID})}),le.push("</ThreadedComments>"),le.join("")})(_,T,d)),g.threadedcomments.push(q),ir(J,-1,"../threadedComments/threadedComment"+y+"."+u,Ns.TCMNT)),us(b,q="xl/comments"+y+"."+u,ag(_)),g.comments.push(q),ir(J,-1,"../comments"+y+"."+u,Ns.CMNT),R=!0),Y["!legacy"]&&R&&us(b,"xl/drawings/vmlDrawing"+y+".vml",ef(y,Y["!comments"])),delete Y["!comments"],delete Y["!legacy"]),J["!id"].rId1&&us(b,jl(x),En(J))}return d.Strings!=null&&0<d.Strings.length&&(us(b,x="xl/sharedStrings.xml",bd(d.Strings,d)),g.strs.push(x),ir(d.wbrels,-1,"sharedStrings.xml",Ns.SST)),us(b,x="xl/workbook.xml",pu(r)),g.workbooks.push(x),ir(d.rels,1,x,Ns.WB),us(b,x="xl/theme/theme1.xml",su(r.Themes,d)),g.themes.push(x),ir(d.wbrels,-1,"theme/theme1.xml",Ns.THEME),us(b,x="xl/styles.xml",Gh(r,d)),g.styles.push(x),ir(d.wbrels,-1,"styles.xml",Ns.STY),r.vbaraw&&h&&(us(b,x="xl/vbaProject.bin",r.vbaraw),g.vba.push(x),ir(d.wbrels,-1,"vbaProject.bin",Ns.VBA)),us(b,x="xl/metadata.xml",Zh()),g.metadata.push(x),ir(d.wbrels,-1,"metadata.xml",Ns.XLMETA),1<T.length&&(us(b,x="xl/persons/person.xml",(h=T,E=[jr,Bt("personList",null,{xmlns:Wr.TCMNT,"xmlns:x":xl[0]}).replace(/[\/]>/,">")],h.forEach(function(z,X){E.push(Bt("person",null,{displayName:z,id:"{54EE7950-7262-4200-6969-"+("000000000000"+X).slice(-12)+"}",userId:z,providerId:"None"}))}),E.push("</personList>"),E.join(""))),g.people.push(x),ir(d.wbrels,-1,"persons/person.xml",Ns.PEOPLE)),us(b,"[Content_Types].xml",C0(g,d)),us(b,"_rels/.rels",En(d.rels)),us(b,"xl/_rels/workbook.xml.rels",En(d.wbrels)),delete d.revssf,delete d.ssf,b}function _f(r,d){var u="";switch((d||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":u=ke(r.slice(0,12));break;case"binary":u=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(d&&d.type||"undefined"))}return[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3),u.charCodeAt(4),u.charCodeAt(5),u.charCodeAt(6),u.charCodeAt(7)]}function Ff(r,d){var u=0;e:for(;u<r.length;)switch(r.charCodeAt(u)){case 10:case 13:case 32:++u;break;case 60:return $a(r.slice(u),d);default:break e}return Wi.to_workbook(r,d)}function Mf(r,d,u,h){return h?(u.type="string",Wi.to_workbook(r,u)):Wi.to_workbook(d,u)}function _c(r,d){L();var u=d||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return _c(new Uint8Array(r),((u=sr(u)).type="array",u));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!u.type&&(u.type=typeof Deno<"u"?"buffer":"array");var h,g,b,x,y,j=r,k=!1;if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),Ll={},u.dateNF&&(Ll.dateNF=u.dateNF),u.type||(u.type=xe&&Buffer.isBuffer(r)?"buffer":"base64"),u.type=="file"&&(u.type=xe?"buffer":"binary",j=(function(T){if(Ta!==void 0)return Ta.readFileSync(T);if(typeof Deno<"u")return Deno.readFileSync(T);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var _=File(T);_.open("r"),_.encoding="binary";var R=_.read();return _.close(),R}catch(q){if(!q.message||!q.message.match(/onstruct/))throw q}throw new Error("Cannot access file "+T)})(r),typeof Uint8Array>"u"||xe||(u.type="array")),u.type=="string"&&(k=!0,u.type="binary",u.codepage=65001,j=(E=r).match(/[^\x00-\x7F]/)?At(E):E),u.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var E=new ArrayBuffer(3),E=new Uint8Array(E);if(E.foo="bar",!E.foo)return(u=sr(u)).type="array",_c(oe(j),u)}switch((h=_f(j,u))[0]){case 208:if(h[1]===207&&h[2]===17&&h[3]===224&&h[4]===161&&h[5]===177&&h[6]===26&&h[7]===225)return x=Tt.read(j,u),y=u,(Tt.find(x,"EncryptedPackage")?mr:zd)(x,y);break;case 9:if(h[1]<=8)return zd(j,u);break;case 60:return $a(j,u);case 73:if(h[1]===73&&h[2]===42&&h[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(h[1]===68)return(function(T,_){var R=_||{},q=!!R.WTF;R.WTF=!0;try{var I=ud.to_workbook(T,R);return R.WTF=q,I}catch(J){if(R.WTF=q,!J.message.match(/SYLK bad record ID/)&&q)throw J;return Wi.to_workbook(T,_)}})(j,u);break;case 84:if(h[1]===65&&h[2]===66&&h[3]===76)return Eh.to_workbook(j,u);break;case 80:return h[1]===75&&h[2]<9&&h[3]<9?(b=y=j,(g=(g=u)||{}).type||(g.type=xe&&Buffer.isBuffer(y)?"buffer":"base64"),Df(hl(b,g),g)):Mf(r,j,u,k);case 239:return h[3]===60?$a(j,u):Mf(r,j,u,k);case 255:if(h[1]===254)return b=j,(g=u).type=="base64"&&(b=ke(b)),b=e.utils.decode(1200,b.slice(2),"str"),g.type="binary",Ff(b,g);if(h[1]===0&&h[2]===2&&h[3]===0)return ua.to_workbook(j,u);break;case 0:if(h[1]===0&&(2<=h[2]&&h[3]===0||h[2]===0&&(h[3]===8||h[3]===9)))return ua.to_workbook(j,u);break;case 3:case 131:case 139:case 140:return B0.to_workbook(j,u);case 123:if(h[1]===92&&h[2]===114&&h[3]===116)return X0.to_workbook(j,u);break;case 10:case 13:case 32:return(function(T,_){var R="",q=_f(T,_);switch(_.type){case"base64":R=ke(T);break;case"binary":R=T;break;case"buffer":R=T.toString("binary");break;case"array":R=_a(T);break;default:throw new Error("Unrecognized type "+_.type)}return q[0]==239&&q[1]==187&&q[2]==191&&(R=Fe(R)),_.type="binary",Ff(R,_)})(j,u);case 137:if(h[1]===80&&h[2]===78&&h[3]===71)throw new Error("PNG Image File is not a spreadsheet")}return-1<oo.indexOf(h[0])&&h[2]<=12&&h[3]<=31?B0.to_workbook(j,u):Mf(r,j,u,k)}function Lu(r,d){return d=d||{},d.type="file",_c(r,d)}function qd(r,d){switch(d.type){case"base64":case"binary":break;case"buffer":case"array":d.type="";break;case"file":return Uo(d.file,Tt.write(r,{type:xe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+d.bookType+"' files");default:throw new Error("Unrecognized type "+d.type)}return Tt.write(r,d)}function Lf(r,d){var u={},h=xe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(d.compression&&(u.compression="DEFLATE"),d.password)u.type=h;else switch(d.type){case"base64":u.type="base64";break;case"binary":u.type="string";break;case"string":throw new Error("'string' output type invalid for '"+d.bookType+"' files");case"buffer":case"file":u.type=h;break;default:throw new Error("Unrecognized type "+d.type)}if(r=r.FullPaths?Tt.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[u.type]||u.type,compression:!!d.compression}):r.generate(u),typeof Deno<"u"&&typeof r=="string"){if(d.type=="binary"||d.type=="base64")return r;r=new Uint8Array(Re(r))}return d.password&&typeof encrypt_agile<"u"?qd(encrypt_agile(r,d.password),d):d.type==="file"?Uo(d.file,r):d.type=="string"?Fe(r):r}function ei(r,d,u){var h=(u=u||"")+r;switch(d.type){case"base64":return re(At(h));case"binary":return At(h);case"string":return r;case"file":return Uo(d.file,h,"utf8");case"buffer":return xe?je(h,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(h):ei(h,{type:"binary"}).split("").map(function(g){return g.charCodeAt(0)})}throw new Error("Unrecognized type "+d.type)}function Fc(r,d){switch(d.type){case"string":case"base64":case"binary":for(var u="",h=0;h<r.length;++h)u+=String.fromCharCode(r[h]);return d.type=="base64"?re(u):d.type=="string"?Fe(u):u;case"file":return Uo(d.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+d.type)}}function Yd(r,d){L(),Zi(r);var u,h=sr(d||{});return h.cellStyles&&(h.cellNF=!0,h.sheetStubs=!0),h.type!="array"?(u=r,d=sr((d=h)||{}),Lf(wa(u,d),d)):(h.type="binary",r=Yd(r,h),h.type="array",Re(r))}function Ru(r,d){L(),Zi(r);var u=sr(d||{});if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),u.type=="array")return u.type="binary",d=Ru(r,u),u.type="array",Re(d);var h,g,b,x=0;if(u.sheet&&(x=typeof u.sheet=="number"?u.sheet:r.SheetNames.indexOf(u.sheet),!r.SheetNames[x]))throw new Error("Sheet not found: "+u.sheet+" : "+typeof u.sheet);switch(u.bookType||"xlsb"){case"xml":case"xlml":return ei(Il(r,u),u);case"slk":case"sylk":return ei(ud.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"htm":case"html":return ei(_g(r.Sheets[r.SheetNames[x]],u),u);case"txt":return(function(y,j){switch(j.type){case"base64":return re(y);case"binary":case"string":return y;case"file":return Uo(j.file,y,"binary");case"buffer":return xe?je(y,"binary"):y.split("").map(function(k){return k.charCodeAt(0)})}throw new Error("Unrecognized type "+j.type)})(Of(r.Sheets[r.SheetNames[x]],u),u);case"csv":return ei(Iu(r.Sheets[r.SheetNames[x]],u),u,"\uFEFF");case"dif":return ei(Eh.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"dbf":return Fc(B0.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"prn":return ei(Wi.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"rtf":return ei(X0.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"eth":return ei(cc.from_sheet(r.Sheets[r.SheetNames[x]],u),u);case"fods":return ei(el(r,u),u);case"wk1":return Fc(ua.sheet_to_wk1(r.Sheets[r.SheetNames[x]],u),u);case"wk3":return Fc(ua.book_to_wk3(r,u),u);case"biff2":u.biff||(u.biff=2);case"biff3":u.biff||(u.biff=3);case"biff4":return u.biff||(u.biff=4),Fc(wf(r,u),u);case"biff5":u.biff||(u.biff=5);case"biff8":case"xla":case"xls":return u.biff||(u.biff=8),qd(Nu(r,b=(b=u)||{}),b);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return h=r,b=sr((g=u)||{}),kd=new zg(g),Lf(Tf(h,b),b);default:throw new Error("Unrecognized bookType |"+u.bookType+"|")}}function Ou(r){var d;r.bookType||((d=r.file.slice(r.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(r.bookType=d.slice(1)),r.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[r.bookType]||r.bookType)}function Ig(r,d,u){return u=u||{},u.type="file",u.file=d,Ou(u),Ru(r,u)}function Rf(r,d,u,h,g,b,x,y){var j=Br(u),k=y.defval,E=y.raw||!Object.prototype.hasOwnProperty.call(y,"raw"),T=!0,_=g===1?[]:{};if(g!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:u,enumerable:!1})}catch{_.__rowNum__=u}else _.__rowNum__=u;if(!x||r[u])for(var R=d.s.c;R<=d.e.c;++R){var q=x?r[u][R]:r[h[R]+j];if(q!==void 0&&q.t!==void 0){var I=q.v;switch(q.t){case"z":if(I==null)break;continue;case"e":I=I==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+q.t)}if(b[R]!=null){if(I==null)if(q.t=="e"&&I===null)_[b[R]]=null;else if(k!==void 0)_[b[R]]=k;else{if(!E||I!==null)continue;_[b[R]]=null}else _[b[R]]=E&&(q.t!=="n"||q.t==="n"&&y.rawNumbers!==!1)?I:ci(q,I,y);I!=null&&(T=!1)}}else k!==void 0&&b[R]!=null&&(_[b[R]]=k)}return{row:_,isempty:T}}function Pu(r,d){if(r==null||r["!ref"]==null)return[];var u,h={t:"n",v:0},g=0,b=1,x=[],y="",j={s:{r:0,c:0},e:{r:0,c:0}},k=d||{},E=k.range!=null?k.range:r["!ref"];switch(k.header===1?g=1:k.header==="A"?g=2:Array.isArray(k.header)?g=3:k.header==null&&(g=0),typeof E){case"string":j=Fs(E);break;case"number":(j=Fs(r["!ref"])).s.r=E;break;default:j=E}0<g&&(b=0);var T=Br(j.s.r),_=[],R=[],q=0,I=0,J=Array.isArray(r),Y=j.s.r,z=0,X={};J&&!r[Y]&&(r[Y]=[]);for(var ie,le=k.skipHidden&&r["!cols"]||[],Ee=k.skipHidden&&r["!rows"]||[],z=j.s.c;z<=j.e.c;++z)if(!(le[z]||{}).hidden)switch(_[z]=Er(z),h=J?r[Y][z]:r[_[z]+T],g){case 1:x[z]=z-j.s.c;break;case 2:x[z]=_[z];break;case 3:x[z]=k.header[z-j.s.c];break;default:if(y=u=ci(h=h??{w:"__EMPTY",t:"s"},null,k),I=X[u]||0){for(;y=u+"_"+I++,X[y];);X[u]=I,X[y]=1}else X[u]=1;x[z]=y}for(Y=j.s.r+b;Y<=j.e.r;++Y)(Ee[Y]||{}).hidden||(ie=Rf(r,j,Y,_,g,x,J,k)).isempty!==!1&&(g===1?k.blankrows===!1:!k.blankrows)||(R[q++]=ie.row);return R.length=q,R}var Bg=/"/g;function rl(r,d,u,h,g,b,x,y){for(var j=!0,k=[],E="",T=Br(u),_=d.s.c;_<=d.e.c;++_)if(h[_]){var R=y.dense?(r[u]||[])[_]:r[h[_]+T];if(R==null)E="";else if(R.v!=null){j=!1,E=""+(y.rawNumbers&&R.t=="n"?R.v:ci(R,null,y));for(var q,I=0;I!==E.length;++I)if((q=E.charCodeAt(I))===g||q===b||q===34||y.forceQuotes){E='"'+E.replace(Bg,'""')+'"';break}E=="ID"&&(E='"ID"')}else R.f==null||R.F?E="":(j=!1,0<=(E="="+R.f).indexOf(",")&&(E='"'+E.replace(Bg,'""')+'"'));k.push(E)}return y.blankrows===!1&&j?null:k.join(x)}function Iu(r,d){var u=[],h=d??{};if(r==null||r["!ref"]==null)return"";var g=Fs(r["!ref"]),b=h.FS!==void 0?h.FS:",",x=b.charCodeAt(0),y=h.RS!==void 0?h.RS:`
`,j=y.charCodeAt(0),k=new RegExp((b=="|"?"\\|":b)+"+$"),E="",T=[];h.dense=Array.isArray(r);for(var _=h.skipHidden&&r["!cols"]||[],R=h.skipHidden&&r["!rows"]||[],q=g.s.c;q<=g.e.c;++q)(_[q]||{}).hidden||(T[q]=Er(q));for(var I=0,J=g.s.r;J<=g.e.r;++J)(R[J]||{}).hidden||(E=rl(r,g,J,T,x,j,b,h))!=null&&(!(E=h.strip?E.replace(k,""):E)&&h.blankrows===!1||u.push((I++?y:"")+E));return delete h.dense,u.join("")}function Of(r,d){return(d=d||{}).FS="	",d.RS=`
`,r=Iu(r,d),e===void 0||d.type=="string"?r:(r=e.utils.encode(1200,r,"str"),""+r)}function Bu(E,d,u){var h,g=u||{},b=+!g.skipHeader,x=E||{},y=0,j=0;x&&g.origin!=null&&(typeof g.origin=="number"?y=g.origin:(k=typeof g.origin=="string"?zr(g.origin):g.origin,y=k.r,j=k.c));var k,E={s:{c:0,r:0},e:{c:j,r:y+d.length-1+b}};x["!ref"]?(k=Fs(x["!ref"]),E.e.c=Math.max(E.e.c,k.e.c),E.e.r=Math.max(E.e.r,k.e.r),y==-1&&(y=k.e.r+1,E.e.r=y+d.length-1+b)):y==-1&&(y=0,E.e.r=d.length-1+b);var T=g.header||[],_=0;d.forEach(function(q,I){wr(q).forEach(function(ie){(_=T.indexOf(ie))==-1&&(T[_=T.length]=ie);var Y=q[ie],z="z",X="",ie=bs({c:j+_,r:y+I+b});h=zu(x,ie),!Y||typeof Y!="object"||Y instanceof Date?(typeof Y=="number"?z="n":typeof Y=="boolean"?z="b":typeof Y=="string"?z="s":Y instanceof Date?(z="d",g.cellDates||(z="n",Y=Sr(Y)),X=g.dateNF||V[14]):Y===null&&g.nullError&&(z="e",Y=0),h?(h.t=z,h.v=Y,delete h.w,delete h.R,X&&(h.z=X)):x[ie]=h={t:z,v:Y},X&&(h.z=X)):x[ie]=Y})}),E.e.c=Math.max(E.e.c,j+T.length-1);var R=Br(y);if(b)for(_=0;_<T.length;++_)x[Er(_+j)+R]={t:"s",v:T[_]};return x["!ref"]=Ss(E),x}function zu(r,d,u){return typeof d!="string"?zu(r,bs(typeof d!="number"?d:{r:d,c:u||0})):Array.isArray(r)?(u=zr(d),r[u.r]||(r[u.r]=[]),r[u.r][u.c]||(r[u.r][u.c]={t:"z"})):r[d]||(r[d]={t:"z"})}function Pf(){return{SheetNames:[],Sheets:{}}}function Uu(r,d,u,h){var g=1;if(!u)for(;g<=65535&&r.SheetNames.indexOf(u="Sheet"+g)!=-1;++g,u=void 0);if(!u||65535<=r.SheetNames.length)throw new Error("Too many worksheets");if(h&&0<=r.SheetNames.indexOf(u)){var h=u.match(/(^.*?)(\d+)$/),g=h&&+h[2]||0,b=h&&h[1]||u;for(++g;g<=65535&&r.SheetNames.indexOf(u=b+g)!=-1;++g);}if(Ur(u),0<=r.SheetNames.indexOf(u))throw new Error("Worksheet with name |"+u+"| already exists!");return r.SheetNames.push(u),r.Sheets[u]=d,u}function Hu(r,d,u){return d?(r.l={Target:d},u&&(r.l.Tooltip=u)):delete r.l,r}var Mc,If={encode_col:Er,encode_row:Br,encode_cell:bs,encode_range:Ss,decode_col:yl,decode_row:b0,split_cell:function(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:zr,decode_range:La,format_cell:ci,sheet_add_aoa:fh,sheet_add_json:Bu,sheet_add_dom:kf,aoa_to_sheet:Ql,json_to_sheet:function(r,d){return Bu(null,r,d)},table_to_sheet:Fg,table_to_book:function(r,d){return Vn(Fg(r,d),d)},sheet_to_csv:Iu,sheet_to_txt:Of,sheet_to_json:Pu,sheet_to_html:_g,sheet_to_formulae:function(r){var d,u="",h="";if(r==null||r["!ref"]==null)return[];for(var g,b=Fs(r["!ref"]),x=[],y=[],j=Array.isArray(r),k=b.s.c;k<=b.e.c;++k)x[k]=Er(k);for(var E=b.s.r;E<=b.e.r;++E)for(g=Br(E),k=b.s.c;k<=b.e.c;++k)if(u=x[k]+g,h="",(d=j?(r[E]||[])[k]:r[u])!==void 0){if(d.F!=null){if(u=d.F,!d.f)continue;h=d.f,u.indexOf(":")==-1&&(u=u+":"+u)}if(d.f!=null)h=d.f;else{if(d.t=="z")continue;if(d.t=="n"&&d.v!=null)h=""+d.v;else if(d.t=="b")h=d.v?"TRUE":"FALSE";else if(d.w!==void 0)h="'"+d.w;else{if(d.v===void 0)continue;h=d.t=="s"?"'"+d.v:""+d.v}}y[y.length]=u+"="+h}return y},sheet_to_row_object_array:Pu,sheet_get_cell:zu,book_new:Pf,book_append_sheet:Uu,book_set_sheet_visibility:function(r,d,u){switch(r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]),d=(function(h,g){if(typeof g=="number"){if(0<=g&&h.SheetNames.length>g)return g;throw new Error("Cannot find sheet # "+g)}if(typeof g!="string")throw new Error("Cannot find sheet |"+g+"|");if(-1<(h=h.SheetNames.indexOf(g)))return h;throw new Error("Cannot find sheet name |"+g+"|")})(r,d),r.Workbook.Sheets[d]||(r.Workbook.Sheets[d]={}),u){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+u)}r.Workbook.Sheets[d].Hidden=u},cell_set_number_format:function(r,d){return r.z=d,r},cell_set_hyperlink:Hu,cell_set_internal_link:function(r,d,u){return Hu(r,"#"+d,u)},cell_add_comment:function(r,d,u){r.c||(r.c=[]),r.c.push({t:d,a:u||"SheetJS"})},sheet_set_array_formula:function(r,d,u,h){for(var g=typeof d!="string"?d:Fs(d),b=typeof d=="string"?d:Ss(d),x=g.s.r;x<=g.e.r;++x)for(var y=g.s.c;y<=g.e.c;++y){var j=zu(r,x,y);j.t="n",j.F=b,delete j.v,x==g.s.r&&y==g.s.c&&(j.f=u,h&&(j.D=!0))}return r},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function vn(r){Mc=r}var Bl={to_json:function(r,d){var u=Mc({objectMode:!0});if(r==null||r["!ref"]==null)return u.push(null),u;var h,g={t:"n",v:0},b=0,x=1,y=[],j="",k={s:{r:0,c:0},e:{r:0,c:0}},E=d||{},T=E.range!=null?E.range:r["!ref"];switch(E.header===1?b=1:E.header==="A"?b=2:Array.isArray(E.header)&&(b=3),typeof T){case"string":k=Fs(T);break;case"number":(k=Fs(r["!ref"])).s.r=T;break;default:k=T}0<b&&(x=0);var _=Br(k.s.r),R=[],q=0,I=Array.isArray(r),J=k.s.r,Y=0,z={};I&&!r[J]&&(r[J]=[]);for(var X=E.skipHidden&&r["!cols"]||[],ie=E.skipHidden&&r["!rows"]||[],Y=k.s.c;Y<=k.e.c;++Y)if(!(X[Y]||{}).hidden)switch(R[Y]=Er(Y),g=I?r[J][Y]:r[R[Y]+_],b){case 1:y[Y]=Y-k.s.c;break;case 2:y[Y]=R[Y];break;case 3:y[Y]=E.header[Y-k.s.c];break;default:if(j=h=ci(g=g??{w:"__EMPTY",t:"s"},null,E),q=z[h]||0){for(;j=h+"_"+q++,z[j];);z[h]=q,z[j]=1}else z[h]=1;y[Y]=j}return J=k.s.r+x,u._read=function(){for(;J<=k.e.r;)if(!(ie[J-1]||{}).hidden){var le=Rf(r,k,J,R,b,y,I,E);if(++J,le.isempty===!1||(b===1?E.blankrows!==!1:E.blankrows))return void u.push(le.row)}return u.push(null)},u},to_html:function(r,g){var u=Mc(),h=g||{},g=h.header!=null?h.header:Nf,b=h.footer!=null?h.footer:lr;u.push(g);var x=La(r["!ref"]);h.dense=Array.isArray(r),u.push(Cu(0,0,h));var y=x.s.r,j=!1;return u._read=function(){if(y>x.e.r)return j||(j=!0,u.push("</table>"+b)),u.push(null);for(;y<=x.e.r;){u.push(jf(r,x,y,h)),++y;break}},u},to_csv:function(r,d){var u=Mc(),h=d??{};if(r==null||r["!ref"]==null)return u.push(null),u;var g=Fs(r["!ref"]),b=h.FS!==void 0?h.FS:",",x=b.charCodeAt(0),y=h.RS!==void 0?h.RS:`
`,j=y.charCodeAt(0),k=new RegExp((b=="|"?"\\|":b)+"+$"),E="",T=[];h.dense=Array.isArray(r);for(var _=h.skipHidden&&r["!cols"]||[],R=h.skipHidden&&r["!rows"]||[],q=g.s.c;q<=g.e.c;++q)(_[q]||{}).hidden||(T[q]=Er(q));var I=g.s.r,J=!1,Y=0;return u._read=function(){if(!J)return J=!0,u.push("\uFEFF");for(;I<=g.e.r;)if(++I,!(R[I-1]||{}).hidden&&(E=rl(r,g,I-1,T,x,j,b,h),E!=null&&((E=h.strip?E.replace(k,""):E)||h.blankrows!==!1)))return u.push((Y++?y:"")+E);return u.push(null)},u},set_readable:vn},$s=(function(){function r(d,u,h){return this instanceof r?(this.tagName=d,this._attributes=u||{},this._children=h||[],this._prefix="",this):new r(d,u,h)}return r.prototype.createElement=function(){return new r(arguments)},r.prototype.children=function(){return this._children},r.prototype.append=function(d){return this._children.push(d),this},r.prototype.prefix=function(d){return arguments.length==0?this._prefix:(this._prefix=d,this)},r.prototype.attr=function(d,u){if(u==null)return delete this._attributes[d],this;if(arguments.length==0)return this._attributes;if(typeof d=="string"&&arguments.length==1)return this._attributes.attr[d];if(typeof d=="object"&&arguments.length==1)for(var h in d)this._attributes[h]=d[h];else arguments.length==2&&typeof d=="string"&&(this._attributes[d]=u);return this},r.prototype.escapeAttributeValue=function(d){return'"'+d.replace(/\"/g,"&quot;")+'"'},r.prototype.toXml=function(d){var u=(d=d||this)._prefix;if(u+="<"+d.tagName,d._attributes)for(var h in d._attributes)u+=" "+h+"="+this.escapeAttributeValue(""+d._attributes[h]);if(d._children&&0<d._children.length){u+=">";for(var g=0;g<d._children.length;g++)u+=this.toXml(d._children[g]);u+="</"+d.tagName+">"}else u+="/>";return u},r})(),zg=function(r){var d,u=164,h={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},g={};for(d in h)g[h[d]]=d;var b={};return{initialize:function(x){this.$fonts=$s("fonts").attr("count",0).attr("x14ac:knownFonts","1"),this.$fills=$s("fills").attr("count",0),this.$borders=$s("borders").attr("count",0),this.$numFmts=$s("numFmts").attr("count",0),this.$cellStyleXfs=$s("cellStyleXfs"),this.$xf=$s("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0),this.$cellXfs=$s("cellXfs").attr("count",0),this.$cellStyles=$s("cellStyles").append($s("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0)),this.$dxfs=$s("dxfs").attr("count","0"),this.$tableStyles=$s("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4"),this.$styles=$s("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);var y=x.defaultCellStyle||{};return y.font||(y.font={name:"Calibri",sz:"11"}),y.font.name||(y.font.name="Calibri"),y.font.sz||(y.font.sz=11),y.fill||(y.fill={patternType:"none",fgColor:{}}),y.border||(y.border={}),y.numFmt||(y.numFmt=0),this.defaultStyle=y,x=JSON.parse(JSON.stringify(y)),x.fill={patternType:"gray125",fgColor:{}},this.addStyles([y,x]),this},addStyle:function(x){var y=JSON.stringify(x),j=b[y];return j==null?(j=this._addXf(x),b[y]=j):j=b[y],j},addStyles:function(x){var y=this;return x.map(function(j){return y.addStyle(j)})},_duckTypeStyle:function(x){return typeof x=="object"&&(x.patternFill||x.fgColor)?{fill:x}:x.font||x.numFmt||x.border||x.fill?x:this._getStyleCSS(x)},_getStyleCSS:function(x){return x},_addXf:function(x){var y=this._addFont(x.font),j=this._addFill(x.fill),k=this._addBorder(x.border),E=this._addNumFmt(x.numFmt),T=$s("xf").attr("numFmtId",E).attr("fontId",y).attr("fillId",j).attr("borderId",k).attr("xfId","0");return 0<y&&T.attr("applyFont","1"),0<j&&T.attr("applyFill","1"),0<k&&T.attr("applyBorder","1"),0<E&&T.attr("applyNumberFormat","1"),x.alignment&&(E=$s("alignment"),x.alignment.horizontal&&E.attr("horizontal",x.alignment.horizontal),x.alignment.vertical&&E.attr("vertical",x.alignment.vertical),x.alignment.indent&&E.attr("indent",x.alignment.indent),x.alignment.readingOrder&&E.attr("readingOrder",x.alignment.readingOrder),x.alignment.wrapText&&E.attr("wrapText",x.alignment.wrapText),x.alignment.textRotation!=null&&E.attr("textRotation",x.alignment.textRotation),T.append(E).attr("applyAlignment",1)),this.$cellXfs.append(T),T=+this.$cellXfs.children().length,this.$cellXfs.attr("count",T),T-1},_addFont:function(x){if(!x)return 0;var y=$s("font").append($s("sz").attr("val",x.sz||this.defaultStyle.font.sz)).append($s("name").attr("val",x.name||this.defaultStyle.font.name));return x.bold&&y.append($s("b")),x.underline&&y.append($s("u")),x.italic&&y.append($s("i")),x.strike&&y.append($s("strike")),x.outline&&y.append($s("outline")),x.shadow&&y.append($s("shadow")),x.vertAlign&&y.append($s("vertAlign").attr("val",x.vertAlign)),x.color&&(x.color.theme?(y.append($s("color").attr("theme",x.color.theme)),x.color.tint&&y.append($s("tint").attr("theme",x.color.tint))):x.color.rgb&&y.append($s("color").attr("rgb",x.color.rgb))),this.$fonts.append(y),y=this.$fonts.children().length,this.$fonts.attr("count",y),y-1},_addNumFmt:function(x){if(!x)return 0;if(typeof x=="string"){var y=g[x];if(0<=y)return y}return/^[0-9]+$/.exec(x)?x:(x=x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),x=$s("numFmt").attr("numFmtId",++u).attr("formatCode",x),this.$numFmts.append(x),x=this.$numFmts.children().length,this.$numFmts.attr("count",x),u)},_addFill:function(x){if(!x)return 0;var y,j=$s("patternFill").attr("patternType",x.patternType||"solid");return x.fgColor&&(y=$s("fgColor"),x.fgColor.rgb?(x.fgColor.rgb.length==6&&(x.fgColor.rgb="FF"+x.fgColor.rgb),y.attr("rgb",x.fgColor.rgb),j.append(y)):x.fgColor.theme&&(y.attr("theme",x.fgColor.theme),x.fgColor.tint&&y.attr("tint",x.fgColor.tint),j.append(y)),x.bgColor||(x.bgColor={indexed:"64"})),x.bgColor&&(x=$s("bgColor").attr(x.bgColor),j.append(x)),j=$s("fill").append(j),this.$fills.append(j),j=this.$fills.children().length,this.$fills.attr("count",j),j-1},_getSubBorder:function(x,y){var j=$s(x);return y&&(j.attr("style",y.style||"medium"),y.color&&(x=$s("color"),y.color.auto?x.attr("auto",y.color.auto):y.color.rgb?x.attr("rgb",y.color.rgb):(y.color.theme||y.color.tint)&&(x.attr("theme",y.color.theme||"1"),x.attr("tint",y.color.tint||"0")),j.append(x))),j},_addBorder:function(x){if(!x)return 0;var y=this,j=$s("border").attr("diagonalUp",x.diagonalUp).attr("diagonalDown",x.diagonalDown);["left","right","top","bottom","diagonal"].forEach(function(E){j.append(y._getSubBorder(E,x[E]))}),this.$borders.append(j);var k=this.$borders.children().length;return this.$borders.attr("count",k),k-1},toXml:function(){return this.$styles.toXml()}}.initialize(r||{})};zd!==void 0&&(s.parse_xlscfb=zd),s.parse_zip=Df,s.read=_c,s.readFile=Lu,s.readFileSync=Lu,s.write=Ru,s.writeFile=Ig,s.writeFileSync=Ig,s.writeFileAsync=function(r,d,u,h){var g=u||{};return g.type="file",g.file=r,Ou(g),g.type="buffer",h instanceof Function||(h=u),Ta.writeFile(r,Ru(d,g),h)},s.utils=If,s.writeXLSX=Yd,s.writeFileXLSX=function(r,d,u){return(u=u||{}).type="file",u.file=d,Ou(u),Yd(r,u)},s.SSF=zo,Bl!==void 0&&(s.stream=Bl),Tt!==void 0&&(s.CFB=Tt),typeof fp>"u"||((Bl=I1)||{}).Readable&&vn(Bl.Readable)}if(o(n),typeof window<"u"&&!window.XLSX)try{window.XLSX=a}catch{}})(np,np.exports)),np.exports}var Kf=R7();function O7(){const{id:l}=ai(),n=Tr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState(!1),[L,M]=B.useState({}),[F,O]=B.useState("day"),[P,G]=B.useState(null),[ae,re]=B.useState({isOpen:!1,metric:null,period:null,channel:null,section:null}),[ke,xe]=B.useState([]),[je,Z]=B.useState(!1),ce=Mo.useRef(null),ue=B.useMemo(()=>a?{call:a.channels?.coldCalling||!1,linkedin:a.channels?.linkedInOutreach||!1,email:a.channels?.coldEmail||!1}:{call:!1,linkedin:!1,email:!1},[a]);B.useEffect(()=>{if(!l)return;const H=ce.current;H&&H.projectId===l?(o(H.project),e(H.activities),v(H.contacts),M(H.reportData||{}),N(!1)):Re()},[l]);const Re=async()=>{try{N(!0),G(null);const[H,Q,se]=await Promise.all([Vt.get(`/projects/${l}`),Vt.get(`/activities/project/${l}?limit=10000`),Vt.get(`/projects/${l}/project-contacts?limit=10000`)]);let de=a,we=s,Ce=m;H.data.success&&(de=H.data.data,o(de)),Q.data.success&&(we=Q.data.data||[],e(we)),se.data.success&&(Ce=se.data.data||[],v(Ce)),ce.current={projectId:l,project:de,activities:we,contacts:Ce,reportData:L}}catch(H){console.error("Error fetching data:",H),G(H.response?.data?.error||"Failed to load report data. Please try again.")}finally{N(!1)}},be=B.useCallback(H=>{const Q=new Date(H),se=Q.getDate(),de=Q.toLocaleString("default",{month:"short"}),we=Q.getFullYear().toString().slice(-2);return`${se} ${de} '${we}`},[]),oe=B.useCallback(H=>{const Q=new Date(H),se=Q.toLocaleString("default",{month:"short"}),de=Q.getFullYear().toString().slice(-2);return`${se} '${de}`},[]),he=B.useCallback(H=>new Date(H).toLocaleString("default",{month:"long"}),[]),ye=B.useMemo(()=>{if(F==="month"){const H=new Set;return s.forEach(se=>{const de=se.callDate?new Date(se.callDate):se.emailDate?new Date(se.emailDate):se.linkedinDate?new Date(se.linkedinDate):se.createdAt?new Date(se.createdAt):null;de&&!isNaN(de.getTime())&&H.add(oe(de))}),m.forEach(se=>{se.createdAt&&H.add(oe(new Date(se.createdAt)))}),[{month:null,periods:Array.from(H).sort((se,de)=>{const[we,Ce]=se.split(" '"),[ne,ve]=de.split(" '"),Ge=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],vt=Ge.indexOf(we),ze=Ge.indexOf(ne);return Ce!==ve?parseInt(Ce)-parseInt(ve):vt-ze})}]}else{const H={};return s.forEach(se=>{const de=se.callDate?new Date(se.callDate):se.emailDate?new Date(se.emailDate):new Date(se.createdAt);if(de&&!isNaN(de.getTime())){const we=be(de),Ce=oe(de),ne=he(de);H[Ce]||(H[Ce]={month:ne,monthKey:Ce,periods:[]}),H[Ce].periods.includes(we)||H[Ce].periods.push(we)}}),m.forEach(se=>{if(se.createdAt){const de=new Date(se.createdAt),we=be(de),Ce=oe(de),ne=he(de);H[Ce]||(H[Ce]={month:ne,monthKey:Ce,periods:[]}),H[Ce].periods.includes(we)||H[Ce].periods.push(we)}}),Object.keys(H).forEach(se=>{H[se].periods.sort((de,we)=>{const Ce=new Date(de.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3")),ne=new Date(we.replace(/(\d+) (\w+) '(\d+)/,"$2 $1, 20$3"));return Ce-ne})}),Object.values(H).sort((se,de)=>{const[we,Ce]=se.monthKey.split(" '"),[ne,ve]=de.monthKey.split(" '"),Ge=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],vt=Ge.indexOf(we),ze=Ge.indexOf(ne);return Ce!==ve?parseInt(Ce)-parseInt(ve):vt-ze})}},[s,m,F,be,oe,he]),Te=B.useMemo(()=>ye.flatMap(H=>H.periods),[ye]),fe=B.useCallback(()=>{if(s.length===0&&m.length===0){M({});return}D(!0);const Q=setTimeout(()=>{const se={};Te.forEach(ne=>{se[ne]={dataAllocated:0,dataResearch:0,interested:0,notInterested:0,ring:0,busy:0,hangUp:0,callBack:0,switchOff:0,detailsShared:0,future:0,invalid:0,demoBooked:0,followUps:0,totalCalls:0,freshCalls:0,connectionRequestSent:0,connectionAccepted:0,firstMessageSent:0,followupMessagesSent:0,existingConnection:0,conversationsInProgress:0,meetingProposed:0,meetingScheduled:0,meetingCompleted:0,emailsSent:0,noReply:0,outOfOffice:0,wrongPerson:0,bounce:0,optOut:0,totalResponses:0,responseRate:0}}),m.forEach(ne=>{if(ne.createdAt){const ve=F==="day"?be(new Date(ne.createdAt)):oe(new Date(ne.createdAt));se[ve]&&(se[ve].dataAllocated++,se[ve].dataResearch++)}});const de=ue.call?s.filter(ne=>ne.type==="call"):[],we=ue.linkedin?s.filter(ne=>ne.type==="linkedin"):[],Ce=ue.email?s.filter(ne=>ne.type==="email"):[];if(ue.call&&de.length>0){const ne=new Map,ve={};de.forEach(Ge=>{const vt=Ge.callDate?new Date(Ge.callDate):new Date(Ge.createdAt);if(!vt||isNaN(vt.getTime()))return;const ze=F==="day"?be(vt):oe(vt);if(!se[ze])return;const jt=Ge.contactId?.toString()||"unknown";Ge.callNumber==="1st call"&&!ne.has(jt)&&ne.set(jt,ze),ve[ze]||(ve[ze]={}),ve[ze][jt]||(ve[ze][jt]=[]),ve[ze][jt].push(Ge)}),de.forEach(Ge=>{const vt=Ge.callDate?new Date(Ge.callDate):new Date(Ge.createdAt);if(!vt||isNaN(vt.getTime()))return;const ze=F==="day"?be(vt):oe(vt);if(se[ze]){if(Ge.callStatus)switch(Ge.callStatus){case"Interested":se[ze].interested++;break;case"Not Interested":se[ze].notInterested++;break;case"Ring":se[ze].ring++;break;case"Busy":se[ze].busy++;break;case"Hang Up":se[ze].hangUp++;break;case"Call Back":se[ze].callBack++;break;case"Switch Off":se[ze].switchOff++;break;case"Details Shared":se[ze].detailsShared++;break;case"Future":se[ze].future++;break;case"Invalid":se[ze].invalid++;break;case"Demo Booked":se[ze].demoBooked++;break}se[ze].totalCalls++}}),Object.keys(ve).forEach(Ge=>{const vt=ve[Ge];let ze=0,jt=0;Object.keys(vt).forEach(rt=>{const Kt=vt[rt],Lt=ne.get(rt);Kt.forEach(ks=>{ks.callNumber==="1st call"||Lt===Ge&&!ks.callNumber?ze++:jt++})}),se[Ge]&&(se[Ge].freshCalls=ze,se[Ge].followUps=jt)})}if(ue.linkedin&&we.length>0){const ne={};Te.forEach(ve=>{ne[ve]={connectionRequestSent:new Set,connectionAccepted:new Set,existingConnection:new Set,conversationsInProgress:new Set,meetingProposed:new Set,meetingScheduled:new Set,meetingCompleted:new Set,firstMessageSent:new Set,followupMessagesSent:new Set}}),we.forEach(ve=>{const Ge=ve.linkedinDate?new Date(ve.linkedinDate):ve.createdAt?new Date(ve.createdAt):null;if(!Ge)return;const vt=ve.contactId?.toString()||"unknown",ze=F==="day"?be(Ge):oe(Ge);if(!ne[ze])return;const jt=ve.template?.trim()||"";(ve.lnRequestSent==="Yes"||jt==="introduction-message")&&ne[ze].connectionRequestSent.add(vt),ve.lnRequestSent==="Existing Connect"&&ne[ze].existingConnection.add(vt),ve.connected==="Yes"&&ne[ze].connectionAccepted.add(vt),ve.status==="CIP"?ne[ze].conversationsInProgress.add(vt):ve.status==="Meeting Proposed"?ne[ze].meetingProposed.add(vt):ve.status==="Meeting Scheduled"?ne[ze].meetingScheduled.add(vt):ve.status==="Meeting Completed"&&ne[ze].meetingCompleted.add(vt),jt==="introduction-message"?ne[ze].firstMessageSent.add(vt):jt==="follow-up-message"&&ne[ze].followupMessagesSent.add(vt)}),Te.forEach(ve=>{se[ve]&&ne[ve]&&(se[ve].connectionRequestSent=ne[ve].connectionRequestSent.size,se[ve].connectionAccepted=ne[ve].connectionAccepted.size,se[ve].existingConnection=ne[ve].existingConnection.size,se[ve].conversationsInProgress=ne[ve].conversationsInProgress.size,se[ve].meetingProposed=ne[ve].meetingProposed.size,se[ve].meetingScheduled=ne[ve].meetingScheduled.size,se[ve].meetingCompleted=ne[ve].meetingCompleted.size,se[ve].firstMessageSent=ne[ve].firstMessageSent.size,se[ve].followupMessagesSent=ne[ve].followupMessagesSent.size)})}ue.email&&Ce.length>0&&(Ce.forEach(ne=>{if(!ne.createdAt)return;const ve=F==="day"?be(new Date(ne.createdAt)):oe(new Date(ne.createdAt));if(se[ve]){if(se[ve].emailsSent++,ne.status)switch(ne.status){case"No Reply":se[ve].noReply++;break;case"Out of Office":se[ve].outOfOffice++;break;case"Wrong Person":se[ve].wrongPerson++;break;case"Bounce":se[ve].bounce++;break;case"Opt Out":se[ve].optOut++;break}ne.status&&ne.status!=="No Reply"&&ne.status!=="Bounce"&&ne.status!=="Opt Out"&&se[ve].totalResponses++}}),Te.forEach(ne=>{se[ne]&&se[ne].emailsSent>0&&(se[ne].responseRate=parseFloat((se[ne].totalResponses/se[ne].emailsSent*100).toFixed(2)))})),M(se),D(!1)},0);return()=>clearTimeout(Q)},[s,m,F,ue,Te,be,oe]);B.useEffect(()=>{fe()},[fe]);const _e=B.useMemo(()=>{const H=[];return ue.call&&!ue.linkedin&&!ue.email?H.push({key:"dataAllocated",label:"Data Allocated",section:"Cold Calling",bold:!1},{key:"interested",label:"Interested",section:"Cold Calling",bold:!0},{key:"notInterested",label:"Not Interested",section:"Cold Calling",bold:!0},{key:"ring",label:"Ring",section:"Cold Calling",bold:!1},{key:"busy",label:"Busy",section:"Cold Calling",bold:!1,highlight:!0},{key:"hangUp",label:"Hang Up",section:"Cold Calling",bold:!1},{key:"callBack",label:"Call Back",section:"Cold Calling",bold:!1},{key:"switchOff",label:"Switch Off",section:"Cold Calling",bold:!1},{key:"detailsShared",label:"Detailed Shared",section:"Cold Calling",bold:!0,highlight:!0},{key:"future",label:"Future",section:"Cold Calling",bold:!1},{key:"invalid",label:"Invalid",section:"Cold Calling",bold:!1},{key:"demoBooked",label:"Demo Booked",section:"Cold Calling",bold:!0,highlight:!0,highlightDark:!0},{key:"followUps",label:"Follow Ups",section:"Cold Calling",bold:!0},{key:"totalCalls",label:"Total Calls",section:"Cold Calling",bold:!0},{key:"freshCalls",label:"(Fresh Calls + FollowUpS)",section:"Cold Calling",bold:!1,isFormula:!0}):ue.linkedin?(H.push({key:"dataResearch",label:"Data Research manually",section:"Linked IN",bold:!1},{key:"connectionRequestSent",label:"Connection Request Sent",section:"Linked IN",bold:!1},{key:"connectionAccepted",label:"Connection Accepted",section:"Linked IN",bold:!1},{key:"firstMessageSent",label:"First Message Sent",section:"Linked IN",bold:!1},{key:"followupMessagesSent",label:"Followup Messages sent",section:"Linked IN",bold:!1},{key:"existingConnection",label:"Existing Connection",section:"Linked IN",bold:!1},{key:"conversationsInProgress",label:"Conversations in Progress",section:"Linked IN",bold:!0,highlight:!0},{key:"meetingProposed",label:"Meeting Proposed",section:"Linked IN",bold:!1,highlight:!0},{key:"meetingScheduled",label:"Meeting Scheduled",section:"Linked IN",bold:!1,highlight:!0},{key:"meetingCompleted",label:"Meeting Completed",section:"Linked IN",bold:!1,highlight:!0}),ue.call&&H.push({key:"dataAllocated",label:"Data Allocated",section:"Cold Calling",bold:!1},{key:"interested",label:"Interested",section:"Cold Calling",bold:!0},{key:"notInterested",label:"Not Interested",section:"Cold Calling",bold:!0},{key:"ring",label:"Ring",section:"Cold Calling",bold:!1},{key:"busy",label:"Busy",section:"Cold Calling",bold:!1,highlight:!0},{key:"hangUp",label:"Hang Up",section:"Cold Calling",bold:!1},{key:"callBack",label:"Call Back",section:"Cold Calling",bold:!1},{key:"switchOff",label:"Switch Off",section:"Cold Calling",bold:!1},{key:"detailsShared",label:"Detailed Shared",section:"Cold Calling",bold:!0,highlight:!0},{key:"future",label:"Future",section:"Cold Calling",bold:!1},{key:"invalid",label:"Invalid",section:"Cold Calling",bold:!1},{key:"demoBooked",label:"Demo Booked",section:"Cold Calling",bold:!0,highlight:!0,highlightDark:!0},{key:"followUps",label:"Follow Ups",section:"Cold Calling",bold:!0},{key:"totalCalls",label:"Total Calls",section:"Cold Calling",bold:!0}),ue.email&&H.push({key:"emailsSent",label:"Emails Sent",section:"Email",bold:!1},{key:"noReply",label:"No Reply",section:"Email",bold:!1},{key:"outOfOffice",label:"Out of Office",section:"Email",bold:!1},{key:"wrongPerson",label:"Wrong Person",section:"Email",bold:!1},{key:"bounce",label:"Bounce",section:"Email",bold:!1},{key:"optOut",label:"Opt Out",section:"Email",bold:!1},{key:"totalResponses",label:"Total Responses",section:"Email",bold:!0},{key:"responseRate",label:"Response Rate (%)",section:"Email",bold:!1})):ue.email&&H.push({key:"emailsSent",label:"Emails Sent",section:"Email",bold:!1},{key:"noReply",label:"No Reply",section:"Email",bold:!1},{key:"outOfOffice",label:"Out of Office",section:"Email",bold:!1},{key:"wrongPerson",label:"Wrong Person",section:"Email",bold:!1},{key:"bounce",label:"Bounce",section:"Email",bold:!1},{key:"optOut",label:"Opt Out",section:"Email",bold:!1},{key:"totalResponses",label:"Total Responses",section:"Email",bold:!0},{key:"responseRate",label:"Response Rate (%)",section:"Email",bold:!1}),H},[ue]),We=B.useMemo(()=>{const H={};return _e.forEach(Q=>{H[Q.section]||(H[Q.section]=[]),H[Q.section].push(Q)}),H},[_e]),te=B.useCallback(H=>H==="Cold Calling"?"call":H==="Linked IN"?"linkedin":H==="Email"?"email":null,[]),me=B.useMemo(()=>{const H={byPeriodAndContact:new Map,byPeriodAndType:new Map,contactPeriods:new Map};return s.forEach(Q=>{if((Q.projectId?.toString?Q.projectId.toString():Q.projectId)!==l)return;const de=Q.callDate?new Date(Q.callDate):Q.emailDate?new Date(Q.emailDate):Q.linkedinDate?new Date(Q.linkedinDate):Q.createdAt?new Date(Q.createdAt):null;if(!de||isNaN(de.getTime()))return;const we=F==="day"?be(de):oe(de),Ce=Q.type;H.byPeriodAndContact.has(we)||H.byPeriodAndContact.set(we,new Map);const ne=H.byPeriodAndContact.get(we);if(Q.contactId){const Ge=Q.contactId.toString?Q.contactId.toString():Q.contactId;ne.has(Ge)||ne.set(Ge,[]),ne.get(Ge).push(Q),H.contactPeriods.has(Ge)||H.contactPeriods.set(Ge,new Set),H.contactPeriods.get(Ge).add(we)}H.byPeriodAndType.has(we)||H.byPeriodAndType.set(we,new Map);const ve=H.byPeriodAndType.get(we);ve.has(Ce)||ve.set(Ce,[]),ve.get(Ce).push(Q)}),H},[s,l,F,be,oe]),W=B.useCallback((H,Q,se)=>{if(!H||!Q||!se)return[];const de=ke.length>0?ke:m;if(s.filter(ne=>ne.type==="linkedin"),se==="all"&&H==="allForPeriod")return de.filter(ne=>{const ve=(ne._id?.toString?ne._id.toString():ne._id)||"",Ge=me.contactPeriods.get(ve),vt=Ge?Ge.has(Q):!1;let ze=!1;return ne.createdAt&&(ze=(F==="day"?be(new Date(ne.createdAt)):oe(new Date(ne.createdAt)))===Q),vt||ze});const we=me.byPeriodAndType.get(Q)?.get(se)||[],Ce=new Set;return we.forEach(ne=>{if(ne.contactId){const ve=ne.contactId.toString?ne.contactId.toString():ne.contactId;Ce.add(ve)}}),de.filter(ne=>{const ve=(ne._id?.toString?ne._id.toString():ne._id)||"",vt=(me.byPeriodAndContact.get(Q)?.get(ve)||[]).filter(ze=>!(se==="call"&&ze.type!=="call"||se==="linkedin"&&ze.type!=="linkedin"||se==="email"&&ze.type!=="email"));if(se==="call")switch(H){case"interested":return vt.some(ze=>ze.callStatus==="Interested");case"notInterested":return vt.some(ze=>ze.callStatus==="Not Interested");case"ring":return vt.some(ze=>ze.callStatus==="Ring");case"busy":return vt.some(ze=>ze.callStatus==="Busy");case"hangUp":return vt.some(ze=>ze.callStatus==="Hang Up");case"callBack":return vt.some(ze=>ze.callStatus==="Call Back");case"switchOff":return vt.some(ze=>ze.callStatus==="Switch Off");case"detailsShared":return vt.some(ze=>ze.callStatus==="Details Shared");case"future":return vt.some(ze=>ze.callStatus==="Future");case"invalid":return vt.some(ze=>ze.callStatus==="Invalid");case"demoBooked":return vt.some(ze=>ze.callStatus==="Demo Booked");case"dataAllocated":return ne.createdAt?(F==="day"?be(new Date(ne.createdAt)):oe(new Date(ne.createdAt)))===Q:!1;default:return!1}else if(se==="linkedin"){const ze=vt.filter(jt=>jt.createdAt?(F==="day"?be(new Date(jt.createdAt)):oe(new Date(jt.createdAt)))===Q:!1);if(ze.length===0)return!1;switch(H){case"dataResearch":return ne.createdAt?(F==="day"?be(new Date(ne.createdAt)):oe(new Date(ne.createdAt)))===Q:!1;case"connectionRequestSent":return ze.some(jt=>{const rt=jt.template?.trim()||"";return jt.lnRequestSent==="Yes"||rt==="introduction-message"});case"connectionAccepted":return ze.some(jt=>jt.connected==="Yes");case"firstMessageSent":return ze.some(jt=>(jt.template?.trim()||"")==="introduction-message");case"followupMessagesSent":return ze.some(jt=>(jt.template?.trim()||"")==="follow-up-message");case"existingConnection":return ze.some(jt=>jt.lnRequestSent==="Existing Connect");case"conversationsInProgress":return ze.some(jt=>jt.status==="CIP");case"meetingProposed":return ze.some(jt=>jt.status==="Meeting Proposed");case"meetingScheduled":return ze.some(jt=>jt.status==="Meeting Scheduled");case"meetingCompleted":return ze.some(jt=>jt.status==="Meeting Completed");default:return!1}}else if(se==="email")switch(H){case"emailsSent":return vt.length>0;case"noReply":return vt.some(ze=>ze.status==="No Reply");case"outOfOffice":return vt.some(ze=>ze.status==="Out of Office");case"wrongPerson":return vt.some(ze=>ze.status==="Wrong Person");case"bounce":return vt.some(ze=>ze.status==="Bounce");case"optOut":return vt.some(ze=>ze.status==="Opt Out");case"totalResponses":return vt.some(ze=>ze.status&&ze.status!=="No Reply"&&ze.status!=="Bounce"&&ze.status!=="Opt Out");default:return!1}return!1})},[ke,m,me,s,F,be,oe]);B.useEffect(()=>{ae.isOpen?(Z(!0),m.length>0?(xe(m),Z(!1),m.length<1e3&&Vt.get(`/projects/${l}/project-contacts?limit=10000`).then(H=>{H.data.success&&xe(H.data.data||[])}).catch(H=>{console.error("Error fetching contacts:",H)})):Vt.get(`/projects/${l}/project-contacts?limit=10000`).then(H=>{H.data.success&&xe(H.data.data||[])}).catch(H=>{console.error("Error fetching contacts:",H)}).finally(()=>{Z(!1)})):xe([])},[ae.isOpen,l,m]);const pe=B.useMemo(()=>{if(!ae.isOpen||!ae.metric||!ae.period||!ae.channel)return[];try{return W(ae.metric,ae.period,ae.channel)}catch(H){return console.error("Error filtering prospects:",H),[]}},[ae.isOpen,ae.metric,ae.period,ae.channel,W]),Le=B.useCallback((H,Q,se)=>{const de=te(se);!de||(L[Q]?.[H.key]||0)===0||H.isFormula||re({isOpen:!0,metric:H.key,period:Q,channel:de,section:se})},[L,te]),Ae=B.useCallback(H=>{const Q=L[H];!Q||Object.values(Q).every(se=>!se||se===0)||re({isOpen:!0,metric:"allForPeriod",period:H,channel:"all",section:"All Channels"})},[L]),V=B.useCallback(()=>{if(Te.length===0||!L){alert("No data available to export");return}try{const H=Kf.utils.book_new(),Q=[],se=[`Monthly Report - ${a?.companyName||"Report"}`];for(let Kt=0;Kt<Te.length;Kt++)se.push("");Q.push(se);const de=[`${F==="day"?"Day":"Month"} View - Exported on ${new Date().toLocaleDateString()}`];for(let Kt=0;Kt<Te.length;Kt++)de.push("");Q.push(de),Q.push(Array(Te.length+1).fill(""));const we=["Key Results",...Te];Q.push(we);let Ce=0;const ne=[];ne[Ce]={cells:Array(se.length).fill({font:{bold:!0,sz:16,color:{rgb:"1E3A8A"}},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"left",vertical:"center"}}),merge:{s:{r:Ce,c:0},e:{r:Ce,c:Te.length}}},Ce++,ne[Ce]={cells:Array(de.length).fill({font:{sz:10,color:{rgb:"6B7280"}},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"left",vertical:"center"}}),merge:{s:{r:Ce,c:0},e:{r:Ce,c:Te.length}}},Ce++,Ce++,ne[Ce]={cells:Array(we.length).fill({font:{bold:!0,color:{rgb:"1F2937"},sz:11},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},Ce++;const ve=Object.values(ue).filter(Boolean).length,Ge=Object.keys(We);ve>1?Ge.forEach((Kt,Lt)=>{Lt>0&&(Q.push(Array(Te.length+1).fill("")),Ce++);const ks=[Kt];for(let ms=0;ms<Te.length;ms++)ks.push("");Q.push(ks),ne[Ce]={cells:Array(ks.length).fill({font:{bold:!0,sz:14,color:{rgb:"1E3A8A"}},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"left",vertical:"center"}}),merge:{s:{r:Ce,c:0},e:{r:Ce,c:Te.length}}},Ce++;const _s=["Key Results",...Te];Q.push(_s),ne[Ce]={cells:Array(_s.length).fill({font:{bold:!0,color:{rgb:"1F2937"},sz:11},fill:{fgColor:{rgb:"FFFFFF"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},Ce++,ye.forEach((ms,ws)=>{if(F==="day"&&ms.month){const Ie=[ms.month];for(let st=0;st<Te.length;st++)Ie.push("");Q.push(Ie),ne[Ce]={cells:Array(Ie.length).fill({font:{bold:!0,sz:12,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFF9C4"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}}),merge:{s:{r:Ce,c:0},e:{r:Ce,c:Te.length}}},Ce++}if(ws===0||F==="day"&&ws>0&&ye[ws-1].monthKey!==ms.monthKey){const Ie=[Kt];for(let st=0;st<Te.length;st++)Ie.push("");Q.push(Ie),ne[Ce]={cells:Array(Ie.length).fill({font:{bold:!0,sz:11,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFE082"}},alignment:{horizontal:"left",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},Ce++,We[Kt].forEach(st=>{const Dt=[st.label];Te.forEach(Pa=>{let dr="";st.isFormula?dr=`(${L[Pa]?.freshCalls||0} + ${L[Pa]?.followUps||0})`:st.key==="responseRate"?dr=`${L[Pa]?.[st.key]||0}%`:dr=L[Pa]?.[st.key]||0,Dt.push(dr)}),Q.push(Dt);const xs=st.highlight?st.highlightDark?"C8E6C9":"E8F5E9":"FFFFFF";ne[Ce]={cells:Dt.map((Pa,dr)=>({font:{bold:st.bold||dr===0,sz:10,color:{rgb:dr===0?"1F2937":"374151"}},fill:{fgColor:{rgb:xs}},alignment:{horizontal:dr===0?"left":"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}},numFmt:dr>0&&typeof Pa=="number"?"0":void 0}))},Ce++})}})}):ye.forEach((Kt,Lt)=>{if(F==="day"&&Kt.month){const ks=[Kt.month];for(let _s=0;_s<Te.length;_s++)ks.push("");Q.push(ks),ne[Ce]={cells:Array(ks.length).fill({font:{bold:!0,sz:12,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFF9C4"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}}),merge:{s:{r:Ce,c:0},e:{r:Ce,c:Te.length}}},Ce++}(Lt===0||F==="day"&&Lt>0&&ye[Lt-1].monthKey!==Kt.monthKey)&&Object.keys(We).forEach(ks=>{const _s=[ks];for(let ms=0;ms<Te.length;ms++)_s.push("");Q.push(_s),ne[Ce]={cells:Array(_s.length).fill({font:{bold:!0,sz:11,color:{rgb:"1F2937"}},fill:{fgColor:{rgb:"FFE082"}},alignment:{horizontal:"left",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}}})},Ce++,We[ks].forEach(ms=>{const ws=[ms.label];Te.forEach(st=>{let Dt="";ms.isFormula?Dt=`(${L[st]?.freshCalls||0} + ${L[st]?.followUps||0})`:ms.key==="responseRate"?Dt=`${L[st]?.[ms.key]||0}%`:Dt=L[st]?.[ms.key]||0,ws.push(Dt)}),Q.push(ws);const Ie=ms.highlight?ms.highlightDark?"C8E6C9":"E8F5E9":"FFFFFF";ne[Ce]={cells:ws.map((st,Dt)=>({font:{bold:ms.bold||Dt===0,sz:10,color:{rgb:Dt===0?"1F2937":"374151"}},fill:{fgColor:{rgb:Ie}},alignment:{horizontal:Dt===0?"left":"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"E5E7EB"}},bottom:{style:"thin",color:{rgb:"E5E7EB"}},left:{style:"thin",color:{rgb:"E5E7EB"}},right:{style:"thin",color:{rgb:"E5E7EB"}}},numFmt:Dt>0&&typeof st=="number"?"0":void 0}))},Ce++})})});const vt=Kf.utils.aoa_to_sheet(Q);Object.keys(vt).forEach(Kt=>{if(Kt.startsWith("!"))return;const Lt=Kf.utils.decode_cell(Kt),ks=ne[Lt.r];if(ks){ks.merge&&Lt.c===0&&(vt["!merges"]||(vt["!merges"]=[]),vt["!merges"].push(ks.merge));const _s=ks.cells[Lt.c];_s&&(vt[Kt].s=_s)}});const ze=[{wch:28}];Te.forEach(()=>{ze.push({wch:14})}),vt["!cols"]=ze,vt["!rows"]=[],ne.forEach((Kt,Lt)=>{Kt&&Kt.merge?vt["!rows"][Lt]={hpt:25}:Lt===0?vt["!rows"][Lt]={hpt:22}:vt["!rows"][Lt]={hpt:18}}),vt["!freeze"]={xSplit:1,ySplit:4,topLeftCell:"B5",activePane:"bottomRight",state:"frozen"},Kf.utils.book_append_sheet(H,vt,"Report");const jt=F==="day"?"Day":"Month",rt=`${a?.companyName||"Report"}_${jt}_View_${new Date().toISOString().split("T")[0]}.xlsx`;Kf.writeFile(H,rt)}catch(H){console.error("Error exporting to Excel:",H),alert("Failed to export report. Please try again.")}},[Te,L,ye,We,F,a]);return w?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-gray-200 border-t-indigo-600 mx-auto"}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"h-8 w-8 bg-indigo-600 rounded-full animate-pulse"})})]}),t.jsx("p",{className:"mt-6 text-lg font-semibold text-gray-700",children:"Loading Report Data"}),t.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Please wait while we fetch your analytics..."})]})}):P?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center p-6",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-8 max-w-md w-full text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error Loading Report"}),t.jsx("p",{className:"text-gray-600 mb-6",children:P}),t.jsxs("div",{className:"flex gap-3 justify-center",children:[t.jsx("button",{onClick:()=>n("/projects"),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Back to Projects"}),t.jsx("button",{onClick:Re,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium",children:"Retry"})]})]})}):a?t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-40 lg:top-0",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4 sm:py-6",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors duration-200 mb-4 group",children:[t.jsx("svg",{className:"w-4 h-4 transform group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Monthly Report"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h2",{className:"text-xl font-semibold text-indigo-600",children:a.companyName}),a.website&&t.jsxs("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),a.website]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-xl p-1.5 border border-gray-200 shadow-inner",children:[t.jsx("button",{onClick:()=>O("day"),className:`px-5 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200 ${F==="day"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg shadow-indigo-200":"text-gray-700 hover:bg-white hover:text-gray-900"}`,children:"Day View"}),t.jsx("button",{onClick:()=>O("month"),className:`px-5 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200 ${F==="month"?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg shadow-indigo-200":"text-gray-700 hover:bg-white hover:text-gray-900"}`,children:"Month View"})]}),t.jsxs("button",{onClick:V,disabled:Te.length===0||S,className:"px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 font-semibold text-sm flex items-center gap-2 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Excel"]})]})]})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8",children:[S&&t.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-center gap-3",children:[t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),t.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Calculating report metrics..."})]}),Te.length===0?t.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-12 text-center",children:[t.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Data Available"}),t.jsx("p",{className:"text-gray-500",children:"There is no data available for this period."})]}):(()=>{const H=Object.values(ue).filter(Boolean).length,Q=Object.keys(We);return H===1?t.jsx("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-blue-50",children:[t.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider border-r-2 border-gray-300 sticky left-0 bg-blue-50 z-20",children:"Key Results"}),Te.map(se=>t.jsx("th",{onClick:()=>Ae(se),className:"px-3 sm:px-4 py-3 text-center text-xs font-bold text-gray-900 uppercase tracking-wider border-r border-gray-300 last:border-r-0 bg-blue-50 cursor-pointer hover:underline",children:se},se))]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ye.map((se,de)=>t.jsxs(Mo.Fragment,{children:[F==="day"&&se.month&&t.jsx("tr",{children:t.jsx("td",{colSpan:Te.length+1,className:"px-4 sm:px-6 py-2.5 bg-yellow-100 text-center font-bold text-sm text-gray-900 border-b-2 border-yellow-300",children:se.month})}),de===0||F==="day"&&de>0&&ye[de-1].monthKey!==se.monthKey?Object.keys(We).map(we=>t.jsxs(Mo.Fragment,{children:[t.jsx("tr",{className:"bg-amber-50 border-y border-amber-200",children:t.jsx("td",{colSpan:Te.length+1,className:"px-4 sm:px-6 py-2.5 sticky left-0 bg-amber-50 z-20",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-1 h-5 bg-amber-500 rounded-full"}),t.jsx("span",{className:"text-xs font-bold text-gray-900",children:we})]})})}),We[we].map(Ce=>t.jsxs("tr",{className:`${Ce.highlight?Ce.highlightDark?"bg-green-100":"bg-green-50":"bg-white hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-4 sm:px-6 py-3 whitespace-nowrap text-sm border-r-2 border-gray-200 sticky left-0 z-20 ${Ce.highlight?Ce.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${Ce.bold?"font-bold text-gray-900":"font-medium text-gray-700"}`,children:Ce.label}),Te.map(ne=>{const ve=Ce.isFormula?`(${L[ne]?.freshCalls||0} + ${L[ne]?.followUps||0})`:Ce.key==="responseRate"?`${L[ne]?.[Ce.key]||0}%`:L[ne]?.[Ce.key]||0,Ge=!Ce.isFormula&&ve!==0&&ve!=="0%";return t.jsx("td",{onClick:()=>Ge&&Le(Ce,ne,we),className:`px-3 sm:px-4 py-3 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${Ce.highlight?Ce.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${Ce.bold?"font-bold text-gray-900":"font-medium text-gray-700"} ${Ge?"cursor-pointer hover:bg-blue-50 hover:underline":""}`,children:ve},ne)})]},`${se.monthKey||de}-${we}-${Ce.key}`))]},`${se.monthKey||de}-${we}`)):null]},se.monthKey||de))})]})})}):t.jsx("div",{className:"space-y-6",children:Q.map(se=>t.jsx("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-blue-50",children:[t.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider border-r-2 border-gray-300 sticky left-0 bg-blue-50 z-20",children:"Key Results"}),Te.map(de=>t.jsx("th",{onClick:()=>Ae(de),className:"px-3 sm:px-4 py-3 text-center text-xs font-bold text-gray-900 uppercase tracking-wider border-r border-gray-300 last:border-r-0 bg-blue-50 cursor-pointer hover:underline",children:de},de))]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ye.map((de,we)=>t.jsxs(Mo.Fragment,{children:[F==="day"&&de.month&&t.jsx("tr",{children:t.jsx("td",{colSpan:Te.length+1,className:"px-4 sm:px-6 py-2.5 bg-yellow-100 text-center font-bold text-sm text-gray-900 border-b-2 border-yellow-300",children:de.month})}),we===0||F==="day"&&we>0&&ye[we-1].monthKey!==de.monthKey?t.jsxs(Mo.Fragment,{children:[t.jsx("tr",{className:"bg-amber-50 border-y border-amber-200",children:t.jsx("td",{colSpan:Te.length+1,className:"px-4 sm:px-6 py-2.5 sticky left-0 bg-amber-50 z-20",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-1 h-5 bg-amber-500 rounded-full"}),t.jsx("span",{className:"text-xs font-bold text-gray-900",children:se})]})})}),We[se].map(Ce=>t.jsxs("tr",{className:`${Ce.highlight?Ce.highlightDark?"bg-green-100":"bg-green-50":"bg-white hover:bg-gray-50"} transition-colors duration-150`,children:[t.jsx("td",{className:`px-4 sm:px-6 py-3 whitespace-nowrap text-sm border-r-2 border-gray-200 sticky left-0 z-20 ${Ce.highlight?Ce.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${Ce.bold?"font-bold text-gray-900":"font-medium text-gray-700"}`,children:Ce.label}),Te.map(ne=>{const ve=Ce.isFormula?`(${L[ne]?.freshCalls||0} + ${L[ne]?.followUps||0})`:Ce.key==="responseRate"?`${L[ne]?.[Ce.key]||0}%`:L[ne]?.[Ce.key]||0,Ge=!Ce.isFormula&&ve!==0&&ve!=="0%";return t.jsx("td",{onClick:()=>Ge&&Le(Ce,ne,se),className:`px-3 sm:px-4 py-3 whitespace-nowrap text-sm text-center border-r border-gray-200 last:border-r-0 ${Ce.highlight?Ce.highlightDark?"bg-green-100":"bg-green-50":"bg-white"} ${Ce.bold?"font-bold text-gray-900":"font-medium text-gray-700"} ${Ge?"cursor-pointer hover:bg-blue-50 hover:underline":""}`,children:ve},ne)})]},`${de.monthKey||we}-${se}-${Ce.key}`))]}):null]},de.monthKey||we))})]})})},se))})})()]}),ae.isOpen&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:ae.metric?ae.metric==="allForPeriod"?`All Prospects - ${ae.section}`:`${_e.find(Q=>Q.key===ae.metric)?.label||ae.metric} - ${ae.section}`:""}),t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Period: ",ae.period]}),!je&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing ",W(ae.metric,ae.period,ae.channel).length," prospects"]})]}),t.jsx("button",{onClick:()=>re({isOpen:!1,metric:null,period:null,channel:null,section:null}),className:"text-gray-400 hover:text-gray-600 transition-colors",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:je?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsx("p",{className:"text-sm font-medium",children:"Loading prospects..."})]}):pe.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.jsx("p",{className:"text-sm font-medium",children:"No prospects found for this metric"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"CONTACT"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"COMPANY"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"DATE"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"STATUS"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:pe.map(H=>{const Q=(H._id?.toString?H._id.toString():H._id)||"",se=me.byPeriodAndContact.get(ae.period)?.get(Q)||[],de=se.find(ve=>{if(ae.channel==="call"&&ve.type!=="call"||ae.channel==="linkedin"&&ve.type!=="linkedin"||ae.channel==="email"&&ve.type!=="email")return!1;if(ae.channel==="call"){const Ge={interested:"Interested",notInterested:"Not Interested",ring:"Ring",busy:"Busy",hangUp:"Hang Up",callBack:"Call Back",switchOff:"Switch Off",detailsShared:"Details Shared",future:"Future",invalid:"Invalid",demoBooked:"Demo Booked"};return ve.callStatus===Ge[ae.metric]}return!0})||se[0],we=de?de.callDate?new Date(de.callDate):de.emailDate?new Date(de.emailDate):new Date(de.createdAt):H.createdAt?new Date(H.createdAt):null,Ce=we?we.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",ne=de?.callStatus||de?.status||H.stage||"New";return t.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[t.jsx("td",{className:"px-4 py-3 text-sm font-semibold text-gray-900",children:H.name||"Unknown"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:H.company||"N/A"}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:Ce}),t.jsx("td",{className:"px-4 py-3 text-sm",children:t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-green-100 text-green-800 rounded-full border border-green-200",children:ne})})]},H._id||H.name)})})]})})})]})})]}):t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-8 text-center max-w-md",children:[t.jsx("p",{className:"text-gray-600 mb-4",children:"Project not found"}),t.jsx("button",{onClick:()=>n("/projects"),className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium",children:"Back to Projects"})]})})}function P7(){const l=Tr(),[n,a]=B.useState([]),[o,s]=B.useState(!0),[e,m]=B.useState(null),[v,w]=B.useState(""),[N,S]=B.useState(!1);B.useEffect(()=>{S(!0),D()},[v]);const D=async()=>{try{s(!0);const F={};v&&(F.search=v);const O=await Vt.get("/projects",{params:F});O.data.success&&a(O.data.data||[])}catch(F){console.error("Error fetching projects:",F),m("Failed to load projects")}finally{s(!1)}},L=F=>F?new Date(F).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",M=F=>{const O={active:{bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200",label:"Active",dot:"bg-emerald-500"},draft:{bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200",label:"Draft",dot:"bg-amber-500"},completed:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-200",label:"Completed",dot:"bg-blue-500"},archived:{bg:"bg-slate-50",text:"text-slate-700",border:"border-slate-200",label:"Archived",dot:"bg-slate-500"}},P=O[F]||O.draft;return t.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-md border ${P.bg} ${P.text} ${P.border} transition-colors`,children:[t.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${P.dot}`}),P.label]})};return t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[t.jsx("div",{className:`mb-10 transition-all duration-500 ${N?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-blue-600 to-indigo-600 rounded-full"}),t.jsx("h1",{className:"text-2xl font-semibold text-slate-900 tracking-tight",children:"Funnel Management"})]}),t.jsx("p",{className:"text-sm text-slate-500 ml-4",children:"Select a project to view detailed funnel metrics and analytics"})]})}),t.jsx("div",{className:`mb-8 transition-all duration-500 delay-75 ${N?"opacity-100 translate-y-0":"opacity-0 -translate-y-2"}`,children:t.jsxs("div",{className:"relative max-w-md",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"h-4 w-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("input",{type:"text",placeholder:"Search projects by name, company, or email...",value:v,onChange:F=>w(F.target.value),className:"block w-full pl-10 pr-10 py-2.5 border border-slate-200 rounded-md bg-white text-sm text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-slate-900 focus:border-slate-900 transition-all shadow-sm"}),v&&t.jsx("button",{onClick:()=>w(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 transition-colors",children:t.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e&&t.jsx("div",{className:"mb-6 rounded-lg bg-red-50 border border-red-200 p-4",children:t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("svg",{className:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("div",{className:"ml-3",children:t.jsx("p",{className:"text-sm font-medium text-red-800",children:e})})]})}),o?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[...Array(6)].map((F,O)=>t.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm p-6 animate-pulse",children:[t.jsxs("div",{className:"flex items-start justify-between mb-5",children:[t.jsxs("div",{className:"flex-1 space-y-2.5",children:[t.jsx("div",{className:"h-5 bg-slate-200 rounded w-3/4"}),t.jsx("div",{className:"h-3 bg-slate-200 rounded w-1/2"})]}),t.jsx("div",{className:"h-6 bg-slate-200 rounded-md w-16"})]}),t.jsxs("div",{className:"space-y-3 mb-5",children:[t.jsx("div",{className:"h-4 bg-slate-200 rounded"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded w-5/6"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded w-4/6"})]}),t.jsx("div",{className:"h-px bg-slate-200 mb-4"}),t.jsx("div",{className:"h-4 bg-slate-200 rounded w-1/3"})]},O))}):n.length>0?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:n.map((F,O)=>t.jsx("div",{onClick:()=>l(`/projects/${F._id}`),className:`group relative bg-white rounded-lg border border-slate-200 shadow-sm hover:shadow hover:border-slate-300 cursor-pointer transition-all duration-150 flex flex-col ${N?"opacity-100":"opacity-0"}`,style:{animationDelay:`${O*30}ms`,minHeight:"240px"},children:t.jsxs("div",{className:"p-6 flex flex-col h-full",children:[t.jsxs("div",{className:"flex items-start justify-between mb-5 min-h-[56px]",children:[t.jsxs("div",{className:"flex-1 min-w-0 pr-3",children:[t.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1.5 truncate",children:F.companyName||"N/A"}),t.jsx("p",{className:"text-xs text-slate-500 min-h-[16px]",children:F.industry||""})]}),t.jsx("div",{className:"flex-shrink-0",children:M(F.status||"draft")})]}),t.jsxs("div",{className:"space-y-3 mb-5 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2.5 min-h-[20px]",children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0 text-slate-400",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),t.jsx("span",{className:`truncate text-sm ${F.contactPerson?.fullName?"text-slate-600":"text-slate-400"}`,children:F.contactPerson?.fullName||"No contact name"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 min-h-[20px]",children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0 text-slate-400",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("span",{className:`truncate text-sm ${F.contactPerson?.email?"text-slate-600":"text-slate-400"}`,children:F.contactPerson?.email||"No email"})]}),t.jsxs("div",{className:"flex items-center gap-2.5 min-h-[20px]",children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0 text-slate-400",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),t.jsx("span",{className:"text-sm text-slate-600",children:L(F.createdAt)})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100",children:[t.jsx("span",{className:"text-xs font-medium text-slate-700 group-hover:text-blue-600 transition-colors",children:"View Funnel"}),t.jsx("svg",{className:"w-4 h-4 text-slate-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})},F._id))}):t.jsx("div",{className:`bg-white rounded-lg border border-slate-200 shadow-sm p-12 transition-all duration-500 ${N?"opacity-100":"opacity-0"}`,children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[t.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-lg flex items-center justify-center mb-4",children:t.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),t.jsx("h3",{className:"text-sm font-semibold text-slate-900 mb-1",children:"No projects found"}),t.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Get started by creating your first project"}),t.jsxs("button",{onClick:()=>l("/projects/new"),className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-900 text-white text-sm font-medium rounded-lg hover:bg-slate-800 transition-colors",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Project"]})]})})]})})}function I7(){const{id:l}=ai(),n=Tr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({prospectData:0,connectionSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0});B.useEffect(()=>{l&&L()},[l]),B.useEffect(()=>{(s.length>0||m.length>0)&&M()},[s,m]);const L=async()=>{try{N(!0);const O=await Vt.get(`/projects/${l}`);O.data.success&&o(O.data.data);const P=await Vt.get(`/projects/${l}/project-contacts`);P.data.success&&e(P.data.data||[]);const G=await Vt.get(`/activities/project/${l}?limit=10000`);if(G.data.success){const re=(G.data.data||[]).filter(ke=>ke.type==="linkedin");v(re)}}catch(O){console.error("Error fetching data:",O)}finally{N(!1)}},M=()=>{const O={prospectData:s.length,connectionSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0},P={};m.forEach(ce=>{if(!ce.contactId)return;const ue=ce.contactId.toString();P[ue]||(P[ue]=[]),P[ue].push(ce)});const G=new Set,ae=new Set,re=new Set,ke=new Set,xe=new Set,je=new Set,Z=new Set;m.forEach(ce=>{const ue=ce.contactId?.toString();ue&&((ce.lnRequestSent==="Yes"||ce.lnRequestSent===!0)&&G.add(ue),(ce.connected==="Yes"||ce.connected===!0)&&ae.add(ue),ce.status==="CIP"&&re.add(ue),ce.status==="Meeting Proposed"&&ke.add(ue),ce.status==="Meeting Scheduled"&&xe.add(ue),ce.status==="Meeting Completed"&&je.add(ue),(ce.status==="Meeting Completed"||ce.status==="Interested")&&Z.add(ue))}),Object.keys(P).forEach(ce=>{P[ce].filter(be=>be.conversationNotes&&be.conversationNotes.trim()!=="").length>1&&O.followups++}),O.connectionSent=G.size,O.accepted=ae.size,O.cip=re.size,O.meetingProposed=ke.size,O.scheduled=xe.size,O.completed=je.size,O.sql=Z.size,D(O)},F=[{key:"prospectData",label:"Prospect Data",description:"Total prospects from this project"},{key:"connectionSent",label:"Connection Sent",description:"Connection requests sent"},{key:"accepted",label:"Accepted",description:"Connections accepted"},{key:"followups",label:"Followups",description:"Contacts with multiple messages"},{key:"cip",label:"CIP",description:"Conversations in Progress"},{key:"meetingProposed",label:"Meeting Proposed",description:"Meetings proposed"},{key:"scheduled",label:"Scheduled",description:"Meetings scheduled"},{key:"completed",label:"Completed",description:"Meetings completed"},{key:"sql",label:"SQL",description:"Sales Qualified Leads"}];return w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading funnel data..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 lg:px-6 py-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200 mb-6",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-indigo-500 to-indigo-700 rounded-full"}),t.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["LinkedIn Funnel - ",a?.companyName||"Project"]})]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-white to-gray-50 border border-gray-200 rounded-lg shadow-lg p-4 backdrop-blur-sm",children:[t.jsxs("div",{className:"mb-3 text-center",children:[t.jsx("h2",{className:"text-base font-bold text-gray-800 mb-0.5",children:"Sales Funnel Performance"}),t.jsx("p",{className:"text-[10px] text-gray-600",children:"Conversion metrics and pipeline health"})]}),t.jsx("div",{className:"flex flex-col items-center space-y-0.5",children:F.map((O,P)=>{const G=S[O.key]||0,ae=S.prospectData||1,re=ae>0?G/ae*100:0,xe=[96,88,78,68,58,48,38,28,20][P]||15;let je="",Z="text-white",ce="",ue="",Re="";P===0?(je="from-blue-600 via-blue-500 to-indigo-500",ce="border-blue-400",ue="shadow-blue-500/30",Re="bg-blue-400/30"):P>=5?(je="from-indigo-600 via-indigo-500 to-purple-500",ce="border-indigo-400",ue="shadow-indigo-500/30",Re="bg-indigo-400/30"):(je="from-slate-600 via-slate-500 to-gray-500",ce="border-slate-400",ue="shadow-slate-500/30",Re="bg-slate-400/30");const be=["","","","","","","","",""];return t.jsxs("div",{className:"w-full flex flex-col items-center transition-all duration-700 ease-out",style:{animation:`fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) ${P*.08}s both`},children:[t.jsxs("div",{className:`relative bg-gradient-to-r ${je} ${ce} border rounded-md shadow-md ${ue} hover:shadow-lg transition-all duration-500 transform hover:scale-[1.01] hover:-translate-y-0.5 group overflow-hidden`,style:{width:`${xe}%`,minWidth:"150px",backdropFilter:"blur(10px)"},children:[t.jsxs("div",{className:"absolute inset-0 opacity-10",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent"}),t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1),transparent_50%)]"})]}),t.jsxs("div",{className:"relative px-3 py-1.5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:`${Re} backdrop-blur-sm rounded p-1 shadow-sm`,children:t.jsx("span",{className:"text-sm",children:be[P]})}),t.jsxs("div",{children:[t.jsx("span",{className:`${Z} text-[10px] font-bold uppercase tracking-wide block leading-tight`,children:O.label}),t.jsx("span",{className:`${Z} text-[9px] opacity-80 mt-0 block`,children:O.description})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:`${Z} text-lg font-extrabold mb-0 drop-shadow-lg`,children:G.toLocaleString()}),P>0&&ae>0&&t.jsxs("div",{className:`${Z} text-[9px] font-semibold bg-white/20 backdrop-blur-sm px-1.5 py-0.5 rounded-full border border-white/30`,children:[re.toFixed(1),"%"]})]})]}),P>0&&t.jsx("div",{className:"mt-1 h-0.5 bg-white/20 backdrop-blur-sm rounded-full overflow-hidden border border-white/20",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-white/80 to-white rounded-full transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min(re,100)}%`,animation:`progressFill 1.5s ease-out ${P*.1+.5}s both`}})})]}),t.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),P<F.length-1&&t.jsxs("div",{className:"relative my-0.5",children:[t.jsx("div",{className:"w-0.5 h-2 bg-gradient-to-b from-gray-400 via-gray-500 to-gray-400 rounded-full shadow-inner mx-auto"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-gray-500 rounded-full shadow-sm"})]})]},O.key)})})]}),t.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(30px) scale(0.95);
            }
            to {
              opacity: 1;
              transform: translateY(0) scale(1);
            }
          }
          
          @keyframes progressFill {
            from {
              width: 0%;
            }
          }
          
          .shadow-3xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
          }
        `}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 via-blue-500 to-indigo-500 rounded-xl p-4 shadow-xl hover:shadow-blue-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Total Prospects"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsx("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:S.prospectData.toLocaleString()}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Pipeline foundation"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-emerald-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Conversion Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.completed/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Meetings completed"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-indigo-600 via-indigo-500 to-purple-500 rounded-xl p-4 shadow-xl hover:shadow-indigo-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"SQL Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.sql/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Sales qualified leads"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]})]})]})})}function B7(){const{id:l}=ai(),n=Tr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({prospectData:0,callsAttempted:0,callsConnected:0,decisionMakerReached:0,interested:0,detailsShared:0,demoBooked:0,demoCompleted:0,sql:0,won:0});B.useEffect(()=>{l&&L()},[l]),B.useEffect(()=>{l&&(s.length>0||m.length>0)?M():l&&s.length===0&&m.length===0&&D({prospectData:0,callsAttempted:0,callsConnected:0,decisionMakerReached:0,interested:0,detailsShared:0,demoBooked:0,demoCompleted:0,sql:0,won:0})},[l,s,m]);const L=async()=>{try{N(!0);const O=await Vt.get(`/projects/${l}`);O.data.success&&o(O.data.data);const P=await Vt.get(`/projects/${l}/project-contacts`);P.data.success&&e(P.data.data||[]);const G=await Vt.get(`/activities/project/${l}?limit=10000`);if(G.data.success){const re=(G.data.data||[]).filter(ke=>ke.type==="call");v(re)}}catch(O){console.error("Error fetching data:",O)}finally{N(!1)}},M=()=>{console.log("Calculating funnel data...",{contactsCount:s.length,activitiesCount:m.length});const O={prospectData:s.length,callsAttempted:0,callsConnected:0,decisionMakerReached:0,interested:0,detailsShared:0,demoBooked:0,demoCompleted:0,sql:0,won:0};if(m.length===0){console.log("No activities found, setting default data"),D(O);return}const P=new Set,G=new Set,ae=new Set,re=new Set,ke=new Set,xe=new Set,je=new Set,Z=new Set,ce=new Set;m.forEach(ue=>{const Re=ue.contactId?.toString();if(!Re)return;ue.callDate&&P.add(Re);const be=["Interested","Not Interested","Call Back","Future","Details Shared","Demo Booked","Demo Completed","Existing"];ue.callStatus&&be.includes(ue.callStatus)&&G.add(Re);const oe=["Interested","Details Shared","Demo Booked","Demo Completed"];ue.callStatus&&oe.includes(ue.callStatus)&&ae.add(Re),ue.callStatus==="Interested"&&re.add(Re),ue.callStatus==="Details Shared"&&ke.add(Re),ue.callStatus==="Demo Booked"&&xe.add(Re),ue.callStatus==="Demo Completed"&&je.add(Re),(ue.callStatus==="Demo Completed"||ue.callStatus==="Interested"&&ue.conversationNotes&&ue.conversationNotes.length>50||ue.status==="SQL")&&Z.add(Re),ue.status==="WON"&&ce.add(Re)}),O.callsAttempted=P.size,O.callsConnected=G.size,O.decisionMakerReached=ae.size,O.interested=re.size,O.detailsShared=ke.size,O.demoBooked=xe.size,O.demoCompleted=je.size,O.sql=Z.size,O.won=ce.size,console.log("Funnel data calculated:",O),console.log("Stage breakdown:",{callsAttempted:O.callsAttempted,callsConnected:O.callsConnected,decisionMakerReached:O.decisionMakerReached,interested:O.interested,detailsShared:O.detailsShared,demoBooked:O.demoBooked,demoCompleted:O.demoCompleted,sql:O.sql,won:O.won}),D(O)},F=[{key:"prospectData",label:"Prospect Data",description:"Total prospects from this project"},{key:"callsAttempted",label:"Calls Attempted",description:"Total calls made to prospects"},{key:"callsConnected",label:"Calls Connected",description:"Calls where contact answered"},{key:"decisionMakerReached",label:"Decision Maker Reached",description:"Reached decision maker"},{key:"interested",label:"Interested",description:"Prospects showing interest"},{key:"detailsShared",label:"Details Shared",description:"Product/service details shared"},{key:"demoBooked",label:"Demo Booked",description:"Demos scheduled"},{key:"demoCompleted",label:"Demo Completed",description:"Demos successfully completed"},{key:"sql",label:"SQL",description:"Sales Qualified Leads"},{key:"won",label:"WON",description:"Deals closed successfully"}];return B.useEffect(()=>{console.log("Funnel rows configured:",F.length,"stages"),console.log("Stage labels:",F.map(O=>O.label))},[]),w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading funnel data..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 lg:px-6 py-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200 mb-6",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-emerald-500 to-emerald-700 rounded-full"}),t.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["Cold Calling Funnel - ",a?.companyName||"Project"]})]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-white to-gray-50 border border-gray-200 rounded-lg shadow-lg p-4 backdrop-blur-sm",children:[t.jsxs("div",{className:"mb-3 text-center",children:[t.jsx("h2",{className:"text-base font-bold text-gray-800 mb-0.5",children:"Cold Calling Funnel Performance"}),t.jsx("p",{className:"text-[10px] text-gray-600",children:"Updated: 10-Stage Funnel  Conversion metrics and pipeline health"}),t.jsxs("div",{className:"mt-1 text-[9px] text-blue-600 font-semibold",children:["Stages: ",F.length," | Total Prospects: ",S.prospectData]}),S.prospectData===0&&t.jsx("p",{className:"text-xs text-amber-600 mt-2 font-medium",children:" No prospects found. Add contacts to see funnel data."})]}),t.jsx("div",{className:"flex flex-col items-center space-y-0.5",children:F.map((O,P)=>{const G=S[O.key]!==void 0?S[O.key]:0,ae=S.prospectData||1,re=ae>0?G/ae*100:0;P===0&&console.log(`Rendering stage ${P}: ${O.label} = ${G} (key: ${O.key})`);const xe=[96,88,80,72,64,56,48,40,32,24][P]||20;let je="",Z="text-white",ce="",ue="",Re="";P===0?(je="from-blue-600 via-blue-500 to-cyan-500",ce="border-blue-400",ue="shadow-blue-500/30",Re="bg-blue-400/30"):P===1||P===2?(je="from-purple-600 via-purple-500 to-indigo-500",ce="border-purple-400",ue="shadow-purple-500/30",Re="bg-purple-400/30"):P===3||P===4?(je="from-orange-600 via-orange-500 to-amber-500",ce="border-orange-400",ue="shadow-orange-500/30",Re="bg-orange-400/30"):P===5||P===6?(je="from-yellow-600 via-yellow-500 to-amber-500",ce="border-yellow-400",ue="shadow-yellow-500/30",Re="bg-yellow-400/30"):P===7||P===8?(je="from-emerald-600 via-emerald-500 to-teal-500",ce="border-emerald-400",ue="shadow-emerald-500/30",Re="bg-emerald-400/30"):(je="from-amber-600 via-amber-500 to-yellow-500",ce="border-amber-400",ue="shadow-amber-500/30",Re="bg-amber-400/30");const be=["","","","","","","","","",""];return t.jsxs("div",{className:"w-full flex flex-col items-center transition-all duration-700 ease-out",style:{animation:`fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) ${P*.08}s both`},children:[t.jsxs("div",{className:`relative bg-gradient-to-r ${je} ${ce} border rounded-md shadow-md ${ue} hover:shadow-lg transition-all duration-500 transform hover:scale-[1.01] hover:-translate-y-0.5 group overflow-hidden`,style:{width:`${xe}%`,minWidth:"150px",backdropFilter:"blur(10px)"},children:[t.jsxs("div",{className:"absolute inset-0 opacity-10",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent"}),t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1),transparent_50%)]"})]}),t.jsxs("div",{className:"relative px-3 py-1.5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:`${Re} backdrop-blur-sm rounded p-1 shadow-sm`,children:t.jsx("span",{className:"text-sm",children:be[P]||""})}),t.jsxs("div",{children:[t.jsx("span",{className:`${Z} text-[10px] font-bold uppercase tracking-wide block leading-tight`,children:O.label}),t.jsx("span",{className:`${Z} text-[9px] opacity-80 mt-0 block`,children:O.description})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:`${Z} text-lg font-extrabold mb-0 drop-shadow-lg`,children:G.toLocaleString()}),P>0&&ae>0&&t.jsxs("div",{className:`${Z} text-[9px] font-semibold bg-white/20 backdrop-blur-sm px-1.5 py-0.5 rounded-full border border-white/30`,children:[re.toFixed(1),"%"]})]})]}),P>0&&t.jsx("div",{className:"mt-1 h-0.5 bg-white/20 backdrop-blur-sm rounded-full overflow-hidden border border-white/20",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-white/80 to-white rounded-full transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min(re,100)}%`,animation:`progressFill 1.5s ease-out ${P*.1+.5}s both`}})})]}),t.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),P<F.length-1&&t.jsxs("div",{className:"relative my-0.5",children:[t.jsx("div",{className:"w-0.5 h-2 bg-gradient-to-b from-gray-400 via-gray-500 to-gray-400 rounded-full shadow-inner mx-auto"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-gray-500 rounded-full shadow-sm"})]})]},O.key)})},`funnel-${F.length}`)]}),t.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(30px) scale(0.95);
            }
            to {
              opacity: 1;
              transform: translateY(0) scale(1);
            }
          }
          
          @keyframes progressFill {
            from {
              width: 0%;
            }
          }
          
          .shadow-3xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
          }
        `}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 via-blue-500 to-cyan-500 rounded-xl p-4 shadow-xl hover:shadow-blue-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Total Prospects"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsx("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:S.prospectData.toLocaleString()}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Pipeline foundation"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-emerald-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Conversion Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.demoCompleted/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Demos completed"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-teal-600 via-teal-500 to-cyan-500 rounded-xl p-4 shadow-xl hover:shadow-teal-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"SQL Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.sql/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Sales qualified leads"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]})]})]})})}function z7(){const{id:l}=ai(),n=Tr(),[a,o]=B.useState(null),[s,e]=B.useState([]),[m,v]=B.useState([]),[w,N]=B.useState(!0),[S,D]=B.useState({prospectData:0,emailSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0});B.useEffect(()=>{l&&L()},[l]),B.useEffect(()=>{(s.length>0||m.length>0)&&M()},[s,m]);const L=async()=>{try{N(!0);const O=await Vt.get(`/projects/${l}`);O.data.success&&o(O.data.data);const P=await Vt.get(`/projects/${l}/project-contacts`);P.data.success&&e(P.data.data||[]);const G=await Vt.get(`/activities/project/${l}?limit=10000`);if(G.data.success){const re=(G.data.data||[]).filter(ke=>ke.type==="email");v(re)}}catch(O){console.error("Error fetching data:",O)}finally{N(!1)}},M=()=>{const O={prospectData:s.length,emailSent:0,accepted:0,followups:0,cip:0,meetingProposed:0,scheduled:0,completed:0,sql:0},P={};m.forEach(ce=>{if(!ce.contactId)return;const ue=ce.contactId.toString();P[ue]||(P[ue]=[]),P[ue].push(ce)});const G=new Set,ae=new Set,re=new Set,ke=new Set,xe=new Set,je=new Set,Z=new Set;m.forEach(ce=>{const ue=ce.contactId?.toString();ue&&(ce.emailDate&&G.add(ue),(ce.status==="Interested"||ce.status==="Meeting Proposed"||ce.status==="Meeting Scheduled")&&ae.add(ue),(ce.status==="Interested"||ce.status==="Out of Office")&&re.add(ue),ce.status==="Meeting Proposed"&&ke.add(ue),(ce.status==="Meeting Scheduled"||ce.nextActionDate)&&xe.add(ue),ce.status==="Meeting Completed"&&je.add(ue),(ce.status==="Meeting Completed"||ce.status==="Interested"&&ce.conversationNotes&&ce.conversationNotes.length>50)&&Z.add(ue))}),Object.keys(P).forEach(ce=>{const ue=P[ce];(ue.filter(be=>be.conversationNotes&&be.conversationNotes.trim()!=="").length>1||ue.length>1)&&O.followups++}),O.emailSent=G.size,O.accepted=ae.size,O.cip=re.size,O.meetingProposed=ke.size,O.scheduled=xe.size,O.completed=je.size,O.sql=Z.size,D(O)},F=[{key:"prospectData",label:"Prospect Data",description:"Total prospects from this project"},{key:"emailSent",label:"Email Sent",description:"Emails sent to prospects"},{key:"accepted",label:"Accepted",description:"Emails accepted/responded"},{key:"followups",label:"Followups",description:"Contacts with multiple emails"},{key:"cip",label:"CIP",description:"Conversations in Progress"},{key:"meetingProposed",label:"Meeting Proposed",description:"Meetings proposed"},{key:"scheduled",label:"Scheduled",description:"Meetings scheduled"},{key:"completed",label:"Completed",description:"Meetings completed"},{key:"sql",label:"SQL",description:"Sales Qualified Leads"}];return w?t.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading funnel data..."})]})}):t.jsx("div",{className:"min-h-screen bg-white",children:t.jsxs("div",{className:"max-w-5xl mx-auto px-4 lg:px-6 py-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("button",{onClick:()=>n(`/projects/${l}`),className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors duration-200 mb-6",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Prospect Management"]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-blue-500 to-blue-700 rounded-full"}),t.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["Email Funnel - ",a?.companyName||"Project"]})]}),a?.website&&t.jsx("a",{href:a.website.startsWith("http")?a.website:`http://${a.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:a.website})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-50 via-white to-gray-50 border border-gray-200 rounded-lg shadow-lg p-4 backdrop-blur-sm",children:[t.jsxs("div",{className:"mb-3 text-center",children:[t.jsx("h2",{className:"text-base font-bold text-gray-800 mb-0.5",children:"Sales Funnel Performance"}),t.jsx("p",{className:"text-[10px] text-gray-600",children:"Conversion metrics and pipeline health"})]}),t.jsx("div",{className:"flex flex-col items-center space-y-0.5",children:F.map((O,P)=>{const G=S[O.key]||0,ae=S.prospectData||1,re=ae>0?G/ae*100:0,xe=[96,88,78,68,58,48,38,28,20][P]||15;let je="",Z="text-white",ce="",ue="",Re="";P===0?(je="from-blue-600 via-blue-500 to-cyan-500",ce="border-blue-400",ue="shadow-blue-500/30",Re="bg-blue-400/30"):P>=5?(je="from-cyan-600 via-cyan-500 to-teal-500",ce="border-cyan-400",ue="shadow-cyan-500/30",Re="bg-cyan-400/30"):(je="from-slate-600 via-slate-500 to-gray-500",ce="border-slate-400",ue="shadow-slate-500/30",Re="bg-slate-400/30");const be=["","","","","","","","",""];return t.jsxs("div",{className:"w-full flex flex-col items-center transition-all duration-700 ease-out",style:{animation:`fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) ${P*.08}s both`},children:[t.jsxs("div",{className:`relative bg-gradient-to-r ${je} ${ce} border rounded-md shadow-md ${ue} hover:shadow-lg transition-all duration-500 transform hover:scale-[1.01] hover:-translate-y-0.5 group overflow-hidden`,style:{width:`${xe}%`,minWidth:"150px",backdropFilter:"blur(10px)"},children:[t.jsxs("div",{className:"absolute inset-0 opacity-10",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent"}),t.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1),transparent_50%)]"})]}),t.jsxs("div",{className:"relative px-3 py-1.5",children:[t.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:`${Re} backdrop-blur-sm rounded p-1 shadow-sm`,children:t.jsx("span",{className:"text-sm",children:be[P]})}),t.jsxs("div",{children:[t.jsx("span",{className:`${Z} text-[10px] font-bold uppercase tracking-wide block leading-tight`,children:O.label}),t.jsx("span",{className:`${Z} text-[9px] opacity-80 mt-0 block`,children:O.description})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:`${Z} text-lg font-extrabold mb-0 drop-shadow-lg`,children:G.toLocaleString()}),P>0&&ae>0&&t.jsxs("div",{className:`${Z} text-[9px] font-semibold bg-white/20 backdrop-blur-sm px-1.5 py-0.5 rounded-full border border-white/30`,children:[re.toFixed(1),"%"]})]})]}),P>0&&t.jsx("div",{className:"mt-1 h-0.5 bg-white/20 backdrop-blur-sm rounded-full overflow-hidden border border-white/20",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-white/80 to-white rounded-full transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min(re,100)}%`,animation:`progressFill 1.5s ease-out ${P*.1+.5}s both`}})})]}),t.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]}),P<F.length-1&&t.jsxs("div",{className:"relative my-0.5",children:[t.jsx("div",{className:"w-0.5 h-2 bg-gradient-to-b from-gray-400 via-gray-500 to-gray-400 rounded-full shadow-inner mx-auto"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-gray-500 rounded-full shadow-sm"})]})]},O.key)})})]}),t.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(30px) scale(0.95);
            }
            to {
              opacity: 1;
              transform: translateY(0) scale(1);
            }
          }
          
          @keyframes progressFill {
            from {
              width: 0%;
            }
          }
          
          .shadow-3xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
          }
        `}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-600 via-blue-500 to-cyan-500 rounded-xl p-4 shadow-xl hover:shadow-blue-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Total Prospects"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsx("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:S.prospectData.toLocaleString()}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Pipeline foundation"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-emerald-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"Conversion Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.completed/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Meetings completed"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-cyan-600 via-cyan-500 to-teal-500 rounded-xl p-4 shadow-xl hover:shadow-cyan-500/30 transition-all duration-500 transform hover:scale-105 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-50"}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-semibold text-white/90 uppercase tracking-wider",children:"SQL Rate"}),t.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:t.jsx("span",{className:"text-base",children:""})})]}),t.jsxs("div",{className:"text-3xl font-extrabold text-white mb-0.5 drop-shadow-lg",children:[S.prospectData>0?(S.sql/S.prospectData*100).toFixed(1):0,"%"]}),t.jsx("div",{className:"text-[10px] text-white/80 font-medium",children:"Sales qualified leads"})]}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-white/30"})]})]})]})})}const Yr=({children:l})=>localStorage.getItem("token")?l:t.jsx(pp,{to:"/login",replace:!0}),U7=()=>localStorage.getItem("token")?t.jsx(pp,{to:"/dashboard",replace:!0}):t.jsx(pp,{to:"/login",replace:!0});function H7(){return t.jsx(cw,{children:t.jsxs(I4,{children:[t.jsx(yr,{path:"/",element:t.jsx(U7,{})}),t.jsx(yr,{path:"/login",element:t.jsx(X5,{})}),t.jsx(yr,{path:"/reset-password",element:t.jsx(J5,{})}),t.jsxs(yr,{element:t.jsx(vw,{}),children:[t.jsx(yr,{path:"/dashboard",element:t.jsx(Yr,{children:t.jsx(Uk,{})})}),t.jsx(yr,{path:"/master-dashboard",element:t.jsx(Yr,{children:t.jsx(u7,{})})}),t.jsx(yr,{path:"/employee-performance",element:t.jsx(Yr,{children:t.jsx(m7,{})})}),t.jsx(yr,{path:"/contacts",element:t.jsx(Yr,{children:t.jsx(Vk,{})})}),t.jsx(yr,{path:"/contacts/company/:companyName",element:t.jsx(Yr,{children:t.jsx(qk,{})})}),t.jsx(yr,{path:"/contacts/:id/activities",element:t.jsx(Yr,{children:t.jsx($k,{})})}),t.jsx(yr,{path:"/contacts/:id",element:t.jsx(Yr,{children:t.jsx(Wk,{})})}),t.jsx(yr,{path:"/contacts/new",element:t.jsx(Yr,{children:t.jsx(Gk,{})})}),t.jsx(yr,{path:"/import",element:t.jsx(Yr,{children:t.jsx(Yk,{})})}),t.jsx(yr,{path:"/projects",element:t.jsx(Yr,{children:t.jsx(Kk,{})})}),t.jsx(yr,{path:"/projects/dashboard",element:t.jsx(Yr,{children:t.jsx(r7,{})})}),t.jsx(yr,{path:"/prospects/dashboard",element:t.jsx(Yr,{children:t.jsx(o7,{})})}),t.jsx(yr,{path:"/projects/new",element:t.jsx(Yr,{children:t.jsx(Sb,{})})}),t.jsx(yr,{path:"/projects/:id/edit",element:t.jsx(Yr,{children:t.jsx(Sb,{})})}),t.jsx(yr,{path:"/projects/:id",element:t.jsx(Yr,{children:t.jsx(Zk,{})})}),t.jsx(yr,{path:"/projects/:id/funnel",element:t.jsx(Yr,{children:t.jsx(g7,{})})}),t.jsx(yr,{path:"/projects/:id/linkedin-funnel",element:t.jsx(Yr,{children:t.jsx(E7,{})})}),t.jsx(yr,{path:"/projects/:id/cold-calling-funnel",element:t.jsx(Yr,{children:t.jsx(D7,{})})}),t.jsx(yr,{path:"/projects/:id/email-funnel",element:t.jsx(Yr,{children:t.jsx(T7,{})})}),t.jsx(yr,{path:"/projects/:id/report",element:t.jsx(Yr,{children:t.jsx(O7,{})})}),t.jsx(yr,{path:"/funnel",element:t.jsx(Yr,{children:t.jsx(P7,{})})}),t.jsx(yr,{path:"/funnel/:id/linkedin",element:t.jsx(Yr,{children:t.jsx(I7,{})})}),t.jsx(yr,{path:"/funnel/:id/cold-calling",element:t.jsx(Yr,{children:t.jsx(B7,{})})}),t.jsx(yr,{path:"/funnel/:id/email",element:t.jsx(Yr,{children:t.jsx(z7,{})})})]})]})})}Iv.createRoot(document.getElementById("root")).render(t.jsx(Mo.StrictMode,{children:t.jsx(H7,{})}));
